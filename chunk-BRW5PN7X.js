import{$ as l,R as h,T as f,c as g,h as p,ha as a,mc as v,na as w,nc as k,oc as D,pa as d,pc as x,ya as b}from"./chunk-3ITZAFYR.js";import{a as y,b as m}from"./chunk-VOSPIT4N.js";function j(o){o||(a(j),o=l(d));let e=new g(t=>o.onDestroy(t.next.bind(t)));return t=>t.pipe(h(e))}function S(o,e){!e?.injector&&a(S);let t=e?.injector??l(w),s=new p(1),u=D(()=>{let r;try{r=o()}catch(i){v(()=>s.error(i));return}v(()=>s.next(r))},{injector:t,manualCleanup:!0});return t.get(d).onDestroy(()=>{u.destroy(),s.complete()}),s.asObservable()}function O(o,e){let t=!e?.manualCleanup;t&&!e?.injector&&a(O);let s=t?e?.injector?.get(d)??l(d):null,u=R(e?.equal),r;e?.requireSync?r=b({kind:0},{equal:u}):r=b({kind:1,value:e?.initialValue},{equal:u});let i,c=o.subscribe({next:n=>r.set({kind:1,value:n}),error:n=>{if(e?.rejectErrors)throw n;r.set({kind:2,error:n})},complete:()=>{i?.()}});if(e?.requireSync&&r().kind===0)throw new f(601,!1);return i=s?.onDestroy(c.unsubscribe.bind(c)),k(()=>{let n=r();switch(n.kind){case 1:return n.value;case 2:throw n.error;case 0:throw new f(601,!1)}},{equal:e?.equal})}function R(o=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&o(e.value,t.value)}function E(o){return o?.injector||a(E),x(m(y({},o),{loader:void 0,stream:e=>{let t,s=()=>t.unsubscribe();e.abortSignal.addEventListener("abort",s);let u=b({value:void 0}),r,i=new Promise(n=>r=n);function c(n){u.set(n),r?.(u),r=void 0}return t=o.loader(e).subscribe({next:n=>c({value:n}),error:n=>{c({error:n}),e.abortSignal.removeEventListener("abort",s)},complete:()=>{r&&c({error:new Error("Resource completed before producing a value")}),e.abortSignal.removeEventListener("abort",s)}}),i}}))}export{j as a,S as b,O as c,E as d};
