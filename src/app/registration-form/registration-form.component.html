<form class="contents" [formGroup]="form" (submit)="submit()">
  <fieldset
    class="grid gap-6 h-dvh place-content-center snap-start timeline-view animation-range-end-contain animation-range-start-0 animate-fade-in-scale">
    <legend class="contents">
      <span class="text-2xl block">Astronaut Identity File</span>
      <span class="block"
        >Every explorer begins with a name. Record yours carefully — history will remember it among the stars.</span
      >
    </legend>

    <label
      class="place-self-center place-items-center place-content-center rounded-full cursor-pointer opacity-80 hover:opacity-100 transition-opacity leading-0 focus-within:outline-2 outline-offset-6 focus-within:outline-offset-1 input size-32 outline-surface-4">
      @if (avatarUrl()) {
        <img [src]="avatarUrl()" alt="" class="object-cover aspect-square rounded-full" />
      } @else if (avatar.loading()) {
        <mat-icon class="!block" svgIcon="spinner"></mat-icon>
      } @else {
        <mat-icon class="!size-full" svgIcon="Astronaut"></mat-icon>
      }

      <input
        type="file"
        class="sr-only"
        accept="image/*"
        [(ngModel)]="avatar.value"
        [ngModelOptions]="{ standalone: true }" />
    </label>

    <label class="group/field relative">
      <span class="group-has-required/field:after:content-['_*'] after:text-red-500">Full Name</span>
      <input
        type="text"
        [iisaErrorMessage]="error"
        inputmode="latin-name"
        [formControl]="form.controls.full_name"
        placeholder="Israel Israeli"
        class="input" />
    </label>

    <label class="group/field relative">
      <span class="group-has-required/field:after:content-['_*'] after:text-red-500">Date Of Birth</span>
      <input
        type="date"
        [iisaErrorMessage]="error"
        inputmode="date"
        [formControl]="form.controls.date_of_birth"
        class="input" />
    </label>

    <a [routerLink]="[]" tabindex="1" fragment="communication-protocols" class="button button__light justify-self-end"
      >Continue</a
    >
  </fieldset>

  <fieldset
    id="communication-protocols"
    class="grid gap-6 h-dvh place-content-center snap-start timeline-view animation-range-end-contain animation-range-start-0 animate-fade-in-scale">
    <legend class="contents">
      <span class="block text-2xl">Communication Protocols</span>
      <span class="block"
        >Mission Control must maintain contact. Provide coordinates so we can reach you across Earth… and beyond.</span
      >
    </legend>
    <label class="group/field relative"
      ><span class="group-has-required/field:after:content-['_*'] after:text-red-500">Email</span>
      <input
        type="email"
        inputmode="email"
        [iisaErrorMessage]="error"
        [formControl]="form.controls.email"
        placeholder="israel.israeli@gmail.com"
        class="input" />
    </label>
    <label class="group/field relative"
      ><span class="group-has-required/field:after:content-['_*'] after:text-red-500">Phone</span>
      <input
        type="text"
        inputmode="tel"
        [iisaErrorMessage]="error"
        [formControl]="form.controls.phone_number"
        placeholder="012-345-6789"
        class="input" />
    </label>

    <label class="group/field relative"
      ><span class="group-has-required/field:after:content-['_*'] after:text-red-500">City or Region</span>
      <input
        type="text"
        [iisaErrorMessage]="error"
        [formControl]="form.controls.city_region"
        placeholder="Jerusalem"
        class="input" />
    </label>

    <a [routerLink]="[]" tabindex="1" fragment="personal-orbit" class="button button__light justify-self-end"
      >Continue</a
    >
  </fieldset>

  <fieldset
    id="personal-orbit"
    class="grid gap-6 h-dvh place-content-center snap-start timeline-view animation-range-end-contain animation-range-start-0 animate-fade-in-scale">
    <legend class="contents">
      <span class="block text-2xl">Personal Orbit</span>
      <span class="block"
        >What keeps you inspired on Earth? Share the passions that fuel your imagination and curiosity.</span
      >
    </legend>

    <ul
      class="flex gap-2 flex-wrap"
      cdkListbox
      cdkListboxMultiple
      cdkListboxOrientation="horizontal"
      [formControl]="form.controls.hobbies">
      @for (hobby of hobbies; track hobby) {
        <li
          [cdkOption]="hobby"
          class="button button__light text-sm aria-selected:bg-surface-2/25 aria-selected:text-surface-3 flex items-center gap-2">
          <span>{{ hobby }}</span>
        </li>
      }
    </ul>

    <textarea
      [(ngModel)]="otherHobbies"
      [ngModelOptions]="{ standalone: true }"
      placeholder="Coding, Biking, Birdwatching, Music... (etc. comma separated)"
      class="input"></textarea>

    <a [routerLink]="[]" tabindex="1" fragment="mission-suitability" class="button button__light justify-self-end"
      >Continue</a
    >
  </fieldset>

  <fieldset
    id="mission-suitability"
    class="grid gap-6 h-dvh place-content-center snap-start timeline-view animation-range-end-contain animation-range-start-0 animate-fade-in-scale">
    <legend class="contents">
      <span class="block text-2xl">Mission Suitability</span>
    </legend>

    <label class="group/field relative" for="personal-statement">
      <span
        >Explain why you’re ready for the challenges of space. Convince Mission Control you belong on this historic
        flight.</span
      >
    </label>

    <textarea
      id="personal-statement"
      [formControl]="form.controls.personal_statement"
      placeholder="I excel at science, adventure, and pretending I know what I’m doing… perfect astronaut material!"
      rows="6"
      class="input"></textarea>

    <button type="submit" class="button button__bold place-self-center capitalize" [class.opacity-50]="form.invalid">
      Launch Application
    </button>
  </fieldset>
</form>

<ng-template #error let-error>
  <span class="text-red-500 text-sm italic absolute top-0 end-0">{{ error }}</span>
</ng-template>
