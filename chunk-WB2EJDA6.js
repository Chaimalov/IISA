import{d as Jy,g as F_}from"./chunk-XDAO4KEX.js";import{e as T_,o as D_,y as tp}from"./chunk-ECWGLPLS.js";import{a as A_,b as Kn}from"./chunk-4QZKOJ7N.js";import{m as M_}from"./chunk-T7QXW6VI.js";import"./chunk-76VAZDLT.js";import{a as Lh}from"./chunk-MPQP3QYP.js";import{$ as Ci,Cb as Jd,Db as ep,Ea as x_,Fa as qy,G as v_,Hb as Yy,Ib as Qy,Kb as Ah,Rb as ka,Sa as Fh,Sb as Ef,Tb as E_,V as Zo,W as Fa,Xa as yn,Y as $y,Za as Rf,_ as y_,_a as Zy,_b as Le,aa as w_,ac as Zn,ba as C_,bc as P_,cb as oo,db as Ia,eb as qn,ec as I_,f as Xd,fb as Ih,g as Th,ga as Hr,gb as Qd,gc as k_,i as Uy,ja as $l,l as jy,na as b_,ob as kh,p as xf,pa as We,q as _f,qa as $n,qb as __,r as Sf,rb as S_,sa as Et,ta as at,tb as R_,ua as ql,ub as Ky,v as m_,vb as Xy,wa as Dh,wb as ho,xb as uo,y as Yd,yb as Lo}from"./chunk-3DHLIRUN.js";import{a as Se,b as ht,c as Kd,e as aF,g as lF}from"./chunk-VOSPIT4N.js";var SR=aF((xw,_w)=>{"use strict";(function(e,t){typeof xw=="object"&&typeof _w<"u"?_w.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self,e.maplibregl=t())})(xw,function(){"use strict";var e={},t={};function i(n,o,l){if(t[n]=l,n==="index"){var d="var sharedModule = {}; ("+t.shared+")(sharedModule); ("+t.worker+")(sharedModule);",p={};return t.shared(p),t.index(e,p),typeof window<"u"&&e.setWorkerUrl(window.URL.createObjectURL(new Blob([d],{type:"text/javascript"}))),e}}i("shared",["exports"],function(n){"use strict";function o(h,a,c,g){return new(c||(c=Promise))(function(m,b){function _(F){try{M(g.next(F))}catch(A){b(A)}}function E(F){try{M(g.throw(F))}catch(A){b(A)}}function M(F){var A;F.done?m(F.value):(A=F.value,A instanceof c?A:new c(function(z){z(A)})).then(_,E)}M((g=g.apply(h,a||[])).next())})}function l(h,a){this.x=h,this.y=a}function d(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var p,y;typeof SuppressedError=="function"&&SuppressedError,l.prototype={clone(){return new l(this.x,this.y)},add(h){return this.clone()._add(h)},sub(h){return this.clone()._sub(h)},multByPoint(h){return this.clone()._multByPoint(h)},divByPoint(h){return this.clone()._divByPoint(h)},mult(h){return this.clone()._mult(h)},div(h){return this.clone()._div(h)},rotate(h){return this.clone()._rotate(h)},rotateAround(h,a){return this.clone()._rotateAround(h,a)},matMult(h){return this.clone()._matMult(h)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(h){return this.x===h.x&&this.y===h.y},dist(h){return Math.sqrt(this.distSqr(h))},distSqr(h){let a=h.x-this.x,c=h.y-this.y;return a*a+c*c},angle(){return Math.atan2(this.y,this.x)},angleTo(h){return Math.atan2(this.y-h.y,this.x-h.x)},angleWith(h){return this.angleWithSep(h.x,h.y)},angleWithSep(h,a){return Math.atan2(this.x*a-this.y*h,this.x*h+this.y*a)},_matMult(h){let a=h[2]*this.x+h[3]*this.y;return this.x=h[0]*this.x+h[1]*this.y,this.y=a,this},_add(h){return this.x+=h.x,this.y+=h.y,this},_sub(h){return this.x-=h.x,this.y-=h.y,this},_mult(h){return this.x*=h,this.y*=h,this},_div(h){return this.x/=h,this.y/=h,this},_multByPoint(h){return this.x*=h.x,this.y*=h.y,this},_divByPoint(h){return this.x/=h.x,this.y/=h.y,this},_unit(){return this._div(this.mag()),this},_perp(){let h=this.y;return this.y=this.x,this.x=-h,this},_rotate(h){let a=Math.cos(h),c=Math.sin(h),g=c*this.x+a*this.y;return this.x=a*this.x-c*this.y,this.y=g,this},_rotateAround(h,a){let c=Math.cos(h),g=Math.sin(h),m=a.y+g*(this.x-a.x)+c*(this.y-a.y);return this.x=a.x+c*(this.x-a.x)-g*(this.y-a.y),this.y=m,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:l},l.convert=function(h){if(h instanceof l)return h;if(Array.isArray(h))return new l(+h[0],+h[1]);if(h.x!==void 0&&h.y!==void 0)return new l(+h.x,+h.y);throw new Error("Expected [x, y] or {x, y} point format")};var C=function(){if(y)return p;function h(a,c,g,m){this.cx=3*a,this.bx=3*(g-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(m-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=c,this.p2x=g,this.p2y=m}return y=1,p=h,h.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,c){if(c===void 0&&(c=1e-6),a<0)return 0;if(a>1)return 1;for(var g=a,m=0;m<8;m++){var b=this.sampleCurveX(g)-a;if(Math.abs(b)<c)return g;var _=this.sampleCurveDerivativeX(g);if(Math.abs(_)<1e-6)break;g-=b/_}var E=0,M=1;for(g=a,m=0;m<20&&(b=this.sampleCurveX(g),!(Math.abs(b-a)<c));m++)a>b?E=g:M=g,g=.5*(M-E)+E;return g},solve:function(a,c){return this.sampleCurveY(this.solveCurveX(a,c))}},p}(),S=d(C);let P,I;function O(){return P==null&&(P=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),P}function V(){if(I==null&&(I=!1,O())){let a=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(a){for(let g=0;g<5*5;g++){let m=4*g;a.fillStyle=`rgb(${m},${m+1},${m+2})`,a.fillRect(g%5,Math.floor(g/5),1,1)}let c=a.getImageData(0,0,5,5).data;for(let g=0;g<5*5*4;g++)if(g%4!=3&&c[g]!==g){I=!0;break}}}return I||!1}var G=1e-6,X=typeof Float32Array<"u"?Float32Array:Array;function Q(){var h=new X(9);return X!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h}function ae(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h}function me(){var h=new X(3);return X!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h}function fe(h){var a=h[0],c=h[1],g=h[2];return Math.sqrt(a*a+c*c+g*g)}function _e(h,a,c){var g=new X(3);return g[0]=h,g[1]=a,g[2]=c,g}function Ae(h,a,c){return h[0]=a[0]+c[0],h[1]=a[1]+c[1],h[2]=a[2]+c[2],h}function Oe(h,a,c){return h[0]=a[0]*c,h[1]=a[1]*c,h[2]=a[2]*c,h}function Ge(h,a,c){var g=a[0],m=a[1],b=a[2],_=c[0],E=c[1],M=c[2];return h[0]=m*M-b*E,h[1]=b*_-g*M,h[2]=g*E-m*_,h}var it,Xe=fe;function lt(h,a,c){var g=a[0],m=a[1],b=a[2],_=a[3];return h[0]=c[0]*g+c[4]*m+c[8]*b+c[12]*_,h[1]=c[1]*g+c[5]*m+c[9]*b+c[13]*_,h[2]=c[2]*g+c[6]*m+c[10]*b+c[14]*_,h[3]=c[3]*g+c[7]*m+c[11]*b+c[15]*_,h}function St(){var h=new X(4);return X!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h[3]=1,h}function Gt(h,a,c,g){var m=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",b=Math.PI/360;a*=b,g*=b,c*=b;var _=Math.sin(a),E=Math.cos(a),M=Math.sin(c),F=Math.cos(c),A=Math.sin(g),z=Math.cos(g);switch(m){case"xyz":h[0]=_*F*z+E*M*A,h[1]=E*M*z-_*F*A,h[2]=E*F*A+_*M*z,h[3]=E*F*z-_*M*A;break;case"xzy":h[0]=_*F*z-E*M*A,h[1]=E*M*z-_*F*A,h[2]=E*F*A+_*M*z,h[3]=E*F*z+_*M*A;break;case"yxz":h[0]=_*F*z+E*M*A,h[1]=E*M*z-_*F*A,h[2]=E*F*A-_*M*z,h[3]=E*F*z+_*M*A;break;case"yzx":h[0]=_*F*z+E*M*A,h[1]=E*M*z+_*F*A,h[2]=E*F*A-_*M*z,h[3]=E*F*z-_*M*A;break;case"zxy":h[0]=_*F*z-E*M*A,h[1]=E*M*z+_*F*A,h[2]=E*F*A+_*M*z,h[3]=E*F*z-_*M*A;break;case"zyx":h[0]=_*F*z-E*M*A,h[1]=E*M*z+_*F*A,h[2]=E*F*A-_*M*z,h[3]=E*F*z+_*M*A;break;default:throw new Error("Unknown angle order "+m)}return h}function xt(){var h=new X(2);return X!=Float32Array&&(h[0]=0,h[1]=0),h}function Yt(h,a){var c=new X(2);return c[0]=h,c[1]=a,c}me(),it=new X(4),X!=Float32Array&&(it[0]=0,it[1]=0,it[2]=0,it[3]=0),me(),_e(1,0,0),_e(0,1,0),St(),St(),Q(),xt();let Ct=8192;function Fi(h,a,c){return a*(Ct/(h.tileSize*Math.pow(2,c-h.tileID.overscaledZ)))}function jt(h,a){return(h%a+a)%a}function Jt(h,a,c){return h*(1-c)+a*c}function Bi(h){if(h<=0)return 0;if(h>=1)return 1;let a=h*h,c=a*h;return 4*(h<.5?c:3*(h-a)+c-.75)}function Qi(h,a,c,g){let m=new S(h,a,c,g);return b=>m.solve(b)}let ji=Qi(.25,.1,.25,1);function fi(h,a,c){return Math.min(c,Math.max(a,h))}function ro(h,a,c){let g=c-a,m=((h-a)%g+g)%g+a;return m===a?c:m}function $i(h,...a){for(let c of a)for(let g in c)h[g]=c[g];return h}let bo=1;function na(h,a,c){let g={};for(let m in h)g[m]=a.call(this,h[m],m,h);return g}function ra(h,a,c){let g={};for(let m in h)a.call(this,h[m],m,h)&&(g[m]=h[m]);return g}function Xs(h){return Array.isArray(h)?h.map(Xs):typeof h=="object"&&h?na(h,Xs):h}let Ii={};function Vi(h){Ii[h]||(typeof console<"u"&&console.warn(h),Ii[h]=!0)}function xo(h,a,c){return(c.y-h.y)*(a.x-h.x)>(a.y-h.y)*(c.x-h.x)}function Ho(h){return typeof WorkerGlobalScope<"u"&&h!==void 0&&h instanceof WorkerGlobalScope}let pr=null;function No(h){return typeof ImageBitmap<"u"&&h instanceof ImageBitmap}let Go="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function aa(h,a,c,g,m){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let b=new VideoFrame(h,{timestamp:0});try{let _=b?.format;if(!_||!_.startsWith("BGR")&&!_.startsWith("RGB"))throw new Error(`Unrecognized format ${_}`);let E=_.startsWith("BGR"),M=new Uint8ClampedArray(g*m*4);if(yield b.copyTo(M,function(F,A,z,N,U){let j=4*Math.max(-A,0),K=(Math.max(0,z)-z)*N*4+j,J=4*N,se=Math.max(0,A),Ce=Math.max(0,z);return{rect:{x:se,y:Ce,width:Math.min(F.width,A+N)-se,height:Math.min(F.height,z+U)-Ce},layout:[{offset:K,stride:J}]}}(h,a,c,g,m)),E)for(let F=0;F<M.length;F+=4){let A=M[F];M[F]=M[F+2],M[F+2]=A}return M}finally{b.close()}})}let Rn,En;function Pn(h,a,c,g){return h.addEventListener(a,c,g),{unsubscribe:()=>{h.removeEventListener(a,c,g)}}}function gr(h){return h*Math.PI/180}function Mn(h){return h/Math.PI*180}let Tn={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Dn={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},la="AbortError";function ye(){return new Error(la)}let $={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function q(h){return $.REGISTERED_PROTOCOLS[h.substring(0,h.indexOf("://"))]}let Y="global-dispatcher";class he extends Error{constructor(a,c,g,m){super(`AJAXError: ${c} (${a}): ${g}`),this.status=a,this.statusText=c,this.url=g,this.body=m}}let de=()=>Ho(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,ve=function(h,a){if(/:\/\//.test(h.url)&&!/^https?:|^file:/.test(h.url)){let g=q(h.url);if(g)return g(h,a);if(Ho(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,targetMapId:Y},a)}if(!(/^file:/.test(c=h.url)||/^file:/.test(de())&&!/^\w+:/.test(c))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(g,m){return o(this,void 0,void 0,function*(){let b=new Request(g.url,{method:g.method||"GET",body:g.body,credentials:g.credentials,headers:g.headers,cache:g.cache,referrer:de(),signal:m.signal}),_,E;g.type!=="json"||b.headers.has("Accept")||b.headers.set("Accept","application/json");try{_=yield fetch(b)}catch(F){throw new he(0,F.message,g.url,new Blob)}if(!_.ok){let F=yield _.blob();throw new he(_.status,_.statusText,g.url,F)}E=g.type==="arrayBuffer"||g.type==="image"?_.arrayBuffer():g.type==="json"?_.json():_.text();let M=yield E;if(m.signal.aborted)throw ye();return{data:M,cacheControl:_.headers.get("Cache-Control"),expires:_.headers.get("Expires")}})}(h,a);if(Ho(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,mustQueue:!0,targetMapId:Y},a)}var c;return function(g,m){return new Promise((b,_)=>{var E;let M=new XMLHttpRequest;M.open(g.method||"GET",g.url,!0),g.type!=="arrayBuffer"&&g.type!=="image"||(M.responseType="arraybuffer");for(let F in g.headers)M.setRequestHeader(F,g.headers[F]);g.type==="json"&&(M.responseType="text",!((E=g.headers)===null||E===void 0)&&E.Accept||M.setRequestHeader("Accept","application/json")),M.withCredentials=g.credentials==="include",M.onerror=()=>{_(new Error(M.statusText))},M.onload=()=>{if(!m.signal.aborted)if((M.status>=200&&M.status<300||M.status===0)&&M.response!==null){let F=M.response;if(g.type==="json")try{F=JSON.parse(M.response)}catch(A){return void _(A)}b({data:F,cacheControl:M.getResponseHeader("Cache-Control"),expires:M.getResponseHeader("Expires")})}else{let F=new Blob([M.response],{type:M.getResponseHeader("Content-Type")});_(new he(M.status,M.statusText,g.url,F))}},m.signal.addEventListener("abort",()=>{M.abort(),_(ye())}),M.send(g.body)})}(h,a)};function Me(h){if(!h||h.indexOf("://")<=0||h.indexOf("data:image/")===0||h.indexOf("blob:")===0)return!0;let a=new URL(h),c=window.location;return a.protocol===c.protocol&&a.host===c.host}function be(h,a,c){c[h]&&c[h].indexOf(a)!==-1||(c[h]=c[h]||[],c[h].push(a))}function ke(h,a,c){if(c&&c[h]){let g=c[h].indexOf(a);g!==-1&&c[h].splice(g,1)}}class Ue{constructor(a,c={}){$i(this,c),this.type=a}}class Ve extends Ue{constructor(a,c={}){super("error",$i({error:a},c))}}class ct{on(a,c){return this._listeners=this._listeners||{},be(a,c,this._listeners),{unsubscribe:()=>{this.off(a,c)}}}off(a,c){return ke(a,c,this._listeners),ke(a,c,this._oneTimeListeners),this}once(a,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},be(a,c,this._oneTimeListeners),this):new Promise(g=>this.once(a,g))}fire(a,c){typeof a=="string"&&(a=new Ue(a,c||{}));let g=a.type;if(this.listens(g)){a.target=this;let m=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(let E of m)E.call(this,a);let b=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(let E of b)ke(g,E,this._oneTimeListeners),E.call(this,a);let _=this._eventedParent;_&&($i(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(a))}else a instanceof Ve&&console.error(a.error);return this}listens(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)}setEventedParent(a,c){return this._eventedParent=a,this._eventedParentData=c,this}}var xe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};let Rt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function zt(h,a){let c={};for(let g in h)g!=="ref"&&(c[g]=h[g]);return Rt.forEach(g=>{g in a&&(c[g]=a[g])}),c}function ft(h,a){if(Array.isArray(h)){if(!Array.isArray(a)||h.length!==a.length)return!1;for(let c=0;c<h.length;c++)if(!ft(h[c],a[c]))return!1;return!0}if(typeof h=="object"&&h!==null&&a!==null){if(typeof a!="object"||Object.keys(h).length!==Object.keys(a).length)return!1;for(let c in h)if(!ft(h[c],a[c]))return!1;return!0}return h===a}function Tt(h,a){h.push(a)}function ci(h,a,c){Tt(c,{command:"addSource",args:[h,a[h]]})}function Ji(h,a,c){Tt(a,{command:"removeSource",args:[h]}),c[h]=!0}function es(h,a,c,g){Ji(h,c,g),ci(h,a,c)}function Hi(h,a,c){let g;for(g in h[c])if(Object.prototype.hasOwnProperty.call(h[c],g)&&g!=="data"&&!ft(h[c][g],a[c][g]))return!1;for(g in a[c])if(Object.prototype.hasOwnProperty.call(a[c],g)&&g!=="data"&&!ft(h[c][g],a[c][g]))return!1;return!0}function Bt(h,a,c,g,m,b){h=h||{},a=a||{};for(let _ in h)Object.prototype.hasOwnProperty.call(h,_)&&(ft(h[_],a[_])||c.push({command:b,args:[g,_,a[_],m]}));for(let _ in a)Object.prototype.hasOwnProperty.call(a,_)&&!Object.prototype.hasOwnProperty.call(h,_)&&(ft(h[_],a[_])||c.push({command:b,args:[g,_,a[_],m]}))}function Wt(h){return h.id}function qi(h,a){return h[a.id]=a,h}class $e{constructor(a,c,g,m){this.message=(a?`${a}: `:"")+g,m&&(this.identifier=m),c!=null&&c.__line__&&(this.line=c.__line__)}}function bs(h,...a){for(let c of a)for(let g in c)h[g]=c[g];return h}class Ei extends Error{constructor(a,c){super(c),this.message=c,this.key=a}}class Fn{constructor(a,c=[]){this.parent=a,this.bindings={};for(let[g,m]of c)this.bindings[g]=m}concat(a){return new Fn(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}let ca={kind:"null"},tt={kind:"number"},At={kind:"string"},Ft={kind:"boolean"},fs={kind:"color"},fr={kind:"projectionDefinition"},In={kind:"object"},Dt={kind:"value"},xc={kind:"collator"},kn={kind:"formatted"},_c={kind:"padding"},Wo={kind:"colorArray"},ha={kind:"numberArray"},ki={kind:"resolvedImage"},Sc={kind:"variableAnchorOffsetCollection"};function Ws(h,a){return{kind:"array",itemType:h,N:a}}function si(h){if(h.kind==="array"){let a=si(h.itemType);return typeof h.N=="number"?`array<${a}, ${h.N}>`:h.itemType.kind==="value"?"array":`array<${a}>`}return h.kind}let ug=[ca,tt,At,Ft,fs,fr,kn,In,Ws(Dt),_c,ha,Wo,ki,Sc];function hl(h,a){if(a.kind==="error")return null;if(h.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!hl(h.itemType,a.itemType))&&(typeof h.N!="number"||h.N===a.N))return null}else{if(h.kind===a.kind)return null;if(h.kind==="value"){for(let c of ug)if(!hl(c,a))return null}}return`Expected ${si(h)} but found ${si(a)} instead.`}function Lu(h,a){return a.some(c=>c.kind===h.kind)}function An(h,a){return a.some(c=>c==="null"?h===null:c==="array"?Array.isArray(h):c==="object"?h&&!Array.isArray(h)&&typeof h=="object":c===typeof h)}function Ln(h,a){return h.kind==="array"&&a.kind==="array"?h.itemType.kind===a.itemType.kind&&typeof h.N=="number":h.kind===a.kind}let Ou=.96422,dg=.82521,pg=4/29,ua=6/29,gg=3*ua*ua,Fv=ua*ua*ua,Iv=Math.PI/180,kv=180/Math.PI;function zu(h){return(h%=360)<0&&(h+=360),h}function da([h,a,c,g]){let m,b,_=Vu((.2225045*(h=Bu(h))+.7168786*(a=Bu(a))+.0606169*(c=Bu(c)))/1);h===a&&a===c?m=b=_:(m=Vu((.4360747*h+.3850649*a+.1430804*c)/Ou),b=Vu((.0139322*h+.0971045*a+.7141733*c)/dg));let E=116*_-16;return[E<0?0:E,500*(m-_),200*(_-b),g]}function Bu(h){return h<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)}function Vu(h){return h>Fv?Math.pow(h,1/3):h/gg+pg}function pa([h,a,c,g]){let m=(h+16)/116,b=isNaN(a)?m:m+a/500,_=isNaN(c)?m:m-c/200;return m=1*Nu(m),b=Ou*Nu(b),_=dg*Nu(_),[Hu(3.1338561*b-1.6168667*m-.4906146*_),Hu(-.9787684*b+1.9161415*m+.033454*_),Hu(.0719453*b-.2289914*m+1.4052427*_),g]}function Hu(h){return(h=h<=.00304?12.92*h:1.055*Math.pow(h,1/2.4)-.055)<0?0:h>1?1:h}function Nu(h){return h>ua?h*h*h:gg*(h-pg)}let Av=Object.hasOwn||function(h,a){return Object.prototype.hasOwnProperty.call(h,a)};function ga(h,a){return Av(h,a)?h[a]:void 0}function ul(h){return parseInt(h.padEnd(2,h),16)/255}function _o(h,a){return Lt(a?h/100:h,0,1)}function Lt(h,a,c){return Math.min(Math.max(a,h),c)}function mr(h){return!h.some(Number.isNaN)}let On={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function an(h,a,c){return h+c*(a-h)}function vr(h,a,c){return h.map((g,m)=>an(g,a[m],c))}class Ot{constructor(a,c,g,m=1,b=!0){this.r=a,this.g=c,this.b=g,this.a=m,b||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[a,c,g,m]))}static parse(a){if(a instanceof Ot)return a;if(typeof a!="string")return;let c=function(g){if((g=g.toLowerCase().trim())==="transparent")return[0,0,0,0];let m=ga(On,g);if(m){let[_,E,M]=m;return[_/255,E/255,M/255,1]}if(g.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(g)){let _=g.length<6?1:2,E=1;return[ul(g.slice(E,E+=_)),ul(g.slice(E,E+=_)),ul(g.slice(E,E+=_)),ul(g.slice(E,E+_)||"ff")]}if(g.startsWith("rgb")){let _=g.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){let[E,M,F,A,z,N,U,j,K,J,se,Ce]=_,ce=[A||" ",U||" ",J].join("");if(ce==="  "||ce==="  /"||ce===",,"||ce===",,,"){let pe=[F,N,K].join(""),Pe=pe==="%%%"?100:pe===""?255:0;if(Pe){let Ie=[Lt(+M/Pe,0,1),Lt(+z/Pe,0,1),Lt(+j/Pe,0,1),se?_o(+se,Ce):1];if(mr(Ie))return Ie}}return}}let b=g.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){let[_,E,M,F,A,z,N,U,j]=b,K=[M||" ",A||" ",N].join("");if(K==="  "||K==="  /"||K===",,"||K===",,,"){let J=[+E,Lt(+F,0,100),Lt(+z,0,100),U?_o(+U,j):1];if(mr(J))return function([se,Ce,ce,pe]){function Pe(Ie){let Ne=(Ie+se/30)%12,et=Ce*Math.min(ce,1-ce);return ce-et*Math.max(-1,Math.min(Ne-3,9-Ne,1))}return se=zu(se),Ce/=100,ce/=100,[Pe(0),Pe(8),Pe(4),pe]}(J)}}}(a);return c?new Ot(...c,!1):void 0}get rgb(){let{r:a,g:c,b:g,a:m}=this,b=m||1/0;return this.overwriteGetter("rgb",[a/b,c/b,g/b,m])}get hcl(){return this.overwriteGetter("hcl",function(a){let[c,g,m,b]=da(a),_=Math.sqrt(g*g+m*m);return[Math.round(1e4*_)?zu(Math.atan2(m,g)*kv):NaN,_,c,b]}(this.rgb))}get lab(){return this.overwriteGetter("lab",da(this.rgb))}overwriteGetter(a,c){return Object.defineProperty(this,a,{value:c}),c}toString(){let[a,c,g,m]=this.rgb;return`rgba(${[a,c,g].map(b=>Math.round(255*b)).join(",")},${m})`}static interpolate(a,c,g,m="rgb"){switch(m){case"rgb":{let[b,_,E,M]=vr(a.rgb,c.rgb,g);return new Ot(b,_,E,M,!1)}case"hcl":{let[b,_,E,M]=a.hcl,[F,A,z,N]=c.hcl,U,j;if(isNaN(b)||isNaN(F))isNaN(b)?isNaN(F)?U=NaN:(U=F,E!==1&&E!==0||(j=A)):(U=b,z!==1&&z!==0||(j=_));else{let ce=F-b;F>b&&ce>180?ce-=360:F<b&&b-F>180&&(ce+=360),U=b+g*ce}let[K,J,se,Ce]=function([ce,pe,Pe,Ie]){return ce=isNaN(ce)?0:ce*Iv,pa([Pe,Math.cos(ce)*pe,Math.sin(ce)*pe,Ie])}([U,j??an(_,A,g),an(E,z,g),an(M,N,g)]);return new Ot(K,J,se,Ce,!1)}case"lab":{let[b,_,E,M]=pa(vr(a.lab,c.lab,g));return new Ot(b,_,E,M,!1)}}}}Ot.black=new Ot(0,0,0,1),Ot.white=new Ot(1,1,1,1),Ot.transparent=new Ot(0,0,0,0),Ot.red=new Ot(1,0,0,1);class yr{constructor(a,c,g){this.sensitivity=a?c?"variant":"case":c?"accent":"base",this.locale=g,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,c){return this.collator.compare(a,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}let Rc=["bottom","center","top"];class Ec{constructor(a,c,g,m,b,_){this.text=a,this.image=c,this.scale=g,this.fontStack=m,this.textColor=b,this.verticalAlign=_}}class Ts{constructor(a){this.sections=a}static fromString(a){return new Ts([new Ec(a,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof Ts?a:Ts.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}}class as{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof as)return a;if(typeof a=="number")return new as([a,a,a,a]);if(Array.isArray(a)&&!(a.length<1||a.length>4)){for(let c of a)if(typeof c!="number")return;switch(a.length){case 1:a=[a[0],a[0],a[0],a[0]];break;case 2:a=[a[0],a[1],a[0],a[1]];break;case 3:a=[a[0],a[1],a[2],a[1]]}return new as(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,c,g){return new as(vr(a.values,c.values,g))}}class Ds{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof Ds)return a;if(typeof a=="number")return new Ds([a]);if(Array.isArray(a)){for(let c of a)if(typeof c!="number")return;return new Ds(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,c,g){return new Ds(vr(a.values,c.values,g))}}class Zi{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof Zi)return a;if(typeof a=="string"){let g=Ot.parse(a);return g?new Zi([g]):void 0}if(!Array.isArray(a))return;let c=[];for(let g of a){if(typeof g!="string")return;let m=Ot.parse(g);if(!m)return;c.push(m)}return new Zi(c)}toString(){return JSON.stringify(this.values)}static interpolate(a,c,g,m="rgb"){let b=[];if(a.values.length!=c.values.length)throw new Error(`colorArray: Arrays have mismatched length (${a.values.length} vs. ${c.values.length}), cannot interpolate.`);for(let _=0;_<a.values.length;_++)b.push(Ot.interpolate(a.values[_],c.values[_],g,m));return new Zi(b)}}class oi extends Error{constructor(a){super(a),this.name="RuntimeError"}toJSON(){return this.message}}let fg=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Fs{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof Fs)return a;if(Array.isArray(a)&&!(a.length<1)&&a.length%2==0){for(let c=0;c<a.length;c+=2){let g=a[c],m=a[c+1];if(typeof g!="string"||!fg.has(g)||!Array.isArray(m)||m.length!==2||typeof m[0]!="number"||typeof m[1]!="number")return}return new Fs(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,c,g){let m=a.values,b=c.values;if(m.length!==b.length)throw new oi(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${c.toString()}`);let _=[];for(let E=0;E<m.length;E+=2){if(m[E]!==b[E])throw new oi(`Cannot interpolate values containing mismatched anchors. from[${E}]: ${m[E]}, to[${E}]: ${b[E]}`);_.push(m[E]);let[M,F]=m[E+1],[A,z]=b[E+1];_.push([an(M,A,g),an(F,z,g)])}return new Fs(_)}}class Ys{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new Ys({name:a,available:!1}):null}}class xs{constructor(a,c,g){this.from=a,this.to=c,this.transition=g}static interpolate(a,c,g){return new xs(a,c,g)}static parse(a){return a instanceof xs?a:Array.isArray(a)&&a.length===3&&typeof a[0]=="string"&&typeof a[1]=="string"&&typeof a[2]=="number"?new xs(a[0],a[1],a[2]):typeof a=="object"&&typeof a.from=="string"&&typeof a.to=="string"&&typeof a.transition=="number"?new xs(a.from,a.to,a.transition):typeof a=="string"?new xs(a,a,1):void 0}}function pi(h,a,c,g){return typeof h=="number"&&h>=0&&h<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof c=="number"&&c>=0&&c<=255?g===void 0||typeof g=="number"&&g>=0&&g<=1?null:`Invalid rgba value [${[h,a,c,g].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof g=="number"?[h,a,c,g]:[h,a,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function wr(h){if(h===null||typeof h=="string"||typeof h=="boolean"||typeof h=="number"||h instanceof xs||h instanceof Ot||h instanceof yr||h instanceof Ts||h instanceof as||h instanceof Ds||h instanceof Zi||h instanceof Fs||h instanceof Ys)return!0;if(Array.isArray(h)){for(let a of h)if(!wr(a))return!1;return!0}if(typeof h=="object"){for(let a in h)if(!wr(h[a]))return!1;return!0}return!1}function yt(h){if(h===null)return ca;if(typeof h=="string")return At;if(typeof h=="boolean")return Ft;if(typeof h=="number")return tt;if(h instanceof Ot)return fs;if(h instanceof xs)return fr;if(h instanceof yr)return xc;if(h instanceof Ts)return kn;if(h instanceof as)return _c;if(h instanceof Ds)return ha;if(h instanceof Zi)return Wo;if(h instanceof Fs)return Sc;if(h instanceof Ys)return ki;if(Array.isArray(h)){let a=h.length,c;for(let g of h){let m=yt(g);if(c){if(c===m)continue;c=Dt;break}c=m}return Ws(c||Dt,a)}return In}function Pt(h){let a=typeof h;return h===null?"":a==="string"||a==="number"||a==="boolean"?String(h):h instanceof Ot||h instanceof xs||h instanceof Ts||h instanceof as||h instanceof Ds||h instanceof Zi||h instanceof Fs||h instanceof Ys?h.toString():JSON.stringify(h)}class ln{constructor(a,c){this.type=a,this.value=c}static parse(a,c){if(a.length!==2)return c.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!wr(a[1]))return c.error("invalid value");let g=a[1],m=yt(g),b=c.expectedType;return m.kind!=="array"||m.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(m=b),new ln(m,g)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}let Ut={string:At,number:tt,boolean:Ft,object:In};class Qs{constructor(a,c){this.type=a,this.args=c}static parse(a,c){if(a.length<2)return c.error("Expected at least one argument.");let g,m=1,b=a[0];if(b==="array"){let E,M;if(a.length>2){let F=a[1];if(typeof F!="string"||!(F in Ut)||F==="object")return c.error('The item type argument of "array" must be one of string, number, boolean',1);E=Ut[F],m++}else E=Dt;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return c.error('The length argument to "array" must be a positive integer literal',2);M=a[2],m++}g=Ws(E,M)}else{if(!Ut[b])throw new Error(`Types doesn't contain name = ${b}`);g=Ut[b]}let _=[];for(;m<a.length;m++){let E=c.parse(a[m],m,Dt);if(!E)return null;_.push(E)}return new Qs(g,_)}evaluate(a){for(let c=0;c<this.args.length;c++){let g=this.args[c].evaluate(a);if(!hl(this.type,yt(g)))return g;if(c===this.args.length-1)throw new oi(`Expected value to be of type ${si(this.type)}, but found ${si(yt(g))} instead.`)}throw new Error}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}let Uo={"to-boolean":Ft,"to-color":fs,"to-number":tt,"to-string":At};class jo{constructor(a,c){this.type=a,this.args=c}static parse(a,c){if(a.length<2)return c.error("Expected at least one argument.");let g=a[0];if(!Uo[g])throw new Error(`Can't parse ${g} as it is not part of the known types`);if((g==="to-boolean"||g==="to-string")&&a.length!==2)return c.error("Expected one argument.");let m=Uo[g],b=[];for(let _=1;_<a.length;_++){let E=c.parse(a[_],_,Dt);if(!E)return null;b.push(E)}return new jo(m,b)}evaluate(a){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(a);case"color":{let c,g;for(let m of this.args){if(c=m.evaluate(a),g=null,c instanceof Ot)return c;if(typeof c=="string"){let b=a.parseColor(c);if(b)return b}else if(Array.isArray(c)&&(g=c.length<3||c.length>4?`Invalid rgba value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:pi(c[0],c[1],c[2],c[3]),!g))return new Ot(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new oi(g||`Could not parse color from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"padding":{let c;for(let g of this.args){c=g.evaluate(a);let m=as.parse(c);if(m)return m}throw new oi(`Could not parse padding from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"numberArray":{let c;for(let g of this.args){c=g.evaluate(a);let m=Ds.parse(c);if(m)return m}throw new oi(`Could not parse numberArray from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"colorArray":{let c;for(let g of this.args){c=g.evaluate(a);let m=Zi.parse(c);if(m)return m}throw new oi(`Could not parse colorArray from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"variableAnchorOffsetCollection":{let c;for(let g of this.args){c=g.evaluate(a);let m=Fs.parse(c);if(m)return m}throw new oi(`Could not parse variableAnchorOffsetCollection from value '${typeof c=="string"?c:JSON.stringify(c)}'`)}case"number":{let c=null;for(let g of this.args){if(c=g.evaluate(a),c===null)return 0;let m=Number(c);if(!isNaN(m))return m}throw new oi(`Could not convert ${JSON.stringify(c)} to number.`)}case"formatted":return Ts.fromString(Pt(this.args[0].evaluate(a)));case"resolvedImage":return Ys.fromString(Pt(this.args[0].evaluate(a)));case"projectionDefinition":return this.args[0].evaluate(a);default:return Pt(this.args[0].evaluate(a))}}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}let Pc=["Unknown","Point","LineString","Polygon"];class Gu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Pc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(a){let c=this._parseColorCache.get(a);return c||(c=Ot.parse(a),this._parseColorCache.set(a,c)),c}}class fa{constructor(a,c,g=[],m,b=new Fn,_=[]){this.registry=a,this.path=g,this.key=g.map(E=>`[${E}]`).join(""),this.scope=b,this.errors=_,this.expectedType=m,this._isConstant=c}parse(a,c,g,m,b={}){return c?this.concat(c,g,m)._parse(a,b):this._parse(a,b)}_parse(a,c){function g(m,b,_){return _==="assert"?new Qs(b,[m]):_==="coerce"?new jo(b,[m]):m}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let m=a[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let b=this.registry[m];if(b){let _=b.parse(a,this);if(!_)return null;if(this.expectedType){let E=this.expectedType,M=_.type;if(E.kind!=="string"&&E.kind!=="number"&&E.kind!=="boolean"&&E.kind!=="object"&&E.kind!=="array"||M.kind!=="value"){if(E.kind==="projectionDefinition"&&["string","array"].includes(M.kind)||["color","formatted","resolvedImage"].includes(E.kind)&&["value","string"].includes(M.kind)||["padding","numberArray"].includes(E.kind)&&["value","number","array"].includes(M.kind)||E.kind==="colorArray"&&["value","string","array"].includes(M.kind)||E.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(M.kind))_=g(_,E,c.typeAnnotation||"coerce");else if(this.checkSubtype(E,M))return null}else _=g(_,E,c.typeAnnotation||"assert")}if(!(_ instanceof ln)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){let E=new Gu;try{_=new ln(_.type,_.evaluate(E))}catch(M){return this.error(M.message),null}}return _}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,c,g){let m=typeof a=="number"?this.path.concat(a):this.path,b=g?this.scope.concat(g):this.scope;return new fa(this.registry,this._isConstant,m,c||null,b,this.errors)}error(a,...c){let g=`${this.key}${c.map(m=>`[${m}]`).join("")}`;this.errors.push(new Ei(g,a))}checkSubtype(a,c){let g=hl(a,c);return g&&this.error(g),g}}class dl{constructor(a,c){this.type=c.type,this.bindings=[].concat(a),this.result=c}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(let c of this.bindings)a(c[1]);a(this.result)}static parse(a,c){if(a.length<4)return c.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);let g=[];for(let b=1;b<a.length-1;b+=2){let _=a[b];if(typeof _!="string")return c.error(`Expected string, but found ${typeof _} instead.`,b);if(/[^a-zA-Z0-9_]/.test(_))return c.error("Variable names must contain only alphanumeric characters or '_'.",b);let E=c.parse(a[b+1],b+1);if(!E)return null;g.push([_,E])}let m=c.parse(a[a.length-1],a.length-1,c.expectedType,g);return m?new dl(g,m):null}outputDefined(){return this.result.outputDefined()}}class Mc{constructor(a,c){this.type=c.type,this.name=a,this.boundExpression=c}static parse(a,c){if(a.length!==2||typeof a[1]!="string")return c.error("'var' expression requires exactly one string literal argument.");let g=a[1];return c.scope.has(g)?new Mc(g,c.scope.get(g)):c.error(`Unknown variable "${g}". Make sure "${g}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}}class Tc{constructor(a,c,g){this.type=a,this.index=c,this.input=g}static parse(a,c){if(a.length!==3)return c.error(`Expected 2 arguments, but found ${a.length-1} instead.`);let g=c.parse(a[1],1,tt),m=c.parse(a[2],2,Ws(c.expectedType||Dt));return g&&m?new Tc(m.type.itemType,g,m):null}evaluate(a){let c=this.index.evaluate(a),g=this.input.evaluate(a);if(c<0)throw new oi(`Array index out of bounds: ${c} < 0.`);if(c>=g.length)throw new oi(`Array index out of bounds: ${c} > ${g.length-1}.`);if(c!==Math.floor(c))throw new oi(`Array index must be an integer, but found ${c} instead.`);return g[c]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}}class Dc{constructor(a,c){this.type=Ft,this.needle=a,this.haystack=c}static parse(a,c){if(a.length!==3)return c.error(`Expected 2 arguments, but found ${a.length-1} instead.`);let g=c.parse(a[1],1,Dt),m=c.parse(a[2],2,Dt);return g&&m?Lu(g.type,[Ft,At,tt,ca,Dt])?new Dc(g,m):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${si(g.type)} instead`):null}evaluate(a){let c=this.needle.evaluate(a),g=this.haystack.evaluate(a);if(!g)return!1;if(!An(c,["boolean","string","number","null"]))throw new oi(`Expected first argument to be of type boolean, string, number or null, but found ${si(yt(c))} instead.`);if(!An(g,["string","array"]))throw new oi(`Expected second argument to be of type array or string, but found ${si(yt(g))} instead.`);return g.indexOf(c)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}}class So{constructor(a,c,g){this.type=tt,this.needle=a,this.haystack=c,this.fromIndex=g}static parse(a,c){if(a.length<=2||a.length>=5)return c.error(`Expected 2 or 3 arguments, but found ${a.length-1} instead.`);let g=c.parse(a[1],1,Dt),m=c.parse(a[2],2,Dt);if(!g||!m)return null;if(!Lu(g.type,[Ft,At,tt,ca,Dt]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${si(g.type)} instead`);if(a.length===4){let b=c.parse(a[3],3,tt);return b?new So(g,m,b):null}return new So(g,m)}evaluate(a){let c=this.needle.evaluate(a),g=this.haystack.evaluate(a);if(!An(c,["boolean","string","number","null"]))throw new oi(`Expected first argument to be of type boolean, string, number or null, but found ${si(yt(c))} instead.`);let m;if(this.fromIndex&&(m=this.fromIndex.evaluate(a)),An(g,["string"])){let b=g.indexOf(c,m);return b===-1?-1:[...g.slice(0,b)].length}if(An(g,["array"]))return g.indexOf(c,m);throw new oi(`Expected second argument to be of type array or string, but found ${si(yt(g))} instead.`)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}}class ls{constructor(a,c,g,m,b,_){this.inputType=a,this.type=c,this.input=g,this.cases=m,this.outputs=b,this.otherwise=_}static parse(a,c){if(a.length<5)return c.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return c.error("Expected an even number of arguments.");let g,m;c.expectedType&&c.expectedType.kind!=="value"&&(m=c.expectedType);let b={},_=[];for(let F=2;F<a.length-1;F+=2){let A=a[F],z=a[F+1];Array.isArray(A)||(A=[A]);let N=c.concat(F);if(A.length===0)return N.error("Expected at least one branch label.");for(let j of A){if(typeof j!="number"&&typeof j!="string")return N.error("Branch labels must be numbers or strings.");if(typeof j=="number"&&Math.abs(j)>Number.MAX_SAFE_INTEGER)return N.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof j=="number"&&Math.floor(j)!==j)return N.error("Numeric branch labels must be integer values.");if(g){if(N.checkSubtype(g,yt(j)))return null}else g=yt(j);if(b[String(j)]!==void 0)return N.error("Branch labels must be unique.");b[String(j)]=_.length}let U=c.parse(z,F,m);if(!U)return null;m=m||U.type,_.push(U)}let E=c.parse(a[1],1,Dt);if(!E)return null;let M=c.parse(a[a.length-1],a.length-1,m);return M?E.type.kind!=="value"&&c.concat(1).checkSubtype(g,E.type)?null:new ls(g,m,E,b,_,M):null}evaluate(a){let c=this.input.evaluate(a);return(yt(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}}class ma{constructor(a,c,g){this.type=a,this.branches=c,this.otherwise=g}static parse(a,c){if(a.length<4)return c.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return c.error("Expected an odd number of arguments.");let g;c.expectedType&&c.expectedType.kind!=="value"&&(g=c.expectedType);let m=[];for(let _=1;_<a.length-1;_+=2){let E=c.parse(a[_],_,Ft);if(!E)return null;let M=c.parse(a[_+1],_+1,g);if(!M)return null;m.push([E,M]),g=g||M.type}let b=c.parse(a[a.length-1],a.length-1,g);if(!b)return null;if(!g)throw new Error("Can't infer output type");return new ma(g,m,b)}evaluate(a){for(let[c,g]of this.branches)if(c.evaluate(a))return g.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(let[c,g]of this.branches)a(c),a(g);a(this.otherwise)}outputDefined(){return this.branches.every(([a,c])=>c.outputDefined())&&this.otherwise.outputDefined()}}class pl{constructor(a,c,g,m){this.type=a,this.input=c,this.beginIndex=g,this.endIndex=m}static parse(a,c){if(a.length<=2||a.length>=5)return c.error(`Expected 2 or 3 arguments, but found ${a.length-1} instead.`);let g=c.parse(a[1],1,Dt),m=c.parse(a[2],2,tt);if(!g||!m)return null;if(!Lu(g.type,[Ws(Dt),At,Dt]))return c.error(`Expected first argument to be of type array or string, but found ${si(g.type)} instead`);if(a.length===4){let b=c.parse(a[3],3,tt);return b?new pl(g.type,g,m,b):null}return new pl(g.type,g,m)}evaluate(a){let c=this.input.evaluate(a),g=this.beginIndex.evaluate(a),m;if(this.endIndex&&(m=this.endIndex.evaluate(a)),An(c,["string"]))return[...c].slice(g,m).join("");if(An(c,["array"]))return c.slice(g,m);throw new oi(`Expected first argument to be of type array or string, but found ${si(yt(c))} instead.`)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}}function Cr(h,a){let c=h.length-1,g,m,b=0,_=c,E=0;for(;b<=_;)if(E=Math.floor((b+_)/2),g=h[E],m=h[E+1],g<=a){if(E===c||a<m)return E;b=E+1}else{if(!(g>a))throw new oi("Input is not a number.");_=E-1}return 0}class Ai{constructor(a,c,g){this.type=a,this.input=c,this.labels=[],this.outputs=[];for(let[m,b]of g)this.labels.push(m),this.outputs.push(b)}static parse(a,c){if(a.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return c.error("Expected an even number of arguments.");let g=c.parse(a[1],1,tt);if(!g)return null;let m=[],b=null;c.expectedType&&c.expectedType.kind!=="value"&&(b=c.expectedType);for(let _=1;_<a.length;_+=2){let E=_===1?-1/0:a[_],M=a[_+1],F=_,A=_+1;if(typeof E!="number")return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(m.length&&m[m.length-1][0]>=E)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',F);let z=c.parse(M,A,b);if(!z)return null;b=b||z.type,m.push([E,z])}return new Ai(b,g,m)}evaluate(a){let c=this.labels,g=this.outputs;if(c.length===1)return g[0].evaluate(a);let m=this.input.evaluate(a);if(m<=c[0])return g[0].evaluate(a);let b=c.length;return m>=c[b-1]?g[b-1].evaluate(a):g[Cr(c,m)].evaluate(a)}eachChild(a){a(this.input);for(let c of this.outputs)a(c)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function mg(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var gl,Wu,Lv=function(){if(Wu)return gl;function h(a,c,g,m){this.cx=3*a,this.bx=3*(g-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*c,this.by=3*(m-c)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=c,this.p2x=g,this.p2y=m}return Wu=1,gl=h,h.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,c){if(c===void 0&&(c=1e-6),a<0)return 0;if(a>1)return 1;for(var g=a,m=0;m<8;m++){var b=this.sampleCurveX(g)-a;if(Math.abs(b)<c)return g;var _=this.sampleCurveDerivativeX(g);if(Math.abs(_)<1e-6)break;g-=b/_}var E=0,M=1;for(g=a,m=0;m<20&&(b=this.sampleCurveX(g),!(Math.abs(b-a)<c));m++)a>b?E=g:M=g,g=.5*(M-E)+E;return g},solve:function(a,c){return this.sampleCurveY(this.solveCurveX(a,c))}},gl}(),va=mg(Lv);class ms{constructor(a,c,g,m,b){this.type=a,this.operator=c,this.interpolation=g,this.input=m,this.labels=[],this.outputs=[];for(let[_,E]of b)this.labels.push(_),this.outputs.push(E)}static interpolationFactor(a,c,g,m){let b=0;if(a.name==="exponential")b=fl(c,a.base,g,m);else if(a.name==="linear")b=fl(c,1,g,m);else if(a.name==="cubic-bezier"){let _=a.controlPoints;b=new va(_[0],_[1],_[2],_[3]).solve(fl(c,1,g,m))}return b}static parse(a,c){let[g,m,b,..._]=a;if(!Array.isArray(m)||m.length===0)return c.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){let F=m[1];if(typeof F!="number")return c.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:F}}else{if(m[0]!=="cubic-bezier")return c.error(`Unknown interpolation type ${String(m[0])}`,1,0);{let F=m.slice(1);if(F.length!==4||F.some(A=>typeof A!="number"||A<0||A>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:F}}}if(a.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(b=c.parse(b,2,tt),!b)return null;let E=[],M=null;g!=="interpolate-hcl"&&g!=="interpolate-lab"||c.expectedType==Wo?c.expectedType&&c.expectedType.kind!=="value"&&(M=c.expectedType):M=fs;for(let F=0;F<_.length;F+=2){let A=_[F],z=_[F+1],N=F+3,U=F+4;if(typeof A!="number")return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',N);if(E.length&&E[E.length-1][0]>=A)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',N);let j=c.parse(z,U,M);if(!j)return null;M=M||j.type,E.push([A,j])}return Ln(M,tt)||Ln(M,fr)||Ln(M,fs)||Ln(M,_c)||Ln(M,ha)||Ln(M,Wo)||Ln(M,Sc)||Ln(M,Ws(tt))?new ms(M,g,m,b,E):c.error(`Type ${si(M)} is not interpolatable.`)}evaluate(a){let c=this.labels,g=this.outputs;if(c.length===1)return g[0].evaluate(a);let m=this.input.evaluate(a);if(m<=c[0])return g[0].evaluate(a);let b=c.length;if(m>=c[b-1])return g[b-1].evaluate(a);let _=Cr(c,m),E=ms.interpolationFactor(this.interpolation,m,c[_],c[_+1]),M=g[_].evaluate(a),F=g[_+1].evaluate(a);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return an(M,F,E);case"color":return Ot.interpolate(M,F,E);case"padding":return as.interpolate(M,F,E);case"colorArray":return Zi.interpolate(M,F,E);case"numberArray":return Ds.interpolate(M,F,E);case"variableAnchorOffsetCollection":return Fs.interpolate(M,F,E);case"array":return vr(M,F,E);case"projectionDefinition":return xs.interpolate(M,F,E)}case"interpolate-hcl":switch(this.type.kind){case"color":return Ot.interpolate(M,F,E,"hcl");case"colorArray":return Zi.interpolate(M,F,E,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Ot.interpolate(M,F,E,"lab");case"colorArray":return Zi.interpolate(M,F,E,"lab")}}}eachChild(a){a(this.input);for(let c of this.outputs)a(c)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function fl(h,a,c,g){let m=g-c,b=h-c;return m===0?0:a===1?b/m:(Math.pow(a,b)-1)/(Math.pow(a,m)-1)}let $o={color:Ot.interpolate,number:an,padding:as.interpolate,numberArray:Ds.interpolate,colorArray:Zi.interpolate,variableAnchorOffsetCollection:Fs.interpolate,array:vr};class ml{constructor(a,c){this.type=a,this.args=c}static parse(a,c){if(a.length<2)return c.error("Expected at least one argument.");let g=null,m=c.expectedType;m&&m.kind!=="value"&&(g=m);let b=[];for(let E of a.slice(1)){let M=c.parse(E,1+b.length,g,void 0,{typeAnnotation:"omit"});if(!M)return null;g=g||M.type,b.push(M)}if(!g)throw new Error("No output type");let _=m&&b.some(E=>hl(m,E.type));return new ml(_?Dt:g,b)}evaluate(a){let c,g=null,m=0;for(let b of this.args)if(m++,g=b.evaluate(a),g&&g instanceof Ys&&!g.available&&(c||(c=g.name),g=null,m===this.args.length&&(g=c)),g!==null)break;return g}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}function vl(h,a){return h==="=="||h==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function yl(h,a,c,g){return g.compare(a,c)===0}function _s(h,a,c){let g=h!=="=="&&h!=="!=";return class _R{constructor(b,_,E){this.type=Ft,this.lhs=b,this.rhs=_,this.collator=E,this.hasUntypedArgument=b.type.kind==="value"||_.type.kind==="value"}static parse(b,_){if(b.length!==3&&b.length!==4)return _.error("Expected two or three arguments.");let E=b[0],M=_.parse(b[1],1,Dt);if(!M)return null;if(!vl(E,M.type))return _.concat(1).error(`"${E}" comparisons are not supported for type '${si(M.type)}'.`);let F=_.parse(b[2],2,Dt);if(!F)return null;if(!vl(E,F.type))return _.concat(2).error(`"${E}" comparisons are not supported for type '${si(F.type)}'.`);if(M.type.kind!==F.type.kind&&M.type.kind!=="value"&&F.type.kind!=="value")return _.error(`Cannot compare types '${si(M.type)}' and '${si(F.type)}'.`);g&&(M.type.kind==="value"&&F.type.kind!=="value"?M=new Qs(F.type,[M]):M.type.kind!=="value"&&F.type.kind==="value"&&(F=new Qs(M.type,[F])));let A=null;if(b.length===4){if(M.type.kind!=="string"&&F.type.kind!=="string"&&M.type.kind!=="value"&&F.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(A=_.parse(b[3],3,xc),!A)return null}return new _R(M,F,A)}evaluate(b){let _=this.lhs.evaluate(b),E=this.rhs.evaluate(b);if(g&&this.hasUntypedArgument){let M=yt(_),F=yt(E);if(M.kind!==F.kind||M.kind!=="string"&&M.kind!=="number")throw new oi(`Expected arguments for "${h}" to be (string, string) or (number, number), but found (${M.kind}, ${F.kind}) instead.`)}if(this.collator&&!g&&this.hasUntypedArgument){let M=yt(_),F=yt(E);if(M.kind!=="string"||F.kind!=="string")return a(b,_,E)}return this.collator?c(b,_,E,this.collator.evaluate(b)):a(b,_,E)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}}}let vg=_s("==",function(h,a,c){return a===c},yl),Fc=_s("!=",function(h,a,c){return a!==c},function(h,a,c,g){return!yl(0,a,c,g)}),Ov=_s("<",function(h,a,c){return a<c},function(h,a,c,g){return g.compare(a,c)<0}),Uu=_s(">",function(h,a,c){return a>c},function(h,a,c,g){return g.compare(a,c)>0}),zv=_s("<=",function(h,a,c){return a<=c},function(h,a,c,g){return g.compare(a,c)<=0}),Bv=_s(">=",function(h,a,c){return a>=c},function(h,a,c,g){return g.compare(a,c)>=0});class Ic{constructor(a,c,g){this.type=xc,this.locale=g,this.caseSensitive=a,this.diacriticSensitive=c}static parse(a,c){if(a.length!==2)return c.error("Expected one argument.");let g=a[1];if(typeof g!="object"||Array.isArray(g))return c.error("Collator options argument must be an object.");let m=c.parse(g["case-sensitive"]!==void 0&&g["case-sensitive"],1,Ft);if(!m)return null;let b=c.parse(g["diacritic-sensitive"]!==void 0&&g["diacritic-sensitive"],1,Ft);if(!b)return null;let _=null;return g.locale&&(_=c.parse(g.locale,1,At),!_)?null:new Ic(m,b,_)}evaluate(a){return new yr(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}}class ju{constructor(a,c,g,m,b){this.type=At,this.number=a,this.locale=c,this.currency=g,this.minFractionDigits=m,this.maxFractionDigits=b}static parse(a,c){if(a.length!==3)return c.error("Expected two arguments.");let g=c.parse(a[1],1,tt);if(!g)return null;let m=a[2];if(typeof m!="object"||Array.isArray(m))return c.error("NumberFormat options argument must be an object.");let b=null;if(m.locale&&(b=c.parse(m.locale,1,At),!b))return null;let _=null;if(m.currency&&(_=c.parse(m.currency,1,At),!_))return null;let E=null;if(m["min-fraction-digits"]&&(E=c.parse(m["min-fraction-digits"],1,tt),!E))return null;let M=null;return m["max-fraction-digits"]&&(M=c.parse(m["max-fraction-digits"],1,tt),!M)?null:new ju(g,b,_,E,M)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}}class br{constructor(a){this.type=kn,this.sections=a}static parse(a,c){if(a.length<2)return c.error("Expected at least one argument.");let g=a[1];if(!Array.isArray(g)&&typeof g=="object")return c.error("First argument must be an image or text section.");let m=[],b=!1;for(let _=1;_<=a.length-1;++_){let E=a[_];if(b&&typeof E=="object"&&!Array.isArray(E)){b=!1;let M=null;if(E["font-scale"]&&(M=c.parse(E["font-scale"],1,tt),!M))return null;let F=null;if(E["text-font"]&&(F=c.parse(E["text-font"],1,Ws(At)),!F))return null;let A=null;if(E["text-color"]&&(A=c.parse(E["text-color"],1,fs),!A))return null;let z=null;if(E["vertical-align"]){if(typeof E["vertical-align"]=="string"&&!Rc.includes(E["vertical-align"]))return c.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${E["vertical-align"]}' instead.`);if(z=c.parse(E["vertical-align"],1,At),!z)return null}let N=m[m.length-1];N.scale=M,N.font=F,N.textColor=A,N.verticalAlign=z}else{let M=c.parse(a[_],1,Dt);if(!M)return null;let F=M.type.kind;if(F!=="string"&&F!=="value"&&F!=="null"&&F!=="resolvedImage")return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,m.push({content:M,scale:null,font:null,textColor:null,verticalAlign:null})}}return new br(m)}evaluate(a){return new Ts(this.sections.map(c=>{let g=c.content.evaluate(a);return yt(g)===ki?new Ec("",g,null,null,null,c.verticalAlign?c.verticalAlign.evaluate(a):null):new Ec(Pt(g),null,c.scale?c.scale.evaluate(a):null,c.font?c.font.evaluate(a).join(","):null,c.textColor?c.textColor.evaluate(a):null,c.verticalAlign?c.verticalAlign.evaluate(a):null)}))}eachChild(a){for(let c of this.sections)a(c.content),c.scale&&a(c.scale),c.font&&a(c.font),c.textColor&&a(c.textColor),c.verticalAlign&&a(c.verticalAlign)}outputDefined(){return!1}}class $u{constructor(a){this.type=ki,this.input=a}static parse(a,c){if(a.length!==2)return c.error("Expected two arguments.");let g=c.parse(a[1],1,At);return g?new $u(g):c.error("No image name provided.")}evaluate(a){let c=this.input.evaluate(a),g=Ys.fromString(c);return g&&a.availableImages&&(g.available=a.availableImages.indexOf(c)>-1),g}eachChild(a){a(this.input)}outputDefined(){return!1}}class kc{constructor(a){this.type=tt,this.input=a}static parse(a,c){if(a.length!==2)return c.error(`Expected 1 argument, but found ${a.length-1} instead.`);let g=c.parse(a[1],1);return g?g.type.kind!=="array"&&g.type.kind!=="string"&&g.type.kind!=="value"?c.error(`Expected argument of type string or array, but found ${si(g.type)} instead.`):new kc(g):null}evaluate(a){let c=this.input.evaluate(a);if(typeof c=="string")return[...c].length;if(Array.isArray(c))return c.length;throw new oi(`Expected value to be of type string or array, but found ${si(yt(c))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}}let Ro=8192;function Vv(h,a){let c=(180+h[0])/360,g=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h[1]*Math.PI/360)))/360,m=Math.pow(2,a.z);return[Math.round(c*m*Ro),Math.round(g*m*Ro)]}function Ac(h,a){let c=Math.pow(2,a.z);return[(m=(h[0]/Ro+a.x)/c,360*m-180),(g=(h[1]/Ro+a.y)/c,360/Math.PI*Math.atan(Math.exp((180-360*g)*Math.PI/180))-90)];var g,m}function wl(h,a){h[0]=Math.min(h[0],a[0]),h[1]=Math.min(h[1],a[1]),h[2]=Math.max(h[2],a[0]),h[3]=Math.max(h[3],a[1])}function Cl(h,a){return!(h[0]<=a[0]||h[2]>=a[2]||h[1]<=a[1]||h[3]>=a[3])}function Hv(h,a,c){let g=h[0]-a[0],m=h[1]-a[1],b=h[0]-c[0],_=h[1]-c[1];return g*_-b*m==0&&g*b<=0&&m*_<=0}function Lc(h,a,c,g){return(m=[g[0]-c[0],g[1]-c[1]])[0]*(b=[a[0]-h[0],a[1]-h[1]])[1]-m[1]*b[0]!=0&&!(!wg(h,a,c,g)||!wg(c,g,h,a));var m,b}function Nv(h,a,c){for(let g of c)for(let m=0;m<g.length-1;++m)if(Lc(h,a,g[m],g[m+1]))return!0;return!1}function xr(h,a,c=!1){let g=!1;for(let E of a)for(let M=0;M<E.length-1;M++){if(Hv(h,E[M],E[M+1]))return c;(b=E[M])[1]>(m=h)[1]!=(_=E[M+1])[1]>m[1]&&m[0]<(_[0]-b[0])*(m[1]-b[1])/(_[1]-b[1])+b[0]&&(g=!g)}var m,b,_;return g}function yg(h,a){for(let c of a)if(xr(h,c))return!0;return!1}function qu(h,a){for(let c of h)if(!xr(c,a))return!1;for(let c=0;c<h.length-1;++c)if(Nv(h[c],h[c+1],a))return!1;return!0}function Gv(h,a){for(let c of a)if(qu(h,c))return!0;return!1}function wg(h,a,c,g){let m=g[0]-c[0],b=g[1]-c[1],_=(h[0]-c[0])*b-m*(h[1]-c[1]),E=(a[0]-c[0])*b-m*(a[1]-c[1]);return _>0&&E<0||_<0&&E>0}function Zu(h,a,c){let g=[];for(let m=0;m<h.length;m++){let b=[];for(let _=0;_<h[m].length;_++){let E=Vv(h[m][_],c);wl(a,E),b.push(E)}g.push(b)}return g}function Cg(h,a,c){let g=[];for(let m=0;m<h.length;m++){let b=Zu(h[m],a,c);g.push(b)}return g}function Oc(h,a,c,g){if(h[0]<c[0]||h[0]>c[2]){let m=.5*g,b=h[0]-c[0]>m?-g:c[0]-h[0]>m?g:0;b===0&&(b=h[0]-c[2]>m?-g:c[2]-h[0]>m?g:0),h[0]+=b}wl(a,h)}function bg(h,a,c,g){let m=Math.pow(2,g.z)*Ro,b=[g.x*Ro,g.y*Ro],_=[];for(let E of h)for(let M of E){let F=[M.x+b[0],M.y+b[1]];Oc(F,a,c,m),_.push(F)}return _}function xg(h,a,c,g){let m=Math.pow(2,g.z)*Ro,b=[g.x*Ro,g.y*Ro],_=[];for(let M of h){let F=[];for(let A of M){let z=[A.x+b[0],A.y+b[1]];wl(a,z),F.push(z)}_.push(F)}if(a[2]-a[0]<=m/2){(E=a)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(let M of _)for(let F of M)Oc(F,a,c,m)}var E;return _}class _r{constructor(a,c){this.type=Ft,this.geojson=a,this.geometries=c}static parse(a,c){if(a.length!==2)return c.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(wr(a[1])){let g=a[1];if(g.type==="FeatureCollection"){let m=[];for(let b of g.features){let{type:_,coordinates:E}=b.geometry;_==="Polygon"&&m.push(E),_==="MultiPolygon"&&m.push(...E)}if(m.length)return new _r(g,{type:"MultiPolygon",coordinates:m})}else if(g.type==="Feature"){let m=g.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new _r(g,g.geometry)}else if(g.type==="Polygon"||g.type==="MultiPolygon")return new _r(g,g)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(c,g){let m=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],_=c.canonicalID();if(g.type==="Polygon"){let E=Zu(g.coordinates,b,_),M=bg(c.geometry(),m,b,_);if(!Cl(m,b))return!1;for(let F of M)if(!xr(F,E))return!1}if(g.type==="MultiPolygon"){let E=Cg(g.coordinates,b,_),M=bg(c.geometry(),m,b,_);if(!Cl(m,b))return!1;for(let F of M)if(!yg(F,E))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(c,g){let m=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],_=c.canonicalID();if(g.type==="Polygon"){let E=Zu(g.coordinates,b,_),M=xg(c.geometry(),m,b,_);if(!Cl(m,b))return!1;for(let F of M)if(!qu(F,E))return!1}if(g.type==="MultiPolygon"){let E=Cg(g.coordinates,b,_),M=xg(c.geometry(),m,b,_);if(!Cl(m,b))return!1;for(let F of M)if(!Gv(F,E))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Ku=class{constructor(h=[],a=(c,g)=>c<g?-1:c>g?1:0){if(this.data=h,this.length=this.data.length,this.compare=a,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(h){this.data.push(h),this._up(this.length++)}pop(){if(this.length===0)return;let h=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),h}peek(){return this.data[0]}_up(h){let{data:a,compare:c}=this,g=a[h];for(;h>0;){let m=h-1>>1,b=a[m];if(c(g,b)>=0)break;a[h]=b,h=m}a[h]=g}_down(h){let{data:a,compare:c}=this,g=this.length>>1,m=a[h];for(;h<g;){let b=1+(h<<1),_=b+1;if(_<this.length&&c(a[_],a[b])<0&&(b=_),c(a[b],m)>=0)break;a[h]=a[b],h=b}a[h]=m}};function Xu(h,a,c=0,g=h.length-1,m=Wv){for(;g>c;){if(g-c>600){let M=g-c+1,F=a-c+1,A=Math.log(M),z=.5*Math.exp(2*A/3),N=.5*Math.sqrt(A*z*(M-z)/M)*(F-M/2<0?-1:1);Xu(h,a,Math.max(c,Math.floor(a-F*z/M+N)),Math.min(g,Math.floor(a+(M-F)*z/M+N)),m)}let b=h[a],_=c,E=g;for(bl(h,c,a),m(h[g],b)>0&&bl(h,c,g);_<E;){for(bl(h,_,E),_++,E--;m(h[_],b)<0;)_++;for(;m(h[E],b)>0;)E--}m(h[c],b)===0?bl(h,c,E):(E++,bl(h,E,g)),E<=a&&(c=E+1),a<=E&&(g=E-1)}}function bl(h,a,c){let g=h[a];h[a]=h[c],h[c]=g}function Wv(h,a){return h<a?-1:h>a?1:0}function xl(h,a){if(h.length<=1)return[h];let c=[],g,m;for(let b of h){let _=Uv(b);_!==0&&(b.area=Math.abs(_),m===void 0&&(m=_<0),m===_<0?(g&&c.push(g),g=[b]):g.push(b))}if(g&&c.push(g),a>1)for(let b=0;b<c.length;b++)c[b].length<=a||(Xu(c[b],a,1,c[b].length-1,_g),c[b]=c[b].slice(0,a));return c}function _g(h,a){return a.area-h.area}function Uv(h){let a=0;for(let c,g,m=0,b=h.length,_=b-1;m<b;_=m++)c=h[m],g=h[_],a+=(g.x-c.x)*(c.y+g.y);return a}let Sg=1/298.257223563,Rg=Sg*(2-Sg),Yu=Math.PI/180;class Qu{constructor(a){let c=6378.137*Yu*1e3,g=Math.cos(a*Yu),m=1/(1-Rg*(1-g*g)),b=Math.sqrt(m);this.kx=c*b*g,this.ky=c*b*m*(1-Rg)}distance(a,c){let g=this.wrap(a[0]-c[0])*this.kx,m=(a[1]-c[1])*this.ky;return Math.sqrt(g*g+m*m)}pointOnLine(a,c){let g,m,b,_,E=1/0;for(let M=0;M<a.length-1;M++){let F=a[M][0],A=a[M][1],z=this.wrap(a[M+1][0]-F)*this.kx,N=(a[M+1][1]-A)*this.ky,U=0;z===0&&N===0||(U=(this.wrap(c[0]-F)*this.kx*z+(c[1]-A)*this.ky*N)/(z*z+N*N),U>1?(F=a[M+1][0],A=a[M+1][1]):U>0&&(F+=z/this.kx*U,A+=N/this.ky*U)),z=this.wrap(c[0]-F)*this.kx,N=(c[1]-A)*this.ky;let j=z*z+N*N;j<E&&(E=j,g=F,m=A,b=M,_=U)}return{point:[g,m],index:b,t:Math.max(0,Math.min(1,_))}}wrap(a){for(;a<-180;)a+=360;for(;a>180;)a-=360;return a}}function Eg(h,a){return a[0]-h[0]}function zc(h){return h[1]-h[0]+1}function cn(h,a){return h[1]>=h[0]&&h[1]<a}function Kt(h,a){if(h[0]>h[1])return[null,null];let c=zc(h);if(a){if(c===2)return[h,null];let m=Math.floor(c/2);return[[h[0],h[0]+m],[h[0]+m,h[1]]]}if(c===1)return[h,null];let g=Math.floor(c/2)-1;return[[h[0],h[0]+g],[h[0]+g+1,h[1]]]}function Ju(h,a){if(!cn(a,h.length))return[1/0,1/0,-1/0,-1/0];let c=[1/0,1/0,-1/0,-1/0];for(let g=a[0];g<=a[1];++g)wl(c,h[g]);return c}function ed(h){let a=[1/0,1/0,-1/0,-1/0];for(let c of h)for(let g of c)wl(a,g);return a}function Pg(h){return h[0]!==-1/0&&h[1]!==-1/0&&h[2]!==1/0&&h[3]!==1/0}function td(h,a,c){if(!Pg(h)||!Pg(a))return NaN;let g=0,m=0;return h[2]<a[0]&&(g=a[0]-h[2]),h[0]>a[2]&&(g=h[0]-a[2]),h[1]>a[3]&&(m=h[1]-a[3]),h[3]<a[1]&&(m=a[1]-h[3]),c.distance([0,0],[g,m])}function Sr(h,a,c){let g=c.pointOnLine(a,h);return c.distance(h,g.point)}function id(h,a,c,g,m){let b=Math.min(Sr(h,[c,g],m),Sr(a,[c,g],m)),_=Math.min(Sr(c,[h,a],m),Sr(g,[h,a],m));return Math.min(b,_)}function jv(h,a,c,g,m){if(!cn(a,h.length)||!cn(g,c.length))return 1/0;let b=1/0;for(let _=a[0];_<a[1];++_){let E=h[_],M=h[_+1];for(let F=g[0];F<g[1];++F){let A=c[F],z=c[F+1];if(Lc(E,M,A,z))return 0;b=Math.min(b,id(E,M,A,z,m))}}return b}function $v(h,a,c,g,m){if(!cn(a,h.length)||!cn(g,c.length))return NaN;let b=1/0;for(let _=a[0];_<=a[1];++_)for(let E=g[0];E<=g[1];++E)if(b=Math.min(b,m.distance(h[_],c[E])),b===0)return b;return b}function qv(h,a,c){if(xr(h,a,!0))return 0;let g=1/0;for(let m of a){let b=m[0],_=m[m.length-1];if(b!==_&&(g=Math.min(g,Sr(h,[_,b],c)),g===0))return g;let E=c.pointOnLine(m,h);if(g=Math.min(g,c.distance(h,E.point)),g===0)return g}return g}function Zv(h,a,c,g){if(!cn(a,h.length))return NaN;for(let b=a[0];b<=a[1];++b)if(xr(h[b],c,!0))return 0;let m=1/0;for(let b=a[0];b<a[1];++b){let _=h[b],E=h[b+1];for(let M of c)for(let F=0,A=M.length,z=A-1;F<A;z=F++){let N=M[z],U=M[F];if(Lc(_,E,N,U))return 0;m=Math.min(m,id(_,E,N,U,g))}}return m}function Mg(h,a){for(let c of h)for(let g of c)if(xr(g,a,!0))return!0;return!1}function Kv(h,a,c,g=1/0){let m=ed(h),b=ed(a);if(g!==1/0&&td(m,b,c)>=g)return g;if(Cl(m,b)){if(Mg(h,a))return 0}else if(Mg(a,h))return 0;let _=1/0;for(let E of h)for(let M=0,F=E.length,A=F-1;M<F;A=M++){let z=E[A],N=E[M];for(let U of a)for(let j=0,K=U.length,J=K-1;j<K;J=j++){let se=U[J],Ce=U[j];if(Lc(z,N,se,Ce))return 0;_=Math.min(_,id(z,N,se,Ce,c))}}return _}function Tg(h,a,c,g,m,b){if(!b)return;let _=td(Ju(g,b),m,c);_<a&&h.push([_,b,[0,0]])}function Bc(h,a,c,g,m,b,_){if(!b||!_)return;let E=td(Ju(g,b),Ju(m,_),c);E<a&&h.push([E,b,_])}function Vc(h,a,c,g,m=1/0){let b=Math.min(g.distance(h[0],c[0][0]),m);if(b===0)return b;let _=new Ku([[0,[0,h.length-1],[0,0]]],Eg),E=ed(c);for(;_.length>0;){let M=_.pop();if(M[0]>=b)continue;let F=M[1],A=a?50:100;if(zc(F)<=A){if(!cn(F,h.length))return NaN;if(a){let z=Zv(h,F,c,g);if(isNaN(z)||z===0)return z;b=Math.min(b,z)}else for(let z=F[0];z<=F[1];++z){let N=qv(h[z],c,g);if(b=Math.min(b,N),b===0)return 0}}else{let z=Kt(F,a);Tg(_,b,g,h,E,z[0]),Tg(_,b,g,h,E,z[1])}}return b}function Hc(h,a,c,g,m,b=1/0){let _=Math.min(b,m.distance(h[0],c[0]));if(_===0)return _;let E=new Ku([[0,[0,h.length-1],[0,c.length-1]]],Eg);for(;E.length>0;){let M=E.pop();if(M[0]>=_)continue;let F=M[1],A=M[2],z=a?50:100,N=g?50:100;if(zc(F)<=z&&zc(A)<=N){if(!cn(F,h.length)&&cn(A,c.length))return NaN;let U;if(a&&g)U=jv(h,F,c,A,m),_=Math.min(_,U);else if(a&&!g){let j=h.slice(F[0],F[1]+1);for(let K=A[0];K<=A[1];++K)if(U=Sr(c[K],j,m),_=Math.min(_,U),_===0)return _}else if(!a&&g){let j=c.slice(A[0],A[1]+1);for(let K=F[0];K<=F[1];++K)if(U=Sr(h[K],j,m),_=Math.min(_,U),_===0)return _}else U=$v(h,F,c,A,m),_=Math.min(_,U)}else{let U=Kt(F,a),j=Kt(A,g);Bc(E,_,m,h,c,U[0],j[0]),Bc(E,_,m,h,c,U[0],j[1]),Bc(E,_,m,h,c,U[1],j[0]),Bc(E,_,m,h,c,U[1],j[1])}}return _}function sd(h){return h.type==="MultiPolygon"?h.coordinates.map(a=>({type:"Polygon",coordinates:a})):h.type==="MultiLineString"?h.coordinates.map(a=>({type:"LineString",coordinates:a})):h.type==="MultiPoint"?h.coordinates.map(a=>({type:"Point",coordinates:a})):[h]}class Rr{constructor(a,c){this.type=tt,this.geojson=a,this.geometries=c}static parse(a,c){if(a.length!==2)return c.error(`'distance' expression requires exactly one argument, but found ${a.length-1} instead.`);if(wr(a[1])){let g=a[1];if(g.type==="FeatureCollection")return new Rr(g,g.features.map(m=>sd(m.geometry)).flat());if(g.type==="Feature")return new Rr(g,sd(g.geometry));if("type"in g&&"coordinates"in g)return new Rr(g,sd(g))}return c.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(c,g){let m=c.geometry(),b=m.flat().map(M=>Ac([M.x,M.y],c.canonical));if(m.length===0)return NaN;let _=new Qu(b[0][1]),E=1/0;for(let M of g){switch(M.type){case"Point":E=Math.min(E,Hc(b,!1,[M.coordinates],!1,_,E));break;case"LineString":E=Math.min(E,Hc(b,!1,M.coordinates,!0,_,E));break;case"Polygon":E=Math.min(E,Vc(b,!1,M.coordinates,_,E))}if(E===0)return E}return E}(a,this.geometries);if(a.geometryType()==="LineString")return function(c,g){let m=c.geometry(),b=m.flat().map(M=>Ac([M.x,M.y],c.canonical));if(m.length===0)return NaN;let _=new Qu(b[0][1]),E=1/0;for(let M of g){switch(M.type){case"Point":E=Math.min(E,Hc(b,!0,[M.coordinates],!1,_,E));break;case"LineString":E=Math.min(E,Hc(b,!0,M.coordinates,!0,_,E));break;case"Polygon":E=Math.min(E,Vc(b,!0,M.coordinates,_,E))}if(E===0)return E}return E}(a,this.geometries);if(a.geometryType()==="Polygon")return function(c,g){let m=c.geometry();if(m.length===0||m[0].length===0)return NaN;let b=xl(m,0).map(M=>M.map(F=>F.map(A=>Ac([A.x,A.y],c.canonical)))),_=new Qu(b[0][0][0][1]),E=1/0;for(let M of g)for(let F of b){switch(M.type){case"Point":E=Math.min(E,Vc([M.coordinates],!1,F,_,E));break;case"LineString":E=Math.min(E,Vc(M.coordinates,!0,F,_,E));break;case"Polygon":E=Math.min(E,Kv(F,M.coordinates,_,E))}if(E===0)return E}return E}(a,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class _l{constructor(a){this.type=Dt,this.key=a}static parse(a,c){if(a.length!==2)return c.error(`Expected 1 argument, but found ${a.length-1} instead.`);let g=a[1];return g==null?c.error("Global state property must be defined."):typeof g!="string"?c.error(`Global state property must be string, but found ${typeof a[1]} instead.`):new _l(g)}evaluate(a){var c;let g=(c=a.globals)===null||c===void 0?void 0:c.globalState;return g&&Object.keys(g).length!==0?ga(g,this.key):null}eachChild(){}outputDefined(){return!1}}let ya={"==":vg,"!=":Fc,">":Uu,"<":Ov,">=":Bv,"<=":zv,array:Qs,at:Tc,boolean:Qs,case:ma,coalesce:ml,collator:Ic,format:br,image:$u,in:Dc,"index-of":So,interpolate:ms,"interpolate-hcl":ms,"interpolate-lab":ms,length:kc,let:dl,literal:ln,match:ls,number:Qs,"number-format":ju,object:Qs,slice:pl,step:Ai,string:Qs,"to-boolean":jo,"to-color":jo,"to-number":jo,"to-string":jo,var:Mc,within:_r,distance:Rr,"global-state":_l};class ao{constructor(a,c,g,m){this.name=a,this.type=c,this._evaluate=g,this.args=m}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}static parse(a,c){let g=a[0],m=ao.definitions[g];if(!m)return c.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0);let b=Array.isArray(m)?m[0]:m.type,_=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,E=_.filter(([F])=>!Array.isArray(F)||F.length===a.length-1),M=null;for(let[F,A]of E){M=new fa(c.registry,Nc,c.path,null,c.scope);let z=[],N=!1;for(let U=1;U<a.length;U++){let j=a[U],K=Array.isArray(F)?F[U-1]:F.type,J=M.parse(j,1+z.length,K);if(!J){N=!0;break}z.push(J)}if(!N)if(Array.isArray(F)&&F.length!==z.length)M.error(`Expected ${F.length} arguments, but found ${z.length} instead.`);else{for(let U=0;U<z.length;U++){let j=Array.isArray(F)?F[U]:F.type,K=z[U];M.concat(U+1).checkSubtype(j,K.type)}if(M.errors.length===0)return new ao(g,b,A,z)}}if(E.length===1)c.errors.push(...M.errors);else{let F=(E.length?E:_).map(([z])=>{return N=z,Array.isArray(N)?`(${N.map(si).join(", ")})`:`(${si(N.type)}...)`;var N}).join(" | "),A=[];for(let z=1;z<a.length;z++){let N=c.parse(a[z],1+A.length);if(!N)return null;A.push(si(N.type))}c.error(`Expected arguments of type ${F}, but found (${A.join(", ")}) instead.`)}return null}static register(a,c){ao.definitions=c;for(let g in c)a[g]=ao}}function Dg(h,[a,c,g,m]){a=a.evaluate(h),c=c.evaluate(h),g=g.evaluate(h);let b=m?m.evaluate(h):1,_=pi(a,c,g,b);if(_)throw new oi(_);return new Ot(a/255,c/255,g/255,b,!1)}function Fg(h,a){return h in a}function od(h,a){let c=a[h];return c===void 0?null:c}function Er(h){return{type:h}}function Nc(h){if(h instanceof Mc)return Nc(h.boundExpression);if(h instanceof ao&&h.name==="error"||h instanceof Ic||h instanceof _r||h instanceof Rr||h instanceof _l)return!1;let a=h instanceof jo||h instanceof Qs,c=!0;return h.eachChild(g=>{c=a?c&&Nc(g):c&&g instanceof ln}),!!c&&Gc(h)&&Wc(h,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Gc(h){if(h instanceof ao&&(h.name==="get"&&h.args.length===1||h.name==="feature-state"||h.name==="has"&&h.args.length===1||h.name==="properties"||h.name==="geometry-type"||h.name==="id"||/^filter-/.test(h.name))||h instanceof _r||h instanceof Rr)return!1;let a=!0;return h.eachChild(c=>{a&&!Gc(c)&&(a=!1)}),a}function Sl(h){if(h instanceof ao&&h.name==="feature-state")return!1;let a=!0;return h.eachChild(c=>{a&&!Sl(c)&&(a=!1)}),a}function Wc(h,a){if(h instanceof ao&&a.indexOf(h.name)>=0)return!1;let c=!0;return h.eachChild(g=>{c&&!Wc(g,a)&&(c=!1)}),c}function Ig(h){return{result:"success",value:h}}function wa(h){return{result:"error",value:h}}function zn(h){return h["property-type"]==="data-driven"||h["property-type"]==="cross-faded-data-driven"}function kg(h){return!!h.expression&&h.expression.parameters.indexOf("zoom")>-1}function nd(h){return!!h.expression&&h.expression.interpolated}function Vt(h){return h instanceof Number?"number":h instanceof String?"string":h instanceof Boolean?"boolean":Array.isArray(h)?"array":h===null?"null":typeof h}function Rl(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)&&yt(h)===In}function Xv(h){return h}function Ag(h,a){let c=h.stops&&typeof h.stops[0][0]=="object",g=c||!(c||h.property!==void 0),m=h.type||(nd(a)?"exponential":"interval"),b=function(A){switch(A.type){case"color":return Ot.parse;case"padding":return as.parse;case"numberArray":return Ds.parse;case"colorArray":return Zi.parse;default:return null}}(a);if(b&&((h=bs({},h)).stops&&(h.stops=h.stops.map(A=>[A[0],b(A[1])])),h.default=b(h.default?h.default:a.default)),h.colorSpace&&(_=h.colorSpace)!=="rgb"&&_!=="hcl"&&_!=="lab")throw new Error(`Unknown color space: "${h.colorSpace}"`);var _;let E=function(A){switch(A){case"exponential":return Og;case"interval":return Yv;case"categorical":return Lg;case"identity":return Qv;default:throw new Error(`Unknown function type "${A}"`)}}(m),M,F;if(m==="categorical"){M=Object.create(null);for(let A of h.stops)M[A[0]]=A[1];F=typeof h.stops[0][0]}if(c){let A={},z=[];for(let j=0;j<h.stops.length;j++){let K=h.stops[j],J=K[0].zoom;A[J]===void 0&&(A[J]={zoom:J,type:h.type,property:h.property,default:h.default,stops:[]},z.push(J)),A[J].stops.push([K[0].value,K[1]])}let N=[];for(let j of z)N.push([A[j].zoom,Ag(A[j],a)]);let U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:ms.interpolationFactor.bind(void 0,U),zoomStops:N.map(j=>j[0]),evaluate:({zoom:j},K)=>Og({stops:N,base:h.base},a,j).evaluate(j,K)}}if(g){let A=m==="exponential"?{name:"exponential",base:h.base!==void 0?h.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:ms.interpolationFactor.bind(void 0,A),zoomStops:h.stops.map(z=>z[0]),evaluate:({zoom:z})=>E(h,a,z,M,F)}}return{kind:"source",evaluate(A,z){let N=z&&z.properties?z.properties[h.property]:void 0;return N===void 0?Bn(h.default,a.default):E(h,a,N,M,F)}}}function Bn(h,a,c){return h!==void 0?h:a!==void 0?a:c!==void 0?c:void 0}function Lg(h,a,c,g,m){return Bn(typeof c===m?g[c]:void 0,h.default,a.default)}function Yv(h,a,c){if(Vt(c)!=="number")return Bn(h.default,a.default);let g=h.stops.length;if(g===1||c<=h.stops[0][0])return h.stops[0][1];if(c>=h.stops[g-1][0])return h.stops[g-1][1];let m=Cr(h.stops.map(b=>b[0]),c);return h.stops[m][1]}function Og(h,a,c){let g=h.base!==void 0?h.base:1;if(Vt(c)!=="number")return Bn(h.default,a.default);let m=h.stops.length;if(m===1||c<=h.stops[0][0])return h.stops[0][1];if(c>=h.stops[m-1][0])return h.stops[m-1][1];let b=Cr(h.stops.map(A=>A[0]),c),_=function(A,z,N,U){let j=U-N,K=A-N;return j===0?0:z===1?K/j:(Math.pow(z,K)-1)/(Math.pow(z,j)-1)}(c,g,h.stops[b][0],h.stops[b+1][0]),E=h.stops[b][1],M=h.stops[b+1][1],F=$o[a.type]||Xv;return typeof E.evaluate=="function"?{evaluate(...A){let z=E.evaluate.apply(void 0,A),N=M.evaluate.apply(void 0,A);if(z!==void 0&&N!==void 0)return F(z,N,_,h.colorSpace)}}:F(E,M,_,h.colorSpace)}function Qv(h,a,c){switch(a.type){case"color":c=Ot.parse(c);break;case"formatted":c=Ts.fromString(c.toString());break;case"resolvedImage":c=Ys.fromString(c.toString());break;case"padding":c=as.parse(c);break;case"colorArray":c=Zi.parse(c);break;case"numberArray":c=Ds.parse(c);break;default:Vt(c)===a.type||a.type==="enum"&&a.values[c]||(c=void 0)}return Bn(c,h.default,a.default)}ao.register(ya,{error:[{kind:"error"},[At],(h,[a])=>{throw new oi(a.evaluate(h))}],typeof:[At,[Dt],(h,[a])=>si(yt(a.evaluate(h)))],"to-rgba":[Ws(tt,4),[fs],(h,[a])=>{let[c,g,m,b]=a.evaluate(h).rgb;return[255*c,255*g,255*m,b]}],rgb:[fs,[tt,tt,tt],Dg],rgba:[fs,[tt,tt,tt,tt],Dg],has:{type:Ft,overloads:[[[At],(h,[a])=>Fg(a.evaluate(h),h.properties())],[[At,In],(h,[a,c])=>Fg(a.evaluate(h),c.evaluate(h))]]},get:{type:Dt,overloads:[[[At],(h,[a])=>od(a.evaluate(h),h.properties())],[[At,In],(h,[a,c])=>od(a.evaluate(h),c.evaluate(h))]]},"feature-state":[Dt,[At],(h,[a])=>od(a.evaluate(h),h.featureState||{})],properties:[In,[],h=>h.properties()],"geometry-type":[At,[],h=>h.geometryType()],id:[Dt,[],h=>h.id()],zoom:[tt,[],h=>h.globals.zoom],"heatmap-density":[tt,[],h=>h.globals.heatmapDensity||0],elevation:[tt,[],h=>h.globals.elevation||0],"line-progress":[tt,[],h=>h.globals.lineProgress||0],accumulated:[Dt,[],h=>h.globals.accumulated===void 0?null:h.globals.accumulated],"+":[tt,Er(tt),(h,a)=>{let c=0;for(let g of a)c+=g.evaluate(h);return c}],"*":[tt,Er(tt),(h,a)=>{let c=1;for(let g of a)c*=g.evaluate(h);return c}],"-":{type:tt,overloads:[[[tt,tt],(h,[a,c])=>a.evaluate(h)-c.evaluate(h)],[[tt],(h,[a])=>-a.evaluate(h)]]},"/":[tt,[tt,tt],(h,[a,c])=>a.evaluate(h)/c.evaluate(h)],"%":[tt,[tt,tt],(h,[a,c])=>a.evaluate(h)%c.evaluate(h)],ln2:[tt,[],()=>Math.LN2],pi:[tt,[],()=>Math.PI],e:[tt,[],()=>Math.E],"^":[tt,[tt,tt],(h,[a,c])=>Math.pow(a.evaluate(h),c.evaluate(h))],sqrt:[tt,[tt],(h,[a])=>Math.sqrt(a.evaluate(h))],log10:[tt,[tt],(h,[a])=>Math.log(a.evaluate(h))/Math.LN10],ln:[tt,[tt],(h,[a])=>Math.log(a.evaluate(h))],log2:[tt,[tt],(h,[a])=>Math.log(a.evaluate(h))/Math.LN2],sin:[tt,[tt],(h,[a])=>Math.sin(a.evaluate(h))],cos:[tt,[tt],(h,[a])=>Math.cos(a.evaluate(h))],tan:[tt,[tt],(h,[a])=>Math.tan(a.evaluate(h))],asin:[tt,[tt],(h,[a])=>Math.asin(a.evaluate(h))],acos:[tt,[tt],(h,[a])=>Math.acos(a.evaluate(h))],atan:[tt,[tt],(h,[a])=>Math.atan(a.evaluate(h))],min:[tt,Er(tt),(h,a)=>Math.min(...a.map(c=>c.evaluate(h)))],max:[tt,Er(tt),(h,a)=>Math.max(...a.map(c=>c.evaluate(h)))],abs:[tt,[tt],(h,[a])=>Math.abs(a.evaluate(h))],round:[tt,[tt],(h,[a])=>{let c=a.evaluate(h);return c<0?-Math.round(-c):Math.round(c)}],floor:[tt,[tt],(h,[a])=>Math.floor(a.evaluate(h))],ceil:[tt,[tt],(h,[a])=>Math.ceil(a.evaluate(h))],"filter-==":[Ft,[At,Dt],(h,[a,c])=>h.properties()[a.value]===c.value],"filter-id-==":[Ft,[Dt],(h,[a])=>h.id()===a.value],"filter-type-==":[Ft,[At],(h,[a])=>h.geometryType()===a.value],"filter-<":[Ft,[At,Dt],(h,[a,c])=>{let g=h.properties()[a.value],m=c.value;return typeof g==typeof m&&g<m}],"filter-id-<":[Ft,[Dt],(h,[a])=>{let c=h.id(),g=a.value;return typeof c==typeof g&&c<g}],"filter->":[Ft,[At,Dt],(h,[a,c])=>{let g=h.properties()[a.value],m=c.value;return typeof g==typeof m&&g>m}],"filter-id->":[Ft,[Dt],(h,[a])=>{let c=h.id(),g=a.value;return typeof c==typeof g&&c>g}],"filter-<=":[Ft,[At,Dt],(h,[a,c])=>{let g=h.properties()[a.value],m=c.value;return typeof g==typeof m&&g<=m}],"filter-id-<=":[Ft,[Dt],(h,[a])=>{let c=h.id(),g=a.value;return typeof c==typeof g&&c<=g}],"filter->=":[Ft,[At,Dt],(h,[a,c])=>{let g=h.properties()[a.value],m=c.value;return typeof g==typeof m&&g>=m}],"filter-id->=":[Ft,[Dt],(h,[a])=>{let c=h.id(),g=a.value;return typeof c==typeof g&&c>=g}],"filter-has":[Ft,[Dt],(h,[a])=>a.value in h.properties()],"filter-has-id":[Ft,[],h=>h.id()!==null&&h.id()!==void 0],"filter-type-in":[Ft,[Ws(At)],(h,[a])=>a.value.indexOf(h.geometryType())>=0],"filter-id-in":[Ft,[Ws(Dt)],(h,[a])=>a.value.indexOf(h.id())>=0],"filter-in-small":[Ft,[At,Ws(Dt)],(h,[a,c])=>c.value.indexOf(h.properties()[a.value])>=0],"filter-in-large":[Ft,[At,Ws(Dt)],(h,[a,c])=>function(g,m,b,_){for(;b<=_;){let E=b+_>>1;if(m[E]===g)return!0;m[E]>g?_=E-1:b=E+1}return!1}(h.properties()[a.value],c.value,0,c.value.length-1)],all:{type:Ft,overloads:[[[Ft,Ft],(h,[a,c])=>a.evaluate(h)&&c.evaluate(h)],[Er(Ft),(h,a)=>{for(let c of a)if(!c.evaluate(h))return!1;return!0}]]},any:{type:Ft,overloads:[[[Ft,Ft],(h,[a,c])=>a.evaluate(h)||c.evaluate(h)],[Er(Ft),(h,a)=>{for(let c of a)if(c.evaluate(h))return!0;return!1}]]},"!":[Ft,[Ft],(h,[a])=>!a.evaluate(h)],"is-supported-script":[Ft,[At],(h,[a])=>{let c=h.globals&&h.globals.isSupportedScript;return!c||c(a.evaluate(h))}],upcase:[At,[At],(h,[a])=>a.evaluate(h).toUpperCase()],downcase:[At,[At],(h,[a])=>a.evaluate(h).toLowerCase()],concat:[At,Er(Dt),(h,a)=>a.map(c=>Pt(c.evaluate(h))).join("")],"resolved-locale":[At,[xc],(h,[a])=>a.evaluate(h).resolvedLocale()]});class rd{constructor(a,c,g){this.expression=a,this._warningHistory={},this._evaluator=new Gu,this._defaultValue=c?function(m){if(m.type==="color"&&Rl(m.default))return new Ot(0,0,0,0);switch(m.type){case"color":return Ot.parse(m.default)||null;case"padding":return as.parse(m.default)||null;case"numberArray":return Ds.parse(m.default)||null;case"colorArray":return Zi.parse(m.default)||null;case"variableAnchorOffsetCollection":return Fs.parse(m.default)||null;case"projectionDefinition":return xs.parse(m.default)||null;default:return m.default===void 0?null:m.default}}(c):null,this._enumValues=c&&c.type==="enum"?c.values:null,this._globalState=g}evaluateWithoutErrorHandling(a,c,g,m,b,_){return this._globalState&&(a=Pr(a,this._globalState)),this._evaluator.globals=a,this._evaluator.feature=c,this._evaluator.featureState=g,this._evaluator.canonical=m,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(a,c,g,m,b,_){this._globalState&&(a=Pr(a,this._globalState)),this._evaluator.globals=a,this._evaluator.feature=c||null,this._evaluator.featureState=g||null,this._evaluator.canonical=m,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=_||null;try{let E=this.expression.evaluate(this._evaluator);if(E==null||typeof E=="number"&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new oi(`Expected value to be one of ${Object.keys(this._enumValues).map(M=>JSON.stringify(M)).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}}}function Uc(h){return Array.isArray(h)&&h.length>0&&typeof h[0]=="string"&&h[0]in ya}function El(h,a,c){let g=new fa(ya,Nc,[],a?function(b){let _={color:fs,string:At,number:tt,enum:At,boolean:Ft,formatted:kn,padding:_c,numberArray:ha,colorArray:Wo,projectionDefinition:fr,resolvedImage:ki,variableAnchorOffsetCollection:Sc};return b.type==="array"?Ws(_[b.value]||Dt,b.length):_[b.type]}(a):void 0),m=g.parse(h,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?Ig(new rd(m,a,c)):wa(g.errors)}class Pl{constructor(a,c,g){this.kind=a,this._styleExpression=c,this.isStateDependent=a!=="constant"&&!Sl(c.expression),this.globalStateRefs=Dl(c.expression),this._globalState=g}evaluateWithoutErrorHandling(a,c,g,m,b,_){return this._globalState&&(a=Pr(a,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(a,c,g,m,b,_)}evaluate(a,c,g,m,b,_){return this._globalState&&(a=Pr(a,this._globalState)),this._styleExpression.evaluate(a,c,g,m,b,_)}}class ad{constructor(a,c,g,m,b){this.kind=a,this.zoomStops=g,this._styleExpression=c,this.isStateDependent=a!=="camera"&&!Sl(c.expression),this.globalStateRefs=Dl(c.expression),this.interpolationType=m,this._globalState=b}evaluateWithoutErrorHandling(a,c,g,m,b,_){return this._globalState&&(a=Pr(a,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(a,c,g,m,b,_)}evaluate(a,c,g,m,b,_){return this._globalState&&(a=Pr(a,this._globalState)),this._styleExpression.evaluate(a,c,g,m,b,_)}interpolationFactor(a,c,g){return this.interpolationType?ms.interpolationFactor(this.interpolationType,a,c,g):0}}function zg(h,a,c){let g=El(h,a,c);if(g.result==="error")return g;let m=g.value.expression,b=Gc(m);if(!b&&!zn(a))return wa([new Ei("","data expressions not supported")]);let _=Wc(m,["zoom"]);if(!_&&!kg(a))return wa([new Ei("","zoom expressions not supported")]);let E=Tl(m);return E||_?E instanceof Ei?wa([E]):E instanceof ms&&!nd(a)?wa([new Ei("",'"interpolate" expressions cannot be used with this property')]):Ig(E?new ad(b?"camera":"composite",g.value,E.labels,E instanceof ms?E.interpolation:void 0,c):new Pl(b?"constant":"source",g.value,c)):wa([new Ei("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ml{constructor(a,c){this._parameters=a,this._specification=c,bs(this,Ag(this._parameters,this._specification))}static deserialize(a){return new Ml(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function Tl(h){let a=null;if(h instanceof dl)a=Tl(h.result);else if(h instanceof ml){for(let c of h.args)if(a=Tl(c),a)break}else(h instanceof Ai||h instanceof ms)&&h.input instanceof ao&&h.input.name==="zoom"&&(a=h);return a instanceof Ei||h.eachChild(c=>{let g=Tl(c);g instanceof Ei?a=g:!a&&g?a=new Ei("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&g&&a!==g&&(a=new Ei("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}function Dl(h,a=new Set){return h instanceof _l&&a.add(h.key),h.eachChild(c=>{Dl(c,a)}),a}function Pr(h,a){let{zoom:c,heatmapDensity:g,elevation:m,lineProgress:b,isSupportedScript:_,accumulated:E}=h??{};return{zoom:c,heatmapDensity:g,elevation:m,lineProgress:b,isSupportedScript:_,accumulated:E,globalState:a}}function Fl(h){if(h===!0||h===!1)return!0;if(!Array.isArray(h)||h.length===0)return!1;switch(h[0]){case"has":return h.length>=2&&h[1]!=="$id"&&h[1]!=="$type";case"in":return h.length>=3&&(typeof h[1]!="string"||Array.isArray(h[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return h.length!==3||Array.isArray(h[1])||Array.isArray(h[2]);case"any":case"all":for(let a of h.slice(1))if(!Fl(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}let ld={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Mr(h,a){if(h==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Fl(h)||(h=jc(h));let c=El(h,ld,a);if(c.result==="error")throw new Error(c.value.map(g=>`${g.key}: ${g.message}`).join(", "));return{filter:(g,m,b)=>c.value.evaluate(g,m,{},b),needGeometry:Il(h),getGlobalStateRefs:()=>Dl(c.value.expression)}}function cd(h,a){return h<a?-1:h>a?1:0}function Il(h){if(!Array.isArray(h))return!1;if(h[0]==="within"||h[0]==="distance")return!0;for(let a=1;a<h.length;a++)if(Il(h[a]))return!0;return!1}function jc(h){if(!h)return!0;let a=h[0];return h.length<=1?a!=="any":a==="=="?hd(h[1],h[2],"=="):a==="!="?$c(hd(h[1],h[2],"==")):a==="<"||a===">"||a==="<="||a===">="?hd(h[1],h[2],a):a==="any"?(c=h.slice(1),["any"].concat(c.map(jc))):a==="all"?["all"].concat(h.slice(1).map(jc)):a==="none"?["all"].concat(h.slice(1).map(jc).map($c)):a==="in"?Bg(h[1],h.slice(2)):a==="!in"?$c(Bg(h[1],h.slice(2))):a==="has"?Vg(h[1]):a!=="!has"||$c(Vg(h[1]));var c}function hd(h,a,c){switch(h){case"$type":return[`filter-type-${c}`,a];case"$id":return[`filter-id-${c}`,a];default:return[`filter-${c}`,h,a]}}function Bg(h,a){if(a.length===0)return!1;switch(h){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(c=>typeof c!=typeof a[0])?["filter-in-large",h,["literal",a.sort(cd)]]:["filter-in-small",h,["literal",a]]}}function Vg(h){switch(h){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",h]}}function $c(h){return["!",h]}function ud(h){let a=typeof h;if(a==="number"||a==="boolean"||a==="string"||h==null)return JSON.stringify(h);if(Array.isArray(h)){let m="[";for(let b of h)m+=`${ud(b)},`;return`${m}]`}let c=Object.keys(h).sort(),g="{";for(let m=0;m<c.length;m++)g+=`${JSON.stringify(c[m])}:${ud(h[c[m]])},`;return`${g}}`}function Hg(h){let a="";for(let c of Rt)a+=`/${ud(h[c])}`;return a}function dd(h){let a=h.value;return a?[new $e(h.key,a,"constants have been deprecated as of v8")]:[]}function mi(h){return h instanceof Number||h instanceof String||h instanceof Boolean?h.valueOf():h}function Tr(h){if(Array.isArray(h))return h.map(Tr);if(h instanceof Object&&!(h instanceof Number||h instanceof String||h instanceof Boolean)){let a={};for(let c in h)a[c]=Tr(h[c]);return a}return mi(h)}function Js(h){let a=h.key,c=h.value,g=h.valueSpec||{},m=h.objectElementValidators||{},b=h.style,_=h.styleSpec,E=h.validateSpec,M=[],F=Vt(c);if(F!=="object")return[new $e(a,c,`object expected, ${F} found`)];for(let A in c){let z=A.split(".")[0],N=ga(g,z)||g["*"],U;if(ga(m,z))U=m[z];else if(ga(g,z))U=E;else if(m["*"])U=m["*"];else{if(!g["*"]){M.push(new $e(a,c[A],`unknown property "${A}"`));continue}U=E}M=M.concat(U({key:(a&&`${a}.`)+A,value:c[A],valueSpec:N,style:b,styleSpec:_,object:c,objectKey:A,validateSpec:E},c))}for(let A in g)m[A]||g[A].required&&g[A].default===void 0&&c[A]===void 0&&M.push(new $e(a,c,`missing required property "${A}"`));return M}function qc(h){let a=h.value,c=h.valueSpec,g=h.style,m=h.styleSpec,b=h.key,_=h.arrayElementValidator||h.validateSpec;if(Vt(a)!=="array")return[new $e(b,a,`array expected, ${Vt(a)} found`)];if(c.length&&a.length!==c.length)return[new $e(b,a,`array length ${c.length} expected, length ${a.length} found`)];if(c["min-length"]&&a.length<c["min-length"])return[new $e(b,a,`array length at least ${c["min-length"]} expected, length ${a.length} found`)];let E={type:c.value,values:c.values};m.$version<7&&(E.function=c.function),Vt(c.value)==="object"&&(E=c.value);let M=[];for(let F=0;F<a.length;F++)M=M.concat(_({array:a,arrayIndex:F,value:a[F],valueSpec:E,validateSpec:h.validateSpec,style:g,styleSpec:m,key:`${b}[${F}]`}));return M}function Zc(h){let a=h.key,c=h.value,g=h.valueSpec,m=Vt(c);return m==="number"&&c!=c&&(m="NaN"),m!=="number"?[new $e(a,c,`number expected, ${m} found`)]:"minimum"in g&&c<g.minimum?[new $e(a,c,`${c} is less than the minimum value ${g.minimum}`)]:"maximum"in g&&c>g.maximum?[new $e(a,c,`${c} is greater than the maximum value ${g.maximum}`)]:[]}function pd(h){let a=h.valueSpec,c=mi(h.value.type),g,m,b,_={},E=c!=="categorical"&&h.value.property===void 0,M=!E,F=Vt(h.value.stops)==="array"&&Vt(h.value.stops[0])==="array"&&Vt(h.value.stops[0][0])==="object",A=Js({key:h.key,value:h.value,valueSpec:h.styleSpec.function,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(U){if(c==="identity")return[new $e(U.key,U.value,'identity function may not have a "stops" property')];let j=[],K=U.value;return j=j.concat(qc({key:U.key,value:K,valueSpec:U.valueSpec,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:z})),Vt(K)==="array"&&K.length===0&&j.push(new $e(U.key,K,"array must have at least one stop")),j},default:function(U){return U.validateSpec({key:U.key,value:U.value,valueSpec:a,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec})}}});return c==="identity"&&E&&A.push(new $e(h.key,h.value,'missing required property "property"')),c==="identity"||h.value.stops||A.push(new $e(h.key,h.value,'missing required property "stops"')),c==="exponential"&&h.valueSpec.expression&&!nd(h.valueSpec)&&A.push(new $e(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&(M&&!zn(h.valueSpec)?A.push(new $e(h.key,h.value,"property functions not supported")):E&&!kg(h.valueSpec)&&A.push(new $e(h.key,h.value,"zoom functions not supported"))),c!=="categorical"&&!F||h.value.property!==void 0||A.push(new $e(h.key,h.value,'"property" property is required')),A;function z(U){let j=[],K=U.value,J=U.key;if(Vt(K)!=="array")return[new $e(J,K,`array expected, ${Vt(K)} found`)];if(K.length!==2)return[new $e(J,K,`array length 2 expected, length ${K.length} found`)];if(F){if(Vt(K[0])!=="object")return[new $e(J,K,`object expected, ${Vt(K[0])} found`)];if(K[0].zoom===void 0)return[new $e(J,K,"object stop key must have zoom")];if(K[0].value===void 0)return[new $e(J,K,"object stop key must have value")];if(b&&b>mi(K[0].zoom))return[new $e(J,K[0].zoom,"stop zoom values must appear in ascending order")];mi(K[0].zoom)!==b&&(b=mi(K[0].zoom),m=void 0,_={}),j=j.concat(Js({key:`${J}[0]`,value:K[0],valueSpec:{zoom:{}},validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:Zc,value:N}}))}else j=j.concat(N({key:`${J}[0]`,value:K[0],validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec},K));return Uc(Tr(K[1]))?j.concat([new $e(`${J}[1]`,K[1],"expressions are not allowed in function stops.")]):j.concat(U.validateSpec({key:`${J}[1]`,value:K[1],valueSpec:a,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec}))}function N(U,j){let K=Vt(U.value),J=mi(U.value),se=U.value!==null?U.value:j;if(g){if(K!==g)return[new $e(U.key,se,`${K} stop domain type must match previous stop domain type ${g}`)]}else g=K;if(K!=="number"&&K!=="string"&&K!=="boolean")return[new $e(U.key,se,"stop domain value must be a number, string, or boolean")];if(K!=="number"&&c!=="categorical"){let Ce=`number expected, ${K} found`;return zn(a)&&c===void 0&&(Ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $e(U.key,se,Ce)]}return c!=="categorical"||K!=="number"||isFinite(J)&&Math.floor(J)===J?c!=="categorical"&&K==="number"&&m!==void 0&&J<m?[new $e(U.key,se,"stop domain values must appear in ascending order")]:(m=J,c==="categorical"&&J in _?[new $e(U.key,se,"stop domain values must be unique")]:(_[J]=!0,[])):[new $e(U.key,se,`integer expected, found ${J}`)]}}function Dr(h){let a=(h.expressionContext==="property"?zg:El)(Tr(h.value),h.valueSpec);if(a.result==="error")return a.value.map(g=>new $e(`${h.key}${g.key}`,h.value,g.message));let c=a.value.expression||a.value._styleExpression.expression;if(h.expressionContext==="property"&&h.propertyKey==="text-font"&&!c.outputDefined())return[new $e(h.key,h.value,`Invalid data expression for "${h.propertyKey}". Output values must be contained as literals within the expression.`)];if(h.expressionContext==="property"&&h.propertyType==="layout"&&!Sl(c))return[new $e(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if(h.expressionContext==="filter"&&!Sl(c))return[new $e(h.key,h.value,'"feature-state" data expressions are not supported with filters.')];if(h.expressionContext&&h.expressionContext.indexOf("cluster")===0){if(!Wc(c,["zoom","feature-state"]))return[new $e(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(h.expressionContext==="cluster-initial"&&!Gc(c))return[new $e(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Fr(h){let a=h.key,c=h.value,g=Vt(c);return g!=="string"?[new $e(a,c,`color expected, ${g} found`)]:Ot.parse(String(c))?[]:[new $e(a,c,`color expected, "${c}" found`)]}function kl(h){let a=h.key,c=h.value,g=h.valueSpec,m=[];return Array.isArray(g.values)?g.values.indexOf(mi(c))===-1&&m.push(new $e(a,c,`expected one of [${g.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(g.values).indexOf(mi(c))===-1&&m.push(new $e(a,c,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(c)} found`)),m}function gd(h){return Fl(Tr(h.value))?Dr(bs({},h,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ng(h)}function Ng(h){let a=h.value,c=h.key;if(Vt(a)!=="array")return[new $e(c,a,`array expected, ${Vt(a)} found`)];let g=h.styleSpec,m,b=[];if(a.length<1)return[new $e(c,a,"filter array must have at least 1 element")];switch(b=b.concat(kl({key:`${c}[0]`,value:a[0],valueSpec:g.filter_operator,style:h.style,styleSpec:h.styleSpec})),mi(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&mi(a[1])==="$type"&&b.push(new $e(c,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&b.push(new $e(c,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(m=Vt(a[1]),m!=="string"&&b.push(new $e(`${c}[1]`,a[1],`string expected, ${m} found`)));for(let _=2;_<a.length;_++)m=Vt(a[_]),mi(a[1])==="$type"?b=b.concat(kl({key:`${c}[${_}]`,value:a[_],valueSpec:g.geometry_type,style:h.style,styleSpec:h.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&b.push(new $e(`${c}[${_}]`,a[_],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let _=1;_<a.length;_++)b=b.concat(Ng({key:`${c}[${_}]`,value:a[_],style:h.style,styleSpec:h.styleSpec}));break;case"has":case"!has":m=Vt(a[1]),a.length!==2?b.push(new $e(c,a,`filter array for "${a[0]}" operator must have 2 elements`)):m!=="string"&&b.push(new $e(`${c}[1]`,a[1],`string expected, ${m} found`))}return b}function Gg(h,a){let c=h.key,g=h.validateSpec,m=h.style,b=h.styleSpec,_=h.value,E=h.objectKey,M=b[`${a}_${h.layerType}`];if(!M)return[];let F=E.match(/^(.*)-transition$/);if(a==="paint"&&F&&M[F[1]]&&M[F[1]].transition)return g({key:c,value:_,valueSpec:b.transition,style:m,styleSpec:b});let A=h.valueSpec||M[E];if(!A)return[new $e(c,_,`unknown property "${E}"`)];let z;if(Vt(_)==="string"&&zn(A)&&!A.tokens&&(z=/^{([^}]+)}$/.exec(_)))return[new $e(c,_,`"${E}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(z[1])} }\`.`)];let N=[];return h.layerType==="symbol"&&(E==="text-field"&&m&&!m.glyphs&&N.push(new $e(c,_,'use of "text-field" requires a style "glyphs" property')),E==="text-font"&&Rl(Tr(_))&&mi(_.type)==="identity"&&N.push(new $e(c,_,'"text-font" does not support identity functions'))),N.concat(g({key:h.key,value:_,valueSpec:A,style:m,styleSpec:b,expressionContext:"property",propertyType:a,propertyKey:E}))}function Wg(h){return Gg(h,"paint")}function Ug(h){return Gg(h,"layout")}function Ca(h){let a=[],c=h.value,g=h.key,m=h.style,b=h.styleSpec;if(Vt(c)!=="object")return[new $e(g,c,`object expected, ${Vt(c)} found`)];c.type||c.ref||a.push(new $e(g,c,'either "type" or "ref" is required'));let _=mi(c.type),E=mi(c.ref);if(c.id){let M=mi(c.id);for(let F=0;F<h.arrayIndex;F++){let A=m.layers[F];mi(A.id)===M&&a.push(new $e(g,c.id,`duplicate layer id "${c.id}", previously used at line ${A.id.__line__}`))}}if("ref"in c){let M;["type","source","source-layer","filter","layout"].forEach(F=>{F in c&&a.push(new $e(g,c[F],`"${F}" is prohibited for ref layers`))}),m.layers.forEach(F=>{mi(F.id)===E&&(M=F)}),M?M.ref?a.push(new $e(g,c.ref,"ref cannot reference another ref layer")):_=mi(M.type):a.push(new $e(g,c.ref,`ref layer "${E}" not found`))}else if(_!=="background")if(c.source){let M=m.sources&&m.sources[c.source],F=M&&mi(M.type);M?F==="vector"&&_==="raster"?a.push(new $e(g,c.source,`layer "${c.id}" requires a raster source`)):F!=="raster-dem"&&_==="hillshade"||F!=="raster-dem"&&_==="color-relief"?a.push(new $e(g,c.source,`layer "${c.id}" requires a raster-dem source`)):F==="raster"&&_!=="raster"?a.push(new $e(g,c.source,`layer "${c.id}" requires a vector source`)):F!=="vector"||c["source-layer"]?F==="raster-dem"&&_!=="hillshade"&&_!=="color-relief"?a.push(new $e(g,c.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):_!=="line"||!c.paint||!c.paint["line-gradient"]||F==="geojson"&&M.lineMetrics||a.push(new $e(g,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new $e(g,c,`layer "${c.id}" must specify a "source-layer"`)):a.push(new $e(g,c.source,`source "${c.source}" not found`))}else a.push(new $e(g,c,'missing required property "source"'));return a=a.concat(Js({key:g,value:c,valueSpec:b.layer,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,objectElementValidators:{"*":()=>[],type:()=>h.validateSpec({key:`${g}.type`,value:c.type,valueSpec:b.layer.type,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,object:c,objectKey:"type"}),filter:gd,layout:M=>Js({layer:c,key:M.key,value:M.value,style:M.style,styleSpec:M.styleSpec,validateSpec:M.validateSpec,objectElementValidators:{"*":F=>Ug(bs({layerType:_},F))}}),paint:M=>Js({layer:c,key:M.key,value:M.value,style:M.style,styleSpec:M.styleSpec,validateSpec:M.validateSpec,objectElementValidators:{"*":F=>Wg(bs({layerType:_},F))}})}})),a}function Eo(h){let a=h.value,c=h.key,g=Vt(a);return g!=="string"?[new $e(c,a,`string expected, ${g} found`)]:[]}let Us={promoteId:function({key:h,value:a}){if(Vt(a)==="string")return Eo({key:h,value:a});{let c=[];for(let g in a)c.push(...Eo({key:`${h}.${g}`,value:a[g]}));return c}}};function ba(h){let a=h.value,c=h.key,g=h.styleSpec,m=h.style,b=h.validateSpec;if(!a.type)return[new $e(c,a,'"type" is required')];let _=mi(a.type),E;switch(_){case"vector":case"raster":return E=Js({key:c,value:a,valueSpec:g[`source_${_.replace("-","_")}`],style:h.style,styleSpec:g,objectElementValidators:Us,validateSpec:b}),E;case"raster-dem":return E=function(M){var F;let A=(F=M.sourceName)!==null&&F!==void 0?F:"",z=M.value,N=M.styleSpec,U=N.source_raster_dem,j=M.style,K=[],J=Vt(z);if(z===void 0)return K;if(J!=="object")return K.push(new $e("source_raster_dem",z,`object expected, ${J} found`)),K;let se=mi(z.encoding)==="custom",Ce=["redFactor","greenFactor","blueFactor","baseShift"],ce=M.value.encoding?`"${M.value.encoding}"`:"Default";for(let pe in z)!se&&Ce.includes(pe)?K.push(new $e(pe,z[pe],`In "${A}": "${pe}" is only valid when "encoding" is set to "custom". ${ce} encoding found`)):U[pe]?K=K.concat(M.validateSpec({key:pe,value:z[pe],valueSpec:U[pe],validateSpec:M.validateSpec,style:j,styleSpec:N})):K.push(new $e(pe,z[pe],`unknown property "${pe}"`));return K}({sourceName:c,value:a,style:h.style,styleSpec:g,validateSpec:b}),E;case"geojson":if(E=Js({key:c,value:a,valueSpec:g.source_geojson,style:m,styleSpec:g,validateSpec:b,objectElementValidators:Us}),a.cluster)for(let M in a.clusterProperties){let[F,A]=a.clusterProperties[M],z=typeof F=="string"?[F,["accumulated"],["get",M]]:F;E.push(...Dr({key:`${c}.${M}.map`,value:A,expressionContext:"cluster-map"})),E.push(...Dr({key:`${c}.${M}.reduce`,value:z,expressionContext:"cluster-reduce"}))}return E;case"video":return Js({key:c,value:a,valueSpec:g.source_video,style:m,validateSpec:b,styleSpec:g});case"image":return Js({key:c,value:a,valueSpec:g.source_image,style:m,validateSpec:b,styleSpec:g});case"canvas":return[new $e(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return kl({key:`${c}.type`,value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function fd(h){let a=h.value,c=h.styleSpec,g=c.light,m=h.style,b=[],_=Vt(a);if(a===void 0)return b;if(_!=="object")return b=b.concat([new $e("light",a,`object expected, ${_} found`)]),b;for(let E in a){let M=E.match(/^(.*)-transition$/);b=b.concat(M&&g[M[1]]&&g[M[1]].transition?h.validateSpec({key:E,value:a[E],valueSpec:c.transition,validateSpec:h.validateSpec,style:m,styleSpec:c}):g[E]?h.validateSpec({key:E,value:a[E],valueSpec:g[E],validateSpec:h.validateSpec,style:m,styleSpec:c}):[new $e(E,a[E],`unknown property "${E}"`)])}return b}function jg(h){let a=h.value,c=h.styleSpec,g=c.sky,m=h.style,b=Vt(a);if(a===void 0)return[];if(b!=="object")return[new $e("sky",a,`object expected, ${b} found`)];let _=[];for(let E in a)_=_.concat(g[E]?h.validateSpec({key:E,value:a[E],valueSpec:g[E],style:m,styleSpec:c}):[new $e(E,a[E],`unknown property "${E}"`)]);return _}function $g(h){let a=h.value,c=h.styleSpec,g=c.terrain,m=h.style,b=[],_=Vt(a);if(a===void 0)return b;if(_!=="object")return b=b.concat([new $e("terrain",a,`object expected, ${_} found`)]),b;for(let E in a)b=b.concat(g[E]?h.validateSpec({key:E,value:a[E],valueSpec:g[E],validateSpec:h.validateSpec,style:m,styleSpec:c}):[new $e(E,a[E],`unknown property "${E}"`)]);return b}function xa(h){let a=[],c=h.value,g=h.key;if(Array.isArray(c)){let m=[],b=[];for(let _ in c)c[_].id&&m.includes(c[_].id)&&a.push(new $e(g,c,`all the sprites' ids must be unique, but ${c[_].id} is duplicated`)),m.push(c[_].id),c[_].url&&b.includes(c[_].url)&&a.push(new $e(g,c,`all the sprites' URLs must be unique, but ${c[_].url} is duplicated`)),b.push(c[_].url),a=a.concat(Js({key:`${g}[${_}]`,value:c[_],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:h.validateSpec}));return a}return Eo({key:g,value:c})}function md(h){return a=h.value,a&&a.constructor===Object?[]:[new $e(h.key,h.value,`object expected, ${Vt(h.value)} found`)];var a}let Kc={"*":()=>[],array:qc,boolean:function(h){let a=h.value,c=h.key,g=Vt(a);return g!=="boolean"?[new $e(c,a,`boolean expected, ${g} found`)]:[]},number:Zc,color:Fr,constants:dd,enum:kl,filter:gd,function:pd,layer:Ca,object:Js,source:ba,light:fd,sky:jg,terrain:$g,projection:function(h){let a=h.value,c=h.styleSpec,g=c.projection,m=h.style,b=Vt(a);if(a===void 0)return[];if(b!=="object")return[new $e("projection",a,`object expected, ${b} found`)];let _=[];for(let E in a)_=_.concat(g[E]?h.validateSpec({key:E,value:a[E],valueSpec:g[E],style:m,styleSpec:c}):[new $e(E,a[E],`unknown property "${E}"`)]);return _},projectionDefinition:function(h){let a=h.key,c=h.value;c=c instanceof String?c.valueOf():c;let g=Vt(c);return g!=="array"||function(m){return Array.isArray(m)&&m.length===3&&typeof m[0]=="string"&&typeof m[1]=="string"&&typeof m[2]=="number"}(c)||function(m){return!!["interpolate","step","literal"].includes(m[0])}(c)?["array","string"].includes(g)?[]:[new $e(a,c,`projection expected, invalid type "${g}" found`)]:[new $e(a,c,`projection expected, invalid array ${JSON.stringify(c)} found`)]},string:Eo,formatted:function(h){return Eo(h).length===0?[]:Dr(h)},resolvedImage:function(h){return Eo(h).length===0?[]:Dr(h)},padding:function(h){let a=h.key,c=h.value;if(Vt(c)==="array"){if(c.length<1||c.length>4)return[new $e(a,c,`padding requires 1 to 4 values; ${c.length} values found`)];let g={type:"number"},m=[];for(let b=0;b<c.length;b++)m=m.concat(h.validateSpec({key:`${a}[${b}]`,value:c[b],validateSpec:h.validateSpec,valueSpec:g}));return m}return Zc({key:a,value:c,valueSpec:{}})},numberArray:function(h){let a=h.key,c=h.value;if(Vt(c)==="array"){let g={type:"number"};if(c.length<1)return[new $e(a,c,"array length at least 1 expected, length 0 found")];let m=[];for(let b=0;b<c.length;b++)m=m.concat(h.validateSpec({key:`${a}[${b}]`,value:c[b],validateSpec:h.validateSpec,valueSpec:g}));return m}return Zc({key:a,value:c,valueSpec:{}})},colorArray:function(h){let a=h.key,c=h.value;if(Vt(c)==="array"){if(c.length<1)return[new $e(a,c,"array length at least 1 expected, length 0 found")];let g=[];for(let m=0;m<c.length;m++)g=g.concat(Fr({key:`${a}[${m}]`,value:c[m]}));return g}return Fr({key:a,value:c})},variableAnchorOffsetCollection:function(h){let a=h.key,c=h.value,g=Vt(c),m=h.styleSpec;if(g!=="array"||c.length<1||c.length%2!=0)return[new $e(a,c,"variableAnchorOffsetCollection requires a non-empty array of even length")];let b=[];for(let _=0;_<c.length;_+=2)b=b.concat(kl({key:`${a}[${_}]`,value:c[_],valueSpec:m.layout_symbol["text-anchor"]})),b=b.concat(qc({key:`${a}[${_+1}]`,value:c[_+1],valueSpec:{length:2,value:"number"},validateSpec:h.validateSpec,style:h.style,styleSpec:m}));return b},sprite:xa,state:md};function Xc(h){let a=h.value,c=h.valueSpec,g=h.styleSpec;return h.validateSpec=Xc,c.expression&&Rl(mi(a))?pd(h):c.expression&&Uc(Tr(a))?Dr(h):c.type&&Kc[c.type]?Kc[c.type](h):Js(bs({},h,{valueSpec:c.type?g[c.type]:c}))}function Yc(h){let a=h.value,c=h.key,g=Eo(h);return g.length||(a.indexOf("{fontstack}")===-1&&g.push(new $e(c,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&g.push(new $e(c,a,'"glyphs" url must include a "{range}" token'))),g}function lo(h,a=xe){let c=[];return c=c.concat(Xc({key:"",value:h,valueSpec:a.$root,styleSpec:a,style:h,validateSpec:Xc,objectElementValidators:{glyphs:Yc,"*":()=>[]}})),h.constants&&(c=c.concat(dd({key:"constants",value:h.constants}))),qg(c)}function Is(h){return function(a){return h(ht(Se({},a),{validateSpec:Xc}))}}function qg(h){return[].concat(h).sort((a,c)=>a.line-c.line)}function Po(h){return function(...a){return qg(h.apply(this,a))}}lo.source=Po(Is(ba)),lo.sprite=Po(Is(xa)),lo.glyphs=Po(Is(Yc)),lo.light=Po(Is(fd)),lo.sky=Po(Is(jg)),lo.terrain=Po(Is($g)),lo.state=Po(Is(md)),lo.layer=Po(Is(Ca)),lo.filter=Po(Is(gd)),lo.paintProperty=Po(Is(Wg)),lo.layoutProperty=Po(Is(Ug));let _a=lo,Al=_a.light,Jv=_a.sky,ey=_a.paintProperty,Qc=_a.layoutProperty;function Zg(h,a){let c=!1;if(a&&a.length)for(let g of a)h.fire(new Ve(new Error(g.message))),c=!0;return c}class Ir{constructor(a,c,g){let m=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;let _=new Int32Array(this.arrayBuffer);a=_[0],this.d=(c=_[1])+2*(g=_[2]);for(let M=0;M<this.d*this.d;M++){let F=_[3+M],A=_[3+M+1];m.push(F===A?null:_.subarray(F,A))}let E=_[3+m.length+1];this.keys=_.subarray(_[3+m.length],E),this.bboxes=_.subarray(E),this.insert=this._insertReadonly}else{this.d=c+2*g;for(let _=0;_<this.d*this.d;_++)m.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=a,this.padding=g,this.scale=c/a,this.uid=0;let b=g/c*a;this.min=-b,this.max=a+b}insert(a,c,g,m,b){this._forEachCell(c,g,m,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(a),this.bboxes.push(c),this.bboxes.push(g),this.bboxes.push(m),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(a,c,g,m,b,_){this.cells[b].push(_)}query(a,c,g,m,b){let _=this.min,E=this.max;if(a<=_&&c<=_&&E<=g&&E<=m&&!b)return Array.prototype.slice.call(this.keys);{let M=[];return this._forEachCell(a,c,g,m,this._queryCell,M,{},b),M}}_queryCell(a,c,g,m,b,_,E,M){let F=this.cells[b];if(F!==null){let A=this.keys,z=this.bboxes;for(let N=0;N<F.length;N++){let U=F[N];if(E[U]===void 0){let j=4*U;(M?M(z[j+0],z[j+1],z[j+2],z[j+3]):a<=z[j+2]&&c<=z[j+3]&&g>=z[j+0]&&m>=z[j+1])?(E[U]=!0,_.push(A[U])):E[U]=!1}}}}_forEachCell(a,c,g,m,b,_,E,M){let F=this._convertToCellCoord(a),A=this._convertToCellCoord(c),z=this._convertToCellCoord(g),N=this._convertToCellCoord(m);for(let U=F;U<=z;U++)for(let j=A;j<=N;j++){let K=this.d*j+U;if((!M||M(this._convertFromCellCoord(U),this._convertFromCellCoord(j),this._convertFromCellCoord(U+1),this._convertFromCellCoord(j+1)))&&b.call(this,a,c,g,m,K,_,E,M))return}}_convertFromCellCoord(a){return(a-this.padding)/this.scale}_convertToCellCoord(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let a=this.cells,c=3+this.cells.length+1+1,g=0;for(let _=0;_<this.cells.length;_++)g+=this.cells[_].length;let m=new Int32Array(c+g+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let b=c;for(let _=0;_<a.length;_++){let E=a[_];m[3+_]=b,m.set(E,b),b+=E.length}return m[3+a.length]=b,m.set(this.keys,b),b+=this.keys.length,m[3+a.length+1]=b,m.set(this.bboxes,b),b+=this.bboxes.length,m.buffer}static serialize(a,c){let g=a.toArrayBuffer();return c&&c.push(g),{buffer:g}}static deserialize(a){return new Ir(a.buffer)}}let co={};function rt(h,a,c={}){if(co[h])throw new Error(`${h} is already registered.`);Object.defineProperty(a,"_classRegistryKey",{value:h,writeable:!1}),co[h]={klass:a,omit:c.omit||[],shallow:c.shallow||[]}}rt("Object",Object),rt("Set",Set),rt("TransferableGridIndex",Ir),rt("Color",Ot),rt("Error",Error),rt("AJAXError",he),rt("ResolvedImage",Ys),rt("StylePropertyFunction",Ml),rt("StyleExpression",rd,{omit:["_evaluator"]}),rt("ZoomDependentExpression",ad),rt("ZoomConstantExpression",Pl),rt("CompoundExpression",ao,{omit:["_evaluate"]});for(let h in ya)ya[h]._classRegistryKey||rt(`Expression_${h}`,ya[h]);function vd(h){return h&&typeof ArrayBuffer<"u"&&(h instanceof ArrayBuffer||h.constructor&&h.constructor.name==="ArrayBuffer")}function Jc(h){return h.$name||h.constructor._classRegistryKey}function yd(h){return!function(a){if(a===null||typeof a!="object")return!1;let c=Jc(a);return!(!c||c==="Object")}(h)&&(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||h instanceof Blob||h instanceof Error||vd(h)||No(h)||ArrayBuffer.isView(h)||h instanceof ImageData)}function kr(h,a){if(yd(h))return(vd(h)||No(h))&&a&&a.push(h),ArrayBuffer.isView(h)&&a&&a.push(h.buffer),h instanceof ImageData&&a&&a.push(h.data.buffer),h;if(Array.isArray(h)){let b=[];for(let _ of h)b.push(kr(_,a));return b}if(typeof h!="object")throw new Error("can't serialize object of type "+typeof h);let c=Jc(h);if(!c)throw new Error(`can't serialize object of unregistered class ${h.constructor.name}`);if(!co[c])throw new Error(`${c} is not registered.`);let{klass:g}=co[c],m=g.serialize?g.serialize(h,a):{};if(g.serialize){if(a&&m===a[a.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let b in h){if(!h.hasOwnProperty(b)||co[c].omit.indexOf(b)>=0)continue;let _=h[b];m[b]=co[c].shallow.indexOf(b)>=0?_:kr(_,a)}h instanceof Error&&(m.message=h.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(m.$name=c),m}function Sa(h){if(yd(h))return h;if(Array.isArray(h))return h.map(Sa);if(typeof h!="object")throw new Error("can't deserialize object of type "+typeof h);let a=Jc(h)||"Object";if(!co[a])throw new Error(`can't deserialize unregistered class ${a}`);let{klass:c}=co[a];if(!c)throw new Error(`can't deserialize unregistered class ${a}`);if(c.deserialize)return c.deserialize(h);let g=Object.create(c.prototype);for(let m of Object.keys(h)){if(m==="$name")continue;let b=h[m];g[m]=co[a].shallow.indexOf(m)>=0?b:Sa(b)}return g}class wd{constructor(){this.first=!0}update(a,c){let g=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=g,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=g,!0):(this.lastFloorZoom>g?(this.lastIntegerZoom=g+1,this.lastIntegerZoomTime=c):this.lastFloorZoom<g&&(this.lastIntegerZoom=g,this.lastIntegerZoomTime=c),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=g,!0))}}let Ht={"Latin-1 Supplement":h=>h>=128&&h<=255,"Hangul Jamo":h=>h>=4352&&h<=4607,Khmer:h=>h>=6016&&h<=6143,"General Punctuation":h=>h>=8192&&h<=8303,"Letterlike Symbols":h=>h>=8448&&h<=8527,"Number Forms":h=>h>=8528&&h<=8591,"Miscellaneous Technical":h=>h>=8960&&h<=9215,"Control Pictures":h=>h>=9216&&h<=9279,"Optical Character Recognition":h=>h>=9280&&h<=9311,"Enclosed Alphanumerics":h=>h>=9312&&h<=9471,"Geometric Shapes":h=>h>=9632&&h<=9727,"Miscellaneous Symbols":h=>h>=9728&&h<=9983,"Miscellaneous Symbols and Arrows":h=>h>=11008&&h<=11263,"Ideographic Description Characters":h=>h>=12272&&h<=12287,"CJK Symbols and Punctuation":h=>h>=12288&&h<=12351,Hiragana:h=>h>=12352&&h<=12447,Katakana:h=>h>=12448&&h<=12543,Kanbun:h=>h>=12688&&h<=12703,"CJK Strokes":h=>h>=12736&&h<=12783,"Enclosed CJK Letters and Months":h=>h>=12800&&h<=13055,"CJK Compatibility":h=>h>=13056&&h<=13311,"Yijing Hexagram Symbols":h=>h>=19904&&h<=19967,"CJK Unified Ideographs":h=>h>=19968&&h<=40959,"Hangul Syllables":h=>h>=44032&&h<=55215,"Private Use Area":h=>h>=57344&&h<=63743,"Vertical Forms":h=>h>=65040&&h<=65055,"CJK Compatibility Forms":h=>h>=65072&&h<=65103,"Small Form Variants":h=>h>=65104&&h<=65135,"Halfwidth and Fullwidth Forms":h=>h>=65280&&h<=65519};function Cd(h){for(let a of h)if(xd(a.charCodeAt(0)))return!0;return!1}function Kg(h){for(let a of h)if(!Yg(a.charCodeAt(0)))return!1;return!0}function bd(h){let a=h.map(c=>{try{return new RegExp(`\\p{sc=${c}}`,"u").source}catch{return null}}).filter(c=>c);return new RegExp(a.join("|"),"u")}let Xg=bd(["Arab","Dupl","Mong","Ougr","Syrc"]);function Yg(h){return!Xg.test(String.fromCodePoint(h))}let Qg=bd(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function xd(h){return!(h!==746&&h!==747&&(h<4352||!(Ht["CJK Compatibility Forms"](h)&&!(h>=65097&&h<=65103)||Ht["CJK Compatibility"](h)||Ht["CJK Strokes"](h)||!(!Ht["CJK Symbols and Punctuation"](h)||h>=12296&&h<=12305||h>=12308&&h<=12319||h===12336)||Ht["Enclosed CJK Letters and Months"](h)||Ht["Ideographic Description Characters"](h)||Ht.Kanbun(h)||Ht.Katakana(h)&&h!==12540||!(!Ht["Halfwidth and Fullwidth Forms"](h)||h===65288||h===65289||h===65293||h>=65306&&h<=65310||h===65339||h===65341||h===65343||h>=65371&&h<=65503||h===65507||h>=65512&&h<=65519)||!(!Ht["Small Form Variants"](h)||h>=65112&&h<=65118||h>=65123&&h<=65126)||Ht["Vertical Forms"](h)||Ht["Yijing Hexagram Symbols"](h)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(h))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(h))||Qg.test(String.fromCodePoint(h)))))}function _d(h){return!(xd(h)||function(a){return!!(Ht["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||Ht["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||Ht["Letterlike Symbols"](a)||Ht["Number Forms"](a)||Ht["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||Ht["Control Pictures"](a)&&a!==9251||Ht["Optical Character Recognition"](a)||Ht["Enclosed Alphanumerics"](a)||Ht["Geometric Shapes"](a)||Ht["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||Ht["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||Ht["CJK Symbols and Punctuation"](a)||Ht.Katakana(a)||Ht["Private Use Area"](a)||Ht["CJK Compatibility Forms"](a)||Ht["Small Form Variants"](a)||Ht["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(h))}let Jg=bd(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Sd(h){return Jg.test(String.fromCodePoint(h))}function ef(h,a){return!(!a&&Sd(h)||h>=2304&&h<=3583||h>=3840&&h<=4255||Ht.Khmer(h))}function eh(h){for(let a of h)if(Sd(a.charCodeAt(0)))return!0;return!1}let Vn=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(h){this.pluginStatus=h.pluginStatus,this.pluginURL=h.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(h){if(Vn.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=h.applyArabicShaping,this.processBidirectionalText=h.processBidirectionalText,this.processStyledBidirectionalText=h.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(h,a){return o(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(h.pluginStatus!=="loading")return this.setState(h),h;let c=h.pluginURL,g=new Promise(b=>{this.loadScriptResolve=b});a(c);let m=new Promise(b=>setTimeout(()=>b(),this.TIMEOUT));if(yield Promise.race([g,m]),this.isParsed()){let b={pluginStatus:"loaded",pluginURL:c};return this.setState(b),b}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${c}`)})}};class ei{constructor(a,c){this.isSupportedScript=ty,this.zoom=a,c?(this.now=c.now||0,this.fadeDuration=c.fadeDuration||0,this.zoomHistory=c.zoomHistory||new wd,this.transition=c.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new wd,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let a=this.zoom,c=a-Math.floor(a),g=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:c+(1-c)*g}:{fromScale:.5,toScale:1,t:1-(1-g)*c}}}function ty(h){return function(a,c){for(let g of a)if(!ef(g.charCodeAt(0),c))return!1;return!0}(h,Vn.getRTLTextPluginStatus()==="loaded")}class th{constructor(a,c,g){this.property=a,this.value=c,this.expression=function(m,b,_){if(Rl(m))return new Ml(m,b);if(Uc(m)){let E=zg(m,b,_);if(E.result==="error")throw new Error(E.value.map(M=>`${M.key}: ${M.message}`).join(", "));return E.value}{let E=m;return b.type==="color"&&typeof m=="string"?E=Ot.parse(m):b.type!=="padding"||typeof m!="number"&&!Array.isArray(m)?b.type!=="numberArray"||typeof m!="number"&&!Array.isArray(m)?b.type!=="colorArray"||typeof m!="string"&&!Array.isArray(m)?b.type==="variableAnchorOffsetCollection"&&Array.isArray(m)?E=Fs.parse(m):b.type==="projectionDefinition"&&typeof m=="string"&&(E=xs.parse(m)):E=Zi.parse(m):E=Ds.parse(m):E=as.parse(m),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>E}}}(c===void 0?a.specification.default:c,a.specification,g)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(a,c,g){return this.property.possiblyEvaluate(this,a,c,g)}}class ih{constructor(a,c){this.property=a,this.value=new th(a,void 0,c)}transitioned(a,c){return new Ed(this.property,this.value,c,$i({},a.transition,this.transition),a.now)}untransitioned(){return new Ed(this.property,this.value,null,{},0)}}class Rd{constructor(a,c){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues),this._globalState=c}getValue(a){return Xs(this._values[a].value.value)}setValue(a,c){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new ih(this._values[a].property,this._globalState)),this._values[a].value=new th(this._values[a].property,c===null?void 0:Xs(c),this._globalState)}getTransition(a){return Xs(this._values[a].transition)}setTransition(a,c){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new ih(this._values[a].property,this._globalState)),this._values[a].transition=Xs(c)||void 0}serialize(){let a={};for(let c of Object.keys(this._values)){let g=this.getValue(c);g!==void 0&&(a[c]=g);let m=this.getTransition(c);m!==void 0&&(a[`${c}-transition`]=m)}return a}transitioned(a,c){let g=new tf(this._properties);for(let m of Object.keys(this._values))g._values[m]=this._values[m].transitioned(a,c._values[m]);return g}untransitioned(){let a=new tf(this._properties);for(let c of Object.keys(this._values))a._values[c]=this._values[c].untransitioned();return a}}class Ed{constructor(a,c,g,m,b){this.property=a,this.value=c,this.begin=b+m.delay||0,this.end=this.begin+m.duration||0,a.specification.transition&&(m.delay||m.duration)&&(this.prior=g)}possiblyEvaluate(a,c,g){let m=a.now||0,b=this.value.possiblyEvaluate(a,c,g),_=this.prior;if(_){if(m>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(m<this.begin)return _.possiblyEvaluate(a,c,g);{let E=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(a,c,g),b,Bi(E))}}return b}}class tf{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,c,g){let m=new sh(this._properties);for(let b of Object.keys(this._values))m._values[b]=this._values[b].possiblyEvaluate(a,c,g);return m}hasTransition(){for(let a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class iy{constructor(a,c){this._properties=a,this._values=Object.create(a.defaultPropertyValues),this._globalState=c}hasValue(a){return this._values[a].value!==void 0}getValue(a){return Xs(this._values[a].value)}setValue(a,c){this._values[a]=new th(this._values[a].property,c===null?void 0:Xs(c),this._globalState)}serialize(){let a={};for(let c of Object.keys(this._values)){let g=this.getValue(c);g!==void 0&&(a[c]=g)}return a}possiblyEvaluate(a,c,g){let m=new sh(this._properties);for(let b of Object.keys(this._values))m._values[b]=this._values[b].possiblyEvaluate(a,c,g);return m}}class qo{constructor(a,c,g){this.property=a,this.value=c,this.parameters=g}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,c,g,m){return this.property.evaluate(this.value,this.parameters,a,c,g,m)}}class sh{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class pt{constructor(a){this.specification=a}possiblyEvaluate(a,c){if(a.isDataDriven())throw new Error("Value should not be data driven");return a.expression.evaluate(c)}interpolate(a,c,g){let m=$o[this.specification.type];return m?m(a,c,g):a}}class mt{constructor(a,c){this.specification=a,this.overrides=c}possiblyEvaluate(a,c,g,m){return new qo(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(c,null,{},g,m)}:a.expression,c)}interpolate(a,c,g){if(a.value.kind!=="constant"||c.value.kind!=="constant")return a;if(a.value.value===void 0||c.value.value===void 0)return new qo(this,{kind:"constant",value:void 0},a.parameters);let m=$o[this.specification.type];if(m){let b=m(a.value.value,c.value.value,g);return new qo(this,{kind:"constant",value:b},a.parameters)}return a}evaluate(a,c,g,m,b,_){return a.kind==="constant"?a.value:a.evaluate(c,g,m,b,_)}}class oh extends mt{possiblyEvaluate(a,c,g,m){if(a.value===void 0)return new qo(this,{kind:"constant",value:void 0},c);if(a.expression.kind==="constant"){let b=a.expression.evaluate(c,null,{},g,m),_=a.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,E=this._calculate(_,_,_,c);return new qo(this,{kind:"constant",value:E},c)}if(a.expression.kind==="camera"){let b=this._calculate(a.expression.evaluate({zoom:c.zoom-1}),a.expression.evaluate({zoom:c.zoom}),a.expression.evaluate({zoom:c.zoom+1}),c);return new qo(this,{kind:"constant",value:b},c)}return new qo(this,a.expression,c)}evaluate(a,c,g,m,b,_){if(a.kind==="source"){let E=a.evaluate(c,g,m,b,_);return this._calculate(E,E,E,c)}return a.kind==="composite"?this._calculate(a.evaluate({zoom:Math.floor(c.zoom)-1},g,m),a.evaluate({zoom:Math.floor(c.zoom)},g,m),a.evaluate({zoom:Math.floor(c.zoom)+1},g,m),c):a.value}_calculate(a,c,g,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:a,to:c}:{from:g,to:c}}interpolate(a){return a}}class Pd{constructor(a){this.specification=a}possiblyEvaluate(a,c,g,m){if(a.value!==void 0){if(a.expression.kind==="constant"){let b=a.expression.evaluate(c,null,{},g,m);return this._calculate(b,b,b,c)}return this._calculate(a.expression.evaluate(new ei(Math.floor(c.zoom-1),c)),a.expression.evaluate(new ei(Math.floor(c.zoom),c)),a.expression.evaluate(new ei(Math.floor(c.zoom+1),c)),c)}}_calculate(a,c,g,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:a,to:c}:{from:g,to:c}}interpolate(a){return a}}class nh{constructor(a){this.specification=a}possiblyEvaluate(a,c,g,m){return!!a.expression.evaluate(c,null,{},g,m)}interpolate(){return!1}}class Ss{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let c in a){let g=a[c];g.specification.overridable&&this.overridableProperties.push(c);let m=this.defaultPropertyValues[c]=new th(g,void 0,void 0),b=this.defaultTransitionablePropertyValues[c]=new ih(g,void 0);this.defaultTransitioningPropertyValues[c]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=m.possiblyEvaluate({})}}}rt("DataDrivenProperty",mt),rt("DataConstantProperty",pt),rt("CrossFadedDataDrivenProperty",oh),rt("CrossFadedProperty",Pd),rt("ColorRampProperty",nh);let sf="-transition";class Mo extends ct{constructor(a,c,g){if(super(),this.id=a.id,this.type=a.type,this._globalState=g,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},a.type!=="custom"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter,this._featureFilter=Mr(a.filter,g)),c.layout&&(this._unevaluatedLayout=new iy(c.layout,g)),c.paint)){this._transitionablePaint=new Rd(c.paint,g);for(let m in a.paint)this.setPaintProperty(m,a.paint[m],{validate:!1});for(let m in a.layout)this.setLayoutProperty(m,a.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new sh(c.paint)}}setFilter(a){this.filter=a,this._featureFilter=Mr(a,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}getLayoutAffectingGlobalStateRefs(){let a=new Set;if(this._unevaluatedLayout)for(let c in this._unevaluatedLayout._values){let g=this._unevaluatedLayout._values[c];for(let m of g.getGlobalStateRefs())a.add(m)}for(let c of this._featureFilter.getGlobalStateRefs())a.add(c);return a}getPaintAffectingGlobalStateRefs(){var a;let c=new globalThis.Map;if(this._transitionablePaint)for(let g in this._transitionablePaint._values){let m=this._transitionablePaint._values[g].value;for(let b of m.getGlobalStateRefs()){let _=(a=c.get(b))!==null&&a!==void 0?a:[];_.push({name:g,value:m.value}),c.set(b,_)}}return c}setLayoutProperty(a,c,g={}){c!=null&&this._validate(Qc,`layers.${this.id}.layout.${a}`,a,c,g)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,c):this.visibility=c)}getPaintProperty(a){return a.endsWith(sf)?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)}setPaintProperty(a,c,g={}){if(c!=null&&this._validate(ey,`layers.${this.id}.paint.${a}`,a,c,g))return!1;if(a.endsWith(sf))return this._transitionablePaint.setTransition(a.slice(0,-11),c||void 0),!1;{let m=this._transitionablePaint._values[a],b=m.property.specification["property-type"]==="cross-faded-data-driven",_=m.value.isDataDriven(),E=m.value;this._transitionablePaint.setValue(a,c),this._handleSpecialPaintPropertyUpdate(a);let M=this._transitionablePaint._values[a].value;return M.isDataDriven()||_||b||this._handleOverridablePaintPropertyUpdate(a,E,M)}}_handleSpecialPaintPropertyUpdate(a){}_handleOverridablePaintPropertyUpdate(a,c,g){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,c){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,c)}serialize(){let a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),ra(a,(c,g)=>!(c===void 0||g==="layout"&&!Object.keys(c).length||g==="paint"&&!Object.keys(c).length))}_validate(a,c,g,m,b={}){return(!b||b.validate!==!1)&&Zg(this,a.call(_a,{key:c,layerType:this.type,objectKey:g,value:m,styleSpec:xe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let a in this.paint._values){let c=this.paint.get(a);if(c instanceof qo&&zn(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1}}let Ar={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ra{constructor(a,c){this._structArray=a,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class vi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,c){return a._trim(),c&&(a.isTransferred=!0,c.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){let c=Object.create(this.prototype);return c.arrayBuffer=a.arrayBuffer,c.length=a.length,c.capacity=a.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Li(h,a=1){let c=0,g=0;return{members:h.map(m=>{let b=Ar[m.type].BYTES_PER_ELEMENT,_=c=rh(c,Math.max(a,b)),E=m.components||1;return g=Math.max(g,b),c+=b*E,{name:m.name,type:m.type,components:E,offset:_}}),size:rh(c,Math.max(g,a)),alignment:a}}function rh(h,a){return Math.ceil(h/a)*a}class Ll extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,c){let g=this.length;return this.resize(g+1),this.emplace(g,a,c)}emplace(a,c,g){let m=2*a;return this.int16[m+0]=c,this.int16[m+1]=g,a}}Ll.prototype.bytesPerElement=4,rt("StructArrayLayout2i4",Ll);class Lr extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,c,g){let m=this.length;return this.resize(m+1),this.emplace(m,a,c,g)}emplace(a,c,g,m){let b=3*a;return this.int16[b+0]=c,this.int16[b+1]=g,this.int16[b+2]=m,a}}Lr.prototype.bytesPerElement=6,rt("StructArrayLayout3i6",Lr);class Or extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,c,g,m){let b=this.length;return this.resize(b+1),this.emplace(b,a,c,g,m)}emplace(a,c,g,m,b){let _=4*a;return this.int16[_+0]=c,this.int16[_+1]=g,this.int16[_+2]=m,this.int16[_+3]=b,a}}Or.prototype.bytesPerElement=8,rt("StructArrayLayout4i8",Or);class Md extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,c,g,m,b,_){let E=this.length;return this.resize(E+1),this.emplace(E,a,c,g,m,b,_)}emplace(a,c,g,m,b,_,E){let M=6*a;return this.int16[M+0]=c,this.int16[M+1]=g,this.int16[M+2]=m,this.int16[M+3]=b,this.int16[M+4]=_,this.int16[M+5]=E,a}}Md.prototype.bytesPerElement=12,rt("StructArrayLayout2i4i12",Md);class ah extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,c,g,m,b,_){let E=this.length;return this.resize(E+1),this.emplace(E,a,c,g,m,b,_)}emplace(a,c,g,m,b,_,E){let M=4*a,F=8*a;return this.int16[M+0]=c,this.int16[M+1]=g,this.uint8[F+4]=m,this.uint8[F+5]=b,this.uint8[F+6]=_,this.uint8[F+7]=E,a}}ah.prototype.bytesPerElement=8,rt("StructArrayLayout2i4ub8",ah);class hn extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,c){let g=this.length;return this.resize(g+1),this.emplace(g,a,c)}emplace(a,c,g){let m=2*a;return this.float32[m+0]=c,this.float32[m+1]=g,a}}hn.prototype.bytesPerElement=8,rt("StructArrayLayout2f8",hn);class Td extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,c,g,m,b,_,E,M,F,A){let z=this.length;return this.resize(z+1),this.emplace(z,a,c,g,m,b,_,E,M,F,A)}emplace(a,c,g,m,b,_,E,M,F,A,z){let N=10*a;return this.uint16[N+0]=c,this.uint16[N+1]=g,this.uint16[N+2]=m,this.uint16[N+3]=b,this.uint16[N+4]=_,this.uint16[N+5]=E,this.uint16[N+6]=M,this.uint16[N+7]=F,this.uint16[N+8]=A,this.uint16[N+9]=z,a}}Td.prototype.bytesPerElement=20,rt("StructArrayLayout10ui20",Td);class Dd extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,c,g,m,b,_,E,M,F,A,z,N){let U=this.length;return this.resize(U+1),this.emplace(U,a,c,g,m,b,_,E,M,F,A,z,N)}emplace(a,c,g,m,b,_,E,M,F,A,z,N,U){let j=12*a;return this.int16[j+0]=c,this.int16[j+1]=g,this.int16[j+2]=m,this.int16[j+3]=b,this.uint16[j+4]=_,this.uint16[j+5]=E,this.uint16[j+6]=M,this.uint16[j+7]=F,this.int16[j+8]=A,this.int16[j+9]=z,this.int16[j+10]=N,this.int16[j+11]=U,a}}Dd.prototype.bytesPerElement=24,rt("StructArrayLayout4i4ui4i24",Dd);class lh extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,c,g){let m=this.length;return this.resize(m+1),this.emplace(m,a,c,g)}emplace(a,c,g,m){let b=3*a;return this.float32[b+0]=c,this.float32[b+1]=g,this.float32[b+2]=m,a}}lh.prototype.bytesPerElement=12,rt("StructArrayLayout3f12",lh);class Fd extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){let c=this.length;return this.resize(c+1),this.emplace(c,a)}emplace(a,c){return this.uint32[1*a+0]=c,a}}Fd.prototype.bytesPerElement=4,rt("StructArrayLayout1ul4",Fd);class w extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,c,g,m,b,_,E,M,F){let A=this.length;return this.resize(A+1),this.emplace(A,a,c,g,m,b,_,E,M,F)}emplace(a,c,g,m,b,_,E,M,F,A){let z=10*a,N=5*a;return this.int16[z+0]=c,this.int16[z+1]=g,this.int16[z+2]=m,this.int16[z+3]=b,this.int16[z+4]=_,this.int16[z+5]=E,this.uint32[N+3]=M,this.uint16[z+8]=F,this.uint16[z+9]=A,a}}w.prototype.bytesPerElement=20,rt("StructArrayLayout6i1ul2ui20",w);class r extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,c,g,m,b,_){let E=this.length;return this.resize(E+1),this.emplace(E,a,c,g,m,b,_)}emplace(a,c,g,m,b,_,E){let M=6*a;return this.int16[M+0]=c,this.int16[M+1]=g,this.int16[M+2]=m,this.int16[M+3]=b,this.int16[M+4]=_,this.int16[M+5]=E,a}}r.prototype.bytesPerElement=12,rt("StructArrayLayout2i2i2i12",r);class u extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,c,g,m,b){let _=this.length;return this.resize(_+1),this.emplace(_,a,c,g,m,b)}emplace(a,c,g,m,b,_){let E=4*a,M=8*a;return this.float32[E+0]=c,this.float32[E+1]=g,this.float32[E+2]=m,this.int16[M+6]=b,this.int16[M+7]=_,a}}u.prototype.bytesPerElement=16,rt("StructArrayLayout2f1f2i16",u);class f extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,c,g,m,b,_){let E=this.length;return this.resize(E+1),this.emplace(E,a,c,g,m,b,_)}emplace(a,c,g,m,b,_,E){let M=16*a,F=4*a,A=8*a;return this.uint8[M+0]=c,this.uint8[M+1]=g,this.float32[F+1]=m,this.float32[F+2]=b,this.int16[A+6]=_,this.int16[A+7]=E,a}}f.prototype.bytesPerElement=16,rt("StructArrayLayout2ub2f2i16",f);class v extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,c,g){let m=this.length;return this.resize(m+1),this.emplace(m,a,c,g)}emplace(a,c,g,m){let b=3*a;return this.uint16[b+0]=c,this.uint16[b+1]=g,this.uint16[b+2]=m,a}}v.prototype.bytesPerElement=6,rt("StructArrayLayout3ui6",v);class x extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,c,g,m,b,_,E,M,F,A,z,N,U,j,K,J,se){let Ce=this.length;return this.resize(Ce+1),this.emplace(Ce,a,c,g,m,b,_,E,M,F,A,z,N,U,j,K,J,se)}emplace(a,c,g,m,b,_,E,M,F,A,z,N,U,j,K,J,se,Ce){let ce=24*a,pe=12*a,Pe=48*a;return this.int16[ce+0]=c,this.int16[ce+1]=g,this.uint16[ce+2]=m,this.uint16[ce+3]=b,this.uint32[pe+2]=_,this.uint32[pe+3]=E,this.uint32[pe+4]=M,this.uint16[ce+10]=F,this.uint16[ce+11]=A,this.uint16[ce+12]=z,this.float32[pe+7]=N,this.float32[pe+8]=U,this.uint8[Pe+36]=j,this.uint8[Pe+37]=K,this.uint8[Pe+38]=J,this.uint32[pe+10]=se,this.int16[ce+22]=Ce,a}}x.prototype.bytesPerElement=48,rt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",x);class R extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,c,g,m,b,_,E,M,F,A,z,N,U,j,K,J,se,Ce,ce,pe,Pe,Ie,Ne,et,qe,Qe,gt,Ye){let Je=this.length;return this.resize(Je+1),this.emplace(Je,a,c,g,m,b,_,E,M,F,A,z,N,U,j,K,J,se,Ce,ce,pe,Pe,Ie,Ne,et,qe,Qe,gt,Ye)}emplace(a,c,g,m,b,_,E,M,F,A,z,N,U,j,K,J,se,Ce,ce,pe,Pe,Ie,Ne,et,qe,Qe,gt,Ye,Je){let ze=32*a,wt=16*a;return this.int16[ze+0]=c,this.int16[ze+1]=g,this.int16[ze+2]=m,this.int16[ze+3]=b,this.int16[ze+4]=_,this.int16[ze+5]=E,this.int16[ze+6]=M,this.int16[ze+7]=F,this.uint16[ze+8]=A,this.uint16[ze+9]=z,this.uint16[ze+10]=N,this.uint16[ze+11]=U,this.uint16[ze+12]=j,this.uint16[ze+13]=K,this.uint16[ze+14]=J,this.uint16[ze+15]=se,this.uint16[ze+16]=Ce,this.uint16[ze+17]=ce,this.uint16[ze+18]=pe,this.uint16[ze+19]=Pe,this.uint16[ze+20]=Ie,this.uint16[ze+21]=Ne,this.uint16[ze+22]=et,this.uint32[wt+12]=qe,this.float32[wt+13]=Qe,this.float32[wt+14]=gt,this.uint16[ze+30]=Ye,this.uint16[ze+31]=Je,a}}R.prototype.bytesPerElement=64,rt("StructArrayLayout8i15ui1ul2f2ui64",R);class T extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){let c=this.length;return this.resize(c+1),this.emplace(c,a)}emplace(a,c){return this.float32[1*a+0]=c,a}}T.prototype.bytesPerElement=4,rt("StructArrayLayout1f4",T);class D extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,c,g){let m=this.length;return this.resize(m+1),this.emplace(m,a,c,g)}emplace(a,c,g,m){let b=3*a;return this.uint16[6*a+0]=c,this.float32[b+1]=g,this.float32[b+2]=m,a}}D.prototype.bytesPerElement=12,rt("StructArrayLayout1ui2f12",D);class k extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,c,g){let m=this.length;return this.resize(m+1),this.emplace(m,a,c,g)}emplace(a,c,g,m){let b=4*a;return this.uint32[2*a+0]=c,this.uint16[b+2]=g,this.uint16[b+3]=m,a}}k.prototype.bytesPerElement=8,rt("StructArrayLayout1ul2ui8",k);class L extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,c){let g=this.length;return this.resize(g+1),this.emplace(g,a,c)}emplace(a,c,g){let m=2*a;return this.uint16[m+0]=c,this.uint16[m+1]=g,a}}L.prototype.bytesPerElement=4,rt("StructArrayLayout2ui4",L);class H extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){let c=this.length;return this.resize(c+1),this.emplace(c,a)}emplace(a,c){return this.uint16[1*a+0]=c,a}}H.prototype.bytesPerElement=2,rt("StructArrayLayout1ui2",H);class B extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,c,g,m){let b=this.length;return this.resize(b+1),this.emplace(b,a,c,g,m)}emplace(a,c,g,m,b){let _=4*a;return this.float32[_+0]=c,this.float32[_+1]=g,this.float32[_+2]=m,this.float32[_+3]=b,a}}B.prototype.bytesPerElement=16,rt("StructArrayLayout4f16",B);class W extends Ra{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new l(this.anchorPointX,this.anchorPointY)}}W.prototype.size=20;class Z extends w{get(a){return new W(this,a)}}rt("CollisionBoxArray",Z);class ee extends Ra{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(a){this._structArray.uint8[this._pos1+37]=a}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(a){this._structArray.uint8[this._pos1+38]=a}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(a){this._structArray.uint32[this._pos4+10]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ee.prototype.size=48;class te extends x{get(a){return new ee(this,a)}}rt("PlacedSymbolArray",te);class ie extends Ra{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(a){this._structArray.uint32[this._pos4+12]=a}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ie.prototype.size=64;class oe extends R{get(a){return new ie(this,a)}}rt("SymbolInstanceArray",oe);class le extends T{getoffsetX(a){return this.float32[1*a+0]}}rt("GlyphOffsetArray",le);class ne extends Lr{getx(a){return this.int16[3*a+0]}gety(a){return this.int16[3*a+1]}gettileUnitDistanceFromAnchor(a){return this.int16[3*a+2]}}rt("SymbolLineVertexArray",ne);class ue extends Ra{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ue.prototype.size=12;class ge extends D{get(a){return new ue(this,a)}}rt("TextAnchorOffsetArray",ge);class re extends Ra{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}re.prototype.size=8;class we extends k{get(a){return new re(this,a)}}rt("FeatureIndexArray",we);class Te extends Ll{}class Re extends Ll{}class Ee extends Ll{}class De extends Md{}class Ke extends ah{}class Ze extends hn{}class He extends Td{}class ut extends Dd{}class It extends lh{}class Xt extends Fd{}class yi extends r{}class ni extends f{}class ti extends v{}class wi extends L{}let hi=Li([{name:"a_pos",components:2,type:"Int16"}],4),{members:ri}=hi;class $t{constructor(a=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=a}prepareSegment(a,c,g,m){let b=this.segments[this.segments.length-1];return a>$t.MAX_VERTEX_ARRAY_LENGTH&&Vi(`Max vertices per segment is ${$t.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${$t.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!b||b.vertexLength+a>$t.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==m?this.createNewSegment(c,g,m):b}createNewSegment(a,c,g){let m={vertexOffset:a.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0,vaos:{}};return g!==void 0&&(m.sortKey=g),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(m),m}getOrCreateLatestSegment(a,c,g){return this.prepareSegment(0,a,c,g)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(let a of this.segments)for(let c in a.vaos)a.vaos[c].destroy()}static simpleSegment(a,c,g,m){return new $t([{vertexOffset:a,primitiveOffset:c,vertexLength:g,primitiveLength:m,vaos:{},sortKey:0}])}}function ts(h,a){return 256*(h=fi(Math.floor(h),0,255))+fi(Math.floor(a),0,255)}$t.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,rt("SegmentVector",$t);let Ki=Li([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ks,Hn,Nn,To={exports:{}},zr={exports:{}},Ol={exports:{}},ch=function(){if(Nn)return To.exports;Nn=1;var h=(ks||(ks=1,zr.exports=function(c,g){var m,b,_,E,M,F,A,z;for(b=c.length-(m=3&c.length),_=g,M=3432918353,F=461845907,z=0;z<b;)A=255&c.charCodeAt(z)|(255&c.charCodeAt(++z))<<8|(255&c.charCodeAt(++z))<<16|(255&c.charCodeAt(++z))<<24,++z,_=27492+(65535&(E=5*(65535&(_=(_^=A=(65535&(A=(A=(65535&A)*M+(((A>>>16)*M&65535)<<16)&4294967295)<<15|A>>>17))*F+(((A>>>16)*F&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(A=0,m){case 3:A^=(255&c.charCodeAt(z+2))<<16;case 2:A^=(255&c.charCodeAt(z+1))<<8;case 1:_^=A=(65535&(A=(A=(65535&(A^=255&c.charCodeAt(z)))*M+(((A>>>16)*M&65535)<<16)&4294967295)<<15|A>>>17))*F+(((A>>>16)*F&65535)<<16)&4294967295}return _^=c.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),zr.exports),a=(Hn||(Hn=1,Ol.exports=function(c,g){for(var m,b=c.length,_=g^b,E=0;b>=4;)m=1540483477*(65535&(m=255&c.charCodeAt(E)|(255&c.charCodeAt(++E))<<8|(255&c.charCodeAt(++E))<<16|(255&c.charCodeAt(++E))<<24))+((1540483477*(m>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),b-=4,++E;switch(b){case 3:_^=(255&c.charCodeAt(E+2))<<16;case 2:_^=(255&c.charCodeAt(E+1))<<8;case 1:_=1540483477*(65535&(_^=255&c.charCodeAt(E)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),Ol.exports);return To.exports=h,To.exports.murmur3=h,To.exports.murmur2=a,To.exports}(),Gn=d(ch);class As{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,c,g,m){this.ids.push(un(a)),this.positions.push(c,g,m)}getPositions(a){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let c=un(a),g=0,m=this.ids.length-1;for(;g<m;){let _=g+m>>1;this.ids[_]>=c?m=_:g=_+1}let b=[];for(;this.ids[g]===c;)b.push({index:this.positions[3*g],start:this.positions[3*g+1],end:this.positions[3*g+2]}),g++;return b}static serialize(a,c){let g=new Float64Array(a.ids),m=new Uint32Array(a.positions);return dn(g,m,0,g.length-1),c&&c.push(g.buffer,m.buffer),{ids:g,positions:m}}static deserialize(a){let c=new As;return c.ids=a.ids,c.positions=a.positions,c.indexed=!0,c}}function un(h){let a=+h;return!isNaN(a)&&a<=Number.MAX_SAFE_INTEGER?a:Gn(String(h))}function dn(h,a,c,g){for(;c<g;){let m=h[c+g>>1],b=c-1,_=g+1;for(;;){do b++;while(h[b]<m);do _--;while(h[_]>m);if(b>=_)break;Wn(h,b,_),Wn(a,3*b,3*_),Wn(a,3*b+1,3*_+1),Wn(a,3*b+2,3*_+2)}_-c<g-_?(dn(h,a,c,_),c=_+1):(dn(h,a,_+1,g),g=_)}}function Wn(h,a,c){let g=h[a];h[a]=h[c],h[c]=g}rt("FeaturePositionMap",As);class ui{constructor(a,c){this.gl=a.gl,this.location=c}}class Ni extends ui{constructor(a,c){super(a,c),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class eo extends ui{constructor(a,c){super(a,c),this.current=[0,0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))}}class is extends ui{constructor(a,c){super(a,c),this.current=Ot.transparent}set(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))}}let sy=new Float32Array(16);function Id(h){return[ts(255*h.r,255*h.g),ts(255*h.b,255*h.a)]}class zl{constructor(a,c,g){this.value=a,this.uniformNames=c.map(m=>`u_${m}`),this.type=g}setUniform(a,c,g){a.set(g.constantOr(this.value))}getBinding(a,c,g){return this.type==="color"?new is(a,c):new Ni(a,c)}}class Ea{constructor(a,c){this.uniformNames=c.map(g=>`u_${g}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(a,c){this.pixelRatioFrom=c.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=c.tlbr,this.patternTo=a.tlbr}setUniform(a,c,g,m){let b=m==="u_pattern_to"?this.patternTo:m==="u_pattern_from"?this.patternFrom:m==="u_pixel_ratio_to"?this.pixelRatioTo:m==="u_pixel_ratio_from"?this.pixelRatioFrom:null;b&&a.set(b)}getBinding(a,c,g){return g.substr(0,9)==="u_pattern"?new eo(a,c):new Ni(a,c)}}class pn{constructor(a,c,g,m){this.expression=a,this.type=g,this.maxValue=0,this.paintVertexAttributes=c.map(b=>({name:`a_${b}`,type:"Float32",components:g==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(a,c,g){let m=this.paintVertexArray.length,b=this.expression.evaluate(new ei(0,g),c,{},g.canonical,[],g.formattedSection);this.paintVertexArray.resize(a),this._setPaintValue(m,a,b)}updatePaintArray(a,c,g,m,b){let _=this.expression.evaluate(new ei(0,b),g,m);this._setPaintValue(a,c,_)}_setPaintValue(a,c,g){if(this.type==="color"){let m=Id(g);for(let b=a;b<c;b++)this.paintVertexArray.emplace(b,m[0],m[1])}else{for(let m=a;m<c;m++)this.paintVertexArray.emplace(m,g);this.maxValue=Math.max(this.maxValue,Math.abs(g))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Do{constructor(a,c,g,m,b,_){this.expression=a,this.uniformNames=c.map(E=>`u_${E}_t`),this.type=g,this.useIntegerZoom=m,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=c.map(E=>({name:`a_${E}`,type:"Float32",components:g==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(a,c,g){let m=this.expression.evaluate(new ei(this.zoom,g),c,{},g.canonical,[],g.formattedSection),b=this.expression.evaluate(new ei(this.zoom+1,g),c,{},g.canonical,[],g.formattedSection),_=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(_,a,m,b)}updatePaintArray(a,c,g,m,b){let _=this.expression.evaluate(new ei(this.zoom,b),g,m),E=this.expression.evaluate(new ei(this.zoom+1,b),g,m);this._setPaintValue(a,c,_,E)}_setPaintValue(a,c,g,m){if(this.type==="color"){let b=Id(g),_=Id(m);for(let E=a;E<c;E++)this.paintVertexArray.emplace(E,b[0],b[1],_[0],_[1])}else{for(let b=a;b<c;b++)this.paintVertexArray.emplace(b,g,m);this.maxValue=Math.max(this.maxValue,Math.abs(g),Math.abs(m))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,c){let g=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,m=fi(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);a.set(m)}getBinding(a,c,g){return new Ni(a,c)}}class js{constructor(a,c,g,m,b,_){this.expression=a,this.type=c,this.useIntegerZoom=g,this.zoom=m,this.layerId=_,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(a,c,g){let m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(m,a,c.patterns&&c.patterns[this.layerId],g.imagePositions)}updatePaintArray(a,c,g,m,b){this._setPaintValues(a,c,g.patterns&&g.patterns[this.layerId],b.imagePositions)}_setPaintValues(a,c,g,m){if(!m||!g)return;let{min:b,mid:_,max:E}=g,M=m[b],F=m[_],A=m[E];if(M&&F&&A)for(let z=a;z<c;z++)this.zoomInPaintVertexArray.emplace(z,F.tl[0],F.tl[1],F.br[0],F.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],F.pixelRatio,M.pixelRatio),this.zoomOutPaintVertexArray.emplace(z,F.tl[0],F.tl[1],F.br[0],F.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],F.pixelRatio,A.pixelRatio)}upload(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,Ki.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,Ki.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class kd{constructor(a,c,g){this.binders={},this._buffers=[];let m=[];for(let b in a.paint._values){if(!g(b))continue;let _=a.paint.get(b);if(!(_ instanceof qo&&zn(_.property.specification)))continue;let E=of(b,a.type),M=_.value,F=_.property.specification.type,A=_.property.useIntegerZoom,z=_.property.specification["property-type"],N=z==="cross-faded"||z==="cross-faded-data-driven";if(M.kind==="constant")this.binders[b]=N?new Ea(M.value,E):new zl(M.value,E,F),m.push(`/u_${b}`);else if(M.kind==="source"||N){let U=hh(b,F,"source");this.binders[b]=N?new js(M,F,A,c,U,a.id):new pn(M,E,F,U),m.push(`/a_${b}`)}else{let U=hh(b,F,"composite");this.binders[b]=new Do(M,E,F,A,c,U),m.push(`/z_${b}`)}}this.cacheKey=m.sort().join("")}getMaxValue(a){let c=this.binders[a];return c instanceof pn||c instanceof Do?c.maxValue:0}populatePaintArrays(a,c,g){for(let m in this.binders){let b=this.binders[m];(b instanceof pn||b instanceof Do||b instanceof js)&&b.populatePaintArray(a,c,g)}}setConstantPatternPositions(a,c){for(let g in this.binders){let m=this.binders[g];m instanceof Ea&&m.setConstantPatternPositions(a,c)}}updatePaintArrays(a,c,g,m,b){let _=!1;for(let E in a){let M=c.getPositions(E);for(let F of M){let A=g.feature(F.index);for(let z in this.binders){let N=this.binders[z];if((N instanceof pn||N instanceof Do||N instanceof js)&&N.expression.isStateDependent===!0){let U=m.paint.get(z);N.expression=U.value,N.updatePaintArray(F.start,F.end,A,a[E],b),_=!0}}}}return _}defines(){let a=[];for(let c in this.binders){let g=this.binders[c];(g instanceof zl||g instanceof Ea)&&a.push(...g.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return a}getBinderAttributes(){let a=[];for(let c in this.binders){let g=this.binders[c];if(g instanceof pn||g instanceof Do)for(let m=0;m<g.paintVertexAttributes.length;m++)a.push(g.paintVertexAttributes[m].name);else if(g instanceof js)for(let m=0;m<Ki.members.length;m++)a.push(Ki.members[m].name)}return a}getBinderUniforms(){let a=[];for(let c in this.binders){let g=this.binders[c];if(g instanceof zl||g instanceof Ea||g instanceof Do)for(let m of g.uniformNames)a.push(m)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a,c){let g=[];for(let m in this.binders){let b=this.binders[m];if(b instanceof zl||b instanceof Ea||b instanceof Do){for(let _ of b.uniformNames)if(c[_]){let E=b.getBinding(a,c[_],_);g.push({name:_,property:m,binding:E})}}}return g}setUniforms(a,c,g,m){for(let{name:b,property:_,binding:E}of c)this.binders[_].setUniform(E,m,g.get(_),b)}updatePaintBuffers(a){this._buffers=[];for(let c in this.binders){let g=this.binders[c];if(a&&g instanceof js){let m=a.fromScale===2?g.zoomInPaintVertexBuffer:g.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(g instanceof pn||g instanceof Do)&&g.paintVertexBuffer&&this._buffers.push(g.paintVertexBuffer)}}upload(a){for(let c in this.binders){let g=this.binders[c];(g instanceof pn||g instanceof Do||g instanceof js)&&g.upload(a)}this.updatePaintBuffers()}destroy(){for(let a in this.binders){let c=this.binders[a];(c instanceof pn||c instanceof Do||c instanceof js)&&c.destroy()}}}class Un{constructor(a,c,g=()=>!0){this.programConfigurations={};for(let m of a)this.programConfigurations[m.id]=new kd(m,c,g);this.needsUpload=!1,this._featureMap=new As,this._bufferOffset=0}populatePaintArrays(a,c,g,m){for(let b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(a,c,m);c.id!==void 0&&this._featureMap.add(c.id,g,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,c,g,m){for(let b of g)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(a,this._featureMap,c,b,m)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(let c in this.programConfigurations)this.programConfigurations[c].upload(a);this.needsUpload=!1}}destroy(){for(let a in this.programConfigurations)this.programConfigurations[a].destroy()}}function of(h,a){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[h]||[h.replace(`${a}-`,"").replace(/-/g,"_")]}function hh(h,a,c){let g={color:{source:hn,composite:B},number:{source:T,composite:hn}},m=function(b){return{"line-pattern":{source:He,composite:He},"fill-pattern":{source:He,composite:He},"fill-extrusion-pattern":{source:He,composite:He}}[b]}(h);return m&&m[c]||g[a][c]}rt("ConstantBinder",zl),rt("CrossFadedConstantBinder",Ea),rt("SourceExpressionBinder",pn),rt("CrossFadedCompositeBinder",js),rt("CompositeExpressionBinder",Do),rt("ProgramConfiguration",kd,{omit:["_buffers"]}),rt("ProgramConfigurationSet",Un);let uh=Math.pow(2,14)-1,dh=-uh-1;function Bl(h){let a=Ct/h.extent,c=h.loadGeometry();for(let g=0;g<c.length;g++){let m=c[g];for(let b=0;b<m.length;b++){let _=m[b],E=Math.round(_.x*a),M=Math.round(_.y*a);_.x=fi(E,dh,uh),_.y=fi(M,dh,uh),(E<_.x||E>_.x+1||M<_.y||M>_.y+1)&&Vi("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return c}function Vl(h,a){return{type:h.type,id:h.id,properties:h.properties,geometry:a?Bl(h):[]}}let Ob=-32768;function hD(h,a,c,g,m){h.emplaceBack(Ob+8*a+g,Ob+8*c+m)}class oy{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(c=>c.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new Re,this.indexArray=new ti,this.segments=new $t,this.programConfigurations=new Un(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(a,c,g){let m=this.layers[0],b=[],_=null,E=!1,M=m.type==="heatmap";if(m.type==="circle"){let A=m;_=A.layout.get("circle-sort-key"),E=!_.isConstant(),M=M||A.paint.get("circle-pitch-alignment")==="map"}let F=M?c.subdivisionGranularity.circle:1;for(let{feature:A,id:z,index:N,sourceLayerIndex:U}of a){let j=this.layers[0]._featureFilter.needGeometry,K=Vl(A,j);if(!this.layers[0]._featureFilter.filter(new ei(this.zoom),K,g))continue;let J=E?_.evaluate(K,{},g):void 0,se={id:z,properties:A.properties,type:A.type,sourceLayerIndex:U,index:N,geometry:j?K.geometry:Bl(A),patterns:{},sortKey:J};b.push(se)}E&&b.sort((A,z)=>A.sortKey-z.sortKey);for(let A of b){let{geometry:z,index:N,sourceLayerIndex:U}=A,j=a[N].feature;this.addFeature(A,z,N,g,F),c.featureIndex.insert(j,z,N,U,this.index)}}update(a,c,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,c,this.stateDependentLayers,{imagePositions:g})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,ri),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,c,g,m,b=1){let _;switch(b){case 1:_=[0,7];break;case 3:_=[0,2,5,7];break;case 5:_=[0,1,3,4,6,7];break;case 7:_=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${b}; valid values are 1, 3, 5, 7.`)}let E=_.length;for(let M of c)for(let F of M){let A=F.x,z=F.y;if(A<0||A>=Ct||z<0||z>=Ct)continue;let N=this.segments.prepareSegment(E*E,this.layoutVertexArray,this.indexArray,a.sortKey),U=N.vertexLength;for(let j=0;j<E;j++)for(let K=0;K<E;K++)hD(this.layoutVertexArray,A,z,_[K],_[j]);for(let j=0;j<E-1;j++)for(let K=0;K<E-1;K++){let J=U+j*E+K,se=U+(j+1)*E+K;this.indexArray.emplaceBack(J,se+1,J+1),this.indexArray.emplaceBack(J,se,se+1)}N.vertexLength+=E*E,N.primitiveLength+=(E-1)*(E-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,g,{imagePositions:{},canonical:m})}}function zb(h,a){for(let c=0;c<h.length;c++)if(ph(a,h[c]))return!0;for(let c=0;c<a.length;c++)if(ph(h,a[c]))return!0;return!!ny(h,a)}function nf(h,a,c){return!!ph(h,a)||!!ry(a,h,c)}function Bb(h,a){if(h.length===1)return Hb(a,h[0]);for(let c=0;c<a.length;c++){let g=a[c];for(let m=0;m<g.length;m++)if(ph(h,g[m]))return!0}for(let c=0;c<h.length;c++)if(Hb(a,h[c]))return!0;for(let c=0;c<a.length;c++)if(ny(h,a[c]))return!0;return!1}function uD(h,a,c){if(h.length>1){if(ny(h,a))return!0;for(let g=0;g<a.length;g++)if(ry(a[g],h,c))return!0}for(let g=0;g<h.length;g++)if(ry(h[g],a,c))return!0;return!1}function ny(h,a){if(h.length===0||a.length===0)return!1;for(let c=0;c<h.length-1;c++){let g=h[c],m=h[c+1];for(let b=0;b<a.length-1;b++)if(dD(g,m,a[b],a[b+1]))return!0}return!1}function dD(h,a,c,g){return xo(h,c,g)!==xo(a,c,g)&&xo(h,a,c)!==xo(h,a,g)}function ry(h,a,c){let g=c*c;if(a.length===1)return h.distSqr(a[0])<g;for(let m=1;m<a.length;m++)if(Vb(h,a[m-1],a[m])<g)return!0;return!1}function Vb(h,a,c){let g=a.distSqr(c);if(g===0)return h.distSqr(a);let m=((h.x-a.x)*(c.x-a.x)+(h.y-a.y)*(c.y-a.y))/g;return h.distSqr(m<0?a:m>1?c:c.sub(a)._mult(m)._add(a))}function Hb(h,a){let c,g,m,b=!1;for(let _=0;_<h.length;_++){c=h[_];for(let E=0,M=c.length-1;E<c.length;M=E++)g=c[E],m=c[M],g.y>a.y!=m.y>a.y&&a.x<(m.x-g.x)*(a.y-g.y)/(m.y-g.y)+g.x&&(b=!b)}return b}function ph(h,a){let c=!1;for(let g=0,m=h.length-1;g<h.length;m=g++){let b=h[g],_=h[m];b.y>a.y!=_.y>a.y&&a.x<(_.x-b.x)*(a.y-b.y)/(_.y-b.y)+b.x&&(c=!c)}return c}function pD(h,a,c){let g=c[0],m=c[2];if(h.x<g.x&&a.x<g.x||h.x>m.x&&a.x>m.x||h.y<g.y&&a.y<g.y||h.y>m.y&&a.y>m.y)return!1;let b=xo(h,a,c[0]);return b!==xo(h,a,c[1])||b!==xo(h,a,c[2])||b!==xo(h,a,c[3])}function gh(h,a,c){let g=a.paint.get(h).value;return g.kind==="constant"?g.value:c.programConfigurations.get(a.id).getMaxValue(h)}function rf(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function af(h,a,c,g,m){if(!a[0]&&!a[1])return h;let b=l.convert(a)._mult(m);c==="viewport"&&b._rotate(-g);let _=[];for(let E=0;E<h.length;E++)_.push(h[E].sub(b));return _}function gD({queryGeometry:h,size:a},c){return nf(h,c,a)}function fD({queryGeometry:h,size:a,transform:c,unwrappedTileID:g,getElevation:m},b){return nf(h,b,a*(c.projectTileCoordinates(b.x,b.y,g,m).signedDistanceFromCamera/c.cameraToCenterDistance))}function mD({queryGeometry:h,size:a,transform:c,unwrappedTileID:g,getElevation:m},b){let _=c.projectTileCoordinates(b.x,b.y,g,m).signedDistanceFromCamera,E=a*(c.cameraToCenterDistance/_);return nf(h,ay(b,c,g,m),E)}function vD({queryGeometry:h,size:a,transform:c,unwrappedTileID:g,getElevation:m},b){return nf(h,ay(b,c,g,m),a)}function Nb({queryGeometry:h,size:a,transform:c,unwrappedTileID:g,getElevation:m,pitchAlignment:b="map",pitchScale:_="map"},E){let M=b==="map"?_==="map"?gD:fD:_==="map"?mD:vD,F={queryGeometry:h,size:a,transform:c,unwrappedTileID:g,getElevation:m};for(let A of E)for(let z of A)if(M(F,z))return!0;return!1}function ay(h,a,c,g){let m=a.projectTileCoordinates(h.x,h.y,c,g).point;return new l((.5*m.x+.5)*a.width,(.5*-m.y+.5)*a.height)}let Gb,Wb;rt("CircleBucket",oy,{omit:["layers"]});var yD={get paint(){return Wb=Wb||new Ss({"circle-radius":new mt(xe.paint_circle["circle-radius"]),"circle-color":new mt(xe.paint_circle["circle-color"]),"circle-blur":new mt(xe.paint_circle["circle-blur"]),"circle-opacity":new mt(xe.paint_circle["circle-opacity"]),"circle-translate":new pt(xe.paint_circle["circle-translate"]),"circle-translate-anchor":new pt(xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new pt(xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new pt(xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new mt(xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new mt(xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new mt(xe.paint_circle["circle-stroke-opacity"])})},get layout(){return Gb=Gb||new Ss({"circle-sort-key":new mt(xe.layout_circle["circle-sort-key"])})}};class wD extends Mo{constructor(a,c){super(a,yD,c)}createBucket(a){return new oy(a)}queryRadius(a){let c=a;return gh("circle-radius",this,c)+gh("circle-stroke-width",this,c)+rf(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:a,feature:c,featureState:g,geometry:m,transform:b,pixelsToTileUnits:_,unwrappedTileID:E,getElevation:M}){let F=af(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-b.bearingInRadians,_),A=this.paint.get("circle-radius").evaluate(c,g)+this.paint.get("circle-stroke-width").evaluate(c,g),z=this.paint.get("circle-pitch-scale"),N=this.paint.get("circle-pitch-alignment"),U,j;return N==="map"?(U=F,j=A*_):(U=function(K,J,se,Ce){return K.map(ce=>ay(ce,J,se,Ce))}(F,b,E,M),j=A),Nb({queryGeometry:U,size:j,transform:b,unwrappedTileID:E,getElevation:M,pitchAlignment:N,pitchScale:z},m)}}class Ub extends oy{}let jb;rt("HeatmapBucket",Ub,{omit:["layers"]});var CD={get paint(){return jb=jb||new Ss({"heatmap-radius":new mt(xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new mt(xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new pt(xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new nh(xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new pt(xe.paint_heatmap["heatmap-opacity"])})}};function ly(h,{width:a,height:c},g,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==a*c*g)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${a*c*g}`)}else m=new Uint8Array(a*c*g);return h.width=a,h.height=c,h.data=m,h}function $b(h,{width:a,height:c},g){if(a===h.width&&c===h.height)return;let m=ly({},{width:a,height:c},g);cy(h,m,{x:0,y:0},{x:0,y:0},{width:Math.min(h.width,a),height:Math.min(h.height,c)},g),h.width=a,h.height=c,h.data=m.data}function cy(h,a,c,g,m,b){if(m.width===0||m.height===0)return a;if(m.width>h.width||m.height>h.height||c.x>h.width-m.width||c.y>h.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>a.width||m.height>a.height||g.x>a.width-m.width||g.y>a.height-m.height)throw new RangeError("out of range destination coordinates for image copy");let _=h.data,E=a.data;if(_===E)throw new Error("srcData equals dstData, so image is already copied");for(let M=0;M<m.height;M++){let F=((c.y+M)*h.width+c.x)*b,A=((g.y+M)*a.width+g.x)*b;for(let z=0;z<m.width*b;z++)E[A+z]=_[F+z]}return a}class Ad{constructor(a,c){ly(this,a,1,c)}resize(a){$b(this,a,1)}clone(){return new Ad({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,c,g,m,b){cy(a,c,g,m,b,1)}}class to{constructor(a,c){ly(this,a,4,c)}resize(a){$b(this,a,4)}replace(a,c){c?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new to({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,c,g,m,b){cy(a,c,g,m,b,4)}setPixel(a,c,g){let m=4*(a*this.width+c);this.data[m+0]=Math.round(255*g.r/g.a),this.data[m+1]=Math.round(255*g.g/g.a),this.data[m+2]=Math.round(255*g.b/g.a),this.data[m+3]=Math.round(255*g.a)}}function qb(h){let a={},c=h.resolution||256,g=h.clips?h.clips.length:1,m=h.image||new to({width:c,height:g});if(Math.log(c)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${c}`);let b=(_,E,M)=>{a[h.evaluationKey]=M;let F=h.expression.evaluate(a);m.setPixel(_/4/c,E/4,F)};if(h.clips)for(let _=0,E=0;_<g;++_,E+=4*c)for(let M=0,F=0;M<c;M++,F+=4){let A=M/(c-1),{start:z,end:N}=h.clips[_];b(E,F,z*(1-A)+N*A)}else for(let _=0,E=0;_<c;_++,E+=4)b(0,E,_/(c-1));return m}rt("AlphaImage",Ad),rt("RGBAImage",to);let hy="big-fb";class bD extends Mo{createBucket(a){return new Ub(a)}constructor(a,c){super(a,CD,c),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=qb({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(hy)&&this.heatmapFbos.delete(hy)}queryRadius(a){return gh("heatmap-radius",this,a)}queryIntersectsFeature({queryGeometry:a,feature:c,featureState:g,geometry:m,transform:b,pixelsToTileUnits:_,unwrappedTileID:E,getElevation:M}){return Nb({queryGeometry:a,size:this.paint.get("heatmap-radius").evaluate(c,g)*_,transform:b,unwrappedTileID:E,getElevation:M},m)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Zb;var xD={get paint(){return Zb=Zb||new Ss({"hillshade-illumination-direction":new pt(xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new pt(xe.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new pt(xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new pt(xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new pt(xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new pt(xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new pt(xe.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new pt(xe.paint_hillshade["hillshade-method"])})}};class _D extends Mo{constructor(a,c){super(a,xD,c),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let a=this.paint.get("hillshade-illumination-direction").values,c=this.paint.get("hillshade-illumination-altitude").values,g=this.paint.get("hillshade-highlight-color").values,m=this.paint.get("hillshade-shadow-color").values,b=Math.max(a.length,c.length,g.length,m.length);a=a.concat(Array(b-a.length).fill(a.at(-1))),c=c.concat(Array(b-c.length).fill(c.at(-1))),g=g.concat(Array(b-g.length).fill(g.at(-1))),m=m.concat(Array(b-m.length).fill(m.at(-1)));let _=c.map(gr);return{directionRadians:a.map(gr),altitudeRadians:_,shadowColor:m,highlightColor:g}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Kb;var SD={get paint(){return Kb=Kb||new Ss({"color-relief-opacity":new pt(xe["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new nh(xe["paint_color-relief"]["color-relief-color"])})}};class uy{constructor(a,c,g,m){this.context=a,this.format=g,this.texture=a.gl.createTexture(),this.update(c,m)}update(a,c,g){let{width:m,height:b}=a,_=!(this.size&&this.size[0]===m&&this.size[1]===b||g),{context:E}=this,{gl:M}=E;if(this.useMipmap=!!(c&&c.useMipmap),M.bindTexture(M.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA&&(!c||c.premultiply!==!1)),_)this.size=[m,b],a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||No(a)?M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,M.UNSIGNED_BYTE,a):M.texImage2D(M.TEXTURE_2D,0,this.format,m,b,0,this.format,M.UNSIGNED_BYTE,a.data);else{let{x:F,y:A}=g||{x:0,y:0};a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||No(a)?M.texSubImage2D(M.TEXTURE_2D,0,F,A,M.RGBA,M.UNSIGNED_BYTE,a):M.texSubImage2D(M.TEXTURE_2D,0,F,A,m,b,M.RGBA,M.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&M.generateMipmap(M.TEXTURE_2D),E.pixelStoreUnpackFlipY.setDefault(),E.pixelStoreUnpack.setDefault(),E.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(a,c,g){let{context:m}=this,{gl:b}=m;b.bindTexture(b.TEXTURE_2D,this.texture),g!==b.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(g=b.LINEAR),a!==this.filter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,a),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,g||a),this.filter=a),c!==this.wrap&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,c),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){let{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}class Xb{constructor(a,c,g,m=1,b=1,_=1,E=0){if(this.uid=a,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(g&&!["mapbox","terrarium","custom"].includes(g))return void Vi(`"${g}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=c.height;let M=this.dim=c.height-2;switch(this.data=new Uint32Array(c.data.buffer),g){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=b,this.blueFactor=_,this.baseShift=E;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let F=0;F<M;F++)this.data[this._idx(-1,F)]=this.data[this._idx(0,F)],this.data[this._idx(M,F)]=this.data[this._idx(M-1,F)],this.data[this._idx(F,-1)]=this.data[this._idx(F,0)],this.data[this._idx(F,M)]=this.data[this._idx(F,M-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(M,-1)]=this.data[this._idx(M-1,0)],this.data[this._idx(-1,M)]=this.data[this._idx(0,M-1)],this.data[this._idx(M,M)]=this.data[this._idx(M-1,M-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let F=0;F<M;F++)for(let A=0;A<M;A++){let z=this.get(F,A);z>this.max&&(this.max=z),z<this.min&&(this.min=z)}}get(a,c){let g=new Uint8Array(this.data.buffer),m=4*this._idx(a,c);return this.unpack(g[m],g[m+1],g[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(a,c){if(a<-1||a>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(a+1)}unpack(a,c,g){return a*this.redFactor+c*this.greenFactor+g*this.blueFactor-this.baseShift}pack(a){return Yb(a,this.getUnpackVector())}getPixels(){return new to({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(a,c,g){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let m=c*this.dim,b=c*this.dim+this.dim,_=g*this.dim,E=g*this.dim+this.dim;switch(c){case-1:m=b-1;break;case 1:b=m+1}switch(g){case-1:_=E-1;break;case 1:E=_+1}let M=-c*this.dim,F=-g*this.dim;for(let A=_;A<E;A++)for(let z=m;z<b;z++)this.data[this._idx(z,A)]=a.data[this._idx(z+M,A+F)]}}function Yb(h,a){let c=a[0],g=a[1],m=a[2],b=a[3],_=Math.min(c,g,m),E=Math.round((h+b)/_);return{r:Math.floor(E*_/c)%256,g:Math.floor(E*_/g)%256,b:Math.floor(E*_/m)%256}}rt("DEMData",Xb);class RD extends Mo{constructor(a,c){super(a,SD,c)}_createColorRamp(a){let c={elevationStops:[],colorStops:[]},g=this._transitionablePaint._values["color-relief-color"].value.expression;if(g instanceof Pl&&g._styleExpression.expression instanceof ms){this.colorRampExpression=g;let _=g._styleExpression.expression;c.elevationStops=_.labels,c.colorStops=[];for(let E of c.elevationStops)c.colorStops.push(_.evaluate({globals:{elevation:E}}))}if(c.elevationStops.length<1&&(c.elevationStops=[0],c.colorStops=[Ot.transparent]),c.elevationStops.length<2&&(c.elevationStops.push(c.elevationStops[0]+1),c.colorStops.push(c.colorStops[0])),c.elevationStops.length<=a)return c;let m={elevationStops:[],colorStops:[]},b=(c.elevationStops.length-1)/(a-1);for(let _=0;_<c.elevationStops.length-.5;_+=b)m.elevationStops.push(c.elevationStops[Math.round(_)]),m.colorStops.push(c.colorStops[Math.round(_)]);return Vi(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),m}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(a,c,g){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;let m=this._createColorRamp(c),b=new to({width:m.colorStops.length,height:1}),_=new to({width:m.colorStops.length,height:1});for(let E=0;E<m.elevationStops.length;E++){let M=Yb(m.elevationStops[E],g);_.setPixel(0,E,new Ot(M.r/255,M.g/255,M.b/255,1)),b.setPixel(0,E,m.colorStops[E])}return this.colorRampTextures={elevationTexture:new uy(a,_,a.gl.RGBA),colorTexture:new uy(a,b,a.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}let ED=Li([{name:"a_pos",components:2,type:"Int16"}],4),{members:PD}=ED;function dy(h,a,c){let g=c.patternDependencies,m=!1;for(let b of a){let _=b.paint.get(`${h}-pattern`);_.isConstant()||(m=!0);let E=_.constantOr(null);E&&(m=!0,g[E.to]=!0,g[E.from]=!0)}return m}function py(h,a,c,g,m){let{zoom:b}=g,_=m.patternDependencies;for(let E of a){let M=E.paint.get(`${h}-pattern`).value;if(M.kind!=="constant"){let F=M.evaluate({zoom:b-1},c,{},m.availableImages),A=M.evaluate({zoom:b},c,{},m.availableImages),z=M.evaluate({zoom:b+1},c,{},m.availableImages);F=F&&F.name?F.name:F,A=A&&A.name?A.name:A,z=z&&z.name?z.name:z,_[F]=!0,_[A]=!0,_[z]=!0,c.patterns[E.id]={min:F,mid:A,max:z}}}return c}function Qb(h,a,c,g,m){let b;if(m===function(_,E,M,F){let A=0;for(let z=E,N=M-F;z<M;z+=F)A+=(_[N]-_[z])*(_[z+1]+_[N+1]),N=z;return A}(h,a,c,g)>0)for(let _=a;_<c;_+=g)b=ix(_/g|0,h[_],h[_+1],b);else for(let _=c-g;_>=a;_-=g)b=ix(_/g|0,h[_],h[_+1],b);return b&&fh(b,b.next)&&(Bd(b),b=b.next),b}function Hl(h,a){if(!h)return h;a||(a=h);let c,g=h;do if(c=!1,g.steiner||!fh(g,g.next)&&Gi(g.prev,g,g.next)!==0)g=g.next;else{if(Bd(g),g=a=g.prev,g===g.next)break;c=!0}while(c||g!==a);return a}function Ld(h,a,c,g,m,b,_){if(!h)return;!_&&b&&function(M,F,A,z){let N=M;do N.z===0&&(N.z=gy(N.x,N.y,F,A,z)),N.prevZ=N.prev,N.nextZ=N.next,N=N.next;while(N!==M);N.prevZ.nextZ=null,N.prevZ=null,function(U){let j,K=1;do{let J,se=U;U=null;let Ce=null;for(j=0;se;){j++;let ce=se,pe=0;for(let Ie=0;Ie<K&&(pe++,ce=ce.nextZ,ce);Ie++);let Pe=K;for(;pe>0||Pe>0&&ce;)pe!==0&&(Pe===0||!ce||se.z<=ce.z)?(J=se,se=se.nextZ,pe--):(J=ce,ce=ce.nextZ,Pe--),Ce?Ce.nextZ=J:U=J,J.prevZ=Ce,Ce=J;se=ce}Ce.nextZ=null,K*=2}while(j>1)}(N)}(h,g,m,b);let E=h;for(;h.prev!==h.next;){let M=h.prev,F=h.next;if(b?TD(h,g,m,b):MD(h))a.push(M.i,h.i,F.i),Bd(h),h=F.next,E=F.next;else if((h=F)===E){_?_===1?Ld(h=DD(Hl(h),a),a,c,g,m,b,2):_===2&&FD(h,a,c,g,m,b):Ld(Hl(h),a,c,g,m,b,1);break}}}function MD(h){let a=h.prev,c=h,g=h.next;if(Gi(a,c,g)>=0)return!1;let m=a.x,b=c.x,_=g.x,E=a.y,M=c.y,F=g.y,A=Math.min(m,b,_),z=Math.min(E,M,F),N=Math.max(m,b,_),U=Math.max(E,M,F),j=g.next;for(;j!==a;){if(j.x>=A&&j.x<=N&&j.y>=z&&j.y<=U&&Od(m,E,b,M,_,F,j.x,j.y)&&Gi(j.prev,j,j.next)>=0)return!1;j=j.next}return!0}function TD(h,a,c,g){let m=h.prev,b=h,_=h.next;if(Gi(m,b,_)>=0)return!1;let E=m.x,M=b.x,F=_.x,A=m.y,z=b.y,N=_.y,U=Math.min(E,M,F),j=Math.min(A,z,N),K=Math.max(E,M,F),J=Math.max(A,z,N),se=gy(U,j,a,c,g),Ce=gy(K,J,a,c,g),ce=h.prevZ,pe=h.nextZ;for(;ce&&ce.z>=se&&pe&&pe.z<=Ce;){if(ce.x>=U&&ce.x<=K&&ce.y>=j&&ce.y<=J&&ce!==m&&ce!==_&&Od(E,A,M,z,F,N,ce.x,ce.y)&&Gi(ce.prev,ce,ce.next)>=0||(ce=ce.prevZ,pe.x>=U&&pe.x<=K&&pe.y>=j&&pe.y<=J&&pe!==m&&pe!==_&&Od(E,A,M,z,F,N,pe.x,pe.y)&&Gi(pe.prev,pe,pe.next)>=0))return!1;pe=pe.nextZ}for(;ce&&ce.z>=se;){if(ce.x>=U&&ce.x<=K&&ce.y>=j&&ce.y<=J&&ce!==m&&ce!==_&&Od(E,A,M,z,F,N,ce.x,ce.y)&&Gi(ce.prev,ce,ce.next)>=0)return!1;ce=ce.prevZ}for(;pe&&pe.z<=Ce;){if(pe.x>=U&&pe.x<=K&&pe.y>=j&&pe.y<=J&&pe!==m&&pe!==_&&Od(E,A,M,z,F,N,pe.x,pe.y)&&Gi(pe.prev,pe,pe.next)>=0)return!1;pe=pe.nextZ}return!0}function DD(h,a){let c=h;do{let g=c.prev,m=c.next.next;!fh(g,m)&&ex(g,c,c.next,m)&&zd(g,m)&&zd(m,g)&&(a.push(g.i,c.i,m.i),Bd(c),Bd(c.next),c=h=m),c=c.next}while(c!==h);return Hl(c)}function FD(h,a,c,g,m,b){let _=h;do{let E=_.next.next;for(;E!==_.prev;){if(_.i!==E.i&&OD(_,E)){let M=tx(_,E);return _=Hl(_,_.next),M=Hl(M,M.next),Ld(_,a,c,g,m,b,0),void Ld(M,a,c,g,m,b,0)}E=E.next}_=_.next}while(_!==h)}function ID(h,a){let c=h.x-a.x;return c===0&&(c=h.y-a.y,c===0)&&(c=(h.next.y-h.y)/(h.next.x-h.x)-(a.next.y-a.y)/(a.next.x-a.x)),c}function kD(h,a){let c=function(m,b){let _=b,E=m.x,M=m.y,F,A=-1/0;if(fh(m,_))return _;do{if(fh(m,_.next))return _.next;if(M<=_.y&&M>=_.next.y&&_.next.y!==_.y){let K=_.x+(M-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(K<=E&&K>A&&(A=K,F=_.x<_.next.x?_:_.next,K===E))return F}_=_.next}while(_!==b);if(!F)return null;let z=F,N=F.x,U=F.y,j=1/0;_=F;do{if(E>=_.x&&_.x>=N&&E!==_.x&&Jb(M<U?E:A,M,N,U,M<U?A:E,M,_.x,_.y)){let K=Math.abs(M-_.y)/(E-_.x);zd(_,m)&&(K<j||K===j&&(_.x>F.x||_.x===F.x&&AD(F,_)))&&(F=_,j=K)}_=_.next}while(_!==z);return F}(h,a);if(!c)return a;let g=tx(c,h);return Hl(g,g.next),Hl(c,c.next)}function AD(h,a){return Gi(h.prev,h,a.prev)<0&&Gi(a.next,h,h.next)<0}function gy(h,a,c,g,m){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-c)*m|0)|h<<8))|h<<4))|h<<2))|h<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-g)*m|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function LD(h){let a=h,c=h;do(a.x<c.x||a.x===c.x&&a.y<c.y)&&(c=a),a=a.next;while(a!==h);return c}function Jb(h,a,c,g,m,b,_,E){return(m-_)*(a-E)>=(h-_)*(b-E)&&(h-_)*(g-E)>=(c-_)*(a-E)&&(c-_)*(b-E)>=(m-_)*(g-E)}function Od(h,a,c,g,m,b,_,E){return!(h===_&&a===E)&&Jb(h,a,c,g,m,b,_,E)}function OD(h,a){return h.next.i!==a.i&&h.prev.i!==a.i&&!function(c,g){let m=c;do{if(m.i!==c.i&&m.next.i!==c.i&&m.i!==g.i&&m.next.i!==g.i&&ex(m,m.next,c,g))return!0;m=m.next}while(m!==c);return!1}(h,a)&&(zd(h,a)&&zd(a,h)&&function(c,g){let m=c,b=!1,_=(c.x+g.x)/2,E=(c.y+g.y)/2;do m.y>E!=m.next.y>E&&m.next.y!==m.y&&_<(m.next.x-m.x)*(E-m.y)/(m.next.y-m.y)+m.x&&(b=!b),m=m.next;while(m!==c);return b}(h,a)&&(Gi(h.prev,h,a.prev)||Gi(h,a.prev,a))||fh(h,a)&&Gi(h.prev,h,h.next)>0&&Gi(a.prev,a,a.next)>0)}function Gi(h,a,c){return(a.y-h.y)*(c.x-a.x)-(a.x-h.x)*(c.y-a.y)}function fh(h,a){return h.x===a.x&&h.y===a.y}function ex(h,a,c,g){let m=cf(Gi(h,a,c)),b=cf(Gi(h,a,g)),_=cf(Gi(c,g,h)),E=cf(Gi(c,g,a));return m!==b&&_!==E||!(m!==0||!lf(h,c,a))||!(b!==0||!lf(h,g,a))||!(_!==0||!lf(c,h,g))||!(E!==0||!lf(c,a,g))}function lf(h,a,c){return a.x<=Math.max(h.x,c.x)&&a.x>=Math.min(h.x,c.x)&&a.y<=Math.max(h.y,c.y)&&a.y>=Math.min(h.y,c.y)}function cf(h){return h>0?1:h<0?-1:0}function zd(h,a){return Gi(h.prev,h,h.next)<0?Gi(h,a,h.next)>=0&&Gi(h,h.prev,a)>=0:Gi(h,a,h.prev)<0||Gi(h,h.next,a)<0}function tx(h,a){let c=fy(h.i,h.x,h.y),g=fy(a.i,a.x,a.y),m=h.next,b=a.prev;return h.next=a,a.prev=h,c.next=m,m.prev=c,g.next=c,c.prev=g,b.next=g,g.prev=b,g}function ix(h,a,c,g){let m=fy(h,a,c);return g?(m.next=g.next,m.prev=g,g.next.prev=m,g.next=m):(m.prev=m,m.next=m),m}function Bd(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function fy(h,a,c){return{i:h,x:a,y:c,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class mh{constructor(a,c){if(c>a)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=a,this._minGranularity=c}getGranularityForZoomLevel(a){return Math.max(Math.floor(this._baseZoomGranularity/(1<<a)),this._minGranularity,1)}}class hf{constructor(a){this.fill=a.fill,this.line=a.line,this.tile=a.tile,this.stencil=a.stencil,this.circle=a.circle}}hf.noSubdivision=new hf({fill:new mh(0,0),line:new mh(0,0),tile:new mh(0,0),stencil:new mh(0,0),circle:1}),rt("SubdivisionGranularityExpression",mh),rt("SubdivisionGranularitySetting",hf);let vh=-32768,Vd=32767;class zD{constructor(a,c){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=a,this._granularityCellSize=Ct/a,this._canonical=c}_getKey(a,c){return(a+=32768)<<16|c+32768}_vertexToIndex(a,c){if(a<-32768||c<-32768||a>32767||c>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");let g=0|Math.round(a),m=0|Math.round(c),b=this._getKey(g,m);if(this._vertexDictionary.has(b))return this._vertexDictionary.get(b);let _=this._vertexBuffer.length/2;return this._vertexDictionary.set(b,_),this._vertexBuffer.push(g,m),_}_subdivideTrianglesScanline(a){if(this._granularity<2)return function(m,b){let _=[];for(let E=0;E<b.length;E+=3){let M=b[E],F=b[E+1],A=b[E+2],z=m[2*M],N=m[2*M+1];(m[2*F]-z)*(m[2*A+1]-N)-(m[2*F+1]-N)*(m[2*A]-z)>0?(_.push(M),_.push(A),_.push(F)):(_.push(M),_.push(F),_.push(A))}return _}(this._vertexBuffer,a);let c=[],g=a.length;for(let m=0;m<g;m+=3){let b=[a[m+0],a[m+1],a[m+2]],_=[this._vertexBuffer[2*a[m+0]+0],this._vertexBuffer[2*a[m+0]+1],this._vertexBuffer[2*a[m+1]+0],this._vertexBuffer[2*a[m+1]+1],this._vertexBuffer[2*a[m+2]+0],this._vertexBuffer[2*a[m+2]+1]],E=1/0,M=1/0,F=-1/0,A=-1/0;for(let K=0;K<3;K++){let J=_[2*K],se=_[2*K+1];E=Math.min(E,J),F=Math.max(F,J),M=Math.min(M,se),A=Math.max(A,se)}if(E===F||M===A)continue;let z=Math.floor(E/this._granularityCellSize),N=Math.ceil(F/this._granularityCellSize),U=Math.floor(M/this._granularityCellSize),j=Math.ceil(A/this._granularityCellSize);if(z!==N||U!==j)for(let K=U;K<j;K++){let J=this._scanlineGenerateVertexRingForCellRow(K,_,b);BD(this._vertexBuffer,J,c)}else c.push(...b)}return c}_scanlineGenerateVertexRingForCellRow(a,c,g){let m=a*this._granularityCellSize,b=m+this._granularityCellSize,_=[];for(let E=0;E<3;E++){let M=c[2*E],F=c[2*E+1],A=c[2*(E+1)%6],z=c[(2*(E+1)+1)%6],N=c[2*(E+2)%6],U=c[(2*(E+2)+1)%6],j=A-M,K=z-F,J=j===0,se=K===0,Ce=(m-F)/K,ce=(b-F)/K,pe=Math.min(Ce,ce),Pe=Math.max(Ce,ce);if(!se&&(pe>=1||Pe<=0)||se&&(F<m||F>b)){z>=m&&z<=b&&_.push(g[(E+1)%3]);continue}!se&&pe>0&&_.push(this._vertexToIndex(M+j*pe,F+K*pe));let Ie=M+j*Math.max(pe,0),Ne=M+j*Math.min(Pe,1);J||this._generateIntraEdgeVertices(_,M,F,A,z,Ie,Ne),!se&&Pe<1&&_.push(this._vertexToIndex(M+j*Pe,F+K*Pe)),(se||z>=m&&z<=b)&&_.push(g[(E+1)%3]),!se&&(z<=m||z>=b)&&this._generateInterEdgeVertices(_,M,F,A,z,N,U,Ne,m,b)}return _}_generateIntraEdgeVertices(a,c,g,m,b,_,E){let M=m-c,F=b-g,A=F===0,z=A?Math.min(c,m):Math.min(_,E),N=A?Math.max(c,m):Math.max(_,E),U=Math.floor(z/this._granularityCellSize)+1,j=Math.ceil(N/this._granularityCellSize)-1;if(A?c<m:_<E)for(let K=U;K<=j;K++){let J=K*this._granularityCellSize;a.push(this._vertexToIndex(J,g+F*(J-c)/M))}else for(let K=j;K>=U;K--){let J=K*this._granularityCellSize;a.push(this._vertexToIndex(J,g+F*(J-c)/M))}}_generateInterEdgeVertices(a,c,g,m,b,_,E,M,F,A){let z=b-g,N=_-m,U=E-b,j=(F-b)/U,K=(A-b)/U,J=Math.min(j,K),se=Math.max(j,K),Ce=m+N*J,ce=Math.floor(Math.min(Ce,M)/this._granularityCellSize)+1,pe=Math.ceil(Math.max(Ce,M)/this._granularityCellSize)-1,Pe=M<Ce,Ie=U===0;if(Ie&&(E===F||E===A))return;if(Ie||J>=1||se<=0){let et=g-E,qe=_+(c-_)*Math.min((F-E)/et,(A-E)/et);ce=Math.floor(Math.min(qe,M)/this._granularityCellSize)+1,pe=Math.ceil(Math.max(qe,M)/this._granularityCellSize)-1,Pe=M<qe}let Ne=z>0?A:F;if(Pe)for(let et=ce;et<=pe;et++)a.push(this._vertexToIndex(et*this._granularityCellSize,Ne));else for(let et=pe;et>=ce;et--)a.push(this._vertexToIndex(et*this._granularityCellSize,Ne))}_generateOutline(a){let c=[];for(let g of a){let m=Nl(g,this._granularity,!0),b=this._pointArrayToIndices(m),_=[];for(let E=1;E<b.length;E++)_.push(b[E-1]),_.push(b[E]);c.push(_)}return c}_handlePoles(a){let c=!1,g=!1;this._canonical&&(this._canonical.y===0&&(c=!0),this._canonical.y===(1<<this._canonical.z)-1&&(g=!0)),(c||g)&&this._fillPoles(a,c,g)}_ensureNoPoleVertices(){let a=this._vertexBuffer;for(let c=0;c<a.length;c+=2){let g=a[c+1];g===vh&&(a[c+1]=-32767),g===Vd&&(a[c+1]=32766)}}_generatePoleQuad(a,c,g,m,b,_){m>b!=(_===vh)?(a.push(c),a.push(g),a.push(this._vertexToIndex(m,_)),a.push(g),a.push(this._vertexToIndex(b,_)),a.push(this._vertexToIndex(m,_))):(a.push(g),a.push(c),a.push(this._vertexToIndex(m,_)),a.push(this._vertexToIndex(b,_)),a.push(g),a.push(this._vertexToIndex(m,_)))}_fillPoles(a,c,g){let m=this._vertexBuffer,b=Ct,_=a.length;for(let E=2;E<_;E+=3){let M=a[E-2],F=a[E-1],A=a[E],z=m[2*M],N=m[2*M+1],U=m[2*F],j=m[2*F+1],K=m[2*A],J=m[2*A+1];c&&(N===0&&j===0&&this._generatePoleQuad(a,M,F,z,U,vh),j===0&&J===0&&this._generatePoleQuad(a,F,A,U,K,vh),J===0&&N===0&&this._generatePoleQuad(a,A,M,K,z,vh)),g&&(N===b&&j===b&&this._generatePoleQuad(a,M,F,z,U,Vd),j===b&&J===b&&this._generatePoleQuad(a,F,A,U,K,Vd),J===b&&N===b&&this._generatePoleQuad(a,A,M,K,z,Vd))}}_initializeVertices(a){for(let c=0;c<a.length;c+=2)this._vertexToIndex(a[c],a[c+1])}subdividePolygonInternal(a,c){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;let{flattened:g,holeIndices:m}=function(E){let M=[],F=[];for(let A of E)if(A.length!==0){A!==E[0]&&M.push(F.length/2);for(let z=0;z<A.length;z++)F.push(A[z].x),F.push(A[z].y)}return{flattened:F,holeIndices:M}}(a),b;this._initializeVertices(g);try{let E=function(F,A,z=2){let N=A&&A.length,U=N?A[0]*z:F.length,j=Qb(F,0,U,z,!0),K=[];if(!j||j.next===j.prev)return K;let J,se,Ce;if(N&&(j=function(ce,pe,Pe,Ie){let Ne=[];for(let et=0,qe=pe.length;et<qe;et++){let Qe=Qb(ce,pe[et]*Ie,et<qe-1?pe[et+1]*Ie:ce.length,Ie,!1);Qe===Qe.next&&(Qe.steiner=!0),Ne.push(LD(Qe))}Ne.sort(ID);for(let et=0;et<Ne.length;et++)Pe=kD(Ne[et],Pe);return Pe}(F,A,j,z)),F.length>80*z){J=F[0],se=F[1];let ce=J,pe=se;for(let Pe=z;Pe<U;Pe+=z){let Ie=F[Pe],Ne=F[Pe+1];Ie<J&&(J=Ie),Ne<se&&(se=Ne),Ie>ce&&(ce=Ie),Ne>pe&&(pe=Ne)}Ce=Math.max(ce-J,pe-se),Ce=Ce!==0?32767/Ce:0}return Ld(j,K,z,J,se,Ce,0),K}(g,m),M=this._convertIndices(g,E);b=this._subdivideTrianglesScanline(M)}catch(E){console.error(E)}let _=[];return c&&(_=this._generateOutline(a)),this._ensureNoPoleVertices(),this._handlePoles(b),{verticesFlattened:this._vertexBuffer,indicesTriangles:b,indicesLineList:_}}_convertIndices(a,c){let g=[];for(let m=0;m<c.length;m++)g.push(this._vertexToIndex(a[2*c[m]],a[2*c[m]+1]));return g}_pointArrayToIndices(a){let c=[];for(let g=0;g<a.length;g++){let m=a[g];c.push(this._vertexToIndex(m.x,m.y))}return c}}function sx(h,a,c,g=!0){return new zD(c,a).subdividePolygonInternal(h,g)}function Nl(h,a,c=!1){if(!h||h.length<1)return[];if(h.length<2)return[];let g=h[0],m=h[h.length-1],b=c&&(g.x!==m.x||g.y!==m.y);if(a<2)return b?[...h,h[0]]:[...h];let _=Math.floor(Ct/a),E=[];E.push(new l(h[0].x,h[0].y));let M=h.length,F=b?M:M-1;for(let A=0;A<F;A++){let z=h[A],N=A<M-1?h[A+1]:h[0],U=z.x,j=z.y,K=N.x,J=N.y,se=U!==K,Ce=j!==J;if(!se&&!Ce)continue;let ce=K-U,pe=J-j,Pe=Math.abs(ce),Ie=Math.abs(pe),Ne=U,et=j;for(;;){let Qe=ce>0?(Math.floor(Ne/_)+1)*_:(Math.ceil(Ne/_)-1)*_,gt=pe>0?(Math.floor(et/_)+1)*_:(Math.ceil(et/_)-1)*_,Ye=Math.abs(Ne-Qe),Je=Math.abs(et-gt),ze=Math.abs(Ne-K),wt=Math.abs(et-J),_t=se?Ye/Pe:Number.POSITIVE_INFINITY,vt=Ce?Je/Ie:Number.POSITIVE_INFINITY;if((ze<=Ye||!se)&&(wt<=Je||!Ce))break;if(_t<vt&&se||!Ce){Ne=Qe,et+=pe*_t;let dt=new l(Ne,Math.round(et));E[E.length-1].x===dt.x&&E[E.length-1].y===dt.y||E.push(dt)}else{Ne+=ce*vt,et=gt;let dt=new l(Math.round(Ne),et);E[E.length-1].x===dt.x&&E[E.length-1].y===dt.y||E.push(dt)}}let qe=new l(K,J);E[E.length-1].x===qe.x&&E[E.length-1].y===qe.y||E.push(qe)}return E}function BD(h,a,c){if(a.length===0)throw new Error("Subdivision vertex ring is empty.");let g=0,m=h[2*a[0]];for(let M=1;M<a.length;M++){let F=h[2*a[M]];F<m&&(m=F,g=M)}let b=a.length,_=g,E=(_+1)%b;for(;;){let M=_-1>=0?_-1:b-1,F=(E+1)%b,A=h[2*a[M]],z=h[2*a[F]],N=h[2*a[_]],U=h[2*a[_]+1],j=h[2*a[E]+1],K=!1;if(A<z)K=!0;else if(A>z)K=!1;else{let J=j-U,se=-(h[2*a[E]]-N),Ce=U<j?1:-1;((A-N)*J+(h[2*a[M]+1]-U)*se)*Ce>((z-N)*J+(h[2*a[F]+1]-U)*se)*Ce&&(K=!0)}if(K){let J=a[M],se=a[_],Ce=a[E];J!==se&&J!==Ce&&se!==Ce&&c.push(Ce,se,J),_--,_<0&&(_=b-1)}else{let J=a[F],se=a[_],Ce=a[E];J!==se&&J!==Ce&&se!==Ce&&c.push(Ce,se,J),E++,E>=b&&(E=0)}if(M===F)break}}function ox(h,a,c,g,m,b,_,E,M){let F=m.length/2,A=_&&E&&M;if(F<$t.MAX_VERTEX_ARRAY_LENGTH){let z=a.prepareSegment(F,c,g),N=z.vertexLength;for(let K=0;K<b.length;K+=3)g.emplaceBack(N+b[K],N+b[K+1],N+b[K+2]);let U,j;z.vertexLength+=F,z.primitiveLength+=b.length/3,A&&(j=_.prepareSegment(F,c,E),U=j.vertexLength,j.vertexLength+=F);for(let K=0;K<m.length;K+=2)h(m[K],m[K+1]);if(A)for(let K=0;K<M.length;K++){let J=M[K];for(let se=1;se<J.length;se+=2)E.emplaceBack(U+J[se-1],U+J[se]);j.primitiveLength+=J.length/2}}else(function(z,N,U,j,K,J){let se=[];for(let Ie=0;Ie<j.length/2;Ie++)se.push(-1);let Ce={count:0},ce=0,pe=z.getOrCreateLatestSegment(N,U),Pe=pe.vertexLength;for(let Ie=2;Ie<K.length;Ie+=3){let Ne=K[Ie-2],et=K[Ie-1],qe=K[Ie],Qe=se[Ne]<ce,gt=se[et]<ce,Ye=se[qe]<ce;pe.vertexLength+((Qe?1:0)+(gt?1:0)+(Ye?1:0))>$t.MAX_VERTEX_ARRAY_LENGTH&&(pe=z.createNewSegment(N,U),ce=Ce.count,Qe=!0,gt=!0,Ye=!0,Pe=0);let Je=Hd(se,j,J,Ce,Ne,Qe,pe),ze=Hd(se,j,J,Ce,et,gt,pe),wt=Hd(se,j,J,Ce,qe,Ye,pe);U.emplaceBack(Pe+Je-ce,Pe+ze-ce,Pe+wt-ce),pe.primitiveLength++}})(a,c,g,m,b,h),A&&function(z,N,U,j,K,J){let se=[];for(let Ie=0;Ie<j.length/2;Ie++)se.push(-1);let Ce={count:0},ce=0,pe=z.getOrCreateLatestSegment(N,U),Pe=pe.vertexLength;for(let Ie=0;Ie<K.length;Ie++){let Ne=K[Ie];for(let et=1;et<K[Ie].length;et+=2){let qe=Ne[et-1],Qe=Ne[et],gt=se[qe]<ce,Ye=se[Qe]<ce;pe.vertexLength+((gt?1:0)+(Ye?1:0))>$t.MAX_VERTEX_ARRAY_LENGTH&&(pe=z.createNewSegment(N,U),ce=Ce.count,gt=!0,Ye=!0,Pe=0);let Je=Hd(se,j,J,Ce,qe,gt,pe),ze=Hd(se,j,J,Ce,Qe,Ye,pe);U.emplaceBack(Pe+Je-ce,Pe+ze-ce),pe.primitiveLength++}}}(_,c,E,m,M,h),a.forceNewSegmentOnNextPrepare(),_?.forceNewSegmentOnNextPrepare()}function Hd(h,a,c,g,m,b,_){if(b){let E=g.count;return c(a[2*m],a[2*m+1]),h[m]=g.count,g.count++,_.vertexLength++,E}return h[m]}class my{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(c=>c.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ee,this.indexArray=new ti,this.indexArray2=new wi,this.programConfigurations=new Un(a.layers,a.zoom),this.segments=new $t,this.segments2=new $t,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(a,c,g){this.hasPattern=dy("fill",this.layers,c);let m=this.layers[0].layout.get("fill-sort-key"),b=!m.isConstant(),_=[];for(let{feature:E,id:M,index:F,sourceLayerIndex:A}of a){let z=this.layers[0]._featureFilter.needGeometry,N=Vl(E,z);if(!this.layers[0]._featureFilter.filter(new ei(this.zoom),N,g))continue;let U=b?m.evaluate(N,{},g,c.availableImages):void 0,j={id:M,properties:E.properties,type:E.type,sourceLayerIndex:A,index:F,geometry:z?N.geometry:Bl(E),patterns:{},sortKey:U};_.push(j)}b&&_.sort((E,M)=>E.sortKey-M.sortKey);for(let E of _){let{geometry:M,index:F,sourceLayerIndex:A}=E;if(this.hasPattern){let z=py("fill",this.layers,E,{zoom:this.zoom},c);this.patternFeatures.push(z)}else this.addFeature(E,M,F,g,{},c.subdivisionGranularity);c.featureIndex.insert(a[F].feature,M,F,A,this.index)}}update(a,c,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,c,this.stateDependentLayers,{imagePositions:g})}addFeatures(a,c,g){for(let m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,c,g,a.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,PD),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,c,g,m,b,_){for(let E of xl(c,500)){let M=sx(E,m,_.fill.getGranularityForZoomLevel(m.z)),F=this.layoutVertexArray;ox((A,z)=>{F.emplaceBack(A,z)},this.segments,this.layoutVertexArray,this.indexArray,M.verticesFlattened,M.indicesTriangles,this.segments2,this.indexArray2,M.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,g,{imagePositions:b,canonical:m})}}let nx,rx;rt("FillBucket",my,{omit:["layers","patternFeatures"]});var VD={get paint(){return rx=rx||new Ss({"fill-antialias":new pt(xe.paint_fill["fill-antialias"]),"fill-opacity":new mt(xe.paint_fill["fill-opacity"]),"fill-color":new mt(xe.paint_fill["fill-color"]),"fill-outline-color":new mt(xe.paint_fill["fill-outline-color"]),"fill-translate":new pt(xe.paint_fill["fill-translate"]),"fill-translate-anchor":new pt(xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new oh(xe.paint_fill["fill-pattern"])})},get layout(){return nx=nx||new Ss({"fill-sort-key":new mt(xe.layout_fill["fill-sort-key"])})}};class HD extends Mo{constructor(a,c){super(a,VD,c)}recalculate(a,c){super.recalculate(a,c);let g=this.paint._values["fill-outline-color"];g.value.kind==="constant"&&g.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new my(a)}queryRadius(){return rf(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:a,geometry:c,transform:g,pixelsToTileUnits:m}){return Bb(af(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-g.bearingInRadians,m),c)}isTileClipped(){return!0}}let ND=Li([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),GD=Li([{name:"a_centroid",components:2,type:"Int16"}],4),{members:WD}=ND;class yh{constructor(a,c,g,m,b){this.properties={},this.extent=g,this.type=0,this.id=void 0,this._pbf=a,this._geometry=-1,this._keys=m,this._values=b,a.readFields(UD,this,c)}loadGeometry(){let a=this._pbf;a.pos=this._geometry;let c=a.readVarint()+a.pos,g=[],m,b=1,_=0,E=0,M=0;for(;a.pos<c;){if(_<=0){let F=a.readVarint();b=7&F,_=F>>3}if(_--,b===1||b===2)E+=a.readSVarint(),M+=a.readSVarint(),b===1&&(m&&g.push(m),m=[]),m&&m.push(new l(E,M));else{if(b!==7)throw new Error(`unknown command ${b}`);m&&m.push(m[0].clone())}}return m&&g.push(m),g}bbox(){let a=this._pbf;a.pos=this._geometry;let c=a.readVarint()+a.pos,g=1,m=0,b=0,_=0,E=1/0,M=-1/0,F=1/0,A=-1/0;for(;a.pos<c;){if(m<=0){let z=a.readVarint();g=7&z,m=z>>3}if(m--,g===1||g===2)b+=a.readSVarint(),_+=a.readSVarint(),b<E&&(E=b),b>M&&(M=b),_<F&&(F=_),_>A&&(A=_);else if(g!==7)throw new Error(`unknown command ${g}`)}return[E,F,M,A]}toGeoJSON(a,c,g){let m=this.extent*Math.pow(2,g),b=this.extent*a,_=this.extent*c,E=this.loadGeometry();function M(N){return[360*(N.x+b)/m-180,360/Math.PI*Math.atan(Math.exp((1-2*(N.y+_)/m)*Math.PI))-90]}function F(N){return N.map(M)}let A;if(this.type===1){let N=[];for(let j of E)N.push(j[0]);let U=F(N);A=N.length===1?{type:"Point",coordinates:U[0]}:{type:"MultiPoint",coordinates:U}}else if(this.type===2){let N=E.map(F);A=N.length===1?{type:"LineString",coordinates:N[0]}:{type:"MultiLineString",coordinates:N}}else{if(this.type!==3)throw new Error("unknown feature type");{let N=function(j){let K=j.length;if(K<=1)return[j];let J=[],se,Ce;for(let ce=0;ce<K;ce++){let pe=jD(j[ce]);pe!==0&&(Ce===void 0&&(Ce=pe<0),Ce===pe<0?(se&&J.push(se),se=[j[ce]]):se&&se.push(j[ce]))}return se&&J.push(se),J}(E),U=[];for(let j of N)U.push(j.map(F));A=U.length===1?{type:"Polygon",coordinates:U[0]}:{type:"MultiPolygon",coordinates:U}}}let z={type:"Feature",geometry:A,properties:this.properties};return this.id!=null&&(z.id=this.id),z}}function UD(h,a,c){h===1?a.id=c.readVarint():h===2?function(g,m){let b=g.readVarint()+g.pos;for(;g.pos<b;){let _=m._keys[g.readVarint()],E=m._values[g.readVarint()];m.properties[_]=E}}(c,a):h===3?a.type=c.readVarint():h===4&&(a._geometry=c.pos)}function jD(h){let a=0;for(let c,g,m=0,b=h.length,_=b-1;m<b;_=m++)c=h[m],g=h[_],a+=(g.x-c.x)*(c.y+g.y);return a}yh.types=["Unknown","Point","LineString","Polygon"];class ax{constructor(a,c){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields($D,this,c),this.length=this._features.length}feature(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];let c=this._pbf.readVarint()+this._pbf.pos;return new yh(this._pbf,c,this.extent,this._keys,this._values)}}function $D(h,a,c){h===15?a.version=c.readVarint():h===1?a.name=c.readString():h===5?a.extent=c.readVarint():h===2?a._features.push(c.pos):h===3?a._keys.push(c.readString()):h===4&&a._values.push(function(g){let m=null,b=g.readVarint()+g.pos;for(;g.pos<b;){let _=g.readVarint()>>3;m=_===1?g.readString():_===2?g.readFloat():_===3?g.readDouble():_===4?g.readVarint64():_===5?g.readVarint():_===6?g.readSVarint():_===7?g.readBoolean():null}if(m==null)throw new Error("unknown feature value");return m}(c))}class lx{constructor(a,c){this.layers=a.readFields(qD,{},c)}}function qD(h,a,c){if(h===3){let g=new ax(c,c.readVarint()+c.pos);g.length&&(a[g.name]=g)}}let vy=Math.pow(2,13);function Nd(h,a,c,g,m,b,_,E){h.emplaceBack(a,c,2*Math.floor(g*vy)+_,m*vy*2,b*vy*2,Math.round(E))}class yy{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(c=>c.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new De,this.centroidVertexArray=new Te,this.indexArray=new ti,this.programConfigurations=new Un(a.layers,a.zoom),this.segments=new $t,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(a,c,g){this.features=[],this.hasPattern=dy("fill-extrusion",this.layers,c);for(let{feature:m,id:b,index:_,sourceLayerIndex:E}of a){let M=this.layers[0]._featureFilter.needGeometry,F=Vl(m,M);if(!this.layers[0]._featureFilter.filter(new ei(this.zoom),F,g))continue;let A={id:b,sourceLayerIndex:E,index:_,geometry:M?F.geometry:Bl(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push(py("fill-extrusion",this.layers,A,{zoom:this.zoom},c)):this.addFeature(A,A.geometry,_,g,{},c.subdivisionGranularity),c.featureIndex.insert(m,A.geometry,_,E,this.index,!0)}}addFeatures(a,c,g){for(let m of this.features){let{geometry:b}=m;this.addFeature(m,b,m.index,c,g,a.subdivisionGranularity)}}update(a,c,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,c,this.stateDependentLayers,{imagePositions:g})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,WD),this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,GD.members,!0),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(a,c,g,m,b,_){for(let E of xl(c,500)){let M={x:0,y:0,sampleCount:0},F=this.layoutVertexArray.length;this.processPolygon(M,m,a,E,_);let A=this.layoutVertexArray.length-F,z=Math.floor(M.x/M.sampleCount),N=Math.floor(M.y/M.sampleCount);for(let U=0;U<A;U++)this.centroidVertexArray.emplaceBack(z,N)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,g,{imagePositions:b,canonical:m})}processPolygon(a,c,g,m,b){if(m.length<1||cx(m[0]))return;for(let z of m)z.length!==0&&ZD(a,z);let _={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},E=b.fill.getGranularityForZoomLevel(c.z),M=yh.types[g.type]==="Polygon";for(let z of m){if(z.length===0||cx(z))continue;let N=Nl(z,E,M);this._generateSideFaces(N,_)}if(!M)return;let F=sx(m,c,E,!1),A=this.layoutVertexArray;ox((z,N)=>{Nd(A,z,N,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,F.verticesFlattened,F.indicesTriangles)}_generateSideFaces(a,c){let g=0;for(let m=1;m<a.length;m++){let b=a[m],_=a[m-1];if(KD(b,_))continue;c.segment.vertexLength+4>$t.MAX_VERTEX_ARRAY_LENGTH&&(c.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let E=b.sub(_)._perp()._unit(),M=_.dist(b);g+M>32768&&(g=0),Nd(this.layoutVertexArray,b.x,b.y,E.x,E.y,0,0,g),Nd(this.layoutVertexArray,b.x,b.y,E.x,E.y,0,1,g),g+=M,Nd(this.layoutVertexArray,_.x,_.y,E.x,E.y,0,0,g),Nd(this.layoutVertexArray,_.x,_.y,E.x,E.y,0,1,g);let F=c.segment.vertexLength;this.indexArray.emplaceBack(F,F+2,F+1),this.indexArray.emplaceBack(F+1,F+2,F+3),c.segment.vertexLength+=4,c.segment.primitiveLength+=2}}}function ZD(h,a){for(let c=0;c<a.length;c++){let g=a[c];c===a.length-1&&a[0].x===g.x&&a[0].y===g.y||(h.x+=g.x,h.y+=g.y,h.sampleCount++)}}function KD(h,a){return h.x===a.x&&(h.x<0||h.x>Ct)||h.y===a.y&&(h.y<0||h.y>Ct)}function cx(h){return h.every(a=>a.x<0)||h.every(a=>a.x>Ct)||h.every(a=>a.y<0)||h.every(a=>a.y>Ct)}let hx;rt("FillExtrusionBucket",yy,{omit:["layers","features"]});var XD={get paint(){return hx=hx||new Ss({"fill-extrusion-opacity":new pt(xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new mt(xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new pt(xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new pt(xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new oh(xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new mt(xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new mt(xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new pt(xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class YD extends Mo{constructor(a,c){super(a,XD,c)}createBucket(a){return new yy(a)}queryRadius(){return rf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:a,feature:c,featureState:g,geometry:m,transform:b,pixelsToTileUnits:_,pixelPosMatrix:E}){let M=af(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-b.bearingInRadians,_),F=this.paint.get("fill-extrusion-height").evaluate(c,g),A=this.paint.get("fill-extrusion-base").evaluate(c,g),z=function(U,j){let K=[];for(let J of U){let se=[J.x,J.y,0,1];lt(se,se,j),K.push(new l(se[0]/se[3],se[1]/se[3]))}return K}(M,E),N=function(U,j,K,J){let se=[],Ce=[],ce=J[8]*j,pe=J[9]*j,Pe=J[10]*j,Ie=J[11]*j,Ne=J[8]*K,et=J[9]*K,qe=J[10]*K,Qe=J[11]*K;for(let gt of U){let Ye=[],Je=[];for(let ze of gt){let wt=ze.x,_t=ze.y,vt=J[0]*wt+J[4]*_t+J[12],dt=J[1]*wt+J[5]*_t+J[13],Nt=J[2]*wt+J[6]*_t+J[14],Pi=J[3]*wt+J[7]*_t+J[15],ss=Nt+Pe,Es=Pi+Ie,Io=vt+Ne,io=dt+et,vs=Nt+qe,_i=Pi+Qe,hs=new l((vt+ce)/Es,(dt+pe)/Es);hs.z=ss/Es,Ye.push(hs);let ys=new l(Io/_i,io/_i);ys.z=vs/_i,Je.push(ys)}se.push(Ye),Ce.push(Je)}return[se,Ce]}(m,A,F,E);return function(U,j,K){let J=1/0;Bb(K,j)&&(J=ux(K,j[0]));for(let se=0;se<j.length;se++){let Ce=j[se],ce=U[se];for(let pe=0;pe<Ce.length-1;pe++){let Pe=Ce[pe],Ie=[Pe,Ce[pe+1],ce[pe+1],ce[pe],Pe];zb(K,Ie)&&(J=Math.min(J,ux(K,Ie)))}}return J!==1/0&&J}(N[0],N[1],z)}}function Gd(h,a){return h.x*a.x+h.y*a.y}function ux(h,a){if(h.length===1){let c=0,g=a[c++],m;for(;!m||g.equals(m);)if(m=a[c++],!m)return 1/0;for(;c<a.length;c++){let b=a[c],_=h[0],E=m.sub(g),M=b.sub(g),F=_.sub(g),A=Gd(E,E),z=Gd(E,M),N=Gd(M,M),U=Gd(F,E),j=Gd(F,M),K=A*N-z*z,J=(N*U-z*j)/K,se=(A*j-z*U)/K,Ce=g.z*(1-J-se)+m.z*J+b.z*se;if(isFinite(Ce))return Ce}return 1/0}{let c=1/0;for(let g of a)c=Math.min(c,g.z);return c}}let QD=Li([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:JD}=QD,e3=Li([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:t3}=e3,i3=Math.cos(Math.PI/180*37.5),dx=Math.pow(2,14)/.5;class wy{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(c=>c.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new Ke,this.layoutVertexArray2=new Ze,this.indexArray=new ti,this.programConfigurations=new Un(a.layers,a.zoom),this.segments=new $t,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(a,c,g){this.hasPattern=dy("line",this.layers,c);let m=this.layers[0].layout.get("line-sort-key"),b=!m.isConstant(),_=[];for(let{feature:E,id:M,index:F,sourceLayerIndex:A}of a){let z=this.layers[0]._featureFilter.needGeometry,N=Vl(E,z);if(!this.layers[0]._featureFilter.filter(new ei(this.zoom),N,g))continue;let U=b?m.evaluate(N,{},g):void 0,j={id:M,properties:E.properties,type:E.type,sourceLayerIndex:A,index:F,geometry:z?N.geometry:Bl(E),patterns:{},sortKey:U};_.push(j)}b&&_.sort((E,M)=>E.sortKey-M.sortKey);for(let E of _){let{geometry:M,index:F,sourceLayerIndex:A}=E;if(this.hasPattern){let z=py("line",this.layers,E,{zoom:this.zoom},c);this.patternFeatures.push(z)}else this.addFeature(E,M,F,g,{},c.subdivisionGranularity);c.featureIndex.insert(a[F].feature,M,F,A,this.index)}}update(a,c,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,c,this.stateDependentLayers,{imagePositions:g})}addFeatures(a,c,g){for(let m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,c,g,a.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,t3)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,JD),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,c,g,m,b,_){let E=this.layers[0].layout,M=E.get("line-join").evaluate(a,{}),F=E.get("line-cap"),A=E.get("line-miter-limit"),z=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(let N of c)this.addLine(N,a,M,F,A,z,m,_);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,g,{imagePositions:b,canonical:m})}addLine(a,c,g,m,b,_,E,M){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,a=Nl(a,E?M.line.getGranularityForZoomLevel(E.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ce=0;ce<a.length-1;ce++)this.totalDistance+=a[ce].dist(a[ce+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let F=yh.types[c.type]==="Polygon",A=a.length;for(;A>=2&&a[A-1].equals(a[A-2]);)A--;let z=0;for(;z<A-1&&a[z].equals(a[z+1]);)z++;if(A<(F?3:2))return;g==="bevel"&&(b=1.05);let N=this.overscaling<=16?122880/(512*this.overscaling):0,U=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray),j,K,J,se,Ce;this.e1=this.e2=-1,F&&(j=a[A-2],Ce=a[z].sub(j)._unit()._perp());for(let ce=z;ce<A;ce++){if(J=ce===A-1?F?a[z+1]:void 0:a[ce+1],J&&a[ce].equals(J))continue;Ce&&(se=Ce),j&&(K=j),j=a[ce],Ce=J?J.sub(j)._unit()._perp():se,se=se||Ce;let pe=se.add(Ce);pe.x===0&&pe.y===0||pe._unit();let Pe=se.x*Ce.x+se.y*Ce.y,Ie=pe.x*Ce.x+pe.y*Ce.y,Ne=Ie!==0?1/Ie:1/0,et=2*Math.sqrt(2-2*Ie),qe=Ie<i3&&K&&J,Qe=se.x*Ce.y-se.y*Ce.x>0;if(qe&&ce>z){let Je=j.dist(K);if(Je>2*N){let ze=j.sub(j.sub(K)._mult(N/Je)._round());this.updateDistance(K,ze),this.addCurrentVertex(ze,se,0,0,U),K=ze}}let gt=K&&J,Ye=gt?g:F?"butt":m;if(gt&&Ye==="round"&&(Ne<_?Ye="miter":Ne<=2&&(Ye="fakeround")),Ye==="miter"&&Ne>b&&(Ye="bevel"),Ye==="bevel"&&(Ne>2&&(Ye="flipbevel"),Ne<b&&(Ye="miter")),K&&this.updateDistance(K,j),Ye==="miter")pe._mult(Ne),this.addCurrentVertex(j,pe,0,0,U);else if(Ye==="flipbevel"){if(Ne>100)pe=Ce.mult(-1);else{let Je=Ne*se.add(Ce).mag()/se.sub(Ce).mag();pe._perp()._mult(Je*(Qe?-1:1))}this.addCurrentVertex(j,pe,0,0,U),this.addCurrentVertex(j,pe.mult(-1),0,0,U)}else if(Ye==="bevel"||Ye==="fakeround"){let Je=-Math.sqrt(Ne*Ne-1),ze=Qe?Je:0,wt=Qe?0:Je;if(K&&this.addCurrentVertex(j,se,ze,wt,U),Ye==="fakeround"){let _t=Math.round(180*et/Math.PI/20);for(let vt=1;vt<_t;vt++){let dt=vt/_t;if(dt!==.5){let Pi=dt-.5;dt+=dt*Pi*(dt-1)*((1.0904+Pe*(Pe*(3.55645-1.43519*Pe)-3.2452))*Pi*Pi+(.848013+Pe*(.215638*Pe-1.06021)))}let Nt=Ce.sub(se)._mult(dt)._add(se)._unit()._mult(Qe?-1:1);this.addHalfVertex(j,Nt.x,Nt.y,!1,Qe,0,U)}}J&&this.addCurrentVertex(j,Ce,-ze,-wt,U)}else if(Ye==="butt")this.addCurrentVertex(j,pe,0,0,U);else if(Ye==="square"){let Je=K?1:-1;this.addCurrentVertex(j,pe,Je,Je,U)}else Ye==="round"&&(K&&(this.addCurrentVertex(j,se,0,0,U),this.addCurrentVertex(j,se,1,1,U,!0)),J&&(this.addCurrentVertex(j,Ce,-1,-1,U,!0),this.addCurrentVertex(j,Ce,0,0,U)));if(qe&&ce<A-1){let Je=j.dist(J);if(Je>2*N){let ze=j.add(J.sub(j)._mult(N/Je)._round());this.updateDistance(j,ze),this.addCurrentVertex(ze,Ce,0,0,U),j=ze}}}}addCurrentVertex(a,c,g,m,b,_=!1){let E=c.y*m-c.x,M=-c.y-c.x*m;this.addHalfVertex(a,c.x+c.y*g,c.y-c.x*g,_,!1,g,b),this.addHalfVertex(a,E,M,_,!0,-m,b),this.distance>dx/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(a,c,g,m,b,_))}addHalfVertex({x:a,y:c},g,m,b,_,E,M){let F=.5*(this.lineClips?this.scaledDistance*(dx-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((a<<1)+(b?1:0),(c<<1)+(_?1:0),Math.round(63*g)+128,Math.round(63*m)+128,1+(E===0?0:E<0?-1:1)|(63&F)<<2,F>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);let A=M.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,A,this.e2),M.primitiveLength++),_?this.e2=A:this.e1=A}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(a,c){this.distance+=a.dist(c),this.updateScaledDistance()}}let px,gx;rt("LineBucket",wy,{omit:["layers","patternFeatures"]});var fx={get paint(){return gx=gx||new Ss({"line-opacity":new mt(xe.paint_line["line-opacity"]),"line-color":new mt(xe.paint_line["line-color"]),"line-translate":new pt(xe.paint_line["line-translate"]),"line-translate-anchor":new pt(xe.paint_line["line-translate-anchor"]),"line-width":new mt(xe.paint_line["line-width"]),"line-gap-width":new mt(xe.paint_line["line-gap-width"]),"line-offset":new mt(xe.paint_line["line-offset"]),"line-blur":new mt(xe.paint_line["line-blur"]),"line-dasharray":new Pd(xe.paint_line["line-dasharray"]),"line-pattern":new oh(xe.paint_line["line-pattern"]),"line-gradient":new nh(xe.paint_line["line-gradient"])})},get layout(){return px=px||new Ss({"line-cap":new pt(xe.layout_line["line-cap"]),"line-join":new mt(xe.layout_line["line-join"]),"line-miter-limit":new pt(xe.layout_line["line-miter-limit"]),"line-round-limit":new pt(xe.layout_line["line-round-limit"]),"line-sort-key":new mt(xe.layout_line["line-sort-key"])})}};class s3 extends mt{possiblyEvaluate(a,c){return c=new ei(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),super.possiblyEvaluate(a,c)}evaluate(a,c,g,m){return c=$i({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(a,c,g,m)}}let uf;class o3 extends Mo{constructor(a,c){super(a,fx,c),this.gradientVersion=0,uf||(uf=new s3(fx.paint.properties["line-width"].specification),uf.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){let c=this.gradientExpression();this.stepInterpolant=!!function(g){return g._styleExpression!==void 0}(c)&&c._styleExpression.expression instanceof Ai,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(a,c){super.recalculate(a,c),this.paint._values["line-floorwidth"]=uf.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new wy(a)}queryRadius(a){let c=a,g=mx(gh("line-width",this,c),gh("line-gap-width",this,c)),m=gh("line-offset",this,c);return g/2+Math.abs(m)+rf(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:a,feature:c,featureState:g,geometry:m,transform:b,pixelsToTileUnits:_}){let E=af(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-b.bearingInRadians,_),M=_/2*mx(this.paint.get("line-width").evaluate(c,g),this.paint.get("line-gap-width").evaluate(c,g)),F=this.paint.get("line-offset").evaluate(c,g);return F&&(m=function(A,z){let N=[];for(let U=0;U<A.length;U++){let j=A[U],K=[];for(let J=0;J<j.length;J++){let se=j[J-1],Ce=j[J],ce=j[J+1],pe=J===0?new l(0,0):Ce.sub(se)._unit()._perp(),Pe=J===j.length-1?new l(0,0):ce.sub(Ce)._unit()._perp(),Ie=pe._add(Pe)._unit(),Ne=Ie.x*Pe.x+Ie.y*Pe.y;Ne!==0&&Ie._mult(1/Ne),K.push(Ie._mult(z)._add(Ce))}N.push(K)}return N}(m,F*_)),function(A,z,N){for(let U=0;U<z.length;U++){let j=z[U];if(A.length>=3){for(let K=0;K<j.length;K++)if(ph(A,j[K]))return!0}if(uD(A,j,N))return!0}return!1}(E,m,M)}isTileClipped(){return!0}}function mx(h,a){return a>0?a+2*h:h}let n3=Li([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),r3=Li([{name:"a_projected_pos",components:3,type:"Float32"}],4);Li([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let a3=Li([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Li([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let vx=Li([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),l3=Li([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function c3(h,a,c){return h.sections.forEach(g=>{g.text=function(m,b,_){let E=b.layout.get("text-transform").evaluate(_,{});return E==="uppercase"?m=m.toLocaleUpperCase():E==="lowercase"&&(m=m.toLocaleLowerCase()),Vn.applyArabicShaping&&(m=Vn.applyArabicShaping(m)),m}(g.text,a,c)}),h}Li([{name:"triangle",components:3,type:"Uint16"}]),Li([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Li([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Li([{type:"Float32",name:"offsetX"}]),Li([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Li([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);let Wd={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var cs=24;let Cy=4294967296,yx=1/Cy,wx=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class by{constructor(a=new Uint8Array(16)){this.buf=ArrayBuffer.isView(a)?a:new Uint8Array(a),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(a,c,g=this.length){for(;this.pos<g;){let m=this.readVarint(),b=m>>3,_=this.pos;this.type=7&m,a(b,c,this),this.pos===_&&this.skip(m)}return c}readMessage(a,c){return this.readFields(a,c,this.readVarint()+this.pos)}readFixed32(){let a=this.dataView.getUint32(this.pos,!0);return this.pos+=4,a}readSFixed32(){let a=this.dataView.getInt32(this.pos,!0);return this.pos+=4,a}readFixed64(){let a=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Cy;return this.pos+=8,a}readSFixed64(){let a=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Cy;return this.pos+=8,a}readFloat(){let a=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,a}readDouble(){let a=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,a}readVarint(a){let c=this.buf,g,m;return m=c[this.pos++],g=127&m,m<128?g:(m=c[this.pos++],g|=(127&m)<<7,m<128?g:(m=c[this.pos++],g|=(127&m)<<14,m<128?g:(m=c[this.pos++],g|=(127&m)<<21,m<128?g:(m=c[this.pos],g|=(15&m)<<28,function(b,_,E){let M=E.buf,F,A;if(A=M[E.pos++],F=(112&A)>>4,A<128||(A=M[E.pos++],F|=(127&A)<<3,A<128)||(A=M[E.pos++],F|=(127&A)<<10,A<128)||(A=M[E.pos++],F|=(127&A)<<17,A<128)||(A=M[E.pos++],F|=(127&A)<<24,A<128)||(A=M[E.pos++],F|=(1&A)<<31,A<128))return wh(b,F,_);throw new Error("Expected varint not more than 10 bytes")}(g,a,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){let a=this.readVarint();return a%2==1?(a+1)/-2:a/2}readBoolean(){return!!this.readVarint()}readString(){let a=this.readVarint()+this.pos,c=this.pos;return this.pos=a,a-c>=12&&wx?wx.decode(this.buf.subarray(c,a)):function(g,m,b){let _="",E=m;for(;E<b;){let M=g[E],F,A,z,N=null,U=M>239?4:M>223?3:M>191?2:1;if(E+U>b)break;U===1?M<128&&(N=M):U===2?(F=g[E+1],(192&F)==128&&(N=(31&M)<<6|63&F,N<=127&&(N=null))):U===3?(F=g[E+1],A=g[E+2],(192&F)==128&&(192&A)==128&&(N=(15&M)<<12|(63&F)<<6|63&A,(N<=2047||N>=55296&&N<=57343)&&(N=null))):U===4&&(F=g[E+1],A=g[E+2],z=g[E+3],(192&F)==128&&(192&A)==128&&(192&z)==128&&(N=(15&M)<<18|(63&F)<<12|(63&A)<<6|63&z,(N<=65535||N>=1114112)&&(N=null))),N===null?(N=65533,U=1):N>65535&&(N-=65536,_+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),_+=String.fromCharCode(N),E+=U}return _}(this.buf,c,a)}readBytes(){let a=this.readVarint()+this.pos,c=this.buf.subarray(this.pos,a);return this.pos=a,c}readPackedVarint(a=[],c){let g=this.readPackedEnd();for(;this.pos<g;)a.push(this.readVarint(c));return a}readPackedSVarint(a=[]){let c=this.readPackedEnd();for(;this.pos<c;)a.push(this.readSVarint());return a}readPackedBoolean(a=[]){let c=this.readPackedEnd();for(;this.pos<c;)a.push(this.readBoolean());return a}readPackedFloat(a=[]){let c=this.readPackedEnd();for(;this.pos<c;)a.push(this.readFloat());return a}readPackedDouble(a=[]){let c=this.readPackedEnd();for(;this.pos<c;)a.push(this.readDouble());return a}readPackedFixed32(a=[]){let c=this.readPackedEnd();for(;this.pos<c;)a.push(this.readFixed32());return a}readPackedSFixed32(a=[]){let c=this.readPackedEnd();for(;this.pos<c;)a.push(this.readSFixed32());return a}readPackedFixed64(a=[]){let c=this.readPackedEnd();for(;this.pos<c;)a.push(this.readFixed64());return a}readPackedSFixed64(a=[]){let c=this.readPackedEnd();for(;this.pos<c;)a.push(this.readSFixed64());return a}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(a){let c=7&a;if(c===0)for(;this.buf[this.pos++]>127;);else if(c===2)this.pos=this.readVarint()+this.pos;else if(c===5)this.pos+=4;else{if(c!==1)throw new Error(`Unimplemented type: ${c}`);this.pos+=8}}writeTag(a,c){this.writeVarint(a<<3|c)}realloc(a){let c=this.length||16;for(;c<this.pos+a;)c*=2;if(c!==this.length){let g=new Uint8Array(c);g.set(this.buf),this.buf=g,this.dataView=new DataView(g.buffer),this.length=c}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(a){this.realloc(4),this.dataView.setInt32(this.pos,a,!0),this.pos+=4}writeSFixed32(a){this.realloc(4),this.dataView.setInt32(this.pos,a,!0),this.pos+=4}writeFixed64(a){this.realloc(8),this.dataView.setInt32(this.pos,-1&a,!0),this.dataView.setInt32(this.pos+4,Math.floor(a*yx),!0),this.pos+=8}writeSFixed64(a){this.realloc(8),this.dataView.setInt32(this.pos,-1&a,!0),this.dataView.setInt32(this.pos+4,Math.floor(a*yx),!0),this.pos+=8}writeVarint(a){(a=+a||0)>268435455||a<0?function(c,g){let m,b;if(c>=0?(m=c%4294967296|0,b=c/4294967296|0):(m=~(-c%4294967296),b=~(-c/4294967296),4294967295^m?m=m+1|0:(m=0,b=b+1|0)),c>=18446744073709552e3||c<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");g.realloc(10),function(_,E,M){M.buf[M.pos++]=127&_|128,_>>>=7,M.buf[M.pos++]=127&_|128,_>>>=7,M.buf[M.pos++]=127&_|128,_>>>=7,M.buf[M.pos++]=127&_|128,M.buf[M.pos]=127&(_>>>=7)}(m,0,g),function(_,E){let M=(7&_)<<4;E.buf[E.pos++]|=M|((_>>>=3)?128:0),_&&(E.buf[E.pos++]=127&_|((_>>>=7)?128:0),_&&(E.buf[E.pos++]=127&_|((_>>>=7)?128:0),_&&(E.buf[E.pos++]=127&_|((_>>>=7)?128:0),_&&(E.buf[E.pos++]=127&_|((_>>>=7)?128:0),_&&(E.buf[E.pos++]=127&_)))))}(b,g)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))}writeSVarint(a){this.writeVarint(a<0?2*-a-1:2*a)}writeBoolean(a){this.writeVarint(+a)}writeString(a){a=String(a),this.realloc(4*a.length),this.pos++;let c=this.pos;this.pos=function(m,b,_){for(let E,M,F=0;F<b.length;F++){if(E=b.charCodeAt(F),E>55295&&E<57344){if(!M){E>56319||F+1===b.length?(m[_++]=239,m[_++]=191,m[_++]=189):M=E;continue}if(E<56320){m[_++]=239,m[_++]=191,m[_++]=189,M=E;continue}E=M-55296<<10|E-56320|65536,M=null}else M&&(m[_++]=239,m[_++]=191,m[_++]=189,M=null);E<128?m[_++]=E:(E<2048?m[_++]=E>>6|192:(E<65536?m[_++]=E>>12|224:(m[_++]=E>>18|240,m[_++]=E>>12&63|128),m[_++]=E>>6&63|128),m[_++]=63&E|128)}return _}(this.buf,a,this.pos);let g=this.pos-c;g>=128&&Cx(c,g,this),this.pos=c-1,this.writeVarint(g),this.pos+=g}writeFloat(a){this.realloc(4),this.dataView.setFloat32(this.pos,a,!0),this.pos+=4}writeDouble(a){this.realloc(8),this.dataView.setFloat64(this.pos,a,!0),this.pos+=8}writeBytes(a){let c=a.length;this.writeVarint(c),this.realloc(c);for(let g=0;g<c;g++)this.buf[this.pos++]=a[g]}writeRawMessage(a,c){this.pos++;let g=this.pos;a(c,this);let m=this.pos-g;m>=128&&Cx(g,m,this),this.pos=g-1,this.writeVarint(m),this.pos+=m}writeMessage(a,c,g){this.writeTag(a,2),this.writeRawMessage(c,g)}writePackedVarint(a,c){c.length&&this.writeMessage(a,h3,c)}writePackedSVarint(a,c){c.length&&this.writeMessage(a,u3,c)}writePackedBoolean(a,c){c.length&&this.writeMessage(a,g3,c)}writePackedFloat(a,c){c.length&&this.writeMessage(a,d3,c)}writePackedDouble(a,c){c.length&&this.writeMessage(a,p3,c)}writePackedFixed32(a,c){c.length&&this.writeMessage(a,f3,c)}writePackedSFixed32(a,c){c.length&&this.writeMessage(a,m3,c)}writePackedFixed64(a,c){c.length&&this.writeMessage(a,v3,c)}writePackedSFixed64(a,c){c.length&&this.writeMessage(a,y3,c)}writeBytesField(a,c){this.writeTag(a,2),this.writeBytes(c)}writeFixed32Field(a,c){this.writeTag(a,5),this.writeFixed32(c)}writeSFixed32Field(a,c){this.writeTag(a,5),this.writeSFixed32(c)}writeFixed64Field(a,c){this.writeTag(a,1),this.writeFixed64(c)}writeSFixed64Field(a,c){this.writeTag(a,1),this.writeSFixed64(c)}writeVarintField(a,c){this.writeTag(a,0),this.writeVarint(c)}writeSVarintField(a,c){this.writeTag(a,0),this.writeSVarint(c)}writeStringField(a,c){this.writeTag(a,2),this.writeString(c)}writeFloatField(a,c){this.writeTag(a,5),this.writeFloat(c)}writeDoubleField(a,c){this.writeTag(a,1),this.writeDouble(c)}writeBooleanField(a,c){this.writeVarintField(a,+c)}}function wh(h,a,c){return c?4294967296*a+(h>>>0):4294967296*(a>>>0)+(h>>>0)}function Cx(h,a,c){let g=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));c.realloc(g);for(let m=c.pos-1;m>=h;m--)c.buf[m+g]=c.buf[m]}function h3(h,a){for(let c=0;c<h.length;c++)a.writeVarint(h[c])}function u3(h,a){for(let c=0;c<h.length;c++)a.writeSVarint(h[c])}function d3(h,a){for(let c=0;c<h.length;c++)a.writeFloat(h[c])}function p3(h,a){for(let c=0;c<h.length;c++)a.writeDouble(h[c])}function g3(h,a){for(let c=0;c<h.length;c++)a.writeBoolean(h[c])}function f3(h,a){for(let c=0;c<h.length;c++)a.writeFixed32(h[c])}function m3(h,a){for(let c=0;c<h.length;c++)a.writeSFixed32(h[c])}function v3(h,a){for(let c=0;c<h.length;c++)a.writeFixed64(h[c])}function y3(h,a){for(let c=0;c<h.length;c++)a.writeSFixed64(h[c])}function w3(h,a,c){h===1&&c.readMessage(C3,a)}function C3(h,a,c){if(h===3){let{id:g,bitmap:m,width:b,height:_,left:E,top:M,advance:F}=c.readMessage(b3,{});a.push({id:g,bitmap:new Ad({width:b+6,height:_+6},m),metrics:{width:b,height:_,left:E,top:M,advance:F}})}}function b3(h,a,c){h===1?a.id=c.readVarint():h===2?a.bitmap=c.readBytes():h===3?a.width=c.readVarint():h===4?a.height=c.readVarint():h===5?a.left=c.readSVarint():h===6?a.top=c.readSVarint():h===7&&(a.advance=c.readVarint())}function bx(h){let a=0,c=0;for(let _ of h)a+=_.w*_.h,c=Math.max(c,_.w);h.sort((_,E)=>E.h-_.h);let g=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),c),h:1/0}],m=0,b=0;for(let _ of h)for(let E=g.length-1;E>=0;E--){let M=g[E];if(!(_.w>M.w||_.h>M.h)){if(_.x=M.x,_.y=M.y,b=Math.max(b,_.y+_.h),m=Math.max(m,_.x+_.w),_.w===M.w&&_.h===M.h){let F=g.pop();F&&E<g.length&&(g[E]=F)}else _.h===M.h?(M.x+=_.w,M.w-=_.w):_.w===M.w?(M.y+=_.h,M.h-=_.h):(g.push({x:M.x+_.w,y:M.y,w:M.w-_.w,h:_.h}),M.y+=_.h,M.h-=_.h);break}}return{w:m,h:b,fill:a/(m*b)||0}}class xy{constructor(a,{pixelRatio:c,version:g,stretchX:m,stretchY:b,content:_,textFitWidth:E,textFitHeight:M}){this.paddedRect=a,this.pixelRatio=c,this.stretchX=m,this.stretchY=b,this.content=_,this.version=g,this.textFitWidth=E,this.textFitHeight=M}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class xx{constructor(a,c){let g={},m={};this.haveRenderCallbacks=[];let b=[];this.addImages(a,g,b),this.addImages(c,m,b);let{w:_,h:E}=bx(b),M=new to({width:_||1,height:E||1});for(let F in a){let A=a[F],z=g[F].paddedRect;to.copy(A.data,M,{x:0,y:0},{x:z.x+1,y:z.y+1},A.data)}for(let F in c){let A=c[F],z=m[F].paddedRect,N=z.x+1,U=z.y+1,j=A.data.width,K=A.data.height;to.copy(A.data,M,{x:0,y:0},{x:N,y:U},A.data),to.copy(A.data,M,{x:0,y:K-1},{x:N,y:U-1},{width:j,height:1}),to.copy(A.data,M,{x:0,y:0},{x:N,y:U+K},{width:j,height:1}),to.copy(A.data,M,{x:j-1,y:0},{x:N-1,y:U},{width:1,height:K}),to.copy(A.data,M,{x:0,y:0},{x:N+j,y:U},{width:1,height:K})}this.image=M,this.iconPositions=g,this.patternPositions=m}addImages(a,c,g){for(let m in a){let b=a[m],_={x:0,y:0,w:b.data.width+2,h:b.data.height+2};g.push(_),c[m]=new xy(_,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(a,c){a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let g in a.updatedImages)this.patchUpdatedImage(this.iconPositions[g],a.getImage(g),c),this.patchUpdatedImage(this.patternPositions[g],a.getImage(g),c)}patchUpdatedImage(a,c,g){if(!a||!c||a.version===c.version)return;a.version=c.version;let[m,b]=a.tl;g.update(c.data,void 0,{x:m,y:b})}}var Pa;rt("ImagePosition",xy),rt("ImageAtlas",xx),n.ao=void 0,(Pa=n.ao||(n.ao={}))[Pa.none=0]="none",Pa[Pa.horizontal=1]="horizontal",Pa[Pa.vertical=2]="vertical",Pa[Pa.horizontalOnly=3]="horizontalOnly";class Ud{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(a,c,g){let m=new Ud;return m.scale=a||1,m.fontStack=c,m.verticalAlign=g||"bottom",m}static forImage(a,c){let g=new Ud;return g.imageName=a,g.verticalAlign=c||"bottom",g}}class Ch{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,c){let g=new Ch;for(let m=0;m<a.sections.length;m++){let b=a.sections[m];b.image?g.addImageSection(b):g.addTextSection(b,c)}return g}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(){this.text=function(a){let c="";for(let g=0;g<a.length;g++){let m=a.charCodeAt(g+1)||null,b=a.charCodeAt(g-1)||null;c+=m&&_d(m)&&!Wd[a[g+1]]||b&&_d(b)&&!Wd[a[g-1]]||!Wd[a[g]]?a[g]:Wd[a[g]]}return c}(this.text)}trim(){let a=0;for(let g=0;g<this.text.length&&pf[this.text.charCodeAt(g)];g++)a++;let c=this.text.length;for(let g=this.text.length-1;g>=0&&g>=a&&pf[this.text.charCodeAt(g)];g--)c--;this.text=this.text.substring(a,c),this.sectionIndex=this.sectionIndex.slice(a,c)}substring(a,c){let g=new Ch;return g.text=this.text.substring(a,c),g.sectionIndex=this.sectionIndex.slice(a,c),g.sections=this.sections,g}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,c)=>Math.max(a,this.sections[c].scale),0)}getMaxImageSize(a){let c=0,g=0;for(let m=0;m<this.length();m++){let b=this.getSection(m);if(b.imageName){let _=a[b.imageName];if(!_)continue;let E=_.displaySize;c=Math.max(c,E[0]),g=Math.max(g,E[1])}}return{maxImageWidth:c,maxImageHeight:g}}addTextSection(a,c){this.text+=a.text,this.sections.push(Ud.forText(a.scale,a.fontStack||c,a.verticalAlign));let g=this.sections.length-1;for(let m=0;m<a.text.length;++m)this.sectionIndex.push(g)}addImageSection(a){let c=a.image?a.image.name:"";if(c.length===0)return void Vi("Can't add FormattedSection with an empty image.");let g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCharCode(g),this.sections.push(Ud.forImage(c,a.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Vi("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function df(h,a,c,g,m,b,_,E,M,F,A,z,N,U,j){let K=Ch.fromFeature(h,m),J;z===n.ao.vertical&&K.verticalizePunctuation();let{processBidirectionalText:se,processStyledBidirectionalText:Ce}=Vn;if(se&&K.sections.length===1){J=[];let Pe=se(K.toString(),_y(K,F,b,a,g,U));for(let Ie of Pe){let Ne=new Ch;Ne.text=Ie,Ne.sections=K.sections;for(let et=0;et<Ie.length;et++)Ne.sectionIndex.push(0);J.push(Ne)}}else if(Ce){J=[];let Pe=Ce(K.text,K.sectionIndex,_y(K,F,b,a,g,U));for(let Ie of Pe){let Ne=new Ch;Ne.text=Ie[0],Ne.sectionIndex=Ie[1],Ne.sections=K.sections,J.push(Ne)}}else J=function(Pe,Ie){let Ne=[],et=Pe.text,qe=0;for(let Qe of Ie)Ne.push(Pe.substring(qe,Qe)),qe=Qe;return qe<et.length&&Ne.push(Pe.substring(qe,et.length)),Ne}(K,_y(K,F,b,a,g,U));let ce=[],pe={positionedLines:ce,text:K.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:z,iconsInText:!1,verticalizable:!1};return function(Pe,Ie,Ne,et,qe,Qe,gt,Ye,Je,ze,wt,_t){let vt=0,dt=0,Nt=0,Pi=0,ss=Ye==="right"?1:Ye==="left"?0:.5,Es=cs/_t,Io=0;for(let _i of qe){_i.trim();let hs=_i.getMaxScale(),ys={positionedGlyphs:[],lineOffset:0};Pe.positionedLines[Io]=ys;let ws=ys.positionedGlyphs,$s=0;if(!_i.length()){dt+=Qe,++Io;continue}let ko=R3(et,_i,Es);for(let so=0;so<_i.length();so++){let os=_i.getSection(so),ds=_i.getSectionIndex(so),ps=_i.getCharCode(so),Xi=E3(Je,wt,ps),gi;if(os.imageName){if(Pe.iconsInText=!0,os.scale=os.scale*Es,gi=M3(os,Xi,hs,ko,et),!gi)continue;$s=Math.max($s,gi.imageOffset)}else if(gi=P3(os,ps,Xi,ko,Ie,Ne),!gi)continue;let{rect:gn,metrics:Sh,baselineOffset:fn}=gi;ws.push({glyph:ps,imageName:os.imageName,x:vt,y:dt+fn+-17,vertical:Xi,scale:os.scale,fontStack:os.fontStack,sectionIndex:ds,metrics:Sh,rect:gn}),Xi?(Pe.verticalizable=!0,vt+=(os.imageName?Sh.advance:cs)*os.scale+ze):vt+=Sh.advance*os.scale+ze}ws.length!==0&&(Nt=Math.max(vt-ze,Nt),T3(ws,0,ws.length-1,ss)),vt=0,ys.lineOffset=Math.max($s,(hs-1)*cs);let us=Qe*hs+$s;dt+=us,Pi=Math.max(us,Pi),++Io}let{horizontalAlign:io,verticalAlign:vs}=Sy(gt);(function(_i,hs,ys,ws,$s,ko,us,so,os){let ds=(hs-ys)*$s,ps=0;ps=ko!==us?-so*ws- -17:-ws*os*us+.5*us;for(let Xi of _i)for(let gi of Xi.positionedGlyphs)gi.x+=ds,gi.y+=ps})(Pe.positionedLines,ss,io,vs,Nt,Pi,Qe,dt,qe.length),Pe.top+=-vs*dt,Pe.bottom=Pe.top+dt,Pe.left+=-io*Nt,Pe.right=Pe.left+Nt}(pe,a,c,g,J,_,E,M,z,F,N,j),!function(Pe){for(let Ie of Pe)if(Ie.positionedGlyphs.length!==0)return!1;return!0}(ce)&&pe}let pf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},x3={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},_3={40:!0};function _x(h,a,c,g,m,b){if(a.imageName){let _=g[a.imageName];return _?_.displaySize[0]*a.scale*cs/b+m:0}{let _=c[a.fontStack],E=_&&_[h];return E?E.metrics.advance*a.scale+m:0}}function Sx(h,a,c,g){let m=Math.pow(h-a,2);return g?h<a?m/2:2*m:m+Math.abs(c)*c}function S3(h,a,c){let g=0;return h===10&&(g-=1e4),c&&(g+=150),h!==40&&h!==65288||(g+=50),a!==41&&a!==65289||(g+=50),g}function Rx(h,a,c,g,m,b){let _=null,E=Sx(a,c,m,b);for(let M of g){let F=Sx(a-M.x,c,m,b)+M.badness;F<=E&&(_=M,E=F)}return{index:h,x:a,priorBreak:_,badness:E}}function Ex(h){return h?Ex(h.priorBreak).concat(h.index):[]}function _y(h,a,c,g,m,b){if(!h)return[];let _=[],E=function(z,N,U,j,K,J){let se=0;for(let Ce=0;Ce<z.length();Ce++){let ce=z.getSection(Ce);se+=_x(z.getCharCode(Ce),ce,j,K,N,J)}return se/Math.max(1,Math.ceil(se/U))}(h,a,c,g,m,b),M=h.text.indexOf("\u200B")>=0,F=0;for(let z=0;z<h.length();z++){let N=h.getSection(z),U=h.getCharCode(z);if(pf[U]||(F+=_x(U,N,g,m,a,b)),z<h.length()-1){let j=!((A=U)<11904)&&(!!Ht["CJK Compatibility Forms"](A)||!!Ht["CJK Compatibility"](A)||!!Ht["CJK Strokes"](A)||!!Ht["CJK Symbols and Punctuation"](A)||!!Ht["Enclosed CJK Letters and Months"](A)||!!Ht["Halfwidth and Fullwidth Forms"](A)||!!Ht["Ideographic Description Characters"](A)||!!Ht["Vertical Forms"](A)||Qg.test(String.fromCodePoint(A)));(x3[U]||j||N.imageName||z!==h.length()-2&&_3[h.getCharCode(z+1)])&&_.push(Rx(z+1,F,E,_,S3(U,h.getCharCode(z+1),j&&M),!1))}}var A;return Ex(Rx(h.length(),F,E,_,0,!0))}function Sy(h){let a=.5,c=.5;switch(h){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(h){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:a,verticalAlign:c}}function R3(h,a,c){let g=a.getMaxScale()*cs,{maxImageWidth:m,maxImageHeight:b}=a.getMaxImageSize(h),_=Math.max(g,b*c);return{verticalLineContentWidth:Math.max(g,m*c),horizontalLineContentHeight:_}}function Px(h){switch(h){case"top":return 0;case"center":return .5;default:return 1}}function E3(h,a,c){return!(h===n.ao.horizontal||!a&&!xd(c)||a&&(pf[c]||(g=c,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(g)))));var g}function P3(h,a,c,g,m,b){let _=b[h.fontStack],E=function(F,A,z,N){if(F&&F.rect)return F;let U=A[z.fontStack],j=U&&U[N];return j?{rect:null,metrics:j.metrics}:null}(_&&_[a],m,h,a);if(E===null)return null;let M;if(c)M=g.verticalLineContentWidth-h.scale*cs;else{let F=Px(h.verticalAlign);M=(g.horizontalLineContentHeight-h.scale*cs)*F}return{rect:E.rect,metrics:E.metrics,baselineOffset:M}}function M3(h,a,c,g,m){let b=m[h.imageName];if(!b)return null;let _=b.paddedRect,E=b.displaySize,M={width:E[0],height:E[1],left:1,top:-3,advance:a?E[1]:E[0]},F;if(a)F=g.verticalLineContentWidth-E[1]*h.scale;else{let A=Px(h.verticalAlign);F=(g.horizontalLineContentHeight-E[1]*h.scale)*A}return{rect:_,metrics:M,baselineOffset:F,imageOffset:(a?E[0]:E[1])*h.scale-cs*c}}function T3(h,a,c,g){if(g===0)return;let m=h[c],b=(h[c].x+m.metrics.advance*m.scale)*g;for(let _=a;_<=c;_++)h[_].x-=b}function D3(h,a,c){let{horizontalAlign:g,verticalAlign:m}=Sy(c),b=a[0]-h.displaySize[0]*g,_=a[1]-h.displaySize[1]*m;return{image:h,top:_,bottom:_+h.displaySize[1],left:b,right:b+h.displaySize[0]}}function Mx(h){var a,c;let g=h.left,m=h.top,b=h.right-g,_=h.bottom-m,E=(a=h.image.textFitWidth)!==null&&a!==void 0?a:"stretchOrShrink",M=(c=h.image.textFitHeight)!==null&&c!==void 0?c:"stretchOrShrink",F=(h.image.content[2]-h.image.content[0])/(h.image.content[3]-h.image.content[1]);if(M==="proportional"){if(E==="stretchOnly"&&b/_<F||E==="proportional"){let A=Math.ceil(_*F);g*=A/b,b=A}}else if(E==="proportional"&&M==="stretchOnly"&&F!==0&&b/_>F){let A=Math.ceil(b/F);m*=A/_,_=A}return{x1:g,y1:m,x2:g+b,y2:m+_}}function Tx(h,a,c,g,m,b){let _=h.image,E;if(_.content){let J=_.content,se=_.pixelRatio||1;E=[J[0]/se,J[1]/se,_.displaySize[0]-J[2]/se,_.displaySize[1]-J[3]/se]}let M=a.left*b,F=a.right*b,A,z,N,U;c==="width"||c==="both"?(U=m[0]+M-g[3],z=m[0]+F+g[1]):(U=m[0]+(M+F-_.displaySize[0])/2,z=U+_.displaySize[0]);let j=a.top*b,K=a.bottom*b;return c==="height"||c==="both"?(A=m[1]+j-g[0],N=m[1]+K+g[2]):(A=m[1]+(j+K-_.displaySize[1])/2,N=A+_.displaySize[1]),{image:_,top:A,right:z,bottom:N,left:U,collisionPadding:E}}let Br=128,Ma=32640;function Dx(h,a){let{expression:c}=a;if(c.kind==="constant")return{kind:"constant",layoutSize:c.evaluate(new ei(h+1))};if(c.kind==="source")return{kind:"source"};{let{zoomStops:g,interpolationType:m}=c,b=0;for(;b<g.length&&g[b]<=h;)b++;b=Math.max(0,b-1);let _=b;for(;_<g.length&&g[_]<h+1;)_++;_=Math.min(g.length-1,_);let E=g[b],M=g[_];return c.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:M,interpolationType:m}:{kind:"camera",minZoom:E,maxZoom:M,minSize:c.evaluate(new ei(E)),maxSize:c.evaluate(new ei(M)),interpolationType:m}}}function Ry(h,a,c){let g="never",m=h.get(a);return m?g=m:h.get(c)&&(g="always"),g}let F3=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function gf(h,a,c,g,m,b,_,E,M,F,A,z,N){let U=E?Math.min(Ma,Math.round(E[0])):0,j=E?Math.min(Ma,Math.round(E[1])):0;h.emplaceBack(a,c,Math.round(32*g),Math.round(32*m),b,_,(U<<1)+(M?1:0),j,16*F,16*A,256*z,256*N)}function Ey(h,a,c){h.emplaceBack(a.x,a.y,c),h.emplaceBack(a.x,a.y,c),h.emplaceBack(a.x,a.y,c),h.emplaceBack(a.x,a.y,c)}function I3(h){for(let a of h.sections)if(eh(a.text))return!0;return!1}class Py{constructor(a){this.layoutVertexArray=new ut,this.indexArray=new ti,this.programConfigurations=a,this.segments=new $t,this.dynamicLayoutVertexArray=new It,this.opacityVertexArray=new Xt,this.hasVisibleVertices=!1,this.placedSymbolArray=new te}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,c,g,m){this.isEmpty()||(g&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,n3.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,r3.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,F3,!0),this.opacityVertexBuffer.itemSize=1),(g||m)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}rt("SymbolBuffers",Py);class My{constructor(a,c,g){this.layoutVertexArray=new a,this.layoutAttributes=c,this.indexArray=new g,this.segments=new $t,this.collisionVertexArray=new ni}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,a3.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}rt("CollisionBuffers",My);class bh{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(_=>_.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];let c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Dx(this.zoom,c["text-size"]),this.iconSizeData=Dx(this.zoom,c["icon-size"]);let g=this.layers[0].layout,m=g.get("symbol-sort-key"),b=g.get("symbol-z-order");this.canOverlap=Ry(g,"text-overlap","text-allow-overlap")!=="never"||Ry(g,"icon-overlap","icon-allow-overlap")!=="never"||g.get("text-ignore-placement")||g.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,g.get("symbol-placement")==="point"&&(this.writingModes=g.get("text-writing-mode").map(_=>n.ao[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=a.sourceID}createArrays(){this.text=new Py(new Un(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new Py(new Un(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new le,this.lineVertexArray=new ne,this.symbolInstances=new oe,this.textAnchorOffsets=new ge}calculateGlyphDependencies(a,c,g,m,b){for(let _=0;_<a.length;_++)if(c[a.charCodeAt(_)]=!0,(g||m)&&b){let E=Wd[a.charAt(_)];E&&(c[E.charCodeAt(0)]=!0)}}populate(a,c,g){let m=this.layers[0],b=m.layout,_=b.get("text-font"),E=b.get("text-field"),M=b.get("icon-image"),F=(E.value.kind!=="constant"||E.value.value instanceof Ts&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),A=M.value.kind!=="constant"||!!M.value.value||Object.keys(M.parameters).length>0,z=b.get("symbol-sort-key");if(this.features=[],!F&&!A)return;let N=c.iconDependencies,U=c.glyphDependencies,j=c.availableImages,K=new ei(this.zoom);for(let{feature:J,id:se,index:Ce,sourceLayerIndex:ce}of a){let pe=m._featureFilter.needGeometry,Pe=Vl(J,pe);if(!m._featureFilter.filter(K,Pe,g))continue;let Ie,Ne;if(pe||(Pe.geometry=Bl(J)),F){let qe=m.getValueAndResolveTokens("text-field",Pe,g,j),Qe=Ts.factory(qe),gt=this.hasRTLText=this.hasRTLText||I3(Qe);(!gt||Vn.getRTLTextPluginStatus()==="unavailable"||gt&&Vn.isParsed())&&(Ie=c3(Qe,m,Pe))}if(A){let qe=m.getValueAndResolveTokens("icon-image",Pe,g,j);Ne=qe instanceof Ys?qe:Ys.fromString(qe)}if(!Ie&&!Ne)continue;let et=this.sortFeaturesByKey?z.evaluate(Pe,{},g):void 0;if(this.features.push({id:se,text:Ie,icon:Ne,index:Ce,sourceLayerIndex:ce,geometry:Pe.geometry,properties:J.properties,type:yh.types[J.type],sortKey:et}),Ne&&(N[Ne.name]=!0),Ie){let qe=_.evaluate(Pe,{},g).join(","),Qe=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(n.ao.vertical)>=0;for(let gt of Ie.sections)if(gt.image)N[gt.image.name]=!0;else{let Ye=Cd(Ie.toString()),Je=gt.fontStack||qe,ze=U[Je]=U[Je]||{};this.calculateGlyphDependencies(gt.text,ze,Qe,this.allowVerticalPlacement,Ye)}}}b.get("symbol-placement")==="line"&&(this.features=function(J){let se={},Ce={},ce=[],pe=0;function Pe(qe){ce.push(J[qe]),pe++}function Ie(qe,Qe,gt){let Ye=Ce[qe];return delete Ce[qe],Ce[Qe]=Ye,ce[Ye].geometry[0].pop(),ce[Ye].geometry[0]=ce[Ye].geometry[0].concat(gt[0]),Ye}function Ne(qe,Qe,gt){let Ye=se[Qe];return delete se[Qe],se[qe]=Ye,ce[Ye].geometry[0].shift(),ce[Ye].geometry[0]=gt[0].concat(ce[Ye].geometry[0]),Ye}function et(qe,Qe,gt){let Ye=gt?Qe[0][Qe[0].length-1]:Qe[0][0];return`${qe}:${Ye.x}:${Ye.y}`}for(let qe=0;qe<J.length;qe++){let Qe=J[qe],gt=Qe.geometry,Ye=Qe.text?Qe.text.toString():null;if(!Ye){Pe(qe);continue}let Je=et(Ye,gt),ze=et(Ye,gt,!0);if(Je in Ce&&ze in se&&Ce[Je]!==se[ze]){let wt=Ne(Je,ze,gt),_t=Ie(Je,ze,ce[wt].geometry);delete se[Je],delete Ce[ze],Ce[et(Ye,ce[_t].geometry,!0)]=_t,ce[wt].geometry=null}else Je in Ce?Ie(Je,ze,gt):ze in se?Ne(Je,ze,gt):(Pe(qe),se[Je]=pe-1,Ce[ze]=pe-1)}return ce.filter(qe=>qe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((J,se)=>J.sortKey-se.sortKey)}update(a,c,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,c,this.layers,{imagePositions:g}),this.icon.programConfigurations.updatePaintArrays(a,c,this.layers,{imagePositions:g}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,c){let g=this.lineVertexArray.length;if(a.segment!==void 0){let m=a.dist(c[a.segment+1]),b=a.dist(c[a.segment]),_={};for(let E=a.segment+1;E<c.length;E++)_[E]={x:c[E].x,y:c[E].y,tileUnitDistanceFromAnchor:m},E<c.length-1&&(m+=c[E+1].dist(c[E]));for(let E=a.segment||0;E>=0;E--)_[E]={x:c[E].x,y:c[E].y,tileUnitDistanceFromAnchor:b},E>0&&(b+=c[E-1].dist(c[E]));for(let E=0;E<c.length;E++){let M=_[E];this.lineVertexArray.emplaceBack(M.x,M.y,M.tileUnitDistanceFromAnchor)}}return{lineStartIndex:g,lineLength:this.lineVertexArray.length-g}}addSymbols(a,c,g,m,b,_,E,M,F,A,z,N){let U=a.indexArray,j=a.layoutVertexArray,K=a.segments.prepareSegment(4*c.length,j,U,this.canOverlap?_.sortKey:void 0),J=this.glyphOffsetArray.length,se=K.vertexLength,Ce=this.allowVerticalPlacement&&E===n.ao.vertical?Math.PI/2:0,ce=_.text&&_.text.sections;for(let pe=0;pe<c.length;pe++){let{tl:Pe,tr:Ie,bl:Ne,br:et,tex:qe,pixelOffsetTL:Qe,pixelOffsetBR:gt,minFontScaleX:Ye,minFontScaleY:Je,glyphOffset:ze,isSDF:wt,sectionIndex:_t}=c[pe],vt=K.vertexLength,dt=ze[1];gf(j,M.x,M.y,Pe.x,dt+Pe.y,qe.x,qe.y,g,wt,Qe.x,Qe.y,Ye,Je),gf(j,M.x,M.y,Ie.x,dt+Ie.y,qe.x+qe.w,qe.y,g,wt,gt.x,Qe.y,Ye,Je),gf(j,M.x,M.y,Ne.x,dt+Ne.y,qe.x,qe.y+qe.h,g,wt,Qe.x,gt.y,Ye,Je),gf(j,M.x,M.y,et.x,dt+et.y,qe.x+qe.w,qe.y+qe.h,g,wt,gt.x,gt.y,Ye,Je),Ey(a.dynamicLayoutVertexArray,M,Ce),U.emplaceBack(vt,vt+2,vt+1),U.emplaceBack(vt+1,vt+2,vt+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ze[0]),pe!==c.length-1&&_t===c[pe+1].sectionIndex||a.programConfigurations.populatePaintArrays(j.length,_,_.index,{imagePositions:{},canonical:N,formattedSection:ce&&ce[_t]})}a.placedSymbolArray.emplaceBack(M.x,M.y,J,this.glyphOffsetArray.length-J,se,F,A,M.segment,g?g[0]:0,g?g[1]:0,m[0],m[1],E,0,!1,0,z)}_addCollisionDebugVertex(a,c,g,m,b,_){return c.emplaceBack(0,0),a.emplaceBack(g.x,g.y,m,b,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(a,c,g,m,b,_,E){let M=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),F=M.vertexLength,A=b.layoutVertexArray,z=b.collisionVertexArray,N=E.anchorX,U=E.anchorY;this._addCollisionDebugVertex(A,z,_,N,U,new l(a,c)),this._addCollisionDebugVertex(A,z,_,N,U,new l(g,c)),this._addCollisionDebugVertex(A,z,_,N,U,new l(g,m)),this._addCollisionDebugVertex(A,z,_,N,U,new l(a,m)),M.vertexLength+=4;let j=b.indexArray;j.emplaceBack(F,F+1),j.emplaceBack(F+1,F+2),j.emplaceBack(F+2,F+3),j.emplaceBack(F+3,F),M.primitiveLength+=4}addDebugCollisionBoxes(a,c,g,m){for(let b=a;b<c;b++){let _=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,m?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,g)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new My(yi,vx.members,wi),this.iconCollisionBox=new My(yi,vx.members,wi);for(let a=0;a<this.symbolInstances.length;a++){let c=this.symbolInstances.get(a);this.addDebugCollisionBoxes(c.textBoxStartIndex,c.textBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.iconBoxStartIndex,c.iconBoxEndIndex,c,!1),this.addDebugCollisionBoxes(c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c,!1)}}_deserializeCollisionBoxesForSymbol(a,c,g,m,b,_,E,M,F){let A={};for(let z=c;z<g;z++){let N=a.get(z);A.textBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,anchorPointX:N.anchorPointX,anchorPointY:N.anchorPointY},A.textFeatureIndex=N.featureIndex;break}for(let z=m;z<b;z++){let N=a.get(z);A.verticalTextBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,anchorPointX:N.anchorPointX,anchorPointY:N.anchorPointY},A.verticalTextFeatureIndex=N.featureIndex;break}for(let z=_;z<E;z++){let N=a.get(z);A.iconBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,anchorPointX:N.anchorPointX,anchorPointY:N.anchorPointY},A.iconFeatureIndex=N.featureIndex;break}for(let z=M;z<F;z++){let N=a.get(z);A.verticalIconBox={x1:N.x1,y1:N.y1,x2:N.x2,y2:N.y2,anchorPointX:N.anchorPointX,anchorPointY:N.anchorPointY},A.verticalIconFeatureIndex=N.featureIndex;break}return A}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){let g=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,g.textBoxStartIndex,g.textBoxEndIndex,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,c){let g=a.placedSymbolArray.get(c),m=g.vertexStartIndex+4*g.numGlyphs;for(let b=g.vertexStartIndex;b<m;b+=4)a.indexArray.emplaceBack(b,b+2,b+1),a.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let c=Math.sin(a),g=Math.cos(a),m=[],b=[],_=[];for(let E=0;E<this.symbolInstances.length;++E){_.push(E);let M=this.symbolInstances.get(E);m.push(0|Math.round(c*M.anchorX+g*M.anchorY)),b.push(M.featureIndex)}return _.sort((E,M)=>m[E]-m[M]||b[M]-b[E]),_}addToSortKeyRanges(a,c){let g=this.sortKeyRanges[this.sortKeyRanges.length-1];g&&g.sortKey===c?g.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let c of this.symbolInstanceIndexes){let g=this.symbolInstances.get(c);this.featureSortOrder.push(g.featureIndex),[g.rightJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.leftJustifiedTextSymbolIndex].forEach((m,b,_)=>{m>=0&&_.indexOf(m)===b&&this.addIndicesForPlacedSymbol(this.text,m)}),g.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,g.verticalPlacedTextSymbolIndex),g.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.placedIconSymbolIndex),g.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Fx,Ix;rt("SymbolBucket",bh,{omit:["layers","collisionBoxArray","features","compareText"]}),bh.MAX_GLYPHS=65535,bh.addDynamicAttributes=Ey;var Ty={get paint(){return Ix=Ix||new Ss({"icon-opacity":new mt(xe.paint_symbol["icon-opacity"]),"icon-color":new mt(xe.paint_symbol["icon-color"]),"icon-halo-color":new mt(xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new mt(xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new mt(xe.paint_symbol["icon-halo-blur"]),"icon-translate":new pt(xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new pt(xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new mt(xe.paint_symbol["text-opacity"]),"text-color":new mt(xe.paint_symbol["text-color"],{runtimeType:fs,getOverride:h=>h.textColor,hasOverride:h=>!!h.textColor}),"text-halo-color":new mt(xe.paint_symbol["text-halo-color"]),"text-halo-width":new mt(xe.paint_symbol["text-halo-width"]),"text-halo-blur":new mt(xe.paint_symbol["text-halo-blur"]),"text-translate":new pt(xe.paint_symbol["text-translate"]),"text-translate-anchor":new pt(xe.paint_symbol["text-translate-anchor"])})},get layout(){return Fx=Fx||new Ss({"symbol-placement":new pt(xe.layout_symbol["symbol-placement"]),"symbol-spacing":new pt(xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new pt(xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new mt(xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new pt(xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new pt(xe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new pt(xe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new pt(xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new pt(xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new pt(xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new mt(xe.layout_symbol["icon-size"]),"icon-text-fit":new pt(xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new pt(xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new mt(xe.layout_symbol["icon-image"]),"icon-rotate":new mt(xe.layout_symbol["icon-rotate"]),"icon-padding":new mt(xe.layout_symbol["icon-padding"]),"icon-keep-upright":new pt(xe.layout_symbol["icon-keep-upright"]),"icon-offset":new mt(xe.layout_symbol["icon-offset"]),"icon-anchor":new mt(xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new pt(xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new pt(xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new pt(xe.layout_symbol["text-rotation-alignment"]),"text-field":new mt(xe.layout_symbol["text-field"]),"text-font":new mt(xe.layout_symbol["text-font"]),"text-size":new mt(xe.layout_symbol["text-size"]),"text-max-width":new mt(xe.layout_symbol["text-max-width"]),"text-line-height":new pt(xe.layout_symbol["text-line-height"]),"text-letter-spacing":new mt(xe.layout_symbol["text-letter-spacing"]),"text-justify":new mt(xe.layout_symbol["text-justify"]),"text-radial-offset":new mt(xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new pt(xe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new mt(xe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new mt(xe.layout_symbol["text-anchor"]),"text-max-angle":new pt(xe.layout_symbol["text-max-angle"]),"text-writing-mode":new pt(xe.layout_symbol["text-writing-mode"]),"text-rotate":new mt(xe.layout_symbol["text-rotate"]),"text-padding":new pt(xe.layout_symbol["text-padding"]),"text-keep-upright":new pt(xe.layout_symbol["text-keep-upright"]),"text-transform":new mt(xe.layout_symbol["text-transform"]),"text-offset":new mt(xe.layout_symbol["text-offset"]),"text-allow-overlap":new pt(xe.layout_symbol["text-allow-overlap"]),"text-overlap":new pt(xe.layout_symbol["text-overlap"]),"text-ignore-placement":new pt(xe.layout_symbol["text-ignore-placement"]),"text-optional":new pt(xe.layout_symbol["text-optional"])})}};class kx{constructor(a){if(a.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=a.property.overrides?a.property.overrides.runtimeType:ca,this.defaultValue=a}evaluate(a){if(a.formattedSection){let c=this.defaultValue.property.overrides;if(c&&c.hasOverride(a.formattedSection))return c.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}rt("FormatSectionOverride",kx,{omit:["defaultValue"]});class ff extends Mo{constructor(a,c){super(a,Ty,c)}recalculate(a,c){if(super.recalculate(a,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let g=this.layout.get("text-writing-mode");if(g){let m=[];for(let b of g)m.indexOf(b)<0&&m.push(b);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(a,c,g,m){let b=this.layout.get(a).evaluate(c,{},g,m),_=this._unevaluatedLayout._values[a];return _.isDataDriven()||Uc(_.value)||!b?b:function(E,M){return M.replace(/{([^{}]+)}/g,(F,A)=>E&&A in E?String(E[A]):"")}(c.properties,b)}createBucket(a){return new bh(a)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let a of Ty.paint.overridableProperties){if(!ff.hasPaintOverride(this.layout,a))continue;let c=this.paint.get(a),g=new kx(c),m=new rd(g,c.property.specification),b=null;b=c.value.kind==="constant"||c.value.kind==="source"?new Pl("source",m):new ad("composite",m,c.value.zoomStops),this.paint._values[a]=new qo(c.property,b,c.parameters)}}_handleOverridablePaintPropertyUpdate(a,c,g){return!(!this.layout||c.isDataDriven()||g.isDataDriven())&&ff.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,c){let g=a.get("text-field"),m=Ty.paint.properties[c],b=!1,_=E=>{for(let M of E)if(m.overrides&&m.overrides.hasOverride(M))return void(b=!0)};if(g.value.kind==="constant"&&g.value.value instanceof Ts)_(g.value.value.sections);else if(g.value.kind==="source"||g.value.kind==="composite"){let E=F=>{b||(F instanceof ln&&yt(F.value)===kn?_(F.value.sections):F instanceof br?_(F.sections):F.eachChild(E))},M=g.value;M._styleExpression&&E(M._styleExpression.expression)}return b}}let Ax;var k3={get paint(){return Ax=Ax||new Ss({"background-color":new pt(xe.paint_background["background-color"]),"background-pattern":new Pd(xe.paint_background["background-pattern"]),"background-opacity":new pt(xe.paint_background["background-opacity"])})}};class A3 extends Mo{constructor(a,c){super(a,k3,c)}}let Lx;var L3={get paint(){return Lx=Lx||new Ss({"raster-opacity":new pt(xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new pt(xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new pt(xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new pt(xe.paint_raster["raster-brightness-max"]),"raster-saturation":new pt(xe.paint_raster["raster-saturation"]),"raster-contrast":new pt(xe.paint_raster["raster-contrast"]),"raster-resampling":new pt(xe.paint_raster["raster-resampling"]),"raster-fade-duration":new pt(xe.paint_raster["raster-fade-duration"])})}};class O3 extends Mo{constructor(a,c){super(a,L3,c)}}class z3 extends Mo{constructor(a,c){super(a,{},c),this.onAdd=g=>{this.implementation.onAdd&&this.implementation.onAdd(g,g.painter.context.gl)},this.onRemove=g=>{this.implementation.onRemove&&this.implementation.onRemove(g,g.painter.context.gl)},this.implementation=a}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class B3{constructor(a){this._methodToThrottle=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}let V3={once:!0},Dy=63710088e-1;class Ta{constructor(a,c){if(isNaN(a)||isNaN(c))throw new Error(`Invalid LngLat object: (${a}, ${c})`);if(this.lng=+a,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ta(ro(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){let c=Math.PI/180,g=this.lat*c,m=a.lat*c,b=Math.sin(g)*Math.sin(m)+Math.cos(g)*Math.cos(m)*Math.cos((a.lng-this.lng)*c);return Dy*Math.acos(Math.min(b,1))}static convert(a){if(a instanceof Ta)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new Ta(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new Ta(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}let Ox=2*Math.PI*Dy;function zx(h){return Ox*Math.cos(h*Math.PI/180)}function Bx(h){return(180+h)/360}function Vx(h){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h*Math.PI/360)))/360}function Hx(h,a){return h/zx(a)}function Fy(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}function Nx(h,a){return h*zx(Fy(a))}class jd{constructor(a,c,g=0){this.x=+a,this.y=+c,this.z=+g}static fromLngLat(a,c=0){let g=Ta.convert(a);return new jd(Bx(g.lng),Vx(g.lat),Hx(c,g.lat))}toLngLat(){return new Ta(360*this.x-180,Fy(this.y))}toAltitude(){return Nx(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ox*(a=Fy(this.y),1/Math.cos(a*Math.PI/180));var a}}function Gx(h,a,c){var g=2*Math.PI*6378137/256/Math.pow(2,c);return[h*g-2*Math.PI*6378137/2,a*g-2*Math.PI*6378137/2]}class Iy{constructor(a,c,g){if(!function(m,b,_){return!(m<0||m>25||_<0||_>=Math.pow(2,m)||b<0||b>=Math.pow(2,m))}(a,c,g))throw new Error(`x=${c}, y=${g}, z=${a} outside of bounds. 0<=x<${Math.pow(2,a)}, 0<=y<${Math.pow(2,a)} 0<=z<=25 `);this.z=a,this.x=c,this.y=g,this.key=xh(0,a,a,c,g)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,c,g){let m=(_=this.y,E=this.z,M=Gx(256*(b=this.x),256*(_=Math.pow(2,E)-_-1),E),F=Gx(256*(b+1),256*(_+1),E),M[0]+","+M[1]+","+F[0]+","+F[1]);var b,_,E,M,F;let A=function(z,N,U){let j,K="";for(let J=z;J>0;J--)j=1<<J-1,K+=(N&j?1:0)+(U&j?2:0);return K}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(g==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,c>1?"@2x":"").replace(/{quadkey}/g,A).replace(/{bbox-epsg-3857}/g,m)}isChildOf(a){let c=this.z-a.z;return c>0&&a.x===this.x>>c&&a.y===this.y>>c}getTilePoint(a){let c=Math.pow(2,this.z);return new l((a.x*c-this.x)*Ct,(a.y*c-this.y)*Ct)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Wx{constructor(a,c){this.wrap=a,this.canonical=c,this.key=xh(a,c.z,c.z,c.x,c.y)}}class Fo{constructor(a,c,g,m,b){if(this.terrainRttPosMatrix32f=null,a<g)throw new Error(`overscaledZ should be >= z; overscaledZ = ${a}; z = ${g}`);this.overscaledZ=a,this.wrap=c,this.canonical=new Iy(g,+m,+b),this.key=xh(c,a,g,m,b)}clone(){return new Fo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);let c=this.canonical.z-a;return a>this.canonical.z?new Fo(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Fo(a,this.wrap,a,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(a,c){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);let g=this.canonical.z-a;return a>this.canonical.z?xh(this.wrap*+c,a,this.canonical.z,this.canonical.x,this.canonical.y):xh(this.wrap*+c,a,a,this.canonical.x>>g,this.canonical.y>>g)}isChildOf(a){if(a.wrap!==this.wrap||this.overscaledZ-a.overscaledZ<=0)return!1;if(a.overscaledZ===0)return this.overscaledZ>0;let c=this.canonical.z-a.canonical.z;return!(c<0)&&a.canonical.x===this.canonical.x>>c&&a.canonical.y===this.canonical.y>>c}children(a){if(this.overscaledZ>=a)return[new Fo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let c=this.canonical.z+1,g=2*this.canonical.x,m=2*this.canonical.y;return[new Fo(c,this.wrap,c,g,m),new Fo(c,this.wrap,c,g+1,m),new Fo(c,this.wrap,c,g,m+1),new Fo(c,this.wrap,c,g+1,m+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new Fo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new Fo(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Wx(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(a){return this.canonical.getTilePoint(new jd(a.x-this.wrap,a.y))}}function xh(h,a,c,g,m){(h*=2)<0&&(h=-1*h-1);let b=1<<c;return(b*b*h+b*m+g).toString(36)+c.toString(36)+a.toString(36)}function $d(h,a){return a?h.properties[a]:h.id}rt("CanonicalTileID",Iy),rt("OverscaledTileID",Fo,{omit:["terrainRttPosMatrix32f"]});class Gl{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(a){return this.minX=Math.min(this.minX,a.x),this.minY=Math.min(this.minY,a.y),this.maxX=Math.max(this.maxX,a.x),this.maxY=Math.max(this.maxY,a.y),this}expandBy(a){return this.minX-=a,this.minY-=a,this.maxX+=a,this.maxY+=a,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(a){return this.expandBy(-a)}map(a){let c=new Gl;return c.extend(a(new l(this.minX,this.minY))),c.extend(a(new l(this.maxX,this.minY))),c.extend(a(new l(this.minX,this.maxY))),c.extend(a(new l(this.maxX,this.maxY))),c}static fromPoints(a){let c=new Gl;for(let g of a)c.extend(g);return c}contains(a){return a.x>=this.minX&&a.x<=this.maxX&&a.y>=this.minY&&a.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(a){return!this.empty()&&!a.empty()&&a.minX>=this.minX&&a.maxX<=this.maxX&&a.minY>=this.minY&&a.maxY<=this.maxY}intersects(a){return!this.empty()&&!a.empty()&&a.minX<=this.maxX&&a.maxX>=this.minX&&a.minY<=this.maxY&&a.maxY>=this.minY}}class Ux{constructor(a){this._stringToNumber={},this._numberToString=[];for(let c=0;c<a.length;c++){let g=a[c];this._stringToNumber[g]=c,this._numberToString[c]=g}}encode(a){return this._stringToNumber[a]}decode(a){if(a>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${a} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[a]}}class jx{constructor(a,c,g,m,b){this.type="Feature",this._vectorTileFeature=a,a._z=c,a._x=g,a._y=m,this.properties=a.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){let a={geometry:this.geometry};for(let c in this)c!=="_geometry"&&c!=="_vectorTileFeature"&&(a[c]=this[c]);return a}}class $x{constructor(a,c){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new Ir(Ct,16,0),this.grid3D=new Ir(Ct,16,0),this.featureIndexArray=new we,this.promoteId=c}insert(a,c,g,m,b,_){let E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(g,m,b);let M=_?this.grid3D:this.grid;for(let F=0;F<c.length;F++){let A=c[F],z=[1/0,1/0,-1/0,-1/0];for(let N=0;N<A.length;N++){let U=A[N];z[0]=Math.min(z[0],U.x),z[1]=Math.min(z[1],U.y),z[2]=Math.max(z[2],U.x),z[3]=Math.max(z[3],U.y)}z[0]<Ct&&z[1]<Ct&&z[2]>=0&&z[3]>=0&&M.insert(E,z[0],z[1],z[2],z[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new lx(new by(this.rawTileData)).layers,this.sourceLayerCoder=new Ux(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(a,c,g,m){this.loadVTLayers();let b=a.params,_=Ct/a.tileSize/a.scale,E=Mr(b.filter,b.globalState),M=a.queryGeometry,F=a.queryPadding*_,A=Gl.fromPoints(M),z=this.grid.query(A.minX-F,A.minY-F,A.maxX+F,A.maxY+F),N=Gl.fromPoints(a.cameraQueryGeometry).expandBy(F),U=this.grid3D.query(N.minX,N.minY,N.maxX,N.maxY,(J,se,Ce,ce)=>function(pe,Pe,Ie,Ne,et){for(let Qe of pe)if(Pe<=Qe.x&&Ie<=Qe.y&&Ne>=Qe.x&&et>=Qe.y)return!0;let qe=[new l(Pe,Ie),new l(Pe,et),new l(Ne,et),new l(Ne,Ie)];if(pe.length>2){for(let Qe of qe)if(ph(pe,Qe))return!0}for(let Qe=0;Qe<pe.length-1;Qe++)if(pD(pe[Qe],pe[Qe+1],qe))return!0;return!1}(a.cameraQueryGeometry,J-F,se-F,Ce+F,ce+F));for(let J of U)z.push(J);z.sort(H3);let j={},K;for(let J=0;J<z.length;J++){let se=z[J];if(se===K)continue;K=se;let Ce=this.featureIndexArray.get(se),ce=null;this.loadMatchingFeature(j,Ce.bucketIndex,Ce.sourceLayerIndex,Ce.featureIndex,E,b.layers,b.availableImages,c,g,m,(pe,Pe,Ie)=>(ce||(ce=Bl(pe)),Pe.queryIntersectsFeature({queryGeometry:M,feature:pe,featureState:Ie,geometry:ce,zoom:this.z,transform:a.transform,pixelsToTileUnits:_,pixelPosMatrix:a.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:a.getElevation})))}return j}loadMatchingFeature(a,c,g,m,b,_,E,M,F,A,z){let N=this.bucketLayerIDs[c];if(_&&!N.some(J=>_.has(J)))return;let U=this.sourceLayerCoder.decode(g),j=this.vtLayers[U].feature(m);if(b.needGeometry){let J=Vl(j,!0);if(!b.filter(new ei(this.tileID.overscaledZ),J,this.tileID.canonical))return}else if(!b.filter(new ei(this.tileID.overscaledZ),j))return;let K=this.getId(j,U);for(let J=0;J<N.length;J++){let se=N[J];if(_&&!_.has(se))continue;let Ce=M[se];if(!Ce)continue;let ce={};K&&A&&(ce=A.getState(Ce.sourceLayer||"_geojsonTileLayer",K));let pe=$i({},F[se]);pe.paint=qx(pe.paint,Ce.paint,j,ce,E),pe.layout=qx(pe.layout,Ce.layout,j,ce,E);let Pe=!z||z(j,Ce,ce);if(!Pe)continue;let Ie=new jx(j,this.z,this.x,this.y,K);Ie.layer=pe;let Ne=a[se];Ne===void 0&&(Ne=a[se]=[]),Ne.push({featureIndex:m,feature:Ie,intersectionZ:Pe})}}lookupSymbolFeatures(a,c,g,m,b,_,E,M){let F={};this.loadVTLayers();let A=Mr(b.filterSpec,b.globalState);for(let z of a)this.loadMatchingFeature(F,g,m,z,A,_,E,M,c);return F}hasLayer(a){for(let c of this.bucketLayerIDs)for(let g of c)if(a===g)return!0;return!1}getId(a,c){var g;let m=a.id;return this.promoteId&&(m=a.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[c]],typeof m=="boolean"&&(m=Number(m)),m===void 0&&(!((g=a.properties)===null||g===void 0)&&g.cluster)&&this.promoteId&&(m=Number(a.properties.cluster_id))),m}}function qx(h,a,c,g,m){return na(h,(b,_)=>{let E=a instanceof sh?a.get(_):null;return E&&E.evaluate?E.evaluate(c,g,m):E})}function H3(h,a){return a-h}function Zx(h,a,c,g,m){let b=[];for(let _=0;_<h.length;_++){let E=h[_],M;for(let F=0;F<E.length-1;F++){let A=E[F],z=E[F+1];A.x<a&&z.x<a||(A.x<a?A=new l(a,A.y+(a-A.x)/(z.x-A.x)*(z.y-A.y))._round():z.x<a&&(z=new l(a,A.y+(a-A.x)/(z.x-A.x)*(z.y-A.y))._round()),A.y<c&&z.y<c||(A.y<c?A=new l(A.x+(c-A.y)/(z.y-A.y)*(z.x-A.x),c)._round():z.y<c&&(z=new l(A.x+(c-A.y)/(z.y-A.y)*(z.x-A.x),c)._round()),A.x>=g&&z.x>=g||(A.x>=g?A=new l(g,A.y+(g-A.x)/(z.x-A.x)*(z.y-A.y))._round():z.x>=g&&(z=new l(g,A.y+(g-A.x)/(z.x-A.x)*(z.y-A.y))._round()),A.y>=m&&z.y>=m||(A.y>=m?A=new l(A.x+(m-A.y)/(z.y-A.y)*(z.x-A.x),m)._round():z.y>=m&&(z=new l(A.x+(m-A.y)/(z.y-A.y)*(z.x-A.x),m)._round()),M&&A.equals(M[M.length-1])||(M=[A],b.push(M)),M.push(z)))))}}return b}rt("FeatureIndex",$x,{omit:["rawTileData","sourceLayerCoder"]});class Da extends l{constructor(a,c,g,m){super(a,c),this.angle=g,m!==void 0&&(this.segment=m)}clone(){return new Da(this.x,this.y,this.angle,this.segment)}}function Kx(h,a,c,g,m){if(a.segment===void 0||c===0)return!0;let b=a,_=a.segment+1,E=0;for(;E>-c/2;){if(_--,_<0)return!1;E-=h[_].dist(b),b=h[_]}E+=h[_].dist(h[_+1]),_++;let M=[],F=0;for(;E<c/2;){let A=h[_],z=h[_+1];if(!z)return!1;let N=h[_-1].angleTo(A)-A.angleTo(z);for(N=Math.abs((N+3*Math.PI)%(2*Math.PI)-Math.PI),M.push({distance:E,angleDelta:N}),F+=N;E-M[0].distance>g;)F-=M.shift().angleDelta;if(F>m)return!1;_++,E+=A.dist(z)}return!0}function Xx(h){let a=0;for(let c=0;c<h.length-1;c++)a+=h[c].dist(h[c+1]);return a}function Yx(h,a,c){return h?.6*a*c:0}function Qx(h,a){return Math.max(h?h.right-h.left:0,a?a.right-a.left:0)}function N3(h,a,c,g,m,b){let _=Yx(c,m,b),E=Qx(c,g)*b,M=0,F=Xx(h)/2;for(let A=0;A<h.length-1;A++){let z=h[A],N=h[A+1],U=z.dist(N);if(M+U>F){let j=(F-M)/U,K=$o.number(z.x,N.x,j),J=$o.number(z.y,N.y,j),se=new Da(K,J,N.angleTo(z),A);return se._round(),!_||Kx(h,se,E,_,a)?se:void 0}M+=U}}function G3(h,a,c,g,m,b,_,E,M){let F=Yx(g,b,_),A=Qx(g,m),z=A*_,N=h[0].x===0||h[0].x===M||h[0].y===0||h[0].y===M;return a-z<a/4&&(a=z+a/4),Jx(h,N?a/2*E%a:(A/2+2*b)*_*E%a,a,F,c,z,N,!1,M)}function Jx(h,a,c,g,m,b,_,E,M){let F=b/2,A=Xx(h),z=0,N=a-c,U=[];for(let j=0;j<h.length-1;j++){let K=h[j],J=h[j+1],se=K.dist(J),Ce=J.angleTo(K);for(;N+c<z+se;){N+=c;let ce=(N-z)/se,pe=$o.number(K.x,J.x,ce),Pe=$o.number(K.y,J.y,ce);if(pe>=0&&pe<M&&Pe>=0&&Pe<M&&N-F>=0&&N+F<=A){let Ie=new Da(pe,Pe,Ce,j);Ie._round(),g&&!Kx(h,Ie,b,g,m)||U.push(Ie)}}z+=se}return E||U.length||_||(U=Jx(h,z/2,c,g,m,b,_,!0,M)),U}function e_(h,a,c,g){let m=[],b=h.image,_=b.pixelRatio,E=b.paddedRect.w-2,M=b.paddedRect.h-2,F={x1:h.left,y1:h.top,x2:h.right,y2:h.bottom},A=b.stretchX||[[0,E]],z=b.stretchY||[[0,M]],N=(ze,wt)=>ze+wt[1]-wt[0],U=A.reduce(N,0),j=z.reduce(N,0),K=E-U,J=M-j,se=0,Ce=U,ce=0,pe=j,Pe=0,Ie=K,Ne=0,et=J;if(b.content&&g){let ze=b.content,wt=ze[2]-ze[0],_t=ze[3]-ze[1];(b.textFitWidth||b.textFitHeight)&&(F=Mx(h)),se=mf(A,0,ze[0]),ce=mf(z,0,ze[1]),Ce=mf(A,ze[0],ze[2]),pe=mf(z,ze[1],ze[3]),Pe=ze[0]-se,Ne=ze[1]-ce,Ie=wt-Ce,et=_t-pe}let qe=F.x1,Qe=F.y1,gt=F.x2-qe,Ye=F.y2-Qe,Je=(ze,wt,_t,vt)=>{let dt=vf(ze.stretch-se,Ce,gt,qe),Nt=yf(ze.fixed-Pe,Ie,ze.stretch,U),Pi=vf(wt.stretch-ce,pe,Ye,Qe),ss=yf(wt.fixed-Ne,et,wt.stretch,j),Es=vf(_t.stretch-se,Ce,gt,qe),Io=yf(_t.fixed-Pe,Ie,_t.stretch,U),io=vf(vt.stretch-ce,pe,Ye,Qe),vs=yf(vt.fixed-Ne,et,vt.stretch,j),_i=new l(dt,Pi),hs=new l(Es,Pi),ys=new l(Es,io),ws=new l(dt,io),$s=new l(Nt/_,ss/_),ko=new l(Io/_,vs/_),us=a*Math.PI/180;if(us){let ds=Math.sin(us),ps=Math.cos(us),Xi=[ps,-ds,ds,ps];_i._matMult(Xi),hs._matMult(Xi),ws._matMult(Xi),ys._matMult(Xi)}let so=ze.stretch+ze.fixed,os=wt.stretch+wt.fixed;return{tl:_i,tr:hs,bl:ws,br:ys,tex:{x:b.paddedRect.x+1+so,y:b.paddedRect.y+1+os,w:_t.stretch+_t.fixed-so,h:vt.stretch+vt.fixed-os},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:$s,pixelOffsetBR:ko,minFontScaleX:Ie/_/gt,minFontScaleY:et/_/Ye,isSDF:c}};if(g&&(b.stretchX||b.stretchY)){let ze=t_(A,K,U),wt=t_(z,J,j);for(let _t=0;_t<ze.length-1;_t++){let vt=ze[_t],dt=ze[_t+1];for(let Nt=0;Nt<wt.length-1;Nt++)m.push(Je(vt,wt[Nt],dt,wt[Nt+1]))}}else m.push(Je({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:M+1}));return m}function mf(h,a,c){let g=0;for(let m of h)g+=Math.max(a,Math.min(c,m[1]))-Math.max(a,Math.min(c,m[0]));return g}function t_(h,a,c){let g=[{fixed:-1,stretch:0}];for(let[m,b]of h){let _=g[g.length-1];g.push({fixed:m-_.stretch,stretch:_.stretch}),g.push({fixed:m-_.stretch,stretch:_.stretch+(b-m)})}return g.push({fixed:a+1,stretch:c}),g}function vf(h,a,c,g){return h/a*c+g}function yf(h,a,c,g){return h-a*c/g}rt("Anchor",Da);class wf{constructor(a,c,g,m,b,_,E,M,F,A){var z;if(this.boxStartIndex=a.length,F){let N=_.top,U=_.bottom,j=_.collisionPadding;j&&(N-=j[1],U+=j[3]);let K=U-N;K>0&&(K=Math.max(10,K),this.circleDiameter=K)}else{let N=!((z=_.image)===null||z===void 0)&&z.content&&(_.image.textFitWidth||_.image.textFitHeight)?Mx(_):{x1:_.left,y1:_.top,x2:_.right,y2:_.bottom};N.y1=N.y1*E-M[0],N.y2=N.y2*E+M[2],N.x1=N.x1*E-M[3],N.x2=N.x2*E+M[1];let U=_.collisionPadding;if(U&&(N.x1-=U[0]*E,N.y1-=U[1]*E,N.x2+=U[2]*E,N.y2+=U[3]*E),A){let j=new l(N.x1,N.y1),K=new l(N.x2,N.y1),J=new l(N.x1,N.y2),se=new l(N.x2,N.y2),Ce=A*Math.PI/180;j._rotate(Ce),K._rotate(Ce),J._rotate(Ce),se._rotate(Ce),N.x1=Math.min(j.x,K.x,J.x,se.x),N.x2=Math.max(j.x,K.x,J.x,se.x),N.y1=Math.min(j.y,K.y,J.y,se.y),N.y2=Math.max(j.y,K.y,J.y,se.y)}a.emplaceBack(c.x,c.y,N.x1,N.y1,N.x2,N.y2,g,m,b)}this.boxEndIndex=a.length}}class W3{constructor(a=[],c=(g,m)=>g<m?-1:g>m?1:0){if(this.data=a,this.length=this.data.length,this.compare=c,this.length>0)for(let g=(this.length>>1)-1;g>=0;g--)this._down(g)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;let a=this.data[0],c=this.data.pop();return--this.length>0&&(this.data[0]=c,this._down(0)),a}peek(){return this.data[0]}_up(a){let{data:c,compare:g}=this,m=c[a];for(;a>0;){let b=a-1>>1,_=c[b];if(g(m,_)>=0)break;c[a]=_,a=b}c[a]=m}_down(a){let{data:c,compare:g}=this,m=this.length>>1,b=c[a];for(;a<m;){let _=1+(a<<1),E=_+1;if(E<this.length&&g(c[E],c[_])<0&&(_=E),g(c[_],b)>=0)break;c[a]=c[_],a=_}c[a]=b}}function U3(h,a=1,c=!1){let g=Gl.fromPoints(h[0]),m=Math.min(g.width(),g.height()),b=m/2,_=new W3([],j3),{minX:E,minY:M,maxX:F,maxY:A}=g;if(m===0)return new l(E,M);for(let U=E;U<F;U+=m)for(let j=M;j<A;j+=m)_.push(new _h(U+b,j+b,b,h));let z=function(U){let j=0,K=0,J=0,se=U[0];for(let Ce=0,ce=se.length,pe=ce-1;Ce<ce;pe=Ce++){let Pe=se[Ce],Ie=se[pe],Ne=Pe.x*Ie.y-Ie.x*Pe.y;K+=(Pe.x+Ie.x)*Ne,J+=(Pe.y+Ie.y)*Ne,j+=3*Ne}return new _h(K/j,J/j,0,U)}(h),N=_.length;for(;_.length;){let U=_.pop();(U.d>z.d||!z.d)&&(z=U,c&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,N)),U.max-z.d<=a||(b=U.h/2,_.push(new _h(U.p.x-b,U.p.y-b,b,h)),_.push(new _h(U.p.x+b,U.p.y-b,b,h)),_.push(new _h(U.p.x-b,U.p.y+b,b,h)),_.push(new _h(U.p.x+b,U.p.y+b,b,h)),N+=4)}return c&&(console.log(`num probes: ${N}`),console.log(`best distance: ${z.d}`)),z.p}function j3(h,a){return a.max-h.max}function _h(h,a,c,g){this.p=new l(h,a),this.h=c,this.d=function(m,b){let _=!1,E=1/0;for(let M=0;M<b.length;M++){let F=b[M];for(let A=0,z=F.length,N=z-1;A<z;N=A++){let U=F[A],j=F[N];U.y>m.y!=j.y>m.y&&m.x<(j.x-U.x)*(m.y-U.y)/(j.y-U.y)+U.x&&(_=!_),E=Math.min(E,Vb(m,U,j))}}return(_?1:-1)*Math.sqrt(E)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}var Rs;n.aE=void 0,(Rs=n.aE||(n.aE={}))[Rs.center=1]="center",Rs[Rs.left=2]="left",Rs[Rs.right=3]="right",Rs[Rs.top=4]="top",Rs[Rs.bottom=5]="bottom",Rs[Rs["top-left"]=6]="top-left",Rs[Rs["top-right"]=7]="top-right",Rs[Rs["bottom-left"]=8]="bottom-left",Rs[Rs["bottom-right"]=9]="bottom-right";let ky=Number.POSITIVE_INFINITY;function i_(h,a){return a[1]!==ky?function(c,g,m){let b=0,_=0;switch(g=Math.abs(g),m=Math.abs(m),c){case"top-right":case"top-left":case"top":_=m-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-m}switch(c){case"top-right":case"bottom-right":case"right":b=-g;break;case"top-left":case"bottom-left":case"left":b=g}return[b,_]}(h,a[0],a[1]):function(c,g){let m=0,b=0;g<0&&(g=0);let _=g/Math.SQRT2;switch(c){case"top-right":case"top-left":b=_-7;break;case"bottom-right":case"bottom-left":b=7-_;break;case"bottom":b=7-g;break;case"top":b=g-7}switch(c){case"top-right":case"bottom-right":m=-_;break;case"top-left":case"bottom-left":m=_;break;case"left":m=g;break;case"right":m=-g}return[m,b]}(h,a[0])}function s_(h,a,c){var g;let m=h.layout,b=(g=m.get("text-variable-anchor-offset"))===null||g===void 0?void 0:g.evaluate(a,{},c);if(b){let E=b.values,M=[];for(let F=0;F<E.length;F+=2){let A=M[F]=E[F],z=E[F+1].map(N=>N*cs);A.startsWith("top")?z[1]-=7:A.startsWith("bottom")&&(z[1]+=7),M[F+1]=z}return new Fs(M)}let _=m.get("text-variable-anchor");if(_){let E;E=h._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[m.get("text-radial-offset").evaluate(a,{},c)*cs,ky]:m.get("text-offset").evaluate(a,{},c).map(F=>F*cs);let M=[];for(let F of _)M.push(F,i_(F,E));return new Fs(M)}return null}function Ay(h){switch(h){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function $3(h,a,c,g,m,b,_,E,M,F,A,z){let N=b.textMaxSize.evaluate(a,{});N===void 0&&(N=_);let U=h.layers[0].layout,j=U.get("icon-offset").evaluate(a,{},A),K=n_(c.horizontal),J=_/24,se=h.tilePixelRatio*J,Ce=h.tilePixelRatio*N/24,ce=h.tilePixelRatio*E,pe=h.tilePixelRatio*U.get("symbol-spacing"),Pe=U.get("text-padding")*h.tilePixelRatio,Ie=function(_t,vt,dt,Nt=1){let Pi=_t.get("icon-padding").evaluate(vt,{},dt),ss=Pi&&Pi.values;return[ss[0]*Nt,ss[1]*Nt,ss[2]*Nt,ss[3]*Nt]}(U,a,A,h.tilePixelRatio),Ne=U.get("text-max-angle")/180*Math.PI,et=U.get("text-rotation-alignment")!=="viewport"&&U.get("symbol-placement")!=="point",qe=U.get("icon-rotation-alignment")==="map"&&U.get("symbol-placement")!=="point",Qe=U.get("symbol-placement"),gt=pe/2,Ye=U.get("icon-text-fit"),Je;g&&Ye!=="none"&&(h.allowVerticalPlacement&&c.vertical&&(Je=Tx(g,c.vertical,Ye,U.get("icon-text-fit-padding"),j,J)),K&&(g=Tx(g,K,Ye,U.get("icon-text-fit-padding"),j,J)));let ze=A?z.line.getGranularityForZoomLevel(A.z):1,wt=(_t,vt)=>{vt.x<0||vt.x>=Ct||vt.y<0||vt.y>=Ct||function(dt,Nt,Pi,ss,Es,Io,io,vs,_i,hs,ys,ws,$s,ko,us,so,os,ds,ps,Xi,gi,gn,Sh,fn,K3){let Rh=dt.addToLineVertexArray(Nt,Pi),Wl,Eh,Ph,Mh,c_=0,h_=0,u_=0,d_=0,Gy=-1,Wy=-1,Vr={},p_=Gn("");if(dt.allowVerticalPlacement&&ss.vertical){let Ls=vs.layout.get("text-rotate").evaluate(gi,{},fn)+90;Ph=new wf(_i,Nt,hs,ys,ws,ss.vertical,$s,ko,us,Ls),io&&(Mh=new wf(_i,Nt,hs,ys,ws,io,os,ds,us,Ls))}if(Es){let Ls=vs.layout.get("icon-rotate").evaluate(gi,{}),Ao=vs.layout.get("icon-text-fit")!=="none",Ul=e_(Es,Ls,Sh,Ao),vn=io?e_(io,Ls,Sh,Ao):void 0;Eh=new wf(_i,Nt,hs,ys,ws,Es,os,ds,!1,Ls),c_=4*Ul.length;let jl=dt.iconSizeData,jn=null;jl.kind==="source"?(jn=[Br*vs.layout.get("icon-size").evaluate(gi,{})],jn[0]>Ma&&Vi(`${dt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):jl.kind==="composite"&&(jn=[Br*gn.compositeIconSizes[0].evaluate(gi,{},fn),Br*gn.compositeIconSizes[1].evaluate(gi,{},fn)],(jn[0]>Ma||jn[1]>Ma)&&Vi(`${dt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),dt.addSymbols(dt.icon,Ul,jn,Xi,ps,gi,n.ao.none,Nt,Rh.lineStartIndex,Rh.lineLength,-1,fn),Gy=dt.icon.placedSymbolArray.length-1,vn&&(h_=4*vn.length,dt.addSymbols(dt.icon,vn,jn,Xi,ps,gi,n.ao.vertical,Nt,Rh.lineStartIndex,Rh.lineLength,-1,fn),Wy=dt.icon.placedSymbolArray.length-1)}let g_=Object.keys(ss.horizontal);for(let Ls of g_){let Ao=ss.horizontal[Ls];if(!Wl){p_=Gn(Ao.text);let vn=vs.layout.get("text-rotate").evaluate(gi,{},fn);Wl=new wf(_i,Nt,hs,ys,ws,Ao,$s,ko,us,vn)}let Ul=Ao.positionedLines.length===1;if(u_+=o_(dt,Nt,Ao,Io,vs,us,gi,so,Rh,ss.vertical?n.ao.horizontal:n.ao.horizontalOnly,Ul?g_:[Ls],Vr,Gy,gn,fn),Ul)break}ss.vertical&&(d_+=o_(dt,Nt,ss.vertical,Io,vs,us,gi,so,Rh,n.ao.vertical,["vertical"],Vr,Wy,gn,fn));let X3=Wl?Wl.boxStartIndex:dt.collisionBoxArray.length,Y3=Wl?Wl.boxEndIndex:dt.collisionBoxArray.length,Q3=Ph?Ph.boxStartIndex:dt.collisionBoxArray.length,J3=Ph?Ph.boxEndIndex:dt.collisionBoxArray.length,eF=Eh?Eh.boxStartIndex:dt.collisionBoxArray.length,tF=Eh?Eh.boxEndIndex:dt.collisionBoxArray.length,iF=Mh?Mh.boxStartIndex:dt.collisionBoxArray.length,sF=Mh?Mh.boxEndIndex:dt.collisionBoxArray.length,mn=-1,bf=(Ls,Ao)=>Ls&&Ls.circleDiameter?Math.max(Ls.circleDiameter,Ao):Ao;mn=bf(Wl,mn),mn=bf(Ph,mn),mn=bf(Eh,mn),mn=bf(Mh,mn);let f_=mn>-1?1:0;f_&&(mn*=K3/cs),dt.glyphOffsetArray.length>=bh.MAX_GLYPHS&&Vi("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),gi.sortKey!==void 0&&dt.addToSortKeyRanges(dt.symbolInstances.length,gi.sortKey);let oF=s_(vs,gi,fn),[nF,rF]=function(Ls,Ao){let Ul=Ls.length,vn=Ao?.values;if(vn?.length>0)for(let jl=0;jl<vn.length;jl+=2){let jn=vn[jl+1];Ls.emplaceBack(n.aE[vn[jl]],jn[0],jn[1])}return[Ul,Ls.length]}(dt.textAnchorOffsets,oF);dt.symbolInstances.emplaceBack(Nt.x,Nt.y,Vr.right>=0?Vr.right:-1,Vr.center>=0?Vr.center:-1,Vr.left>=0?Vr.left:-1,Vr.vertical||-1,Gy,Wy,p_,X3,Y3,Q3,J3,eF,tF,iF,sF,hs,u_,d_,c_,h_,f_,0,$s,mn,nF,rF)}(h,vt,_t,c,g,m,Je,h.layers[0],h.collisionBoxArray,a.index,a.sourceLayerIndex,h.index,se,[Pe,Pe,Pe,Pe],et,M,ce,Ie,qe,j,a,b,F,A,_)};if(Qe==="line")for(let _t of Zx(a.geometry,0,0,Ct,Ct)){let vt=Nl(_t,ze),dt=G3(vt,pe,Ne,c.vertical||K,g,24,Ce,h.overscaling,Ct);for(let Nt of dt)K&&q3(h,K.text,gt,Nt)||wt(vt,Nt)}else if(Qe==="line-center"){for(let _t of a.geometry)if(_t.length>1){let vt=Nl(_t,ze),dt=N3(vt,Ne,c.vertical||K,g,24,Ce);dt&&wt(vt,dt)}}else if(a.type==="Polygon")for(let _t of xl(a.geometry,0)){let vt=U3(_t,16);wt(Nl(_t[0],ze,!0),new Da(vt.x,vt.y,0))}else if(a.type==="LineString")for(let _t of a.geometry){let vt=Nl(_t,ze);wt(vt,new Da(vt[0].x,vt[0].y,0))}else if(a.type==="Point")for(let _t of a.geometry)for(let vt of _t)wt([vt],new Da(vt.x,vt.y,0))}function o_(h,a,c,g,m,b,_,E,M,F,A,z,N,U,j){let K=function(Ce,ce,pe,Pe,Ie,Ne,et,qe){let Qe=Pe.layout.get("text-rotate").evaluate(Ne,{})*Math.PI/180,gt=[];for(let Ye of ce.positionedLines)for(let Je of Ye.positionedGlyphs){if(!Je.rect)continue;let ze=Je.rect||{},wt=4,_t=!0,vt=1,dt=0,Nt=(Ie||qe)&&Je.vertical,Pi=Je.metrics.advance*Je.scale/2;if(qe&&ce.verticalizable&&(dt=Ye.lineOffset/2-(Je.imageName?-(cs-Je.metrics.width*Je.scale)/2:(Je.scale-1)*cs)),Je.imageName){let ds=et[Je.imageName];_t=ds.sdf,vt=ds.pixelRatio,wt=1/vt}let ss=Ie?[Je.x+Pi,Je.y]:[0,0],Es=Ie?[0,0]:[Je.x+Pi+pe[0],Je.y+pe[1]-dt],Io=[0,0];Nt&&(Io=Es,Es=[0,0]);let io=Je.metrics.isDoubleResolution?2:1,vs=(Je.metrics.left-wt)*Je.scale-Pi+Es[0],_i=(-Je.metrics.top-wt)*Je.scale+Es[1],hs=vs+ze.w/io*Je.scale/vt,ys=_i+ze.h/io*Je.scale/vt,ws=new l(vs,_i),$s=new l(hs,_i),ko=new l(vs,ys),us=new l(hs,ys);if(Nt){let ds=new l(-Pi,Pi- -17),ps=-Math.PI/2,Xi=12-Pi,gi=new l(22-Xi,-(Je.imageName?Xi:0)),gn=new l(...Io);ws._rotateAround(ps,ds)._add(gi)._add(gn),$s._rotateAround(ps,ds)._add(gi)._add(gn),ko._rotateAround(ps,ds)._add(gi)._add(gn),us._rotateAround(ps,ds)._add(gi)._add(gn)}if(Qe){let ds=Math.sin(Qe),ps=Math.cos(Qe),Xi=[ps,-ds,ds,ps];ws._matMult(Xi),$s._matMult(Xi),ko._matMult(Xi),us._matMult(Xi)}let so=new l(0,0),os=new l(0,0);gt.push({tl:ws,tr:$s,bl:ko,br:us,tex:ze,writingMode:ce.writingMode,glyphOffset:ss,sectionIndex:Je.sectionIndex,isSDF:_t,pixelOffsetTL:so,pixelOffsetBR:os,minFontScaleX:0,minFontScaleY:0})}return gt}(0,c,E,m,b,_,g,h.allowVerticalPlacement),J=h.textSizeData,se=null;J.kind==="source"?(se=[Br*m.layout.get("text-size").evaluate(_,{})],se[0]>Ma&&Vi(`${h.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):J.kind==="composite"&&(se=[Br*U.compositeTextSizes[0].evaluate(_,{},j),Br*U.compositeTextSizes[1].evaluate(_,{},j)],(se[0]>Ma||se[1]>Ma)&&Vi(`${h.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),h.addSymbols(h.text,K,se,E,b,_,F,a,M.lineStartIndex,M.lineLength,N,j);for(let Ce of A)z[Ce]=h.text.placedSymbolArray.length-1;return 4*K.length}function n_(h){for(let a in h)return h[a];return null}function q3(h,a,c,g){let m=h.compareText;if(a in m){let b=m[a];for(let _=b.length-1;_>=0;_--)if(g.dist(b[_])<c)return!0}else m[a]=[];return m[a].push(g),!1}let r_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ly{static from(a){if(!(a instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[c,g]=new Uint8Array(a,0,2);if(c!==219)throw new Error("Data does not appear to be in a KDBush format.");let m=g>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);let b=r_[15&g];if(!b)throw new Error("Unrecognized array type.");let[_]=new Uint16Array(a,2,1),[E]=new Uint32Array(a,4,1);return new Ly(E,_,b,a)}constructor(a,c=64,g=Float64Array,m){if(isNaN(a)||a<0)throw new Error(`Unpexpected numItems value: ${a}.`);this.numItems=+a,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=g,this.IndexArrayType=a<65536?Uint16Array:Uint32Array;let b=r_.indexOf(this.ArrayType),_=2*a*this.ArrayType.BYTES_PER_ELEMENT,E=a*this.IndexArrayType.BYTES_PER_ELEMENT,M=(8-E%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${g}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+E+M,2*a),this._pos=2*a,this._finished=!0):(this.data=new ArrayBuffer(8+_+E+M),this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+E+M,2*a),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=a)}add(a,c){let g=this._pos>>1;return this.ids[g]=g,this.coords[this._pos++]=a,this.coords[this._pos++]=c,g}finish(){let a=this._pos>>1;if(a!==this.numItems)throw new Error(`Added ${a} items when expected ${this.numItems}.`);return Oy(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(a,c,g,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:b,coords:_,nodeSize:E}=this,M=[0,b.length-1,0],F=[];for(;M.length;){let A=M.pop()||0,z=M.pop()||0,N=M.pop()||0;if(z-N<=E){for(let J=N;J<=z;J++){let se=_[2*J],Ce=_[2*J+1];se>=a&&se<=g&&Ce>=c&&Ce<=m&&F.push(b[J])}continue}let U=N+z>>1,j=_[2*U],K=_[2*U+1];j>=a&&j<=g&&K>=c&&K<=m&&F.push(b[U]),(A===0?a<=j:c<=K)&&(M.push(N),M.push(U-1),M.push(1-A)),(A===0?g>=j:m>=K)&&(M.push(U+1),M.push(z),M.push(1-A))}return F}within(a,c,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:m,coords:b,nodeSize:_}=this,E=[0,m.length-1,0],M=[],F=g*g;for(;E.length;){let A=E.pop()||0,z=E.pop()||0,N=E.pop()||0;if(z-N<=_){for(let J=N;J<=z;J++)l_(b[2*J],b[2*J+1],a,c)<=F&&M.push(m[J]);continue}let U=N+z>>1,j=b[2*U],K=b[2*U+1];l_(j,K,a,c)<=F&&M.push(m[U]),(A===0?a-g<=j:c-g<=K)&&(E.push(N),E.push(U-1),E.push(1-A)),(A===0?a+g>=j:c+g>=K)&&(E.push(U+1),E.push(z),E.push(1-A))}return M}}function Oy(h,a,c,g,m,b){if(m-g<=c)return;let _=g+m>>1;a_(h,a,_,g,m,b),Oy(h,a,c,g,_-1,1-b),Oy(h,a,c,_+1,m,1-b)}function a_(h,a,c,g,m,b){for(;m>g;){if(m-g>600){let F=m-g+1,A=c-g+1,z=Math.log(F),N=.5*Math.exp(2*z/3),U=.5*Math.sqrt(z*N*(F-N)/F)*(A-F/2<0?-1:1);a_(h,a,c,Math.max(g,Math.floor(c-A*N/F+U)),Math.min(m,Math.floor(c+(F-A)*N/F+U)),b)}let _=a[2*c+b],E=g,M=m;for(qd(h,a,g,c),a[2*m+b]>_&&qd(h,a,g,m);E<M;){for(qd(h,a,E,M),E++,M--;a[2*E+b]<_;)E++;for(;a[2*M+b]>_;)M--}a[2*g+b]===_?qd(h,a,g,M):(M++,qd(h,a,M,m)),M<=c&&(g=M+1),c<=M&&(m=M-1)}}function qd(h,a,c,g){zy(h,c,g),zy(a,2*c,2*g),zy(a,2*c+1,2*g+1)}function zy(h,a,c){let g=h[a];h[a]=h[c],h[c]=g}function l_(h,a,c,g){let m=h-c,b=a-g;return m*m+b*b}var By;n.cx=void 0,(By=n.cx||(n.cx={})).create="create",By.load="load",By.fullLoad="fullLoad";let Cf=null,Zd=[],Vy=1e3/60,Hy="loadTime",Ny="fullLoadTime",Z3={mark(h){performance.mark(h)},frame(h){let a=h;Cf!=null&&Zd.push(a-Cf),Cf=a},clearMetrics(){Cf=null,Zd=[],performance.clearMeasures(Hy),performance.clearMeasures(Ny);for(let h in n.cx)performance.clearMarks(n.cx[h])},getPerformanceMetrics(){performance.measure(Hy,n.cx.create,n.cx.load),performance.measure(Ny,n.cx.create,n.cx.fullLoad);let h=performance.getEntriesByName(Hy)[0].duration,a=performance.getEntriesByName(Ny)[0].duration,c=Zd.length,g=1/(Zd.reduce((b,_)=>b+_,0)/c/1e3),m=Zd.filter(b=>b>Vy).reduce((b,_)=>b+(_-Vy)/Vy,0);return{loadTime:h,fullLoadTime:a,fps:g,percentDroppedFrames:m/(c+m)*100,totalFrames:c}}};n.$=Ct,n.A=X,n.B=function([h,a,c]){return a+=90,a*=Math.PI/180,c*=Math.PI/180,{x:h*Math.cos(a)*Math.sin(c),y:h*Math.sin(a)*Math.sin(c),z:h*Math.cos(c)}},n.C=$o,n.D=pt,n.E=ct,n.F=ei,n.G=Jv,n.H=function(h){if(pr==null){let a=h.navigator?h.navigator.userAgent:null;pr=!!h.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return pr},n.I=xy,n.J=class{constructor(h,a){this.target=h,this.mapId=a,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new B3(()=>this.process()),this.subscription=Pn(this.target,"message",c=>this.receive(c),!1),this.globalScope=Ho(self)?h:window}registerMessageHandler(h,a){this.messageHandlers[h]=a}sendAsync(h,a){return new Promise((c,g)=>{let m=Math.round(1e18*Math.random()).toString(36).substring(0,10),b=a?Pn(a.signal,"abort",()=>{b?.unsubscribe(),delete this.resolveRejects[m];let M={id:m,type:"<cancel>",origin:location.origin,targetMapId:h.targetMapId,sourceMapId:this.mapId};this.target.postMessage(M)},V3):null;this.resolveRejects[m]={resolve:M=>{b?.unsubscribe(),c(M)},reject:M=>{b?.unsubscribe(),g(M)}};let _=[],E=Object.assign(Object.assign({},h),{id:m,sourceMapId:this.mapId,origin:location.origin,data:kr(h.data,_)});this.target.postMessage(E,{transfer:_})})}receive(h){let a=h.data,c=a.id;if(!(a.origin!=="file://"&&location.origin!=="file://"&&a.origin!=="resource://android"&&location.origin!=="resource://android"&&a.origin!==location.origin||a.targetMapId&&this.mapId!==a.targetMapId)){if(a.type==="<cancel>"){delete this.tasks[c];let g=this.abortControllers[c];return delete this.abortControllers[c],void(g&&g.abort())}if(Ho(self)||a.mustQueue)return this.tasks[c]=a,this.taskQueue.push(c),void this.invoker.trigger();this.processTask(c,a)}}process(){if(this.taskQueue.length===0)return;let h=this.taskQueue.shift(),a=this.tasks[h];delete this.tasks[h],this.taskQueue.length>0&&this.invoker.trigger(),a&&this.processTask(h,a)}processTask(h,a){return o(this,void 0,void 0,function*(){if(a.type==="<response>"){let m=this.resolveRejects[h];return delete this.resolveRejects[h],m?void(a.error?m.reject(Sa(a.error)):m.resolve(Sa(a.data))):void 0}if(!this.messageHandlers[a.type])return void this.completeTask(h,new Error(`Could not find a registered handler for ${a.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));let c=Sa(a.data),g=new AbortController;this.abortControllers[h]=g;try{let m=yield this.messageHandlers[a.type](a.sourceMapId,c,g);this.completeTask(h,null,m)}catch(m){this.completeTask(h,m)}})}completeTask(h,a,c){let g=[];delete this.abortControllers[h];let m={id:h,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:a?kr(a):null,data:kr(c,g)};this.target.postMessage(m,{transfer:g})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},n.K=Y,n.L=function(){var h=new X(16);return X!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=0,h[12]=0,h[13]=0,h[14]=0),h[0]=1,h[5]=1,h[10]=1,h[15]=1,h},n.M=function(h,a,c){var g,m,b,_,E,M,F,A,z,N,U,j,K=c[0],J=c[1],se=c[2];return a===h?(h[12]=a[0]*K+a[4]*J+a[8]*se+a[12],h[13]=a[1]*K+a[5]*J+a[9]*se+a[13],h[14]=a[2]*K+a[6]*J+a[10]*se+a[14],h[15]=a[3]*K+a[7]*J+a[11]*se+a[15]):(m=a[1],b=a[2],_=a[3],E=a[4],M=a[5],F=a[6],A=a[7],z=a[8],N=a[9],U=a[10],j=a[11],h[0]=g=a[0],h[1]=m,h[2]=b,h[3]=_,h[4]=E,h[5]=M,h[6]=F,h[7]=A,h[8]=z,h[9]=N,h[10]=U,h[11]=j,h[12]=g*K+E*J+z*se+a[12],h[13]=m*K+M*J+N*se+a[13],h[14]=b*K+F*J+U*se+a[14],h[15]=_*K+A*J+j*se+a[15]),h},n.N=function(h,a,c){var g=c[0],m=c[1],b=c[2];return h[0]=a[0]*g,h[1]=a[1]*g,h[2]=a[2]*g,h[3]=a[3]*g,h[4]=a[4]*m,h[5]=a[5]*m,h[6]=a[6]*m,h[7]=a[7]*m,h[8]=a[8]*b,h[9]=a[9]*b,h[10]=a[10]*b,h[11]=a[11]*b,h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15],h},n.O=function(h,a,c){var g=a[0],m=a[1],b=a[2],_=a[3],E=a[4],M=a[5],F=a[6],A=a[7],z=a[8],N=a[9],U=a[10],j=a[11],K=a[12],J=a[13],se=a[14],Ce=a[15],ce=c[0],pe=c[1],Pe=c[2],Ie=c[3];return h[0]=ce*g+pe*E+Pe*z+Ie*K,h[1]=ce*m+pe*M+Pe*N+Ie*J,h[2]=ce*b+pe*F+Pe*U+Ie*se,h[3]=ce*_+pe*A+Pe*j+Ie*Ce,h[4]=(ce=c[4])*g+(pe=c[5])*E+(Pe=c[6])*z+(Ie=c[7])*K,h[5]=ce*m+pe*M+Pe*N+Ie*J,h[6]=ce*b+pe*F+Pe*U+Ie*se,h[7]=ce*_+pe*A+Pe*j+Ie*Ce,h[8]=(ce=c[8])*g+(pe=c[9])*E+(Pe=c[10])*z+(Ie=c[11])*K,h[9]=ce*m+pe*M+Pe*N+Ie*J,h[10]=ce*b+pe*F+Pe*U+Ie*se,h[11]=ce*_+pe*A+Pe*j+Ie*Ce,h[12]=(ce=c[12])*g+(pe=c[13])*E+(Pe=c[14])*z+(Ie=c[15])*K,h[13]=ce*m+pe*M+Pe*N+Ie*J,h[14]=ce*b+pe*F+Pe*U+Ie*se,h[15]=ce*_+pe*A+Pe*j+Ie*Ce,h},n.P=l,n.Q=function(h,a){let c={};for(let g=0;g<a.length;g++){let m=a[g];m in h&&(c[m]=h[m])}return c},n.R=to,n.S=Ta,n.T=uy,n.U=Vx,n.V=Bx,n.W=O,n.X=V,n.Y=aa,n.Z=Fo,n._=o,n.a=$,n.a$=Xe,n.a0=function(h,a){var c,g,m,b,_;if(!h)return a??{};if(!a)return h;let E=Object.assign({},h);if(a.removeAll&&(E={removeAll:!0}),a.remove){let M=new Set(a.remove);E.add&&(E.add=E.add.filter(A=>!M.has(A.id))),E.update&&(E.update=E.update.filter(A=>!M.has(A.id)));let F=new Set(((c=h.add)!==null&&c!==void 0?c:[]).map(A=>A.id));a.remove=a.remove.filter(A=>!F.has(A))}if(a.remove){let M=new Set(E.remove?E.remove.concat(a.remove):a.remove);E.remove=Array.from(M.values())}if(a.add){let M=E.add?E.add.concat(a.add):a.add,F=new Map(M.map(A=>[A.id,A]));E.add=Array.from(F.values())}if(a.update){let M=new Map((g=E.update)===null||g===void 0?void 0:g.map(F=>[F.id,F]));for(let F of a.update){let A=(m=M.get(F.id))!==null&&m!==void 0?m:{id:F.id};F.newGeometry&&(A.newGeometry=F.newGeometry),F.addOrUpdateProperties&&(A.addOrUpdateProperties=((b=A.addOrUpdateProperties)!==null&&b!==void 0?b:[]).concat(F.addOrUpdateProperties)),F.removeProperties&&(A.removeProperties=((_=A.removeProperties)!==null&&_!==void 0?_:[]).concat(F.removeProperties)),F.removeAllProperties&&(A.removeAllProperties=!0),M.set(F.id,A)}E.update=Array.from(M.values())}return E.remove&&E.add&&(E.remove=E.remove.filter(M=>E.add.findIndex(F=>F.id===M)===-1)),E},n.a1=jd,n.a2=Gl,n.a3=25,n.a4=Iy,n.a5=h=>{let a=window.document.createElement("video");return a.muted=!0,new Promise(c=>{a.onloadstart=()=>{c(a)};for(let g of h){let m=window.document.createElement("source");Me(g)||(a.crossOrigin="Anonymous"),m.src=g,a.appendChild(m)}})},n.a6=$e,n.a7=function(){return bo++},n.a8=Z,n.a9=bh,n.aA=function(h){let a=1/0,c=1/0,g=-1/0,m=-1/0;for(let b of h)a=Math.min(a,b.x),c=Math.min(c,b.y),g=Math.max(g,b.x),m=Math.max(m,b.y);return[a,c,g,m]},n.aB=cs,n.aC=Fi,n.aD=function(h,a,c,g,m=!1){if(!c[0]&&!c[1])return[0,0];let b=m?g==="map"?-h.bearingInRadians:0:g==="viewport"?h.bearingInRadians:0;if(b){let _=Math.sin(b),E=Math.cos(b);c=[c[0]*E-c[1]*_,c[0]*_+c[1]*E]}return[m?c[0]:Fi(a,c[0],h.zoom),m?c[1]:Fi(a,c[1],h.zoom)]},n.aF=Ry,n.aG=Ay,n.aH=Sy,n.aI=Ly,n.aJ=Li,n.aK=hf,n.aL=Te,n.aM=$t,n.aN=ti,n.aO=ro,n.aP=Mn,n.aQ=Nx,n.aR=Oe,n.aS=Ae,n.aT=function(h){var a=new X(3);return a[0]=h[0],a[1]=h[1],a[2]=h[2],a},n.aU=function(h,a,c){return h[0]=a[0]-c[0],h[1]=a[1]-c[1],h[2]=a[2]-c[2],h},n.aV=function(h,a){var c=a[0],g=a[1],m=a[2],b=c*c+g*g+m*m;return b>0&&(b=1/Math.sqrt(b)),h[0]=a[0]*b,h[1]=a[1]*b,h[2]=a[2]*b,h},n.aW=Ge,n.aX=function(h,a){return h[0]*a[0]+h[1]*a[1]+h[2]*a[2]},n.aY=function(h,a,c){return h[0]=a[0]*c[0],h[1]=a[1]*c[1],h[2]=a[2]*c[2],h[3]=a[3]*c[3],h},n.aZ=fe,n.a_=function(h,a,c){let g=a[0]*c[0]+a[1]*c[1]+a[2]*c[2];return g===0?null:(-(h[0]*c[0]+h[1]*c[1]+h[2]*c[2])-c[3])/g},n.aa=Mr,n.ab=Vl,n.ac=jx,n.ad=function(h){let a={};if(h.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,g,m,b)=>{let _=m||b;return a[g]=!_||_.toLowerCase(),""}),a["max-age"]){let c=parseInt(a["max-age"],10);isNaN(c)?delete a["max-age"]:a["max-age"]=c}return a},n.ae=gr,n.af=function(h){return Math.pow(2,h)},n.ag=ae,n.ah=fi,n.ai=85.051129,n.aj=Hx,n.ak=function(h){return Math.log(h)/Math.LN2},n.al=function(h){var a=h[0],c=h[1];return a*a+c*c},n.am=function(h,a){let c=[];for(let g in h)g in a||c.push(g);return c},n.an=function(h,a){let c=0,g=0;if(h.kind==="constant")g=h.layoutSize;else if(h.kind!=="source"){let{interpolationType:m,minZoom:b,maxZoom:_}=h,E=m?fi(ms.interpolationFactor(m,a,b,_),0,1):0;h.kind==="camera"?g=$o.number(h.minSize,h.maxSize,E):c=E}return{uSizeT:c,uSize:g}},n.ap=function(h,{uSize:a,uSizeT:c},{lowerSize:g,upperSize:m}){return h.kind==="source"?g/Br:h.kind==="composite"?$o.number(g/Br,m/Br,c):a},n.aq=function(h,a){var c=a[0],g=a[1],m=a[2],b=a[3],_=a[4],E=a[5],M=a[6],F=a[7],A=a[8],z=a[9],N=a[10],U=a[11],j=a[12],K=a[13],J=a[14],se=a[15],Ce=c*E-g*_,ce=c*M-m*_,pe=c*F-b*_,Pe=g*M-m*E,Ie=g*F-b*E,Ne=m*F-b*M,et=A*K-z*j,qe=A*J-N*j,Qe=A*se-U*j,gt=z*J-N*K,Ye=z*se-U*K,Je=N*se-U*J,ze=Ce*Je-ce*Ye+pe*gt+Pe*Qe-Ie*qe+Ne*et;return ze?(h[0]=(E*Je-M*Ye+F*gt)*(ze=1/ze),h[1]=(m*Ye-g*Je-b*gt)*ze,h[2]=(K*Ne-J*Ie+se*Pe)*ze,h[3]=(N*Ie-z*Ne-U*Pe)*ze,h[4]=(M*Qe-_*Je-F*qe)*ze,h[5]=(c*Je-m*Qe+b*qe)*ze,h[6]=(J*pe-j*Ne-se*ce)*ze,h[7]=(A*Ne-N*pe+U*ce)*ze,h[8]=(_*Ye-E*Qe+F*et)*ze,h[9]=(g*Qe-c*Ye-b*et)*ze,h[10]=(j*Ie-K*pe+se*Ce)*ze,h[11]=(z*pe-A*Ie-U*Ce)*ze,h[12]=(E*qe-_*gt-M*et)*ze,h[13]=(c*gt-g*qe+m*et)*ze,h[14]=(K*ce-j*Pe-J*Ce)*ze,h[15]=(A*Pe-z*ce+N*Ce)*ze,h):null},n.ar=xt,n.as=function(h){var a=h[0],c=h[1];return Math.sqrt(a*a+c*c)},n.at=function(h){return h[0]=0,h[1]=0,h},n.au=function(h,a,c){return h[0]=a[0]*c,h[1]=a[1]*c,h},n.av=Ey,n.aw=lt,n.ax=function(h,a,c,g){let m=a.y-h.y,b=a.x-h.x,_=g.y-c.y,E=g.x-c.x,M=_*b-E*m;if(M===0)return null;let F=(E*(h.y-c.y)-_*(h.x-c.x))/M;return new l(h.x+F*b,h.y+F*m)},n.ay=Zx,n.az=zb,n.b=No,n.b$=class extends u{},n.b0=function(h,a,c){return h[0]=a[0]*c,h[1]=a[1]*c,h[2]=a[2]*c,h[3]=a[3]*c,h},n.b1=function(h,a){return h[0]*a[0]+h[1]*a[1]+h[2]*a[2]+h[3]},n.b2=Wx,n.b3=xh,n.b4=function(h,a,c,g,m){var b=1/Math.tan(a/2);if(h[0]=b/c,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=b,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=-1,h[12]=0,h[13]=0,h[15]=0,m!=null&&m!==1/0){var _=1/(g-m);h[10]=(m+g)*_,h[14]=2*m*g*_}else h[10]=-1,h[14]=-2*g;return h},n.b5=function(h){var a=new X(16);return a[0]=h[0],a[1]=h[1],a[2]=h[2],a[3]=h[3],a[4]=h[4],a[5]=h[5],a[6]=h[6],a[7]=h[7],a[8]=h[8],a[9]=h[9],a[10]=h[10],a[11]=h[11],a[12]=h[12],a[13]=h[13],a[14]=h[14],a[15]=h[15],a},n.b6=function(h,a,c){var g=Math.sin(c),m=Math.cos(c),b=a[0],_=a[1],E=a[2],M=a[3],F=a[4],A=a[5],z=a[6],N=a[7];return a!==h&&(h[8]=a[8],h[9]=a[9],h[10]=a[10],h[11]=a[11],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]),h[0]=b*m+F*g,h[1]=_*m+A*g,h[2]=E*m+z*g,h[3]=M*m+N*g,h[4]=F*m-b*g,h[5]=A*m-_*g,h[6]=z*m-E*g,h[7]=N*m-M*g,h},n.b7=function(h,a,c){var g=Math.sin(c),m=Math.cos(c),b=a[4],_=a[5],E=a[6],M=a[7],F=a[8],A=a[9],z=a[10],N=a[11];return a!==h&&(h[0]=a[0],h[1]=a[1],h[2]=a[2],h[3]=a[3],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]),h[4]=b*m+F*g,h[5]=_*m+A*g,h[6]=E*m+z*g,h[7]=M*m+N*g,h[8]=F*m-b*g,h[9]=A*m-_*g,h[10]=z*m-E*g,h[11]=N*m-M*g,h},n.b8=function(){let h=new Float32Array(16);return ae(h),h},n.b9=function(){let h=new Float64Array(16);return ae(h),h},n.bA=function(h,a){let c=jt(h,360),g=jt(a,360),m=g-c,b=g>c?m-360:m+360;return Math.abs(m)<Math.abs(b)?m:b},n.bB=function(h){return h[0]=0,h[1]=0,h[2]=0,h},n.bC=function(h,a,c,g){let m=Math.sqrt(h*h+a*a),b=Math.sqrt(c*c+g*g);h/=m,a/=m,c/=b,g/=b;let _=Math.acos(h*c+a*g);return-a*c+h*g>0?_:-_},n.bD=function(h,a){let c=jt(h,2*Math.PI),g=jt(a,2*Math.PI);return Math.min(Math.abs(c-g),Math.abs(c-g+2*Math.PI),Math.abs(c-g-2*Math.PI))},n.bE=function(){let h={},a=xe.$version;for(let c in xe.$root){let g=xe.$root[c];if(g.required){let m=null;m=c==="version"?a:g.type==="array"?[]:{},m!=null&&(h[c]=m)}}return h},n.bF=wd,n.bG=de,n.bH=function h(a,c){if(Array.isArray(a)){if(!Array.isArray(c)||a.length!==c.length)return!1;for(let g=0;g<a.length;g++)if(!h(a[g],c[g]))return!1;return!0}if(typeof a=="object"&&a!==null&&c!==null){if(typeof c!="object"||Object.keys(a).length!==Object.keys(c).length)return!1;for(let g in a)if(!h(a[g],c[g]))return!1;return!0}return a===c},n.bI=function(h){h=h.slice();let a=Object.create(null);for(let c=0;c<h.length;c++)a[h[c].id]=h[c];for(let c=0;c<h.length;c++)"ref"in h[c]&&(h[c]=zt(h[c],a[h[c].ref]));return h},n.bJ=function(h,a){if(h.type==="custom")return new z3(h,a);switch(h.type){case"background":return new A3(h,a);case"circle":return new wD(h,a);case"color-relief":return new RD(h,a);case"fill":return new HD(h,a);case"fill-extrusion":return new YD(h,a);case"heatmap":return new bD(h,a);case"hillshade":return new _D(h,a);case"line":return new o3(h,a);case"raster":return new O3(h,a);case"symbol":return new ff(h,a)}},n.bK=Xs,n.bL=function(h,a){if(!h)return[{command:"setStyle",args:[a]}];let c=[];try{if(!ft(h.version,a.version))return[{command:"setStyle",args:[a]}];ft(h.center,a.center)||c.push({command:"setCenter",args:[a.center]}),ft(h.state,a.state)||c.push({command:"setGlobalState",args:[a.state]}),ft(h.centerAltitude,a.centerAltitude)||c.push({command:"setCenterAltitude",args:[a.centerAltitude]}),ft(h.zoom,a.zoom)||c.push({command:"setZoom",args:[a.zoom]}),ft(h.bearing,a.bearing)||c.push({command:"setBearing",args:[a.bearing]}),ft(h.pitch,a.pitch)||c.push({command:"setPitch",args:[a.pitch]}),ft(h.roll,a.roll)||c.push({command:"setRoll",args:[a.roll]}),ft(h.sprite,a.sprite)||c.push({command:"setSprite",args:[a.sprite]}),ft(h.glyphs,a.glyphs)||c.push({command:"setGlyphs",args:[a.glyphs]}),ft(h.transition,a.transition)||c.push({command:"setTransition",args:[a.transition]}),ft(h.light,a.light)||c.push({command:"setLight",args:[a.light]}),ft(h.terrain,a.terrain)||c.push({command:"setTerrain",args:[a.terrain]}),ft(h.sky,a.sky)||c.push({command:"setSky",args:[a.sky]}),ft(h.projection,a.projection)||c.push({command:"setProjection",args:[a.projection]});let g={},m=[];(function(_,E,M,F){let A;for(A in E=E||{},_=_||{})Object.prototype.hasOwnProperty.call(_,A)&&(Object.prototype.hasOwnProperty.call(E,A)||Ji(A,M,F));for(A in E)Object.prototype.hasOwnProperty.call(E,A)&&(Object.prototype.hasOwnProperty.call(_,A)?ft(_[A],E[A])||(_[A].type==="geojson"&&E[A].type==="geojson"&&Hi(_,E,A)?Tt(M,{command:"setGeoJSONSourceData",args:[A,E[A].data]}):es(A,E,M,F)):ci(A,E,M))})(h.sources,a.sources,m,g);let b=[];h.layers&&h.layers.forEach(_=>{"source"in _&&g[_.source]?c.push({command:"removeLayer",args:[_.id]}):b.push(_)}),c=c.concat(m),function(_,E,M){E=E||[];let F=(_=_||[]).map(Wt),A=E.map(Wt),z=_.reduce(qi,{}),N=E.reduce(qi,{}),U=F.slice(),j=Object.create(null),K,J,se,Ce,ce;for(let pe=0,Pe=0;pe<F.length;pe++)K=F[pe],Object.prototype.hasOwnProperty.call(N,K)?Pe++:(Tt(M,{command:"removeLayer",args:[K]}),U.splice(U.indexOf(K,Pe),1));for(let pe=0,Pe=0;pe<A.length;pe++)K=A[A.length-1-pe],U[U.length-1-pe]!==K&&(Object.prototype.hasOwnProperty.call(z,K)?(Tt(M,{command:"removeLayer",args:[K]}),U.splice(U.lastIndexOf(K,U.length-Pe),1)):Pe++,Ce=U[U.length-pe],Tt(M,{command:"addLayer",args:[N[K],Ce]}),U.splice(U.length-pe,0,K),j[K]=!0);for(let pe=0;pe<A.length;pe++)if(K=A[pe],J=z[K],se=N[K],!j[K]&&!ft(J,se))if(ft(J.source,se.source)&&ft(J["source-layer"],se["source-layer"])&&ft(J.type,se.type)){for(ce in Bt(J.layout,se.layout,M,K,null,"setLayoutProperty"),Bt(J.paint,se.paint,M,K,null,"setPaintProperty"),ft(J.filter,se.filter)||Tt(M,{command:"setFilter",args:[K,se.filter]}),ft(J.minzoom,se.minzoom)&&ft(J.maxzoom,se.maxzoom)||Tt(M,{command:"setLayerZoomRange",args:[K,se.minzoom,se.maxzoom]}),J)Object.prototype.hasOwnProperty.call(J,ce)&&ce!=="layout"&&ce!=="paint"&&ce!=="filter"&&ce!=="metadata"&&ce!=="minzoom"&&ce!=="maxzoom"&&(ce.indexOf("paint.")===0?Bt(J[ce],se[ce],M,K,ce.slice(6),"setPaintProperty"):ft(J[ce],se[ce])||Tt(M,{command:"setLayerProperty",args:[K,ce,se[ce]]}));for(ce in se)Object.prototype.hasOwnProperty.call(se,ce)&&!Object.prototype.hasOwnProperty.call(J,ce)&&ce!=="layout"&&ce!=="paint"&&ce!=="filter"&&ce!=="metadata"&&ce!=="minzoom"&&ce!=="maxzoom"&&(ce.indexOf("paint.")===0?Bt(J[ce],se[ce],M,K,ce.slice(6),"setPaintProperty"):ft(J[ce],se[ce])||Tt(M,{command:"setLayerProperty",args:[K,ce,se[ce]]}))}else Tt(M,{command:"removeLayer",args:[K]}),Ce=U[U.lastIndexOf(K)+1],Tt(M,{command:"addLayer",args:[se,Ce]})}(b,a.layers,c)}catch(g){console.warn("Unable to compute style diff:",g),c=[{command:"setStyle",args:[a]}]}return c},n.bM=function(h){let a=[],c=h.id;return c===void 0&&a.push({message:`layers.${c}: missing required property "id"`}),h.render===void 0&&a.push({message:`layers.${c}: missing required method "render"`}),h.renderingMode&&h.renderingMode!=="2d"&&h.renderingMode!=="3d"&&a.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),a},n.bN=na,n.bO=ra,n.bP=class extends ui{constructor(h,a){super(h,a),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}},n.bQ=is,n.bR=class extends ui{constructor(h,a){super(h,a),this.current=sy}set(h){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let a=1;a<16;a++)if(h[a]!==this.current[a]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}},n.bS=eo,n.bT=class extends ui{constructor(h,a){super(h,a),this.current=[0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2]))}},n.bU=class extends ui{constructor(h,a){super(h,a),this.current=[0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1]))}},n.bV=Q,n.bW=function(h,a){var c=Math.sin(a),g=Math.cos(a);return h[0]=g,h[1]=c,h[2]=0,h[3]=-c,h[4]=g,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},n.bX=function(h,a,c){var g=a[0],m=a[1],b=a[2];return h[0]=g*c[0]+m*c[3]+b*c[6],h[1]=g*c[1]+m*c[4]+b*c[7],h[2]=g*c[2]+m*c[5]+b*c[8],h},n.bY=function(h,a,c,g,m,b,_){var E=1/(a-c),M=1/(g-m),F=1/(b-_);return h[0]=-2*E,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*M,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*F,h[11]=0,h[12]=(a+c)*E,h[13]=(m+g)*M,h[14]=(_+b)*F,h[15]=1,h},n.bZ=class extends ui{constructor(h,a){super(h,a),this.current=new Array}set(h){if(h!=this.current){this.current=h;let a=new Float32Array(4*h.length);for(let c=0;c<h.length;c++)a[4*c]=h[c].r,a[4*c+1]=h[c].g,a[4*c+2]=h[c].b,a[4*c+3]=h[c].a;this.gl.uniform4fv(this.location,a)}}},n.b_=class extends ui{constructor(h,a){super(h,a),this.current=new Array}set(h){if(h!=this.current){this.current=h;let a=new Float32Array(h);this.gl.uniform1fv(this.location,a)}}},n.ba=function(){return new Float64Array(16)},n.bb=function(h,a,c){let g=new Float64Array(4);return Gt(g,h,a-90,c),g},n.bc=function(h,a,c,g){var m,b,_,E,M,F=a[0],A=a[1],z=a[2],N=a[3],U=c[0],j=c[1],K=c[2],J=c[3];return(b=F*U+A*j+z*K+N*J)<0&&(b=-b,U=-U,j=-j,K=-K,J=-J),1-b>G?(m=Math.acos(b),_=Math.sin(m),E=Math.sin((1-g)*m)/_,M=Math.sin(g*m)/_):(E=1-g,M=g),h[0]=E*F+M*U,h[1]=E*A+M*j,h[2]=E*z+M*K,h[3]=E*N+M*J,h},n.bd=function(h){let a=new Float64Array(9);var c,g,m,b,_,E,M,F,A,z,N,U,j,K,J,se,Ce,ce;z=(m=(g=h)[0])*(M=m+m),N=(b=g[1])*M,j=(_=g[2])*M,K=_*(F=b+b),se=(E=g[3])*M,Ce=E*F,ce=E*(A=_+_),(c=a)[0]=1-(U=b*F)-(J=_*A),c[3]=N-ce,c[6]=j+Ce,c[1]=N+ce,c[4]=1-z-J,c[7]=K-se,c[2]=j-Ce,c[5]=K+se,c[8]=1-z-U;let pe=Mn(-Math.asin(fi(a[2],-1,1))),Pe,Ie;return Math.hypot(a[5],a[8])<.001?(Pe=0,Ie=-Mn(Math.atan2(a[3],a[4]))):(Pe=Mn(a[5]===0&&a[8]===0?0:Math.atan2(a[5],a[8])),Ie=Mn(a[1]===0&&a[0]===0?0:Math.atan2(a[1],a[0]))),{roll:Pe,pitch:pe+90,bearing:Ie}},n.be=function(h,a){return h.roll==a.roll&&h.pitch==a.pitch&&h.bearing==a.bearing},n.bf=Ot,n.bg=Ni,n.bh=vh,n.bi=Vd,n.bj=mh,n.bk=Jt,n.bl=Bi,n.bm=xs,n.bn=function(h,a,c,g,m){return Jt(g,m,fi((h-a)/(c-a),0,1))},n.bo=jt,n.bp=function(){return new Float64Array(3)},n.bq=function(h,a,c,g){return h[0]=a[0]+c[0]*g,h[1]=a[1]+c[1]*g,h[2]=a[2]+c[2]*g,h},n.br=Gt,n.bs=function(h,a,c){var g=c[0],m=c[1],b=c[2],_=c[3],E=a[0],M=a[1],F=a[2],A=m*F-b*M,z=b*E-g*F,N=g*M-m*E;return h[0]=E+_*(A+=A)+m*(N+=N)-b*(z+=z),h[1]=M+_*z+b*A-g*N,h[2]=F+_*N+g*z-m*A,h},n.bt=function(h,a,c){let g=(m=[h[0],h[1],h[2],a[0],a[1],a[2],c[0],c[1],c[2]])[0]*((A=m[8])*(_=m[4])-(E=m[5])*(F=m[7]))+m[1]*(-A*(b=m[3])+E*(M=m[6]))+m[2]*(F*b-_*M);var m,b,_,E,M,F,A;if(g===0)return null;let z=Ge([],[a[0],a[1],a[2]],[c[0],c[1],c[2]]),N=Ge([],[c[0],c[1],c[2]],[h[0],h[1],h[2]]),U=Ge([],[h[0],h[1],h[2]],[a[0],a[1],a[2]]),j=Oe([],z,-h[3]);return Ae(j,j,Oe([],N,-a[3])),Ae(j,j,Oe([],U,-c[3])),Oe(j,j,1/g),j},n.bu=Dy,n.bv=function(){return new Float64Array(4)},n.bw=function(h,a,c,g){var m=[],b=[];return m[0]=a[0]-c[0],m[1]=a[1]-c[1],m[2]=a[2]-c[2],b[0]=m[0]*Math.cos(g)-m[1]*Math.sin(g),b[1]=m[0]*Math.sin(g)+m[1]*Math.cos(g),b[2]=m[2],h[0]=b[0]+c[0],h[1]=b[1]+c[1],h[2]=b[2]+c[2],h},n.bx=function(h,a,c,g){var m=[],b=[];return m[0]=a[0]-c[0],m[1]=a[1]-c[1],m[2]=a[2]-c[2],b[0]=m[0],b[1]=m[1]*Math.cos(g)-m[2]*Math.sin(g),b[2]=m[1]*Math.sin(g)+m[2]*Math.cos(g),h[0]=b[0]+c[0],h[1]=b[1]+c[1],h[2]=b[2]+c[2],h},n.by=function(h,a,c,g){var m=[],b=[];return m[0]=a[0]-c[0],m[1]=a[1]-c[1],m[2]=a[2]-c[2],b[0]=m[2]*Math.sin(g)+m[0]*Math.cos(g),b[1]=m[1],b[2]=m[2]*Math.cos(g)-m[0]*Math.sin(g),h[0]=b[0]+c[0],h[1]=b[1]+c[1],h[2]=b[2]+c[2],h},n.bz=function(h,a,c){var g=Math.sin(c),m=Math.cos(c),b=a[0],_=a[1],E=a[2],M=a[3],F=a[8],A=a[9],z=a[10],N=a[11];return a!==h&&(h[4]=a[4],h[5]=a[5],h[6]=a[6],h[7]=a[7],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]),h[0]=b*m-F*g,h[1]=_*m-A*g,h[2]=E*m-z*g,h[3]=M*m-N*g,h[8]=b*g+F*m,h[9]=_*g+A*m,h[10]=E*g+z*m,h[11]=M*g+N*m,h},n.c=ye,n.c0=l3,n.c1=class extends v{},n.c2=hy,n.c3=function(h){return h<=1?1:Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))},n.c4=qb,n.c5=function(h,a,c){var g=a[0],m=a[1],b=a[2],_=c[3]*g+c[7]*m+c[11]*b+c[15];return h[0]=(c[0]*g+c[4]*m+c[8]*b+c[12])/(_=_||1),h[1]=(c[1]*g+c[5]*m+c[9]*b+c[13])/_,h[2]=(c[2]*g+c[6]*m+c[10]*b+c[14])/_,h},n.c6=class extends Or{},n.c7=class extends H{},n.c8=function(h,a){return h[0]===a[0]&&h[1]===a[1]&&h[2]===a[2]&&h[3]===a[3]&&h[4]===a[4]&&h[5]===a[5]&&h[6]===a[6]&&h[7]===a[7]&&h[8]===a[8]&&h[9]===a[9]&&h[10]===a[10]&&h[11]===a[11]&&h[12]===a[12]&&h[13]===a[13]&&h[14]===a[14]&&h[15]===a[15]},n.c9=function(h,a){var c=h[0],g=h[1],m=h[2],b=h[3],_=h[4],E=h[5],M=h[6],F=h[7],A=h[8],z=h[9],N=h[10],U=h[11],j=h[12],K=h[13],J=h[14],se=h[15],Ce=a[0],ce=a[1],pe=a[2],Pe=a[3],Ie=a[4],Ne=a[5],et=a[6],qe=a[7],Qe=a[8],gt=a[9],Ye=a[10],Je=a[11],ze=a[12],wt=a[13],_t=a[14],vt=a[15];return Math.abs(c-Ce)<=G*Math.max(1,Math.abs(c),Math.abs(Ce))&&Math.abs(g-ce)<=G*Math.max(1,Math.abs(g),Math.abs(ce))&&Math.abs(m-pe)<=G*Math.max(1,Math.abs(m),Math.abs(pe))&&Math.abs(b-Pe)<=G*Math.max(1,Math.abs(b),Math.abs(Pe))&&Math.abs(_-Ie)<=G*Math.max(1,Math.abs(_),Math.abs(Ie))&&Math.abs(E-Ne)<=G*Math.max(1,Math.abs(E),Math.abs(Ne))&&Math.abs(M-et)<=G*Math.max(1,Math.abs(M),Math.abs(et))&&Math.abs(F-qe)<=G*Math.max(1,Math.abs(F),Math.abs(qe))&&Math.abs(A-Qe)<=G*Math.max(1,Math.abs(A),Math.abs(Qe))&&Math.abs(z-gt)<=G*Math.max(1,Math.abs(z),Math.abs(gt))&&Math.abs(N-Ye)<=G*Math.max(1,Math.abs(N),Math.abs(Ye))&&Math.abs(U-Je)<=G*Math.max(1,Math.abs(U),Math.abs(Je))&&Math.abs(j-ze)<=G*Math.max(1,Math.abs(j),Math.abs(ze))&&Math.abs(K-wt)<=G*Math.max(1,Math.abs(K),Math.abs(wt))&&Math.abs(J-_t)<=G*Math.max(1,Math.abs(J),Math.abs(_t))&&Math.abs(se-vt)<=G*Math.max(1,Math.abs(se),Math.abs(vt))},n.cA=function(h,a){$.REGISTERED_PROTOCOLS[h]=a},n.cB=function(h){delete $.REGISTERED_PROTOCOLS[h]},n.cC=function(h,a){let c={};for(let m=0;m<h.length;m++){let b=a&&a[h[m].id]||Hg(h[m]);a&&(a[h[m].id]=b);let _=c[b];_||(_=c[b]=[]),_.push(h[m])}let g=[];for(let m in c)g.push(c[m]);return g},n.cD=rt,n.cE=Ux,n.cF=$x,n.cG=xx,n.cH=function(h){h.bucket.createArrays(),h.bucket.tilePixelRatio=Ct/(512*h.bucket.overscaling),h.bucket.compareText={},h.bucket.iconsNeedLinear=!1;let a=h.bucket.layers[0],c=a.layout,g=a._unevaluatedLayout._values,m={layoutIconSize:g["icon-size"].possiblyEvaluate(new ei(h.bucket.zoom+1),h.canonical),layoutTextSize:g["text-size"].possiblyEvaluate(new ei(h.bucket.zoom+1),h.canonical),textMaxSize:g["text-size"].possiblyEvaluate(new ei(18))};if(h.bucket.textSizeData.kind==="composite"){let{minZoom:F,maxZoom:A}=h.bucket.textSizeData;m.compositeTextSizes=[g["text-size"].possiblyEvaluate(new ei(F),h.canonical),g["text-size"].possiblyEvaluate(new ei(A),h.canonical)]}if(h.bucket.iconSizeData.kind==="composite"){let{minZoom:F,maxZoom:A}=h.bucket.iconSizeData;m.compositeIconSizes=[g["icon-size"].possiblyEvaluate(new ei(F),h.canonical),g["icon-size"].possiblyEvaluate(new ei(A),h.canonical)]}let b=c.get("text-line-height")*cs,_=c.get("text-rotation-alignment")!=="viewport"&&c.get("symbol-placement")!=="point",E=c.get("text-keep-upright"),M=c.get("text-size");for(let F of h.bucket.features){let A=c.get("text-font").evaluate(F,{},h.canonical).join(","),z=M.evaluate(F,{},h.canonical),N=m.layoutTextSize.evaluate(F,{},h.canonical),U=m.layoutIconSize.evaluate(F,{},h.canonical),j={horizontal:{},vertical:void 0},K=F.text,J,se=[0,0];if(K){let pe=K.toString(),Pe=c.get("text-letter-spacing").evaluate(F,{},h.canonical)*cs,Ie=Kg(pe)?Pe:0,Ne=c.get("text-anchor").evaluate(F,{},h.canonical),et=s_(a,F,h.canonical);if(!et){let Ye=c.get("text-radial-offset").evaluate(F,{},h.canonical);se=Ye?i_(Ne,[Ye*cs,ky]):c.get("text-offset").evaluate(F,{},h.canonical).map(Je=>Je*cs)}let qe=_?"center":c.get("text-justify").evaluate(F,{},h.canonical),Qe=c.get("symbol-placement")==="point"?c.get("text-max-width").evaluate(F,{},h.canonical)*cs:1/0,gt=()=>{h.bucket.allowVerticalPlacement&&Cd(pe)&&(j.vertical=df(K,h.glyphMap,h.glyphPositions,h.imagePositions,A,Qe,b,Ne,"left",Ie,se,n.ao.vertical,!0,N,z))};if(!_&&et){let Ye=new Set;if(qe==="auto")for(let ze=0;ze<et.values.length;ze+=2)Ye.add(Ay(et.values[ze]));else Ye.add(qe);let Je=!1;for(let ze of Ye)if(!j.horizontal[ze])if(Je)j.horizontal[ze]=j.horizontal[0];else{let wt=df(K,h.glyphMap,h.glyphPositions,h.imagePositions,A,Qe,b,"center",ze,Ie,se,n.ao.horizontal,!1,N,z);wt&&(j.horizontal[ze]=wt,Je=wt.positionedLines.length===1)}gt()}else{qe==="auto"&&(qe=Ay(Ne));let Ye=df(K,h.glyphMap,h.glyphPositions,h.imagePositions,A,Qe,b,Ne,qe,Ie,se,n.ao.horizontal,!1,N,z);Ye&&(j.horizontal[qe]=Ye),gt(),Cd(pe)&&_&&E&&(j.vertical=df(K,h.glyphMap,h.glyphPositions,h.imagePositions,A,Qe,b,Ne,qe,Ie,se,n.ao.vertical,!1,N,z))}}let Ce=!1;if(F.icon&&F.icon.name){let pe=h.imageMap[F.icon.name];pe&&(J=D3(h.imagePositions[F.icon.name],c.get("icon-offset").evaluate(F,{},h.canonical),c.get("icon-anchor").evaluate(F,{},h.canonical)),Ce=!!pe.sdf,h.bucket.sdfIcons===void 0?h.bucket.sdfIcons=Ce:h.bucket.sdfIcons!==Ce&&Vi("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(pe.pixelRatio!==h.bucket.pixelRatio||c.get("icon-rotate").constantOr(1)!==0)&&(h.bucket.iconsNeedLinear=!0))}let ce=n_(j.horizontal)||j.vertical;h.bucket.iconsInText=!!ce&&ce.iconsInText,(ce||J)&&$3(h.bucket,F,j,J,h.imageMap,m,N,U,se,Ce,h.canonical,h.subdivisionGranularity)}h.showCollisionBoxes&&h.bucket.generateCollisionDebugBuffers()},n.cI=wy,n.cJ=my,n.cK=yy,n.cL=lx,n.cM=by,n.cN=class{constructor(h){this._marks={start:[h.url,"start"].join("#"),end:[h.url,"end"].join("#"),measure:h.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let h=performance.getEntriesByName(this._marks.measure);return h.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),h=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),h}},n.cO=function(h,a,c,g,m){return o(this,void 0,void 0,function*(){if(V())try{return yield aa(h,a,c,g,m)}catch{}return function(b,_,E,M,F){let A=b.width,z=b.height;Rn&&En||(Rn=new OffscreenCanvas(A,z),En=Rn.getContext("2d",{willReadFrequently:!0})),Rn.width=A,Rn.height=z,En.drawImage(b,0,0,A,z);let N=En.getImageData(_,E,M,F);return En.clearRect(0,0,A,z),N.data}(h,a,c,g,m)})},n.cP=Xb,n.cQ=d,n.cR=ax,n.cS=yh,n.cT=El,n.cU=function(h,a){let c=new Map;if(h!=null)if(h.type==="Feature")c.set($d(h,a),h);else for(let g of h.features)c.set($d(g,a),g);return c},n.cV=function(h,a){if(h==null)return!0;if(h.type==="Feature")return $d(h,a)!=null;if(h.type==="FeatureCollection"){let c=new Set;for(let g of h.features){let m=$d(g,a);if(m==null||c.has(m))return!1;c.add(m)}return!0}return!1},n.cW=function(h,a,c){var g,m,b,_;if(a.removeAll&&h.clear(),a.remove)for(let E of a.remove)h.delete(E);if(a.add)for(let E of a.add){let M=$d(E,c);M!=null&&h.set(M,E)}if(a.update)for(let E of a.update){let M=h.get(E.id);if(M==null)continue;let F=!E.removeAllProperties&&(((g=E.removeProperties)===null||g===void 0?void 0:g.length)>0||((m=E.addOrUpdateProperties)===null||m===void 0?void 0:m.length)>0);if((E.newGeometry||E.removeAllProperties||F)&&(M=Object.assign({},M),h.set(E.id,M),F&&(M.properties=Object.assign({},M.properties))),E.newGeometry&&(M.geometry=E.newGeometry),E.removeAllProperties)M.properties={};else if(((b=E.removeProperties)===null||b===void 0?void 0:b.length)>0)for(let A of E.removeProperties)Object.prototype.hasOwnProperty.call(M.properties,A)&&delete M.properties[A];if(((_=E.addOrUpdateProperties)===null||_===void 0?void 0:_.length)>0)for(let{key:A,value:z}of E.addOrUpdateProperties)M.properties[A]=z}},n.cX=Vn,n.ca=function(h,a){return h[0]=a[0],h[1]=a[1],h[2]=a[2],h[3]=a[3],h[4]=a[4],h[5]=a[5],h[6]=a[6],h[7]=a[7],h[8]=a[8],h[9]=a[9],h[10]=a[10],h[11]=a[11],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15],h},n.cb=h=>h.type==="symbol",n.cc=h=>h.type==="circle",n.cd=h=>h.type==="heatmap",n.ce=h=>h.type==="line",n.cf=h=>h.type==="fill",n.cg=h=>h.type==="fill-extrusion",n.ch=h=>h.type==="hillshade",n.ci=h=>h.type==="color-relief",n.cj=h=>h.type==="raster",n.ck=h=>h.type==="background",n.cl=h=>h.type==="custom",n.cm=Qi,n.cn=function(h,a,c){let g=Yt(a.x-c.x,a.y-c.y),m=Yt(h.x-c.x,h.y-c.y);var b,_;return Mn(Math.atan2(g[0]*m[1]-g[1]*m[0],(b=g)[0]*(_=m)[0]+b[1]*_[1]))},n.co=ji,n.cp=function(h,a){return Dn[a]&&(h instanceof MouseEvent||h instanceof WheelEvent)},n.cq=function(h,a){return Tn[a]&&"touches"in h},n.cr=function(h){return Tn[h]||Dn[h]},n.cs=function(h,a,c){var g=a[0],m=a[1];return h[0]=c[0]*g+c[4]*m+c[12],h[1]=c[1]*g+c[5]*m+c[13],h},n.ct=function(h,a){let{x:c,y:g}=jd.fromLngLat(a);return!(h<0||h>25||g<0||g>=1||c<0||c>=1)},n.cu=function(h,a){return h[0]=a[0],h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=a[1],h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=a[2],h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},n.cv=class extends Lr{},n.cw=Z3,n.cy=function(h){return h.message===la},n.cz=he,n.d=Me,n.e=$i,n.f=h=>o(void 0,void 0,void 0,function*(){if(h.byteLength===0)return createImageBitmap(new ImageData(1,1));let a=new Blob([new Uint8Array(h)],{type:"image/png"});try{return createImageBitmap(a)}catch(c){throw new Error(`Could not load image because of ${c.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),n.g=q,n.h=h=>new Promise((a,c)=>{let g=new Image;g.onload=()=>{a(g),URL.revokeObjectURL(g.src),g.onload=null,window.requestAnimationFrame(()=>{g.src=Go})},g.onerror=()=>c(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let m=new Blob([new Uint8Array(h)],{type:"image/png"});g.src=h.byteLength?URL.createObjectURL(m):Go}),n.i=Ho,n.j=(h,a)=>ve($i(h,{type:"json"}),a),n.k=Ve,n.l=Ue,n.m=ve,n.n=(h,a)=>ve($i(h,{type:"arrayBuffer"}),a),n.o=function(h){return new by(h).readFields(w3,[])},n.p=bx,n.q=Ad,n.r=Ss,n.s=Pn,n.t=Rd,n.u=Ht,n.v=xe,n.w=Vi,n.x=Al,n.y=Zg,n.z=_a}),i("worker",["./shared"],function(n){"use strict";class o{constructor($,q){this.keyCache={},$&&this.replace($,q)}replace($,q){this._layerConfigs={},this._layers={},this.update($,[],q)}update($,q,Y){for(let de of $){this._layerConfigs[de.id]=de;let ve=this._layers[de.id]=n.bJ(de,Y);ve._featureFilter=n.aa(ve.filter,Y),this.keyCache[de.id]&&delete this.keyCache[de.id]}for(let de of q)delete this.keyCache[de],delete this._layerConfigs[de],delete this._layers[de];this.familiesBySource={};let he=n.cC(Object.values(this._layerConfigs),this.keyCache);for(let de of he){let ve=de.map(ct=>this._layers[ct.id]),Me=ve[0];if(Me.visibility==="none")continue;let be=Me.source||"",ke=this.familiesBySource[be];ke||(ke=this.familiesBySource[be]={});let Ue=Me.sourceLayer||"_geojsonTileLayer",Ve=ke[Ue];Ve||(Ve=ke[Ue]=[]),Ve.push(ve)}}}class l{constructor($){let q={},Y=[];for(let Me in $){let be=$[Me],ke=q[Me]={};for(let Ue in be){let Ve=be[+Ue];if(!Ve||Ve.bitmap.width===0||Ve.bitmap.height===0)continue;let ct={x:0,y:0,w:Ve.bitmap.width+2,h:Ve.bitmap.height+2};Y.push(ct),ke[Ue]={rect:ct,metrics:Ve.metrics}}}let{w:he,h:de}=n.p(Y),ve=new n.q({width:he||1,height:de||1});for(let Me in $){let be=$[Me];for(let ke in be){let Ue=be[+ke];if(!Ue||Ue.bitmap.width===0||Ue.bitmap.height===0)continue;let Ve=q[Me][ke].rect;n.q.copy(Ue.bitmap,ve,{x:0,y:0},{x:Ve.x+1,y:Ve.y+1},Ue.bitmap)}}this.image=ve,this.positions=q}}n.cD("GlyphAtlas",l);class d{constructor($){this.tileID=new n.Z($.tileID.overscaledZ,$.tileID.wrap,$.tileID.canonical.z,$.tileID.canonical.x,$.tileID.canonical.y),this.uid=$.uid,this.zoom=$.zoom,this.pixelRatio=$.pixelRatio,this.tileSize=$.tileSize,this.source=$.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=$.showCollisionBoxes,this.collectResourceTiming=!!$.collectResourceTiming,this.returnDependencies=!!$.returnDependencies,this.promoteId=$.promoteId,this.inFlightDependencies=[]}parse($,q,Y,he,de){return n._(this,void 0,void 0,function*(){this.status="parsing",this.data=$,this.collisionBoxArray=new n.a8;let ve=new n.cE(Object.keys($.layers).sort()),Me=new n.cF(this.tileID,this.promoteId);Me.bucketLayerIDs=[];let be={},ke={featureIndex:Me,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Y,subdivisionGranularity:de},Ue=q.familiesBySource[this.source];for(let Bt in Ue){let Wt=$.layers[Bt];if(!Wt)continue;Wt.version===1&&n.w(`Vector tile source "${this.source}" layer "${Bt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let qi=ve.encode(Bt),$e=[];for(let bs=0;bs<Wt.length;bs++){let Ei=Wt.feature(bs),Fn=Me.getId(Ei,Bt);$e.push({feature:Ei,id:Fn,index:bs,sourceLayerIndex:qi})}for(let bs of Ue[Bt]){let Ei=bs[0];Ei.source!==this.source&&n.w(`layer.source = ${Ei.source} does not equal this.source = ${this.source}`),Ei.minzoom&&this.zoom<Math.floor(Ei.minzoom)||Ei.maxzoom&&this.zoom>=Ei.maxzoom||Ei.visibility!=="none"&&(p(bs,this.zoom,Y),(be[Ei.id]=Ei.createBucket({index:Me.bucketLayerIDs.length,layers:bs,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:qi,sourceID:this.source})).populate($e,ke,this.tileID.canonical),Me.bucketLayerIDs.push(bs.map(Fn=>Fn.id)))}}let Ve=n.bN(ke.glyphDependencies,Bt=>Object.keys(Bt).map(Number));this.inFlightDependencies.forEach(Bt=>Bt?.abort()),this.inFlightDependencies=[];let ct=Promise.resolve({});if(Object.keys(Ve).length){let Bt=new AbortController;this.inFlightDependencies.push(Bt),ct=he.sendAsync({type:"GG",data:{stacks:Ve,source:this.source,tileID:this.tileID,type:"glyphs"}},Bt)}let xe=Object.keys(ke.iconDependencies),Rt=Promise.resolve({});if(xe.length){let Bt=new AbortController;this.inFlightDependencies.push(Bt),Rt=he.sendAsync({type:"GI",data:{icons:xe,source:this.source,tileID:this.tileID,type:"icons"}},Bt)}let zt=Object.keys(ke.patternDependencies),ft=Promise.resolve({});if(zt.length){let Bt=new AbortController;this.inFlightDependencies.push(Bt),ft=he.sendAsync({type:"GI",data:{icons:zt,source:this.source,tileID:this.tileID,type:"patterns"}},Bt)}let[Tt,ci,Ji]=yield Promise.all([ct,Rt,ft]),es=new l(Tt),Hi=new n.cG(ci,Ji);for(let Bt in be){let Wt=be[Bt];Wt instanceof n.a9?(p(Wt.layers,this.zoom,Y),n.cH({bucket:Wt,glyphMap:Tt,glyphPositions:es.positions,imageMap:ci,imagePositions:Hi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:ke.subdivisionGranularity})):Wt.hasPattern&&(Wt instanceof n.cI||Wt instanceof n.cJ||Wt instanceof n.cK)&&(p(Wt.layers,this.zoom,Y),Wt.addFeatures(ke,this.tileID.canonical,Hi.patternPositions))}return this.status="done",{buckets:Object.values(be).filter(Bt=>!Bt.isEmpty()),featureIndex:Me,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:es.image,imageAtlas:Hi,glyphMap:this.returnDependencies?Tt:null,iconMap:this.returnDependencies?ci:null,glyphPositions:this.returnDependencies?es.positions:null}})}}function p(ye,$,q){let Y=new n.F($);for(let he of ye)he.recalculate(Y,q)}class y{constructor($,q,Y){this.actor=$,this.layerIndex=q,this.availableImages=Y,this.fetching={},this.loading={},this.loaded={}}loadVectorTile($,q){return n._(this,void 0,void 0,function*(){let Y=yield n.n($.request,q);try{return{vectorTile:new n.cL(new n.cM(Y.data)),rawData:Y.data,cacheControl:Y.cacheControl,expires:Y.expires}}catch(he){let de=new Uint8Array(Y.data),ve=`Unable to parse the tile at ${$.request.url}, `;throw ve+=de[0]===31&&de[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${he.message}`,new Error(ve)}})}loadTile($){return n._(this,void 0,void 0,function*(){let q=$.uid,Y=!!($&&$.request&&$.request.collectResourceTiming)&&new n.cN($.request),he=new d($);this.loading[q]=he;let de=new AbortController;he.abort=de;try{let ve=yield this.loadVectorTile($,de);if(delete this.loading[q],!ve)return null;let Me=ve.rawData,be={};ve.expires&&(be.expires=ve.expires),ve.cacheControl&&(be.cacheControl=ve.cacheControl);let ke={};if(Y){let Ve=Y.finish();Ve&&(ke.resourceTiming=JSON.parse(JSON.stringify(Ve)))}he.vectorTile=ve.vectorTile;let Ue=he.parse(ve.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity);this.loaded[q]=he,this.fetching[q]={rawTileData:Me,cacheControl:be,resourceTiming:ke};try{let Ve=yield Ue;return n.e({rawTileData:Me.slice(0)},Ve,be,ke)}finally{delete this.fetching[q]}}catch(ve){throw delete this.loading[q],he.status="done",this.loaded[q]=he,ve}})}reloadTile($){return n._(this,void 0,void 0,function*(){let q=$.uid;if(!this.loaded||!this.loaded[q])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");let Y=this.loaded[q];if(Y.showCollisionBoxes=$.showCollisionBoxes,Y.status==="parsing"){let he=yield Y.parse(Y.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity),de;if(this.fetching[q]){let{rawTileData:ve,cacheControl:Me,resourceTiming:be}=this.fetching[q];delete this.fetching[q],de=n.e({rawTileData:ve.slice(0)},he,Me,be)}else de=he;return de}if(Y.status==="done"&&Y.vectorTile)return Y.parse(Y.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity)})}abortTile($){return n._(this,void 0,void 0,function*(){let q=this.loading,Y=$.uid;q&&q[Y]&&q[Y].abort&&(q[Y].abort.abort(),delete q[Y])})}removeTile($){return n._(this,void 0,void 0,function*(){this.loaded&&this.loaded[$.uid]&&delete this.loaded[$.uid]})}}class C{constructor(){this.loaded={}}loadTile($){return n._(this,void 0,void 0,function*(){let{uid:q,encoding:Y,rawImageData:he,redFactor:de,greenFactor:ve,blueFactor:Me,baseShift:be}=$,ke=he.width+2,Ue=he.height+2,Ve=n.b(he)?new n.R({width:ke,height:Ue},yield n.cO(he,-1,-1,ke,Ue)):he,ct=new n.cP(q,Ve,Y,de,ve,Me,be);return this.loaded=this.loaded||{},this.loaded[q]=ct,ct})}removeTile($){let q=this.loaded,Y=$.uid;q&&q[Y]&&delete q[Y]}}var S,P,I=function(){if(P)return S;function ye(q,Y){if(q.length!==0){$(q[0],Y);for(var he=1;he<q.length;he++)$(q[he],!Y)}}function $(q,Y){for(var he=0,de=0,ve=0,Me=q.length,be=Me-1;ve<Me;be=ve++){var ke=(q[ve][0]-q[be][0])*(q[be][1]+q[ve][1]),Ue=he+ke;de+=Math.abs(he)>=Math.abs(ke)?he-Ue+ke:ke-Ue+he,he=Ue}he+de>=0!=!!Y&&q.reverse()}return P=1,S=function q(Y,he){var de,ve=Y&&Y.type;if(ve==="FeatureCollection")for(de=0;de<Y.features.length;de++)q(Y.features[de],he);else if(ve==="GeometryCollection")for(de=0;de<Y.geometries.length;de++)q(Y.geometries[de],he);else if(ve==="Feature")q(Y.geometry,he);else if(ve==="Polygon")ye(Y.coordinates,he);else if(ve==="MultiPolygon")for(de=0;de<Y.coordinates.length;de++)ye(Y.coordinates[de],he);return Y}}(),O=n.cQ(I);class V extends n.cS{constructor($,q){super(new n.cM,0,q,[],[]),this.feature=$,this.type=$.type,this.properties=$.tags?$.tags:{},"id"in $&&(typeof $.id=="string"?this.id=parseInt($.id,10):typeof $.id!="number"||isNaN($.id)||(this.id=$.id))}loadGeometry(){let $=[],q=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(let Y of q){let he=[];for(let de of Y)he.push(new n.P(de[0],de[1]));$.push(he)}return $}}class G extends n.cR{constructor($,q){super(new n.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=q?q.version:1,this.extent=q?q.extent:4096,this.length=$.length,this.features=$}feature($){return new V(this.features[$],this.extent)}}function X(ye,$){$.writeVarintField(15,ye.version||1),$.writeStringField(1,ye.name||""),$.writeVarintField(5,ye.extent||4096);let q={keys:[],values:[],keycache:{},valuecache:{}};for(let de=0;de<ye.length;de++)q.feature=ye.feature(de),$.writeMessage(2,Q,q);let Y=q.keys;for(let de of Y)$.writeStringField(3,de);let he=q.values;for(let de of he)$.writeMessage(4,Ae,de)}function Q(ye,$){if(!ye.feature)return;let q=ye.feature;q.id!==void 0&&$.writeVarintField(1,q.id),$.writeMessage(2,ae,ye),$.writeVarintField(3,q.type),$.writeMessage(4,_e,q)}function ae(ye,$){for(let q in ye.feature?.properties){let Y=ye.feature.properties[q],he=ye.keycache[q];if(Y===null)continue;he===void 0&&(ye.keys.push(q),he=ye.keys.length-1,ye.keycache[q]=he),$.writeVarint(he),typeof Y!="string"&&typeof Y!="boolean"&&typeof Y!="number"&&(Y=JSON.stringify(Y));let de=typeof Y+":"+Y,ve=ye.valuecache[de];ve===void 0&&(ye.values.push(Y),ve=ye.values.length-1,ye.valuecache[de]=ve),$.writeVarint(ve)}}function me(ye,$){return($<<3)+(7&ye)}function fe(ye){return ye<<1^ye>>31}function _e(ye,$){let q=ye.loadGeometry(),Y=ye.type,he=0,de=0;for(let ve of q){let Me=1;Y===1&&(Me=ve.length),$.writeVarint(me(1,Me));let be=Y===3?ve.length-1:ve.length;for(let ke=0;ke<be;ke++){ke===1&&Y!==1&&$.writeVarint(me(2,be-1));let Ue=ve[ke].x-he,Ve=ve[ke].y-de;$.writeVarint(fe(Ue)),$.writeVarint(fe(Ve)),he+=Ue,de+=Ve}ye.type===3&&$.writeVarint(me(7,1))}}function Ae(ye,$){let q=typeof ye;q==="string"?$.writeStringField(1,ye):q==="boolean"?$.writeBooleanField(7,ye):q==="number"&&(ye%1!=0?$.writeDoubleField(3,ye):ye<0?$.writeSVarintField(6,ye):$.writeVarintField(5,ye))}let Oe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ye=>ye},Ge=Math.fround||(it=new Float32Array(1),ye=>(it[0]=+ye,it[0]));var it;class Xe{constructor($){this.options=Object.assign(Object.create(Oe),$),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load($){let{log:q,minZoom:Y,maxZoom:he}=this.options;q&&console.time("total time");let de=`prepare ${$.length} points`;q&&console.time(de),this.points=$;let ve=[];for(let be=0;be<$.length;be++){let ke=$[be];if(!ke.geometry)continue;let[Ue,Ve]=ke.geometry.coordinates,ct=Ge(Gt(Ue)),xe=Ge(xt(Ve));ve.push(ct,xe,1/0,be,-1,1),this.options.reduce&&ve.push(0)}let Me=this.trees[he+1]=this._createTree(ve);q&&console.timeEnd(de);for(let be=he;be>=Y;be--){let ke=+Date.now();Me=this.trees[be]=this._createTree(this._cluster(Me,be)),q&&console.log("z%d: %d clusters in %dms",be,Me.numItems,+Date.now()-ke)}return q&&console.timeEnd("total time"),this}getClusters($,q){let Y=(($[0]+180)%360+360)%360-180,he=Math.max(-90,Math.min(90,$[1])),de=$[2]===180?180:(($[2]+180)%360+360)%360-180,ve=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)Y=-180,de=180;else if(Y>de){let Ve=this.getClusters([Y,he,180,ve],q),ct=this.getClusters([-180,he,de,ve],q);return Ve.concat(ct)}let Me=this.trees[this._limitZoom(q)],be=Me.range(Gt(Y),xt(ve),Gt(de),xt(he)),ke=Me.data,Ue=[];for(let Ve of be){let ct=this.stride*Ve;Ue.push(ke[ct+5]>1?lt(ke,ct,this.clusterProps):this.points[ke[ct+3]])}return Ue}getChildren($){let q=this._getOriginId($),Y=this._getOriginZoom($),he="No cluster with the specified id.",de=this.trees[Y];if(!de)throw new Error(he);let ve=de.data;if(q*this.stride>=ve.length)throw new Error(he);let Me=this.options.radius/(this.options.extent*Math.pow(2,Y-1)),be=de.within(ve[q*this.stride],ve[q*this.stride+1],Me),ke=[];for(let Ue of be){let Ve=Ue*this.stride;ve[Ve+4]===$&&ke.push(ve[Ve+5]>1?lt(ve,Ve,this.clusterProps):this.points[ve[Ve+3]])}if(ke.length===0)throw new Error(he);return ke}getLeaves($,q,Y){let he=[];return this._appendLeaves(he,$,q=q||10,Y=Y||0,0),he}getTile($,q,Y){let he=this.trees[this._limitZoom($)],de=Math.pow(2,$),{extent:ve,radius:Me}=this.options,be=Me/ve,ke=(Y-be)/de,Ue=(Y+1+be)/de,Ve={features:[]};return this._addTileFeatures(he.range((q-be)/de,ke,(q+1+be)/de,Ue),he.data,q,Y,de,Ve),q===0&&this._addTileFeatures(he.range(1-be/de,ke,1,Ue),he.data,de,Y,de,Ve),q===de-1&&this._addTileFeatures(he.range(0,ke,be/de,Ue),he.data,-1,Y,de,Ve),Ve.features.length?Ve:null}getClusterExpansionZoom($){let q=this._getOriginZoom($)-1;for(;q<=this.options.maxZoom;){let Y=this.getChildren($);if(q++,Y.length!==1)break;$=Y[0].properties.cluster_id}return q}_appendLeaves($,q,Y,he,de){let ve=this.getChildren(q);for(let Me of ve){let be=Me.properties;if(be&&be.cluster?de+be.point_count<=he?de+=be.point_count:de=this._appendLeaves($,be.cluster_id,Y,he,de):de<he?de++:$.push(Me),$.length===Y)break}return de}_createTree($){let q=new n.aI($.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Y=0;Y<$.length;Y+=this.stride)q.add($[Y],$[Y+1]);return q.finish(),q.data=$,q}_addTileFeatures($,q,Y,he,de,ve){for(let Me of $){let be=Me*this.stride,ke=q[be+5]>1,Ue,Ve,ct;if(ke)Ue=St(q,be,this.clusterProps),Ve=q[be],ct=q[be+1];else{let zt=this.points[q[be+3]];Ue=zt.properties;let[ft,Tt]=zt.geometry.coordinates;Ve=Gt(ft),ct=xt(Tt)}let xe={type:1,geometry:[[Math.round(this.options.extent*(Ve*de-Y)),Math.round(this.options.extent*(ct*de-he))]],tags:Ue},Rt;Rt=ke||this.options.generateId?q[be+3]:this.points[q[be+3]].id,Rt!==void 0&&(xe.id=Rt),ve.features.push(xe)}}_limitZoom($){return Math.max(this.options.minZoom,Math.min(Math.floor(+$),this.options.maxZoom+1))}_cluster($,q){let{radius:Y,extent:he,reduce:de,minPoints:ve}=this.options,Me=Y/(he*Math.pow(2,q)),be=$.data,ke=[],Ue=this.stride;for(let Ve=0;Ve<be.length;Ve+=Ue){if(be[Ve+2]<=q)continue;be[Ve+2]=q;let ct=be[Ve],xe=be[Ve+1],Rt=$.within(be[Ve],be[Ve+1],Me),zt=be[Ve+5],ft=zt;for(let Tt of Rt){let ci=Tt*Ue;be[ci+2]>q&&(ft+=be[ci+5])}if(ft>zt&&ft>=ve){let Tt,ci=ct*zt,Ji=xe*zt,es=-1,Hi=(Ve/Ue<<5)+(q+1)+this.points.length;for(let Bt of Rt){let Wt=Bt*Ue;if(be[Wt+2]<=q)continue;be[Wt+2]=q;let qi=be[Wt+5];ci+=be[Wt]*qi,Ji+=be[Wt+1]*qi,be[Wt+4]=Hi,de&&(Tt||(Tt=this._map(be,Ve,!0),es=this.clusterProps.length,this.clusterProps.push(Tt)),de(Tt,this._map(be,Wt)))}be[Ve+4]=Hi,ke.push(ci/ft,Ji/ft,1/0,Hi,-1,ft),de&&ke.push(es)}else{for(let Tt=0;Tt<Ue;Tt++)ke.push(be[Ve+Tt]);if(ft>1)for(let Tt of Rt){let ci=Tt*Ue;if(!(be[ci+2]<=q)){be[ci+2]=q;for(let Ji=0;Ji<Ue;Ji++)ke.push(be[ci+Ji])}}}}return ke}_getOriginId($){return $-this.points.length>>5}_getOriginZoom($){return($-this.points.length)%32}_map($,q,Y){if($[q+5]>1){let ve=this.clusterProps[$[q+6]];return Y?Object.assign({},ve):ve}let he=this.points[$[q+3]].properties,de=this.options.map(he);return Y&&de===he?Object.assign({},de):de}}function lt(ye,$,q){return{type:"Feature",id:ye[$+3],properties:St(ye,$,q),geometry:{type:"Point",coordinates:[(Y=ye[$],360*(Y-.5)),Yt(ye[$+1])]}};var Y}function St(ye,$,q){let Y=ye[$+5],he=Y>=1e4?`${Math.round(Y/1e3)}k`:Y>=1e3?Math.round(Y/100)/10+"k":Y,de=ye[$+6],ve=de===-1?{}:Object.assign({},q[de]);return Object.assign(ve,{cluster:!0,cluster_id:ye[$+3],point_count:Y,point_count_abbreviated:he})}function Gt(ye){return ye/360+.5}function xt(ye){let $=Math.sin(ye*Math.PI/180),q=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return q<0?0:q>1?1:q}function Yt(ye){let $=(180-360*ye)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function Ct(ye,$,q,Y){let he=Y,de=$+(q-$>>1),ve,Me=q-$,be=ye[$],ke=ye[$+1],Ue=ye[q],Ve=ye[q+1];for(let ct=$+3;ct<q;ct+=3){let xe=Fi(ye[ct],ye[ct+1],be,ke,Ue,Ve);if(xe>he)ve=ct,he=xe;else if(xe===he){let Rt=Math.abs(ct-de);Rt<Me&&(ve=ct,Me=Rt)}}he>Y&&(ve-$>3&&Ct(ye,$,ve,Y),ye[ve+2]=he,q-ve>3&&Ct(ye,ve,q,Y))}function Fi(ye,$,q,Y,he,de){let ve=he-q,Me=de-Y;if(ve!==0||Me!==0){let be=((ye-q)*ve+($-Y)*Me)/(ve*ve+Me*Me);be>1?(q=he,Y=de):be>0&&(q+=ve*be,Y+=Me*be)}return ve=ye-q,Me=$-Y,ve*ve+Me*Me}function jt(ye,$,q,Y){let he={id:ye??null,type:$,geometry:q,tags:Y,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if($==="Point"||$==="MultiPoint"||$==="LineString")Jt(he,q);else if($==="Polygon")Jt(he,q[0]);else if($==="MultiLineString")for(let de of q)Jt(he,de);else if($==="MultiPolygon")for(let de of q)Jt(he,de[0]);return he}function Jt(ye,$){for(let q=0;q<$.length;q+=3)ye.minX=Math.min(ye.minX,$[q]),ye.minY=Math.min(ye.minY,$[q+1]),ye.maxX=Math.max(ye.maxX,$[q]),ye.maxY=Math.max(ye.maxY,$[q+1])}function Bi(ye,$,q,Y){if(!$.geometry)return;let he=$.geometry.coordinates;if(he&&he.length===0)return;let de=$.geometry.type,ve=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2),Me=[],be=$.id;if(q.promoteId?be=$.properties[q.promoteId]:q.generateId&&(be=Y||0),de==="Point")Qi(he,Me);else if(de==="MultiPoint")for(let ke of he)Qi(ke,Me);else if(de==="LineString")ji(he,Me,ve,!1);else if(de==="MultiLineString"){if(q.lineMetrics){for(let ke of he)Me=[],ji(ke,Me,ve,!1),ye.push(jt(be,"LineString",Me,$.properties));return}fi(he,Me,ve,!1)}else if(de==="Polygon")fi(he,Me,ve,!0);else{if(de!=="MultiPolygon"){if(de==="GeometryCollection"){for(let ke of $.geometry.geometries)Bi(ye,{id:be,geometry:ke,properties:$.properties},q,Y);return}throw new Error("Input data is not a valid GeoJSON object.")}for(let ke of he){let Ue=[];fi(ke,Ue,ve,!0),Me.push(Ue)}}ye.push(jt(be,de,Me,$.properties))}function Qi(ye,$){$.push(ro(ye[0]),$i(ye[1]),0)}function ji(ye,$,q,Y){let he,de,ve=0;for(let be=0;be<ye.length;be++){let ke=ro(ye[be][0]),Ue=$i(ye[be][1]);$.push(ke,Ue,0),be>0&&(ve+=Y?(he*Ue-ke*de)/2:Math.sqrt(Math.pow(ke-he,2)+Math.pow(Ue-de,2))),he=ke,de=Ue}let Me=$.length-3;$[2]=1,Ct($,0,Me,q),$[Me+2]=1,$.size=Math.abs(ve),$.start=0,$.end=$.size}function fi(ye,$,q,Y){for(let he=0;he<ye.length;he++){let de=[];ji(ye[he],de,q,Y),$.push(de)}}function ro(ye){return ye/360+.5}function $i(ye){let $=Math.sin(ye*Math.PI/180),q=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return q<0?0:q>1?1:q}function bo(ye,$,q,Y,he,de,ve,Me){if(Y/=$,de>=(q/=$)&&ve<Y)return ye;if(ve<q||de>=Y)return null;let be=[];for(let ke of ye){let Ue=ke.geometry,Ve=ke.type,ct=he===0?ke.minX:ke.minY,xe=he===0?ke.maxX:ke.maxY;if(ct>=q&&xe<Y){be.push(ke);continue}if(xe<q||ct>=Y)continue;let Rt=[];if(Ve==="Point"||Ve==="MultiPoint")na(Ue,Rt,q,Y,he);else if(Ve==="LineString")ra(Ue,Rt,q,Y,he,!1,Me.lineMetrics);else if(Ve==="MultiLineString")Ii(Ue,Rt,q,Y,he,!1);else if(Ve==="Polygon")Ii(Ue,Rt,q,Y,he,!0);else if(Ve==="MultiPolygon")for(let zt of Ue){let ft=[];Ii(zt,ft,q,Y,he,!0),ft.length&&Rt.push(ft)}if(Rt.length){if(Me.lineMetrics&&Ve==="LineString"){for(let zt of Rt)be.push(jt(ke.id,Ve,zt,ke.tags));continue}Ve!=="LineString"&&Ve!=="MultiLineString"||(Rt.length===1?(Ve="LineString",Rt=Rt[0]):Ve="MultiLineString"),Ve!=="Point"&&Ve!=="MultiPoint"||(Ve=Rt.length===3?"Point":"MultiPoint"),be.push(jt(ke.id,Ve,Rt,ke.tags))}}return be.length?be:null}function na(ye,$,q,Y,he){for(let de=0;de<ye.length;de+=3){let ve=ye[de+he];ve>=q&&ve<=Y&&Vi($,ye[de],ye[de+1],ye[de+2])}}function ra(ye,$,q,Y,he,de,ve){let Me=Xs(ye),be=he===0?xo:Ho,ke,Ue,Ve=ye.start;for(let ft=0;ft<ye.length-3;ft+=3){let Tt=ye[ft],ci=ye[ft+1],Ji=ye[ft+2],es=ye[ft+3],Hi=ye[ft+4],Bt=he===0?Tt:ci,Wt=he===0?es:Hi,qi=!1;ve&&(ke=Math.sqrt(Math.pow(Tt-es,2)+Math.pow(ci-Hi,2))),Bt<q?Wt>q&&(Ue=be(Me,Tt,ci,es,Hi,q),ve&&(Me.start=Ve+ke*Ue)):Bt>Y?Wt<Y&&(Ue=be(Me,Tt,ci,es,Hi,Y),ve&&(Me.start=Ve+ke*Ue)):Vi(Me,Tt,ci,Ji),Wt<q&&Bt>=q&&(Ue=be(Me,Tt,ci,es,Hi,q),qi=!0),Wt>Y&&Bt<=Y&&(Ue=be(Me,Tt,ci,es,Hi,Y),qi=!0),!de&&qi&&(ve&&(Me.end=Ve+ke*Ue),$.push(Me),Me=Xs(ye)),ve&&(Ve+=ke)}let ct=ye.length-3,xe=ye[ct],Rt=ye[ct+1],zt=he===0?xe:Rt;zt>=q&&zt<=Y&&Vi(Me,xe,Rt,ye[ct+2]),ct=Me.length-3,de&&ct>=3&&(Me[ct]!==Me[0]||Me[ct+1]!==Me[1])&&Vi(Me,Me[0],Me[1],Me[2]),Me.length&&$.push(Me)}function Xs(ye){let $=[];return $.size=ye.size,$.start=ye.start,$.end=ye.end,$}function Ii(ye,$,q,Y,he,de){for(let ve of ye)ra(ve,$,q,Y,he,de,!1)}function Vi(ye,$,q,Y){ye.push($,q,Y)}function xo(ye,$,q,Y,he,de){let ve=(de-$)/(Y-$);return Vi(ye,de,q+(he-q)*ve,1),ve}function Ho(ye,$,q,Y,he,de){let ve=(de-q)/(he-q);return Vi(ye,$+(Y-$)*ve,de,1),ve}function pr(ye,$){let q=[];for(let Y=0;Y<ye.length;Y++){let he=ye[Y],de=he.type,ve;if(de==="Point"||de==="MultiPoint"||de==="LineString")ve=No(he.geometry,$);else if(de==="MultiLineString"||de==="Polygon"){ve=[];for(let Me of he.geometry)ve.push(No(Me,$))}else if(de==="MultiPolygon"){ve=[];for(let Me of he.geometry){let be=[];for(let ke of Me)be.push(No(ke,$));ve.push(be)}}q.push(jt(he.id,de,ve,he.tags))}return q}function No(ye,$){let q=[];q.size=ye.size,ye.start!==void 0&&(q.start=ye.start,q.end=ye.end);for(let Y=0;Y<ye.length;Y+=3)q.push(ye[Y]+$,ye[Y+1],ye[Y+2]);return q}function Go(ye,$){if(ye.transformed)return ye;let q=1<<ye.z,Y=ye.x,he=ye.y;for(let de of ye.features){let ve=de.geometry,Me=de.type;if(de.geometry=[],Me===1)for(let be=0;be<ve.length;be+=2)de.geometry.push(aa(ve[be],ve[be+1],$,q,Y,he));else for(let be=0;be<ve.length;be++){let ke=[];for(let Ue=0;Ue<ve[be].length;Ue+=2)ke.push(aa(ve[be][Ue],ve[be][Ue+1],$,q,Y,he));de.geometry.push(ke)}}return ye.transformed=!0,ye}function aa(ye,$,q,Y,he,de){return[Math.round(q*(ye*Y-he)),Math.round(q*($*Y-de))]}function Rn(ye,$,q,Y,he){let de=$===he.maxZoom?0:he.tolerance/((1<<$)*he.extent),ve={features:[],numPoints:0,numSimplified:0,numFeatures:ye.length,source:null,x:q,y:Y,z:$,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(let Me of ye)En(ve,Me,de,he);return ve}function En(ye,$,q,Y){let he=$.geometry,de=$.type,ve=[];if(ye.minX=Math.min(ye.minX,$.minX),ye.minY=Math.min(ye.minY,$.minY),ye.maxX=Math.max(ye.maxX,$.maxX),ye.maxY=Math.max(ye.maxY,$.maxY),de==="Point"||de==="MultiPoint")for(let Me=0;Me<he.length;Me+=3)ve.push(he[Me],he[Me+1]),ye.numPoints++,ye.numSimplified++;else if(de==="LineString")Pn(ve,he,ye,q,!1,!1);else if(de==="MultiLineString"||de==="Polygon")for(let Me=0;Me<he.length;Me++)Pn(ve,he[Me],ye,q,de==="Polygon",Me===0);else if(de==="MultiPolygon")for(let Me=0;Me<he.length;Me++){let be=he[Me];for(let ke=0;ke<be.length;ke++)Pn(ve,be[ke],ye,q,!0,ke===0)}if(ve.length){let Me=$.tags||null;if(de==="LineString"&&Y.lineMetrics){Me={};for(let ke in $.tags)Me[ke]=$.tags[ke];Me.mapbox_clip_start=he.start/he.size,Me.mapbox_clip_end=he.end/he.size}let be={geometry:ve,type:de==="Polygon"||de==="MultiPolygon"?3:de==="LineString"||de==="MultiLineString"?2:1,tags:Me};$.id!==null&&(be.id=$.id),ye.features.push(be)}}function Pn(ye,$,q,Y,he,de){let ve=Y*Y;if(Y>0&&$.size<(he?ve:Y))return void(q.numPoints+=$.length/3);let Me=[];for(let be=0;be<$.length;be+=3)(Y===0||$[be+2]>ve)&&(q.numSimplified++,Me.push($[be],$[be+1])),q.numPoints++;he&&function(be,ke){let Ue=0;for(let Ve=0,ct=be.length,xe=ct-2;Ve<ct;xe=Ve,Ve+=2)Ue+=(be[Ve]-be[xe])*(be[Ve+1]+be[xe+1]);if(Ue>0===ke)for(let Ve=0,ct=be.length;Ve<ct/2;Ve+=2){let xe=be[Ve],Rt=be[Ve+1];be[Ve]=be[ct-2-Ve],be[Ve+1]=be[ct-1-Ve],be[ct-2-Ve]=xe,be[ct-1-Ve]=Rt}}(Me,de),ye.push(Me)}let gr={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Mn{constructor($,q){let Y=(q=this.options=function(de,ve){for(let Me in ve)de[Me]=ve[Me];return de}(Object.create(gr),q)).debug;if(Y&&console.time("preprocess data"),q.maxZoom<0||q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(q.promoteId&&q.generateId)throw new Error("promoteId and generateId cannot be used together.");let he=function(de,ve){let Me=[];if(de.type==="FeatureCollection")for(let be=0;be<de.features.length;be++)Bi(Me,de.features[be],ve,be);else Bi(Me,de.type==="Feature"?de:{geometry:de},ve);return Me}($,q);this.tiles={},this.tileCoords=[],Y&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",q.indexMaxZoom,q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),he=function(de,ve){let Me=ve.buffer/ve.extent,be=de,ke=bo(de,1,-1-Me,Me,0,-1,2,ve),Ue=bo(de,1,1-Me,2+Me,0,-1,2,ve);return(ke||Ue)&&(be=bo(de,1,-Me,1+Me,0,-1,2,ve)||[],ke&&(be=pr(ke,1).concat(be)),Ue&&(be=be.concat(pr(Ue,-1)))),be}(he,q),he.length&&this.splitTile(he,0,0,0),Y&&(he.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile($,q,Y,he,de,ve,Me){let be=[$,q,Y,he],ke=this.options,Ue=ke.debug;for(;be.length;){he=be.pop(),Y=be.pop(),q=be.pop(),$=be.pop();let Ve=1<<q,ct=Tn(q,Y,he),xe=this.tiles[ct];if(!xe&&(Ue>1&&console.time("creation"),xe=this.tiles[ct]=Rn($,q,Y,he,ke),this.tileCoords.push({z:q,x:Y,y:he}),Ue)){Ue>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",q,Y,he,xe.numFeatures,xe.numPoints,xe.numSimplified),console.timeEnd("creation"));let qi=`z${q}`;this.stats[qi]=(this.stats[qi]||0)+1,this.total++}if(xe.source=$,de==null){if(q===ke.indexMaxZoom||xe.numPoints<=ke.indexMaxPoints)continue}else{if(q===ke.maxZoom||q===de)continue;if(de!=null){let qi=de-q;if(Y!==ve>>qi||he!==Me>>qi)continue}}if(xe.source=null,$.length===0)continue;Ue>1&&console.time("clipping");let Rt=.5*ke.buffer/ke.extent,zt=.5-Rt,ft=.5+Rt,Tt=1+Rt,ci=null,Ji=null,es=null,Hi=null,Bt=bo($,Ve,Y-Rt,Y+ft,0,xe.minX,xe.maxX,ke),Wt=bo($,Ve,Y+zt,Y+Tt,0,xe.minX,xe.maxX,ke);$=null,Bt&&(ci=bo(Bt,Ve,he-Rt,he+ft,1,xe.minY,xe.maxY,ke),Ji=bo(Bt,Ve,he+zt,he+Tt,1,xe.minY,xe.maxY,ke),Bt=null),Wt&&(es=bo(Wt,Ve,he-Rt,he+ft,1,xe.minY,xe.maxY,ke),Hi=bo(Wt,Ve,he+zt,he+Tt,1,xe.minY,xe.maxY,ke),Wt=null),Ue>1&&console.timeEnd("clipping"),be.push(ci||[],q+1,2*Y,2*he),be.push(Ji||[],q+1,2*Y,2*he+1),be.push(es||[],q+1,2*Y+1,2*he),be.push(Hi||[],q+1,2*Y+1,2*he+1)}}getTile($,q,Y){$=+$,q=+q,Y=+Y;let he=this.options,{extent:de,debug:ve}=he;if($<0||$>24)return null;let Me=1<<$,be=Tn($,q=q+Me&Me-1,Y);if(this.tiles[be])return Go(this.tiles[be],de);ve>1&&console.log("drilling down to z%d-%d-%d",$,q,Y);let ke,Ue=$,Ve=q,ct=Y;for(;!ke&&Ue>0;)Ue--,Ve>>=1,ct>>=1,ke=this.tiles[Tn(Ue,Ve,ct)];return ke&&ke.source?(ve>1&&(console.log("found parent tile z%d-%d-%d",Ue,Ve,ct),console.time("drilling down")),this.splitTile(ke.source,Ue,Ve,ct,$,q,Y),ve>1&&console.timeEnd("drilling down"),this.tiles[be]?Go(this.tiles[be],de):null):null}}function Tn(ye,$,q){return 32*((1<<ye)*q+$)+ye}class Dn extends y{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile($,q){return n._(this,void 0,void 0,function*(){let Y=$.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");let he=this._geoJSONIndex.getTile(Y.z,Y.x,Y.y);if(!he)return null;let de=new G(he.features,{version:2,extent:n.$}),ve=function(Me){let be=new n.cM;return function(ke,Ue){for(let Ve in ke.layers)Ue.writeMessage(3,X,ke.layers[Ve])}(Me,be),be.finish()}(de);return ve.byteOffset===0&&ve.byteLength===ve.buffer.byteLength||(ve=new Uint8Array(ve)),{vectorTile:de,rawData:ve.buffer}})}loadData($){return n._(this,void 0,void 0,function*(){var q;(q=this._pendingRequest)===null||q===void 0||q.abort();let Y=!!($&&$.request&&$.request.collectResourceTiming)&&new n.cN($.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON($,this._pendingRequest);let he=yield this._pendingData;this._geoJSONIndex=$.cluster?new Xe(function({superclusterOptions:ve,clusterProperties:Me}){if(!Me||!ve)return ve;let be={},ke={},Ue={accumulated:null,zoom:0},Ve={properties:null},ct=Object.keys(Me);for(let xe of ct){let[Rt,zt]=Me[xe],ft=n.cT(zt),Tt=n.cT(typeof Rt=="string"?[Rt,["accumulated"],["get",xe]]:Rt);be[xe]=ft.value,ke[xe]=Tt.value}return ve.map=xe=>{Ve.properties=xe;let Rt={};for(let zt of ct)Rt[zt]=be[zt].evaluate(Ue,Ve);return Rt},ve.reduce=(xe,Rt)=>{Ve.properties=Rt;for(let zt of ct)Ue.accumulated=xe[zt],xe[zt]=ke[zt].evaluate(Ue,Ve)},ve}($)).load(he.features):function(ve,Me){return new Mn(ve,Me)}(he,$.geojsonVtOptions),this.loaded={};let de={data:he};if(Y){let ve=Y.finish();ve&&(de.resourceTiming={},de.resourceTiming[$.source]=JSON.parse(JSON.stringify(ve)))}return de}catch(he){if(delete this._pendingRequest,n.cy(he))return{abandoned:!0};throw he}})}getData(){return n._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile($){let q=this.loaded;return q&&q[$.uid]?super.reloadTile($):this.loadTile($)}loadAndProcessGeoJSON($,q){return n._(this,void 0,void 0,function*(){let Y=yield this.loadGeoJSON($,q);if(delete this._pendingRequest,typeof Y!="object")throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`);if(O(Y,!0),$.filter){let he=n.cT($.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(he.result==="error")throw new Error(he.value.map(ve=>`${ve.key}: ${ve.message}`).join(", "));Y={type:"FeatureCollection",features:Y.features.filter(ve=>he.value.evaluate({zoom:0},ve))}}return Y})}loadGeoJSON($,q){return n._(this,void 0,void 0,function*(){let{promoteId:Y}=$;if($.request){let he=yield n.j($.request,q);return this._dataUpdateable=n.cV(he.data,Y)?n.cU(he.data,Y):void 0,he.data}if(typeof $.data=="string")try{let he=JSON.parse($.data);return this._dataUpdateable=n.cV(he,Y)?n.cU(he,Y):void 0,he}catch{throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`)}if(!$.dataDiff)throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${$.source}`);return n.cW(this._dataUpdateable,$.dataDiff,Y),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource($){return n._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom($){return this._geoJSONIndex.getClusterExpansionZoom($.clusterId)}getClusterChildren($){return this._geoJSONIndex.getChildren($.clusterId)}getClusterLeaves($){return this._geoJSONIndex.getLeaves($.clusterId,$.limit,$.offset)}}class la{constructor($){this.self=$,this.actor=new n.J($),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(q,Y)=>{if(this.externalWorkerSourceTypes[q])throw new Error(`Worker source with name "${q}" already registered.`);this.externalWorkerSourceTypes[q]=Y},this.self.addProtocol=n.cA,this.self.removeProtocol=n.cB,this.self.registerRTLTextPlugin=q=>{n.cX.setMethods(q)},this.actor.registerMessageHandler("LDT",(q,Y)=>this._getDEMWorkerSource(q,Y.source).loadTile(Y)),this.actor.registerMessageHandler("RDT",(q,Y)=>n._(this,void 0,void 0,function*(){this._getDEMWorkerSource(q,Y.source).removeTile(Y)})),this.actor.registerMessageHandler("GCEZ",(q,Y)=>n._(this,void 0,void 0,function*(){return this._getWorkerSource(q,Y.type,Y.source).getClusterExpansionZoom(Y)})),this.actor.registerMessageHandler("GCC",(q,Y)=>n._(this,void 0,void 0,function*(){return this._getWorkerSource(q,Y.type,Y.source).getClusterChildren(Y)})),this.actor.registerMessageHandler("GCL",(q,Y)=>n._(this,void 0,void 0,function*(){return this._getWorkerSource(q,Y.type,Y.source).getClusterLeaves(Y)})),this.actor.registerMessageHandler("LD",(q,Y)=>this._getWorkerSource(q,Y.type,Y.source).loadData(Y)),this.actor.registerMessageHandler("GD",(q,Y)=>this._getWorkerSource(q,Y.type,Y.source).getData()),this.actor.registerMessageHandler("LT",(q,Y)=>this._getWorkerSource(q,Y.type,Y.source).loadTile(Y)),this.actor.registerMessageHandler("RT",(q,Y)=>this._getWorkerSource(q,Y.type,Y.source).reloadTile(Y)),this.actor.registerMessageHandler("AT",(q,Y)=>this._getWorkerSource(q,Y.type,Y.source).abortTile(Y)),this.actor.registerMessageHandler("RMT",(q,Y)=>this._getWorkerSource(q,Y.type,Y.source).removeTile(Y)),this.actor.registerMessageHandler("RS",(q,Y)=>n._(this,void 0,void 0,function*(){if(!this.workerSources[q]||!this.workerSources[q][Y.type]||!this.workerSources[q][Y.type][Y.source])return;let he=this.workerSources[q][Y.type][Y.source];delete this.workerSources[q][Y.type][Y.source],he.removeSource!==void 0&&he.removeSource(Y)})),this.actor.registerMessageHandler("RM",q=>n._(this,void 0,void 0,function*(){delete this.layerIndexes[q],delete this.availableImages[q],delete this.workerSources[q],delete this.demWorkerSources[q],this.globalStates.delete(q)})),this.actor.registerMessageHandler("SR",(q,Y)=>n._(this,void 0,void 0,function*(){this.referrer=Y})),this.actor.registerMessageHandler("SRPS",(q,Y)=>this._syncRTLPluginState(q,Y)),this.actor.registerMessageHandler("IS",(q,Y)=>n._(this,void 0,void 0,function*(){this.self.importScripts(Y)})),this.actor.registerMessageHandler("SI",(q,Y)=>this._setImages(q,Y)),this.actor.registerMessageHandler("UL",(q,Y)=>n._(this,void 0,void 0,function*(){this._getLayerIndex(q).update(Y.layers,Y.removedIds,this._getGlobalState(q))})),this.actor.registerMessageHandler("UGS",(q,Y)=>n._(this,void 0,void 0,function*(){let he=this._getGlobalState(q);for(let de in Y)he[de]=Y[de]})),this.actor.registerMessageHandler("SL",(q,Y)=>n._(this,void 0,void 0,function*(){this._getLayerIndex(q).replace(Y,this._getGlobalState(q))}))}_getGlobalState($){let q=this.globalStates.get($);return q||(q={},this.globalStates.set($,q)),q}_setImages($,q){return n._(this,void 0,void 0,function*(){this.availableImages[$]=q;for(let Y in this.workerSources[$]){let he=this.workerSources[$][Y];for(let de in he)he[de].availableImages=q}})}_syncRTLPluginState($,q){return n._(this,void 0,void 0,function*(){return yield n.cX.syncState(q,this.self.importScripts)})}_getAvailableImages($){let q=this.availableImages[$];return q||(q=[]),q}_getLayerIndex($){let q=this.layerIndexes[$];return q||(q=this.layerIndexes[$]=new o),q}_getWorkerSource($,q,Y){if(this.workerSources[$]||(this.workerSources[$]={}),this.workerSources[$][q]||(this.workerSources[$][q]={}),!this.workerSources[$][q][Y]){let he={sendAsync:(de,ve)=>(de.targetMapId=$,this.actor.sendAsync(de,ve))};switch(q){case"vector":this.workerSources[$][q][Y]=new y(he,this._getLayerIndex($),this._getAvailableImages($));break;case"geojson":this.workerSources[$][q][Y]=new Dn(he,this._getLayerIndex($),this._getAvailableImages($));break;default:this.workerSources[$][q][Y]=new this.externalWorkerSourceTypes[q](he,this._getLayerIndex($),this._getAvailableImages($))}}return this.workerSources[$][q][Y]}_getDEMWorkerSource($,q){return this.demWorkerSources[$]||(this.demWorkerSources[$]={}),this.demWorkerSources[$][q]||(this.demWorkerSources[$][q]=new C),this.demWorkerSources[$][q]}}return n.i(self)&&(self.worker=new la(self)),la}),i("index",["exports","./shared"],function(n,o){"use strict";var l="5.7.3";function d(){var w=new o.A(4);return o.A!=Float32Array&&(w[1]=0,w[2]=0),w[0]=1,w[3]=1,w}let p,y,C={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(w,r,u){let f=requestAnimationFrame(x=>{v(),r(x)}),{unsubscribe:v}=o.s(w.signal,"abort",()=>{v(),cancelAnimationFrame(f),u(o.c())},!1)},frameAsync(w){return new Promise((r,u)=>{this.frame(w,r,u)})},getImageData(w,r=0){return this.getImageCanvasContext(w).getImageData(-r,-r,w.width+2*r,w.height+2*r)},getImageCanvasContext(w){let r=window.document.createElement("canvas"),u=r.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return r.width=w.width,r.height=w.height,u.drawImage(w,0,0,w.width,w.height),u},resolveURL:w=>(p||(p=document.createElement("a")),p.href=w,p.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(y==null&&(y=matchMedia("(prefers-reduced-motion: reduce)")),y.matches)}};class S{static testProp(r){if(!S.docStyle)return r[0];for(let u=0;u<r.length;u++)if(r[u]in S.docStyle)return r[u];return r[0]}static create(r,u,f){let v=window.document.createElement(r);return u!==void 0&&(v.className=u),f&&f.appendChild(v),v}static createNS(r,u){return window.document.createElementNS(r,u)}static disableDrag(){S.docStyle&&S.selectProp&&(S.userSelect=S.docStyle[S.selectProp],S.docStyle[S.selectProp]="none")}static enableDrag(){S.docStyle&&S.selectProp&&(S.docStyle[S.selectProp]=S.userSelect)}static setTransform(r,u){r.style[S.transformProp]=u}static addEventListener(r,u,f,v={}){r.addEventListener(u,f,"passive"in v?v:v.capture)}static removeEventListener(r,u,f,v={}){r.removeEventListener(u,f,"passive"in v?v:v.capture)}static suppressClickInternal(r){r.preventDefault(),r.stopPropagation(),window.removeEventListener("click",S.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",S.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",S.suppressClickInternal,!0)},0)}static getScale(r){let u=r.getBoundingClientRect();return{x:u.width/r.offsetWidth||1,y:u.height/r.offsetHeight||1,boundingClientRect:u}}static getPoint(r,u,f){let v=u.boundingClientRect;return new o.P((f.clientX-v.left)/u.x-r.clientLeft,(f.clientY-v.top)/u.y-r.clientTop)}static mousePos(r,u){let f=S.getScale(r);return S.getPoint(r,f,u)}static touchPos(r,u){let f=[],v=S.getScale(r);for(let x=0;x<u.length;x++)f.push(S.getPoint(r,v,u[x]));return f}static mouseButton(r){return r.button}static remove(r){r.parentNode&&r.parentNode.removeChild(r)}static sanitize(r){let u=new DOMParser().parseFromString(r,"text/html").body||document.createElement("body"),f=u.querySelectorAll("script");for(let v of f)v.remove();return S.clean(u),u.innerHTML}static isPossiblyDangerous(r,u){let f=u.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(r)||!f.includes("javascript:")&&!f.includes("data:"))||!!r.startsWith("on")||void 0}static clean(r){let u=r.children;for(let f of u)S.removeAttributes(f),S.clean(f)}static removeAttributes(r){for(let{name:u,value:f}of r.attributes)S.isPossiblyDangerous(u,f)&&r.removeAttribute(u)}}S.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,S.selectProp=S.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),S.transformProp=S.testProp(["transform","WebkitTransform"]);let P={supported:!1,testSupport:function(w){!V&&O&&(G?X(w):I=w)}},I,O,V=!1,G=!1;function X(w){let r=w.createTexture();w.bindTexture(w.TEXTURE_2D,r);try{if(w.texImage2D(w.TEXTURE_2D,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,O),w.isContextLost())return;P.supported=!0}catch{}w.deleteTexture(r),V=!0}var Q;typeof document<"u"&&(O=document.createElement("img"),O.onload=()=>{I&&X(I),I=null,G=!0},O.onerror=()=>{V=!0,I=null},O.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(w){let r,u,f,v;w.resetRequestQueue=()=>{r=[],u=0,f=0,v={}},w.addThrottleControl=D=>{let k=f++;return v[k]=D,k},w.removeThrottleControl=D=>{delete v[D],R()},w.getImage=(D,k,L=!0)=>new Promise((H,B)=>{P.supported&&(D.headers||(D.headers={}),D.headers.accept="image/webp,*/*"),o.e(D,{type:"image"}),r.push({abortController:k,requestParameters:D,supportImageRefresh:L,state:"queued",onError:W=>{B(W)},onSuccess:W=>{H(W)}}),R()});let x=D=>o._(this,void 0,void 0,function*(){D.state="running";let{requestParameters:k,supportImageRefresh:L,onError:H,onSuccess:B,abortController:W}=D,Z=L===!1&&!o.i(self)&&!o.g(k.url)&&(!k.headers||Object.keys(k.headers).reduce((ie,oe)=>ie&&oe==="accept",!0));u++;let ee=Z?T(k,W):o.m(k,W);try{let ie=yield ee;delete D.abortController,D.state="completed",ie.data instanceof HTMLImageElement||o.b(ie.data)?B(ie):ie.data&&B({data:yield(te=ie.data,typeof createImageBitmap=="function"?o.f(te):o.h(te)),cacheControl:ie.cacheControl,expires:ie.expires})}catch(ie){delete D.abortController,H(ie)}finally{u--,R()}var te}),R=()=>{let D=(()=>{for(let k of Object.keys(v))if(v[k]())return!0;return!1})()?o.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:o.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let k=u;k<D&&r.length>0;k++){let L=r.shift();L.abortController.signal.aborted?k--:x(L)}},T=(D,k)=>new Promise((L,H)=>{let B=new Image,W=D.url,Z=D.credentials;Z&&Z==="include"?B.crossOrigin="use-credentials":(Z&&Z==="same-origin"||!o.d(W))&&(B.crossOrigin="anonymous"),k.signal.addEventListener("abort",()=>{B.src="",H(o.c())}),B.fetchPriority="high",B.onload=()=>{B.onerror=B.onload=null,L({data:B})},B.onerror=()=>{B.onerror=B.onload=null,k.signal.aborted||H(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},B.src=W})}(Q||(Q={})),Q.resetRequestQueue();class ae{constructor(r){this._transformRequestFn=r??null}transformRequest(r,u){return this._transformRequestFn&&this._transformRequestFn(r,u)||{url:r}}setTransformRequest(r){this._transformRequestFn=r}}function me(w){let r=[];if(typeof w=="string")r.push({id:"default",url:w});else if(w&&w.length>0){let u=[];for(let{id:f,url:v}of w){let x=`${f}${v}`;u.indexOf(x)===-1&&(u.push(x),r.push({id:f,url:v}))}}return r}function fe(w,r,u){try{let f=new URL(w);return f.pathname+=`${r}${u}`,f.toString()}catch{throw new Error(`Invalid sprite URL "${w}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function _e(w){let{userImage:r}=w;return!!(r&&r.render&&r.render())&&(w.data.replace(new Uint8Array(r.data.buffer)),!0)}class Ae extends o.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(let{ids:u,promiseResolve:f}of this.requestors)f(this._getImagesForIds(u));this.requestors=[]}}getImage(r){let u=this.images[r];if(u&&!u.data&&u.spriteData){let f=u.spriteData;u.data=new o.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),u.spriteData=null}return u}addImage(r,u){if(this.images[r])throw new Error(`Image id ${r} already exist, use updateImage instead`);this._validate(r,u)&&(this.images[r]=u)}_validate(r,u){let f=!0,v=u.data||u.spriteData;return this._validateStretch(u.stretchX,v&&v.width)||(this.fire(new o.k(new Error(`Image "${r}" has invalid "stretchX" value`))),f=!1),this._validateStretch(u.stretchY,v&&v.height)||(this.fire(new o.k(new Error(`Image "${r}" has invalid "stretchY" value`))),f=!1),this._validateContent(u.content,u)||(this.fire(new o.k(new Error(`Image "${r}" has invalid "content" value`))),f=!1),f}_validateStretch(r,u){if(!r)return!0;let f=0;for(let v of r){if(v[0]<f||v[1]<v[0]||u<v[1])return!1;f=v[1]}return!0}_validateContent(r,u){if(!r)return!0;if(r.length!==4)return!1;let f=u.spriteData,v=f&&f.width||u.data.width,x=f&&f.height||u.data.height;return!(r[0]<0||v<r[0]||r[1]<0||x<r[1]||r[2]<0||v<r[2]||r[3]<0||x<r[3]||r[2]<r[0]||r[3]<r[1])}updateImage(r,u,f=!0){let v=this.getImage(r);if(f&&(v.data.width!==u.data.width||v.data.height!==u.data.height))throw new Error(`size mismatch between old image (${v.data.width}x${v.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=v.version+1,this.images[r]=u,this.updatedImages[r]=!0}removeImage(r){let u=this.images[r];delete this.images[r],delete this.patterns[r],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r){return new Promise((u,f)=>{let v=!0;if(!this.isLoaded())for(let x of r)this.images[x]||(v=!1);this.isLoaded()||v?u(this._getImagesForIds(r)):this.requestors.push({ids:r,promiseResolve:u})})}_getImagesForIds(r){let u={};for(let f of r){let v=this.getImage(f);v||(this.fire(new o.l("styleimagemissing",{id:f})),v=this.getImage(f)),v?u[f]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,textFitWidth:v.textFitWidth,textFitHeight:v.textFitHeight,hasRenderCallback:!!(v.userImage&&v.userImage.render)}:o.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){let{width:r,height:u}=this.atlasImage;return{width:r,height:u}}getPattern(r){let u=this.patterns[r],f=this.getImage(r);if(!f)return null;if(u&&u.position.version===f.version)return u.position;if(u)u.position.version=f.version;else{let v={w:f.data.width+2,h:f.data.height+2,x:0,y:0},x=new o.I(v,f);this.patterns[r]={bin:v,position:x}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){let u=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.T(r,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){let r=[];for(let x in this.patterns)r.push(this.patterns[x].bin);let{w:u,h:f}=o.p(r),v=this.atlasImage;v.resize({width:u||1,height:f||1});for(let x in this.patterns){let{bin:R}=this.patterns[x],T=R.x+1,D=R.y+1,k=this.getImage(x).data,L=k.width,H=k.height;o.R.copy(k,v,{x:0,y:0},{x:T,y:D},{width:L,height:H}),o.R.copy(k,v,{x:0,y:H-1},{x:T,y:D-1},{width:L,height:1}),o.R.copy(k,v,{x:0,y:0},{x:T,y:D+H},{width:L,height:1}),o.R.copy(k,v,{x:L-1,y:0},{x:T-1,y:D},{width:1,height:H}),o.R.copy(k,v,{x:0,y:0},{x:T+L,y:D},{width:1,height:H})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(let u of r){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;let f=this.getImage(u);f||o.w(`Image with ID: "${u}" was not found`),_e(f)&&this.updateImage(u,f)}}}let Oe=1e20;function Ge(w,r,u,f,v,x,R,T,D){for(let k=r;k<r+f;k++)it(w,u*x+k,x,v,R,T,D);for(let k=u;k<u+v;k++)it(w,k*x+r,1,f,R,T,D)}function it(w,r,u,f,v,x,R){x[0]=0,R[0]=-Oe,R[1]=Oe,v[0]=w[r];for(let T=1,D=0,k=0;T<f;T++){v[T]=w[r+T*u];let L=T*T;do{let H=x[D];k=(v[T]-v[H]+L-H*H)/(T-H)/2}while(k<=R[D]&&--D>-1);D++,x[D]=T,R[D]=k,R[D+1]=Oe}for(let T=0,D=0;T<f;T++){for(;R[D+1]<T;)D++;let k=x[D],L=T-k;w[r+T*u]=v[k]+L*L}}class Xe{constructor(r,u,f){this.requestManager=r,this.localIdeographFontFamily=u,this.entries={},this.lang=f}setURL(r){this.url=r}getGlyphs(r){return o._(this,void 0,void 0,function*(){let u=[];for(let x in r)for(let R of r[x])u.push(this._getAndCacheGlyphsPromise(x,R));let f=yield Promise.all(u),v={};for(let{stack:x,id:R,glyph:T}of f)v[x]||(v[x]={}),v[x][R]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics};return v})}_getAndCacheGlyphsPromise(r,u){return o._(this,void 0,void 0,function*(){let f=this.entries[r];f||(f=this.entries[r]={glyphs:{},requests:{},ranges:{}});let v=f.glyphs[u];if(v!==void 0)return{stack:r,id:u,glyph:v};if(v=this._tinySDF(f,r,u),v)return f.glyphs[u]=v,{stack:r,id:u,glyph:v};let x=Math.floor(u/256);if(256*x>65535)throw new Error("glyphs > 65535 not supported");if(f.ranges[x])return{stack:r,id:u,glyph:v};if(!this.url)throw new Error("glyphsUrl is not set");if(!f.requests[x]){let T=Xe.loadGlyphRange(r,x,this.url,this.requestManager);f.requests[x]=T}let R=yield f.requests[x];for(let T in R)this._doesCharSupportLocalGlyph(+T)||(f.glyphs[+T]=R[+T]);return f.ranges[x]=!0,{stack:r,id:u,glyph:R[u]||null}})}_doesCharSupportLocalGlyph(r){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(r))||o.u["CJK Unified Ideographs"](r)||o.u["Hangul Syllables"](r)||o.u.Hiragana(r)||o.u.Katakana(r)||o.u["CJK Symbols and Punctuation"](r)||o.u["Halfwidth and Fullwidth Forms"](r))}_tinySDF(r,u,f){let v=this.localIdeographFontFamily;if(!v||!this._doesCharSupportLocalGlyph(f))return;let x=r.tinySDF;if(!x){let T="400";/bold/i.test(u)?T="900":/medium/i.test(u)?T="500":/light/i.test(u)&&(T="200"),x=r.tinySDF=new Xe.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:v,fontWeight:T})}let R=x.draw(String.fromCharCode(f));return{id:f,bitmap:new o.q({width:R.width||60,height:R.height||60},R.data),metrics:{width:R.glyphWidth/2||24,height:R.glyphHeight/2||24,left:R.glyphLeft/2+.5||0,top:R.glyphTop/2-27.5||-8,advance:R.glyphAdvance/2||24,isDoubleResolution:!0}}}}Xe.loadGlyphRange=function(w,r,u,f){return o._(this,void 0,void 0,function*(){let v=256*r,x=v+255,R=f.transformRequest(u.replace("{fontstack}",w).replace("{range}",`${v}-${x}`),"Glyphs"),T=yield o.n(R,new AbortController);if(!T||!T.data)throw new Error(`Could not load glyph range. range: ${r}, ${v}-${x}`);let D={};for(let k of o.o(T.data))D[k.id]=k;return D})},Xe.TinySDF=class{constructor({fontSize:w=24,buffer:r=3,radius:u=8,cutoff:f=.25,fontFamily:v="sans-serif",fontWeight:x="normal",fontStyle:R="normal",lang:T=null}={}){this.buffer=r,this.cutoff=f,this.radius=u,this.lang=T;let D=this.size=w+4*r,k=this._createCanvas(D),L=this.ctx=k.getContext("2d",{willReadFrequently:!0});L.font=`${R} ${x} ${w}px ${v}`,L.textBaseline="alphabetic",L.textAlign="left",L.fillStyle="black",this.gridOuter=new Float64Array(D*D),this.gridInner=new Float64Array(D*D),this.f=new Float64Array(D),this.z=new Float64Array(D+1),this.v=new Uint16Array(D)}_createCanvas(w){let r=document.createElement("canvas");return r.width=r.height=w,r}draw(w){let{width:r,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:v,actualBoundingBoxRight:x}=this.ctx.measureText(w),R=Math.ceil(u),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-v))),D=Math.min(this.size-this.buffer,R+Math.ceil(f)),k=T+2*this.buffer,L=D+2*this.buffer,H=Math.max(k*L,0),B=new Uint8ClampedArray(H),W={data:B,width:k,height:L,glyphWidth:T,glyphHeight:D,glyphTop:R,glyphLeft:0,glyphAdvance:r};if(T===0||D===0)return W;let{ctx:Z,buffer:ee,gridInner:te,gridOuter:ie}=this;this.lang&&(Z.lang=this.lang),Z.clearRect(ee,ee,T,D),Z.fillText(w,ee,ee+R);let oe=Z.getImageData(ee,ee,T,D);ie.fill(Oe,0,H),te.fill(0,0,H);for(let le=0;le<D;le++)for(let ne=0;ne<T;ne++){let ue=oe.data[4*(le*T+ne)+3]/255;if(ue===0)continue;let ge=(le+ee)*k+ne+ee;if(ue===1)ie[ge]=0,te[ge]=Oe;else{let re=.5-ue;ie[ge]=re>0?re*re:0,te[ge]=re<0?re*re:0}}Ge(ie,0,0,k,L,k,this.f,this.v,this.z),Ge(te,ee,ee,T,D,k,this.f,this.v,this.z);for(let le=0;le<H;le++){let ne=Math.sqrt(ie[le])-Math.sqrt(te[le]);B[le]=Math.round(255-255*(ne/this.radius+this.cutoff))}return W}};class lt{constructor(){this.specification=o.v.light.position}possiblyEvaluate(r,u){return o.B(r.expression.evaluate(u))}interpolate(r,u,f){return{x:o.C.number(r.x,u.x,f),y:o.C.number(r.y,u.y,f),z:o.C.number(r.z,u.z,f)}}}let St;class Gt extends o.E{constructor(r){super(),St=St||new o.r({anchor:new o.D(o.v.light.anchor),position:new lt,color:new o.D(o.v.light.color),intensity:new o.D(o.v.light.intensity)}),this._transitionable=new o.t(St,void 0),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,u={}){if(!this._validate(o.x,r,u))for(let f in r){let v=r[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),v):this._transitionable.setValue(f,v)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,u,f){return(!f||f.validate!==!1)&&o.y(this,r.call(o.z,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:o.v}))}}let xt=new o.r({"sky-color":new o.D(o.v.sky["sky-color"]),"horizon-color":new o.D(o.v.sky["horizon-color"]),"fog-color":new o.D(o.v.sky["fog-color"]),"fog-ground-blend":new o.D(o.v.sky["fog-ground-blend"]),"horizon-fog-blend":new o.D(o.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new o.D(o.v.sky["sky-horizon-blend"]),"atmosphere-blend":new o.D(o.v.sky["atmosphere-blend"])});class Yt extends o.E{constructor(r){super(),this._transitionable=new o.t(xt,void 0),this.setSky(r),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.F(0))}setSky(r,u={}){if(!this._validate(o.G,r,u)){r||(r={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(let f in r){let v=r[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),v):this._transitionable.setValue(f,v)}}}getSky(){return this._transitionable.serialize()}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,u,f={}){return f?.validate!==!1&&o.y(this,r.call(o.z,o.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:o.v})))}calculateFogBlendOpacity(r){return r<60?0:r<70?(r-60)/10:1}}class Ct{constructor(r,u){this.width=r,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(r,u){let f=r.join(",")+String(u);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(r,u)),this.dashEntry[f]}getDashRanges(r,u,f){let v=[],x=r.length%2==1?-r[r.length-1]*f:0,R=r[0]*f,T=!0;v.push({left:x,right:R,isDash:T,zeroLength:r[0]===0});let D=r[0];for(let k=1;k<r.length;k++){T=!T;let L=r[k];x=D*f,D+=L,R=D*f,v.push({left:x,right:R,isDash:T,zeroLength:L===0})}return v}addRoundDash(r,u,f){let v=u/2;for(let x=-f;x<=f;x++){let R=this.width*(this.nextRow+f+x),T=0,D=r[T];for(let k=0;k<this.width;k++){k/D.right>1&&(D=r[++T]);let L=Math.abs(k-D.left),H=Math.abs(k-D.right),B=Math.min(L,H),W,Z=x/f*(v+1);if(D.isDash){let ee=v-Math.abs(Z);W=Math.sqrt(B*B+ee*ee)}else W=v-Math.sqrt(B*B+Z*Z);this.data[R+k]=Math.max(0,Math.min(255,W+128))}}}addRegularDash(r){for(let T=r.length-1;T>=0;--T){let D=r[T],k=r[T+1];D.zeroLength?r.splice(T,1):k&&k.isDash===D.isDash&&(k.left=D.left,r.splice(T,1))}let u=r[0],f=r[r.length-1];u.isDash===f.isDash&&(u.left=f.left-this.width,f.right=u.right+this.width);let v=this.width*this.nextRow,x=0,R=r[x];for(let T=0;T<this.width;T++){T/R.right>1&&(R=r[++x]);let D=Math.abs(T-R.left),k=Math.abs(T-R.right),L=Math.min(D,k);this.data[v+T]=Math.max(0,Math.min(255,(R.isDash?L:-L)+128))}}addDash(r,u){let f=u?7:0,v=2*f+1;if(this.nextRow+v>this.height)return o.w("LineAtlas out of space"),null;let x=0;for(let T=0;T<r.length;T++)x+=r[T];if(x!==0){let T=this.width/x,D=this.getDashRanges(r,this.width,T);u?this.addRoundDash(D,T,f):this.addRegularDash(D)}let R={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:x};return this.nextRow+=v,this.dirty=!0,R}bind(r){let u=r.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}let Fi="maplibre_preloaded_worker_pool";class jt{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<jt.workerCount;)this.workers.push(new Worker(o.a.WORKER_URL));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Fi]}numActive(){return Object.keys(this.active).length}}let Jt=Math.floor(C.hardwareConcurrency/2),Bi,Qi;function ji(){return Bi||(Bi=new jt),Bi}jt.workerCount=o.H(globalThis)?Math.max(Math.min(Jt,3),1):1;class fi{constructor(r,u){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=u;let f=this.workerPool.acquire(u);for(let v=0;v<f.length;v++){let x=new o.J(f[v],u);x.name=`Worker ${v}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(r,u){let f=[];for(let v of this.actors)f.push(v.sendAsync({type:r,data:u}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(r=!0){this.actors.forEach(u=>{u.remove()}),this.actors=[],r&&this.workerPool.release(this.id)}registerMessageHandler(r,u){for(let f of this.actors)f.registerMessageHandler(r,u)}}function ro(){return Qi||(Qi=new fi(ji(),o.K),Qi.registerMessageHandler("GR",(w,r,u)=>o.m(r,u))),Qi}function $i(w,r){let u=o.L();return o.M(u,u,[1,1,0]),o.N(u,u,[.5*w.width,.5*w.height,1]),w.calculatePosMatrix?o.O(u,u,w.calculatePosMatrix(r.toUnwrapped())):u}function bo(w,r,u,f,v,x,R){var T;let D=function(B,W,Z){if(B)for(let ee of B){let te=W[ee];if(te&&te.source===Z&&te.type==="fill-extrusion")return!0}else for(let ee in W){let te=W[ee];if(te.source===Z&&te.type==="fill-extrusion")return!0}return!1}((T=v?.layers)!==null&&T!==void 0?T:null,r,w.id),k=x.maxPitchScaleFactor(),L=w.tilesIn(f,k,D);L.sort(na);let H=[];for(let B of L)H.push({wrappedTileID:B.tileID.wrapped().key,queryResults:B.tile.queryRenderedFeatures(r,u,w._state,B.queryGeometry,B.cameraQueryGeometry,B.scale,v,x,k,$i(w.transform,B.tileID),R?(W,Z)=>R(B.tileID,W,Z):void 0)});return function(B,W){for(let Z in B)for(let ee of B[Z])ra(ee,W);return B}(function(B){let W={},Z={};for(let ee of B){let te=ee.queryResults,ie=ee.wrappedTileID,oe=Z[ie]=Z[ie]||{};for(let le in te){let ne=te[le],ue=oe[le]=oe[le]||{},ge=W[le]=W[le]||[];for(let re of ne)ue[re.featureIndex]||(ue[re.featureIndex]=!0,ge.push(re))}}return W}(H),w)}function na(w,r){let u=w.tileID,f=r.tileID;return u.overscaledZ-f.overscaledZ||u.canonical.y-f.canonical.y||u.wrap-f.wrap||u.canonical.x-f.canonical.x}function ra(w,r){let u=w.feature,f=r.getFeatureState(u.layer["source-layer"],u.id);u.source=u.layer.source,u.layer["source-layer"]&&(u.sourceLayer=u.layer["source-layer"]),u.state=f}function Xs(w,r,u){return o._(this,void 0,void 0,function*(){let f=w;if(w.url?f=(yield o.j(r.transformRequest(w.url,"Source"),u)).data:yield C.frameAsync(u),!f)return null;let v=o.Q(o.e(f,w),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(v.vectorLayerIds=f.vector_layers.map(x=>x.id)),v})}class Ii{constructor(r,u){r&&(u?this.setSouthWest(r).setNorthEast(u):Array.isArray(r)&&(r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1])))}setNorthEast(r){return this._ne=r instanceof o.S?new o.S(r.lng,r.lat):o.S.convert(r),this}setSouthWest(r){return this._sw=r instanceof o.S?new o.S(r.lng,r.lat):o.S.convert(r),this}extend(r){let u=this._sw,f=this._ne,v,x;if(r instanceof o.S)v=r,x=r;else{if(!(r instanceof Ii))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(Ii.convert(r)):this.extend(o.S.convert(r)):r&&("lng"in r||"lon"in r)&&"lat"in r?this.extend(o.S.convert(r)):this;if(v=r._sw,x=r._ne,!v||!x)return this}return u||f?(u.lng=Math.min(v.lng,u.lng),u.lat=Math.min(v.lat,u.lat),f.lng=Math.max(x.lng,f.lng),f.lat=Math.max(x.lat,f.lat)):(this._sw=new o.S(v.lng,v.lat),this._ne=new o.S(x.lng,x.lat)),this}getCenter(){return new o.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new o.S(this.getWest(),this.getNorth())}getSouthEast(){return new o.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){let{lng:u,lat:f}=o.S.convert(r),v=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&v}static convert(r){return r instanceof Ii?r:r&&new Ii(r)}static fromLngLat(r,u=0){let f=360*u/40075017,v=f/Math.cos(Math.PI/180*r.lat);return new Ii(new o.S(r.lng-v,r.lat-f),new o.S(r.lng+v,r.lat+f))}adjustAntiMeridian(){let r=new o.S(this._sw.lng,this._sw.lat),u=new o.S(this._ne.lng,this._ne.lat);return new Ii(r,r.lng>u.lng?new o.S(u.lng+360,u.lat):u)}}class Vi{constructor(r,u,f){this.bounds=Ii.convert(this.validateBounds(r)),this.minzoom=u||0,this.maxzoom=f||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){let u=Math.pow(2,r.z),f=Math.floor(o.V(this.bounds.getWest())*u),v=Math.floor(o.U(this.bounds.getNorth())*u),x=Math.ceil(o.V(this.bounds.getEast())*u),R=Math.ceil(o.U(this.bounds.getSouth())*u);return r.x>=f&&r.x<x&&r.y>=v&&r.y<R}}class xo extends o.E{constructor(r,u,f,v){if(super(),this.id=r,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.e(this,o.Q(u,["url","scheme","tileSize","promoteId"])),this._options=o.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v)}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let r=yield Xs(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),r&&(o.e(this,r),r.bounds&&(this.tileBounds=new Vi(r.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})))}catch(r){this._tileJSONRequest=null,this._loaded=!0,this.fire(new o.k(r))}})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.abort(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return o.e({},this._options)}loadTile(r){return o._(this,void 0,void 0,function*(){let u=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(u,"Tile"),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};f.request.collectResourceTiming=this._collectResourceTiming;let v="RT";if(r.actor&&r.state!=="expired"){if(r.state==="loading")return new Promise((x,R)=>{r.reloadPromise={resolve:x,reject:R}})}else r.actor=this.dispatcher.getActor(),v="LT";r.abortController=new AbortController;try{let x=yield r.actor.sendAsync({type:v,data:f},r.abortController);if(delete r.abortController,r.aborted)return;this._afterTileLoadWorkerResponse(r,x)}catch(x){if(delete r.abortController,r.aborted)return;if(x&&x.status!==404)throw x;this._afterTileLoadWorkerResponse(r,null)}})}_afterTileLoadWorkerResponse(r,u){if(u&&u.resourceTiming&&(r.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&r.setExpiryData(u),r.loadVectorData(u,this.map.painter),r.reloadPromise){let f=r.reloadPromise;r.reloadPromise=null,this.loadTile(r).then(f.resolve).catch(f.reject)}}abortTile(r){return o._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController),r.actor&&(yield r.actor.sendAsync({type:"AT",data:{uid:r.uid,type:this.type,source:this.id}}))})}unloadTile(r){return o._(this,void 0,void 0,function*(){r.unloadVectorData(),r.actor&&(yield r.actor.sendAsync({type:"RMT",data:{uid:r.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ho extends o.E{constructor(r,u,f,v){super(),this.id=r,this.dispatcher=f,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.e({type:"raster"},u),o.e(this,o.Q(u,["url","scheme","tileSize"]))}load(){return o._(this,arguments,void 0,function*(r=!1){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let u=yield Xs(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,u&&(o.e(this,u),u.bounds&&(this.tileBounds=new Vi(u.bounds,this.minzoom,this.maxzoom)),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:r})))}catch(u){this._tileJSONRequest=null,this._loaded=!0,this.fire(new o.k(u))}})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(r){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),r(),this.load(!0)}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}serialize(){return o.e({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r){return o._(this,void 0,void 0,function*(){let u=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);r.abortController=new AbortController;try{let f=yield Q.getImage(this.map._requestManager.transformRequest(u,"Tile"),r.abortController,this.map._refreshExpiredTiles);if(delete r.abortController,r.aborted)return void(r.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&r.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});let v=this.map.painter.context,x=v.gl,R=f.data;r.texture=this.map.painter.getTileTexture(R.width),r.texture?r.texture.update(R,{useMipmap:!0}):(r.texture=new o.T(v,R,x.RGBA,{useMipmap:!0}),r.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST)),r.state="loaded"}}catch(f){if(delete r.abortController,r.aborted)r.state="unloaded";else if(f)throw r.state="errored",f}})}abortTile(r){return o._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController)})}unloadTile(r){return o._(this,void 0,void 0,function*(){r.texture&&this.map.painter.saveTileTexture(r.texture)})}hasTransition(){return!1}}class pr extends Ho{constructor(r,u,f,v){super(r,u,f,v),this.type="raster-dem",this.maxzoom=22,this._options=o.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(r){return o._(this,void 0,void 0,function*(){let u=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(u,"Tile");r.neighboringTiles=this._getNeighboringTiles(r.tileID),r.abortController=new AbortController;try{let v=yield Q.getImage(f,r.abortController,this.map._refreshExpiredTiles);if(delete r.abortController,r.aborted)return void(r.state="unloaded");if(v&&v.data){let x=v.data;this.map._refreshExpiredTiles&&(v.cacheControl||v.expires)&&r.setExpiryData({cacheControl:v.cacheControl,expires:v.expires});let R=o.b(x)&&o.W()?x:yield this.readImageNow(x),T={type:this.type,uid:r.uid,source:this.id,rawImageData:R,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!r.actor||r.state==="expired"){r.actor=this.dispatcher.getActor();let D=yield r.actor.sendAsync({type:"LDT",data:T});r.dem=D,r.needsHillshadePrepare=!0,r.needsTerrainPrepare=!0,r.state="loaded"}}}catch(v){if(delete r.abortController,r.aborted)r.state="unloaded";else if(v)throw r.state="errored",v}})}readImageNow(r){return o._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&o.X()){let u=r.width+2,f=r.height+2;try{return new o.R({width:u,height:f},yield o.Y(r,-1,-1,u,f))}catch{}}return C.getImageData(r,1)})}_getNeighboringTiles(r){let u=r.canonical,f=Math.pow(2,u.z),v=(u.x-1+f)%f,x=u.x===0?r.wrap-1:r.wrap,R=(u.x+1+f)%f,T=u.x+1===f?r.wrap+1:r.wrap,D={};return D[new o.Z(r.overscaledZ,x,u.z,v,u.y).key]={backfilled:!1},D[new o.Z(r.overscaledZ,T,u.z,R,u.y).key]={backfilled:!1},u.y>0&&(D[new o.Z(r.overscaledZ,x,u.z,v,u.y-1).key]={backfilled:!1},D[new o.Z(r.overscaledZ,r.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},D[new o.Z(r.overscaledZ,T,u.z,R,u.y-1).key]={backfilled:!1}),u.y+1<f&&(D[new o.Z(r.overscaledZ,x,u.z,v,u.y+1).key]={backfilled:!1},D[new o.Z(r.overscaledZ,r.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},D[new o.Z(r.overscaledZ,T,u.z,R,u.y+1).key]={backfilled:!1}),D}unloadTile(r){return o._(this,void 0,void 0,function*(){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&(yield r.actor.sendAsync({type:"RDT",data:{type:this.type,uid:r.uid,source:this.id}}))})}}class No extends o.E{constructor(r,u,f,v){super(),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:u.data},this.actor=f.getActor(),this.setEventedParent(v),this._data=u.data,this._options=o.e({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId,u.clusterMaxZoom!==void 0&&this.maxzoom<=u.clusterMaxZoom&&o.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${u.clusterMaxZoom}".`),this.workerOptions=o.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(u.buffer!==void 0?u.buffer:128),tolerance:this._pixelsToTileUnits(u.tolerance!==void 0?u.tolerance:.375),extent:o.$,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(u.clusterMaxZoom),minPoints:Math.max(2,u.clusterMinPoints||2),extent:o.$,radius:this._pixelsToTileUnits(u.clusterRadius||50),log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(r){return r*(o.$/this.tileSize)}_getClusterMaxZoom(r){let u=r?Math.round(r):this.maxzoom-1;return Number.isInteger(r)||r===void 0||o.w(`Integer expected for option 'clusterMaxZoom': provided value "${r}" rounded to "${u}"`),u}load(){return o._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(r){this.map=r,this.load()}setData(r){return this._data=r,this._pendingWorkerUpdate={data:r},this._updateWorkerData(),this}updateData(r){return this._pendingWorkerUpdate.diff=o.a0(this._pendingWorkerUpdate.diff,r),this._updateWorkerData(),this}getData(){return o._(this,void 0,void 0,function*(){let r=o.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:r})})}getCoordinatesFromGeometry(r){return r.type==="GeometryCollection"?r.geometries.map(u=>u.coordinates).flat(1/0):r.coordinates.flat(1/0)}getBounds(){return o._(this,void 0,void 0,function*(){let r=new Ii,u=yield this.getData(),f;switch(u.type){case"FeatureCollection":f=u.features.map(v=>this.getCoordinatesFromGeometry(v.geometry)).flat(1/0);break;case"Feature":f=this.getCoordinatesFromGeometry(u.geometry);break;default:f=this.getCoordinatesFromGeometry(u)}if(f.length==0)return r;for(let v=0;v<f.length-1;v+=2)r.extend([f[v],f[v+1]]);return r})}setClusterOptions(r){return this.workerOptions.cluster=r.cluster,r&&(r.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(r.clusterRadius)),r.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(r.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(r){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:r,source:this.id}})}getClusterChildren(r){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:r,source:this.id}})}getClusterLeaves(r,u,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:r,limit:u,offset:f}})}_updateWorkerData(){return o._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;let{data:r,diff:u}=this._pendingWorkerUpdate;if(!r&&!u)return void o.w(`No data or diff provided to GeoJSONSource ${this.id}.`);let f=o.e({type:this.type},this.workerOptions);r?(typeof r=="string"?(f.request=this.map._requestManager.transformRequest(C.resolveURL(r),"Source"),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(r),this._pendingWorkerUpdate.data=void 0):u&&(f.dataDiff=u,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new o.l("dataloading",{dataType:"source"}));try{let v=yield this.actor.sendAsync({type:"LD",data:f});if(this._isUpdatingWorker=!1,this._removed||v.abandoned)return void this.fire(new o.l("dataabort",{dataType:"source"}));this._data=v.data;let x=null;v.resourceTiming&&v.resourceTiming[this.id]&&(x=v.resourceTiming[this.id].slice(0));let R={dataType:"source"};this._collectResourceTiming&&x&&x.length>0&&o.e(R,{resourceTiming:x}),this.fire(new o.l("data",Object.assign(Object.assign({},R),{sourceDataType:"metadata"}))),this.fire(new o.l("data",Object.assign(Object.assign({},R),{sourceDataType:"content"})))}catch(v){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new o.l("dataabort",{dataType:"source"}));this.fire(new o.k(v))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}})}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(r){return o._(this,void 0,void 0,function*(){let u=r.actor?"RT":"LT";r.actor=this.actor;let f={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};r.abortController=new AbortController;let v=yield this.actor.sendAsync({type:u,data:f},r.abortController);delete r.abortController,r.unloadVectorData(),r.aborted||r.loadVectorData(v,this.map.painter,u==="RT")})}abortTile(r){return o._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController),r.aborted=!0})}unloadTile(r){return o._(this,void 0,void 0,function*(){r.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:r.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return o.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Go extends o.E{constructor(r,u,f,v){super(),this.flippedWindingOrder=!1,this.id=r,this.dispatcher=f,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=u}load(r){return o._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new o.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{let u=yield Q.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,r&&(this.coordinates=r),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,this.fire(new o.k(u))}})}loaded(){return this._loaded}updateImage(r){return r.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=r.url,this.load(r.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(r){this.coordinates=r;let u=r.map(o.a1.fromLngLat);var f;return this.tileID=function(v){let x=o.a2.fromPoints(v),R=x.width(),T=x.height(),D=Math.max(R,T),k=Math.max(0,Math.floor(-Math.log(D)/Math.LN2)),L=Math.pow(2,k);return new o.a4(k,Math.floor((x.minX+x.maxX)/2*L),Math.floor((x.minY+x.maxY)/2*L))}(u),this.terrainTileRanges=this._getOverlappingTileRanges(u),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=u.map(v=>this.tileID.getTilePoint(v)._round()),this.flippedWindingOrder=((f=this.tileCoords)[1].x-f[0].x)*(f[2].y-f[0].y)-(f[1].y-f[0].y)*(f[2].x-f[0].x)<0,this.fire(new o.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let r=this.map.painter.context,u=r.gl;this.texture||(this.texture=new o.T(r,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(let v in this.tiles){let x=this.tiles[v];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,f=!0)}f&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(r){return o._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={}):r.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(r){let{minX:u,minY:f,maxX:v,maxY:x}=o.a2.fromPoints(r),R={};for(let T=0;T<=o.a3;T++){let D=Math.pow(2,T),k=Math.floor(u*D),L=Math.floor(f*D),H=Math.floor(v*D),B=Math.floor(x*D);R[T]={minTileX:k,minTileY:L,maxTileX:H,maxTileY:B}}return R}}class aa extends Go{constructor(r,u,f,v){super(r,u,f,v),this.roundZoom=!0,this.type="video",this.options=u}load(){return o._(this,void 0,void 0,function*(){this._loaded=!1;let r=this.options;this.urls=[];for(let u of r.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{let u=yield o.a5(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new o.k(u))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){let u=this.video.seekable;r<u.start(0)||r>u.end(0)?this.fire(new o.k(new o.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let r=this.map.painter.context,u=r.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new o.T(r,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(let v in this.tiles){let x=this.tiles[v];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,f=!0)}f&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Rn extends Go{constructor(r,u,f,v){super(r,u,f,v),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(R=>typeof R!="number"))||this.fire(new o.k(new o.a6(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.k(new o.a6(`sources.${r}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new o.k(new o.a6(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new o.k(new o.a6(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.k(new o.a6(`sources.${r}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){return o._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let r=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,r=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,r=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let u=this.map.painter.context,f=u.gl;this.texture?(r||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.T(u,this.canvas,f.RGBA,{premultiply:!0});let v=!1;for(let x in this.tiles){let R=this.tiles[x];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture,v=!0)}v&&this.fire(new o.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}}let En={},Pn=w=>{switch(w){case"geojson":return No;case"image":return Go;case"raster":return Ho;case"raster-dem":return pr;case"vector":return xo;case"video":return aa;case"canvas":return Rn}return En[w]},gr="RTLPluginLoaded";class Mn extends o.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ro()}_syncState(r){return this.status=r,this.dispatcher.broadcast("SRPS",{pluginStatus:r,pluginURL:this.url}).catch(u=>{throw this.status="error",u})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(r){return o._(this,arguments,void 0,function*(u,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=C.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if(this.status==="unavailable"){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return o._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new o.l(gr))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Tn=null;function Dn(){return Tn||(Tn=new Mn),Tn}class la{constructor(r,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=r,this.uid=o.a7(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(r){let u=r+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(r){this.demTexture&&r.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(r,u,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(v,x){let R={};if(!x)return R;for(let T of v){let D=T.layerIds.map(k=>x.getLayer(k)).filter(Boolean);if(D.length!==0){T.layers=D,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(k=>D.filter(L=>L.id===k)[0]));for(let k of D)R[k.id]=T}}return R}(r.buckets,u?.style),this.hasSymbolBuckets=!1;for(let v in this.buckets){let x=this.buckets[v];if(x instanceof o.a9){if(this.hasSymbolBuckets=!0,!f)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let v in this.buckets){let x=this.buckets[v];if(x instanceof o.a9&&x.hasRTLText){this.hasRTLText=!0,Dn().lazyLoad();break}}this.queryPadding=0;for(let v in this.buckets){let x=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(v).queryRadius(x))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new o.a8}unloadVectorData(){for(let r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(r){return this.buckets[r.id]}upload(r){for(let f in this.buckets){let v=this.buckets[f];v.uploadPending()&&v.upload(r)}let u=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new o.T(r,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new o.T(r,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,u,f,v,x,R,T,D,k,L,H){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:x,scale:R,tileSize:this.tileSize,pixelPosMatrix:L,transform:D,params:T,queryPadding:this.queryPadding*k,getElevation:H},r,u,f):{}}querySourceFeatures(r,u){let f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;let v=f.loadVTLayers(),x=u&&u.sourceLayer?u.sourceLayer:"",R=v._geojsonTileLayer||v[x];if(!R)return;let T=o.aa(u?.filter,u?.globalState),{z:D,x:k,y:L}=this.tileID.canonical,H={z:D,x:k,y:L};for(let B=0;B<R.length;B++){let W=R.feature(B);if(T.needGeometry){let te=o.ab(W,!0);if(!T.filter(new o.F(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!T.filter(new o.F(this.tileID.overscaledZ),W))continue;let Z=f.getId(W,x),ee=new o.ac(W,D,k,L,Z);ee.tile=H,r.push(ee)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){let u=this.expirationTime;if(r.cacheControl){let f=o.ad(r.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){let f=Date.now(),v=!1;if(this.expirationTime>f)v=!1;else if(u)if(this.expirationTime<u)v=!0;else{let x=this.expirationTime-u;x?this.expirationTime=f+Math.max(x,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0)return;let f=this.latestFeatureIndex.loadVTLayers();for(let v in this.buckets){if(!u.style.hasLayer(v))continue;let x=this.buckets[v],R=x.layers[0].sourceLayer||"_geojsonTileLayer",T=f[R],D=r[R];if(!T||!D||Object.keys(D).length===0)continue;x.update(D,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});let k=u&&u.style&&u.style.getLayer(v);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<C.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=C.now()+r}setDependencies(r,u){let f={};for(let v of u)f[v]=!0;this.dependencies[r]=f}hasDependency(r,u){for(let f of r){let v=this.dependencies[f];if(v){for(let x of u)if(v[x])return!0}}return!1}}class ye{constructor(r,u){this.max=r,this.onRemove=u,this.reset()}reset(){for(let r in this.data)for(let u of this.data[r])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(r,u,f){let v=r.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);let x={value:u,timeout:void 0};if(f!==void 0&&(x.timeout=setTimeout(()=>{this.remove(r,x)},f)),this.data[v].push(x),this.order.push(v),this.order.length>this.max){let R=this._getAndRemoveByKey(this.order[0]);R&&this.onRemove(R)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){let u=this.data[r].shift();return u.timeout&&clearTimeout(u.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),u.value}getByKey(r){let u=this.data[r];return u?u[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,u){if(!this.has(r))return this;let f=r.wrapped().key,v=u===void 0?0:this.data[f].indexOf(u),x=this.data[f][v];return this.data[f].splice(v,1),x.timeout&&clearTimeout(x.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(x.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){let u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(r){let u=[];for(let f in this.data)for(let v of this.data[f])r(v.value)||u.push(v);for(let f of u)this.remove(f.value.tileID,f)}}class ${constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,u,f){let v=String(u);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][v]=this.stateChanges[r][v]||{},o.e(this.stateChanges[r][v],f),this.deletedStates[r]===null){this.deletedStates[r]={};for(let x in this.state[r])x!==v&&(this.deletedStates[r][x]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][v]===null){this.deletedStates[r][v]={};for(let x in this.state[r][v])f[x]||(this.deletedStates[r][v][x]=null)}else for(let x in f)this.deletedStates[r]&&this.deletedStates[r][v]&&this.deletedStates[r][v][x]===null&&delete this.deletedStates[r][v][x]}removeFeatureState(r,u,f){if(this.deletedStates[r]===null)return;let v=String(u);if(this.deletedStates[r]=this.deletedStates[r]||{},f&&u!==void 0)this.deletedStates[r][v]!==null&&(this.deletedStates[r][v]=this.deletedStates[r][v]||{},this.deletedStates[r][v][f]=null);else if(u!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][v])for(f in this.deletedStates[r][v]={},this.stateChanges[r][v])this.deletedStates[r][v][f]=null;else this.deletedStates[r][v]=null;else this.deletedStates[r]=null}getState(r,u){let f=String(u),v=o.e({},(this.state[r]||{})[f],(this.stateChanges[r]||{})[f]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){let x=this.deletedStates[r][u];if(x===null)return{};for(let R in x)delete v[R]}return v}initializeTileState(r,u){r.setFeatureState(this.state,u)}coalesceChanges(r,u){let f={};for(let v in this.stateChanges){this.state[v]=this.state[v]||{};let x={};for(let R in this.stateChanges[v])this.state[v][R]||(this.state[v][R]={}),o.e(this.state[v][R],this.stateChanges[v][R]),x[R]=this.state[v][R];f[v]=x}for(let v in this.deletedStates){this.state[v]=this.state[v]||{};let x={};if(this.deletedStates[v]===null)for(let R in this.state[v])x[R]={},this.state[v][R]={};else for(let R in this.deletedStates[v]){if(this.deletedStates[v][R]===null)this.state[v][R]={};else for(let T of Object.keys(this.deletedStates[v][R]))delete this.state[v][R][T];x[R]=this.state[v][R]}f[v]=f[v]||{},o.e(f[v],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(let v in r)r[v].setFeatureState(f,u)}}let q=89.25;function Y(w,r){let u=o.ah(r.lat,-o.ai,o.ai);return new o.P(o.V(r.lng)*w,o.U(u)*w)}function he(w,r){return new o.a1(r.x/w,r.y/w).toLngLat()}function de(w){return w.cameraToCenterDistance*Math.min(.85*Math.tan(o.ae(90-w.pitch)),Math.tan(o.ae(q-w.pitch)))}function ve(w,r){let u=w.canonical,f=r/o.af(u.z),v=u.x+Math.pow(2,u.z)*w.wrap,x=o.ag(new Float64Array(16));return o.M(x,x,[v*f,u.y*f,0]),o.N(x,x,[f/o.$,f/o.$,1]),x}function Me(w,r,u,f,v){let x=o.a1.fromLngLat(w,r),R=v*o.aj(1,w.lat),T=R*Math.cos(o.ae(u)),D=Math.sqrt(R*R-T*T),k=D*Math.sin(o.ae(-f)),L=D*Math.cos(o.ae(-f));return new o.a1(x.x+k,x.y+L,x.z+T)}function be(w,r,u){let f=r.intersectsFrustum(w);if(!u||f===0)return f;let v=r.intersectsPlane(u);return v===0?0:f===2&&v===2?2:1}function ke(w,r,u){let f=0,v=(u-r)/10;for(let x=0;x<10;x++)f+=v*Math.pow(Math.cos(r+(x+.5)/10*(u-r)),w);return f}function Ue(w,r){return function(u,f,v,x,R){let T=2*((w-1)/o.ak(Math.cos(o.ae(q-R))/Math.cos(o.ae(q)))-1),D=Math.acos(v/x),k=2*ke(T-1,0,o.ae(R/2)),L=Math.min(o.ae(q),D+o.ae(R/2)),H=ke(T-1,Math.min(L,D-o.ae(R/2)),L),B=Math.atan(f/v),W=Math.hypot(f,v),Z=u;return Z+=o.ak(x/W/Math.max(.5,Math.cos(o.ae(R/2)))),Z+=T*o.ak(Math.cos(B))/2,Z-=o.ak(Math.max(1,H/k/r))/2,Z}}let Ve=Ue(9.314,3);function ct(w,r){let u=(r.roundZoom?Math.round:Math.floor)(w.zoom+o.ak(w.tileSize/r.tileSize));return Math.max(0,u)}function xe(w,r){let u=w.getCameraFrustum(),f=w.getClippingPlane(),v=w.screenPointToMercatorCoordinate(w.getCameraPoint()),x=o.a1.fromLngLat(w.center,w.elevation);v.z=x.z+Math.cos(w.pitchInRadians)*w.cameraToCenterDistance/w.worldSize;let R=w.getCoveringTilesDetailsProvider(),T=R.allowVariableZoom(w,r),D=ct(w,r),k=r.minzoom||0,L=r.maxzoom!==void 0?r.maxzoom:w.maxZoom,H=Math.min(Math.max(0,D),L),B=Math.pow(2,H),W=[B*v.x,B*v.y,0],Z=[B*x.x,B*x.y,0],ee=Math.hypot(x.x-v.x,x.y-v.y),te=Math.abs(x.z-v.z),ie=Math.hypot(ee,te),oe=ue=>({zoom:0,x:0,y:0,wrap:ue,fullyVisible:!1}),le=[],ne=[];if(w.renderWorldCopies&&R.allowWorldCopies())for(let ue=1;ue<=3;ue++)le.push(oe(-ue)),le.push(oe(ue));for(le.push(oe(0));le.length>0;){let ue=le.pop(),ge=ue.x,re=ue.y,we=ue.fullyVisible,Te={x:ge,y:re,z:ue.zoom},Re=R.getTileBoundingVolume(Te,ue.wrap,w.elevation,r);if(!we){let Ze=be(u,Re,f);if(Ze===0)continue;we=Ze===2}let Ee=R.distanceToTile2d(v.x,v.y,Te,Re),De=D;T&&(De=(r.calculateTileZoom||Ve)(w.zoom+o.ak(w.tileSize/r.tileSize),Ee,te,ie,w.fov)),De=(r.roundZoom?Math.round:Math.floor)(De),De=Math.max(0,De);let Ke=Math.min(De,L);if(ue.wrap=R.getWrap(x,Te,ue.wrap),ue.zoom>=Ke){if(ue.zoom<k)continue;let Ze=H-ue.zoom,He=W[0]-.5-(ge<<Ze),ut=W[1]-.5-(re<<Ze),It=r.reparseOverscaled?Math.max(ue.zoom,De):ue.zoom;ne.push({tileID:new o.Z(ue.zoom===L?It:ue.zoom,ue.wrap,ue.zoom,ge,re),distanceSq:o.al([Z[0]-.5-ge,Z[1]-.5-re]),tileDistanceToCamera:Math.sqrt(He*He+ut*ut)})}else for(let Ze=0;Ze<4;Ze++)le.push({zoom:ue.zoom+1,x:(ge<<1)+Ze%2,y:(re<<1)+(Ze>>1),wrap:ue.wrap,fullyVisible:we})}return ne.sort((ue,ge)=>ue.distanceSq-ge.distanceSq).map(ue=>ue.tileID)}let Rt=o.a2.fromPoints([new o.P(0,0),new o.P(o.$,o.$)]);class zt extends o.E{constructor(r,u,f){super(),this.id=r,this.dispatcher=f,this.on("data",v=>this._dataHandler(v)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((v,x,R,T)=>{let D=new(Pn(x.type))(v,x,R,T);if(D.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${D.id}`);return D})(r,u,f,this),this._tiles={},this._cache=new ye(0,v=>this._unloadTile(v)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new $,this._didEmitContent=!1,this._updated=!1}onAdd(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._maxTileCacheZoomLevels=r?r._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(r)}onRemove(r){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(r)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(let r in this._tiles){let u=this._tiles[r];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(r,u,f){return o._(this,void 0,void 0,function*(){try{yield this._source.loadTile(r),this._tileLoaded(r,u,f)}catch(v){r.state="errored",v.status!==404?this._source.fire(new o.k(v,{tile:r})):this.update(this.transform,this.terrain)}})}_unloadTile(r){this._source.unloadTile&&this._source.unloadTile(r)}_abortTile(r){this._source.abortTile&&this._source.abortTile(r),this._source.fire(new o.l("dataabort",{tile:r,coord:r.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let u in this._tiles){let f=this._tiles[u];f.upload(r),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort(ft).map(r=>r.key)}getRenderableIds(r){let u=[];for(let f in this._tiles)this._isIdRenderable(f,r)&&u.push(this._tiles[f]);return r?u.sort((f,v)=>{let x=f.tileID,R=v.tileID,T=new o.P(x.canonical.x,x.canonical.y)._rotate(-this.transform.bearingInRadians),D=new o.P(R.canonical.x,R.canonical.y)._rotate(-this.transform.bearingInRadians);return x.overscaledZ-R.overscaledZ||D.y-T.y||D.x-T.x}).map(f=>f.tileID.key):u.map(f=>f.tileID).sort(ft).map(f=>f.key)}hasRenderableParent(r){let u=this.findLoadedParent(r,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(r,u){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(u||!this._tiles[r].holdingForFade())}reload(r){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let u in this._tiles)r?this._reloadTile(u,"expired"):this._tiles[u].state!=="errored"&&this._reloadTile(u,"reloading")}}_reloadTile(r,u){return o._(this,void 0,void 0,function*(){let f=this._tiles[r];f&&(f.state!=="loading"&&(f.state=u),yield this._loadTile(f,r,u))})}_tileLoaded(r,u,f){r.timeAdded=C.now(),f==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(u,r),this.getSource().type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),r.aborted||this._source.fire(new o.l("data",{dataType:"source",tile:r,coord:r.tileID}))}_backfillDEM(r){let u=this.getRenderableIds();for(let v=0;v<u.length;v++){let x=u[v];if(r.neighboringTiles&&r.neighboringTiles[x]){let R=this.getTileByID(x);f(r,R),f(R,r)}}function f(v,x){v.needsHillshadePrepare=!0,v.needsTerrainPrepare=!0;let R=x.tileID.canonical.x-v.tileID.canonical.x,T=x.tileID.canonical.y-v.tileID.canonical.y,D=Math.pow(2,v.tileID.canonical.z),k=x.tileID.key;R===0&&T===0||Math.abs(T)>1||(Math.abs(R)>1&&(Math.abs(R+D)===1?R+=D:Math.abs(R-D)===1&&(R-=D)),x.dem&&v.dem&&(v.dem.backfillBorder(x.dem,R,T),v.neighboringTiles&&v.neighboringTiles[k]&&(v.neighboringTiles[k].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,u){let f=Object.values(r),v=this._getLoadedDescendents(f);for(let x of f){let R=v[x.key];if(!R)continue;let T=x.overscaledZ+zt.maxUnderzooming,D=1/0;for(let k of R){let L=k.tileID.overscaledZ;L<=T&&L<D&&(D=L)}if(D!==1/0)for(let k of R)k.tileID.overscaledZ===D&&(u[k.tileID.key]=k.tileID)}}_getLoadedDescendents(r){var u;let f={};for(let v in this._tiles){let x=this._tiles[v];if(x.hasData())for(let R of r)x.tileID.isChildOf(R)&&(f[u=R.key]||(f[u]=[])).push(x)}return f}findLoadedParent(r,u){if(r.key in this._loadedParentTiles){let f=this._loadedParentTiles[r.key];return f&&f.tileID.overscaledZ>=u?f:null}for(let f=r.overscaledZ-1;f>=u;f--){let v=r.scaledTo(f),x=this._getLoadedTile(v);if(x)return x}}findLoadedSibling(r){return this._getLoadedTile(r)}_getLoadedTile(r){let u=this._tiles[r.key];return u&&u.hasData()?u:this._cache.getByKey(r.wrapped().key)}updateCacheSize(r){let u=Math.ceil(r.width/this._source.tileSize)+1,f=Math.ceil(r.height/this._source.tileSize)+1,v=Math.floor(u*f*(this._maxTileCacheZoomLevels===null?o.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(x)}handleWrapJump(r){let u=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,u){let f={};for(let v in this._tiles){let x=this._tiles[v];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+u),f[x.tileID.key]=x}this._tiles=f;for(let v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(let v in this._tiles)this._setTileReloadTimer(v,this._tiles[v])}}_updateCoveredAndRetainedTiles(r,u,f,v){let x={},R={},T=Object.keys(r),D=C.now();for(let k of T){let L=r[k],H=this._tiles[k];if(!H||H.fadeEndTime!==0&&H.fadeEndTime<=D)continue;let B=this.findLoadedParent(L,u),W=this.findLoadedSibling(L),Z=B||W||null;Z&&(this._addTile(Z.tileID),x[Z.tileID.key]=Z.tileID),R[k]=L}this._retainLoadedChildren(R,r);for(let k in x)r[k]||(this._coveredTiles[k]=!0,r[k]=x[k]);if(v){let k={},L={};for(let H of f)this._tiles[H.key].hasData()?k[H.key]=H:L[H.key]=H;for(let H in L){let B=L[H].children(this._source.maxzoom);this._tiles[B[0].key]&&this._tiles[B[1].key]&&this._tiles[B[2].key]&&this._tiles[B[3].key]&&(k[B[0].key]=r[B[0].key]=B[0],k[B[1].key]=r[B[1].key]=B[1],k[B[2].key]=r[B[2].key]=B[2],k[B[3].key]=r[B[3].key]=B[3],delete L[H])}for(let H in L){let B=L[H],W=this.findLoadedParent(B,this._source.minzoom),Z=this.findLoadedSibling(B),ee=W||Z||null;if(ee){k[ee.tileID.key]=r[ee.tileID.key]=ee.tileID;for(let te in k)k[te].isChildOf(ee.tileID)&&delete k[te]}}for(let H in this._tiles)k[H]||(this._coveredTiles[H]=!0)}}update(r,u){if(!this._sourceLoaded||this._paused)return;let f;this.transform=r,this.terrain=u,this.updateCacheSize(r),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new o.Z(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(f=xe(r,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(f=f.filter(k=>this._source.hasTile(k)))):f=[];let v=ct(r,this._source),x=Math.max(v-zt.maxOverzooming,this._source.minzoom);if(this.usedForTerrain){let k={};for(let L of f)if(L.canonical.z>this._source.minzoom){let H=L.scaledTo(L.canonical.z-1);k[H.key]=H;let B=L.scaledTo(Math.max(this._source.minzoom,Math.min(L.canonical.z,5)));k[B.key]=B}f=f.concat(Object.values(k))}let R=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,R&&this.fire(new o.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let T=this._updateRetainedTiles(f,v);Tt(this._source.type)&&this._updateCoveredAndRetainedTiles(T,x,f,u);for(let k in T)this._tiles[k].clearFadeHold();let D=o.am(this._tiles,T);for(let k of D){let L=this._tiles[k];L.hasSymbolBuckets&&!L.holdingForFade()?L.setHoldDuration(this.map._fadeDuration):L.hasSymbolBuckets&&!L.symbolFadeFinished()||this._removeTile(k)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(let r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)}_updateRetainedTiles(r,u){var f;let v={},x={},R=Math.max(u-zt.maxOverzooming,this._source.minzoom),T={};for(let D of r){let k=this._addTile(D);v[D.key]=D,k.hasData()||u<this._source.maxzoom&&(T[D.key]=D)}this._retainLoadedChildren(T,v);for(let D of r){let k=this._tiles[D.key];if(k.hasData())continue;if(u+1>this._source.maxzoom){let H=D.children(this._source.maxzoom)[0],B=this.getTile(H);if(B&&B.hasData()){v[H.key]=H;continue}}else{let H=D.children(this._source.maxzoom);if(H.length===4&&v[H[0].key]&&v[H[1].key]&&v[H[2].key]&&v[H[3].key]||H.length===1&&v[H[0].key])continue}let L=k.wasRequested();for(let H=D.overscaledZ-1;H>=R;--H){let B=D.scaledTo(H);if(x[B.key])break;if(x[B.key]=!0,k=this.getTile(B),!k&&L&&(k=this._addTile(B)),k){let W=k.hasData();if((W||!(!((f=this.map)===null||f===void 0)&&f.cancelPendingTileRequestsWhileZooming)||L)&&(v[B.key]=B),L=k.wasRequested(),W)break}}}return v}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let r in this._tiles){let u=[],f,v=this._tiles[r].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){f=this._loadedParentTiles[v.key];break}u.push(v.key);let x=v.scaledTo(v.overscaledZ-1);if(f=this._getLoadedTile(x),f)break;v=x}for(let x of u)this._loadedParentTiles[x]=f}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(let r in this._tiles){let u=this._tiles[r].tileID,f=this._getLoadedTile(u);this._loadedSiblingTiles[u.key]=f}}_addTile(r){let u=this._tiles[r.key];if(u)return u;u=this._cache.getAndRemove(r),u&&(this._setTileReloadTimer(r.key,u),u.tileID=r,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,u)));let f=u;return u||(u=new la(r,this._source.tileSize*r.overscaleFactor()),this._loadTile(u,r.key,u.state)),u.uses++,this._tiles[r.key]=u,f||this._source.fire(new o.l("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(r,u){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);let f=u.getExpiryTimeout();f&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},f))}refreshTiles(r){for(let u in this._tiles)(this._isIdRenderable(u)||this._tiles[u].state=="errored")&&r.some(f=>f.equals(this._tiles[u].tileID.canonical))&&this._reloadTile(u,"expired")}_removeTile(r){let u=this._tiles[r];u&&(u.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(r){let u=r.sourceDataType;r.dataType==="source"&&u==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&r.dataType==="source"&&u==="content"&&(this.reload(r.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let r in this._tiles)this._removeTile(r);this._cache.reset()}tilesIn(r,u,f){let v=[],x=this.transform;if(!x)return v;let R=x.getCoveringTilesDetailsProvider().allowWorldCopies(),T=f?x.getCameraQueryGeometry(r):r,D=W=>x.screenPointToMercatorCoordinate(W,this.terrain),k=this.transformBbox(r,D,!R),L=this.transformBbox(T,D,!R),H=this.getIds(),B=o.a2.fromPoints(L);for(let W=0;W<H.length;W++){let Z=this._tiles[H[W]];if(Z.holdingForFade())continue;let ee=R?[Z.tileID]:[Z.tileID.unwrapTo(-1),Z.tileID.unwrapTo(0)],te=Math.pow(2,x.zoom-Z.tileID.overscaledZ),ie=u*Z.queryPadding*o.$/Z.tileSize/te;for(let oe of ee){let le=B.map(ne=>oe.getTilePoint(new o.a1(ne.x,ne.y)));if(le.expandBy(ie),le.intersects(Rt)){let ne=k.map(ge=>oe.getTilePoint(ge)),ue=L.map(ge=>oe.getTilePoint(ge));v.push({tile:Z,tileID:R?oe:oe.unwrapTo(0),queryGeometry:ne,cameraQueryGeometry:ue,scale:te})}}}return v}transformBbox(r,u,f){let v=r.map(u);if(f){let x=o.a2.fromPoints(r);x.shrinkBy(.001*Math.min(x.width(),x.height()));let R=x.map(u);o.a2.fromPoints(v).covers(R)||(v=v.map(T=>T.x>.5?new o.a1(T.x-1,T.y,T.z):T))}return v}getVisibleCoordinates(r){let u=this.getRenderableIds(r).map(f=>this._tiles[f].tileID);return this.transform&&this.transform.populateCache(u),u}hasTransition(){if(this._source.hasTransition())return!0;if(Tt(this._source.type)){let r=C.now();for(let u in this._tiles)if(this._tiles[u].fadeEndTime>=r)return!0}return!1}setFeatureState(r,u,f){this._state.updateState(r=r||"_geojsonTileLayer",u,f)}removeFeatureState(r,u,f){this._state.removeFeatureState(r=r||"_geojsonTileLayer",u,f)}getFeatureState(r,u){return this._state.getState(r=r||"_geojsonTileLayer",u)}setDependencies(r,u,f){let v=this._tiles[r];v&&v.setDependencies(u,f)}reloadTilesForDependencies(r,u){for(let f in this._tiles)this._tiles[f].hasDependency(r,u)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(r,u))}}function ft(w,r){let u=Math.abs(2*w.wrap)-+(w.wrap<0),f=Math.abs(2*r.wrap)-+(r.wrap<0);return w.overscaledZ-r.overscaledZ||f-u||r.canonical.y-w.canonical.y||r.canonical.x-w.canonical.x}function Tt(w){return w==="raster"||w==="image"||w==="video"}zt.maxOverzooming=10,zt.maxUnderzooming=3;class ci{constructor(r,u){this.reset(r,u)}reset(r,u){this.points=r||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=o.ah(r,0,1);let u=1,f=this._distances[u],v=r*this.paddedLength+this.padding;for(;f<v&&u<this._distances.length;)f=this._distances[++u];let x=u-1,R=this._distances[x],T=f-R,D=T>0?(v-R)/T:0;return this.points[x].mult(1-D).add(this.points[u].mult(D))}}function Ji(w,r){let u=!0;return w==="always"||w!=="never"&&r!=="never"||(u=!1),u}class es{constructor(r,u,f){let v=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(r/f),this.yCellCount=Math.ceil(u/f);for(let R=0;R<this.xCellCount*this.yCellCount;R++)v.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=u,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,u,f,v,x){this._forEachCell(u,f,v,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(v),this.bboxes.push(x)}insertCircle(r,u,f,v){this._forEachCell(u-v,f-v,u+v,f+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(u),this.circles.push(f),this.circles.push(v)}_insertBoxCell(r,u,f,v,x,R){this.boxCells[x].push(R)}_insertCircleCell(r,u,f,v,x,R){this.circleCells[x].push(R)}_query(r,u,f,v,x,R,T){if(f<0||r>this.width||v<0||u>this.height)return[];let D=[];if(r<=0&&u<=0&&this.width<=f&&this.height<=v){if(x)return[{key:null,x1:r,y1:u,x2:f,y2:v}];for(let k=0;k<this.boxKeys.length;k++)D.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){let L=this.circles[3*k],H=this.circles[3*k+1],B=this.circles[3*k+2];D.push({key:this.circleKeys[k],x1:L-B,y1:H-B,x2:L+B,y2:H+B})}}else this._forEachCell(r,u,f,v,this._queryCell,D,{hitTest:x,overlapMode:R,seenUids:{box:{},circle:{}}},T);return D}query(r,u,f,v){return this._query(r,u,f,v,!1,null)}hitTest(r,u,f,v,x,R){return this._query(r,u,f,v,!0,x,R).length>0}hitTestCircle(r,u,f,v,x){let R=r-f,T=r+f,D=u-f,k=u+f;if(T<0||R>this.width||k<0||D>this.height)return!1;let L=[];return this._forEachCell(R,D,T,k,this._queryCellCircle,L,{hitTest:!0,overlapMode:v,circle:{x:r,y:u,radius:f},seenUids:{box:{},circle:{}}},x),L.length>0}_queryCell(r,u,f,v,x,R,T,D){let{seenUids:k,hitTest:L,overlapMode:H}=T,B=this.boxCells[x];if(B!==null){let Z=this.bboxes;for(let ee of B)if(!k.box[ee]){k.box[ee]=!0;let te=4*ee,ie=this.boxKeys[ee];if(r<=Z[te+2]&&u<=Z[te+3]&&f>=Z[te+0]&&v>=Z[te+1]&&(!D||D(ie))&&(!L||!Ji(H,ie.overlapMode))&&(R.push({key:ie,x1:Z[te],y1:Z[te+1],x2:Z[te+2],y2:Z[te+3]}),L))return!0}}let W=this.circleCells[x];if(W!==null){let Z=this.circles;for(let ee of W)if(!k.circle[ee]){k.circle[ee]=!0;let te=3*ee,ie=this.circleKeys[ee];if(this._circleAndRectCollide(Z[te],Z[te+1],Z[te+2],r,u,f,v)&&(!D||D(ie))&&(!L||!Ji(H,ie.overlapMode))){let oe=Z[te],le=Z[te+1],ne=Z[te+2];if(R.push({key:ie,x1:oe-ne,y1:le-ne,x2:oe+ne,y2:le+ne}),L)return!0}}}return!1}_queryCellCircle(r,u,f,v,x,R,T,D){let{circle:k,seenUids:L,overlapMode:H}=T,B=this.boxCells[x];if(B!==null){let Z=this.bboxes;for(let ee of B)if(!L.box[ee]){L.box[ee]=!0;let te=4*ee,ie=this.boxKeys[ee];if(this._circleAndRectCollide(k.x,k.y,k.radius,Z[te+0],Z[te+1],Z[te+2],Z[te+3])&&(!D||D(ie))&&!Ji(H,ie.overlapMode))return R.push(!0),!0}}let W=this.circleCells[x];if(W!==null){let Z=this.circles;for(let ee of W)if(!L.circle[ee]){L.circle[ee]=!0;let te=3*ee,ie=this.circleKeys[ee];if(this._circlesCollide(Z[te],Z[te+1],Z[te+2],k.x,k.y,k.radius)&&(!D||D(ie))&&!Ji(H,ie.overlapMode))return R.push(!0),!0}}}_forEachCell(r,u,f,v,x,R,T,D){let k=this._convertToXCellCoord(r),L=this._convertToYCellCoord(u),H=this._convertToXCellCoord(f),B=this._convertToYCellCoord(v);for(let W=k;W<=H;W++)for(let Z=L;Z<=B;Z++)if(x.call(this,r,u,f,v,this.xCellCount*Z+W,R,T,D))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,u,f,v,x,R){let T=v-r,D=x-u,k=f+R;return k*k>T*T+D*D}_circleAndRectCollide(r,u,f,v,x,R,T){let D=(R-v)/2,k=Math.abs(r-(v+D));if(k>D+f)return!1;let L=(T-x)/2,H=Math.abs(u-(x+L));if(H>L+f)return!1;if(k<=D||H<=L)return!0;let B=k-D,W=H-L;return B*B+W*W<=f*f}}function Hi(w,r,u){let f=o.L();if(!w){let{vecSouth:H,vecEast:B}=Wt(r),W=d();W[0]=B[0],W[1]=B[1],W[2]=H[0],W[3]=H[1],v=W,(L=(R=(x=W)[0])*(k=x[3])-(D=x[2])*(T=x[1]))&&(v[0]=k*(L=1/L),v[1]=-T*L,v[2]=-D*L,v[3]=R*L),f[0]=W[0],f[1]=W[1],f[4]=W[2],f[5]=W[3]}var v,x,R,T,D,k,L;return o.N(f,f,[1/u,1/u,1]),f}function Bt(w,r,u,f){if(w){let v=o.L();if(!r){let{vecSouth:x,vecEast:R}=Wt(u);v[0]=R[0],v[1]=R[1],v[4]=x[0],v[5]=x[1]}return o.N(v,v,[f,f,1]),v}return u.pixelsToClipSpaceMatrix}function Wt(w){let r=Math.cos(w.rollInRadians),u=Math.sin(w.rollInRadians),f=Math.cos(w.pitchInRadians),v=Math.cos(w.bearingInRadians),x=Math.sin(w.bearingInRadians),R=o.ar();R[0]=-v*f*u-x*r,R[1]=-x*f*u+v*r;let T=o.as(R);T<1e-9?o.at(R):o.au(R,R,1/T);let D=o.ar();D[0]=v*f*r-x*u,D[1]=x*f*r+v*u;let k=o.as(D);return k<1e-9?o.at(D):o.au(D,D,1/k),{vecEast:D,vecSouth:R}}function qi(w,r,u,f){let v;f?(v=[w,r,f(w,r),1],o.aw(v,v,u)):(v=[w,r,0,1],ha(v,v,u));let x=v[3];return{point:new o.P(v[0]/x,v[1]/x),signedDistanceFromCamera:x,isOccluded:!1}}function $e(w,r){return .5+w/r*.5}function bs(w,r){return w.x>=-r[0]&&w.x<=r[0]&&w.y>=-r[1]&&w.y<=r[1]}function Ei(w,r,u,f,v,x,R,T,D,k,L,H,B){let W=u?w.textSizeData:w.iconSizeData,Z=o.an(W,r.transform.zoom),ee=[256/r.width*2+1,256/r.height*2+1],te=u?w.text.dynamicLayoutVertexArray:w.icon.dynamicLayoutVertexArray;te.clear();let ie=w.lineVertexArray,oe=u?w.text.placedSymbolArray:w.icon.placedSymbolArray,le=r.transform.width/r.transform.height,ne=!1;for(let ue=0;ue<oe.length;ue++){let ge=oe.get(ue);if(ge.hidden||ge.writingMode===o.ao.vertical&&!ne){Wo(ge.numGlyphs,te);continue}ne=!1;let re=new o.P(ge.anchorX,ge.anchorY),we={getElevation:B,pitchedLabelPlaneMatrix:f,lineVertexArray:ie,pitchWithMap:x,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:r.transform,tileAnchorPoint:re,unwrappedTileID:D,width:k,height:L,translation:H},Te=In(ge.anchorX,ge.anchorY,we);if(!bs(Te.point,ee)){Wo(ge.numGlyphs,te);continue}let Re=$e(r.transform.cameraToCenterDistance,Te.signedDistanceFromCamera),Ee=o.ap(W,Z,ge),De=x?Ee*r.transform.getPitchedTextCorrection(ge.anchorX,ge.anchorY,D)/Re:Ee*Re,Ke=tt({projectionContext:we,pitchedLabelPlaneMatrixInverse:v,symbol:ge,fontSize:De,flip:!1,keepUpright:R,glyphOffsetArray:w.glyphOffsetArray,dynamicLayoutVertexArray:te,aspectRatio:le,rotateToLine:T});ne=Ke.useVertical,(Ke.notEnoughRoom||ne||Ke.needsFlipping&&tt({projectionContext:we,pitchedLabelPlaneMatrixInverse:v,symbol:ge,fontSize:De,flip:!0,keepUpright:R,glyphOffsetArray:w.glyphOffsetArray,dynamicLayoutVertexArray:te,aspectRatio:le,rotateToLine:T}).notEnoughRoom)&&Wo(ge.numGlyphs,te)}u?w.text.dynamicLayoutVertexBuffer.updateData(te):w.icon.dynamicLayoutVertexBuffer.updateData(te)}function Fn(w,r,u,f,v,x,R,T){let D=x.glyphStartIndex+x.numGlyphs,k=x.lineStartIndex,L=x.lineStartIndex+x.lineLength,H=r.getoffsetX(x.glyphStartIndex),B=r.getoffsetX(D-1),W=kn(w*H,u,f,v,x.segment,k,L,T,R);if(!W)return null;let Z=kn(w*B,u,f,v,x.segment,k,L,T,R);return Z?T.projectionCache.anyProjectionOccluded?null:{first:W,last:Z}:null}function ca(w,r,u,f){return w===o.ao.horizontal&&Math.abs(u.y-r.y)>Math.abs(u.x-r.x)*f?{useVertical:!0}:(w===o.ao.vertical?r.y<u.y:r.x>u.x)?{needsFlipping:!0}:null}function tt(w){let{projectionContext:r,pitchedLabelPlaneMatrixInverse:u,symbol:f,fontSize:v,flip:x,keepUpright:R,glyphOffsetArray:T,dynamicLayoutVertexArray:D,aspectRatio:k,rotateToLine:L}=w,H=v/24,B=f.lineOffsetX*H,W=f.lineOffsetY*H,Z;if(f.numGlyphs>1){let ee=f.glyphStartIndex+f.numGlyphs,te=f.lineStartIndex,ie=f.lineStartIndex+f.lineLength,oe=Fn(H,T,B,W,x,f,L,r);if(!oe)return{notEnoughRoom:!0};let le=fr(oe.first.point.x,oe.first.point.y,r,u),ne=fr(oe.last.point.x,oe.last.point.y,r,u);if(R&&!x){let ue=ca(f.writingMode,le,ne,k);if(ue)return ue}Z=[oe.first];for(let ue=f.glyphStartIndex+1;ue<ee-1;ue++){let ge=kn(H*T.getoffsetX(ue),B,W,x,f.segment,te,ie,r,L);if(!ge)return{notEnoughRoom:!0};Z.push(ge)}Z.push(oe.last)}else{if(R&&!x){let te=fs(r.tileAnchorPoint.x,r.tileAnchorPoint.y,r).point,ie=f.lineStartIndex+f.segment+1,oe=new o.P(r.lineVertexArray.getx(ie),r.lineVertexArray.gety(ie)),le=fs(oe.x,oe.y,r),ne=le.signedDistanceFromCamera>0?le.point:At(r.tileAnchorPoint,oe,te,1,r),ue=fr(te.x,te.y,r,u),ge=fr(ne.x,ne.y,r,u),re=ca(f.writingMode,ue,ge,k);if(re)return re}let ee=kn(H*T.getoffsetX(f.glyphStartIndex),B,W,x,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,r,L);if(!ee||r.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Z=[ee]}for(let ee of Z)o.av(D,ee.point,ee.angle);return{}}function At(w,r,u,f,v){let x=w.add(w.sub(r)._unit()),R=fs(x.x,x.y,v).point,T=u.sub(R);return u.add(T._mult(f/T.mag()))}function Ft(w,r,u){let f=r.projectionCache;if(f.projections[w])return f.projections[w];let v=new o.P(r.lineVertexArray.getx(w),r.lineVertexArray.gety(w)),x=fs(v.x,v.y,r);if(x.signedDistanceFromCamera>0)return f.projections[w]=x.point,f.anyProjectionOccluded=f.anyProjectionOccluded||x.isOccluded,x.point;let R=w-u.direction;return At(u.distanceFromAnchor===0?r.tileAnchorPoint:new o.P(r.lineVertexArray.getx(R),r.lineVertexArray.gety(R)),v,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,r)}function fs(w,r,u){let f=w+u.translation[0],v=r+u.translation[1],x;return u.pitchWithMap?(x=qi(f,v,u.pitchedLabelPlaneMatrix,u.getElevation),x.isOccluded=!1):(x=u.transform.projectTileCoordinates(f,v,u.unwrappedTileID,u.getElevation),x.point.x=(.5*x.point.x+.5)*u.width,x.point.y=(.5*-x.point.y+.5)*u.height),x}function fr(w,r,u,f){if(u.pitchWithMap){let v=[w,r,0,1];return o.aw(v,v,f),u.transform.projectTileCoordinates(v[0]/v[3],v[1]/v[3],u.unwrappedTileID,u.getElevation).point}return{x:w/u.width*2-1,y:1-r/u.height*2}}function In(w,r,u){return u.transform.projectTileCoordinates(w,r,u.unwrappedTileID,u.getElevation)}function Dt(w,r,u){return w._unit()._perp()._mult(r*u)}function xc(w,r,u,f,v,x,R,T,D){if(T.projectionCache.offsets[w])return T.projectionCache.offsets[w];let k=u.add(r);if(w+D.direction<f||w+D.direction>=v)return T.projectionCache.offsets[w]=k,k;let L=Ft(w+D.direction,T,D),H=Dt(L.sub(u),R,D.direction),B=u.add(H),W=L.add(H);return T.projectionCache.offsets[w]=o.ax(x,k,B,W)||k,T.projectionCache.offsets[w]}function kn(w,r,u,f,v,x,R,T,D){let k=f?w-r:w+r,L=k>0?1:-1,H=0;f&&(L*=-1,H=Math.PI),L<0&&(H+=Math.PI);let B,W=L>0?x+v:x+v+1;T.projectionCache.cachedAnchorPoint?B=T.projectionCache.cachedAnchorPoint:(B=fs(T.tileAnchorPoint.x,T.tileAnchorPoint.y,T).point,T.projectionCache.cachedAnchorPoint=B);let Z,ee,te=B,ie=B,oe=0,le=0,ne=Math.abs(k),ue=[],ge;for(;oe+le<=ne;){if(W+=L,W<x||W>=R)return null;oe+=le,ie=te,ee=Z;let Te={absOffsetX:ne,direction:L,distanceFromAnchor:oe,previousVertex:ie};if(te=Ft(W,T,Te),u===0)ue.push(ie),ge=te.sub(ie);else{let Re,Ee=te.sub(ie);Re=Ee.mag()===0?Dt(Ft(W+L,T,Te).sub(te),u,L):Dt(Ee,u,L),ee||(ee=ie.add(Re)),Z=xc(W,Re,te,x,R,ee,u,T,Te),ue.push(ee),ge=Z.sub(ee)}le=ge.mag()}let re=ge._mult((ne-oe)/le)._add(ee||ie),we=H+Math.atan2(te.y-ie.y,te.x-ie.x);return ue.push(re),{point:re,angle:D?we:0,path:ue}}let _c=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Wo(w,r){for(let u=0;u<w;u++){let f=r.length;r.resize(f+4),r.float32.set(_c,3*f)}}function ha(w,r,u){let f=r[0],v=r[1];return w[0]=u[0]*f+u[4]*v+u[12],w[1]=u[1]*f+u[5]*v+u[13],w[3]=u[3]*f+u[7]*v+u[15],w}let ki=100;class Sc{constructor(r,u=new es(r.width+200,r.height+200,25),f=new es(r.width+200,r.height+200,25)){this.transform=r,this.grid=u,this.ignoredGrid=f,this.pitchFactor=Math.cos(r.pitch*Math.PI/180)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+ki,this.screenBottomBoundary=r.height+ki,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(r,u,f,v,x,R,T,D,k,L,H,B){let W=this.projectAndGetPerspectiveRatio(r.anchorPointX+D[0],r.anchorPointY+D[1],x,L,B),Z=f*W.perspectiveRatio,ee;if(R||T)ee=this._projectCollisionBox(r,Z,v,x,R,T,D,W,L,H,B);else{let ge=W.x+(H?H.x*Z:0),re=W.y+(H?H.y*Z:0);ee={allPointsOccluded:!1,box:[ge+r.x1*Z,re+r.y1*Z,ge+r.x2*Z,re+r.y2*Z]}}let[te,ie,oe,le]=ee.box,ne=R?ee.allPointsOccluded:W.isOccluded,ue=ne;return ue||(ue=W.perspectiveRatio<this.perspectiveRatioCutoff),ue||(ue=!this.isInsideGrid(te,ie,oe,le)),ue||u!=="always"&&this.grid.hitTest(te,ie,oe,le,u,k)?{box:[te,ie,oe,le],placeable:!1,offscreen:!1,occluded:ne}:{box:[te,ie,oe,le],placeable:!0,offscreen:this.isOffscreen(te,ie,oe,le),occluded:ne}}placeCollisionCircles(r,u,f,v,x,R,T,D,k,L,H,B,W,Z){let ee=[],te=new o.P(u.anchorX,u.anchorY),ie=this.getPerspectiveRatio(te.x,te.y,R,Z),oe=(k?x*this.transform.getPitchedTextCorrection(u.anchorX,u.anchorY,R)/ie:x*ie)/o.aB,le={getElevation:Z,pitchedLabelPlaneMatrix:T,lineVertexArray:f,pitchWithMap:k,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:te,unwrappedTileID:R,width:this.transform.width,height:this.transform.height,translation:W},ne=Fn(oe,v,u.lineOffsetX*oe,u.lineOffsetY*oe,!1,u,!1,le),ue=!1,ge=!1,re=!0;if(ne){let we=.5*H*ie+B,Te=new o.P(-100,-100),Re=new o.P(this.screenRightBoundary,this.screenBottomBoundary),Ee=new ci,De=ne.first,Ke=ne.last,Ze=[];for(let It=De.path.length-1;It>=1;It--)Ze.push(De.path[It]);for(let It=1;It<Ke.path.length;It++)Ze.push(Ke.path[It]);let He=2.5*we;if(k){let It=this.projectPathToScreenSpace(Ze,le);Ze=It.some(Xt=>Xt.signedDistanceFromCamera<=0)?[]:It.map(Xt=>Xt.point)}let ut=[];if(Ze.length>0){let It=Ze[0].clone(),Xt=Ze[0].clone();for(let yi=1;yi<Ze.length;yi++)It.x=Math.min(It.x,Ze[yi].x),It.y=Math.min(It.y,Ze[yi].y),Xt.x=Math.max(Xt.x,Ze[yi].x),Xt.y=Math.max(Xt.y,Ze[yi].y);ut=It.x>=Te.x&&Xt.x<=Re.x&&It.y>=Te.y&&Xt.y<=Re.y?[Ze]:Xt.x<Te.x||It.x>Re.x||Xt.y<Te.y||It.y>Re.y?[]:o.ay([Ze],Te.x,Te.y,Re.x,Re.y)}for(let It of ut){Ee.reset(It,.25*we);let Xt=0;Xt=Ee.length<=.5*we?1:Math.ceil(Ee.paddedLength/He)+1;for(let yi=0;yi<Xt;yi++){let ni=yi/Math.max(Xt-1,1),ti=Ee.lerp(ni),wi=ti.x+ki,hi=ti.y+ki;ee.push(wi,hi,we,0);let ri=wi-we,$t=hi-we,ts=wi+we,Ki=hi+we;if(re=re&&this.isOffscreen(ri,$t,ts,Ki),ge=ge||this.isInsideGrid(ri,$t,ts,Ki),r!=="always"&&this.grid.hitTestCircle(wi,hi,we,r,L)&&(ue=!0,!D))return{circles:[],offscreen:!1,collisionDetected:ue}}}}return{circles:!D&&ue||!ge||ie<this.perspectiveRatioCutoff?[]:ee,offscreen:re,collisionDetected:ue}}projectPathToScreenSpace(r,u){let f=function(v,x){let R=o.L();return o.aq(R,x.pitchedLabelPlaneMatrix),v.map(T=>{let D=qi(T.x,T.y,R,x.getElevation),k=x.transform.projectTileCoordinates(D.point.x,D.point.y,x.unwrappedTileID,x.getElevation);return k.point.x=(.5*k.point.x+.5)*x.width,k.point.y=(.5*-k.point.y+.5)*x.height,k})}(r,u);return function(v){let x=0,R=0,T=0,D=0;for(let k=0;k<v.length;k++)v[k].isOccluded?(T=k+1,D=0):(D++,D>R&&(R=D,x=T));return v.slice(x,x+R)}(f)}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let u=[],f=new o.a2;for(let H of r){let B=new o.P(H.x+ki,H.y+ki);f.extend(B),u.push(B)}let{minX:v,minY:x,maxX:R,maxY:T}=f,D=this.grid.query(v,x,R,T).concat(this.ignoredGrid.query(v,x,R,T)),k={},L={};for(let H of D){let B=H.key;if(k[B.bucketInstanceId]===void 0&&(k[B.bucketInstanceId]={}),k[B.bucketInstanceId][B.featureIndex])continue;let W=[new o.P(H.x1,H.y1),new o.P(H.x2,H.y1),new o.P(H.x2,H.y2),new o.P(H.x1,H.y2)];o.az(u,W)&&(k[B.bucketInstanceId][B.featureIndex]=!0,L[B.bucketInstanceId]===void 0&&(L[B.bucketInstanceId]=[]),L[B.bucketInstanceId].push(B.featureIndex))}return L}insertCollisionBox(r,u,f,v,x,R){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:x,collisionGroupID:R,overlapMode:u},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,u,f,v,x,R){let T=f?this.ignoredGrid:this.grid,D={bucketInstanceId:v,featureIndex:x,collisionGroupID:R,overlapMode:u};for(let k=0;k<r.length;k+=4)T.insertCircle(D,r[k],r[k+1],r[k+2])}projectAndGetPerspectiveRatio(r,u,f,v,x){if(x){let R;v?(R=[r,u,v(r,u),1],o.aw(R,R,x)):(R=[r,u,0,1],ha(R,R,x));let T=R[3];return{x:(R[0]/T+1)/2*this.transform.width+ki,y:(-R[1]/T+1)/2*this.transform.height+ki,perspectiveRatio:.5+this.transform.cameraToCenterDistance/T*.5,isOccluded:!1,signedDistanceFromCamera:T}}{let R=this.transform.projectTileCoordinates(r,u,f,v);return{x:(R.point.x+1)/2*this.transform.width+ki,y:(1-R.point.y)/2*this.transform.height+ki,perspectiveRatio:.5+this.transform.cameraToCenterDistance/R.signedDistanceFromCamera*.5,isOccluded:R.isOccluded,signedDistanceFromCamera:R.signedDistanceFromCamera}}}getPerspectiveRatio(r,u,f,v){let x=this.transform.projectTileCoordinates(r,u,f,v);return .5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5}isOffscreen(r,u,f,v){return f<ki||r>=this.screenRightBoundary||v<ki||u>this.screenBottomBoundary}isInsideGrid(r,u,f,v){return f>=0&&r<this.gridRightBoundary&&v>=0&&u<this.gridBottomBoundary}getViewportMatrix(){let r=o.ag([]);return o.M(r,r,[-100,-100,0]),r}_projectCollisionBox(r,u,f,v,x,R,T,D,k,L,H){let B=1,W=0,Z=0,ee=1,te=r.anchorPointX+T[0],ie=r.anchorPointY+T[1];if(R&&!x){let Ze=this.projectAndGetPerspectiveRatio(te+1,ie,v,k,H),He=Ze.x-D.x,ut=Math.atan((Ze.y-D.y)/He)+(He<0?Math.PI:0),It=Math.sin(ut),Xt=Math.cos(ut);B=Xt,W=It,Z=-It,ee=Xt}else if(!R&&x){let Ze=Wt(this.transform);B=Ze.vecEast[0],W=Ze.vecEast[1],Z=Ze.vecSouth[0],ee=Ze.vecSouth[1]}let oe=D.x,le=D.y,ne=u;x&&(oe=te,le=ie,ne=Math.pow(2,-(this.transform.zoom-f.overscaledZ)),ne*=this.transform.getPitchedTextCorrection(te,ie,v),L||(ne*=o.ah(.5+D.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),L&&(oe+=B*L.x*ne+Z*L.y*ne,le+=W*L.x*ne+ee*L.y*ne);let ue=r.x1*ne,ge=r.x2*ne,re=(ue+ge)/2,we=r.y1*ne,Te=r.y2*ne,Re=(we+Te)/2,Ee=[{offsetX:ue,offsetY:we},{offsetX:re,offsetY:we},{offsetX:ge,offsetY:we},{offsetX:ge,offsetY:Re},{offsetX:ge,offsetY:Te},{offsetX:re,offsetY:Te},{offsetX:ue,offsetY:Te},{offsetX:ue,offsetY:Re}],De=[];for(let{offsetX:Ze,offsetY:He}of Ee)De.push(new o.P(oe+B*Ze+Z*He,le+W*Ze+ee*He));let Ke=!1;if(x){let Ze=De.map(He=>this.projectAndGetPerspectiveRatio(He.x,He.y,v,k,H));Ke=Ze.some(He=>!He.isOccluded),De=Ze.map(He=>new o.P(He.x,He.y))}else Ke=!0;return{box:o.aA(De),allPointsOccluded:!Ke}}}class Ws{constructor(r,u,f,v){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?u:-u))):v&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class si{constructor(r,u,f,v,x){this.text=new Ws(r?r.text:null,u,f,x),this.icon=new Ws(r?r.icon:null,u,v,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ug{constructor(r,u,f){this.text=r,this.icon=u,this.skipFade=f}}class hl{constructor(r,u,f,v,x){this.bucketInstanceId=r,this.featureIndex=u,this.sourceLayerIndex=f,this.bucketIndex=v,this.tileID=x}}class Lu{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){let u=++this.maxGroupID;this.collisionGroups[r]={ID:u,predicate:f=>f.collisionGroupID===u}}return this.collisionGroups[r]}}function An(w,r,u,f,v){let{horizontalAlign:x,verticalAlign:R}=o.aH(w);return new o.P(-(x-.5)*r+f[0]*v,-(R-.5)*u+f[1]*v)}class Ln{constructor(r,u,f,v,x){this.transform=r.clone(),this.terrain=u,this.collisionIndex=new Sc(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Lu(v),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(r){let u=this.terrain;return u?(f,v)=>u.getElevation(r,f,v):null}getBucketParts(r,u,f,v){let x=f.getBucket(u),R=f.latestFeatureIndex;if(!x||!R||u.id!==x.layerIds[0])return;let T=f.collisionBoxArray,D=x.layers[0].layout,k=x.layers[0].paint,L=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),H=f.tileSize/o.$,B=f.tileID.toUnwrapped(),W=D.get("text-rotation-alignment")==="map",Z=o.aC(f,1,this.transform.zoom),ee=o.aD(this.collisionIndex.transform,f,k.get("text-translate"),k.get("text-translate-anchor")),te=o.aD(this.collisionIndex.transform,f,k.get("icon-translate"),k.get("icon-translate-anchor")),ie=Hi(W,this.transform,Z);this.retainedQueryData[x.bucketInstanceId]=new hl(x.bucketInstanceId,R,x.sourceLayerIndex,x.index,f.tileID);let oe={bucket:x,layout:D,translationText:ee,translationIcon:te,unwrappedTileID:B,pitchedLabelPlaneMatrix:ie,scale:L,textPixelRatio:H,holdingForFade:f.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:o.an(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(v)for(let le of x.sortKeyRanges){let{sortKey:ne,symbolInstanceStart:ue,symbolInstanceEnd:ge}=le;r.push({sortKey:ne,symbolInstanceStart:ue,symbolInstanceEnd:ge,parameters:oe})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:oe})}attemptAnchorPlacement(r,u,f,v,x,R,T,D,k,L,H,B,W,Z,ee,te,ie,oe,le,ne){let ue=o.aE[r.textAnchor],ge=[r.textOffset0,r.textOffset1],re=An(ue,f,v,ge,x),we=this.collisionIndex.placeCollisionBox(u,B,D,k,L,T,R,te,H.predicate,le,re,ne);if((!oe||this.collisionIndex.placeCollisionBox(oe,B,D,k,L,T,R,ie,H.predicate,le,re,ne).placeable)&&we.placeable){let Te;if(this.prevPlacement&&this.prevPlacement.variableOffsets[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID]&&this.prevPlacement.placements[W.crossTileID].text&&(Te=this.prevPlacement.variableOffsets[W.crossTileID].anchor),W.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[W.crossTileID]={textOffset:ge,width:f,height:v,anchor:ue,textBoxScale:x,prevAnchor:Te},this.markUsedJustification(Z,ue,W,ee),Z.allowVerticalPlacement&&(this.markUsedOrientation(Z,ee,W),this.placedOrientations[W.crossTileID]=ee),{shift:re,placedGlyphBoxes:we}}}placeLayerBucketPart(r,u,f){let{bucket:v,layout:x,translationText:R,translationIcon:T,unwrappedTileID:D,pitchedLabelPlaneMatrix:k,textPixelRatio:L,holdingForFade:H,collisionBoxArray:B,partiallyEvaluatedTextSize:W,collisionGroup:Z}=r.parameters,ee=x.get("text-optional"),te=x.get("icon-optional"),ie=o.aF(x,"text-overlap","text-allow-overlap"),oe=ie==="always",le=o.aF(x,"icon-overlap","icon-allow-overlap"),ne=le==="always",ue=x.get("text-rotation-alignment")==="map",ge=x.get("text-pitch-alignment")==="map",re=x.get("icon-text-fit")!=="none",we=x.get("symbol-z-order")==="viewport-y",Te=oe&&(ne||!v.hasIconData()||te),Re=ne&&(oe||!v.hasTextData()||ee);!v.collisionArrays&&B&&v.deserializeCollisionBoxes(B);let Ee=this.retainedQueryData[v.bucketInstanceId].tileID,De=this._getTerrainElevationFunc(Ee),Ke=this.transform.getFastPathSimpleProjectionMatrix(Ee),Ze=(He,ut,It)=>{var Xt,yi;if(u[He.crossTileID])return;if(H)return void(this.placements[He.crossTileID]=new ug(!1,!1,!1));let ni=!1,ti=!1,wi=!0,hi=null,ri={box:null,placeable:!1,offscreen:null,occluded:!1},$t={placeable:!1},ts=null,Ki=null,ks=null,Hn=0,Nn=0,To=0;ut.textFeatureIndex?Hn=ut.textFeatureIndex:He.useRuntimeCollisionCircles&&(Hn=He.featureIndex),ut.verticalTextFeatureIndex&&(Nn=ut.verticalTextFeatureIndex);let zr=ut.textBox;if(zr){let As=ui=>{let Ni=o.ao.horizontal;if(v.allowVerticalPlacement&&!ui&&this.prevPlacement){let eo=this.prevPlacement.placedOrientations[He.crossTileID];eo&&(this.placedOrientations[He.crossTileID]=eo,Ni=eo,this.markUsedOrientation(v,Ni,He))}return Ni},un=(ui,Ni)=>{if(v.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&ut.verticalTextBox){for(let eo of v.writingModes)if(eo===o.ao.vertical?(ri=Ni(),$t=ri):ri=ui(),ri&&ri.placeable)break}else ri=ui()},dn=He.textAnchorOffsetStartIndex,Wn=He.textAnchorOffsetEndIndex;if(Wn===dn){let ui=(Ni,eo)=>{let is=this.collisionIndex.placeCollisionBox(Ni,ie,L,Ee,D,ge,ue,R,Z.predicate,De,void 0,Ke);return is&&is.placeable&&(this.markUsedOrientation(v,eo,He),this.placedOrientations[He.crossTileID]=eo),is};un(()=>ui(zr,o.ao.horizontal),()=>{let Ni=ut.verticalTextBox;return v.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&Ni?ui(Ni,o.ao.vertical):{box:null,offscreen:null}}),As(ri&&ri.placeable)}else{let ui=o.aE[(yi=(Xt=this.prevPlacement)===null||Xt===void 0?void 0:Xt.variableOffsets[He.crossTileID])===null||yi===void 0?void 0:yi.anchor],Ni=(is,sy,Id)=>{let zl=is.x2-is.x1,Ea=is.y2-is.y1,pn=He.textBoxScale,Do=re&&le==="never"?sy:null,js=null,kd=ie==="never"?1:2,Un="never";ui&&kd++;for(let of=0;of<kd;of++){for(let hh=dn;hh<Wn;hh++){let uh=v.textAnchorOffsets.get(hh);if(ui&&uh.textAnchor!==ui)continue;let dh=this.attemptAnchorPlacement(uh,is,zl,Ea,pn,ue,ge,L,Ee,D,Z,Un,He,v,Id,R,T,Do,De);if(dh&&(js=dh.placedGlyphBoxes,js&&js.placeable))return ni=!0,hi=dh.shift,js}ui?ui=null:Un=ie}return f&&!js&&(js={box:this.collisionIndex.placeCollisionBox(zr,"always",L,Ee,D,ge,ue,R,Z.predicate,De,void 0,Ke).box,offscreen:!1,placeable:!1,occluded:!1}),js};un(()=>Ni(zr,ut.iconBox,o.ao.horizontal),()=>{let is=ut.verticalTextBox;return v.allowVerticalPlacement&&(!ri||!ri.placeable)&&He.numVerticalGlyphVertices>0&&is?Ni(is,ut.verticalIconBox,o.ao.vertical):{box:null,occluded:!0,offscreen:null}}),ri&&(ni=ri.placeable,wi=ri.offscreen);let eo=As(ri&&ri.placeable);if(!ni&&this.prevPlacement){let is=this.prevPlacement.variableOffsets[He.crossTileID];is&&(this.variableOffsets[He.crossTileID]=is,this.markUsedJustification(v,is.anchor,He,eo))}}}if(ts=ri,ni=ts&&ts.placeable,wi=ts&&ts.offscreen,He.useRuntimeCollisionCircles){let As=v.text.placedSymbolArray.get(He.centerJustifiedTextSymbolIndex),un=o.ap(v.textSizeData,W,As),dn=x.get("text-padding");Ki=this.collisionIndex.placeCollisionCircles(ie,As,v.lineVertexArray,v.glyphOffsetArray,un,D,k,f,ge,Z.predicate,He.collisionCircleDiameter,dn,R,De),Ki.circles.length&&Ki.collisionDetected&&!f&&o.w("Collisions detected, but collision boxes are not shown"),ni=oe||Ki.circles.length>0&&!Ki.collisionDetected,wi=wi&&Ki.offscreen}if(ut.iconFeatureIndex&&(To=ut.iconFeatureIndex),ut.iconBox){let As=un=>this.collisionIndex.placeCollisionBox(un,le,L,Ee,D,ge,ue,T,Z.predicate,De,re&&hi?hi:void 0,Ke);$t&&$t.placeable&&ut.verticalIconBox?(ks=As(ut.verticalIconBox),ti=ks.placeable):(ks=As(ut.iconBox),ti=ks.placeable),wi=wi&&ks.offscreen}let Ol=ee||He.numHorizontalGlyphVertices===0&&He.numVerticalGlyphVertices===0,ch=te||He.numIconVertices===0;Ol||ch?ch?Ol||(ti=ti&&ni):ni=ti&&ni:ti=ni=ti&&ni;let Gn=ti&&ks.placeable;if(ni&&ts.placeable&&this.collisionIndex.insertCollisionBox(ts.box,ie,x.get("text-ignore-placement"),v.bucketInstanceId,$t&&$t.placeable&&Nn?Nn:Hn,Z.ID),Gn&&this.collisionIndex.insertCollisionBox(ks.box,le,x.get("icon-ignore-placement"),v.bucketInstanceId,To,Z.ID),Ki&&ni&&this.collisionIndex.insertCollisionCircles(Ki.circles,ie,x.get("text-ignore-placement"),v.bucketInstanceId,Hn,Z.ID),f&&this.storeCollisionData(v.bucketInstanceId,It,ut,ts,ks,Ki),He.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(v.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[He.crossTileID]=new ug((ni||Te)&&!ts?.occluded,(ti||Re)&&!ks?.occluded,wi||v.justReloaded),u[He.crossTileID]=!0};if(we){if(r.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let He=v.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let ut=He.length-1;ut>=0;--ut){let It=He[ut];Ze(v.symbolInstances.get(It),v.collisionArrays[It],It)}}else for(let He=r.symbolInstanceStart;He<r.symbolInstanceEnd;He++)Ze(v.symbolInstances.get(He),v.collisionArrays[He],He);v.justReloaded=!1}storeCollisionData(r,u,f,v,x,R){if(f.textBox||f.iconBox){let T,D;this.collisionBoxArrays.has(r)?T=this.collisionBoxArrays.get(r):(T=new Map,this.collisionBoxArrays.set(r,T)),T.has(u)?D=T.get(u):(D={text:null,icon:null},T.set(u,D)),f.textBox&&(D.text=v.box),f.iconBox&&(D.icon=x.box)}if(R){let T=this.collisionCircleArrays[r];T===void 0&&(T=this.collisionCircleArrays[r]=[]);for(let D=0;D<R.circles.length;D+=4)T.push(R.circles[D+0]-ki),T.push(R.circles[D+1]-ki),T.push(R.circles[D+2]),T.push(R.collisionDetected?1:0)}}markUsedJustification(r,u,f,v){let x;x=v===o.ao.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[o.aG(u)];let R=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(let T of R)T>=0&&(r.text.placedSymbolArray.get(T).crossTileID=x>=0&&T!==x?0:f.crossTileID)}markUsedOrientation(r,u,f){let v=u===o.ao.horizontal||u===o.ao.horizontalOnly?u:0,x=u===o.ao.vertical?u:0,R=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(let T of R)r.text.placedSymbolArray.get(T).placedOrientation=v;f.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;let u=this.prevPlacement,f=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;let v=u?u.symbolFadeChange(r):1,x=u?u.opacities:{},R=u?u.variableOffsets:{},T=u?u.placedOrientations:{};for(let D in this.placements){let k=this.placements[D],L=x[D];L?(this.opacities[D]=new si(L,v,k.text,k.icon),f=f||k.text!==L.text.placed||k.icon!==L.icon.placed):(this.opacities[D]=new si(null,v,k.text,k.icon,k.skipFade),f=f||k.text||k.icon)}for(let D in x){let k=x[D];if(!this.opacities[D]){let L=new si(k,v,!1,!1);L.isHidden()||(this.opacities[D]=L,f=f||k.text.placed||k.icon.placed)}}for(let D in R)this.variableOffsets[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.variableOffsets[D]=R[D]);for(let D in T)this.placedOrientations[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.placedOrientations[D]=T[D]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:r)}updateLayerOpacities(r,u){let f={};for(let v of u){let x=v.getBucket(r);x&&v.latestFeatureIndex&&r.id===x.layerIds[0]&&this.updateBucketOpacities(x,v.tileID,f,v.collisionBoxArray)}}updateBucketOpacities(r,u,f,v){r.hasTextData()&&(r.text.opacityVertexArray.clear(),r.text.hasVisibleVertices=!1),r.hasIconData()&&(r.icon.opacityVertexArray.clear(),r.icon.hasVisibleVertices=!1),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();let x=r.layers[0],R=x.layout,T=new si(null,0,!1,!1,!0),D=R.get("text-allow-overlap"),k=R.get("icon-allow-overlap"),L=x._unevaluatedLayout.hasValue("text-variable-anchor")||x._unevaluatedLayout.hasValue("text-variable-anchor-offset"),H=R.get("text-rotation-alignment")==="map",B=R.get("text-pitch-alignment")==="map",W=R.get("icon-text-fit")!=="none",Z=new si(null,0,D&&(k||!r.hasIconData()||R.get("icon-optional")),k&&(D||!r.hasTextData()||R.get("text-optional")),!0);!r.collisionArrays&&v&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(v);let ee=(ie,oe,le)=>{for(let ne=0;ne<oe/4;ne++)ie.opacityVertexArray.emplaceBack(le);ie.hasVisibleVertices=ie.hasVisibleVertices||le!==da},te=this.collisionBoxArrays.get(r.bucketInstanceId);for(let ie=0;ie<r.symbolInstances.length;ie++){let oe=r.symbolInstances.get(ie),{numHorizontalGlyphVertices:le,numVerticalGlyphVertices:ne,crossTileID:ue}=oe,ge=this.opacities[ue];f[ue]?ge=T:ge||(ge=Z,this.opacities[ue]=ge),f[ue]=!0;let re=oe.numIconVertices>0,we=this.placedOrientations[oe.crossTileID],Te=we===o.ao.vertical,Re=we===o.ao.horizontal||we===o.ao.horizontalOnly;if(le>0||ne>0){let De=zu(ge.text);ee(r.text,le,Te?da:De),ee(r.text,ne,Re?da:De);let Ke=ge.text.isHidden();[oe.rightJustifiedTextSymbolIndex,oe.centerJustifiedTextSymbolIndex,oe.leftJustifiedTextSymbolIndex].forEach(ut=>{ut>=0&&(r.text.placedSymbolArray.get(ut).hidden=Ke||Te?1:0)}),oe.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(oe.verticalPlacedTextSymbolIndex).hidden=Ke||Re?1:0);let Ze=this.variableOffsets[oe.crossTileID];Ze&&this.markUsedJustification(r,Ze.anchor,oe,we);let He=this.placedOrientations[oe.crossTileID];He&&(this.markUsedJustification(r,"left",oe,He),this.markUsedOrientation(r,He,oe))}if(re){let De=zu(ge.icon),Ke=!(W&&oe.verticalPlacedIconSymbolIndex&&Te);oe.placedIconSymbolIndex>=0&&(ee(r.icon,oe.numIconVertices,Ke?De:da),r.icon.placedSymbolArray.get(oe.placedIconSymbolIndex).hidden=ge.icon.isHidden()),oe.verticalPlacedIconSymbolIndex>=0&&(ee(r.icon,oe.numVerticalIconVertices,Ke?da:De),r.icon.placedSymbolArray.get(oe.verticalPlacedIconSymbolIndex).hidden=ge.icon.isHidden())}let Ee=te&&te.has(ie)?te.get(ie):{text:null,icon:null};if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){let De=r.collisionArrays[ie];if(De){let Ke=new o.P(0,0);if(De.textBox||De.verticalTextBox){let Ze=!0;if(L){let He=this.variableOffsets[ue];He?(Ke=An(He.anchor,He.width,He.height,He.textOffset,He.textBoxScale),H&&Ke._rotate(B?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Ze=!1}if(De.textBox||De.verticalTextBox){let He;De.textBox&&(He=Te),De.verticalTextBox&&(He=Re),Ou(r.textCollisionBox.collisionVertexArray,ge.text.placed,!Ze||He,Ee.text,Ke.x,Ke.y)}}if(De.iconBox||De.verticalIconBox){let Ze=!!(!Re&&De.verticalIconBox),He;De.iconBox&&(He=Ze),De.verticalIconBox&&(He=!Ze),Ou(r.iconCollisionBox.collisionVertexArray,ge.icon.placed,He,Ee.icon,W?Ke.x:0,W?Ke.y:0)}}}}if(r.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.text.opacityVertexArray.length!==r.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${r.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${r.text.layoutVertexArray.length}) / 4`);if(r.icon.opacityVertexArray.length!==r.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${r.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${r.icon.layoutVertexArray.length}) / 4`);r.bucketInstanceId in this.collisionCircleArrays&&(r.collisionCircleArray=this.collisionCircleArrays[r.bucketInstanceId],delete this.collisionCircleArrays[r.bucketInstanceId])}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,u){let f=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*f>r}setStale(){this.stale=!0}}function Ou(w,r,u,f,v,x){f&&f.length!==0||(f=[0,0,0,0]);let R=f[0]-ki,T=f[1]-ki,D=f[2]-ki,k=f[3]-ki;w.emplaceBack(r?1:0,u?1:0,v||0,x||0,R,T),w.emplaceBack(r?1:0,u?1:0,v||0,x||0,D,T),w.emplaceBack(r?1:0,u?1:0,v||0,x||0,D,k),w.emplaceBack(r?1:0,u?1:0,v||0,x||0,R,k)}let dg=Math.pow(2,25),pg=Math.pow(2,24),ua=Math.pow(2,17),gg=Math.pow(2,16),Fv=Math.pow(2,9),Iv=Math.pow(2,8),kv=Math.pow(2,1);function zu(w){if(w.opacity===0&&!w.placed)return 0;if(w.opacity===1&&w.placed)return 4294967295;let r=w.placed?1:0,u=Math.floor(127*w.opacity);return u*dg+r*pg+u*ua+r*gg+u*Fv+r*Iv+u*kv+r}let da=0;class Bu{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&!r.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,u,f,v,x){let R=this._bucketParts;for(;this._currentTileIndex<r.length;)if(u.getBucketParts(R,v,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort((T,D)=>T.sortKey-D.sortKey));this._currentPartIndex<R.length;)if(u.placeLayerBucketPart(R[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,x())return!0;return!1}}class Vu{constructor(r,u,f,v,x,R,T,D){this.placement=new Ln(r,u,R,T,D),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(r,u,f){let v=C.now(),x=()=>!this._forceFullPlacement&&C.now()-v>2;for(;this._currentPlacementIndex>=0;){let R=u[r[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(R.type==="symbol"&&(!R.minzoom||R.minzoom<=T)&&(!R.maxzoom||R.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new Bu(R)),this._inProgressLayer.continuePlacement(f[R.source],this.placement,this._showCollisionBoxes,R,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}let pa=512/o.$/2;class Hu{constructor(r,u,f){this.tileID=r,this.bucketInstanceId=f,this._symbolsByKey={};let v=new Map;for(let x=0;x<u.length;x++){let R=u.get(x),T=R.key,D=v.get(T);D?D.push(R):v.set(T,[R])}for(let[x,R]of v){let T={positions:R.map(D=>({x:Math.floor(D.anchorX*pa),y:Math.floor(D.anchorY*pa)})),crossTileIDs:R.map(D=>D.crossTileID)};if(T.positions.length>128){let D=new o.aI(T.positions.length,16,Uint16Array);for(let{x:k,y:L}of T.positions)D.add(k,L);D.finish(),delete T.positions,T.index=D}this._symbolsByKey[x]=T}}getScaledCoordinates(r,u){let{x:f,y:v,z:x}=this.tileID.canonical,{x:R,y:T,z:D}=u.canonical,k=pa/Math.pow(2,D-x),L=(T*o.$+r.anchorY)*k,H=v*o.$*pa;return{x:Math.floor((R*o.$+r.anchorX)*k-f*o.$*pa),y:Math.floor(L-H)}}findMatches(r,u,f){let v=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let x=0;x<r.length;x++){let R=r.get(x);if(R.crossTileID)continue;let T=this._symbolsByKey[R.key];if(!T)continue;let D=this.getScaledCoordinates(R,u);if(T.index){let k=T.index.range(D.x-v,D.y-v,D.x+v,D.y+v).sort();for(let L of k){let H=T.crossTileIDs[L];if(!f[H]){f[H]=!0,R.crossTileID=H;break}}}else if(T.positions)for(let k=0;k<T.positions.length;k++){let L=T.positions[k],H=T.crossTileIDs[k];if(Math.abs(L.x-D.x)<=v&&Math.abs(L.y-D.y)<=v&&!f[H]){f[H]=!0,R.crossTileID=H;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:r})=>r)}}class Nu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Av{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){let u=Math.round((r-this.lng)/360);if(u!==0)for(let f in this.indexes){let v=this.indexes[f],x={};for(let R in v){let T=v[R];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+u),x[T.tileID.key]=T}this.indexes[f]=x}this.lng=r}addBucket(r,u,f){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let x=0;x<u.symbolInstances.length;x++)u.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});let v=this.usedCrossTileIDs[r.overscaledZ];for(let x in this.indexes){let R=this.indexes[x];if(Number(x)>r.overscaledZ)for(let T in R){let D=R[T];D.tileID.isChildOf(r)&&D.findMatches(u.symbolInstances,r,v)}else{let T=R[r.scaledTo(Number(x)).key];T&&T.findMatches(u.symbolInstances,r,v)}}for(let x=0;x<u.symbolInstances.length;x++){let R=u.symbolInstances.get(x);R.crossTileID||(R.crossTileID=f.generate(),v[R.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Hu(r,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(r,u){for(let f of u.getCrossTileIDsLists())for(let v of f)delete this.usedCrossTileIDs[r][v]}removeStaleBuckets(r){let u=!1;for(let f in this.indexes){let v=this.indexes[f];for(let x in v)r[v[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,v[x]),delete v[x],u=!0)}return u}}class ga{constructor(){this.layerIndexes={},this.crossTileIDs=new Nu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,u,f){let v=this.layerIndexes[r.id];v===void 0&&(v=this.layerIndexes[r.id]=new Av);let x=!1,R={};v.handleWrapJump(f);for(let T of u){let D=T.getBucket(r);D&&r.id===D.layerIds[0]&&(D.bucketInstanceId||(D.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(T.tileID,D,this.crossTileIDs)&&(x=!0),R[D.bucketInstanceId]=!0)}return v.removeStaleBuckets(R)&&(x=!0),x}pruneUnusedLayers(r){let u={};r.forEach(f=>{u[f]=!0});for(let f in this.layerIndexes)u[f]||delete this.layerIndexes[f]}}var ul="void main() {fragColor=vec4(1.0);}";let _o={prelude:Lt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Lt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Lt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Lt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Lt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Lt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Lt(ul,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Lt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Lt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Lt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Lt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Lt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Lt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Lt(ul,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Lt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Lt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Lt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Lt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Lt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Lt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Lt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Lt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Lt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Lt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Lt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Lt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Lt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Lt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Lt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Lt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Lt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Lt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Lt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Lt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Lt(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Lt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Lt(w,r){let u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=r.match(/in ([\w]+) ([\w]+)/g),v=w.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),R=x?x.concat(v):v,T={};return{fragmentSource:w=w.replace(u,(D,k,L,H,B)=>(T[B]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${B}
in ${L} ${H} ${B};
#else
uniform ${L} ${H} u_${B};
#endif
`:`
#ifdef HAS_UNIFORM_u_${B}
    ${L} ${H} ${B} = u_${B};
#endif
`)),vertexSource:r=r.replace(u,(D,k,L,H,B)=>{let W=H==="float"?"vec2":"vec4",Z=B.match(/color/)?"color":W;return T[B]?k==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
in ${L} ${W} a_${B};
out ${L} ${H} ${B};
#else
uniform ${L} ${H} u_${B};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = a_${B};
#else
    ${L} ${H} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${B} = unpack_mix_${Z}(a_${B}, u_${B}_t);
#else
    ${L} ${H} ${B} = u_${B};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${B}
uniform lowp float u_${B}_t;
in ${L} ${W} a_${B};
#else
uniform ${L} ${H} u_${B};
#endif
`:Z==="vec4"?`
#ifndef HAS_UNIFORM_u_${B}
    ${L} ${H} ${B} = a_${B};
#else
    ${L} ${H} ${B} = u_${B};
#endif
`:`
#ifndef HAS_UNIFORM_u_${B}
    ${L} ${H} ${B} = unpack_mix_${Z}(a_${B}, u_${B}_t);
#else
    ${L} ${H} ${B} = u_${B};
#endif
`}),staticAttributes:f,staticUniforms:R}}class mr{constructor(r,u,f){this.vertexBuffer=r,this.indexBuffer=u,this.segments=f}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var On=o.aJ([{name:"a_pos",type:"Int16",components:2}]);let an="#define PROJECTION_MERCATOR",vr="mercator";class Ot{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return vr}get shaderDefine(){return an}get shaderPreludeCode(){return _o.projectionMercator}get vertexShaderPreludeCode(){return _o.projectionMercator.vertexSource}get subdivisionGranularity(){return o.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(r){}getMeshFromTileID(r,u,f,v,x){if(this._cachedMesh)return this._cachedMesh;let R=new o.aL;R.emplaceBack(0,0),R.emplaceBack(o.$,0),R.emplaceBack(0,o.$),R.emplaceBack(o.$,o.$);let T=r.createVertexBuffer(R,On.members),D=o.aM.simpleSegment(0,0,4,2),k=new o.aN;k.emplaceBack(1,0,2),k.emplaceBack(1,2,3);let L=r.createIndexBuffer(k);return this._cachedMesh=new mr(T,L,D),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(r){}}class yr{constructor(r=0,u=0,f=0,v=0){if(isNaN(r)||r<0||isNaN(u)||u<0||isNaN(f)||f<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=u,this.left=f,this.right=v}interpolate(r,u,f){return u.top!=null&&r.top!=null&&(this.top=o.C.number(r.top,u.top,f)),u.bottom!=null&&r.bottom!=null&&(this.bottom=o.C.number(r.bottom,u.bottom,f)),u.left!=null&&r.left!=null&&(this.left=o.C.number(r.left,u.left,f)),u.right!=null&&r.right!=null&&(this.right=o.C.number(r.right,u.right,f)),this}getCenter(r,u){let f=o.ah((this.left+r-this.right)/2,0,r),v=o.ah((this.top+u-this.bottom)/2,0,u);return new o.P(f,v)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new yr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Rc(w,r){if(!w.renderWorldCopies||w.lngRange)return;let u=r.lng-w.center.lng;r.lng+=u>180?-360:u<-180?360:0}function Ec(w){return Math.max(0,Math.floor(w))}class Ts{constructor(r,u,f,v,x,R){this._callbacks=r,this._tileSize=512,this._renderWorldCopies=R===void 0||!!R,this._minZoom=u||0,this._maxZoom=f||22,this._minPitch=v??0,this._maxPitch=x??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new o.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ec(this._zoom),this._scale=o.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new yr,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(r,u,f){this._latRange=r.latRange,this._lngRange=r.lngRange,this._width=r.width,this._height=r.height,this._center=r.center,this._elevation=r.elevation,this._minElevationForCurrentTile=r.minElevationForCurrentTile,this._zoom=r.zoom,this._tileZoom=Ec(this._zoom),this._scale=o.af(this._zoom),this._bearingInRadians=r.bearingInRadians,this._fovInRadians=r.fovInRadians,this._pitchInRadians=r.pitchInRadians,this._rollInRadians=r.rollInRadians,this._unmodified=r.unmodified,this._edgeInsets=new yr(r.padding.top,r.padding.bottom,r.padding.left,r.padding.right),this._minZoom=r.minZoom,this._maxZoom=r.maxZoom,this._minPitch=r.minPitch,this._maxPitch=r.maxPitch,this._renderWorldCopies=r.renderWorldCopies,this._cameraToCenterDistance=r.cameraToCenterDistance,this._nearZ=r.nearZ,this._farZ=r.farZ,this._autoCalculateNearFarZ=!f&&r.autoCalculateNearFarZ,u&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(r){this._minElevationForCurrentTile=r}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(r){this._minZoom!==r&&(this._minZoom=r,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(r){this._minPitch!==r&&(this._minPitch=r,this.setPitch(Math.max(this.pitch,r)))}get maxPitch(){return this._maxPitch}setMaxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.setPitch(Math.min(this.pitch,r)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(r){let u=o.aO(r,-180,180)*Math.PI/180;var f,v,x,R,T,D,k,L,H;this._bearingInRadians!==u&&(this._unmodified=!1,this._bearingInRadians=u,this._calcMatrices(),this._rotationMatrix=d(),f=this._rotationMatrix,x=-this._bearingInRadians,R=(v=this._rotationMatrix)[0],T=v[1],D=v[2],k=v[3],L=Math.sin(x),H=Math.cos(x),f[0]=R*H+D*L,f[1]=T*H+k*L,f[2]=R*-L+D*H,f[3]=T*-L+k*H)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(r){let u=o.ah(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==u&&(this._unmodified=!1,this._pitchInRadians=u,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(r){let u=r/180*Math.PI;this._rollInRadians!==u&&(this._unmodified=!1,this._rollInRadians=u,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return o.aP(this._fovInRadians)}setFov(r){r=o.ah(r,.1,150),this.fov!==r&&(this._unmodified=!1,this._fovInRadians=o.ae(r),this._calcMatrices())}get zoom(){return this._zoom}setZoom(r){let u=this.getConstrained(this._center,r).zoom;this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this._tileZoom=Math.max(0,Math.floor(u)),this._scale=o.af(u),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(r){r!==this._elevation&&(this._elevation=r,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(r,u){this._autoCalculateNearFarZ=!1,this._nearZ=r,this._farZ=u,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,u,f){this._unmodified=!1,this._edgeInsets.interpolate(r,u,f),this._constrain(),this._calcMatrices()}resize(r,u,f=!0){this._width=r,this._height=u,f&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Ii([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(r){r?(this._lngRange=[r.getWest(),r.getEast()],this._latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-o.ai,o.ai])}getConstrained(r,u){return this._callbacks.getConstrained(r,u)}getCameraQueryGeometry(r,u){if(u.length===1)return[u[0],r];{let{minX:f,minY:v,maxX:x,maxY:R}=o.a2.fromPoints(u).extend(r);return[new o.P(f,v),new o.P(x,v),new o.P(x,R),new o.P(f,R),new o.P(f,v)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;let r=this._unmodified,{center:u,zoom:f}=this.getConstrained(this.center,this.zoom);this.setCenter(u),this.setZoom(f),this._unmodified=r,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let r=o.ag(new Float64Array(16));o.N(r,r,[this._width/2,-this._height/2,1]),o.M(r,r,[1,-1,0]),this._clipSpaceToPixelsMatrix=r,r=o.ag(new Float64Array(16)),o.N(r,r,[1,-1,1]),o.M(r,r,[-1,-1,0]),o.N(r,r,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=r,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(r,u,f,v){let x=f!==void 0?f:this.bearing,R=v=v!==void 0?v:this.pitch,T=o.a1.fromLngLat(r,u),D=-Math.cos(o.ae(R)),k=Math.sin(o.ae(R)),L=k*Math.sin(o.ae(x)),H=-k*Math.cos(o.ae(x)),B=this.elevation,W=u-B,Z;D*W>=0||Math.abs(D)<.1?(Z=1e4,B=u+Z*D):Z=-W/D;let ee,te,ie=o.aQ(1,T.y),oe=0;do{if(oe+=1,oe>10)break;te=Z/ie,ee=new o.a1(T.x+L*te,T.y+H*te),ie=1/ee.meterInMercatorCoordinateUnits()}while(Math.abs(Z-te*ie)>1e-12);return{center:ee.toLngLat(),elevation:B,zoom:o.ak(this.height/2/Math.tan(this.fovInRadians/2)/te/this.tileSize)}}recalculateZoomAndCenter(r){if(this.elevation-r==0)return;let u=o.aj(1,this.center.lat)*this.worldSize,f=this.cameraToCenterDistance/u,v=o.a1.fromLngLat(this.center,this.elevation),x=Me(this.center,this.elevation,this.pitch,this.bearing,f);this._elevation=r;let R=this.calculateCenterFromCameraLngLatAlt(x.toLngLat(),o.aQ(x.z,v.y),this.bearing,this.pitch);this._elevation=R.elevation,this._center=R.center,this.setZoom(R.zoom)}getCameraPoint(){let r=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.P(r*Math.sin(this.rollInRadians),r*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){let r=o.aj(1,this.center.lat)*this.worldSize;return Me(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/r).toLngLat()}getMercatorTileCoordinates(r){if(!r)return[0,0,1,1];let u=r.canonical.z>=0?1<<r.canonical.z:Math.pow(2,r.canonical.z);return[r.canonical.x/u,r.canonical.y/u,1/u/o.$,1/u/o.$]}}class as{constructor(r,u){this.min=r,this.max=u,this.center=o.aR([],o.aS([],this.min,this.max),.5)}quadrant(r){let u=[r%2==0,r<2],f=o.aT(this.min),v=o.aT(this.max);for(let x=0;x<u.length;x++)f[x]=u[x]?this.min[x]:this.center[x],v[x]=u[x]?this.center[x]:this.max[x];return v[2]=this.max[2],new as(f,v)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}intersectsFrustum(r){let u=!0;for(let f=0;f<r.planes.length;f++){let v=this.intersectsPlane(r.planes[f]);if(v===0)return 0;v===1&&(u=!1)}return u?2:r.aabb.min[0]>this.max[0]||r.aabb.min[1]>this.max[1]||r.aabb.min[2]>this.max[2]||r.aabb.max[0]<this.min[0]||r.aabb.max[1]<this.min[1]||r.aabb.max[2]<this.min[2]?0:1}intersectsPlane(r){let u=r[3],f=r[3];for(let v=0;v<3;v++)r[v]>0?(u+=r[v]*this.min[v],f+=r[v]*this.max[v]):(f+=r[v]*this.min[v],u+=r[v]*this.max[v]);return u>=0?2:f<0?0:1}}class Ds{distanceToTile2d(r,u,f,v){let x=v.distanceX([r,u]),R=v.distanceY([r,u]);return Math.hypot(x,R)}getWrap(r,u,f){return f}getTileBoundingVolume(r,u,f,v){var x,R;let T=0,D=0;if(v?.terrain){let L=new o.Z(r.z,u,r.z,r.x,r.y),H=v.terrain.getMinMaxElevation(L);T=(x=H.minElevation)!==null&&x!==void 0?x:Math.min(0,f),D=(R=H.maxElevation)!==null&&R!==void 0?R:Math.max(0,f)}let k=1<<r.z;return new as([u+r.x/k,r.y/k,T],[u+(r.x+1)/k,(r.y+1)/k,D])}allowVariableZoom(r,u){let f=r.fov*(Math.abs(Math.cos(r.rollInRadians))*r.height+Math.abs(Math.sin(r.rollInRadians))*r.width)/r.height,v=o.ah(78.5-f/2,0,60);return!!u.terrain||r.pitch>v}allowWorldCopies(){return!0}prepareNextFrame(){}}class Zi{constructor(r,u,f){this.points=r,this.planes=u,this.aabb=f}static fromInvProjectionMatrix(r,u=1,f=0,v,x){let R=x?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],T=Math.pow(2,f),D=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(B=>function(W,Z,ee,te){let ie=o.aw([],W,Z),oe=1/ie[3]/ee*te;return o.aY(ie,ie,[oe,oe,1/ie[3],oe])}(B,r,u,T));v&&function(B,W,Z,ee){let te=ee?4:0,ie=ee?0:4,oe=0,le=[],ne=[];for(let re=0;re<4;re++){let we=o.aU([],B[re+ie],B[re+te]),Te=o.aZ(we);o.aR(we,we,1/Te),le.push(Te),ne.push(we)}for(let re=0;re<4;re++){let we=o.a_(B[re+te],ne[re],Z);oe=we!==null&&we>=0?Math.max(oe,we):Math.max(oe,le[re])}let ue=function(re,we){let Te=o.aU([],re[we[0]],re[we[1]]),Re=o.aU([],re[we[2]],re[we[1]]),Ee=[0,0,0,0];return o.aV(Ee,o.aW([],Te,Re)),Ee[3]=-o.aX(Ee,re[we[0]]),Ee}(B,W),ge=function(re,we){let Te=o.a$(re),Re=o.b0([],re,1/Te),Ee=o.aU([],we,o.aR([],Re,o.aX(we,Re))),De=o.a$(Ee);if(De>0){let Ke=Math.sqrt(1-Re[3]*Re[3]),Ze=o.aR([],Re,-Re[3]),He=o.aS([],Ze,o.aR([],Ee,Ke/De));return o.b1(we,He)}return null}(Z,ue);if(ge!==null){let re=ge/o.aX(ne[0],ue);oe=Math.min(oe,re)}for(let re=0;re<4;re++){let we=Math.min(oe,le[re]);B[re+ie]=[B[re+te][0]+ne[re][0]*we,B[re+te][1]+ne[re][1]*we,B[re+te][2]+ne[re][2]*we,1]}}(D,R[0],v,x);let k=R.map(B=>{let W=o.aU([],D[B[0]],D[B[1]]),Z=o.aU([],D[B[2]],D[B[1]]),ee=o.aV([],o.aW([],W,Z)),te=-o.aX(ee,D[B[1]]);return ee.concat(te)}),L=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],H=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(let B of D)for(let W=0;W<3;W++)L[W]=Math.min(L[W],B[W]),H[W]=Math.max(H[W],B[W]);return new Zi(D,k,new as(L,H))}}class oi{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(r){this._helper.setMinZoom(r)}setMaxZoom(r){this._helper.setMaxZoom(r)}setMinPitch(r){this._helper.setMinPitch(r)}setMaxPitch(r){this._helper.setMaxPitch(r)}setRenderWorldCopies(r){this._helper.setRenderWorldCopies(r)}setBearing(r){this._helper.setBearing(r)}setPitch(r){this._helper.setPitch(r)}setRoll(r){this._helper.setRoll(r)}setFov(r){this._helper.setFov(r)}setZoom(r){this._helper.setZoom(r)}setCenter(r){this._helper.setCenter(r)}setElevation(r){this._helper.setElevation(r)}setMinElevationForCurrentTile(r){this._helper.setMinElevationForCurrentTile(r)}setPadding(r){this._helper.setPadding(r)}interpolatePadding(r,u,f){return this._helper.interpolatePadding(r,u,f)}isPaddingEqual(r){return this._helper.isPaddingEqual(r)}resize(r,u,f=!0){this._helper.resize(r,u,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(r){this._helper.setMaxBounds(r)}overrideNearFarZ(r,u){this._helper.overrideNearFarZ(r,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(r){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),r)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(r,u){}constructor(r,u,f,v,x){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Ts({calcMatrices:()=>{this._calcMatrices()},getConstrained:(R,T)=>this.getConstrained(R,T)},r,u,f,v,x),this._coveringTilesDetailsProvider=new Ds}clone(){let r=new oi;return r.apply(this),r}apply(r,u,f){this._helper.apply(r,u,f)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(r){let u=[new o.b2(0,r)];if(this._helper._renderWorldCopies){let f=this.screenPointToMercatorCoordinate(new o.P(0,0)),v=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,0)),x=this.screenPointToMercatorCoordinate(new o.P(this._helper._width,this._helper._height)),R=this.screenPointToMercatorCoordinate(new o.P(0,this._helper._height)),T=Math.floor(Math.min(f.x,v.x,x.x,R.x)),D=Math.floor(Math.max(f.x,v.x,x.x,R.x)),k=1;for(let L=T-k;L<=D+k;L++)L!==0&&u.push(new o.b2(L,r))}return u}getCameraFrustum(){return Zi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(r){let u=this.screenPointToLocation(this.centerPoint,r),f=r?r.getElevationForLngLatZoom(u,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(f)}setLocationAtPoint(r,u){let f=o.aj(this.elevation,this.center.lat),v=this.screenPointToMercatorCoordinateAtZ(u,f),x=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,f),R=o.a1.fromLngLat(r),T=new o.a1(R.x-(v.x-x.x),R.y-(v.y-x.y));this.setCenter(T?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(r,u){return u?this.coordinatePoint(o.a1.fromLngLat(r),u.getElevationForLngLatZoom(r,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(o.a1.fromLngLat(r))}screenPointToLocation(r,u){var f;return(f=this.screenPointToMercatorCoordinate(r,u))===null||f===void 0?void 0:f.toLngLat()}screenPointToMercatorCoordinate(r,u){if(u){let f=u.pointCoordinate(r);if(f!=null)return f}return this.screenPointToMercatorCoordinateAtZ(r)}screenPointToMercatorCoordinateAtZ(r,u){let f=u||0,v=[r.x,r.y,0,1],x=[r.x,r.y,1,1];o.aw(v,v,this._pixelMatrixInverse),o.aw(x,x,this._pixelMatrixInverse);let R=v[3],T=x[3],D=v[1]/R,k=x[1]/T,L=v[2]/R,H=x[2]/T,B=L===H?0:(f-L)/(H-L);return new o.a1(o.C.number(v[0]/R,x[0]/T,B)/this.worldSize,o.C.number(D,k,B)/this.worldSize,f)}coordinatePoint(r,u=0,f=this._pixelMatrix){let v=[r.x*this.worldSize,r.y*this.worldSize,u,1];return o.aw(v,v,f),new o.P(v[0]/v[3],v[1]/v[3])}getBounds(){let r=Math.max(0,this._helper._height/2-de(this));return new Ii().extend(this.screenPointToLocation(new o.P(0,r))).extend(this.screenPointToLocation(new o.P(this._helper._width,r))).extend(this.screenPointToLocation(new o.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new o.P(0,this._helper._height)))}isPointOnMapSurface(r,u){return u?u.pointCoordinate(r)!=null:r.y>this.height/2-de(this)}calculatePosMatrix(r,u=!1,f){var v;let x=(v=r.key)!==null&&v!==void 0?v:o.b3(r.wrap,r.canonical.z,r.canonical.z,r.canonical.x,r.canonical.y),R=u?this._alignedPosMatrixCache:this._posMatrixCache;if(R.has(x)){let k=R.get(x);return f?k.f32:k.f64}let T=ve(r,this.worldSize);o.O(T,u?this._alignedProjMatrix:this._viewProjMatrix,T);let D={f64:T,f32:new Float32Array(T)};return R.set(x,D),f?D.f32:D.f64}calculateFogMatrix(r){let u=r.key,f=this._fogMatrixCacheF32;if(f.has(u))return f.get(u);let v=ve(r,this.worldSize);return o.O(v,this._fogMatrix,v),f.set(u,new Float32Array(v)),f.get(u)}getConstrained(r,u){u=o.ah(+u,this.minZoom,this.maxZoom);let f={center:new o.S(r.lng,r.lat),zoom:u},v=this._helper._lngRange;if(!this._helper._renderWorldCopies&&v===null){let le=179.9999999999;v=[-le,le]}let x=this.tileSize*o.af(f.zoom),R=0,T=x,D=0,k=x,L=0,H=0,{x:B,y:W}=this.size;if(this._helper._latRange){let le=this._helper._latRange;R=o.U(le[1])*x,T=o.U(le[0])*x,T-R<W&&(L=W/(T-R))}v&&(D=o.aO(o.V(v[0])*x,0,x),k=o.aO(o.V(v[1])*x,0,x),k<D&&(k+=x),k-D<B&&(H=B/(k-D)));let{x:Z,y:ee}=Y(x,r),te,ie,oe=Math.max(H||0,L||0);if(oe){let le=new o.P(H?(k+D)/2:Z,L?(T+R)/2:ee);return f.center=he(x,le).wrap(),f.zoom+=o.ak(oe),f}if(this._helper._latRange){let le=W/2;ee-le<R&&(ie=R+le),ee+le>T&&(ie=T-le)}if(v){let le=(D+k)/2,ne=Z;this._helper._renderWorldCopies&&(ne=o.aO(Z,le-x/2,le+x/2));let ue=B/2;ne-ue<D&&(te=D+ue),ne+ue>k&&(te=k-ue)}if(te!==void 0||ie!==void 0){let le=new o.P(te??Z,ie??ee);f.center=he(x,le).wrap()}return f}calculateCenterFromCameraLngLatAlt(r,u,f,v){return this._helper.calculateCenterFromCameraLngLatAlt(r,u,f,v)}_calculateNearFarZIfNeeded(r,u,f){if(!this._helper.autoCalculateNearFarZ)return;let v=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),x=r-v*this._helper._pixelPerMeter/Math.cos(u),R=v<0?x:r,T=Math.PI/2+this.pitchInRadians,D=o.ae(this.fov)*(Math.abs(Math.cos(o.ae(this.roll)))*this.height+Math.abs(Math.sin(o.ae(this.roll)))*this.width)/this.height*(.5+f.y/this.height),k=Math.sin(D)*R/Math.sin(o.ah(Math.PI-T-D,.01,Math.PI-.01)),L=de(this),H=Math.atan(L/this._helper.cameraToCenterDistance),B=o.ae(.75),W=H>B?2*H*(.5+f.y/(2*L)):B,Z=Math.sin(W)*R/Math.sin(o.ah(Math.PI-T-W,.01,Math.PI-.01)),ee=Math.min(k,Z);this._helper._farZ=1.01*(Math.cos(Math.PI/2-u)*ee+R),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;let r=this.centerOffset,u=Y(this.worldSize,this.center),f=u.x,v=u.y;this._helper._pixelPerMeter=o.aj(1,this.center.lat)*this.worldSize;let x=o.ae(Math.min(this.pitch,q)),R=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(x)),T;this._calculateNearFarZIfNeeded(R,x,r),T=new Float64Array(16),o.b4(T,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),o.aq(this._invProjMatrix,T),T[8]=2*-r.x/this._helper._width,T[9]=2*r.y/this._helper._height,this._projectionMatrix=o.b5(T),o.N(T,T,[1,-1,1]),o.M(T,T,[0,0,-this._helper.cameraToCenterDistance]),o.b6(T,T,-this.rollInRadians),o.b7(T,T,this.pitchInRadians),o.b6(T,T,-this.bearingInRadians),o.M(T,T,[-f,-v,0]),this._mercatorMatrix=o.N([],T,[this.worldSize,this.worldSize,this.worldSize]),o.N(T,T,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=o.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,T),o.M(T,T,[0,0,-this.elevation]),this._viewProjMatrix=T,this._invViewProjMatrix=o.aq([],T);let D=[0,0,-1,1];o.aw(D,D,this._invViewProjMatrix),this._cameraPosition=[D[0]/D[3],D[1]/D[3],D[2]/D[3]],this._fogMatrix=new Float64Array(16),o.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,R,this._helper._farZ),this._fogMatrix[8]=2*-r.x/this.width,this._fogMatrix[9]=2*r.y/this.height,o.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),o.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),o.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),o.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),o.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),o.M(this._fogMatrix,this._fogMatrix,[-f,-v,0]),o.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),o.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=o.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,T);let k=this._helper._width%2/2,L=this._helper._height%2/2,H=Math.cos(this.bearingInRadians),B=Math.sin(-this.bearingInRadians),W=f-Math.round(f)+H*k+B*L,Z=v-Math.round(v)+H*L+B*k,ee=new Float64Array(T);if(o.M(ee,ee,[W>.5?W-1:W,Z>.5?Z-1:Z,0]),this._alignedProjMatrix=ee,T=o.aq(new Float64Array(16),this._pixelMatrix),!T)throw new Error("failed to invert matrix");this._pixelMatrixInverse=T,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;let r=this.screenPointToMercatorCoordinate(new o.P(0,0)),u=[r.x*this.worldSize,r.y*this.worldSize,0,1];return o.aw(u,u,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){let r=o.aj(1,this.center.lat)*this.worldSize;return Me(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/r).toLngLat()}lngLatToCameraDepth(r,u){let f=o.a1.fromLngLat(r),v=[f.x*this.worldSize,f.y*this.worldSize,u,1];return o.aw(v,v,this._viewProjMatrix),v[2]/v[3]}getProjectionData(r){let{overscaledTileID:u,aligned:f,applyTerrainMatrix:v}=r,x=this._helper.getMercatorTileCoordinates(u),R=u?this.calculatePosMatrix(u,f,!0):null,T;return T=u&&u.terrainRttPosMatrix32f&&v?u.terrainRttPosMatrix32f:R||o.b8(),{mainMatrix:T,tileMercatorCoords:x,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:T}}isLocationOccluded(r){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(r,u,f){return 1}transformLightDirection(r){return o.aT(r)}getRayDirectionFromPixel(r){throw new Error("Not implemented.")}projectTileCoordinates(r,u,f,v){let x=this.calculatePosMatrix(f),R;v?(R=[r,u,v(r,u),1],o.aw(R,R,x)):(R=[r,u,0,1],ha(R,R,x));let T=R[3];return{point:new o.P(R[0]/T,R[1]/T),signedDistanceFromCamera:T,isOccluded:!1}}populateCache(r){for(let u of r)this.calculatePosMatrix(u)}getMatrixForModel(r,u){let f=o.a1.fromLngLat(r,u),v=f.meterInMercatorCoordinateUnits(),x=o.b9();return o.M(x,x,[f.x,f.y,f.z]),o.b6(x,x,Math.PI),o.b7(x,x,Math.PI/2),o.N(x,x,[-v,v,v]),x}getProjectionDataForCustomLayer(r=!0){let u=new o.Z(0,0,0,0,0),f=this.getProjectionData({overscaledTileID:u,applyGlobeMatrix:r}),v=ve(u,this.worldSize);o.O(v,this._viewProjMatrix,v),f.tileMercatorCoords=[0,0,1,1];let x=[o.$,o.$,this.worldSize/this._helper.pixelsPerMeter],R=o.ba();return o.N(R,v,x),f.fallbackMatrix=R,f.mainMatrix=R,f}getFastPathSimpleProjectionMatrix(r){return this.calculatePosMatrix(r)}}function fg(){o.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Fs(w){if(w.useSlerp)if(w.k<1){let r=o.bb(w.startEulerAngles.roll,w.startEulerAngles.pitch,w.startEulerAngles.bearing),u=o.bb(w.endEulerAngles.roll,w.endEulerAngles.pitch,w.endEulerAngles.bearing),f=new Float64Array(4);o.bc(f,r,u,w.k);let v=o.bd(f);w.tr.setRoll(v.roll),w.tr.setPitch(v.pitch),w.tr.setBearing(v.bearing)}else w.tr.setRoll(w.endEulerAngles.roll),w.tr.setPitch(w.endEulerAngles.pitch),w.tr.setBearing(w.endEulerAngles.bearing);else w.tr.setRoll(o.C.number(w.startEulerAngles.roll,w.endEulerAngles.roll,w.k)),w.tr.setPitch(o.C.number(w.startEulerAngles.pitch,w.endEulerAngles.pitch,w.k)),w.tr.setBearing(o.C.number(w.startEulerAngles.bearing,w.endEulerAngles.bearing,w.k))}function Ys(w,r,u,f,v){let x=v.padding,R=Y(v.worldSize,u.getNorthWest()),T=Y(v.worldSize,u.getNorthEast()),D=Y(v.worldSize,u.getSouthEast()),k=Y(v.worldSize,u.getSouthWest()),L=o.ae(-f),H=R.rotate(L),B=T.rotate(L),W=D.rotate(L),Z=k.rotate(L),ee=new o.P(Math.max(H.x,B.x,Z.x,W.x),Math.max(H.y,B.y,Z.y,W.y)),te=new o.P(Math.min(H.x,B.x,Z.x,W.x),Math.min(H.y,B.y,Z.y,W.y)),ie=ee.sub(te),oe=(v.width-(x.left+x.right+r.left+r.right))/ie.x,le=(v.height-(x.top+x.bottom+r.top+r.bottom))/ie.y;if(le<0||oe<0)return void fg();let ne=Math.min(o.ak(v.scale*Math.min(oe,le)),w.maxZoom),ue=o.P.convert(w.offset),ge=new o.P((r.left-r.right)/2,(r.top-r.bottom)/2).rotate(o.ae(f)),re=ue.add(ge).mult(v.scale/o.af(ne));return{center:he(v.worldSize,R.add(D).div(2).sub(re)),zoom:ne,bearing:f}}class xs{get useGlobeControls(){return!1}handlePanInertia(r,u){let f=r.mag(),v=Math.abs(de(u));return{easingOffset:r.mult(Math.min(.75*v/f,1)),easingCenter:u.center}}handleMapControlsRollPitchBearingZoom(r,u){r.bearingDelta&&u.setBearing(u.bearing+r.bearingDelta),r.pitchDelta&&u.setPitch(u.pitch+r.pitchDelta),r.rollDelta&&u.setRoll(u.roll+r.rollDelta),r.zoomDelta&&u.setZoom(u.zoom+r.zoomDelta)}handleMapControlsPan(r,u,f){r.around.distSqr(u.centerPoint)<.01||u.setLocationAtPoint(f,r.around)}cameraForBoxAndBearing(r,u,f,v,x){return Ys(r,u,f,v,x)}handleJumpToCenterZoom(r,u){r.zoom!==(u.zoom!==void 0?+u.zoom:r.zoom)&&r.setZoom(+u.zoom),u.center!==void 0&&r.setCenter(o.S.convert(u.center))}handleEaseTo(r,u){let f=r.zoom,v=r.padding,x={roll:r.roll,pitch:r.pitch,bearing:r.bearing},R={roll:u.roll===void 0?r.roll:u.roll,pitch:u.pitch===void 0?r.pitch:u.pitch,bearing:u.bearing===void 0?r.bearing:u.bearing},T=u.zoom!==void 0,D=!r.isPaddingEqual(u.padding),k=!1,L=T?+u.zoom:r.zoom,H=r.centerPoint.add(u.offsetAsPoint),B=r.screenPointToLocation(H),{center:W,zoom:Z}=r.getConstrained(o.S.convert(u.center||B),L??f);Rc(r,W);let ee=Y(r.worldSize,B),te=Y(r.worldSize,W).sub(ee),ie=o.af(Z-f);return k=Z!==f,{easeFunc:oe=>{if(k&&r.setZoom(o.C.number(f,Z,oe)),o.be(x,R)||Fs({startEulerAngles:x,endEulerAngles:R,tr:r,k:oe,useSlerp:x.roll!=R.roll}),D&&(r.interpolatePadding(v,u.padding,oe),H=r.centerPoint.add(u.offsetAsPoint)),u.around)r.setLocationAtPoint(u.around,u.aroundPoint);else{let le=o.af(r.zoom-f),ne=Z>f?Math.min(2,ie):Math.max(.5,ie),ue=Math.pow(ne,1-oe),ge=he(r.worldSize,ee.add(te.mult(oe*ue)).mult(le));r.setLocationAtPoint(r.renderWorldCopies?ge.wrap():ge,H)}},isZooming:k,elevationCenter:W}}handleFlyTo(r,u){let f=u.zoom!==void 0,v=r.zoom,x=r.getConstrained(o.S.convert(u.center||u.locationAtOffset),f?+u.zoom:v),R=x.center,T=x.zoom;Rc(r,R);let D=Y(r.worldSize,u.locationAtOffset),k=Y(r.worldSize,R).sub(D),L=k.mag(),H=o.af(T-v),B;if(u.minZoom!==void 0){let W=Math.min(+u.minZoom,v,T),Z=r.getConstrained(R,W).zoom;B=o.af(Z-v)}return{easeFunc:(W,Z,ee,te)=>{r.setZoom(W===1?T:v+o.ak(Z));let ie=W===1?R:he(r.worldSize,D.add(k.mult(ee)).mult(Z));r.setLocationAtPoint(r.renderWorldCopies?ie.wrap():ie,te)},scaleOfZoom:H,targetCenter:R,scaleOfMinZoom:B,pixelPathLength:L}}}class pi{constructor(r,u,f){this.blendFunction=r,this.blendColor=u,this.mask=f}}pi.Replace=[1,0],pi.disabled=new pi(pi.Replace,o.bf.transparent,[!1,!1,!1,!1]),pi.unblended=new pi(pi.Replace,o.bf.transparent,[!0,!0,!0,!0]),pi.alphaBlended=new pi([1,771],o.bf.transparent,[!0,!0,!0,!0]);let wr=2305;class yt{constructor(r,u,f){this.enable=r,this.mode=u,this.frontFace=f}}yt.disabled=new yt(!1,1029,wr),yt.backCCW=new yt(!0,1029,wr),yt.frontCCW=new yt(!0,1028,wr);class Pt{constructor(r,u,f){this.func=r,this.mask=u,this.range=f}}Pt.ReadOnly=!1,Pt.ReadWrite=!0,Pt.disabled=new Pt(519,Pt.ReadOnly,[0,1]);let ln=7680;class Ut{constructor(r,u,f,v,x,R){this.test=r,this.ref=u,this.mask=f,this.fail=v,this.depthFail=x,this.pass=R}}Ut.disabled=new Ut({func:519,mask:0},0,0,ln,ln,ln);let Qs=new WeakMap;function Uo(w){var r;if(Qs.has(w))return Qs.get(w);{let u=(r=w.getParameter(w.VERSION))===null||r===void 0?void 0:r.startsWith("WebGL 2.0");return Qs.set(w,u),u}}class jo{get awaitingQuery(){return!!this._readbackQueue}constructor(r){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=r;let u=r.context,f=u.gl;this._texFormat=f.RGBA,this._texType=f.UNSIGNED_BYTE;let v=new o.aL;v.emplaceBack(-1,-1),v.emplaceBack(2,-1),v.emplaceBack(-1,2);let x=new o.aN;x.emplaceBack(0,1,2),this._fullscreenTriangle=new mr(u.createVertexBuffer(v,On.members),u.createIndexBuffer(x),o.aM.simpleSegment(0,0,v.length,x.length)),this._resultBuffer=new Uint8Array(4),u.activeTexture.set(f.TEXTURE1);let R=f.createTexture();f.bindTexture(f.TEXTURE_2D,R),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texImage2D(f.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=u.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(R),Uo(f)&&(this._pbo=f.createBuffer(),f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.bufferData(f.PIXEL_PACK_BUFFER,4,f.STREAM_READ),f.bindBuffer(f.PIXEL_PACK_BUFFER,null))}destroy(){let r=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),r.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(r,u){let f=this._updateCount;return this._readbackQueue?f>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():f>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(r,u),this._updateCount++,this._measuredError}_bindFramebuffer(){let r=this._cachedRenderContext.context,u=r.gl;r.activeTexture.set(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,this._fbo.colorAttachment.get()),r.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(r,u){let f=this._cachedRenderContext.context,v=f.gl;if(this._bindFramebuffer(),f.viewport.set([0,0,this._texWidth,this._texHeight]),f.clear({color:o.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(f,v.TRIANGLES,Pt.disabled,Ut.disabled,pi.unblended,yt.disabled,((x,R)=>({u_input:x,u_output_expected:R}))(r,u),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Uo(v)){v.bindBuffer(v.PIXEL_PACK_BUFFER,this._pbo),v.readBuffer(v.COLOR_ATTACHMENT0),v.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),v.bindBuffer(v.PIXEL_PACK_BUFFER,null);let x=v.fenceSync(v.SYNC_GPU_COMMANDS_COMPLETE,0);v.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:x}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){let r=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Uo(r)){let u=r.clientWaitSync(this._readbackQueue.sync,0,0);if(u===r.WAIT_FAILED)return o.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(u===r.TIMEOUT_EXPIRED)return;r.bindBuffer(r.PIXEL_PACK_BUFFER,this._pbo),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),r.bindBuffer(r.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),r.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=jo._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(r){let u=0;return u+=r[0]/256,u+=r[1]/65536,u+=r[2]/16777216,r[3]<127&&(u=-u),u/128}}let Pc=o.$/128;function Gu(w,r){let u=w.granularity!==void 0?Math.max(w.granularity,1):1,f=u+(w.generateBorders?2:0),v=u+(w.extendToNorthPole||w.generateBorders?1:0)+(w.extendToSouthPole||w.generateBorders?1:0),x=f+1,R=v+1,T=w.generateBorders?-1:0,D=w.generateBorders||w.extendToNorthPole?-1:0,k=u+(w.generateBorders?1:0),L=u+(w.generateBorders||w.extendToSouthPole?1:0),H=x*R,B=f*v*6,W=x*R>65536;if(W&&r==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");let Z=W||r==="32bit",ee=new Int16Array(2*H),te=0;for(let le=D;le<=L;le++)for(let ne=T;ne<=k;ne++){let ue=ne/u*o.$;ne===-1&&(ue=-Pc),ne===u+1&&(ue=o.$+Pc);let ge=le/u*o.$;le===-1&&(ge=w.extendToNorthPole?o.bh:-Pc),le===u+1&&(ge=w.extendToSouthPole?o.bi:o.$+Pc),ee[te++]=ue,ee[te++]=ge}let ie=Z?new Uint32Array(B):new Uint16Array(B),oe=0;for(let le=0;le<v;le++)for(let ne=0;ne<f;ne++){let ue=ne+1+le*x,ge=ne+(le+1)*x,re=ne+1+(le+1)*x;ie[oe++]=ne+le*x,ie[oe++]=ge,ie[oe++]=ue,ie[oe++]=ue,ie[oe++]=ge,ie[oe++]=re}return{vertices:ee.buffer.slice(0),indices:ie.buffer.slice(0),uses32bitIndices:Z}}let fa=new o.aK({fill:new o.bj(128,2),line:new o.bj(512,0),tile:new o.bj(128,32),stencil:new o.bj(128,1),circle:3});class dl{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return _o.projectionGlobe}get vertexShaderPreludeCode(){return _o.projectionMercator.vertexSource}get subdivisionGranularity(){return fa}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(r){this._errorMeasurement||(this._errorMeasurement=new jo(r));let u=o.U(this._errorQueryLatitudeDegrees),f=2*Math.atan(Math.exp(Math.PI-u*Math.PI*2))-.5*Math.PI,v=this._errorMeasurement.updateErrorLoop(u,f),x=C.now();v!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=v,this._errorMeasurementLastChangeTime=x);let R=Math.min(Math.max((x-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=o.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,o.bl(R))}_getMeshKey(r){return`${r.granularity.toString(36)}_${r.generateBorders?"b":""}${r.extendToNorthPole?"n":""}${r.extendToSouthPole?"s":""}`}getMeshFromTileID(r,u,f,v,x){let R=(x==="stencil"?fa.stencil:fa.tile).getGranularityForZoomLevel(u.z);return this._getMesh(r,{granularity:R,generateBorders:f,extendToNorthPole:u.y===0&&v,extendToSouthPole:u.y===(1<<u.z)-1&&v})}_getMesh(r,u){let f=this._getMeshKey(u);if(f in this._tileMeshCache)return this._tileMeshCache[f];let v=function(x,R){let T=Gu(R,"16bit"),D=o.aL.deserialize({arrayBuffer:T.vertices,length:T.vertices.byteLength/2/2}),k=o.aN.deserialize({arrayBuffer:T.indices,length:T.indices.byteLength/2/3});return new mr(x.createVertexBuffer(D,On.members),x.createIndexBuffer(k),o.aM.simpleSegment(0,0,D.length,k.length))}(r,u);return this._tileMeshCache[f]=v,v}recalculate(r){}hasTransition(){let r=C.now(),u=!1;return u=u||(r-this._errorMeasurementLastChangeTime)/1e3<.7,u=u||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,u}setErrorQueryLatitudeDegrees(r){this._errorQueryLatitudeDegrees=r}}let Mc=new o.r({type:new o.D(o.v.projection.type)});class Tc extends o.E{constructor(r){super(),this._transitionable=new o.t(Mc,void 0),this.setProjection(r),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new o.F(0)),this._mercatorProjection=new Ot,this._verticalPerspectiveProjection=new dl}get transitionState(){let r=this.properties.get("type");if(typeof r=="string"&&r==="mercator")return 0;if(typeof r=="string"&&r==="vertical-perspective")return 1;if(r instanceof o.bm){if(r.from==="vertical-perspective"&&r.to==="mercator")return 1-r.transition;if(r.from==="mercator"&&r.to==="vertical-perspective")return r.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(r){this._mercatorProjection.updateGPUdependent(r),this._verticalPerspectiveProjection.updateGPUdependent(r)}getMeshFromTileID(r,u,f,v,x){return this.currentProjection.getMeshFromTileID(r,u,f,v,x)}setProjection(r){this._transitionable.setValue("type",r?.type||"mercator")}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}setErrorQueryLatitudeDegrees(r){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(r),this._mercatorProjection.setErrorQueryLatitudeDegrees(r)}}function Dc(w){let r=ma(w.worldSize,w.center.lat);return 2*Math.PI*r}function So(w,r,u,f,v){let x=1/(1<<v),R=r/o.$*x+f*x,T=o.bo((w/o.$*x+u*x)*Math.PI*2+Math.PI,2*Math.PI),D=2*Math.atan(Math.exp(Math.PI-R*Math.PI*2))-.5*Math.PI,k=Math.cos(D),L=new Float64Array(3);return L[0]=Math.sin(T)*k,L[1]=Math.sin(D),L[2]=Math.cos(T)*k,L}function ls(w){return function(r,u){let f=Math.cos(u),v=new Float64Array(3);return v[0]=Math.sin(r)*f,v[1]=Math.sin(u),v[2]=Math.cos(r)*f,v}(w.lng*Math.PI/180,w.lat*Math.PI/180)}function ma(w,r){return w/(2*Math.PI)/Math.cos(r*Math.PI/180)}function pl(w){let r=Math.asin(w[1])/Math.PI*180,u=Math.sqrt(w[0]*w[0]+w[2]*w[2]);if(u>1e-6){let f=w[0]/u,v=Math.acos(w[2]/u),x=(f>0?v:-v)/Math.PI*180;return new o.S(o.aO(x,-180,180),r)}return new o.S(0,r)}function Cr(w){return Math.cos(w*Math.PI/180)}function Ai(w,r){let u=Cr(w),f=Cr(r);return o.ak(f/u)}function mg(w,r){let u=w.rotate(r.bearingInRadians),f=r.zoom+Ai(r.center.lat,0),v=o.bk(1/Cr(r.center.lat),1/Cr(Math.min(Math.abs(r.center.lat),60)),o.bn(f,7,3,0,1)),x=360/Dc({worldSize:r.worldSize,center:{lat:r.center.lat}});return new o.S(r.center.lng-u.x*x*v,o.ah(r.center.lat+u.y*x,-o.ai,o.ai))}function gl(w){let r=.5*w,u=Math.sin(r),f=Math.cos(r);return Math.log(u+f)-Math.log(f-u)}function Wu(w,r,u,f){let v=w.lat+u*f;if(Math.abs(u)>1){let x=(Math.sign(w.lat+u)!==Math.sign(w.lat)?-Math.abs(w.lat):Math.abs(w.lat))*Math.PI/180,R=Math.abs(w.lat+u)*Math.PI/180,T=gl(x+f*(R-x)),D=gl(x),k=gl(R);return new o.S(w.lng+r*((T-D)/(k-D)),v)}return new o.S(w.lng+r*f,v)}class Lv{constructor(r){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=r}swapBuffers(){if(!this._hadAnyChanges)return;let r=this._cachePrevious;this._cachePrevious=this._cache,this._cache=r,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(r,u,f,v){let x=`${r.z}_${r.x}_${r.y}_${v?.terrain?"t":""}`,R=this._cache.get(x);if(R)return R;let T=this._cachePrevious.get(x);if(T)return this._cache.set(x,T),T;let D=this._boundingVolumeFactory(r,u,f,v);return this._cache.set(x,D),this._hadAnyChanges=!0,D}}class va{constructor(r,u,f,v){this.min=f,this.max=v,this.points=r,this.planes=u}static fromAabb(r,u){let f=[];for(let v=0;v<8;v++)f.push([1&~v?r[0]:u[0],(v>>1&1)==1?u[1]:r[1],(v>>2&1)==1?u[2]:r[2]]);return new va(f,[[-1,0,0,u[0]],[1,0,0,-r[0]],[0,-1,0,u[1]],[0,1,0,-r[1]],[0,0,-1,u[2]],[0,0,1,-r[2]]],r,u)}static fromCenterSizeAngles(r,u,f){let v=o.br([],f[0],f[1],f[2]),x=o.bs([],[u[0],0,0],v),R=o.bs([],[0,u[1],0],v),T=o.bs([],[0,0,u[2]],v),D=[...r],k=[...r];for(let H=0;H<8;H++)for(let B=0;B<3;B++){let W=r[B]+x[B]*(1&~H?-1:1)+R[B]*((H>>1&1)==1?1:-1)+T[B]*((H>>2&1)==1?1:-1);D[B]=Math.min(D[B],W),k[B]=Math.max(k[B],W)}let L=[];for(let H=0;H<8;H++){let B=[...r];o.aS(B,B,o.aR([],x,1&~H?-1:1)),o.aS(B,B,o.aR([],R,(H>>1&1)==1?1:-1)),o.aS(B,B,o.aR([],T,(H>>2&1)==1?1:-1)),L.push(B)}return new va(L,[[...x,-o.aX(x,L[0])],[...R,-o.aX(R,L[0])],[...T,-o.aX(T,L[0])],[-x[0],-x[1],-x[2],-o.aX(x,L[7])],[-R[0],-R[1],-R[2],-o.aX(R,L[7])],[-T[0],-T[1],-T[2],-o.aX(T,L[7])]],D,k)}intersectsFrustum(r){let u=!0,f=this.points.length,v=this.planes.length,x=r.planes.length,R=r.points.length;for(let T=0;T<x;T++){let D=r.planes[T],k=0;for(let L=0;L<f;L++){let H=this.points[L];D[0]*H[0]+D[1]*H[1]+D[2]*H[2]+D[3]>=0&&k++}if(k===0)return 0;k<f&&(u=!1)}if(u)return 2;for(let T=0;T<v;T++){let D=this.planes[T],k=0;for(let L=0;L<R;L++){let H=r.points[L];D[0]*H[0]+D[1]*H[1]+D[2]*H[2]+D[3]>=0&&k++}if(k===0)return 0}return 1}intersectsPlane(r){let u=this.points.length,f=0;for(let v=0;v<u;v++){let x=this.points[v];r[0]*x[0]+r[1]*x[1]+r[2]*x[2]+r[3]>=0&&f++}return f===u?2:f===0?0:1}}function ms(w,r,u){let f=w-r;return f<0?-f:Math.max(0,f-u)}function fl(w,r,u,f,v){let x=w-u,R;return R=x<0?Math.min(-x,1+x-v):x>1?Math.min(Math.max(x-v,0),1-x):0,Math.max(R,ms(r,f,v))}class $o{constructor(){this._boundingVolumeCache=new Lv(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(r,u,f,v){let x=1<<f.z,R=1/x,T=f.x/x,D=f.y/x,k=2;return k=Math.min(k,fl(r,u,T,D,R)),k=Math.min(k,fl(r,u,T+.5,-D-R,R)),k=Math.min(k,fl(r,u,T+.5,2-D-R,R)),k}getWrap(r,u,f){let v=1<<u.z,x=1/v,R=u.x/v,T=ms(r.x,R,x),D=ms(r.x,R-1,x),k=ms(r.x,R+1,x),L=Math.min(T,D,k);return L===k?1:L===D?-1:0}allowVariableZoom(r,u){return ct(r,u)>4}allowWorldCopies(){return!1}getTileBoundingVolume(r,u,f,v){return this._boundingVolumeCache.getTileBoundingVolume(r,u,f,v)}_computeTileBoundingVolume(r,u,f,v){var x,R;let T=0,D=0;if(v?.terrain){let k=new o.Z(r.z,u,r.z,r.x,r.y),L=v.terrain.getMinMaxElevation(k);T=(x=L.minElevation)!==null&&x!==void 0?x:Math.min(0,f),D=(R=L.maxElevation)!==null&&R!==void 0?R:Math.max(0,f)}if(T/=o.bu,D/=o.bu,T+=1,D+=1,r.z<=0)return va.fromAabb([-D,-D,-D],[D,D,D]);if(r.z===1)return va.fromAabb([r.x===0?-D:0,r.y===0?0:-D,-D],[r.x===0?0:D,r.y===0?D:0,D]);{let k=[So(0,0,r.x,r.y,r.z),So(o.$,0,r.x,r.y,r.z),So(o.$,o.$,r.x,r.y,r.z),So(0,o.$,r.x,r.y,r.z)],L=[];for(let Ee of k)L.push(o.aR([],Ee,D));if(D!==T)for(let Ee of k)L.push(o.aR([],Ee,T));r.y===0&&L.push([0,1,0]),r.y===(1<<r.z)-1&&L.push([0,-1,0]);let H=[1,1,1],B=[-1,-1,-1];for(let Ee of L)for(let De=0;De<3;De++)H[De]=Math.min(H[De],Ee[De]),B[De]=Math.max(B[De],Ee[De]);let W=So(o.$/2,o.$/2,r.x,r.y,r.z),Z=o.aW([],[0,1,0],W);o.aV(Z,Z);let ee=o.aW([],W,Z);o.aV(ee,ee);let te=o.aW([],k[2],k[1]);o.aV(te,te);let ie=o.aW([],k[0],k[3]);o.aV(ie,ie),L.push(o.aR([],W,D)),r.y>=(1<<r.z)/2&&L.push(o.aR([],So(o.$/2,0,r.x,r.y,r.z),D)),r.y<(1<<r.z)/2&&L.push(o.aR([],So(o.$/2,o.$,r.x,r.y,r.z),D));let oe=ml(W,L),le=ml(ee,L),ne=[-W[0],-W[1],-W[2],oe.max],ue=[W[0],W[1],W[2],-oe.min],ge=[-ee[0],-ee[1],-ee[2],le.max],re=[ee[0],ee[1],ee[2],-le.min],we=[...te,0],Te=[...ie,0],Re=[];return r.y===0?Re.push(o.bt(Te,we,ne),o.bt(Te,we,ue)):Re.push(o.bt(ge,we,ne),o.bt(ge,we,ue),o.bt(ge,Te,ne),o.bt(ge,Te,ue)),r.y===(1<<r.z)-1?Re.push(o.bt(Te,we,ne),o.bt(Te,we,ue)):Re.push(o.bt(re,we,ne),o.bt(re,we,ue),o.bt(re,Te,ne),o.bt(re,Te,ue)),new va(Re,[ne,ue,ge,re,we,Te],H,B)}}}function ml(w,r){let u=1/0,f=-1/0;for(let v of r){let x=o.aX(w,v);u=Math.min(u,x),f=Math.max(f,x)}return{min:u,max:f}}class vl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(r){this._helper.setMinZoom(r)}setMaxZoom(r){this._helper.setMaxZoom(r)}setMinPitch(r){this._helper.setMinPitch(r)}setMaxPitch(r){this._helper.setMaxPitch(r)}setRenderWorldCopies(r){this._helper.setRenderWorldCopies(r)}setBearing(r){this._helper.setBearing(r)}setPitch(r){this._helper.setPitch(r)}setRoll(r){this._helper.setRoll(r)}setFov(r){this._helper.setFov(r)}setZoom(r){this._helper.setZoom(r)}setCenter(r){this._helper.setCenter(r)}setElevation(r){this._helper.setElevation(r)}setMinElevationForCurrentTile(r){this._helper.setMinElevationForCurrentTile(r)}setPadding(r){this._helper.setPadding(r)}interpolatePadding(r,u,f){return this._helper.interpolatePadding(r,u,f)}isPaddingEqual(r){return this._helper.isPaddingEqual(r)}resize(r,u){this._helper.resize(r,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(r){this._helper.setMaxBounds(r)}overrideNearFarZ(r,u){this._helper.overrideNearFarZ(r,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(r){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),r)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(r){}constructor(){this._cachedClippingPlane=o.bv(),this._projectionMatrix=o.b9(),this._globeViewProjMatrix32f=o.b8(),this._globeViewProjMatrixNoCorrection=o.b9(),this._globeViewProjMatrixNoCorrectionInverted=o.b9(),this._globeProjMatrixInverted=o.b9(),this._cameraPosition=o.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Ts({calcMatrices:()=>{this._calcMatrices()},getConstrained:(r,u)=>this.getConstrained(r,u)}),this._coveringTilesDetailsProvider=new $o}clone(){let r=new vl;return r.apply(this),r}apply(r,u){this._globeLatitudeErrorCorrectionRadians=u||0,this._helper.apply(r)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){let r=o.bp();return r[0]=this._cameraPosition[0],r[1]=this._cameraPosition[1],r[2]=this._cameraPosition[2],r}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(r){let{overscaledTileID:u,applyGlobeMatrix:f}=r,v=this._helper.getMercatorTileCoordinates(u);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:v,clippingPlane:this._cachedClippingPlane,projectionTransition:f?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(r){let u=this.pitchInRadians,f=this.cameraToCenterDistance/r,v=Math.sin(u)*f,x=Math.cos(u)*f+1,R=1/Math.sqrt(v*v+x*x)*1,T=-v,D=x,k=Math.sqrt(T*T+D*D);T/=k,D/=k;let L=[0,T,D];o.bw(L,L,[0,0,0],-this.bearingInRadians),o.bx(L,L,[0,0,0],-1*this.center.lat*Math.PI/180),o.by(L,L,[0,0,0],this.center.lng*Math.PI/180);let H=1/o.aZ(L);return o.aR(L,L,H),[...L,-R*H]}isLocationOccluded(r){return!this.isSurfacePointVisible(ls(r))}transformLightDirection(r){let u=this._helper._center.lng*Math.PI/180,f=this._helper._center.lat*Math.PI/180,v=Math.cos(f),x=[Math.sin(u)*v,Math.sin(f),Math.cos(u)*v],R=[x[2],0,-x[0]],T=[0,0,0];o.aW(T,R,x),o.aV(R,R),o.aV(T,T);let D=[0,0,0];return o.aV(D,[R[0]*r[0]+T[0]*r[1]+x[0]*r[2],R[1]*r[0]+T[1]*r[1]+x[1]*r[2],R[2]*r[0]+T[2]*r[1]+x[2]*r[2]]),D}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(r,u,f){let v=function(T,D,k){let L=1/(1<<k.z);return new o.a1(T/o.$*L+k.x*L,D/o.$*L+k.y*L)}(r,u,f.canonical),x=(R=v.y,[o.bo(v.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-R*Math.PI*2))-.5*Math.PI]);var R;return this.getCircleRadiusCorrection()/Math.cos(x[1])}projectTileCoordinates(r,u,f,v){let x=f.canonical,R=So(r,u,x.x,x.y,x.z),T=1+(v?v(r,u):0)/o.bu,D=[R[0]*T,R[1]*T,R[2]*T,1];o.aw(D,D,this._globeViewProjMatrixNoCorrection);let k=this._cachedClippingPlane,L=k[0]*R[0]+k[1]*R[1]+k[2]*R[2]+k[3]<0;return{point:new o.P(D[0]/D[3],D[1]/D[3]),signedDistanceFromCamera:D[3],isOccluded:L}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;let r=ma(this.worldSize,this.center.lat),u=o.ba(),f=o.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*r),o.b4(u,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);let v=this.centerOffset;u[8]=2*-v.x/this._helper._width,u[9]=2*v.y/this._helper._height,this._projectionMatrix=o.b5(u),this._globeProjMatrixInverted=o.ba(),o.aq(this._globeProjMatrixInverted,u),o.M(u,u,[0,0,-this.cameraToCenterDistance]),o.b6(u,u,this.rollInRadians),o.b7(u,u,-this.pitchInRadians),o.b6(u,u,this.bearingInRadians),o.M(u,u,[0,0,-r]);let x=o.bp();x[0]=r,x[1]=r,x[2]=r,o.b7(f,u,this.center.lat*Math.PI/180),o.bz(f,f,-this.center.lng*Math.PI/180),o.N(f,f,x),this._globeViewProjMatrixNoCorrection=f,o.b7(u,u,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),o.bz(u,u,-this.center.lng*Math.PI/180),o.N(u,u,x),this._globeViewProjMatrix32f=new Float32Array(u),this._globeViewProjMatrixNoCorrectionInverted=o.ba(),o.aq(this._globeViewProjMatrixNoCorrectionInverted,f);let R=o.bp();this._cameraPosition=o.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/r,o.bw(this._cameraPosition,this._cameraPosition,R,-this.rollInRadians),o.bx(this._cameraPosition,this._cameraPosition,R,this.pitchInRadians),o.bw(this._cameraPosition,this._cameraPosition,R,-this.bearingInRadians),o.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),o.bx(this._cameraPosition,this._cameraPosition,R,-this.center.lat*Math.PI/180),o.by(this._cameraPosition,this._cameraPosition,R,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(r);let T=o.b5(this._globeViewProjMatrixNoCorrectionInverted);o.N(T,T,[1,1,-1]),this._cachedFrustum=Zi.fromInvProjectionMatrix(T,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(r){o.w("calculateFogMatrix is not supported on globe projection.");let u=o.ba();return o.ag(u),u}getVisibleUnwrappedCoordinates(r){return[new o.b2(0,r)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(r){r&&o.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(r,u){if(!this._globeViewProjMatrixNoCorrection)return 1;let f=ls(r);o.aR(f,f,1+u/o.bu);let v=o.bv();return o.aw(v,[f[0],f[1],f[2],1],this._globeViewProjMatrixNoCorrection),v[2]/v[3]}populateCache(r){}getBounds(){let r=.5*this.width,u=.5*this.height,f=[new o.P(0,0),new o.P(r,0),new o.P(this.width,0),new o.P(this.width,u),new o.P(this.width,this.height),new o.P(r,this.height),new o.P(0,this.height),new o.P(0,u)],v=[];for(let H of f)v.push(this.unprojectScreenPoint(H));let x=0,R=0,T=0,D=0,k=this.center;for(let H of v){let B=o.bA(k.lng,H.lng),W=o.bA(k.lat,H.lat);B<R&&(R=B),B>x&&(x=B),W<D&&(D=W),W>T&&(T=W)}let L=[k.lng+R,k.lat+D,k.lng+x,k.lat+T];return this.isSurfacePointOnScreen([0,1,0])&&(L[3]=90,L[0]=-180,L[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(L[1]=-90,L[0]=-180,L[2]=180),new Ii(L)}getConstrained(r,u){let f=o.ah(r.lat,-o.ai,o.ai),v=o.ah(+u,this.minZoom+Ai(0,f),this.maxZoom);return{center:new o.S(r.lng,f),zoom:v}}calculateCenterFromCameraLngLatAlt(r,u,f,v){return this._helper.calculateCenterFromCameraLngLatAlt(r,u,f,v)}setLocationAtPoint(r,u){let f=ls(this.unprojectScreenPoint(u)),v=ls(r),x=o.bp();o.bB(x);let R=o.bp();o.by(R,f,x,-this.center.lng*Math.PI/180),o.bx(R,R,x,this.center.lat*Math.PI/180);let T=v[0]*v[0]+v[2]*v[2],D=R[0]*R[0];if(T<D)return;let k=Math.sqrt(T-D),L=-k,H=o.bC(v[0],v[2],R[0],k),B=o.bC(v[0],v[2],R[0],L),W=o.bp();o.by(W,v,x,-H);let Z=o.bC(W[1],W[2],R[1],R[2]),ee=o.bp();o.by(ee,v,x,-B);let te=o.bC(ee[1],ee[2],R[1],R[2]),ie=.5*Math.PI,oe=Z>=-ie&&Z<=ie,le=te>=-ie&&te<=ie,ne,ue;if(oe&&le){let Te=this.center.lng*Math.PI/180,Re=this.center.lat*Math.PI/180;o.bD(H,Te)+o.bD(Z,Re)<o.bD(B,Te)+o.bD(te,Re)?(ne=H,ue=Z):(ne=B,ue=te)}else if(oe)ne=H,ue=Z;else{if(!le)return;ne=B,ue=te}let ge=ne/Math.PI*180,re=ue/Math.PI*180,we=this.center.lat;this.setCenter(new o.S(ge,o.ah(re,-90,90))),this.setZoom(this.zoom+Ai(we,this.center.lat))}locationToScreenPoint(r,u){let f=ls(r);if(u){let v=u.getElevationForLngLatZoom(r,this._helper._tileZoom);o.aR(f,f,1+v/o.bu)}return this._projectSurfacePointToScreen(f)}_projectSurfacePointToScreen(r){let u=o.bv();return o.aw(u,[...r,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],new o.P((.5*u[0]+.5)*this.width,(.5*-u[1]+.5)*this.height)}screenPointToMercatorCoordinate(r,u){if(u){let f=u.pointCoordinate(r);if(f)return f}return o.a1.fromLngLat(this.unprojectScreenPoint(r))}screenPointToLocation(r,u){var f;return(f=this.screenPointToMercatorCoordinate(r,u))===null||f===void 0?void 0:f.toLngLat()}isPointOnMapSurface(r,u){let f=this._cameraPosition,v=this.getRayDirectionFromPixel(r);return!!this.rayPlanetIntersection(f,v)}getRayDirectionFromPixel(r){let u=o.bv();u[0]=r.x/this.width*2-1,u[1]=-1*(r.y/this.height*2-1),u[2]=1,u[3]=1,o.aw(u,u,this._globeViewProjMatrixNoCorrectionInverted),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3];let f=o.bp();f[0]=u[0]-this._cameraPosition[0],f[1]=u[1]-this._cameraPosition[1],f[2]=u[2]-this._cameraPosition[2];let v=o.bp();return o.aV(v,f),v}isSurfacePointVisible(r){let u=this._cachedClippingPlane;return u[0]*r[0]+u[1]*r[1]+u[2]*r[2]+u[3]>=0}isSurfacePointOnScreen(r){if(!this.isSurfacePointVisible(r))return!1;let u=o.bv();return o.aw(u,[...r,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3],u[0]>-1&&u[0]<1&&u[1]>-1&&u[1]<1&&u[2]>-1&&u[2]<1}rayPlanetIntersection(r,u){let f=o.aX(r,u),v=o.bp(),x=o.bp();o.aR(x,u,f),o.aU(v,r,x);let R=1-o.aX(v,v);if(R<0)return null;let T=o.aX(r,r)-1,D=-f+(f<0?1:-1)*Math.sqrt(R),k=T/D,L=D;return{tMin:Math.min(k,L),tMax:Math.max(k,L)}}unprojectScreenPoint(r){let u=this._cameraPosition,f=this.getRayDirectionFromPixel(r),v=this.rayPlanetIntersection(u,f);if(v){let L=o.bp();o.aS(L,u,[f[0]*v.tMin,f[1]*v.tMin,f[2]*v.tMin]);let H=o.bp();return o.aV(H,L),pl(H)}let x=this._cachedClippingPlane,R=x[0]*f[0]+x[1]*f[1]+x[2]*f[2],T=-o.b1(x,u)/R,D=o.bp();if(T>0)o.aS(D,u,[f[0]*T,f[1]*T,f[2]*T]);else{let L=o.bp();o.aS(L,u,[2*f[0],2*f[1],2*f[2]]);let H=o.b1(this._cachedClippingPlane,L);o.aU(D,L,[this._cachedClippingPlane[0]*H,this._cachedClippingPlane[1]*H,this._cachedClippingPlane[2]*H])}let k=function(L){let H=o.bp();return H[0]=L[0]*-L[3],H[1]=L[1]*-L[3],H[2]=L[2]*-L[3],{center:H,radius:Math.sqrt(1-L[3]*L[3])}}(x);return pl(function(L,H,B){let W=o.bp();o.aU(W,B,L);let Z=o.bp();return o.bq(Z,L,W,H/o.a$(W)),Z}(k.center,k.radius,D))}getMatrixForModel(r,u){let f=o.S.convert(r),v=1/o.bu,x=o.b9();return o.bz(x,x,f.lng/180*Math.PI),o.b7(x,x,-f.lat/180*Math.PI),o.M(x,x,[0,0,1+u/o.bu]),o.b7(x,x,.5*Math.PI),o.N(x,x,[v,v,v]),x}getProjectionDataForCustomLayer(r=!0){let u=this.getProjectionData({overscaledTileID:new o.Z(0,0,0,0,0),applyGlobeMatrix:r});return u.tileMercatorCoords=[0,0,1,1],u}getFastPathSimpleProjectionMatrix(r){}}class yl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(r){this._helper.setMinZoom(r)}setMaxZoom(r){this._helper.setMaxZoom(r)}setMinPitch(r){this._helper.setMinPitch(r)}setMaxPitch(r){this._helper.setMaxPitch(r)}setRenderWorldCopies(r){this._helper.setRenderWorldCopies(r)}setBearing(r){this._helper.setBearing(r)}setPitch(r){this._helper.setPitch(r)}setRoll(r){this._helper.setRoll(r)}setFov(r){this._helper.setFov(r)}setZoom(r){this._helper.setZoom(r)}setCenter(r){this._helper.setCenter(r)}setElevation(r){this._helper.setElevation(r)}setMinElevationForCurrentTile(r){this._helper.setMinElevationForCurrentTile(r)}setPadding(r){this._helper.setPadding(r)}interpolatePadding(r,u,f){return this._helper.interpolatePadding(r,u,f)}isPaddingEqual(r){return this._helper.isPaddingEqual(r)}resize(r,u,f=!0){this._helper.resize(r,u,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(r){this._helper.setMaxBounds(r)}overrideNearFarZ(r,u){this._helper.overrideNearFarZ(r,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(r){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),r)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(r,u){this._globeness=r,this._globeLatitudeErrorCorrectionRadians=u,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Ts({calcMatrices:()=>{this._calcMatrices()},getConstrained:(r,u)=>this.getConstrained(r,u)}),this._globeness=1,this._mercatorTransform=new oi,this._verticalPerspectiveTransform=new vl}clone(){let r=new yl;return r._globeness=this._globeness,r._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,r.apply(this),r}apply(r){this._helper.apply(r),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(r){let u=this._mercatorTransform.getProjectionData(r),f=this._verticalPerspectiveTransform.getProjectionData(r);return{mainMatrix:this.isGlobeRendering?f.mainMatrix:u.mainMatrix,clippingPlane:f.clippingPlane,tileMercatorCoords:f.tileMercatorCoords,projectionTransition:r.applyGlobeMatrix?this._globeness:0,fallbackMatrix:u.fallbackMatrix}}isLocationOccluded(r){return this.currentTransform.isLocationOccluded(r)}transformLightDirection(r){return this.currentTransform.transformLightDirection(r)}getPixelScale(){return o.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return o.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(r,u,f){let v=this._mercatorTransform.getPitchedTextCorrection(r,u,f),x=this._verticalPerspectiveTransform.getPitchedTextCorrection(r,u,f);return o.bk(v,x,this._globeness)}projectTileCoordinates(r,u,f,v){return this.currentTransform.projectTileCoordinates(r,u,f,v)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(r){return this.currentTransform.calculateFogMatrix(r)}getVisibleUnwrappedCoordinates(r){return this.currentTransform.getVisibleUnwrappedCoordinates(r)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(r){this._mercatorTransform.recalculateZoomAndCenter(r),this._verticalPerspectiveTransform.recalculateZoomAndCenter(r)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(r,u){return this.currentTransform.lngLatToCameraDepth(r,u)}populateCache(r){this._mercatorTransform.populateCache(r),this._verticalPerspectiveTransform.populateCache(r)}getBounds(){return this.currentTransform.getBounds()}getConstrained(r,u){return this.currentTransform.getConstrained(r,u)}calculateCenterFromCameraLngLatAlt(r,u,f,v){return this._helper.calculateCenterFromCameraLngLatAlt(r,u,f,v)}setLocationAtPoint(r,u){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(r,u),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(r,u),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(r,u){return this.currentTransform.locationToScreenPoint(r,u)}screenPointToMercatorCoordinate(r,u){return this.currentTransform.screenPointToMercatorCoordinate(r,u)}screenPointToLocation(r,u){return this.currentTransform.screenPointToLocation(r,u)}isPointOnMapSurface(r,u){return this.currentTransform.isPointOnMapSurface(r,u)}getRayDirectionFromPixel(r){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(r)}getMatrixForModel(r,u){return this.currentTransform.getMatrixForModel(r,u)}getProjectionDataForCustomLayer(r=!0){let u=this._mercatorTransform.getProjectionDataForCustomLayer(r);if(!this.isGlobeRendering)return u;let f=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(r);return f.fallbackMatrix=u.mainMatrix,f}getFastPathSimpleProjectionMatrix(r){return this.currentTransform.getFastPathSimpleProjectionMatrix(r)}}class _s{get useGlobeControls(){return!0}handlePanInertia(r,u){let f=mg(r,u);return Math.abs(f.lng-u.center.lng)>180&&(f.lng=u.center.lng+179.5*Math.sign(f.lng-u.center.lng)),{easingCenter:f,easingOffset:new o.P(0,0)}}handleMapControlsRollPitchBearingZoom(r,u){let f=r.around,v=u.screenPointToLocation(f);r.bearingDelta&&u.setBearing(u.bearing+r.bearingDelta),r.pitchDelta&&u.setPitch(u.pitch+r.pitchDelta),r.rollDelta&&u.setRoll(u.roll+r.rollDelta);let x=u.zoom;r.zoomDelta&&u.setZoom(u.zoom+r.zoomDelta);let R=u.zoom-x;if(R===0)return;let T=o.bA(u.center.lng,v.lng),D=T/(Math.abs(T/180)+1),k=o.bA(u.center.lat,v.lat),L=u.getRayDirectionFromPixel(f),H=u.cameraPosition,B=-1*o.aX(H,L),W=o.bp();o.aS(W,H,[L[0]*B,L[1]*B,L[2]*B]);let Z=o.aZ(W)-1,ee=Math.exp(.5*-Math.max(Z-.3,0)),te=ma(u.worldSize,u.center.lat)/Math.min(u.width,u.height),ie=o.bn(te,.9,.5,1,.25),oe=(1-o.af(-R))*Math.min(ee,ie),le=u.center.lat,ne=u.zoom,ue=new o.S(u.center.lng+D*oe,o.ah(u.center.lat+k*oe,-o.ai,o.ai));u.setLocationAtPoint(v,f);let ge=u.center,re=o.bn(Math.abs(T),45,85,0,1),we=o.bn(te,.75,.35,0,1),Te=Math.pow(Math.max(re,we),.25),Re=o.bA(ge.lng,ue.lng),Ee=o.bA(ge.lat,ue.lat);u.setCenter(new o.S(ge.lng+Re*Te,ge.lat+Ee*Te).wrap()),u.setZoom(ne+Ai(le,u.center.lat))}handleMapControlsPan(r,u,f){if(!r.panDelta)return;let v=u.center.lat,x=u.zoom;u.setCenter(mg(r.panDelta,u).wrap()),u.setZoom(x+Ai(v,u.center.lat))}cameraForBoxAndBearing(r,u,f,v,x){let R=Ys(r,u,f,v,x),T=u.left/x.width*2-1,D=(x.width-u.right)/x.width*2-1,k=u.top/x.height*-2+1,L=(x.height-u.bottom)/x.height*-2+1,H=o.bA(f.getWest(),f.getEast())<0,B=H?f.getEast():f.getWest(),W=H?f.getWest():f.getEast(),Z=Math.max(f.getNorth(),f.getSouth()),ee=Math.min(f.getNorth(),f.getSouth()),te=B+.5*o.bA(B,W),ie=Z+.5*o.bA(Z,ee),oe=x.clone();oe.setCenter(R.center),oe.setBearing(R.bearing),oe.setPitch(0),oe.setRoll(0),oe.setZoom(R.zoom);let le=oe.modelViewProjectionMatrix,ne=[ls(f.getNorthWest()),ls(f.getNorthEast()),ls(f.getSouthWest()),ls(f.getSouthEast()),ls(new o.S(W,ie)),ls(new o.S(B,ie)),ls(new o.S(te,Z)),ls(new o.S(te,ee))],ue=ls(R.center),ge=Number.POSITIVE_INFINITY;for(let re of ne)T<0&&(ge=_s.getLesserNonNegativeNonNull(ge,_s.solveVectorScale(re,ue,le,"x",T))),D>0&&(ge=_s.getLesserNonNegativeNonNull(ge,_s.solveVectorScale(re,ue,le,"x",D))),k>0&&(ge=_s.getLesserNonNegativeNonNull(ge,_s.solveVectorScale(re,ue,le,"y",k))),L<0&&(ge=_s.getLesserNonNegativeNonNull(ge,_s.solveVectorScale(re,ue,le,"y",L)));if(Number.isFinite(ge)&&ge!==0)return R.zoom=oe.zoom+o.ak(ge),R;fg()}handleJumpToCenterZoom(r,u){let f=r.center.lat,v=r.getConstrained(u.center?o.S.convert(u.center):r.center,r.zoom).center;r.setCenter(v.wrap());let x=u.zoom!==void 0?+u.zoom:r.zoom+Ai(f,v.lat);r.zoom!==x&&r.setZoom(x)}handleEaseTo(r,u){let f=r.zoom,v=r.center,x=r.padding,R={roll:r.roll,pitch:r.pitch,bearing:r.bearing},T={roll:u.roll===void 0?r.roll:u.roll,pitch:u.pitch===void 0?r.pitch:u.pitch,bearing:u.bearing===void 0?r.bearing:u.bearing},D=u.zoom!==void 0,k=!r.isPaddingEqual(u.padding),L=!1,H=u.center?o.S.convert(u.center):v,B=r.getConstrained(H,f).center;Rc(r,B);let W=r.clone();W.setCenter(B),W.setZoom(D?+u.zoom:f+Ai(v.lat,H.lat)),W.setBearing(u.bearing);let Z=new o.P(o.ah(r.centerPoint.x+u.offsetAsPoint.x,0,r.width),o.ah(r.centerPoint.y+u.offsetAsPoint.y,0,r.height));W.setLocationAtPoint(B,Z);let ee=(u.offset&&u.offsetAsPoint.mag())>0?W.center:B,te=D?+u.zoom:f+Ai(v.lat,ee.lat),ie=f+Ai(v.lat,0),oe=te+Ai(ee.lat,0),le=o.bA(v.lng,ee.lng),ne=o.bA(v.lat,ee.lat),ue=o.af(oe-ie);return L=te!==f,{easeFunc:ge=>{if(o.be(R,T)||Fs({startEulerAngles:R,endEulerAngles:T,tr:r,k:ge,useSlerp:R.roll!=T.roll}),k&&r.interpolatePadding(x,u.padding,ge),u.around)o.w("Easing around a point is not supported under globe projection."),r.setLocationAtPoint(u.around,u.aroundPoint);else{let re=oe>ie?Math.min(2,ue):Math.max(.5,ue),we=Math.pow(re,1-ge),Te=Wu(v,le,ne,ge*we);r.setCenter(Te.wrap())}if(L){let re=o.C.number(ie,oe,ge)+Ai(0,r.center.lat);r.setZoom(re)}},isZooming:L,elevationCenter:ee}}handleFlyTo(r,u){let f=u.zoom!==void 0,v=r.center,x=r.zoom,R=r.padding,T=!r.isPaddingEqual(u.padding),D=r.getConstrained(o.S.convert(u.center||u.locationAtOffset),x).center,k=f?+u.zoom:r.zoom+Ai(r.center.lat,D.lat),L=r.clone();L.setCenter(D),L.setZoom(k),L.setBearing(u.bearing);let H=new o.P(o.ah(r.centerPoint.x+u.offsetAsPoint.x,0,r.width),o.ah(r.centerPoint.y+u.offsetAsPoint.y,0,r.height));L.setLocationAtPoint(D,H);let B=L.center;Rc(r,B);let W=function(ne,ue,ge){let re=ls(ue),we=ls(ge),Te=o.aX(re,we),Re=Math.acos(Te),Ee=Dc(ne);return Re/(2*Math.PI)*Ee}(r,v,B),Z=x+Ai(v.lat,0),ee=k+Ai(B.lat,0),te=o.af(ee-Z),ie;if(typeof u.minZoom=="number"){let ne=+u.minZoom+Ai(B.lat,0),ue=Math.min(ne,Z,ee)+Ai(0,B.lat),ge=r.getConstrained(B,ue).zoom+Ai(B.lat,0);ie=o.af(ge-Z)}let oe=o.bA(v.lng,B.lng),le=o.bA(v.lat,B.lat);return{easeFunc:(ne,ue,ge,re)=>{let we=Wu(v,oe,le,ge);T&&r.interpolatePadding(R,u.padding,ne);let Te=ne===1?B:we;r.setCenter(Te.wrap());let Re=Z+o.ak(ue);r.setZoom(ne===1?k:Re+Ai(0,Te.lat))},scaleOfZoom:te,targetCenter:B,scaleOfMinZoom:ie,pixelPathLength:W}}static solveVectorScale(r,u,f,v,x){let R=v==="x"?[f[0],f[4],f[8],f[12]]:[f[1],f[5],f[9],f[13]],T=[f[3],f[7],f[11],f[15]],D=r[0]*R[0]+r[1]*R[1]+r[2]*R[2],k=r[0]*T[0]+r[1]*T[1]+r[2]*T[2],L=u[0]*R[0]+u[1]*R[1]+u[2]*R[2],H=u[0]*T[0]+u[1]*T[1]+u[2]*T[2];return L+x*k===D+x*H||T[3]*(D-L)+R[3]*(H-k)+D*H==L*k?null:(L+R[3]-x*H-x*T[3])/(L-D-x*H+x*k)}static getLesserNonNegativeNonNull(r,u){return u!==null&&u>=0&&u<r?u:r}}class vg{constructor(r){this._globe=r,this._mercatorCameraHelper=new xs,this._verticalPerspectiveCameraHelper=new _s}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(r,u){return this.currentHelper.handlePanInertia(r,u)}handleMapControlsRollPitchBearingZoom(r,u){return this.currentHelper.handleMapControlsRollPitchBearingZoom(r,u)}handleMapControlsPan(r,u,f){this.currentHelper.handleMapControlsPan(r,u,f)}cameraForBoxAndBearing(r,u,f,v,x){return this.currentHelper.cameraForBoxAndBearing(r,u,f,v,x)}handleJumpToCenterZoom(r,u){this.currentHelper.handleJumpToCenterZoom(r,u)}handleEaseTo(r,u){return this.currentHelper.handleEaseTo(r,u)}handleFlyTo(r,u){return this.currentHelper.handleFlyTo(r,u)}}let Fc=(w,r)=>o.y(w,r&&r.filter(u=>u.identifier!=="source.canvas")),Ov=o.bE();class Uu extends o.E{constructor(r,u={}){var f,v;super(),this._rtlPluginLoaded=()=>{for(let R in this.sourceCaches){let T=this.sourceCaches[R].getSource().type;T!=="vector"&&T!=="geojson"||this.sourceCaches[R].reload()}},this.map=r,this.dispatcher=new fi(ji(),r._getMapId()),this.dispatcher.registerMessageHandler("GG",(R,T)=>this.getGlyphs(R,T)),this.dispatcher.registerMessageHandler("GI",(R,T)=>this.getImages(R,T)),this.imageManager=new Ae,this.imageManager.setEventedParent(this);let x=((f=r._container)===null||f===void 0?void 0:f.lang)||typeof document<"u"&&((v=document.documentElement)===null||v===void 0?void 0:v.lang)||void 0;this.glyphManager=new Xe(r._requestManager,u.localIdeographFontFamily,x),this.lineAtlas=new Ct(256,512),this.crossTileSymbolIndex=new ga,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",o.bG()),Dn().on(gr,this._rtlPluginLoaded),this.on("data",R=>{if(R.dataType!=="source"||R.sourceDataType!=="metadata")return;let T=this.sourceCaches[R.sourceId];if(!T)return;let D=T.getSource();if(D&&D.vectorLayerIds)for(let k in this._layers){let L=this._layers[k];L.source===D.id&&this._validateLayer(L)}})}setGlobalStateProperty(r,u){var f,v,x;this._checkLoaded();let R=u===null?(x=(v=(f=this.stylesheet.state)===null||f===void 0?void 0:f[r])===null||v===void 0?void 0:v.default)!==null&&x!==void 0?x:null:u;if(o.bH(R,this._globalState[r]))return this;this._globalState[r]=R,this._applyGlobalStateChanges([r])}getGlobalState(){return this._globalState}setGlobalState(r){this._checkLoaded();let u=[];for(let f in r)!o.bH(this._globalState[f],r[f].default)&&(u.push(f),this._globalState[f]=r[f].default);this._applyGlobalStateChanges(u)}_applyGlobalStateChanges(r){if(r.length===0)return;let u=new Set,f={};for(let v of r){f[v]=this._globalState[v];for(let x in this._layers){let R=this._layers[x],T=R.getLayoutAffectingGlobalStateRefs(),D=R.getPaintAffectingGlobalStateRefs();if(T.has(v)&&u.add(R.source),D.has(v))for(let{name:k,value:L}of D.get(v))this._updatePaintProperty(R,k,L)}}this.dispatcher.broadcast("UGS",f);for(let v in this.sourceCaches)u.has(v)&&(this._reloadSource(v),this._changed=!0)}loadURL(r,u={},f){this.fire(new o.l("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;let v=this.map._requestManager.transformRequest(r,"Style");this._loadStyleRequest=new AbortController;let x=this._loadStyleRequest;o.j(v,this._loadStyleRequest).then(R=>{this._loadStyleRequest=null,this._load(R.data,u,f)}).catch(R=>{this._loadStyleRequest=null,R&&!x.signal.aborted&&this.fire(new o.k(R))})}loadJSON(r,u={},f){this.fire(new o.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,C.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,u.validate=u.validate!==!1,this._load(r,u,f)}).catch(()=>{})}loadEmpty(){this.fire(new o.l("dataloading",{dataType:"style"})),this._load(Ov,{validate:!1})}_load(r,u,f){var v,x;let R=u.transformStyle?u.transformStyle(f,r):r;if(!u.validate||!Fc(this,o.z(R))){R=Object.assign({},R),this._loaded=!0,this.stylesheet=R;for(let T in R.sources)this.addSource(T,R.sources[T],{validate:!1});R.sprite?this._loadSprite(R.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(R.glyphs),this._createLayers(),this.light=new Gt(this.stylesheet.light),this._setProjectionInternal(((v=this.stylesheet.projection)===null||v===void 0?void 0:v.type)||"mercator"),this.sky=new Yt(this.stylesheet.sky),this.map.setTerrain((x=this.stylesheet.terrain)!==null&&x!==void 0?x:null),this.fire(new o.l("data",{dataType:"style"})),this.fire(new o.l("style.load"))}}_createLayers(){var r;let u=o.bI(this.stylesheet.layers);this.setGlobalState((r=this.stylesheet.state)!==null&&r!==void 0?r:null),this.dispatcher.broadcast("SL",u),this._order=u.map(f=>f.id),this._layers={},this._serializedLayers=null;for(let f of u){let v=o.bJ(f,this._globalState);v.setEventedParent(this,{layer:{id:f.id}}),this._layers[f.id]=v}}_loadSprite(r,u=!1,f=void 0){let v;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(x,R,T,D){return o._(this,void 0,void 0,function*(){let k=me(x),L=T>1?"@2x":"",H={},B={};for(let{id:W,url:Z}of k){let ee=R.transformRequest(fe(Z,L,".json"),"SpriteJSON");H[W]=o.j(ee,D);let te=R.transformRequest(fe(Z,L,".png"),"SpriteImage");B[W]=Q.getImage(te,D)}return yield Promise.all([...Object.values(H),...Object.values(B)]),function(W,Z){return o._(this,void 0,void 0,function*(){let ee={};for(let te in W){ee[te]={};let ie=C.getImageCanvasContext((yield Z[te]).data),oe=(yield W[te]).data;for(let le in oe){let{width:ne,height:ue,x:ge,y:re,sdf:we,pixelRatio:Te,stretchX:Re,stretchY:Ee,content:De,textFitWidth:Ke,textFitHeight:Ze}=oe[le];ee[te][le]={data:null,pixelRatio:Te,sdf:we,stretchX:Re,stretchY:Ee,content:De,textFitWidth:Ke,textFitHeight:Ze,spriteData:{width:ne,height:ue,x:ge,y:re,context:ie}}}}return ee})}(H,B)})}(r,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(x=>{if(this._spriteRequest=null,x)for(let R in x){this._spritesImagesIds[R]=[];let T=this._spritesImagesIds[R]?this._spritesImagesIds[R].filter(D=>!(D in x)):[];for(let D of T)this.imageManager.removeImage(D),this._changedImages[D]=!0;for(let D in x[R]){let k=R==="default"?D:`${R}:${D}`;this._spritesImagesIds[R].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,x[R][D],!1):this.imageManager.addImage(k,x[R][D]),u&&(this._changedImages[k]=!0)}}}).catch(x=>{this._spriteRequest=null,v=x,this.fire(new o.k(v))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"})),f&&f(v)})}_unloadSprite(){for(let r of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(r),this._changedImages[r]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}_validateLayer(r){let u=this.sourceCaches[r.source];if(!u)return;let f=r.sourceLayer;if(!f)return;let v=u.getSource();(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(f)===-1)&&this.fire(new o.k(new Error(`Source layer "${f}" does not exist on source "${v.id}" as specified by style layer "${r.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(r,u=!1){let f=this._serializedAllLayers();if(!r||r.length===0)return Object.values(u?o.bK(f):f);let v=[];for(let x of r)if(f[x]){let R=u?o.bK(f[x]):f[x];v.push(R)}return v}_serializedAllLayers(){let r=this._serializedLayers;if(r)return r;r=this._serializedLayers={};let u=Object.keys(this._layers);for(let f of u){let v=this._layers[f];v.type!=="custom"&&(r[f]=v.serialize())}return r}hasTransitions(){var r,u,f;if(!((r=this.light)===null||r===void 0)&&r.hasTransition()||!((u=this.sky)===null||u===void 0)&&u.hasTransition()||!((f=this.projection)===null||f===void 0)&&f.hasTransition())return!0;for(let v in this.sourceCaches)if(this.sourceCaches[v].hasTransition())return!0;for(let v in this._layers)if(this._layers[v].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(r){if(!this._loaded)return;let u=this._changed;if(u){let v=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(v.length||x.length)&&this._updateWorkerLayers(v,x);for(let R in this._updatedSources){let T=this._updatedSources[R];if(T==="reload")this._reloadSource(R);else{if(T!=="clear")throw new Error(`Invalid action ${T}`);this._clearSource(R)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let R in this._updatedPaintProps)this._layers[R].updateTransitions(r);this.light.updateTransitions(r),this.sky.updateTransitions(r),this._resetUpdates()}let f={};for(let v in this.sourceCaches){let x=this.sourceCaches[v];f[v]=x.used,x.used=!1}for(let v of this._order){let x=this._layers[v];x.recalculate(r,this._availableImages),!x.isHidden(r.zoom)&&x.source&&(this.sourceCaches[x.source].used=!0)}for(let v in f){let x=this.sourceCaches[v];!!f[v]!=!!x.used&&x.fire(new o.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:v}))}this.light.recalculate(r),this.sky.recalculate(r),this.projection.recalculate(r),this.z=r.zoom,u&&this.fire(new o.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){let r=Object.keys(this._changedImages);if(r.length){for(let u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(r,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(r,!1),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(r,u={}){var f;this._checkLoaded();let v=this.serialize();if(r=u.transformStyle?u.transformStyle(v,r):r,((f=u.validate)===null||f===void 0||f)&&Fc(this,o.z(r)))return!1;(r=o.bK(r)).layers=o.bI(r.layers);let x=o.bL(v,r),R=this._getOperationsToPerform(x);if(R.unimplemented.length>0)throw new Error(`Unimplemented: ${R.unimplemented.join(", ")}.`);if(R.operations.length===0)return!1;for(let T of R.operations)T();return this.stylesheet=r,this._serializedLayers=null,!0}_getOperationsToPerform(r){let u=[],f=[];for(let v of r)switch(v.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":u.push(()=>this.addLayer.apply(this,v.args));break;case"removeLayer":u.push(()=>this.removeLayer.apply(this,v.args));break;case"setPaintProperty":u.push(()=>this.setPaintProperty.apply(this,v.args));break;case"setLayoutProperty":u.push(()=>this.setLayoutProperty.apply(this,v.args));break;case"setFilter":u.push(()=>this.setFilter.apply(this,v.args));break;case"addSource":u.push(()=>this.addSource.apply(this,v.args));break;case"removeSource":u.push(()=>this.removeSource.apply(this,v.args));break;case"setLayerZoomRange":u.push(()=>this.setLayerZoomRange.apply(this,v.args));break;case"setLight":u.push(()=>this.setLight.apply(this,v.args));break;case"setGeoJSONSourceData":u.push(()=>this.setGeoJSONSourceData.apply(this,v.args));break;case"setGlyphs":u.push(()=>this.setGlyphs.apply(this,v.args));break;case"setSprite":u.push(()=>this.setSprite.apply(this,v.args));break;case"setTerrain":u.push(()=>this.map.setTerrain.apply(this,v.args));break;case"setSky":u.push(()=>this.setSky.apply(this,v.args));break;case"setProjection":this.setProjection.apply(this,v.args);break;case"setGlobalState":u.push(()=>this.setGlobalState.apply(this,v.args));break;case"setTransition":u.push(()=>{});break;default:f.push(v.command)}return{operations:u,unimplemented:f}}addImage(r,u){if(this.getImage(r))return this.fire(new o.k(new Error(`An image named "${r}" already exists.`)));this.imageManager.addImage(r,u),this._afterImageUpdated(r)}updateImage(r,u){this.imageManager.updateImage(r,u)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new o.k(new Error(`An image named "${r}" does not exist.`)));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(r,u,f={}){if(this._checkLoaded(),this.sourceCaches[r]!==void 0)throw new Error(`Source "${r}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(o.z.source,`sources.${r}`,u,null,f))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);let v=this.sourceCaches[r]=new zt(r,u,this.dispatcher);v.style=this,v.setEventedParent(this,()=>({isSourceLoaded:v.loaded(),source:v.serialize(),sourceId:r})),v.onAdd(this.map),this._changed=!0}removeSource(r){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error("There is no source with this ID");for(let f in this._layers)if(this._layers[f].source===r)return this.fire(new o.k(new Error(`Source "${r}" cannot be removed while layer "${f}" is using it.`)));let u=this.sourceCaches[r];delete this.sourceCaches[r],delete this._updatedSources[r],u.fire(new o.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:r})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,u){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error(`There is no source with this ID=${r}`);let f=this.sourceCaches[r].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(u),this._changed=!0}getSource(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()}addLayer(r,u,f={}){this._checkLoaded();let v=r.id;if(this.getLayer(v))return void this.fire(new o.k(new Error(`Layer "${v}" already exists on this map.`)));let x;if(r.type==="custom"){if(Fc(this,o.bM(r)))return;x=o.bJ(r,this._globalState)}else{if("source"in r&&typeof r.source=="object"&&(this.addSource(v,r.source),r=o.bK(r),r=o.e(r,{source:v})),this._validate(o.z.layer,`layers.${v}`,r,{arrayIndex:-1},f))return;x=o.bJ(r,this._globalState),this._validateLayer(x),x.setEventedParent(this,{layer:{id:v}})}let R=u?this._order.indexOf(u):this._order.length;if(u&&R===-1)this.fire(new o.k(new Error(`Cannot add layer "${v}" before non-existing layer "${u}".`)));else{if(this._order.splice(R,0,v),this._layerOrderChanged=!0,this._layers[v]=x,this._removedLayers[v]&&x.source&&x.type!=="custom"){let T=this._removedLayers[v];delete this._removedLayers[v],T.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(r,u){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new o.k(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===u)return;let f=this._order.indexOf(r);this._order.splice(f,1);let v=u?this._order.indexOf(u):this._order.length;u&&v===-1?this.fire(new o.k(new Error(`Cannot move layer "${r}" before non-existing layer "${u}".`))):(this._order.splice(v,0,r),this._layerOrderChanged=!0)}removeLayer(r){this._checkLoaded();let u=this._layers[r];if(!u)return void this.fire(new o.k(new Error(`Cannot remove non-existing layer "${r}".`)));u.setEventedParent(null);let f=this._order.indexOf(r);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=u,delete this._layers[r],this._serializedLayers&&delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],u.onRemove&&u.onRemove(this.map)}getLayer(r){return this._layers[r]}getLayersOrder(){return[...this._order]}hasLayer(r){return r in this._layers}setLayerZoomRange(r,u,f){this._checkLoaded();let v=this.getLayer(r);v?v.minzoom===u&&v.maxzoom===f||(u!=null&&(v.minzoom=u),f!=null&&(v.maxzoom=f),this._updateLayer(v)):this.fire(new o.k(new Error(`Cannot set the zoom range of non-existing layer "${r}".`)))}setFilter(r,u,f={}){this._checkLoaded();let v=this.getLayer(r);if(v){if(!o.bH(v.filter,u))return u==null?(v.setFilter(void 0),void this._updateLayer(v)):void(this._validate(o.z.filter,`layers.${v.id}.filter`,u,null,f)||(v.setFilter(o.bK(u)),this._updateLayer(v)))}else this.fire(new o.k(new Error(`Cannot filter non-existing layer "${r}".`)))}getFilter(r){return o.bK(this.getLayer(r).filter)}setLayoutProperty(r,u,f,v={}){this._checkLoaded();let x=this.getLayer(r);x?o.bH(x.getLayoutProperty(u),f)||(x.setLayoutProperty(u,f,v),this._updateLayer(x)):this.fire(new o.k(new Error(`Cannot style non-existing layer "${r}".`)))}getLayoutProperty(r,u){let f=this.getLayer(r);if(f)return f.getLayoutProperty(u);this.fire(new o.k(new Error(`Cannot get style of non-existing layer "${r}".`)))}setPaintProperty(r,u,f,v={}){this._checkLoaded();let x=this.getLayer(r);x?o.bH(x.getPaintProperty(u),f)||this._updatePaintProperty(x,u,f,v):this.fire(new o.k(new Error(`Cannot style non-existing layer "${r}".`)))}_updatePaintProperty(r,u,f,v={}){r.setPaintProperty(u,f,v)&&this._updateLayer(r),this._changed=!0,this._updatedPaintProps[r.id]=!0,this._serializedLayers=null}getPaintProperty(r,u){return this.getLayer(r).getPaintProperty(u)}setFeatureState(r,u){this._checkLoaded();let f=r.source,v=r.sourceLayer,x=this.sourceCaches[f];if(x===void 0)return void this.fire(new o.k(new Error(`The source '${f}' does not exist in the map's style.`)));let R=x.getSource().type;R==="geojson"&&v?this.fire(new o.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):R!=="vector"||v?(r.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),x.setFeatureState(v,r.id,u)):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(r,u){this._checkLoaded();let f=r.source,v=this.sourceCaches[f];if(v===void 0)return void this.fire(new o.k(new Error(`The source '${f}' does not exist in the map's style.`)));let x=v.getSource().type,R=x==="vector"?r.sourceLayer:void 0;x!=="vector"||R?u&&typeof r.id!="string"&&typeof r.id!="number"?this.fire(new o.k(new Error("A feature id is required to remove its specific state property."))):v.removeFeatureState(R,r.id,u):this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(r){this._checkLoaded();let u=r.source,f=r.sourceLayer,v=this.sourceCaches[u];if(v!==void 0)return v.getSource().type!=="vector"||f?(r.id===void 0&&this.fire(new o.k(new Error("The feature id parameter must be provided."))),v.getFeatureState(f,r.id)):void this.fire(new o.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.k(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return o.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let r=o.bN(this.sourceCaches,x=>x.serialize()),u=this._serializeByIds(this._order,!0),f=this.map.getTerrain()||void 0,v=this.stylesheet;return o.bO({version:v.version,name:v.name,metadata:v.metadata,light:v.light,sky:v.sky,center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch,sprite:v.sprite,glyphs:v.glyphs,transition:v.transition,projection:v.projection,sources:r,layers:u,terrain:f},x=>x!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&this.sourceCaches[r.source].getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(r){let u=R=>this._layers[R].type==="fill-extrusion",f={},v=[];for(let R=this._order.length-1;R>=0;R--){let T=this._order[R];if(u(T)){f[T]=R;for(let D of r){let k=D[T];if(k)for(let L of k)v.push(L)}}}v.sort((R,T)=>T.intersectionZ-R.intersectionZ);let x=[];for(let R=this._order.length-1;R>=0;R--){let T=this._order[R];if(u(T))for(let D=v.length-1;D>=0;D--){let k=v[D].feature;if(f[k.layer.id]<R)break;x.push(k),v.pop()}else for(let D of r){let k=D[T];if(k)for(let L of k)x.push(L.feature)}}return x}queryRenderedFeatures(r,u,f){u&&u.filter&&this._validate(o.z.filter,"queryRenderedFeatures.filter",u.filter,null,u);let v={};if(u&&u.layers){if(!(Array.isArray(u.layers)||u.layers instanceof Set))return this.fire(new o.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(let k of u.layers){let L=this._layers[k];if(!L)return this.fire(new o.k(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];v[L.source]=!0}}let x=[];u.availableImages=this._availableImages;let R=this._serializedAllLayers(),T=u.layers instanceof Set?u.layers:Array.isArray(u.layers)?new Set(u.layers):null,D=Object.assign(Object.assign({},u),{layers:T,globalState:this._globalState});for(let k in this.sourceCaches)u.layers&&!v[k]||x.push(bo(this.sourceCaches[k],this._layers,R,r,D,f,this.map.terrain?(L,H,B)=>this.map.terrain.getElevation(L,H,B):void 0));return this.placement&&x.push(function(k,L,H,B,W,Z,ee){let te={},ie=Z.queryRenderedSymbols(B),oe=[];for(let le of Object.keys(ie).map(Number))oe.push(ee[le]);oe.sort(na);for(let le of oe){let ne=le.featureIndex.lookupSymbolFeatures(ie[le.bucketInstanceId],L,le.bucketIndex,le.sourceLayerIndex,{filterSpec:W.filter,globalState:W.globalState},W.layers,W.availableImages,k);for(let ue in ne){let ge=te[ue]=te[ue]||[],re=ne[ue];re.sort((we,Te)=>{let Re=le.featureSortOrder;if(Re){let Ee=Re.indexOf(we.featureIndex);return Re.indexOf(Te.featureIndex)-Ee}return Te.featureIndex-we.featureIndex});for(let we of re)ge.push(we)}}return function(le,ne,ue){for(let ge in le)for(let re of le[ge])ra(re,ue[ne[ge].source]);return le}(te,k,H)}(this._layers,R,this.sourceCaches,r,D,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(r,u){u?.filter&&this._validate(o.z.filter,"querySourceFeatures.filter",u.filter,null,u);let f=this.sourceCaches[r];return f?function(v,x){let R=v.getRenderableIds().map(k=>v.getTileByID(k)),T=[],D={};for(let k=0;k<R.length;k++){let L=R[k],H=L.tileID.canonical.key;D[H]||(D[H]=!0,L.querySourceFeatures(T,x))}return T}(f,u?Object.assign(Object.assign({},u),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(r,u={}){this._checkLoaded();let f=this.light.getLight(),v=!1;for(let R in r)if(!o.bH(r[R],f[R])){v=!0;break}if(!v)return;let x={now:C.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,u),this.light.updateTransitions(x)}getProjection(){var r;return(r=this.stylesheet)===null||r===void 0?void 0:r.projection}setProjection(r){if(this._checkLoaded(),this.projection){if(this.projection.name===r.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=r,this._setProjectionInternal(r.type)}getSky(){var r;return(r=this.stylesheet)===null||r===void 0?void 0:r.sky}setSky(r,u={}){this._checkLoaded();let f=this.getSky(),v=!1;if(!r&&!f)return;if(r&&!f)v=!0;else if(!r&&f)v=!0;else for(let R in r)if(!o.bH(r[R],f[R])){v=!0;break}if(!v)return;let x={now:C.now(),transition:o.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=r,this.sky.setSky(r,u),this.sky.updateTransitions(x)}_setProjectionInternal(r){let u=function(f){if(Array.isArray(f)){let v=new Tc({type:f});return{projection:v,transform:new yl,cameraHelper:new vg(v)}}switch(f){case"mercator":return{projection:new Ot,transform:new oi,cameraHelper:new xs};case"globe":{let v=new Tc({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:v,transform:new yl,cameraHelper:new vg(v)}}case"vertical-perspective":return{projection:new dl,transform:new vl,cameraHelper:new _s};default:return o.w(`Unknown projection name: ${f}. Falling back to mercator projection.`),{projection:new Ot,transform:new oi,cameraHelper:new xs}}}(r);this.projection=u.projection,this.map.migrateProjection(u.transform,u.cameraHelper);for(let f in this.sourceCaches)this.sourceCaches[f].reload()}_validate(r,u,f,v,x={}){return(!x||x.validate!==!1)&&Fc(this,r.call(o.z,o.e({key:u,style:this.serialize(),value:f,styleSpec:o.v},v)))}_remove(r=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Dn().off(gr,this._rtlPluginLoaded);for(let u in this._layers)this._layers[u].setEventedParent(null);for(let u in this.sourceCaches){let f=this.sourceCaches[u];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),r&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(r)}_clearSource(r){this.sourceCaches[r].clearTiles()}_reloadSource(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()}_updateSources(r){for(let u in this.sourceCaches)this.sourceCaches[u].update(r,this.map.terrain)}_generateCollisionBoxes(){for(let r in this.sourceCaches)this._reloadSource(r)}_updatePlacement(r,u,f,v,x=!1){let R=!1,T=!1,D={};for(let k of this._order){let L=this._layers[k];if(L.type!=="symbol")continue;if(!D[L.source]){let B=this.sourceCaches[L.source];D[L.source]=B.getRenderableIds(!0).map(W=>B.getTileByID(W)).sort((W,Z)=>Z.tileID.overscaledZ-W.tileID.overscaledZ||(W.tileID.isLessThan(Z.tileID)?-1:1))}let H=this.crossTileSymbolIndex.addLayer(L,D[L.source],r.center.lng);R=R||H}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(C.now(),r.zoom))&&(this.pauseablePlacement=new Vu(r,this.map.terrain,this._order,x,u,f,v,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,D),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(C.now()),T=!0),R&&this.pauseablePlacement.placement.setStale()),T||R)for(let k of this._order){let L=this._layers[k];L.type==="symbol"&&this.placement.updateLayerOpacities(L,D[L.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(C.now())}_releaseSymbolFadeTiles(){for(let r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,u){return o._(this,void 0,void 0,function*(){let f=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();let v=this.sourceCaches[u.source];return v&&v.setDependencies(u.tileID.key,u.type,u.icons),f})}getGlyphs(r,u){return o._(this,void 0,void 0,function*(){let f=yield this.glyphManager.getGlyphs(u.stacks),v=this.sourceCaches[u.source];return v&&v.setDependencies(u.tileID.key,u.type,[""]),f})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(r,u={}){this._checkLoaded(),r&&this._validate(o.z.glyphs,"glyphs",r,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=r,this.glyphManager.entries={},this.glyphManager.setURL(r))}addSprite(r,u,f={},v){this._checkLoaded();let x=[{id:r,url:u}],R=[...me(this.stylesheet.sprite),...x];this._validate(o.z.sprite,"sprite",R,null,f)||(this.stylesheet.sprite=R,this._loadSprite(x,!0,v))}removeSprite(r){this._checkLoaded();let u=me(this.stylesheet.sprite);if(u.find(f=>f.id===r)){if(this._spritesImagesIds[r])for(let f of this._spritesImagesIds[r])this.imageManager.removeImage(f),this._changedImages[f]=!0;u.splice(u.findIndex(f=>f.id===r),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[r],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new o.l("data",{dataType:"style"}))}else this.fire(new o.k(new Error(`Sprite "${r}" doesn't exists on this map.`)))}getSprite(){return me(this.stylesheet.sprite)}setSprite(r,u={},f){this._checkLoaded(),r&&this._validate(o.z.sprite,"sprite",r,null,u)||(this.stylesheet.sprite=r,r?this._loadSprite(r,!0,f):(this._unloadSprite(),f&&f(null)))}}var zv=o.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Bv{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,u,f,v,x,R,T,D,k){this.context=r;let L=this.boundPaintVertexBuffers.length!==v.length;for(let H=0;!L&&H<v.length;H++)this.boundPaintVertexBuffers[H]!==v[H]&&(L=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==f||L||this.boundIndexBuffer!==x||this.boundVertexOffset!==R||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==D||this.boundDynamicVertexBuffer3!==k?this.freshBind(u,f,v,x,R,T,D,k):(r.bindVertexArray.set(this.vao),T&&T.bind(),x&&x.dynamicDraw&&x.bind(),D&&D.bind(),k&&k.bind())}freshBind(r,u,f,v,x,R,T,D){let k=r.numAttributes,L=this.context,H=L.gl;this.vao&&this.destroy(),this.vao=L.createVertexArray(),L.bindVertexArray.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=v,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=R,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=D,u.enableAttributes(H,r);for(let B of f)B.enableAttributes(H,r);R&&R.enableAttributes(H,r),T&&T.enableAttributes(H,r),D&&D.enableAttributes(H,r),u.bind(),u.setVertexAttribPointers(H,r,x);for(let B of f)B.bind(),B.setVertexAttribPointers(H,r,x);R&&(R.bind(),R.setVertexAttribPointers(H,r,x)),v&&v.bind(),T&&(T.bind(),T.setVertexAttribPointers(H,r,x)),D&&(D.bind(),D.setVertexAttribPointers(H,r,x)),L.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}let Ic=(w,r,u,f,v)=>({u_texture:0,u_ele_delta:w,u_fog_matrix:r,u_fog_color:u?u.properties.get("fog-color"):o.bf.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:v?0:u?u.calculateFogBlendOpacity(f):0,u_horizon_color:u?u.properties.get("horizon-color"):o.bf.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1,u_is_globe_mode:v?1:0}),ju={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function br(w){let r=[];for(let u=0;u<w.length;u++){if(w[u]===null)continue;let f=w[u].split(" ");r.push(f.pop())}return r}class $u{constructor(r,u,f,v,x,R,T,D,k=[]){let L=r.gl;this.program=L.createProgram();let H=br(u.staticAttributes),B=f?f.getBinderAttributes():[],W=H.concat(B),Z=_o.prelude.staticUniforms?br(_o.prelude.staticUniforms):[],ee=T.staticUniforms?br(T.staticUniforms):[],te=u.staticUniforms?br(u.staticUniforms):[],ie=f?f.getBinderUniforms():[],oe=Z.concat(ee).concat(te).concat(ie),le=[];for(let Re of oe)le.indexOf(Re)<0&&le.push(Re);let ne=f?f.defines():[];Uo(L)&&ne.unshift("#version 300 es"),x&&ne.push("#define OVERDRAW_INSPECTOR;"),R&&ne.push("#define TERRAIN3D;"),D&&ne.push(D),k&&ne.push(...k);let ue=ne.concat(_o.prelude.fragmentSource,T.fragmentSource,u.fragmentSource).join(`
`),ge=ne.concat(_o.prelude.vertexSource,T.vertexSource,u.vertexSource).join(`
`);Uo(L)||(ue=function(Re){return Re.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(ue),ge=function(Re){return Re.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(ge));let re=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);if(L.shaderSource(re,ue),L.compileShader(re),!L.getShaderParameter(re,L.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${L.getShaderInfoLog(re)}`);L.attachShader(this.program,re);let we=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);if(L.shaderSource(we,ge),L.compileShader(we),!L.getShaderParameter(we,L.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${L.getShaderInfoLog(we)}`);L.attachShader(this.program,we),this.attributes={};let Te={};this.numAttributes=W.length;for(let Re=0;Re<this.numAttributes;Re++)W[Re]&&(L.bindAttribLocation(this.program,Re,W[Re]),this.attributes[W[Re]]=Re);if(L.linkProgram(this.program),!L.getProgramParameter(this.program,L.LINK_STATUS))throw new Error(`Program failed to link: ${L.getProgramInfoLog(this.program)}`);L.deleteShader(we),L.deleteShader(re);for(let Re=0;Re<le.length;Re++){let Ee=le[Re];if(Ee&&!Te[Ee]){let De=L.getUniformLocation(this.program,Ee);De&&(Te[Ee]=De)}}this.fixedUniforms=v(r,Te),this.terrainUniforms=((Re,Ee)=>({u_depth:new o.bP(Re,Ee.u_depth),u_terrain:new o.bP(Re,Ee.u_terrain),u_terrain_dim:new o.bg(Re,Ee.u_terrain_dim),u_terrain_matrix:new o.bR(Re,Ee.u_terrain_matrix),u_terrain_unpack:new o.bS(Re,Ee.u_terrain_unpack),u_terrain_exaggeration:new o.bg(Re,Ee.u_terrain_exaggeration)}))(r,Te),this.projectionUniforms=((Re,Ee)=>({u_projection_matrix:new o.bR(Re,Ee.u_projection_matrix),u_projection_tile_mercator_coords:new o.bS(Re,Ee.u_projection_tile_mercator_coords),u_projection_clipping_plane:new o.bS(Re,Ee.u_projection_clipping_plane),u_projection_transition:new o.bg(Re,Ee.u_projection_transition),u_projection_fallback_matrix:new o.bR(Re,Ee.u_projection_fallback_matrix)}))(r,Te),this.binderUniforms=f?f.getUniforms(r,Te):[]}draw(r,u,f,v,x,R,T,D,k,L,H,B,W,Z,ee,te,ie,oe,le){let ne=r.gl;if(this.failedToCreate)return;if(r.program.set(this.program),r.setDepthMode(f),r.setStencilMode(v),r.setColorMode(x),r.setCullFace(R),D){r.activeTexture.set(ne.TEXTURE2),ne.bindTexture(ne.TEXTURE_2D,D.depthTexture),r.activeTexture.set(ne.TEXTURE3),ne.bindTexture(ne.TEXTURE_2D,D.texture);for(let ge in this.terrainUniforms)this.terrainUniforms[ge].set(D[ge])}if(k)for(let ge in k)this.projectionUniforms[ju[ge]].set(k[ge]);if(T)for(let ge in this.fixedUniforms)this.fixedUniforms[ge].set(T[ge]);te&&te.setUniforms(r,this.binderUniforms,Z,{zoom:ee});let ue=0;switch(u){case ne.LINES:ue=2;break;case ne.TRIANGLES:ue=3;break;case ne.LINE_STRIP:ue=1}for(let ge of W.get()){let re=ge.vaos||(ge.vaos={});(re[L]||(re[L]=new Bv)).bind(r,this,H,te?te.getPaintVertexBuffers():[],B,ge.vertexOffset,ie,oe,le),ne.drawElements(u,ge.primitiveLength*ue,ne.UNSIGNED_SHORT,ge.primitiveOffset*ue*2)}}}function kc(w,r,u){let f=1/o.aC(u,1,r.transform.tileZoom),v=Math.pow(2,u.tileID.overscaledZ),x=u.tileSize*Math.pow(2,r.transform.tileZoom)/v,R=x*(u.tileID.canonical.x+u.tileID.wrap*v),T=x*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[f,w.fromScale,w.toScale],u_fade:w.t,u_pixel_coord_upper:[R>>16,T>>16],u_pixel_coord_lower:[65535&R,65535&T]}}let Ro=(w,r,u,f)=>{let v=w.style.light,x=v.properties.get("position"),R=[x.x,x.y,x.z],T=o.bV();v.properties.get("anchor")==="viewport"&&o.bW(T,w.transform.bearingInRadians),o.bX(R,R,T);let D=w.transform.transformLightDirection(R),k=v.properties.get("color");return{u_lightpos:R,u_lightpos_globe:D,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+r,u_opacity:u,u_fill_translate:f}},Vv=(w,r,u,f,v,x,R)=>o.e(Ro(w,r,u,f),kc(x,w,R),{u_height_factor:-Math.pow(2,v.overscaledZ)/R.tileSize/8}),Ac=(w,r,u,f)=>o.e(kc(r,w,u),{u_fill_translate:f}),wl=(w,r)=>({u_world:w,u_fill_translate:r}),Cl=(w,r,u,f,v)=>o.e(Ac(w,r,u,v),{u_world:f}),Hv=(w,r,u,f,v)=>{let x=w.transform,R,T,D=0;if(u.paint.get("circle-pitch-alignment")==="map"){let k=o.aC(r,1,x.zoom);R=!0,T=[k,k],D=k/(o.$*Math.pow(2,r.tileID.overscaledZ))*2*Math.PI*v}else R=!1,T=x.pixelsToGLUnits;return{u_camera_to_center_distance:x.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+R,u_device_pixel_ratio:w.pixelRatio,u_extrude_scale:T,u_globe_extrude_scale:D,u_translate:f}},Lc=w=>({u_pixel_extrude_scale:[1/w.width,1/w.height]}),Nv=w=>({u_viewport_size:[w.width,w.height]}),xr=(w,r=1)=>({u_color:w,u_overlay:0,u_overlay_scale:r}),yg=(w,r,u,f)=>{let v=o.aC(w,1,r)/(o.$*Math.pow(2,w.tileID.overscaledZ))*2*Math.PI*f;return{u_extrude_scale:o.aC(w,1,r),u_intensity:u,u_globe_extrude_scale:v}},qu=(w,r,u,f)=>{let v=o.L();o.bY(v,0,w.width,w.height,0,0,1);let x=w.context.gl;return{u_matrix:v,u_world:[x.drawingBufferWidth,x.drawingBufferHeight],u_image:u,u_color_ramp:f,u_opacity:r.paint.get("heatmap-opacity")}},Gv=(w,r,u)=>{let f=u.paint.get("hillshade-accent-color"),v;switch(u.paint.get("hillshade-method")){case"basic":v=4;break;case"combined":v=1;break;case"igor":v=2;break;case"multidirectional":v=3;break;default:v=0}let x=u.getIlluminationProperties();for(let R=0;R<x.directionRadians.length;R++)u.paint.get("hillshade-illumination-anchor")==="viewport"&&(x.directionRadians[R]+=w.transform.bearingInRadians);return{u_image:0,u_latrange:Zu(0,r.tileID),u_exaggeration:u.paint.get("hillshade-exaggeration"),u_altitudes:x.altitudeRadians,u_azimuths:x.directionRadians,u_accent:f,u_method:v,u_highlights:x.highlightColor,u_shadows:x.shadowColor}},wg=(w,r)=>{let u=r.stride,f=o.L();return o.bY(f,0,o.$,-o.$,0,0,1),o.M(f,f,[0,-o.$,0]),{u_matrix:f,u_image:1,u_dimension:[u,u],u_zoom:w.overscaledZ,u_unpack:r.getUnpackVector()}};function Zu(w,r){let u=Math.pow(2,r.canonical.z),f=r.canonical.y;return[new o.a1(0,f/u).toLngLat().lat,new o.a1(0,(f+1)/u).toLngLat().lat]}let Cg=(w,r,u=0)=>({u_image:0,u_unpack:r.getUnpackVector(),u_dimension:[r.stride,r.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:u,u_opacity:w.paint.get("color-relief-opacity")}),Oc=(w,r,u,f)=>{let v=w.transform;return{u_translation:Xu(w,r,u),u_ratio:f/o.aC(r,1,v.zoom),u_device_pixel_ratio:w.pixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},bg=(w,r,u,f,v)=>o.e(Oc(w,r,u,f),{u_image:0,u_image_height:v}),xg=(w,r,u,f,v)=>{let x=w.transform,R=Ku(r,x);return{u_translation:Xu(w,r,u),u_texsize:r.imageAtlasTexture.size,u_ratio:f/o.aC(r,1,x.zoom),u_device_pixel_ratio:w.pixelRatio,u_image:0,u_scale:[R,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},_r=(w,r,u,f,v,x)=>{let R=w.lineAtlas,T=Ku(r,w.transform),D=u.layout.get("line-cap")==="round",k=R.getDash(v.from,D),L=R.getDash(v.to,D),H=k.width*x.fromScale,B=L.width*x.toScale;return o.e(Oc(w,r,u,f),{u_patternscale_a:[T/H,-k.height/2],u_patternscale_b:[T/B,-L.height/2],u_sdfgamma:R.width/(256*Math.min(H,B)*w.pixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:L.y,u_mix:x.t})};function Ku(w,r){return 1/o.aC(w,1,r.tileZoom)}function Xu(w,r,u){return o.aD(w.transform,r,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}let bl=(w,r,u,f,v)=>{return{u_tl_parent:w,u_scale_parent:r,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(R=f.paint.get("raster-saturation"),R>0?1-1/(1.001-R):-R),u_contrast_factor:(x=f.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:Wv(f.paint.get("raster-hue-rotate")),u_coords_top:[v[0].x,v[0].y,v[1].x,v[1].y],u_coords_bottom:[v[3].x,v[3].y,v[2].x,v[2].y]};var x,R};function Wv(w){w*=Math.PI/180;let r=Math.sin(w),u=Math.cos(w);return[(2*u+1)/3,(-Math.sqrt(3)*r-u+1)/3,(Math.sqrt(3)*r-u+1)/3]}let xl=(w,r,u,f,v,x,R,T,D,k,L,H,B)=>{let W=R.transform;return{u_is_size_zoom_constant:+(w==="constant"||w==="source"),u_is_size_feature_constant:+(w==="constant"||w==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:W.cameraToCenterDistance,u_pitch:W.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:W.width/W.height,u_fade_change:R.options.fadeDuration?R.symbolFadeChange:1,u_label_plane_matrix:T,u_coord_matrix:D,u_is_text:+L,u_pitch_with_map:+f,u_is_along_line:v,u_is_variable_anchor:x,u_texsize:H,u_texture:0,u_translation:k,u_pitched_scale:B}},_g=(w,r,u,f,v,x,R,T,D,k,L,H,B,W)=>{let Z=R.transform;return o.e(xl(w,r,u,f,v,x,R,T,D,k,L,H,W),{u_gamma_scale:f?Math.cos(Z.pitch*Math.PI/180)*Z.cameraToCenterDistance:1,u_device_pixel_ratio:R.pixelRatio,u_is_halo:1})},Uv=(w,r,u,f,v,x,R,T,D,k,L,H,B)=>o.e(_g(w,r,u,f,v,x,R,T,D,k,!0,L,0,B),{u_texsize_icon:H,u_texture_icon:1}),Sg=(w,r)=>({u_opacity:w,u_color:r}),Rg=(w,r,u,f,v)=>o.e(function(x,R,T,D){let k=T.imageManager.getPattern(x.from.toString()),L=T.imageManager.getPattern(x.to.toString()),{width:H,height:B}=T.imageManager.getPixelSize(),W=Math.pow(2,D.tileID.overscaledZ),Z=D.tileSize*Math.pow(2,T.transform.tileZoom)/W,ee=Z*(D.tileID.canonical.x+D.tileID.wrap*W),te=Z*D.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:k.tl,u_pattern_br_a:k.br,u_pattern_tl_b:L.tl,u_pattern_br_b:L.br,u_texsize:[H,B],u_mix:R.t,u_pattern_size_a:k.displaySize,u_pattern_size_b:L.displaySize,u_scale_a:R.fromScale,u_scale_b:R.toScale,u_tile_units_to_pixels:1/o.aC(D,1,T.transform.tileZoom),u_pixel_coord_upper:[ee>>16,te>>16],u_pixel_coord_lower:[65535&ee,65535&te]}}(u,v,r,f),{u_opacity:w}),Yu=(w,r)=>{},Qu={fillExtrusion:(w,r)=>({u_lightpos:new o.bT(w,r.u_lightpos),u_lightpos_globe:new o.bT(w,r.u_lightpos_globe),u_lightintensity:new o.bg(w,r.u_lightintensity),u_lightcolor:new o.bT(w,r.u_lightcolor),u_vertical_gradient:new o.bg(w,r.u_vertical_gradient),u_opacity:new o.bg(w,r.u_opacity),u_fill_translate:new o.bU(w,r.u_fill_translate)}),fillExtrusionPattern:(w,r)=>({u_lightpos:new o.bT(w,r.u_lightpos),u_lightpos_globe:new o.bT(w,r.u_lightpos_globe),u_lightintensity:new o.bg(w,r.u_lightintensity),u_lightcolor:new o.bT(w,r.u_lightcolor),u_vertical_gradient:new o.bg(w,r.u_vertical_gradient),u_height_factor:new o.bg(w,r.u_height_factor),u_opacity:new o.bg(w,r.u_opacity),u_fill_translate:new o.bU(w,r.u_fill_translate),u_image:new o.bP(w,r.u_image),u_texsize:new o.bU(w,r.u_texsize),u_pixel_coord_upper:new o.bU(w,r.u_pixel_coord_upper),u_pixel_coord_lower:new o.bU(w,r.u_pixel_coord_lower),u_scale:new o.bT(w,r.u_scale),u_fade:new o.bg(w,r.u_fade)}),fill:(w,r)=>({u_fill_translate:new o.bU(w,r.u_fill_translate)}),fillPattern:(w,r)=>({u_image:new o.bP(w,r.u_image),u_texsize:new o.bU(w,r.u_texsize),u_pixel_coord_upper:new o.bU(w,r.u_pixel_coord_upper),u_pixel_coord_lower:new o.bU(w,r.u_pixel_coord_lower),u_scale:new o.bT(w,r.u_scale),u_fade:new o.bg(w,r.u_fade),u_fill_translate:new o.bU(w,r.u_fill_translate)}),fillOutline:(w,r)=>({u_world:new o.bU(w,r.u_world),u_fill_translate:new o.bU(w,r.u_fill_translate)}),fillOutlinePattern:(w,r)=>({u_world:new o.bU(w,r.u_world),u_image:new o.bP(w,r.u_image),u_texsize:new o.bU(w,r.u_texsize),u_pixel_coord_upper:new o.bU(w,r.u_pixel_coord_upper),u_pixel_coord_lower:new o.bU(w,r.u_pixel_coord_lower),u_scale:new o.bT(w,r.u_scale),u_fade:new o.bg(w,r.u_fade),u_fill_translate:new o.bU(w,r.u_fill_translate)}),circle:(w,r)=>({u_camera_to_center_distance:new o.bg(w,r.u_camera_to_center_distance),u_scale_with_map:new o.bP(w,r.u_scale_with_map),u_pitch_with_map:new o.bP(w,r.u_pitch_with_map),u_extrude_scale:new o.bU(w,r.u_extrude_scale),u_device_pixel_ratio:new o.bg(w,r.u_device_pixel_ratio),u_globe_extrude_scale:new o.bg(w,r.u_globe_extrude_scale),u_translate:new o.bU(w,r.u_translate)}),collisionBox:(w,r)=>({u_pixel_extrude_scale:new o.bU(w,r.u_pixel_extrude_scale)}),collisionCircle:(w,r)=>({u_viewport_size:new o.bU(w,r.u_viewport_size)}),debug:(w,r)=>({u_color:new o.bQ(w,r.u_color),u_overlay:new o.bP(w,r.u_overlay),u_overlay_scale:new o.bg(w,r.u_overlay_scale)}),depth:Yu,clippingMask:Yu,heatmap:(w,r)=>({u_extrude_scale:new o.bg(w,r.u_extrude_scale),u_intensity:new o.bg(w,r.u_intensity),u_globe_extrude_scale:new o.bg(w,r.u_globe_extrude_scale)}),heatmapTexture:(w,r)=>({u_matrix:new o.bR(w,r.u_matrix),u_world:new o.bU(w,r.u_world),u_image:new o.bP(w,r.u_image),u_color_ramp:new o.bP(w,r.u_color_ramp),u_opacity:new o.bg(w,r.u_opacity)}),hillshade:(w,r)=>({u_image:new o.bP(w,r.u_image),u_latrange:new o.bU(w,r.u_latrange),u_exaggeration:new o.bg(w,r.u_exaggeration),u_altitudes:new o.b_(w,r.u_altitudes),u_azimuths:new o.b_(w,r.u_azimuths),u_accent:new o.bQ(w,r.u_accent),u_method:new o.bP(w,r.u_method),u_shadows:new o.bZ(w,r.u_shadows),u_highlights:new o.bZ(w,r.u_highlights)}),hillshadePrepare:(w,r)=>({u_matrix:new o.bR(w,r.u_matrix),u_image:new o.bP(w,r.u_image),u_dimension:new o.bU(w,r.u_dimension),u_zoom:new o.bg(w,r.u_zoom),u_unpack:new o.bS(w,r.u_unpack)}),colorRelief:(w,r)=>({u_image:new o.bP(w,r.u_image),u_unpack:new o.bS(w,r.u_unpack),u_dimension:new o.bU(w,r.u_dimension),u_elevation_stops:new o.bP(w,r.u_elevation_stops),u_color_stops:new o.bP(w,r.u_color_stops),u_color_ramp_size:new o.bP(w,r.u_color_ramp_size),u_opacity:new o.bg(w,r.u_opacity)}),line:(w,r)=>({u_translation:new o.bU(w,r.u_translation),u_ratio:new o.bg(w,r.u_ratio),u_device_pixel_ratio:new o.bg(w,r.u_device_pixel_ratio),u_units_to_pixels:new o.bU(w,r.u_units_to_pixels)}),lineGradient:(w,r)=>({u_translation:new o.bU(w,r.u_translation),u_ratio:new o.bg(w,r.u_ratio),u_device_pixel_ratio:new o.bg(w,r.u_device_pixel_ratio),u_units_to_pixels:new o.bU(w,r.u_units_to_pixels),u_image:new o.bP(w,r.u_image),u_image_height:new o.bg(w,r.u_image_height)}),linePattern:(w,r)=>({u_translation:new o.bU(w,r.u_translation),u_texsize:new o.bU(w,r.u_texsize),u_ratio:new o.bg(w,r.u_ratio),u_device_pixel_ratio:new o.bg(w,r.u_device_pixel_ratio),u_image:new o.bP(w,r.u_image),u_units_to_pixels:new o.bU(w,r.u_units_to_pixels),u_scale:new o.bT(w,r.u_scale),u_fade:new o.bg(w,r.u_fade)}),lineSDF:(w,r)=>({u_translation:new o.bU(w,r.u_translation),u_ratio:new o.bg(w,r.u_ratio),u_device_pixel_ratio:new o.bg(w,r.u_device_pixel_ratio),u_units_to_pixels:new o.bU(w,r.u_units_to_pixels),u_patternscale_a:new o.bU(w,r.u_patternscale_a),u_patternscale_b:new o.bU(w,r.u_patternscale_b),u_sdfgamma:new o.bg(w,r.u_sdfgamma),u_image:new o.bP(w,r.u_image),u_tex_y_a:new o.bg(w,r.u_tex_y_a),u_tex_y_b:new o.bg(w,r.u_tex_y_b),u_mix:new o.bg(w,r.u_mix)}),raster:(w,r)=>({u_tl_parent:new o.bU(w,r.u_tl_parent),u_scale_parent:new o.bg(w,r.u_scale_parent),u_buffer_scale:new o.bg(w,r.u_buffer_scale),u_fade_t:new o.bg(w,r.u_fade_t),u_opacity:new o.bg(w,r.u_opacity),u_image0:new o.bP(w,r.u_image0),u_image1:new o.bP(w,r.u_image1),u_brightness_low:new o.bg(w,r.u_brightness_low),u_brightness_high:new o.bg(w,r.u_brightness_high),u_saturation_factor:new o.bg(w,r.u_saturation_factor),u_contrast_factor:new o.bg(w,r.u_contrast_factor),u_spin_weights:new o.bT(w,r.u_spin_weights),u_coords_top:new o.bS(w,r.u_coords_top),u_coords_bottom:new o.bS(w,r.u_coords_bottom)}),symbolIcon:(w,r)=>({u_is_size_zoom_constant:new o.bP(w,r.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bP(w,r.u_is_size_feature_constant),u_size_t:new o.bg(w,r.u_size_t),u_size:new o.bg(w,r.u_size),u_camera_to_center_distance:new o.bg(w,r.u_camera_to_center_distance),u_pitch:new o.bg(w,r.u_pitch),u_rotate_symbol:new o.bP(w,r.u_rotate_symbol),u_aspect_ratio:new o.bg(w,r.u_aspect_ratio),u_fade_change:new o.bg(w,r.u_fade_change),u_label_plane_matrix:new o.bR(w,r.u_label_plane_matrix),u_coord_matrix:new o.bR(w,r.u_coord_matrix),u_is_text:new o.bP(w,r.u_is_text),u_pitch_with_map:new o.bP(w,r.u_pitch_with_map),u_is_along_line:new o.bP(w,r.u_is_along_line),u_is_variable_anchor:new o.bP(w,r.u_is_variable_anchor),u_texsize:new o.bU(w,r.u_texsize),u_texture:new o.bP(w,r.u_texture),u_translation:new o.bU(w,r.u_translation),u_pitched_scale:new o.bg(w,r.u_pitched_scale)}),symbolSDF:(w,r)=>({u_is_size_zoom_constant:new o.bP(w,r.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bP(w,r.u_is_size_feature_constant),u_size_t:new o.bg(w,r.u_size_t),u_size:new o.bg(w,r.u_size),u_camera_to_center_distance:new o.bg(w,r.u_camera_to_center_distance),u_pitch:new o.bg(w,r.u_pitch),u_rotate_symbol:new o.bP(w,r.u_rotate_symbol),u_aspect_ratio:new o.bg(w,r.u_aspect_ratio),u_fade_change:new o.bg(w,r.u_fade_change),u_label_plane_matrix:new o.bR(w,r.u_label_plane_matrix),u_coord_matrix:new o.bR(w,r.u_coord_matrix),u_is_text:new o.bP(w,r.u_is_text),u_pitch_with_map:new o.bP(w,r.u_pitch_with_map),u_is_along_line:new o.bP(w,r.u_is_along_line),u_is_variable_anchor:new o.bP(w,r.u_is_variable_anchor),u_texsize:new o.bU(w,r.u_texsize),u_texture:new o.bP(w,r.u_texture),u_gamma_scale:new o.bg(w,r.u_gamma_scale),u_device_pixel_ratio:new o.bg(w,r.u_device_pixel_ratio),u_is_halo:new o.bP(w,r.u_is_halo),u_translation:new o.bU(w,r.u_translation),u_pitched_scale:new o.bg(w,r.u_pitched_scale)}),symbolTextAndIcon:(w,r)=>({u_is_size_zoom_constant:new o.bP(w,r.u_is_size_zoom_constant),u_is_size_feature_constant:new o.bP(w,r.u_is_size_feature_constant),u_size_t:new o.bg(w,r.u_size_t),u_size:new o.bg(w,r.u_size),u_camera_to_center_distance:new o.bg(w,r.u_camera_to_center_distance),u_pitch:new o.bg(w,r.u_pitch),u_rotate_symbol:new o.bP(w,r.u_rotate_symbol),u_aspect_ratio:new o.bg(w,r.u_aspect_ratio),u_fade_change:new o.bg(w,r.u_fade_change),u_label_plane_matrix:new o.bR(w,r.u_label_plane_matrix),u_coord_matrix:new o.bR(w,r.u_coord_matrix),u_is_text:new o.bP(w,r.u_is_text),u_pitch_with_map:new o.bP(w,r.u_pitch_with_map),u_is_along_line:new o.bP(w,r.u_is_along_line),u_is_variable_anchor:new o.bP(w,r.u_is_variable_anchor),u_texsize:new o.bU(w,r.u_texsize),u_texsize_icon:new o.bU(w,r.u_texsize_icon),u_texture:new o.bP(w,r.u_texture),u_texture_icon:new o.bP(w,r.u_texture_icon),u_gamma_scale:new o.bg(w,r.u_gamma_scale),u_device_pixel_ratio:new o.bg(w,r.u_device_pixel_ratio),u_is_halo:new o.bP(w,r.u_is_halo),u_translation:new o.bU(w,r.u_translation),u_pitched_scale:new o.bg(w,r.u_pitched_scale)}),background:(w,r)=>({u_opacity:new o.bg(w,r.u_opacity),u_color:new o.bQ(w,r.u_color)}),backgroundPattern:(w,r)=>({u_opacity:new o.bg(w,r.u_opacity),u_image:new o.bP(w,r.u_image),u_pattern_tl_a:new o.bU(w,r.u_pattern_tl_a),u_pattern_br_a:new o.bU(w,r.u_pattern_br_a),u_pattern_tl_b:new o.bU(w,r.u_pattern_tl_b),u_pattern_br_b:new o.bU(w,r.u_pattern_br_b),u_texsize:new o.bU(w,r.u_texsize),u_mix:new o.bg(w,r.u_mix),u_pattern_size_a:new o.bU(w,r.u_pattern_size_a),u_pattern_size_b:new o.bU(w,r.u_pattern_size_b),u_scale_a:new o.bg(w,r.u_scale_a),u_scale_b:new o.bg(w,r.u_scale_b),u_pixel_coord_upper:new o.bU(w,r.u_pixel_coord_upper),u_pixel_coord_lower:new o.bU(w,r.u_pixel_coord_lower),u_tile_units_to_pixels:new o.bg(w,r.u_tile_units_to_pixels)}),terrain:(w,r)=>({u_texture:new o.bP(w,r.u_texture),u_ele_delta:new o.bg(w,r.u_ele_delta),u_fog_matrix:new o.bR(w,r.u_fog_matrix),u_fog_color:new o.bQ(w,r.u_fog_color),u_fog_ground_blend:new o.bg(w,r.u_fog_ground_blend),u_fog_ground_blend_opacity:new o.bg(w,r.u_fog_ground_blend_opacity),u_horizon_color:new o.bQ(w,r.u_horizon_color),u_horizon_fog_blend:new o.bg(w,r.u_horizon_fog_blend),u_is_globe_mode:new o.bg(w,r.u_is_globe_mode)}),terrainDepth:(w,r)=>({u_ele_delta:new o.bg(w,r.u_ele_delta)}),terrainCoords:(w,r)=>({u_texture:new o.bP(w,r.u_texture),u_terrain_coords_id:new o.bg(w,r.u_terrain_coords_id),u_ele_delta:new o.bg(w,r.u_ele_delta)}),projectionErrorMeasurement:(w,r)=>({u_input:new o.bg(w,r.u_input),u_output_expected:new o.bg(w,r.u_output_expected)}),atmosphere:(w,r)=>({u_sun_pos:new o.bT(w,r.u_sun_pos),u_atmosphere_blend:new o.bg(w,r.u_atmosphere_blend),u_globe_position:new o.bT(w,r.u_globe_position),u_globe_radius:new o.bg(w,r.u_globe_radius),u_inv_proj_matrix:new o.bR(w,r.u_inv_proj_matrix)}),sky:(w,r)=>({u_sky_color:new o.bQ(w,r.u_sky_color),u_horizon_color:new o.bQ(w,r.u_horizon_color),u_horizon:new o.bU(w,r.u_horizon),u_horizon_normal:new o.bU(w,r.u_horizon_normal),u_sky_horizon_blend:new o.bg(w,r.u_sky_horizon_blend),u_sky_blend:new o.bg(w,r.u_sky_blend)})};class Eg{constructor(r,u,f){this.context=r;let v=r.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){let u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let zc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class cn{constructor(r,u,f,v){this.length=u.length,this.attributes=f,this.itemSize=u.bytesPerElement,this.dynamicDraw=v,this.context=r;let x=r.gl;this.buffer=x.createBuffer(),r.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){if(r.length!==this.length)throw new Error(`Length of new data is ${r.length}, which doesn't match current length of ${this.length}`);let u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,u){for(let f=0;f<this.attributes.length;f++){let v=u.attributes[this.attributes[f].name];v!==void 0&&r.enableVertexAttribArray(v)}}setVertexAttribPointers(r,u,f){for(let v=0;v<this.attributes.length;v++){let x=this.attributes[v],R=u.attributes[x.name];R!==void 0&&r.vertexAttribPointer(R,x.components,r[zc[x.type]],!1,this.itemSize,x.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Kt{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ju extends Kt{getDefault(){return o.bf.transparent}set(r){let u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class ed extends Kt{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Pg extends Kt{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class td extends Kt{getDefault(){return[!0,!0,!0,!0]}set(r){let u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Sr extends Kt{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class id extends Kt{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class jv extends Kt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){let u=this.current;(r.func!==u.func||r.ref!==u.ref||r.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class $v extends Kt{getDefault(){let r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){let u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class qv extends Kt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;let u=this.gl;r?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=r,this.dirty=!1}}class Zv extends Kt{getDefault(){return[0,1]}set(r){let u=this.current;(r[0]!==u[0]||r[1]!==u[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class Mg extends Kt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;let u=this.gl;r?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=r,this.dirty=!1}}class Kv extends Kt{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Tg extends Kt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;let u=this.gl;r?u.enable(u.BLEND):u.disable(u.BLEND),this.current=r,this.dirty=!1}}class Bc extends Kt{getDefault(){let r=this.gl;return[r.ONE,r.ZERO]}set(r){let u=this.current;(r[0]!==u[0]||r[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class Vc extends Kt{getDefault(){return o.bf.transparent}set(r){let u=this.current;(r.r!==u.r||r.g!==u.g||r.b!==u.b||r.a!==u.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Hc extends Kt{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class sd extends Kt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;let u=this.gl;r?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=r,this.dirty=!1}}class Rr extends Kt{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class _l extends Kt{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class ya extends Kt{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class ao extends Kt{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class Dg extends Kt{getDefault(){let r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){let u=this.current;(r[0]!==u[0]||r[1]!==u[1]||r[2]!==u[2]||r[3]!==u[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Fg extends Kt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;let u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class od extends Kt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;let u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Er extends Kt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;let u=this.gl;u.bindTexture(u.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class Nc extends Kt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;let u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Gc extends Kt{getDefault(){return null}set(r){let u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Sl extends Kt{getDefault(){return null}set(r){var u;if(r===this.current&&!this.dirty)return;let f=this.gl;Uo(f)?f.bindVertexArray(r):(u=f.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(r),this.current=r,this.dirty=!1}}class Wc extends Kt{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;let u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class Ig extends Kt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;let u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class wa extends Kt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;let u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class zn extends Kt{constructor(r,u){super(r),this.context=r,this.parent=u}getDefault(){return null}}class kg extends zn{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class nd extends zn{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Vt extends zn{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,r),this.current=r,this.dirty=!1}}let Rl="Framebuffer is not complete";class Xv{constructor(r,u,f,v,x){this.context=r,this.width=u,this.height=f;let R=r.gl,T=this.framebuffer=R.createFramebuffer();if(this.colorAttachment=new kg(r,T),v)this.depthAttachment=x?new Vt(r,T):new nd(r,T);else if(x)throw new Error("Stencil cannot be set without depth");if(R.checkFramebufferStatus(R.FRAMEBUFFER)!==R.FRAMEBUFFER_COMPLETE)throw new Error(Rl)}destroy(){let r=this.context.gl,u=this.colorAttachment.get();if(u&&r.deleteTexture(u),this.depthAttachment){let f=this.depthAttachment.get();f&&r.deleteRenderbuffer(f)}r.deleteFramebuffer(this.framebuffer)}}class Ag{constructor(r){var u,f;if(this.gl=r,this.clearColor=new Ju(this),this.clearDepth=new ed(this),this.clearStencil=new Pg(this),this.colorMask=new td(this),this.depthMask=new Sr(this),this.stencilMask=new id(this),this.stencilFunc=new jv(this),this.stencilOp=new $v(this),this.stencilTest=new qv(this),this.depthRange=new Zv(this),this.depthTest=new Mg(this),this.depthFunc=new Kv(this),this.blend=new Tg(this),this.blendFunc=new Bc(this),this.blendColor=new Vc(this),this.blendEquation=new Hc(this),this.cullFace=new sd(this),this.cullFaceSide=new Rr(this),this.frontFace=new _l(this),this.program=new ya(this),this.activeTexture=new ao(this),this.viewport=new Dg(this),this.bindFramebuffer=new Fg(this),this.bindRenderbuffer=new od(this),this.bindTexture=new Er(this),this.bindVertexBuffer=new Nc(this),this.bindElementBuffer=new Gc(this),this.bindVertexArray=new Sl(this),this.pixelStoreUnpack=new Wc(this),this.pixelStoreUnpackPremultiplyAlpha=new Ig(this),this.pixelStoreUnpackFlipY=new wa(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),Uo(r)){this.HALF_FLOAT=r.HALF_FLOAT;let v=r.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=r.RGBA16F)!==null&&u!==void 0?u:v?.RGBA16F_EXT,this.RGB16F=(f=r.RGB16F)!==null&&f!==void 0?f:v?.RGB16F_EXT,r.getExtension("EXT_color_buffer_float")}else{r.getExtension("EXT_color_buffer_half_float"),r.getExtension("OES_texture_half_float_linear");let v=r.getExtension("OES_texture_half_float");this.HALF_FLOAT=v?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,u){return new Eg(this,r,u)}createVertexBuffer(r,u,f){return new cn(this,r,u,f)}createRenderbuffer(r,u,f){let v=this.gl,x=v.createRenderbuffer();return this.bindRenderbuffer.set(x),v.renderbufferStorage(v.RENDERBUFFER,r,u,f),this.bindRenderbuffer.set(null),x}createFramebuffer(r,u,f,v){return new Xv(this,r,u,f,v)}clear({color:r,depth:u,stencil:f}){let v=this.gl,x=0;r&&(x|=v.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(x|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),f!==void 0&&(x|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),v.clear(x)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){o.bH(r.blendFunction,pi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}createVertexArray(){var r;return Uo(this.gl)?this.gl.createVertexArray():(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.createVertexArrayOES()}deleteVertexArray(r){var u;return Uo(this.gl)?this.gl.deleteVertexArray(r):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(r)}unbindVAO(){this.bindVertexArray.set(null)}}let Bn;function Lg(w,r,u,f,v){let x=w.context,R=w.transform,T=x.gl,D=w.useProgram("collisionBox"),k=[],L=0,H=0;for(let ie=0;ie<f.length;ie++){let oe=f[ie],le=r.getTile(oe).getBucket(u);if(!le)continue;let ne=v?le.textCollisionBox:le.iconCollisionBox,ue=le.collisionCircleArray;ue.length>0&&(k.push({circleArray:ue,circleOffset:H,coord:oe}),L+=ue.length/4,H=L),ne&&D.draw(x,T.LINES,Pt.disabled,Ut.disabled,w.colorModeForRenderPass(),yt.disabled,Lc(w.transform),w.style.map.terrain&&w.style.map.terrain.getTerrainData(oe),R.getProjectionData({overscaledTileID:oe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),u.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,null,w.transform.zoom,null,null,ne.collisionVertexBuffer)}if(!v||!k.length)return;let B=w.useProgram("collisionCircle"),W=new o.b$;W.resize(4*L),W._trim();let Z=0;for(let ie of k)for(let oe=0;oe<ie.circleArray.length/4;oe++){let le=4*oe,ne=ie.circleArray[le+0],ue=ie.circleArray[le+1],ge=ie.circleArray[le+2],re=ie.circleArray[le+3];W.emplace(Z++,ne,ue,ge,re,0),W.emplace(Z++,ne,ue,ge,re,1),W.emplace(Z++,ne,ue,ge,re,2),W.emplace(Z++,ne,ue,ge,re,3)}(!Bn||Bn.length<2*L)&&(Bn=function(ie){let oe=2*ie,le=new o.c1;le.resize(oe),le._trim();for(let ne=0;ne<oe;ne++){let ue=6*ne;le.uint16[ue+0]=4*ne+0,le.uint16[ue+1]=4*ne+1,le.uint16[ue+2]=4*ne+2,le.uint16[ue+3]=4*ne+2,le.uint16[ue+4]=4*ne+3,le.uint16[ue+5]=4*ne+0}return le}(L));let ee=x.createIndexBuffer(Bn,!0),te=x.createVertexBuffer(W,o.c0.members,!0);for(let ie of k){let oe=Nv(w.transform);B.draw(x,T.TRIANGLES,Pt.disabled,Ut.disabled,w.colorModeForRenderPass(),yt.disabled,oe,w.style.map.terrain&&w.style.map.terrain.getTerrainData(ie.coord),null,u.id,te,ee,o.aM.simpleSegment(0,2*ie.circleOffset,ie.circleArray.length,ie.circleArray.length/2),null,w.transform.zoom,null,null,null)}te.destroy(),ee.destroy()}let Yv=o.ag(new Float32Array(16));function Og(w,r,u,f,v,x){let{horizontalAlign:R,verticalAlign:T}=o.aH(w);return new o.P((-(R-.5)*r/v+f[0])*x,(-(T-.5)*u/v+f[1])*x)}function Qv(w,r,u,f,v,x){let R=r.tileAnchorPoint.add(new o.P(r.translation[0],r.translation[1]));if(r.pitchWithMap){let T=f.mult(x);u||(T=T.rotate(-v));let D=R.add(T);return qi(D.x,D.y,r.pitchedLabelPlaneMatrix,r.getElevation).point}if(u){let T=fs(r.tileAnchorPoint.x+1,r.tileAnchorPoint.y,r).point.sub(w),D=Math.atan(T.y/T.x)+(T.x<0?Math.PI:0);return w.add(f.rotate(D))}return w.add(f)}function rd(w,r,u,f,v,x,R,T,D,k,L,H){let B=w.text.placedSymbolArray,W=w.text.dynamicLayoutVertexArray,Z=w.icon.dynamicLayoutVertexArray,ee={};W.clear();for(let te=0;te<B.length;te++){let ie=B.get(te),oe=ie.hidden||!ie.crossTileID||w.allowVerticalPlacement&&!ie.placedOrientation?null:f[ie.crossTileID];if(oe){let le=new o.P(ie.anchorX,ie.anchorY),ne={getElevation:H,width:v.width,height:v.height,pitchedLabelPlaneMatrix:x,pitchWithMap:u,transform:v,tileAnchorPoint:le,translation:k,unwrappedTileID:L},ue=u?In(le.x,le.y,ne):fs(le.x,le.y,ne),ge=$e(v.cameraToCenterDistance,ue.signedDistanceFromCamera),re=o.ap(w.textSizeData,T,ie)*ge/o.aB;u&&(re*=w.tilePixelRatio/R);let{width:we,height:Te,anchor:Re,textOffset:Ee,textBoxScale:De}=oe,Ke=Og(Re,we,Te,Ee,De,re),Ze=v.getPitchedTextCorrection(le.x+k[0],le.y+k[1],L),He=Qv(ue.point,ne,r,Ke,-v.bearingInRadians,Ze),ut=w.allowVerticalPlacement&&ie.placedOrientation===o.ao.vertical?Math.PI/2:0;for(let It=0;It<ie.numGlyphs;It++)o.av(W,He,ut);D&&ie.associatedIconIndex>=0&&(ee[ie.associatedIconIndex]={shiftedAnchor:He,angle:ut})}else Wo(ie.numGlyphs,W)}if(D){Z.clear();let te=w.icon.placedSymbolArray;for(let ie=0;ie<te.length;ie++){let oe=te.get(ie);if(oe.hidden)Wo(oe.numGlyphs,Z);else{let le=ee[ie];if(le)for(let ne=0;ne<oe.numGlyphs;ne++)o.av(Z,le.shiftedAnchor,le.angle);else Wo(oe.numGlyphs,Z)}}w.icon.dynamicLayoutVertexBuffer.updateData(Z)}w.text.dynamicLayoutVertexBuffer.updateData(W)}function Uc(w,r,u){return u.iconsInText&&r?"symbolTextAndIcon":w?"symbolSDF":"symbolIcon"}function El(w,r,u,f,v,x,R,T,D,k,L,H,B){let W=w.context,Z=W.gl,ee=w.transform,te=T==="map",ie=D==="map",oe=T!=="viewport"&&u.layout.get("symbol-placement")!=="point",le=te&&!ie&&!oe,ne=!u.layout.get("symbol-sort-key").isConstant(),ue=!1,ge=w.getDepthModeForSublayer(0,Pt.ReadOnly),re=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),we=[],Te=ee.getCircleRadiusCorrection();for(let Re of f){let Ee=r.getTile(Re),De=Ee.getBucket(u);if(!De)continue;let Ke=v?De.text:De.icon;if(!Ke||!Ke.segments.get().length||!Ke.hasVisibleVertices)continue;let Ze=Ke.programConfigurations.get(u.id),He=v||De.sdfIcons,ut=v?De.textSizeData:De.iconSizeData,It=ie||ee.pitch!==0,Xt=w.useProgram(Uc(He,v,De),Ze),yi=o.an(ut,ee.zoom),ni=w.style.map.terrain&&w.style.map.terrain.getTerrainData(Re),ti,wi,hi,ri,$t=[0,0],ts=null;if(v)wi=Ee.glyphAtlasTexture,hi=Z.LINEAR,ti=Ee.glyphAtlasTexture.size,De.iconsInText&&($t=Ee.imageAtlasTexture.size,ts=Ee.imageAtlasTexture,ri=It||w.options.rotating||w.options.zooming||ut.kind==="composite"||ut.kind==="camera"?Z.LINEAR:Z.NEAREST);else{let ui=u.layout.get("icon-size").constantOr(0)!==1||De.iconsNeedLinear;wi=Ee.imageAtlasTexture,hi=He||w.options.rotating||w.options.zooming||ui||It?Z.LINEAR:Z.NEAREST,ti=Ee.imageAtlasTexture.size}let Ki=o.aC(Ee,1,w.transform.zoom),ks=Hi(te,w.transform,Ki),Hn=o.L();o.aq(Hn,ks);let Nn=Bt(ie,te,w.transform,Ki),To=o.aD(ee,Ee,x,R),zr=ee.getProjectionData({overscaledTileID:Re,applyGlobeMatrix:!B,applyTerrainMatrix:!0}),Ol=re&&De.hasTextData(),ch=u.layout.get("icon-text-fit")!=="none"&&Ol&&De.hasIconData();if(oe){let ui=w.style.map.terrain?(eo,is)=>w.style.map.terrain.getElevation(Re,eo,is):null,Ni=u.layout.get("text-rotation-alignment")==="map";Ei(De,w,v,ks,Hn,ie,k,Ni,Re.toUnwrapped(),ee.width,ee.height,To,ui)}let Gn=v&&re||ch,As=oe||Gn?Yv:ie?ks:w.transform.clipSpaceToPixelsMatrix,un=He&&u.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0,dn;dn=He?De.iconsInText?Uv(ut.kind,yi,le,ie,oe,Gn,w,As,Nn,To,ti,$t,Te):_g(ut.kind,yi,le,ie,oe,Gn,w,As,Nn,To,v,ti,0,Te):xl(ut.kind,yi,le,ie,oe,Gn,w,As,Nn,To,v,ti,Te);let Wn={program:Xt,buffers:Ke,uniformValues:dn,projectionData:zr,atlasTexture:wi,atlasTextureIcon:ts,atlasInterpolation:hi,atlasInterpolationIcon:ri,isSDF:He,hasHalo:un};if(ne&&De.canOverlap){ue=!0;let ui=Ke.segments.get();for(let Ni of ui)we.push({segments:new o.aM([Ni]),sortKey:Ni.sortKey,state:Wn,terrainData:ni})}else we.push({segments:Ke.segments,sortKey:0,state:Wn,terrainData:ni})}ue&&we.sort((Re,Ee)=>Re.sortKey-Ee.sortKey);for(let Re of we){let Ee=Re.state;if(W.activeTexture.set(Z.TEXTURE0),Ee.atlasTexture.bind(Ee.atlasInterpolation,Z.CLAMP_TO_EDGE),Ee.atlasTextureIcon&&(W.activeTexture.set(Z.TEXTURE1),Ee.atlasTextureIcon&&Ee.atlasTextureIcon.bind(Ee.atlasInterpolationIcon,Z.CLAMP_TO_EDGE)),Ee.isSDF){let De=Ee.uniformValues;Ee.hasHalo&&(De.u_is_halo=1,Pl(Ee.buffers,Re.segments,u,w,Ee.program,ge,L,H,De,Ee.projectionData,Re.terrainData)),De.u_is_halo=0}Pl(Ee.buffers,Re.segments,u,w,Ee.program,ge,L,H,Ee.uniformValues,Ee.projectionData,Re.terrainData)}}function Pl(w,r,u,f,v,x,R,T,D,k,L){let H=f.context;v.draw(H,H.gl.TRIANGLES,x,R,T,yt.backCCW,D,L,k,u.id,w.layoutVertexBuffer,w.indexBuffer,r,u.paint,f.transform.zoom,w.programConfigurations.get(u.id),w.dynamicLayoutVertexBuffer,w.opacityVertexBuffer)}function ad(w,r,u,f,v){let x=w.context,R=x.gl,T=Ut.disabled,D=new pi([R.ONE,R.ONE],o.bf.transparent,[!0,!0,!0,!0]),k=r.getBucket(u);if(!k)return;let L=f.key,H=u.heatmapFbos.get(L);H||(H=Ml(x,r.tileSize,r.tileSize),u.heatmapFbos.set(L,H)),x.bindFramebuffer.set(H.framebuffer),x.viewport.set([0,0,r.tileSize,r.tileSize]),x.clear({color:o.bf.transparent});let B=k.programConfigurations.get(u.id),W=w.useProgram("heatmap",B,!v),Z=w.transform.getProjectionData({overscaledTileID:r.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ee=w.style.map.terrain.getTerrainData(f);W.draw(x,R.TRIANGLES,Pt.disabled,T,D,yt.disabled,yg(r,w.transform.zoom,u.paint.get("heatmap-intensity"),1),ee,Z,u.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,u.paint,w.transform.zoom,B)}function zg(w,r,u,f,v){let x=w.context,R=x.gl,T=w.transform;x.setColorMode(w.colorModeForRenderPass());let D=Tl(x,r),k=u.key,L=r.heatmapFbos.get(k);if(!L)return;x.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,L.colorAttachment.get()),x.activeTexture.set(R.TEXTURE1),D.bind(R.LINEAR,R.CLAMP_TO_EDGE);let H=T.getProjectionData({overscaledTileID:u,applyTerrainMatrix:v,applyGlobeMatrix:!f});w.useProgram("heatmapTexture").draw(x,R.TRIANGLES,Pt.disabled,Ut.disabled,w.colorModeForRenderPass(),yt.disabled,qu(w,r,0,1),null,H,r.id,w.rasterBoundsBuffer,w.quadTriangleIndexBuffer,w.rasterBoundsSegments,r.paint,T.zoom),L.destroy(),r.heatmapFbos.delete(k)}function Ml(w,r,u){var f,v;let x=w.gl,R=x.createTexture();x.bindTexture(x.TEXTURE_2D,R),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.LINEAR);let T=(f=w.HALF_FLOAT)!==null&&f!==void 0?f:x.UNSIGNED_BYTE,D=(v=w.RGBA16F)!==null&&v!==void 0?v:x.RGBA;x.texImage2D(x.TEXTURE_2D,0,D,r,u,0,x.RGBA,T,null);let k=w.createFramebuffer(r,u,!1,!1);return k.colorAttachment.set(R),k}function Tl(w,r){return r.colorRampTexture||(r.colorRampTexture=new o.T(w,r.colorRamp,w.gl.RGBA)),r.colorRampTexture}function Dl(w,r,u,f,v){if(!u||!f||!f.imageAtlas)return;let x=f.imageAtlas.patternPositions,R=x[u.to.toString()],T=x[u.from.toString()];if(!R&&T&&(R=T),!T&&R&&(T=R),!R||!T){let D=v.getPaintProperty(r);R=x[D],T=x[D]}R&&T&&w.setConstantPatternPositions(R,T)}function Pr(w,r,u,f,v,x,R,T){let D=w.context.gl,k="fill-pattern",L=u.paint.get(k),H=L&&L.constantOr(1),B=u.getCrossfadeParameters(),W,Z,ee,te,ie,oe=w.transform,le=u.paint.get("fill-translate"),ne=u.paint.get("fill-translate-anchor");R?(Z=H&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",W=D.LINES):(Z=H?"fillPattern":"fill",W=D.TRIANGLES);let ue=L.constantOr(null);for(let ge of f){let re=r.getTile(ge);if(H&&!re.patternsLoaded())continue;let we=re.getBucket(u);if(!we)continue;let Te=we.programConfigurations.get(u.id),Re=w.useProgram(Z,Te),Ee=w.style.map.terrain&&w.style.map.terrain.getTerrainData(ge);H&&(w.context.activeTexture.set(D.TEXTURE0),re.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),Te.updatePaintBuffers(B)),Dl(Te,k,ue,re,u);let De=oe.getProjectionData({overscaledTileID:ge,applyGlobeMatrix:!T,applyTerrainMatrix:!0}),Ke=o.aD(oe,re,le,ne);if(R){te=we.indexBuffer2,ie=we.segments2;let He=[D.drawingBufferWidth,D.drawingBufferHeight];ee=Z==="fillOutlinePattern"&&H?Cl(w,B,re,He,Ke):wl(He,Ke)}else te=we.indexBuffer,ie=we.segments,ee=H?Ac(w,B,re,Ke):{u_fill_translate:Ke};let Ze=w.stencilModeForClipping(ge);Re.draw(w.context,W,v,Ze,x,yt.backCCW,ee,Ee,De,u.id,we.layoutVertexBuffer,te,ie,u.paint,w.transform.zoom,Te)}}function Fl(w,r,u,f,v,x,R,T){let D=w.context,k=D.gl,L="fill-extrusion-pattern",H=u.paint.get(L),B=H.constantOr(1),W=u.getCrossfadeParameters(),Z=u.paint.get("fill-extrusion-opacity"),ee=H.constantOr(null),te=w.transform;for(let ie of f){let oe=r.getTile(ie),le=oe.getBucket(u);if(!le)continue;let ne=w.style.map.terrain&&w.style.map.terrain.getTerrainData(ie),ue=le.programConfigurations.get(u.id),ge=w.useProgram(B?"fillExtrusionPattern":"fillExtrusion",ue);B&&(w.context.activeTexture.set(k.TEXTURE0),oe.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ue.updatePaintBuffers(W));let re=te.getProjectionData({overscaledTileID:ie,applyGlobeMatrix:!T,applyTerrainMatrix:!0});Dl(ue,L,ee,oe,u);let we=o.aD(te,oe,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Te=u.paint.get("fill-extrusion-vertical-gradient"),Re=B?Vv(w,Te,Z,we,ie,W,oe):Ro(w,Te,Z,we);ge.draw(D,D.gl.TRIANGLES,v,x,R,yt.backCCW,Re,ne,re,u.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,u.paint,w.transform.zoom,ue,w.style.map.terrain&&le.centroidVertexBuffer)}}function ld(w,r,u,f,v,x,R,T,D){var k;let L=w.style.projection,H=w.context,B=w.transform,W=H.gl,Z=[`#define NUM_ILLUMINATION_SOURCES ${u.paint.get("hillshade-highlight-color").values.length}`],ee=w.useProgram("hillshade",null,!1,Z),te=!w.options.moving;for(let ie of f){let oe=r.getTile(ie),le=oe.fbo;if(!le)continue;let ne=L.getMeshFromTileID(H,ie.canonical,T,!0,"raster"),ue=(k=w.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(ie);H.activeTexture.set(W.TEXTURE0),W.bindTexture(W.TEXTURE_2D,le.colorAttachment.get());let ge=B.getProjectionData({overscaledTileID:ie,aligned:te,applyGlobeMatrix:!D,applyTerrainMatrix:!0});ee.draw(H,W.TRIANGLES,x,v[ie.overscaledZ],R,yt.backCCW,Gv(w,oe,u),ue,ge,u.id,ne.vertexBuffer,ne.indexBuffer,ne.segments)}}function Mr(w,r,u,f,v,x,R,T,D){var k;let L=w.style.projection,H=w.context,B=w.transform,W=H.gl,Z=w.useProgram("colorRelief"),ee=!w.options.moving,te=!0,ie=0;for(let oe of f){let le=r.getTile(oe),ne=le.dem;if(te){let Re=W.getParameter(W.MAX_TEXTURE_SIZE),{elevationTexture:Ee,colorTexture:De}=u.getColorRampTextures(H,Re,ne.getUnpackVector());H.activeTexture.set(W.TEXTURE1),Ee.bind(W.NEAREST,W.CLAMP_TO_EDGE),H.activeTexture.set(W.TEXTURE4),De.bind(W.LINEAR,W.CLAMP_TO_EDGE),te=!1,ie=Ee.size[0]}if(!ne||!ne.data)continue;let ue=ne.stride,ge=ne.getPixels();if(H.activeTexture.set(W.TEXTURE0),H.pixelStoreUnpackPremultiplyAlpha.set(!1),le.demTexture=le.demTexture||w.getTileTexture(ue),le.demTexture){let Re=le.demTexture;Re.update(ge,{premultiply:!1}),Re.bind(W.LINEAR,W.CLAMP_TO_EDGE)}else le.demTexture=new o.T(H,ge,W.RGBA,{premultiply:!1}),le.demTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE);let re=L.getMeshFromTileID(H,oe.canonical,T,!0,"raster"),we=(k=w.style.map.terrain)===null||k===void 0?void 0:k.getTerrainData(oe),Te=B.getProjectionData({overscaledTileID:oe,aligned:ee,applyGlobeMatrix:!D,applyTerrainMatrix:!0});Z.draw(H,W.TRIANGLES,x,v[oe.overscaledZ],R,yt.backCCW,Cg(u,le.dem,ie),we,Te,u.id,re.vertexBuffer,re.indexBuffer,re.segments)}}let cd=[new o.P(0,0),new o.P(o.$,0),new o.P(o.$,o.$),new o.P(0,o.$)];function Il(w,r,u,f,v,x,R,T,D=!1,k=!1){let L=f[f.length-1].overscaledZ,H=w.context,B=H.gl,W=w.useProgram("raster"),Z=w.transform,ee=w.style.projection,te=w.colorModeForRenderPass(),ie=!w.options.moving;for(let oe of f){let le=w.getDepthModeForSublayer(oe.overscaledZ-L,u.paint.get("raster-opacity")===1?Pt.ReadWrite:Pt.ReadOnly,B.LESS),ne=r.getTile(oe);ne.registerFadeDuration(u.paint.get("raster-fade-duration"));let ue=r.findLoadedParent(oe,0),ge=r.findLoadedSibling(oe),re=jc(ne,ue||ge||null,r,u,w.transform,w.style.map.terrain),we,Te,Re=u.paint.get("raster-resampling")==="nearest"?B.NEAREST:B.LINEAR;H.activeTexture.set(B.TEXTURE0),ne.texture.bind(Re,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),H.activeTexture.set(B.TEXTURE1),ue?(ue.texture.bind(Re,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),we=Math.pow(2,ue.tileID.overscaledZ-ne.tileID.overscaledZ),Te=[ne.tileID.canonical.x*we%1,ne.tileID.canonical.y*we%1]):ne.texture.bind(Re,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST),ne.texture.useMipmap&&H.extTextureFilterAnisotropic&&w.transform.pitch>20&&B.texParameterf(B.TEXTURE_2D,H.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,H.extTextureFilterAnisotropicMax);let Ee=w.style.map.terrain&&w.style.map.terrain.getTerrainData(oe),De=Z.getProjectionData({overscaledTileID:oe,aligned:ie,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),Ke=bl(Te||[0,0],we||1,re,u,T),Ze=ee.getMeshFromTileID(H,oe.canonical,x,R,"raster");W.draw(H,B.TRIANGLES,le,v?v[oe.overscaledZ]:Ut.disabled,te,D?yt.frontCCW:yt.backCCW,Ke,Ee,De,u.id,Ze.vertexBuffer,Ze.indexBuffer,Ze.segments)}}function jc(w,r,u,f,v,x){let R=f.paint.get("raster-fade-duration");if(!x&&R>0){let T=C.now(),D=(T-w.timeAdded)/R,k=r?(T-r.timeAdded)/R:-1,L=u.getSource(),H=ct(v,{tileSize:L.tileSize,roundZoom:L.roundZoom}),B=!r||Math.abs(r.tileID.overscaledZ-H)>Math.abs(w.tileID.overscaledZ-H),W=B&&w.refreshedUponExpiration?1:o.ah(B?D:1-k,0,1);return w.refreshedUponExpiration&&D>=1&&(w.refreshedUponExpiration=!1),r?{opacity:1,mix:1-W}:{opacity:W,mix:0}}return{opacity:1,mix:0}}let hd=new o.bf(1,0,0,1),Bg=new o.bf(0,1,0,1),Vg=new o.bf(0,0,1,1),$c=new o.bf(1,0,1,1),ud=new o.bf(0,1,1,1);function Hg(w,r,u,f){mi(w,0,r+u/2,w.transform.width,u,f)}function dd(w,r,u,f){mi(w,r-u/2,0,u,w.transform.height,f)}function mi(w,r,u,f,v,x){let R=w.context,T=R.gl;T.enable(T.SCISSOR_TEST),T.scissor(r*w.pixelRatio,u*w.pixelRatio,f*w.pixelRatio,v*w.pixelRatio),R.clear({color:x}),T.disable(T.SCISSOR_TEST)}function Tr(w,r,u){let f=w.context,v=f.gl,x=w.useProgram("debug"),R=Pt.disabled,T=Ut.disabled,D=w.colorModeForRenderPass(),k="$debug",L=w.style.map.terrain&&w.style.map.terrain.getTerrainData(u);f.activeTexture.set(v.TEXTURE0);let H=r.getTileByID(u.key).latestRawTileData,B=Math.floor((H&&H.byteLength||0)/1024),W=r.getTile(u).tileSize,Z=512/Math.min(W,512)*(u.overscaledZ/w.transform.zoom)*.5,ee=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(ee+=` => ${u.overscaledZ}`),function(ie,oe){ie.initDebugOverlayCanvas();let le=ie.debugOverlayCanvas,ne=ie.context.gl,ue=ie.debugOverlayCanvas.getContext("2d");ue.clearRect(0,0,le.width,le.height),ue.shadowColor="white",ue.shadowBlur=2,ue.lineWidth=1.5,ue.strokeStyle="white",ue.textBaseline="top",ue.font="bold 36px Open Sans, sans-serif",ue.fillText(oe,5,5),ue.strokeText(oe,5,5),ie.debugOverlayTexture.update(le),ie.debugOverlayTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE)}(w,`${ee} ${B}kB`);let te=w.transform.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(f,v.TRIANGLES,R,T,pi.alphaBlended,yt.disabled,xr(o.bf.transparent,Z),null,te,k,w.debugBuffer,w.quadTriangleIndexBuffer,w.debugSegments),x.draw(f,v.LINE_STRIP,R,T,D,yt.disabled,xr(o.bf.red),L,te,k,w.debugBuffer,w.tileBorderIndexBuffer,w.debugSegments)}function Js(w,r,u,f){let{isRenderingGlobe:v}=f,x=w.context,R=x.gl,T=w.transform,D=w.colorModeForRenderPass(),k=w.getDepthModeFor3D(),L=w.useProgram("terrain");x.bindFramebuffer.set(null),x.viewport.set([0,0,w.width,w.height]);for(let H of u){let B=r.getTerrainMesh(H.tileID),W=w.renderToTexture.getTexture(H),Z=r.getTerrainData(H.tileID);x.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,W.texture);let ee=r.getMeshFrameDelta(T.zoom),te=T.calculateFogMatrix(H.tileID.toUnwrapped()),ie=Ic(ee,te,w.style.sky,T.pitch,v),oe=T.getProjectionData({overscaledTileID:H.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});L.draw(x,R.TRIANGLES,k,Ut.disabled,D,yt.backCCW,ie,Z,oe,"terrain",B.vertexBuffer,B.indexBuffer,B.segments)}}function qc(w,r){if(!r.mesh){let u=new o.aL;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(1,1),u.emplaceBack(-1,1);let f=new o.aN;f.emplaceBack(0,1,2),f.emplaceBack(0,2,3),r.mesh=new mr(w.createVertexBuffer(u,On.members),w.createIndexBuffer(f),o.aM.simpleSegment(0,0,u.length,f.length))}return r.mesh}class Zc{constructor(r,u){this.context=new Ag(r),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=zt.maxUnderzooming+zt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ga}resize(r,u,f){if(this.width=Math.floor(r*f),this.height=Math.floor(u*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let v of this.style._order)this.style._layers[v].resize()}setup(){let r=this.context,u=new o.aL;u.emplaceBack(0,0),u.emplaceBack(o.$,0),u.emplaceBack(0,o.$),u.emplaceBack(o.$,o.$),this.tileExtentBuffer=r.createVertexBuffer(u,On.members),this.tileExtentSegments=o.aM.simpleSegment(0,0,4,2);let f=new o.aL;f.emplaceBack(0,0),f.emplaceBack(o.$,0),f.emplaceBack(0,o.$),f.emplaceBack(o.$,o.$),this.debugBuffer=r.createVertexBuffer(f,On.members),this.debugSegments=o.aM.simpleSegment(0,0,4,5);let v=new o.c6;v.emplaceBack(0,0,0,0),v.emplaceBack(o.$,0,o.$,0),v.emplaceBack(0,o.$,0,o.$),v.emplaceBack(o.$,o.$,o.$,o.$),this.rasterBoundsBuffer=r.createVertexBuffer(v,zv.members),this.rasterBoundsSegments=o.aM.simpleSegment(0,0,4,2);let x=new o.aL;x.emplaceBack(0,0),x.emplaceBack(o.$,0),x.emplaceBack(0,o.$),x.emplaceBack(o.$,o.$),this.rasterBoundsBufferPosOnly=r.createVertexBuffer(x,On.members),this.rasterBoundsSegmentsPosOnly=o.aM.simpleSegment(0,0,4,5);let R=new o.aL;R.emplaceBack(0,0),R.emplaceBack(1,0),R.emplaceBack(0,1),R.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(R,On.members),this.viewportSegments=o.aM.simpleSegment(0,0,4,2);let T=new o.c7;T.emplaceBack(0),T.emplaceBack(1),T.emplaceBack(3),T.emplaceBack(2),T.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(T);let D=new o.aN;D.emplaceBack(1,0,2),D.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(D);let k=this.context.gl;this.stencilClearMode=new Ut({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.tileExtentMesh=new mr(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){let r=this.context,u=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let f=o.L();o.bY(f,0,this.width,this.height,0,0,1),o.N(f,f,[u.drawingBufferWidth,u.drawingBufferHeight,0]);let v={mainMatrix:f,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:f};this.useProgram("clippingMask",null,!0).draw(r,u.TRIANGLES,Pt.disabled,this.stencilClearMode,pi.disabled,yt.disabled,null,null,v,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,u,f){if(this.currentStencilSource===r.source||!r.isTileClipped()||!u||!u.length)return;this.currentStencilSource=r.source,this.nextStencilID+u.length>256&&this.clearStencil();let v=this.context;v.setColorMode(pi.disabled),v.setDepthMode(Pt.disabled);let x={};for(let R of u)x[R.key]=this.nextStencilID++;this._renderTileMasks(x,u,f,!0),this._renderTileMasks(x,u,f,!1),this._tileClippingMaskIDs=x}_renderTileMasks(r,u,f,v){let x=this.context,R=x.gl,T=this.style.projection,D=this.transform,k=this.useProgram("clippingMask");for(let L of u){let H=r[L.key],B=this.style.map.terrain&&this.style.map.terrain.getTerrainData(L),W=T.getMeshFromTileID(this.context,L.canonical,v,!0,"stencil"),Z=D.getProjectionData({overscaledTileID:L,applyGlobeMatrix:!f,applyTerrainMatrix:!0});k.draw(x,R.TRIANGLES,Pt.disabled,new Ut({func:R.ALWAYS,mask:0},H,255,R.KEEP,R.KEEP,R.REPLACE),pi.disabled,f?yt.disabled:yt.backCCW,null,B,Z,"$clipping",W.vertexBuffer,W.indexBuffer,W.segments)}}_renderTilesDepthBuffer(){let r=this.context,u=r.gl,f=this.style.projection,v=this.transform,x=this.useProgram("depth"),R=this.getDepthModeFor3D(),T=xe(v,{tileSize:v.tileSize});for(let D of T){let k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(D),L=f.getMeshFromTileID(this.context,D.canonical,!0,!0,"raster"),H=v.getProjectionData({overscaledTileID:D,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(r,u.TRIANGLES,R,Ut.disabled,pi.disabled,yt.backCCW,null,k,H,"$clipping",L.vertexBuffer,L.indexBuffer,L.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let r=this.nextStencilID++,u=this.context.gl;return new Ut({func:u.NOTEQUAL,mask:255},r,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(r){let u=this.context.gl;return new Ut({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,u.KEEP,u.KEEP,u.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(r){let u=this.context.gl,f=r.sort((R,T)=>T.overscaledZ-R.overscaledZ),v=f[f.length-1].overscaledZ,x=f[0].overscaledZ-v+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();let R={};for(let T=0;T<x;T++)R[T+v]=new Ut({func:u.GEQUAL,mask:255},T+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=x,[R,f]}return[{[v]:Ut.disabled},f]}stencilConfigForOverlapTwoPass(r){let u=this.context.gl,f=r.sort((R,T)=>T.overscaledZ-R.overscaledZ),v=f[f.length-1].overscaledZ,x=f[0].overscaledZ-v+1;if(this.clearStencil(),x>1){let R={},T={};for(let D=0;D<x;D++)R[D+v]=new Ut({func:u.GREATER,mask:255},x+1+D,255,u.KEEP,u.KEEP,u.REPLACE),T[D+v]=new Ut({func:u.GREATER,mask:255},1+D,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID=2*x+1,[R,T,f]}return this.nextStencilID=3,[{[v]:new Ut({func:u.GREATER,mask:255},2,255,u.KEEP,u.KEEP,u.REPLACE)},{[v]:new Ut({func:u.GREATER,mask:255},1,255,u.KEEP,u.KEEP,u.REPLACE)},f]}colorModeForRenderPass(){let r=this.context.gl;return this._showOverdrawInspector?new pi([r.CONSTANT_COLOR,r.ONE],new o.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?pi.unblended:pi.alphaBlended}getDepthModeForSublayer(r,u,f){if(!this.opaquePassEnabledForLayer())return Pt.disabled;let v=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new Pt(f||this.context.gl.LEQUAL,u,[v,v])}getDepthModeFor3D(){return new Pt(this.context.gl.LEQUAL,Pt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,u){var f,v;this.style=r,this.options=u,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(C.now()),this.imageManager.beginFrame();let x=this.style._order,R=this.style.sourceCaches,T={},D={},k={},L={isRenderingToTexture:!1,isRenderingGlobe:((f=r.projection)===null||f===void 0?void 0:f.transitionState)>0};for(let B in R){let W=R[B];W.used&&W.prepare(this.context),T[B]=W.getVisibleCoordinates(!1),D[B]=T[B].slice().reverse(),k[B]=W.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let B=0;B<x.length;B++)if(this.style._layers[x[B]].is3D()){this.opaquePassCutoff=B;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(let B of x){let W=this.style._layers[B];if(!W.hasOffscreenPass()||W.isHidden(this.transform.zoom))continue;let Z=D[W.source];(W.type==="custom"||Z.length)&&this.renderLayer(this,R[W.source],W,Z,L)}if((v=this.style.projection)===null||v===void 0||v.updateGPUdependent({context:this.context,useProgram:B=>this.useProgram(B)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?o.bf.black:o.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(B,W){let Z=B.context,ee=Z.gl,te=((ge,re,we)=>{let Te=Math.cos(re.rollInRadians),Re=Math.sin(re.rollInRadians),Ee=de(re),De=re.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:ge.properties.get("sky-color"),u_horizon_color:ge.properties.get("horizon-color"),u_horizon:[(re.width/2-Ee*Re)*we,(re.height/2+Ee*Te)*we],u_horizon_normal:[-Re,Te],u_sky_horizon_blend:ge.properties.get("sky-horizon-blend")*re.height/2*we,u_sky_blend:De}})(W,B.style.map.transform,B.pixelRatio),ie=new Pt(ee.LEQUAL,Pt.ReadWrite,[0,1]),oe=Ut.disabled,le=B.colorModeForRenderPass(),ne=B.useProgram("sky"),ue=qc(Z,W);ne.draw(Z,ee.TRIANGLES,ie,oe,le,yt.disabled,te,null,void 0,"sky",ue.vertexBuffer,ue.indexBuffer,ue.segments)}(this,this.style.sky),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){let B=this.style._layers[x[this.currentLayer]],W=R[B.source],Z=T[B.source];this._renderTileClippingMasks(B,Z,!1),this.renderLayer(this,W,B,Z,L)}this.renderPass="translucent";let H=!1;for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){let B=this.style._layers[x[this.currentLayer]],W=R[B.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(B,L))continue;this.opaquePassEnabledForLayer()||H||(H=!0,L.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());let Z=(B.type==="symbol"?k:D)[B.source];this._renderTileClippingMasks(B,T[B.source],!!this.renderToTexture),this.renderLayer(this,W,B,Z,L)}if(L.isRenderingGlobe&&function(B,W,Z){let ee=B.context,te=ee.gl,ie=B.useProgram("atmosphere"),oe=new Pt(te.LEQUAL,Pt.ReadOnly,[0,1]),le=B.transform,ne=function(De,Ke){let Ze=De.properties.get("position"),He=[-Ze.x,-Ze.y,-Ze.z],ut=o.ag(new Float64Array(16));return De.properties.get("anchor")==="map"&&(o.b6(ut,ut,Ke.rollInRadians),o.b7(ut,ut,-Ke.pitchInRadians),o.b6(ut,ut,Ke.bearingInRadians),o.b7(ut,ut,Ke.center.lat*Math.PI/180),o.bz(ut,ut,-Ke.center.lng*Math.PI/180)),o.c5(He,He,ut),He}(Z,B.transform),ue=le.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ge=W.properties.get("atmosphere-blend")*ue.projectionTransition;if(ge===0)return;let re=ma(le.worldSize,le.center.lat),we=le.inverseProjectionMatrix,Te=new Float64Array(4);Te[3]=1,o.aw(Te,Te,le.modelViewProjectionMatrix),Te[0]/=Te[3],Te[1]/=Te[3],Te[2]/=Te[3],Te[3]=1,o.aw(Te,Te,we),Te[0]/=Te[3],Te[1]/=Te[3],Te[2]/=Te[3],Te[3]=1;let Re=((De,Ke,Ze,He,ut)=>({u_sun_pos:De,u_atmosphere_blend:Ke,u_globe_position:Ze,u_globe_radius:He,u_inv_proj_matrix:ut}))(ne,ge,[Te[0],Te[1],Te[2]],re,we),Ee=qc(ee,W);ie.draw(ee,te.TRIANGLES,oe,Ut.disabled,pi.alphaBlended,yt.disabled,Re,null,null,"atmosphere",Ee.vertexBuffer,Ee.indexBuffer,Ee.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){let B=function(W,Z){let ee=null,te=Object.values(W._layers).flatMap(ne=>ne.source&&!ne.isHidden(Z)?[W.sourceCaches[ne.source]]:[]),ie=te.filter(ne=>ne.getSource().type==="vector"),oe=te.filter(ne=>ne.getSource().type!=="vector"),le=ne=>{(!ee||ee.getSource().maxzoom<ne.getSource().maxzoom)&&(ee=ne)};return ie.forEach(ne=>le(ne)),ee||oe.forEach(ne=>le(ne)),ee}(this.style,this.transform.zoom);B&&function(W,Z,ee){for(let te=0;te<ee.length;te++)Tr(W,Z,ee[te])}(this,B,B.getVisibleCoordinates())}this.options.showPadding&&function(B){let W=B.transform.padding;Hg(B,B.transform.height-(W.top||0),3,hd),Hg(B,W.bottom||0,3,Bg),dd(B,W.left||0,3,Vg),dd(B,B.transform.width-(W.right||0),3,$c);let Z=B.transform.centerPoint;(function(ee,te,ie,oe){mi(ee,te-1,ie-10,2,20,oe),mi(ee,te-10,ie-1,20,2,oe)})(B,Z.x,B.transform.height-Z.y,ud)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(r){if(!this.style||!this.style.map||!this.style.map.terrain)return;let u=this.terrainFacilitator.matrix,f=this.transform.modelViewProjectionMatrix,v=this.terrainFacilitator.dirty;v||(v=r?!o.c8(u,f):!o.c9(u,f)),v||(v=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),v&&(o.ca(u,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(x,R){let T=x.context,D=T.gl,k=x.transform,L=pi.unblended,H=new Pt(D.LEQUAL,Pt.ReadWrite,[0,1]),B=R.sourceCache.getRenderableTiles(),W=x.useProgram("terrainDepth");T.bindFramebuffer.set(R.getFramebuffer("depth").framebuffer),T.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),T.clear({color:o.bf.transparent,depth:1});for(let Z of B){let ee=R.getTerrainMesh(Z.tileID),te=R.getTerrainData(Z.tileID),ie=k.getProjectionData({overscaledTileID:Z.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),oe={u_ele_delta:R.getMeshFrameDelta(k.zoom)};W.draw(T,D.TRIANGLES,H,Ut.disabled,L,yt.backCCW,oe,te,ie,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments)}T.bindFramebuffer.set(null),T.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain),function(x,R){let T=x.context,D=T.gl,k=x.transform,L=pi.unblended,H=new Pt(D.LEQUAL,Pt.ReadWrite,[0,1]),B=R.getCoordsTexture(),W=R.sourceCache.getRenderableTiles(),Z=x.useProgram("terrainCoords");T.bindFramebuffer.set(R.getFramebuffer("coords").framebuffer),T.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),T.clear({color:o.bf.transparent,depth:1}),R.coordsIndex=[];for(let ee of W){let te=R.getTerrainMesh(ee.tileID),ie=R.getTerrainData(ee.tileID);T.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,B.texture);let oe={u_terrain_coords_id:(255-R.coordsIndex.length)/255,u_texture:0,u_ele_delta:R.getMeshFrameDelta(k.zoom)},le=k.getProjectionData({overscaledTileID:ee.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Z.draw(T,D.TRIANGLES,H,Ut.disabled,L,yt.backCCW,oe,ie,le,"terrain",te.vertexBuffer,te.indexBuffer,te.segments),R.coordsIndex.push(ee.tileID.key)}T.bindFramebuffer.set(null),T.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain))}renderLayer(r,u,f,v,x){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||(v||[]).length)&&(this.id=f.id,o.cb(f)?function(R,T,D,k,L,H){if(R.renderPass!=="translucent")return;let{isRenderingToTexture:B}=H,W=Ut.disabled,Z=R.colorModeForRenderPass();(D._unevaluatedLayout.hasValue("text-variable-anchor")||D._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ee,te,ie,oe,le,ne,ue,ge,re){let we=te.transform,Te=te.style.map.terrain,Re=le==="map",Ee=ne==="map";for(let De of ee){let Ke=oe.getTile(De),Ze=Ke.getBucket(ie);if(!Ze||!Ze.text||!Ze.text.segments.get().length)continue;let He=o.an(Ze.textSizeData,we.zoom),ut=o.aC(Ke,1,te.transform.zoom),It=Hi(Re,te.transform,ut),Xt=ie.layout.get("icon-text-fit")!=="none"&&Ze.hasIconData();if(He){let yi=Math.pow(2,we.zoom-Ke.tileID.overscaledZ),ni=Te?(ti,wi)=>Te.getElevation(De,ti,wi):null;rd(Ze,Re,Ee,re,we,It,yi,He,Xt,o.aD(we,Ke,ue,ge),De.toUnwrapped(),ni)}}}(k,R,D,T,D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),L),D.paint.get("icon-opacity").constantOr(1)!==0&&El(R,T,D,k,!1,D.paint.get("icon-translate"),D.paint.get("icon-translate-anchor"),D.layout.get("icon-rotation-alignment"),D.layout.get("icon-pitch-alignment"),D.layout.get("icon-keep-upright"),W,Z,B),D.paint.get("text-opacity").constantOr(1)!==0&&El(R,T,D,k,!0,D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.layout.get("text-keep-upright"),W,Z,B),T.map.showCollisionBoxes&&(Lg(R,T,D,k,!0),Lg(R,T,D,k,!1))}(r,u,f,v,this.style.placement.variableOffsets,x):o.cc(f)?function(R,T,D,k,L){if(R.renderPass!=="translucent")return;let{isRenderingToTexture:H}=L,B=D.paint.get("circle-opacity"),W=D.paint.get("circle-stroke-width"),Z=D.paint.get("circle-stroke-opacity"),ee=!D.layout.get("circle-sort-key").isConstant();if(B.constantOr(1)===0&&(W.constantOr(1)===0||Z.constantOr(1)===0))return;let te=R.context,ie=te.gl,oe=R.transform,le=R.getDepthModeForSublayer(0,Pt.ReadOnly),ne=Ut.disabled,ue=R.colorModeForRenderPass(),ge=[],re=oe.getCircleRadiusCorrection();for(let we=0;we<k.length;we++){let Te=k[we],Re=T.getTile(Te),Ee=Re.getBucket(D);if(!Ee)continue;let De=D.paint.get("circle-translate"),Ke=D.paint.get("circle-translate-anchor"),Ze=o.aD(oe,Re,De,Ke),He=Ee.programConfigurations.get(D.id),ut=R.useProgram("circle",He),It=Ee.layoutVertexBuffer,Xt=Ee.indexBuffer,yi=R.style.map.terrain&&R.style.map.terrain.getTerrainData(Te),ni={programConfiguration:He,program:ut,layoutVertexBuffer:It,indexBuffer:Xt,uniformValues:Hv(R,Re,D,Ze,re),terrainData:yi,projectionData:oe.getProjectionData({overscaledTileID:Te,applyGlobeMatrix:!H,applyTerrainMatrix:!0})};if(ee){let ti=Ee.segments.get();for(let wi of ti)ge.push({segments:new o.aM([wi]),sortKey:wi.sortKey,state:ni})}else ge.push({segments:Ee.segments,sortKey:0,state:ni})}ee&&ge.sort((we,Te)=>we.sortKey-Te.sortKey);for(let we of ge){let{programConfiguration:Te,program:Re,layoutVertexBuffer:Ee,indexBuffer:De,uniformValues:Ke,terrainData:Ze,projectionData:He}=we.state;Re.draw(te,ie.TRIANGLES,le,ne,ue,yt.backCCW,Ke,Ze,He,D.id,Ee,De,we.segments,D.paint,R.transform.zoom,Te)}}(r,u,f,v,x):o.cd(f)?function(R,T,D,k,L){if(D.paint.get("heatmap-opacity")===0)return;let H=R.context,{isRenderingToTexture:B,isRenderingGlobe:W}=L;if(R.style.map.terrain){for(let Z of k){let ee=T.getTile(Z);T.hasRenderableParent(Z)||(R.renderPass==="offscreen"?ad(R,ee,D,Z,W):R.renderPass==="translucent"&&zg(R,D,Z,B,W))}H.viewport.set([0,0,R.width,R.height])}else R.renderPass==="offscreen"?function(Z,ee,te,ie){let oe=Z.context,le=oe.gl,ne=Z.transform,ue=Ut.disabled,ge=new pi([le.ONE,le.ONE],o.bf.transparent,[!0,!0,!0,!0]);(function(re,we,Te){let Re=re.gl;re.activeTexture.set(Re.TEXTURE1),re.viewport.set([0,0,we.width/4,we.height/4]);let Ee=Te.heatmapFbos.get(o.c2);Ee?(Re.bindTexture(Re.TEXTURE_2D,Ee.colorAttachment.get()),re.bindFramebuffer.set(Ee.framebuffer)):(Ee=Ml(re,we.width/4,we.height/4),Te.heatmapFbos.set(o.c2,Ee))})(oe,Z,te),oe.clear({color:o.bf.transparent});for(let re=0;re<ie.length;re++){let we=ie[re];if(ee.hasRenderableParent(we))continue;let Te=ee.getTile(we),Re=Te.getBucket(te);if(!Re)continue;let Ee=Re.programConfigurations.get(te.id),De=Z.useProgram("heatmap",Ee),Ke=ne.getProjectionData({overscaledTileID:we,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Ze=ne.getCircleRadiusCorrection();De.draw(oe,le.TRIANGLES,Pt.disabled,ue,ge,yt.backCCW,yg(Te,ne.zoom,te.paint.get("heatmap-intensity"),Ze),null,Ke,te.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,te.paint,ne.zoom,Ee)}oe.viewport.set([0,0,Z.width,Z.height])}(R,T,D,k):R.renderPass==="translucent"&&function(Z,ee){let te=Z.context,ie=te.gl;te.setColorMode(Z.colorModeForRenderPass());let oe=ee.heatmapFbos.get(o.c2);oe&&(te.activeTexture.set(ie.TEXTURE0),ie.bindTexture(ie.TEXTURE_2D,oe.colorAttachment.get()),te.activeTexture.set(ie.TEXTURE1),Tl(te,ee).bind(ie.LINEAR,ie.CLAMP_TO_EDGE),Z.useProgram("heatmapTexture").draw(te,ie.TRIANGLES,Pt.disabled,Ut.disabled,Z.colorModeForRenderPass(),yt.disabled,qu(Z,ee,0,1),null,null,ee.id,Z.viewportBuffer,Z.quadTriangleIndexBuffer,Z.viewportSegments,ee.paint,Z.transform.zoom))}(R,D)}(r,u,f,v,x):o.ce(f)?function(R,T,D,k,L){if(R.renderPass!=="translucent")return;let{isRenderingToTexture:H}=L,B=D.paint.get("line-opacity"),W=D.paint.get("line-width");if(B.constantOr(1)===0||W.constantOr(1)===0)return;let Z=R.getDepthModeForSublayer(0,Pt.ReadOnly),ee=R.colorModeForRenderPass(),te=D.paint.get("line-dasharray"),ie=D.paint.get("line-pattern"),oe=ie.constantOr(1),le=D.paint.get("line-gradient"),ne=D.getCrossfadeParameters(),ue=oe?"linePattern":te?"lineSDF":le?"lineGradient":"line",ge=R.context,re=ge.gl,we=R.transform,Te=!0;for(let Re of k){let Ee=T.getTile(Re);if(oe&&!Ee.patternsLoaded())continue;let De=Ee.getBucket(D);if(!De)continue;let Ke=De.programConfigurations.get(D.id),Ze=R.context.program.get(),He=R.useProgram(ue,Ke),ut=Te||He.program!==Ze,It=R.style.map.terrain&&R.style.map.terrain.getTerrainData(Re),Xt=ie.constantOr(null);if(Xt&&Ee.imageAtlas){let hi=Ee.imageAtlas,ri=hi.patternPositions[Xt.to.toString()],$t=hi.patternPositions[Xt.from.toString()];ri&&$t&&Ke.setConstantPatternPositions(ri,$t)}let yi=we.getProjectionData({overscaledTileID:Re,applyGlobeMatrix:!H,applyTerrainMatrix:!0}),ni=we.getPixelScale(),ti=oe?xg(R,Ee,D,ni,ne):te?_r(R,Ee,D,ni,te,ne):le?bg(R,Ee,D,ni,De.lineClipsArray.length):Oc(R,Ee,D,ni);if(oe)ge.activeTexture.set(re.TEXTURE0),Ee.imageAtlasTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE),Ke.updatePaintBuffers(ne);else if(te&&(ut||R.lineAtlas.dirty))ge.activeTexture.set(re.TEXTURE0),R.lineAtlas.bind(ge);else if(le){let hi=De.gradients[D.id],ri=hi.texture;if(D.gradientVersion!==hi.version){let $t=256;if(D.stepInterpolant){let ts=T.getSource().maxzoom,Ki=Re.canonical.z===ts?Math.ceil(1<<R.transform.maxZoom-Re.canonical.z):1;$t=o.ah(o.c3(De.maxLineLength/o.$*1024*Ki),256,ge.maxTextureSize)}hi.gradient=o.c4({expression:D.gradientExpression(),evaluationKey:"lineProgress",resolution:$t,image:hi.gradient||void 0,clips:De.lineClipsArray}),hi.texture?hi.texture.update(hi.gradient):hi.texture=new o.T(ge,hi.gradient,re.RGBA),hi.version=D.gradientVersion,ri=hi.texture}ge.activeTexture.set(re.TEXTURE0),ri.bind(D.stepInterpolant?re.NEAREST:re.LINEAR,re.CLAMP_TO_EDGE)}let wi=R.stencilModeForClipping(Re);He.draw(ge,re.TRIANGLES,Z,wi,ee,yt.disabled,ti,It,yi,D.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,D.paint,R.transform.zoom,Ke,De.layoutVertexBuffer2),Te=!1}}(r,u,f,v,x):o.cf(f)?function(R,T,D,k,L){let H=D.paint.get("fill-color"),B=D.paint.get("fill-opacity");if(B.constantOr(1)===0)return;let{isRenderingToTexture:W}=L,Z=R.colorModeForRenderPass(),ee=D.paint.get("fill-pattern"),te=R.opaquePassEnabledForLayer()&&!ee.constantOr(1)&&H.constantOr(o.bf.transparent).a===1&&B.constantOr(0)===1?"opaque":"translucent";if(R.renderPass===te){let ie=R.getDepthModeForSublayer(1,R.renderPass==="opaque"?Pt.ReadWrite:Pt.ReadOnly);Pr(R,T,D,k,ie,Z,!1,W)}if(R.renderPass==="translucent"&&D.paint.get("fill-antialias")){let ie=R.getDepthModeForSublayer(D.getPaintProperty("fill-outline-color")?2:0,Pt.ReadOnly);Pr(R,T,D,k,ie,Z,!0,W)}}(r,u,f,v,x):o.cg(f)?function(R,T,D,k,L){let H=D.paint.get("fill-extrusion-opacity");if(H===0)return;let{isRenderingToTexture:B}=L;if(R.renderPass==="translucent"){let W=new Pt(R.context.gl.LEQUAL,Pt.ReadWrite,R.depthRangeFor3D);if(H!==1||D.paint.get("fill-extrusion-pattern").constantOr(1))Fl(R,T,D,k,W,Ut.disabled,pi.disabled,B),Fl(R,T,D,k,W,R.stencilModeFor3D(),R.colorModeForRenderPass(),B);else{let Z=R.colorModeForRenderPass();Fl(R,T,D,k,W,Ut.disabled,Z,B)}}}(r,u,f,v,x):o.ch(f)?function(R,T,D,k,L){if(R.renderPass!=="offscreen"&&R.renderPass!=="translucent")return;let{isRenderingToTexture:H}=L,B=R.context,W=R.style.projection.useSubdivision,Z=R.getDepthModeForSublayer(0,Pt.ReadOnly),ee=R.colorModeForRenderPass();if(R.renderPass==="offscreen")(function(te,ie,oe,le,ne,ue,ge){let re=te.context,we=re.gl;for(let Te of oe){let Re=ie.getTile(Te),Ee=Re.dem;if(!Ee||!Ee.data||!Re.needsHillshadePrepare)continue;let De=Ee.dim,Ke=Ee.stride,Ze=Ee.getPixels();if(re.activeTexture.set(we.TEXTURE1),re.pixelStoreUnpackPremultiplyAlpha.set(!1),Re.demTexture=Re.demTexture||te.getTileTexture(Ke),Re.demTexture){let ut=Re.demTexture;ut.update(Ze,{premultiply:!1}),ut.bind(we.NEAREST,we.CLAMP_TO_EDGE)}else Re.demTexture=new o.T(re,Ze,we.RGBA,{premultiply:!1}),Re.demTexture.bind(we.NEAREST,we.CLAMP_TO_EDGE);re.activeTexture.set(we.TEXTURE0);let He=Re.fbo;if(!He){let ut=new o.T(re,{width:De,height:De,data:null},we.RGBA);ut.bind(we.LINEAR,we.CLAMP_TO_EDGE),He=Re.fbo=re.createFramebuffer(De,De,!0,!1),He.colorAttachment.set(ut.texture)}re.bindFramebuffer.set(He.framebuffer),re.viewport.set([0,0,De,De]),te.useProgram("hillshadePrepare").draw(re,we.TRIANGLES,ne,ue,ge,yt.disabled,wg(Re.tileID,Ee),null,null,le.id,te.rasterBoundsBuffer,te.quadTriangleIndexBuffer,te.rasterBoundsSegments),Re.needsHillshadePrepare=!1}})(R,T,k,D,Z,Ut.disabled,ee),B.viewport.set([0,0,R.width,R.height]);else if(R.renderPass==="translucent")if(W){let[te,ie,oe]=R.stencilConfigForOverlapTwoPass(k);ld(R,T,D,oe,te,Z,ee,!1,H),ld(R,T,D,oe,ie,Z,ee,!0,H)}else{let[te,ie]=R.getStencilConfigForOverlapAndUpdateStencilID(k);ld(R,T,D,ie,te,Z,ee,!1,H)}}(r,u,f,v,x):o.ci(f)?function(R,T,D,k,L){if(R.renderPass!=="translucent"||!k.length)return;let{isRenderingToTexture:H}=L,B=R.style.projection.useSubdivision,W=R.getDepthModeForSublayer(0,Pt.ReadOnly),Z=R.colorModeForRenderPass();if(B){let[ee,te,ie]=R.stencilConfigForOverlapTwoPass(k);Mr(R,T,D,ie,ee,W,Z,!1,H),Mr(R,T,D,ie,te,W,Z,!0,H)}else{let[ee,te]=R.getStencilConfigForOverlapAndUpdateStencilID(k);Mr(R,T,D,te,ee,W,Z,!1,H)}}(r,u,f,v,x):o.cj(f)?function(R,T,D,k,L){if(R.renderPass!=="translucent"||D.paint.get("raster-opacity")===0||!k.length)return;let{isRenderingToTexture:H}=L,B=T.getSource(),W=R.style.projection.useSubdivision;if(B instanceof Go)Il(R,T,D,k,null,!1,!1,B.tileCoords,B.flippedWindingOrder,H);else if(W){let[Z,ee,te]=R.stencilConfigForOverlapTwoPass(k);Il(R,T,D,te,Z,!1,!0,cd,!1,H),Il(R,T,D,te,ee,!0,!0,cd,!1,H)}else{let[Z,ee]=R.getStencilConfigForOverlapAndUpdateStencilID(k);Il(R,T,D,ee,Z,!1,!0,cd,!1,H)}}(r,u,f,v,x):o.ck(f)?function(R,T,D,k,L){let H=D.paint.get("background-color"),B=D.paint.get("background-opacity");if(B===0)return;let{isRenderingToTexture:W}=L,Z=R.context,ee=Z.gl,te=R.style.projection,ie=R.transform,oe=ie.tileSize,le=D.paint.get("background-pattern");if(R.isPatternMissing(le))return;let ne=!le&&H.a===1&&B===1&&R.opaquePassEnabledForLayer()?"opaque":"translucent";if(R.renderPass!==ne)return;let ue=Ut.disabled,ge=R.getDepthModeForSublayer(0,ne==="opaque"?Pt.ReadWrite:Pt.ReadOnly),re=R.colorModeForRenderPass(),we=R.useProgram(le?"backgroundPattern":"background"),Te=k||xe(ie,{tileSize:oe,terrain:R.style.map.terrain});le&&(Z.activeTexture.set(ee.TEXTURE0),R.imageManager.bind(R.context));let Re=D.getCrossfadeParameters();for(let Ee of Te){let De=ie.getProjectionData({overscaledTileID:Ee,applyGlobeMatrix:!W,applyTerrainMatrix:!0}),Ke=le?Rg(B,R,le,{tileID:Ee,tileSize:oe},Re):Sg(B,H),Ze=R.style.map.terrain&&R.style.map.terrain.getTerrainData(Ee),He=te.getMeshFromTileID(Z,Ee.canonical,!1,!0,"raster");we.draw(Z,ee.TRIANGLES,ge,ue,re,yt.backCCW,Ke,Ze,De,D.id,He.vertexBuffer,He.indexBuffer,He.segments)}}(r,0,f,v,x):o.cl(f)&&function(R,T,D,k){let{isRenderingGlobe:L}=k,H=R.context,B=D.implementation,W=R.style.projection,Z=R.transform,ee=Z.getProjectionDataForCustomLayer(L),te={farZ:Z.farZ,nearZ:Z.nearZ,fov:Z.fov*Math.PI/180,modelViewProjectionMatrix:Z.modelViewProjectionMatrix,projectionMatrix:Z.projectionMatrix,shaderData:{variantName:W.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${W.shaderPreludeCode.vertexSource}`,define:W.shaderDefine},defaultProjectionData:ee},ie=B.renderingMode?B.renderingMode:"2d";if(R.renderPass==="offscreen"){let oe=B.prerender;oe&&(R.setCustomLayerDefaults(),H.setColorMode(R.colorModeForRenderPass()),oe.call(B,H.gl,te),H.setDirty(),R.setBaseState())}else if(R.renderPass==="translucent"){R.setCustomLayerDefaults(),H.setColorMode(R.colorModeForRenderPass()),H.setStencilMode(Ut.disabled);let oe=ie==="3d"?R.getDepthModeFor3D():R.getDepthModeForSublayer(0,Pt.ReadOnly);H.setDepthMode(oe),B.render(H.gl,te),H.setDirty(),R.setBaseState(),H.bindFramebuffer.set(null)}}(r,0,f,x))}saveTileTexture(r){let u=this._tileTextures[r.size[0]];u?u.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){let u=this._tileTextures[r];return u&&u.length>0?u.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;let u=this.imageManager.getPattern(r.from.toString()),f=this.imageManager.getPattern(r.to.toString());return!u||!f}useProgram(r,u,f=!1,v=[]){this.cache=this.cache||{};let x=!!this.style.map.terrain,R=this.style.projection,T=f?_o.projectionMercator:R.shaderPreludeCode,D=f?an:R.shaderDefine,k=r+(u?u.cacheKey:"")+`/${f?vr:R.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(x?"/terrain":"")+(v?`/${v.join("/")}`:"");return this.cache[k]||(this.cache[k]=new $u(this.context,_o[r],u,Qu[r],this._showOverdrawInspector,x,T,D,v)),this.cache[k]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:r,drawingBufferHeight:u}=this.context.gl;return this.width!==r||this.height!==u}}function pd(w,r){let u,f=!1,v=null,x=null,R=()=>{v=null,f&&(w.apply(x,u),v=setTimeout(R,r),f=!1)};return(...T)=>(f=!0,x=this,u=T,v||R(),v)}class Dr{constructor(r){this._getCurrentHash=()=>{let u=window.location.hash.replace("#","");if(this._hashName){let f;return u.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(f=v)}),(f&&f[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{let u=this._getCurrentHash();if(!this._isValidHash(u))return!1;let f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:f,pitch:+(u[4]||0)}),!0},this._updateHashUnthrottled=()=>{let u=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,u)},this._removeHash=()=>{let u=this._getCurrentHash();if(u.length===0)return;let f=u.join("/"),v=f;v.split("&").length>0&&(v=v.split("&")[0]),this._hashName&&(v=`${this._hashName}=${f}`);let x=window.location.hash.replace(v,"");x.startsWith("#&")?x=x.slice(0,1)+x.slice(2):x==="#"&&(x="");let R=window.location.href.replace(/(#.+)?$/,x);R=R.replace("&&","&"),window.history.replaceState(window.history.state,null,R)},this._updateHash=pd(this._updateHashUnthrottled,300),this._hashName=r&&encodeURIComponent(r)}addTo(r){return this._map=r,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(r){let u=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,v=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,v),R=Math.round(u.lng*x)/x,T=Math.round(u.lat*x)/x,D=this._map.getBearing(),k=this._map.getPitch(),L="";if(L+=r?`/${R}/${T}/${f}`:`${f}/${T}/${R}`,(D||k)&&(L+="/"+Math.round(10*D)/10),k&&(L+=`/${Math.round(k)}`),this._hashName){let H=this._hashName,B=!1,W=window.location.hash.slice(1).split("&").map(Z=>{let ee=Z.split("=")[0];return ee===H?(B=!0,`${ee}=${L}`):Z}).filter(Z=>Z);return B||W.push(`${H}=${L}`),`#${W.join("&")}`}return`#${L}`}_isValidHash(r){if(r.length<3||r.some(isNaN))return!1;try{new o.S(+r[2],+r[1])}catch{return!1}let u=+r[0],f=+(r[3]||0),v=+(r[4]||0);return u>=this._map.getMinZoom()&&u<=this._map.getMaxZoom()&&f>=-180&&f<=180&&v>=this._map.getMinPitch()&&v<=this._map.getMaxPitch()}}let Fr={linearity:.3,easing:o.cm(0,0,.3,1)},kl=o.e({deceleration:2500,maxSpeed:1400},Fr),gd=o.e({deceleration:20,maxSpeed:1400},Fr),Ng=o.e({deceleration:1e3,maxSpeed:360},Fr),Gg=o.e({deceleration:1e3,maxSpeed:90},Fr),Wg=o.e({deceleration:1e3,maxSpeed:360},Fr);class Ug{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:C.now(),settings:r})}_drainInertiaBuffer(){let r=this._inertiaBuffer,u=C.now();for(;r.length>0&&u-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let u={zoom:0,bearing:0,pitch:0,roll:0,pan:new o.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:x}of this._inertiaBuffer)u.zoom+=x.zoomDelta||0,u.bearing+=x.bearingDelta||0,u.pitch+=x.pitchDelta||0,u.roll+=x.rollDelta||0,x.panDelta&&u.pan._add(x.panDelta),x.around&&(u.around=x.around),x.pinchAround&&(u.pinchAround=x.pinchAround);let f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(u.pan.mag()){let x=Eo(u.pan.mag(),f,o.e({},kl,r||{})),R=u.pan.mult(x.amount/u.pan.mag()),T=this._map.cameraHelper.handlePanInertia(R,this._map.transform);v.center=T.easingCenter,v.offset=T.easingOffset,Ca(v,x)}if(u.zoom){let x=Eo(u.zoom,f,gd);v.zoom=this._map.transform.zoom+x.amount,Ca(v,x)}if(u.bearing){let x=Eo(u.bearing,f,Ng);v.bearing=this._map.transform.bearing+o.ah(x.amount,-179,179),Ca(v,x)}if(u.pitch){let x=Eo(u.pitch,f,Gg);v.pitch=this._map.transform.pitch+x.amount,Ca(v,x)}if(u.roll){let x=Eo(u.roll,f,Wg);v.roll=this._map.transform.roll+o.ah(x.amount,-179,179),Ca(v,x)}if(v.zoom||v.bearing){let x=u.pinchAround===void 0?u.around:u.pinchAround;v.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),o.e(v,{noMoveStart:!0})}}function Ca(w,r){(!w.duration||w.duration<r.duration)&&(w.duration=r.duration,w.easing=r.easing)}function Eo(w,r,u){let{maxSpeed:f,linearity:v,deceleration:x}=u,R=o.ah(w*v/(r/1e3),-f,f),T=Math.abs(R)/(x*v);return{easing:u.easing,duration:1e3*T,amount:R*(T/2)}}class Us extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,f,v={}){f=f instanceof MouseEvent?f:new MouseEvent(r,f);let x=S.mousePos(u.getCanvas(),f),R=u.unproject(x);super(r,o.e({point:x,lngLat:R,originalEvent:f},v)),this._defaultPrevented=!1,this.target=u}}class ba extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,f){let v=r==="touchend"?f.changedTouches:f.touches,x=S.touchPos(u.getCanvasContainer(),v),R=x.map(D=>u.unproject(D)),T=x.reduce((D,k,L,H)=>D.add(k.div(H.length)),new o.P(0,0));super(r,{points:x,point:T,lngLats:R,lngLat:u.unproject(T),originalEvent:f}),this._defaultPrevented=!1}}class fd extends o.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,u,f){super(r,{originalEvent:f}),this._defaultPrevented=!1}}class jg{constructor(r,u){this._map=r,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new fd(r.type,this._map,r))}mousedown(r,u){return this._mousedownPos=u,this._firePreventable(new Us(r.type,this._map,r))}mouseup(r){this._map.fire(new Us(r.type,this._map,r))}click(r,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new Us(r.type,this._map,r))}dblclick(r){return this._firePreventable(new Us(r.type,this._map,r))}mouseover(r){this._map.fire(new Us(r.type,this._map,r))}mouseout(r){this._map.fire(new Us(r.type,this._map,r))}touchstart(r){return this._firePreventable(new ba(r.type,this._map,r))}touchmove(r){this._map.fire(new ba(r.type,this._map,r))}touchend(r){this._map.fire(new ba(r.type,this._map,r))}touchcancel(r){this._map.fire(new ba(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class $g{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(r){this._map.fire(new Us(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Us("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._ignoreContextMenu||this._map.fire(new Us(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class xa{constructor(r){this._map=r}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(r){return this.transform.screenPointToLocation(o.P.convert(r),this._map.terrain)}}class md{constructor(r,u){this._map=r,this._tr=new xa(r),this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,u){this.isEnabled()&&r.shiftKey&&r.button===0&&(S.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(r,u){if(!this._active)return;let f=u;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;let v=this._startPos;this._lastPos=f,this._box||(this._box=S.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",r));let x=Math.min(v.x,f.x),R=Math.max(v.x,f.x),T=Math.min(v.y,f.y),D=Math.max(v.y,f.y);S.setTransform(this._box,`translate(${x}px,${T}px)`),this._box.style.width=R-x+"px",this._box.style.height=D-T+"px"}mouseupWindow(r,u){if(!this._active||r.button!==0)return;let f=this._startPos,v=u;if(this.reset(),S.suppressClick(),f.x!==v.x||f.y!==v.y)return this._map.fire(new o.l("boxzoomend",{originalEvent:r})),{cameraAnimation:x=>x.fitScreenCoordinates(f,v,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(S.remove(this._box),this._box=null),S.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,u){return this._map.fire(new o.l(r,{originalEvent:u}))}}function Kc(w,r){if(w.length!==r.length)throw new Error(`The number of touches and points are not equal - touches ${w.length}, points ${r.length}`);let u={};for(let f=0;f<w.length;f++)u[w[f].identifier]=r[f];return u}class Xc{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,u,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),f.length===this.numTouches&&(this.centroid=function(v){let x=new o.P(0,0);for(let R of v)x._add(R);return x.div(v.length)}(u),this.touches=Kc(f,u)))}touchmove(r,u,f){if(this.aborted||!this.centroid)return;let v=Kc(f,u);for(let x in this.touches){let R=v[x];(!R||R.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(r,u,f){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){let v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class Yc{constructor(r){this.singleTap=new Xc(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,u,f){this.singleTap.touchstart(r,u,f)}touchmove(r,u,f){this.singleTap.touchmove(r,u,f)}touchend(r,u,f){let v=this.singleTap.touchend(r,u,f);if(v){let x=r.timeStamp-this.lastTime<500,R=!this.lastTap||this.lastTap.dist(v)<30;if(x&&R||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class lo{constructor(r){this._tr=new xa(r),this._zoomIn=new Yc({numTouches:1,numTaps:2}),this._zoomOut=new Yc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,u,f){this._zoomIn.touchstart(r,u,f),this._zoomOut.touchstart(r,u,f)}touchmove(r,u,f){this._zoomIn.touchmove(r,u,f),this._zoomOut.touchmove(r,u,f)}touchend(r,u,f){let v=this._zoomIn.touchend(r,u,f),x=this._zoomOut.touchend(r,u,f),R=this._tr;return v?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:R.zoom+1,around:R.unproject(v)},{originalEvent:r})}):x?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:R.zoom-1,around:R.unproject(x)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Is{constructor(r){this._enabled=!!r.enable,this._moveStateManager=r.moveStateManager,this._clickTolerance=r.clickTolerance||1,this._moveFunction=r.move,this._activateOnStart=!!r.activateOnStart,r.assignEvents(this),this.reset()}reset(r){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(r)}_move(...r){let u=this._moveFunction(...r);if(u.bearingDelta||u.pitchDelta||u.rollDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(r,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(r)&&(this._moveStateManager.startMove(r),this._lastPoint=Array.isArray(u)?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(r,u){if(!this.isEnabled())return;let f=this._lastPoint;if(!f)return;if(r.preventDefault(),!this._moveStateManager.isValidMoveEvent(r))return void this.reset(r);let v=Array.isArray(u)?u[0]:u;return!this._moved&&v.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=v,this._move(f,v))}dragEnd(r){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(r)&&(this._moved&&S.suppressClick(),this.reset(r))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}let qg=0,Po=2,_a={[qg]:1,[Po]:2};class Al{constructor(r){this._correctEvent=r.checkCorrectEvent}startMove(r){let u=S.mouseButton(r);this._eventButton=u}endMove(r){delete this._eventButton}isValidStartEvent(r){return this._correctEvent(r)}isValidMoveEvent(r){return!function(u,f){let v=_a[f];return u.buttons===void 0||(u.buttons&v)!==v}(r,this._eventButton)}isValidEndEvent(r){return S.mouseButton(r)===this._eventButton}}class Jv{constructor(){this._firstTouch=void 0}_isOneFingerTouch(r){return r.targetTouches.length===1}_isSameTouchEvent(r){return r.targetTouches[0].identifier===this._firstTouch}startMove(r){this._firstTouch=r.targetTouches[0].identifier}endMove(r){delete this._firstTouch}isValidStartEvent(r){return this._isOneFingerTouch(r)}isValidMoveEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}isValidEndEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}}class ey{constructor(r=new Al({checkCorrectEvent:()=>!0}),u=new Jv){this.mouseMoveStateManager=r,this.oneFingerTouchMoveStateManager=u}_executeRelevantHandler(r,u,f){return r instanceof MouseEvent?u(r):typeof TouchEvent<"u"&&r instanceof TouchEvent?f(r):void 0}startMove(r){this._executeRelevantHandler(r,u=>this.mouseMoveStateManager.startMove(u),u=>this.oneFingerTouchMoveStateManager.startMove(u))}endMove(r){this._executeRelevantHandler(r,u=>this.mouseMoveStateManager.endMove(u),u=>this.oneFingerTouchMoveStateManager.endMove(u))}isValidStartEvent(r){return this._executeRelevantHandler(r,u=>this.mouseMoveStateManager.isValidStartEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidStartEvent(u))}isValidMoveEvent(r){return this._executeRelevantHandler(r,u=>this.mouseMoveStateManager.isValidMoveEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(u))}isValidEndEvent(r){return this._executeRelevantHandler(r,u=>this.mouseMoveStateManager.isValidEndEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidEndEvent(u))}}let Qc=w=>{w.mousedown=w.dragStart,w.mousemoveWindow=w.dragMove,w.mouseup=w.dragEnd,w.contextmenu=r=>{r.preventDefault()}};class Zg{constructor(r,u){this._clickTolerance=r.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.P(0,0)}_shouldBePrevented(r){return r<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(r,u,f){return this._calculateTransform(r,u,f)}touchmove(r,u,f){if(this._active){if(!this._shouldBePrevented(f.length))return r.preventDefault(),this._calculateTransform(r,u,f);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",r)}}touchend(r,u,f){this._calculateTransform(r,u,f),this._active&&this._shouldBePrevented(f.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,u,f){f.length>0&&(this._active=!0);let v=Kc(f,u),x=new o.P(0,0),R=new o.P(0,0),T=0;for(let k in v){let L=v[k],H=this._touches[k];H&&(x._add(L),R._add(L.sub(H)),T++,v[k]=L)}if(this._touches=v,this._shouldBePrevented(T)||!R.mag())return;let D=R.div(T);return this._sum._add(D),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(T),panDelta:D}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ir{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(r,u,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([u[0],u[1]]))}touchmove(r,u,f){if(!this._firstTwoTouches)return;r.preventDefault();let[v,x]=this._firstTwoTouches,R=co(f,u,v),T=co(f,u,x);if(!R||!T)return;let D=this._aroundCenter?null:R.add(T).div(2);return this._move([R,T],D,r)}touchend(r,u,f){if(!this._firstTwoTouches)return;let[v,x]=this._firstTwoTouches,R=co(f,u,v),T=co(f,u,x);R&&T||(this._active&&S.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function co(w,r,u){for(let f=0;f<w.length;f++)if(w[f].identifier===u)return r[f]}function rt(w,r){return Math.log(w/r)/Math.LN2}class vd extends Ir{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,u){let f=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(rt(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:rt(this._distance,f),pinchAround:u}}}function Jc(w,r){return 180*w.angleWith(r)/Math.PI}class yd extends Ir{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,u,f){let v=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Jc(this._vector,v),pinchAround:u}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());let u=25/(Math.PI*this._minDiameter)*360,f=Jc(r,this._startVector);return Math.abs(f)<u}}function kr(w){return Math.abs(w.y)>Math.abs(w.x)}class Sa extends Ir{constructor(r){super(),this._currentTouchCount=0,this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(r,u,f){super.touchstart(r,u,f),this._currentTouchCount=f.length}_start(r){this._lastPoints=r,kr(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,u,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let v=r[0].sub(this._lastPoints[0]),x=r[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(v,x,f.timeStamp),this._valid?(this._lastPoints=r,this._active=!0,{pitchDelta:(v.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(r,u,f){if(this._valid!==void 0)return this._valid;let v=r.mag()>=2,x=u.mag()>=2;if(!v&&!x)return;if(!v||!x)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;let R=r.y>0==u.y>0;return kr(r)&&kr(u)&&R}}let wd={panStep:100,bearingStep:15,pitchStep:10};class Ht{constructor(r){this._tr=new xa(r);let u=wd;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let u=0,f=0,v=0,x=0,R=0;switch(r.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:r.shiftKey?f=-1:(r.preventDefault(),x=-1);break;case 39:r.shiftKey?f=1:(r.preventDefault(),x=1);break;case 38:r.shiftKey?v=1:(r.preventDefault(),R=-1);break;case 40:r.shiftKey?v=-1:(r.preventDefault(),R=1);break;default:return}return this._rotationDisabled&&(f=0,v=0),{cameraAnimation:T=>{let D=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:Cd,zoom:u?Math.round(D.zoom)+u*(r.shiftKey?2:1):D.zoom,bearing:D.bearing+f*this._bearingStep,pitch:D.pitch+v*this._pitchStep,offset:[-x*this._panStep,-R*this._panStep],center:D.center},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Cd(w){return w*(2-w)}let Kg=4.000244140625,bd=1/450;class Xg{constructor(r,u){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=r,this._tr=new xa(r),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=bd}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(r){return!!this._map.cooperativeGestures.isEnabled()&&!(r.ctrlKey||this._map.cooperativeGestures.isBypassed(r))}wheel(r){if(!this.isEnabled())return;if(this._shouldBePrevented(r))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",r);let u=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY,f=C.now(),v=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,u!==0&&u%Kg==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(v*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),r.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=r,this._delta-=u,this._active||this._start(r)),r.preventDefault()}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let u=S.mousePos(this._map.getCanvas(),r),f=this._tr;this._aroundPoint=this._aroundCenter?f.transform.locationToScreenPoint(o.S.convert(f.center)):u,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let r=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){let T=r.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=T),typeof this._targetZoom=="number"&&(this._targetZoom+=T)}if(this._delta!==0){let T=this._type==="wheel"&&Math.abs(this._delta)>Kg?this._wheelZoomRate:this._defaultZoomRate,D=2/(1+Math.exp(-Math.abs(this._delta*T)));this._delta<0&&D!==0&&(D=1/D);let k=typeof this._targetZoom!="number"?r.scale:o.af(this._targetZoom);this._targetZoom=r.getConstrained(r.getCameraLngLat(),o.ak(k*D)).zoom,this._type==="wheel"&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let u=typeof this._targetZoom!="number"?r.zoom:this._targetZoom,f=this._startZoom,v=this._easing,x,R=!1;if(this._type==="wheel"&&f&&v){let T=C.now()-this._lastWheelEventTime,D=Math.min((T+5)/200,1),k=v(D);x=o.C.number(f,u,k),D<1?this._frameId||(this._frameId=!0):R=!0}else x=u,R=!0;return this._active=!0,R&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=x,{noInertia:!0,needsRenderFrame:!R,zoomDelta:x-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let u=o.co;if(this._prevEase){let f=this._prevEase,v=(C.now()-f.start)/f.duration,x=f.easing(v+.01)-f.easing(v),R=.27/Math.sqrt(x*x+1e-4)*.01,T=Math.sqrt(.0729-R*R);u=o.cm(R,T,.25,1)}return this._prevEase={start:C.now(),duration:r,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Yg{constructor(r,u){this._clickZoom=r,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Qg{constructor(r){this._tr=new xa(r),this.reset()}reset(){this._active=!1}dblclick(r,u){return r.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(r.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xd{constructor(){this._tap=new Yc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(r,u,f){if(!this._swipePoint)if(this._tapTime){let v=u[0],x=r.timeStamp-this._tapTime<500,R=this._tapPoint.dist(v)<30;x&&R?f.length>0&&(this._swipePoint=v,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(r,u,f)}touchmove(r,u,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;let v=u[0],x=v.y-this._swipePoint.y;return this._swipePoint=v,r.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(r,u,f)}touchend(r,u,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{let v=this._tap.touchend(r,u,f);v&&(this._tapTime=r.timeStamp,this._tapPoint=v)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _d{constructor(r,u,f){this._el=r,this._mousePan=u,this._touchPan=f}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Jg{constructor(r,u,f,v){this._pitchWithRotate=r.pitchWithRotate,this._rollEnabled=r.rollEnabled,this._mouseRotate=u,this._mousePitch=f,this._mouseRoll=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Sd{constructor(r,u,f,v){this._el=r,this._touchZoom=u,this._touchRotate=f,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ef{constructor(r,u){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=r,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let r=this._map.getCanvasContainer();r.classList.add("maplibregl-cooperative-gestures"),this._container=S.create("div","maplibregl-cooperative-gesture-screen",r);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));let f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),v=document.createElement("div");v.className="maplibregl-desktop-message",v.textContent=u,this._container.appendChild(v);let x=document.createElement("div");x.className="maplibregl-mobile-message",x.textContent=f,this._container.appendChild(x),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(S.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(r){return r[this._bypassKey]}notifyGestureBlocked(r,u){this._enabled&&(this._map.fire(new o.l("cooperativegestureprevented",{gestureType:r,originalEvent:u})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}let eh=w=>w.zoom||w.drag||w.roll||w.pitch||w.rotate;class Vn extends o.l{}function ei(w){return w.panDelta&&w.panDelta.mag()||w.zoomDelta||w.bearingDelta||w.pitchDelta||w.rollDelta}class ty{constructor(r,u){this.handleWindowEvent=v=>{this.handleEvent(v,`${v.type}Window`)},this.handleEvent=(v,x)=>{if(v.type==="blur")return void this.stop(!0);this._updatingCamera=!0;let R=v.type==="renderFrame"?void 0:v,T={needsRenderFrame:!1},D={},k={};for(let{handlerName:B,handler:W,allowed:Z}of this._handlers){if(!W.isEnabled())continue;let ee;if(this._blockedByActive(k,Z,B))W.reset();else if(W[x||v.type]){if(o.cp(v,x||v.type)){let te=S.mousePos(this._map.getCanvas(),v);ee=W[x||v.type](v,te)}else if(o.cq(v,x||v.type)){let te=this._getMapTouches(v.touches),ie=S.touchPos(this._map.getCanvas(),te);ee=W[x||v.type](v,ie,te)}else o.cr(x||v.type)||(ee=W[x||v.type](v));this.mergeHandlerResult(T,D,ee,B,R),ee&&ee.needsRenderFrame&&this._triggerRenderFrame()}(ee||W.isActive())&&(k[B]=W)}let L={};for(let B in this._previousActiveHandlers)k[B]||(L[B]=R);this._previousActiveHandlers=k,(Object.keys(L).length||ei(T))&&(this._changes.push([T,D,L]),this._triggerRenderFrame()),(Object.keys(k).length||ei(T))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:H}=T;H&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],H(this._map))},this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ug(r),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);let f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(let[v,x,R]of this._listeners)S.addEventListener(v,x,v===document?this.handleWindowEvent:this.handleEvent,R)}destroy(){for(let[r,u,f]of this._listeners)S.removeEventListener(r,u,r===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(r){let u=this._map,f=u.getCanvasContainer();this._add("mapEvent",new jg(u,r));let v=u.boxZoom=new md(u,r);this._add("boxZoom",v),r.interactive&&r.boxZoom&&v.enable();let x=u.cooperativeGestures=new ef(u,r.cooperativeGestures);this._add("cooperativeGestures",x),r.cooperativeGestures&&x.enable();let R=new lo(u),T=new Qg(u);u.doubleClickZoom=new Yg(T,R),this._add("tapZoom",R),this._add("clickZoom",T),r.interactive&&r.doubleClickZoom&&u.doubleClickZoom.enable();let D=new xd;this._add("tapDragZoom",D);let k=u.touchPitch=new Sa(u);this._add("touchPitch",k),r.interactive&&r.touchPitch&&u.touchPitch.enable(r.touchPitch);let L=()=>u.project(u.getCenter()),H=function({enable:ne,clickTolerance:ue,aroundCenter:ge=!0,minPixelCenterThreshold:re=100,rotateDegreesPerPixelMoved:we=.8},Te){let Re=new Al({checkCorrectEvent:Ee=>S.mouseButton(Ee)===0&&Ee.ctrlKey||S.mouseButton(Ee)===2&&!Ee.ctrlKey});return new Is({clickTolerance:ue,move:(Ee,De)=>{let Ke=Te();if(ge&&Math.abs(Ke.y-Ee.y)>re)return{bearingDelta:o.cn(new o.P(Ee.x,De.y),De,Ke)};let Ze=(De.x-Ee.x)*we;return ge&&De.y<Ke.y&&(Ze=-Ze),{bearingDelta:Ze}},moveStateManager:Re,enable:ne,assignEvents:Qc})}(r,L),B=function({enable:ne,clickTolerance:ue,pitchDegreesPerPixelMoved:ge=-.5}){let re=new Al({checkCorrectEvent:we=>S.mouseButton(we)===0&&we.ctrlKey||S.mouseButton(we)===2});return new Is({clickTolerance:ue,move:(we,Te)=>({pitchDelta:(Te.y-we.y)*ge}),moveStateManager:re,enable:ne,assignEvents:Qc})}(r),W=function({enable:ne,clickTolerance:ue,rollDegreesPerPixelMoved:ge=.3},re){let we=new Al({checkCorrectEvent:Te=>S.mouseButton(Te)===2&&Te.ctrlKey});return new Is({clickTolerance:ue,move:(Te,Re)=>{let Ee=re(),De=(Re.x-Te.x)*ge;return Re.y<Ee.y&&(De=-De),{rollDelta:De}},moveStateManager:we,enable:ne,assignEvents:Qc})}(r,L);u.dragRotate=new Jg(r,H,B,W),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",B,["mouseRotate","mouseRoll"]),this._add("mouseRoll",W,["mousePitch"]),r.interactive&&r.dragRotate&&u.dragRotate.enable();let Z=function({enable:ne,clickTolerance:ue}){let ge=new Al({checkCorrectEvent:re=>S.mouseButton(re)===0&&!re.ctrlKey});return new Is({clickTolerance:ue,move:(re,we)=>({around:we,panDelta:we.sub(re)}),activateOnStart:!0,moveStateManager:ge,enable:ne,assignEvents:Qc})}(r),ee=new Zg(r,u);u.dragPan=new _d(f,Z,ee),this._add("mousePan",Z),this._add("touchPan",ee,["touchZoom","touchRotate"]),r.interactive&&r.dragPan&&u.dragPan.enable(r.dragPan);let te=new yd,ie=new vd;u.touchZoomRotate=new Sd(f,ie,te,D),this._add("touchRotate",te,["touchPan","touchZoom"]),this._add("touchZoom",ie,["touchPan","touchRotate"]),r.interactive&&r.touchZoomRotate&&u.touchZoomRotate.enable(r.touchZoomRotate);let oe=u.scrollZoom=new Xg(u,()=>this._triggerRenderFrame());this._add("scrollZoom",oe,["mousePan"]),r.interactive&&r.scrollZoom&&u.scrollZoom.enable(r.scrollZoom);let le=u.keyboard=new Ht(u);this._add("keyboard",le),r.interactive&&r.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new $g(u))}_add(r,u,f){this._handlers.push({handlerName:r,handler:u,allowed:f}),this._handlersById[r]=u}stop(r){if(!this._updatingCamera){for(let{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(let{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!eh(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,u,f){for(let v in r)if(v!==f&&(!u||u.indexOf(v)<0))return!0;return!1}_getMapTouches(r){let u=[];for(let f of r)this._el.contains(f.target)&&u.push(f);return u}mergeHandlerResult(r,u,f,v,x){if(!f)return;o.e(r,f);let R={handlerName:v,originalEvent:f.originalEvent||x};f.zoomDelta!==void 0&&(u.zoom=R),f.panDelta!==void 0&&(u.drag=R),f.rollDelta!==void 0&&(u.roll=R),f.pitchDelta!==void 0&&(u.pitch=R),f.bearingDelta!==void 0&&(u.rotate=R)}_applyChanges(){let r={},u={},f={};for(let[v,x,R]of this._changes)v.panDelta&&(r.panDelta=(r.panDelta||new o.P(0,0))._add(v.panDelta)),v.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+v.pitchDelta),v.rollDelta&&(r.rollDelta=(r.rollDelta||0)+v.rollDelta),v.around!==void 0&&(r.around=v.around),v.pinchAround!==void 0&&(r.pinchAround=v.pinchAround),v.noInertia&&(r.noInertia=v.noInertia),o.e(u,x),o.e(f,R);this._updateMapTransform(r,u,f),this._changes=[]}_updateMapTransform(r,u,f){let v=this._map,x=v._getTransformForUpdate(),R=v.terrain;if(!(ei(r)||R&&this._terrainMovement))return this._fireEvents(u,f,!0);v._stop(!0);let{panDelta:T,zoomDelta:D,bearingDelta:k,pitchDelta:L,rollDelta:H,around:B,pinchAround:W}=r;W!==void 0&&(B=W),B=B||v.transform.centerPoint,R&&!x.isPointOnMapSurface(B)&&(B=x.centerPoint);let Z={panDelta:T,zoomDelta:D,rollDelta:H,pitchDelta:L,bearingDelta:k,around:B};this._map.cameraHelper.useGlobeControls&&!x.isPointOnMapSurface(B)&&(B=x.centerPoint);let ee=B.distSqr(x.centerPoint)<.01?x.center:x.screenPointToLocation(T?B.sub(T):B);R?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Z,x),this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?x.setCenter(x.screenPointToLocation(x.centerPoint.sub(T))):this._map.cameraHelper.handleMapControlsPan(Z,x,ee):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(Z,x,ee))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Z,x),this._map.cameraHelper.handleMapControlsPan(Z,x,ee)),v._applyUpdatedTransform(x),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(u,f,!0)}_fireEvents(r,u,f){let v=eh(this._eventsInProgress),x=eh(r),R={};for(let H in r){let{originalEvent:B}=r[H];this._eventsInProgress[H]||(R[`${H}start`]=B),this._eventsInProgress[H]=r[H]}!v&&x&&this._fireEvent("movestart",x.originalEvent);for(let H in R)this._fireEvent(H,R[H]);x&&this._fireEvent("move",x.originalEvent);for(let H in r){let{originalEvent:B}=r[H];this._fireEvent(H,B)}let T={},D;for(let H in this._eventsInProgress){let{handlerName:B,originalEvent:W}=this._eventsInProgress[H];this._handlersById[B].isActive()||(delete this._eventsInProgress[H],D=u[B]||W,T[`${H}end`]=D)}for(let H in T)this._fireEvent(H,T[H]);let k=eh(this._eventsInProgress),L=(v||x)&&!k;if(L&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;let H=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&H.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(H)}if(f&&L){this._updatingCamera=!0;let H=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),B=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;!H||!H.essential&&C.prefersReducedMotion?(this._map.fire(new o.l("moveend",{originalEvent:D})),B(this._map.getBearing())&&this._map.resetNorth()):(B(H.bearing||this._map.getBearing())&&(H.bearing=0),H.freezeElevation=!0,this._map.easeTo(H,{originalEvent:D})),this._updatingCamera=!1}}_fireEvent(r,u){this._map.fire(new o.l(r,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new Vn("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class th extends o.E{constructor(r,u,f){super(),this._renderFrameCallback=()=>{let v=Math.min((C.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(v)),v<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=f.bearingSnap,this.cameraHelper=u,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(r,u){r.apply(this.transform),this.transform=r,this.cameraHelper=u}getCenter(){return new o.S(this.transform.center.lng,this.transform.center.lat)}setCenter(r,u){return this.jumpTo({center:r},u)}getCenterElevation(){return this.transform.elevation}setCenterElevation(r,u){return this.jumpTo({elevation:r},u),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(r){this._centerClampedToGround=r}panBy(r,u,f){return r=o.P.convert(r).mult(-1),this.panTo(this.transform.center,o.e({offset:r},u),f)}panTo(r,u,f){return this.easeTo(o.e({center:r},u),f)}getZoom(){return this.transform.zoom}setZoom(r,u){return this.jumpTo({zoom:r},u),this}zoomTo(r,u,f){return this.easeTo(o.e({zoom:r},u),f)}zoomIn(r,u){return this.zoomTo(this.getZoom()+1,r,u),this}zoomOut(r,u){return this.zoomTo(this.getZoom()-1,r,u),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(r,u){return r!=this.transform.fov&&(this.transform.setFov(r),this.fire(new o.l("movestart",u)).fire(new o.l("move",u)).fire(new o.l("moveend",u))),this}getBearing(){return this.transform.bearing}setBearing(r,u){return this.jumpTo({bearing:r},u),this}getPadding(){return this.transform.padding}setPadding(r,u){return this.jumpTo({padding:r},u),this}rotateTo(r,u,f){return this.easeTo(o.e({bearing:r},u),f)}resetNorth(r,u){return this.rotateTo(0,o.e({duration:1e3},r),u),this}resetNorthPitch(r,u){return this.easeTo(o.e({bearing:0,pitch:0,roll:0,duration:1e3},r),u),this}snapToNorth(r,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,u):this}getPitch(){return this.transform.pitch}setPitch(r,u){return this.jumpTo({pitch:r},u),this}getRoll(){return this.transform.roll}setRoll(r,u){return this.jumpTo({roll:r},u),this}cameraForBounds(r,u){r=Ii.convert(r).adjustAntiMeridian();let f=u&&u.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),f,u)}_cameraForBoxAndBearing(r,u,f,v){let x={top:0,bottom:0,right:0,left:0};if(typeof(v=o.e({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},v)).padding=="number"){let k=v.padding;v.padding={top:k,bottom:k,right:k,left:k}}let R=o.e(x,v.padding);v.padding=R;let T=this.transform,D=new Ii(r,u);return this.cameraHelper.cameraForBoxAndBearing(v,R,D,f,T)}fitBounds(r,u,f){return this._fitInternal(this.cameraForBounds(r,u),u,f)}fitScreenCoordinates(r,u,f,v,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(o.P.convert(r)),this.transform.screenPointToLocation(o.P.convert(u)),f,v),v,x)}_fitInternal(r,u,f){return r?(delete(u=o.e(r,u)).padding,u.linear?this.easeTo(u,f):this.flyTo(u,f)):this}jumpTo(r,u){this.stop();let f=this._getTransformForUpdate(),v=!1,x=!1,R=!1,T=f.zoom;this.cameraHelper.handleJumpToCenterZoom(f,r);let D=f.zoom!==T;return"elevation"in r&&f.elevation!==+r.elevation&&f.setElevation(+r.elevation),"bearing"in r&&f.bearing!==+r.bearing&&(v=!0,f.setBearing(+r.bearing)),"pitch"in r&&f.pitch!==+r.pitch&&(x=!0,f.setPitch(+r.pitch)),"roll"in r&&f.roll!==+r.roll&&(R=!0,f.setRoll(+r.roll)),r.padding==null||f.isPaddingEqual(r.padding)||f.setPadding(r.padding),this._applyUpdatedTransform(f),this.fire(new o.l("movestart",u)).fire(new o.l("move",u)),D&&this.fire(new o.l("zoomstart",u)).fire(new o.l("zoom",u)).fire(new o.l("zoomend",u)),v&&this.fire(new o.l("rotatestart",u)).fire(new o.l("rotate",u)).fire(new o.l("rotateend",u)),x&&this.fire(new o.l("pitchstart",u)).fire(new o.l("pitch",u)).fire(new o.l("pitchend",u)),R&&this.fire(new o.l("rollstart",u)).fire(new o.l("roll",u)).fire(new o.l("rollend",u)),this.fire(new o.l("moveend",u))}calculateCameraOptionsFromTo(r,u,f,v=0){let x=o.a1.fromLngLat(r,u),R=o.a1.fromLngLat(f,v),T=R.x-x.x,D=R.y-x.y,k=R.z-x.z,L=Math.hypot(T,D,k);if(L===0)throw new Error("Can't calculate camera options with same From and To");let H=Math.hypot(T,D),B=o.ak(this.transform.cameraToCenterDistance/L/this.transform.tileSize),W=180*Math.atan2(T,-D)/Math.PI,Z=180*Math.acos(H/L)/Math.PI;return Z=k<0?90-Z:90+Z,{center:R.toLngLat(),elevation:v,zoom:B,pitch:Z,bearing:W}}calculateCameraOptionsFromCameraLngLatAltRotation(r,u,f,v,x){let R=this.transform.calculateCenterFromCameraLngLatAlt(r,u,f,v);return{center:R.center,elevation:R.elevation,zoom:R.zoom,bearing:f,pitch:v,roll:x}}easeTo(r,u){this._stop(!1,r.easeId),((r=o.e({offset:[0,0],duration:500,easing:o.co},r)).animate===!1||!r.essential&&C.prefersReducedMotion)&&(r.duration=0);let f=this._getTransformForUpdate(),v=this.getBearing(),x=f.pitch,R=f.roll,T="bearing"in r?this._normalizeBearing(r.bearing,v):v,D="pitch"in r?+r.pitch:x,k="roll"in r?this._normalizeBearing(r.roll,R):R,L="padding"in r?r.padding:f.padding,H=o.P.convert(r.offset),B,W;r.around&&(B=o.S.convert(r.around),W=f.locationToScreenPoint(B));let Z={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ee=this.cameraHelper.handleEaseTo(f,{bearing:T,pitch:D,roll:k,padding:L,around:B,aroundPoint:W,offsetAsPoint:H,offset:r.offset,zoom:r.zoom,center:r.center});return this._rotating=this._rotating||v!==T,this._pitching=this._pitching||D!==x,this._rolling=this._rolling||k!==R,this._padding=!f.isPaddingEqual(L),this._zooming=this._zooming||ee.isZooming,this._easeId=r.easeId,this._prepareEase(u,r.noMoveStart,Z),this.terrain&&this._prepareElevation(ee.elevationCenter),this._ease(te=>{ee.easeFunc(te),this.terrain&&!r.freezeElevation&&this._updateElevation(te),this._applyUpdatedTransform(f),this._fireMoveEvents(u)},te=>{this.terrain&&r.freezeElevation&&this._finalizeElevation(),this._afterEase(u,te)},r),this}_prepareEase(r,u,f={}){this._moving=!0,u||f.moving||this.fire(new o.l("movestart",r)),this._zooming&&!f.zooming&&this.fire(new o.l("zoomstart",r)),this._rotating&&!f.rotating&&this.fire(new o.l("rotatestart",r)),this._pitching&&!f.pitching&&this.fire(new o.l("pitchstart",r)),this._rolling&&!f.rolling&&this.fire(new o.l("rollstart",r))}_prepareElevation(r){this._elevationCenter=r,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(r){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));let u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(r<1&&u!==this._elevationTarget){let f=this._elevationTarget-this._elevationStart;this._elevationStart+=r*(f-(u-(f*r+this._elevationStart))/(1-r)),this._elevationTarget=u}this.transform.setElevation(o.C.number(this._elevationStart,this._elevationTarget,r))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(r){if(!this.terrain&&r.elevation>=0&&r.pitch<=90)return{};let u=r.getCameraLngLat(),f=r.getCameraAltitude(),v=this.terrain?this.terrain.getElevationForLngLatZoom(u,r.zoom):0;if(f<v){let x=this.calculateCameraOptionsFromTo(u,v,r.center,r.elevation);return{pitch:x.pitch,zoom:x.zoom}}return{}}_applyUpdatedTransform(r){let u=[];if(u.push(v=>this._elevateCameraIfInsideTerrain(v)),this.transformCameraUpdate&&u.push(v=>this.transformCameraUpdate(v)),!u.length)return;let f=r.clone();for(let v of u){let x=f.clone(),{center:R,zoom:T,roll:D,pitch:k,bearing:L,elevation:H}=v(x);R&&x.setCenter(R),H!==void 0&&x.setElevation(H),T!==void 0&&x.setZoom(T),D!==void 0&&x.setRoll(D),k!==void 0&&x.setPitch(k),L!==void 0&&x.setBearing(L),f.apply(x)}this.transform.apply(f)}_fireMoveEvents(r){this.fire(new o.l("move",r)),this._zooming&&this.fire(new o.l("zoom",r)),this._rotating&&this.fire(new o.l("rotate",r)),this._pitching&&this.fire(new o.l("pitch",r)),this._rolling&&this.fire(new o.l("roll",r))}_afterEase(r,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;let f=this._zooming,v=this._rotating,x=this._pitching,R=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,f&&this.fire(new o.l("zoomend",r)),v&&this.fire(new o.l("rotateend",r)),x&&this.fire(new o.l("pitchend",r)),R&&this.fire(new o.l("rollend",r)),this.fire(new o.l("moveend",r))}flyTo(r,u){if(!r.essential&&C.prefersReducedMotion){let De=o.Q(r,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(De,u)}this.stop(),r=o.e({offset:[0,0],speed:1.2,curve:1.42,easing:o.co},r);let f=this._getTransformForUpdate(),v=f.bearing,x=f.pitch,R=f.roll,T=f.padding,D="bearing"in r?this._normalizeBearing(r.bearing,v):v,k="pitch"in r?+r.pitch:x,L="roll"in r?this._normalizeBearing(r.roll,R):R,H="padding"in r?r.padding:f.padding,B=o.P.convert(r.offset),W=f.centerPoint.add(B),Z=f.screenPointToLocation(W),ee=this.cameraHelper.handleFlyTo(f,{bearing:D,pitch:k,roll:L,padding:H,locationAtOffset:Z,offsetAsPoint:B,center:r.center,minZoom:r.minZoom,zoom:r.zoom}),te=r.curve,ie=Math.max(f.width,f.height),oe=ie/ee.scaleOfZoom,le=ee.pixelPathLength;typeof ee.scaleOfMinZoom=="number"&&(te=Math.sqrt(ie/ee.scaleOfMinZoom/le*2));let ne=te*te;function ue(De){let Ke=(oe*oe-ie*ie+(De?-1:1)*ne*ne*le*le)/(2*(De?oe:ie)*ne*le);return Math.log(Math.sqrt(Ke*Ke+1)-Ke)}function ge(De){return(Math.exp(De)-Math.exp(-De))/2}function re(De){return(Math.exp(De)+Math.exp(-De))/2}let we=ue(!1),Te=function(De){return re(we)/re(we+te*De)},Re=function(De){return ie*((re(we)*(ge(Ke=we+te*De)/re(Ke))-ge(we))/ne)/le;var Ke},Ee=(ue(!0)-we)/te;if(Math.abs(le)<2e-6||!isFinite(Ee)){if(Math.abs(ie-oe)<1e-6)return this.easeTo(r,u);let De=oe<ie?-1:1;Ee=Math.abs(Math.log(oe/ie))/te,Re=()=>0,Te=Ke=>Math.exp(De*te*Ke)}return r.duration="duration"in r?+r.duration:1e3*Ee/("screenSpeed"in r?+r.screenSpeed/te:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=v!==D,this._pitching=k!==x,this._rolling=L!==R,this._padding=!f.isPaddingEqual(H),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(ee.targetCenter),this._ease(De=>{let Ke=De*Ee,Ze=1/Te(Ke),He=Re(Ke);this._rotating&&f.setBearing(o.C.number(v,D,De)),this._pitching&&f.setPitch(o.C.number(x,k,De)),this._rolling&&f.setRoll(o.C.number(R,L,De)),this._padding&&(f.interpolatePadding(T,H,De),W=f.centerPoint.add(B)),ee.easeFunc(De,Ze,He,W),this.terrain&&!r.freezeElevation&&this._updateElevation(De),this._applyUpdatedTransform(f),this._fireMoveEvents(u)},()=>{this.terrain&&r.freezeElevation&&this._finalizeElevation(),this._afterEase(u)},r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,u){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,u)}return r||(f=this.handlers)===null||f===void 0||f.stop(!1),this}_ease(r,u,f){f.animate===!1||f.duration===0?(r(1),u()):(this._easeStart=C.now(),this._easeOptions=f,this._onEaseFrame=r,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(r,u){r=o.aO(r,-180,180);let f=Math.abs(r-u);return Math.abs(r-360-u)<f&&(r-=360),Math.abs(r+360-u)<f&&(r+=360),r}queryTerrainElevation(r){return this.terrain?this.terrain.getElevationForLngLatZoom(o.S.convert(r),this.transform.tileZoom):null}}let ih={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Rd{constructor(r=ih){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=r}getDefaultPosition(){return"bottom-right"}onAdd(r){return this._map=r,this._compact=this.options.compact,this._container=S.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=S.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=S.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){S.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(r,u){let f=this._map._getUIString(`AttributionControl.${u}`);r.title=f,r.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(v=>typeof v!="string"?"":v)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){let v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}let u=this._map.style.sourceCaches;for(let v in u){let x=u[v];if(x.used||x.usedForTerrain){let R=x.getSource();R.attribution&&r.indexOf(R.attribution)<0&&r.push(R.attribution)}}r=r.filter(v=>String(v).trim()),r.sort((v,x)=>v.length-x.length),r=r.filter((v,x)=>{for(let R=x+1;R<r.length;R++)if(r[R].indexOf(v)>=0)return!1;return!0});let f=r.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,r.length?(this._innerContainer.innerHTML=S.sanitize(f),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Ed{constructor(r={}){this._updateCompact=()=>{let u=this._container.children;if(u.length){let f=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=r}getDefaultPosition(){return"bottom-left"}onAdd(r){this._map=r,this._compact=this.options&&this.options.compact,this._container=S.create("div","maplibregl-ctrl");let u=S.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){S.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class tf{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){let u=++this._id;return this._queue.push({callback:r,id:u,cancelled:!1}),u}remove(r){let u=this._currentlyRunning,f=u?this._queue.concat(u):this._queue;for(let v of f)if(v.id===r)return void(v.cancelled=!0)}run(r=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let u=this._currentlyRunning=this._queue;this._queue=[];for(let f of u)if(!f.cancelled&&(f.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var iy=o.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class qo extends o.E{constructor(r){super(),this._lastTilesetChange=C.now(),this.sourceCache=r,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=r._source.tileSize*2**this.deltaZoom,r.usedForTerrain=!0,r.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(r,u){this.sourceCache.update(r,u),this._renderableTilesKeys=[];let f={};for(let v of xe(r,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))f[v.key]=!0,this._renderableTilesKeys.push(v.key),this._tiles[v.key]||(v.terrainRttPosMatrix32f=new Float64Array(16),o.bY(v.terrainRttPosMatrix32f,0,o.$,o.$,0,0,1),this._tiles[v.key]=new la(v,this.tileSize),this._lastTilesetChange=C.now());for(let v in this._tiles)f[v]||delete this._tiles[v]}freeRtt(r){for(let u in this._tiles){let f=this._tiles[u];(!r||f.tileID.equals(r)||f.tileID.isChildOf(r)||r.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(r=>this.getTileByID(r))}getTileByID(r){return this._tiles[r]}getTerrainCoords(r,u){return u?this._getTerrainCoordsForTileRanges(r,u):this._getTerrainCoordsForRegularTile(r)}_getTerrainCoordsForRegularTile(r){let u={};for(let f of this._renderableTilesKeys){let v=this._tiles[f].tileID,x=r.clone(),R=o.ba();if(v.canonical.equals(r.canonical))o.bY(R,0,o.$,o.$,0,0,1);else if(v.canonical.isChildOf(r.canonical)){let T=v.canonical.z-r.canonical.z,D=v.canonical.x-(v.canonical.x>>T<<T),k=v.canonical.y-(v.canonical.y>>T<<T),L=o.$>>T;o.bY(R,0,L,L,0,0,1),o.M(R,R,[-D*L,-k*L,0])}else{if(!r.canonical.isChildOf(v.canonical))continue;{let T=r.canonical.z-v.canonical.z,D=r.canonical.x-(r.canonical.x>>T<<T),k=r.canonical.y-(r.canonical.y>>T<<T),L=o.$>>T;o.bY(R,0,o.$,o.$,0,0,1),o.M(R,R,[D*L,k*L,0]),o.N(R,R,[1/2**T,1/2**T,0])}}x.terrainRttPosMatrix32f=new Float32Array(R),u[f]=x}return u}_getTerrainCoordsForTileRanges(r,u){let f={};for(let v of this._renderableTilesKeys){let x=this._tiles[v].tileID;if(!this._isWithinTileRanges(x,u))continue;let R=r.clone(),T=o.ba();if(x.canonical.z===r.canonical.z){let D=r.canonical.x-x.canonical.x,k=r.canonical.y-x.canonical.y;o.bY(T,0,o.$,o.$,0,0,1),o.M(T,T,[D*o.$,k*o.$,0])}else if(x.canonical.z>r.canonical.z){let D=x.canonical.z-r.canonical.z,k=x.canonical.x-(x.canonical.x>>D<<D),L=x.canonical.y-(x.canonical.y>>D<<D),H=r.canonical.x-(x.canonical.x>>D),B=r.canonical.y-(x.canonical.y>>D),W=o.$>>D;o.bY(T,0,W,W,0,0,1),o.M(T,T,[-k*W+H*o.$,-L*W+B*o.$,0])}else{let D=r.canonical.z-x.canonical.z,k=r.canonical.x-(r.canonical.x>>D<<D),L=r.canonical.y-(r.canonical.y>>D<<D),H=(r.canonical.x>>D)-x.canonical.x,B=(r.canonical.y>>D)-x.canonical.y,W=o.$<<D;o.bY(T,0,W,W,0,0,1),o.M(T,T,[k*o.$+H*W,L*o.$+B*W,0])}R.terrainRttPosMatrix32f=new Float32Array(T),f[v]=R}return f}getSourceTile(r,u){let f=this.sourceCache._source,v=r.overscaledZ-this.deltaZoom;if(v>f.maxzoom&&(v=f.maxzoom),v<f.minzoom)return null;this._sourceTileCache[r.key]||(this._sourceTileCache[r.key]=r.scaledTo(v).key);let x=this.sourceCache.getTileByID(this._sourceTileCache[r.key]);if((!x||!x.dem)&&u)for(;v>=f.minzoom&&(!x||!x.dem);)x=this.sourceCache.getTileByID(r.scaledTo(v--).key);return x}anyTilesAfterTime(r=Date.now()){return this._lastTilesetChange>=r}_isWithinTileRanges(r,u){return u[r.canonical.z]&&r.canonical.x>=u[r.canonical.z].minTileX&&r.canonical.x<=u[r.canonical.z].maxTileX&&r.canonical.y>=u[r.canonical.z].minTileY&&r.canonical.y<=u[r.canonical.z].maxTileY}}class sh{constructor(r,u,f){this._meshCache={},this.painter=r,this.sourceCache=new qo(u),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(r,u,f,v=o.$){var x;if(!(u>=0&&u<v&&f>=0&&f<v))return 0;let R=this.getTerrainData(r),T=(x=R.tile)===null||x===void 0?void 0:x.dem;if(!T)return 0;let D=o.cs([],[u/v*o.$,f/v*o.$],R.u_terrain_matrix),k=[D[0]*T.dim,D[1]*T.dim],L=Math.floor(k[0]),H=Math.floor(k[1]),B=k[0]-L,W=k[1]-H;return T.get(L,H)*(1-B)*(1-W)+T.get(L+1,H)*B*(1-W)+T.get(L,H+1)*(1-B)*W+T.get(L+1,H+1)*B*W}getElevationForLngLatZoom(r,u){if(!o.ct(u,r.wrap()))return 0;let{tileID:f,mercatorX:v,mercatorY:x}=this._getOverscaledTileIDFromLngLatZoom(r,u);return this.getElevation(f,v%o.$,x%o.$,o.$)}getElevation(r,u,f,v=o.$){return this.getDEMElevation(r,u,f,v)*this.exaggeration}getTerrainData(r){if(!this._emptyDemTexture){let v=this.painter.context,x=new o.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new o.T(v,x,v.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new o.T(v,new o.R({width:1,height:1}),v.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.ag([])}let u=this.sourceCache.getSourceTile(r,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){let v=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new o.T(v,u.dem.getPixels(),v.gl.RGBA,{premultiply:!1}),u.demTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}let f=u&&u+u.tileID.key+r.key;if(f&&!this._demMatrixCache[f]){let v=this.sourceCache.sourceCache._source.maxzoom,x=r.canonical.z-u.tileID.canonical.z;r.overscaledZ>r.canonical.z&&(r.canonical.z>=v?x=r.canonical.z-v:o.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let R=r.canonical.x-(r.canonical.x>>x<<x),T=r.canonical.y-(r.canonical.y>>x<<x),D=o.cu(new Float64Array(16),[1/(o.$<<x),1/(o.$<<x),0]);o.M(D,D,[R*o.$,T*o.$,0]),this._demMatrixCache[r.key]={matrix:D,coord:r}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[r.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(r){let u=this.painter,f=u.width/devicePixelRatio,v=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===v||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new o.T(u.context,{width:f,height:v,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new o.T(u.context,{width:f,height:v,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(f,v,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,f,v))),this._fbo.colorAttachment.set(r==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let r=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,R=0;x<this._coordsTextureSize;x++)for(let T=0;T<this._coordsTextureSize;T++,R+=4)u[R+0]=255&T,u[R+1]=255&x,u[R+2]=T>>8<<4|x>>8,u[R+3]=0;let f=new o.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),v=new o.T(r,f,r.gl.RGBA,{premultiply:!1});return v.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._coordsTexture=v,v}pointCoordinate(r){this.painter.maybeDrawDepthAndCoords(!0);let u=new Uint8Array(4),f=this.painter.context,v=f.gl,x=Math.round(r.x*this.painter.pixelRatio/devicePixelRatio),R=Math.round(r.y*this.painter.pixelRatio/devicePixelRatio),T=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),v.readPixels(x,T-R-1,1,1,v.RGBA,v.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null);let D=u[0]+(u[2]>>4<<8),k=u[1]+((15&u[2])<<8),L=this.coordsIndex[255-u[3]],H=L&&this.sourceCache.getTileByID(L);if(!H)return null;let B=this._coordsTextureSize,W=(1<<H.tileID.canonical.z)*B;return new o.a1((H.tileID.canonical.x*B+D)/W+H.tileID.wrap,(H.tileID.canonical.y*B+k)/W,this.getElevation(H.tileID,D,k,B))}depthAtPoint(r){let u=new Uint8Array(4),f=this.painter.context,v=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),v.readPixels(r.x,this.painter.height/devicePixelRatio-r.y-1,1,1,v.RGBA,v.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(r){var u;let f=((u=this.painter.style.projection)===null||u===void 0?void 0:u.transitionState)>0,v=f&&r.canonical.y===0,x=f&&r.canonical.y===(1<<r.canonical.z)-1,R=`m_${v?"n":""}_${x?"s":""}`;if(this._meshCache[R])return this._meshCache[R];let T=this.painter.context,D=new o.cv,k=new o.aN,L=this.meshSize,H=o.$/L,B=L*L;for(let re=0;re<=L;re++)for(let we=0;we<=L;we++)D.emplaceBack(we*H,re*H,0);for(let re=0;re<B;re+=L+1)for(let we=0;we<L;we++)k.emplaceBack(we+re,L+we+re+1,L+we+re+2),k.emplaceBack(we+re,L+we+re+2,we+re+1);let W=D.length,Z=W+(L+1),ee=(L+1)*L,te=v?o.bh:0,ie=v?0:1,oe=x?o.bi:o.$,le=x?0:1;for(let re=0;re<=L;re++)D.emplaceBack(re*H,te,ie);for(let re=0;re<=L;re++)D.emplaceBack(re*H,oe,le);for(let re=0;re<L;re++)k.emplaceBack(ee+re,Z+re,Z+re+1),k.emplaceBack(ee+re,Z+re+1,ee+re+1),k.emplaceBack(0+re,W+re+1,W+re),k.emplaceBack(0+re,0+re+1,W+re+1);let ne=D.length,ue=ne+2*(L+1);for(let re of[0,1])for(let we=0;we<=L;we++)for(let Te of[0,1])D.emplaceBack(re*o.$,we*H,Te);for(let re=0;re<2*L;re+=2)k.emplaceBack(ne+re,ne+re+1,ne+re+3),k.emplaceBack(ne+re,ne+re+3,ne+re+2),k.emplaceBack(ue+re,ue+re+3,ue+re+1),k.emplaceBack(ue+re,ue+re+2,ue+re+3);let ge=new mr(T.createVertexBuffer(D,iy.members),T.createIndexBuffer(k),o.aM.simpleSegment(0,0,D.length,k.length));return this._meshCache[R]=ge,ge}getMeshFrameDelta(r){return 2*Math.PI*o.bu/Math.pow(2,Math.max(r,0))/5}getMinTileElevationForLngLatZoom(r,u){var f;let{tileID:v}=this._getOverscaledTileIDFromLngLatZoom(r,u);return(f=this.getMinMaxElevation(v).minElevation)!==null&&f!==void 0?f:0}getMinMaxElevation(r){let u=this.getTerrainData(r).tile,f={minElevation:null,maxElevation:null};return u&&u.dem&&(f.minElevation=u.dem.min*this.exaggeration,f.maxElevation=u.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(r,u){let f=o.a1.fromLngLat(r.wrap()),v=(1<<u)*o.$,x=f.x*v,R=f.y*v,T=Math.floor(x/o.$),D=Math.floor(R/o.$);return{tileID:new o.Z(u,0,u,T,D),mercatorX:x,mercatorY:R}}}class pt{constructor(r,u,f){this._context=r,this._size=u,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let r of this._objects)r.texture.destroy(),r.fbo.destroy()}_createObject(r){let u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new o.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(f.texture),{id:r,fbo:u,texture:f,stamp:-1,inUse:!1}}getObjectForId(r){return this._objects[r]}useObject(r){r.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(u=>r.id!==u),this._recentlyUsed.push(r.id)}stampObject(r){r.stamp=++this._stamp}getOrCreateFreeObject(){for(let u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let r=this._createObject(this._objects.length);return this._objects.push(r),r}freeObject(r){r.inUse=!1}freeAllObjects(){for(let r of this._objects)this.freeObject(r)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(r=>!r.inUse)===!1}}let mt={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class oh{constructor(r,u){this.painter=r,this.terrain=u,this.pool=new pt(r.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(r){return this.pool.getObjectForId(r.rtt[this._stacks.length-1].id).texture}prepareForRender(r,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=r._order.filter(f=>!r._layers[f].isHidden(u)),this._coordsAscending={};for(let f in r.sourceCaches){this._coordsAscending[f]={};let v=r.sourceCaches[f].getVisibleCoordinates(),x=r.sourceCaches[f].getSource(),R=x instanceof Go?x.terrainTileRanges:null;for(let T of v){let D=this.terrain.sourceCache.getTerrainCoords(T,R);for(let k in D)this._coordsAscending[f][k]||(this._coordsAscending[f][k]=[]),this._coordsAscending[f][k].push(D[k])}}this._coordsAscendingStr={};for(let f of r._order){let v=r._layers[f],x=v.source;if(mt[v.type]&&!this._coordsAscendingStr[x]){this._coordsAscendingStr[x]={};for(let R in this._coordsAscending[x])this._coordsAscendingStr[x][R]=this._coordsAscending[x][R].map(T=>T.key).sort().join()}}for(let f of this._renderableTiles)for(let v in this._coordsAscendingStr){let x=this._coordsAscendingStr[v][f.tileID.key];x&&x!==f.rttCoords[v]&&(f.rtt=[])}}renderLayer(r,u){if(r.isHidden(this.painter.transform.zoom))return!1;let f=Object.assign(Object.assign({},u),{isRenderingToTexture:!0}),v=r.type,x=this.painter,R=this._renderableLayerIds[this._renderableLayerIds.length-1]===r.id;if(mt[v]&&(this._prevType&&mt[this._prevType]||this._stacks.push([]),this._prevType=v,this._stacks[this._stacks.length-1].push(r.id),!R))return!0;if(mt[this._prevType]||mt[v]&&R){this._prevType=v;let T=this._stacks.length-1,D=this._stacks[T]||[];for(let k of this._renderableTiles){if(this.pool.isFull()&&(Js(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(k),k.rtt[T]){let H=this.pool.getObjectForId(k.rtt[T].id);if(H.stamp===k.rtt[T].stamp){this.pool.useObject(H);continue}}let L=this.pool.getOrCreateFreeObject();this.pool.useObject(L),this.pool.stampObject(L),k.rtt[T]={id:L.id,stamp:L.stamp},x.context.bindFramebuffer.set(L.fbo.framebuffer),x.context.clear({color:o.bf.transparent,stencil:0}),x.currentStencilSource=void 0;for(let H=0;H<D.length;H++){let B=x.style._layers[D[H]],W=B.source?this._coordsAscending[B.source][k.tileID.key]:[k.tileID];x.context.viewport.set([0,0,L.fbo.width,L.fbo.height]),x._renderTileClippingMasks(B,W,!0),x.renderLayer(x,x.style.sourceCaches[B.source],B,W,f),B.source&&(k.rttCoords[B.source]=this._coordsAscendingStr[B.source][k.tileID.key])}}return Js(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects(),mt[v]}return!1}}let Pd={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use \u2318 + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},nh=l,Ss={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ih,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:o.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},sf={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Mo{constructor(r,u,f=!1){this.mousedown=x=>{this.startMove(x,S.mousePos(this.element,x)),S.addEventListener(window,"mousemove",this.mousemove),S.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.move(x,S.mousePos(this.element,x))},this.mouseup=x=>{this._rotatePitchHandler.dragEnd(x),this.offTemp()},this.touchstart=x=>{x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=S.touchPos(this.element,x.targetTouches)[0],this.startMove(x,this._startPos),S.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),S.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{x.targetTouches.length!==1?this.reset():(this._lastPos=S.touchPos(this.element,x.targetTouches)[0],this.move(x,this._lastPos))},this.touchend=x=>{x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=u;let v=new ey;this._rotatePitchHandler=new Is({clickTolerance:3,move:(x,R)=>{let T=u.getBoundingClientRect(),D=new o.P((T.bottom-T.top)/2,(T.right-T.left)/2);return{bearingDelta:o.cn(new o.P(x.x,R.y),R,D),pitchDelta:f?-.5*(R.y-x.y):void 0}},moveStateManager:v,enable:!0,assignEvents:()=>{}}),this.map=r,S.addEventListener(u,"mousedown",this.mousedown),S.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),S.addEventListener(u,"touchcancel",this.reset)}startMove(r,u){this._rotatePitchHandler.dragStart(r,u),S.disableDrag()}move(r,u){let f=this.map,{bearingDelta:v,pitchDelta:x}=this._rotatePitchHandler.dragMove(r,u)||{};v&&f.setBearing(f.getBearing()+v),x&&f.setPitch(f.getPitch()+x)}off(){let r=this.element;S.removeEventListener(r,"mousedown",this.mousedown),S.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),S.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),S.removeEventListener(window,"touchend",this.touchend),S.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){S.enableDrag(),S.removeEventListener(window,"mousemove",this.mousemove),S.removeEventListener(window,"mouseup",this.mouseup),S.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),S.removeEventListener(window,"touchend",this.touchend)}}let Ar;function Ra(w,r,u,f=!1){if(f||!u.getCoveringTilesDetailsProvider().allowWorldCopies())return w?.wrap();let v=new o.S(w.lng,w.lat);if(w=new o.S(w.lng,w.lat),r){let x=new o.S(w.lng-360,w.lat),R=new o.S(w.lng+360,w.lat),T=u.locationToScreenPoint(w).distSqr(r);u.locationToScreenPoint(x).distSqr(r)<T?w=x:u.locationToScreenPoint(R).distSqr(r)<T&&(w=R)}for(;Math.abs(w.lng-u.center.lng)>180;){let x=u.locationToScreenPoint(w);if(x.x>=0&&x.y>=0&&x.x<=u.width&&x.y<=u.height)break;w.lng>u.center.lng?w.lng-=360:w.lng+=360}return w.lng!==v.lng&&u.isPointOnMapSurface(u.locationToScreenPoint(w))?w:v}let vi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Li(w,r,u){let f=w.classList;for(let v in vi)f.remove(`maplibregl-${u}-anchor-${v}`);f.add(`maplibregl-${u}-anchor-${r}`)}class rh extends o.E{constructor(r){if(super(),this._onKeyPress=u=>{let f=u.code,v=u.charCode||u.keyCode;f!=="Space"&&f!=="Enter"&&v!==32&&v!==13||this.togglePopup()},this._onMapClick=u=>{let f=u.originalEvent.target,v=this._element;this._popup&&(f===v||v.contains(f))&&this.togglePopup()},this._update=u=>{if(!this._map)return;let f=this._map.loaded()&&!this._map.isMoving();(u?.type==="terrain"||u?.type==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=Ra(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(v=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let x="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?x="rotateX(0deg)":this._pitchAlignment==="map"&&(x=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||u&&u.type!=="moveend"||(this._pos=this._pos.round()),S.setTransform(this._element,`${vi[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${x} ${v}`),C.frameAsync(new AbortController).then(()=>{this._updateOpacity(u&&u.type==="moveend")}).catch(()=>{})},this._onMove=u=>{if(!this._isDragging){let f=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.l("dragstart"))),this.fire(new o.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.l("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._subpixelPositioning=r&&r.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,this.setOpacity(r?.opacity,r?.opacityWhenCovered),r&&r.element)this._element=r.element,this._offset=o.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=S.create("div");let u=S.createNS("http://www.w3.org/2000/svg","svg"),f=41,v=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${f}px`),u.setAttributeNS(null,"width",`${v}px`),u.setAttributeNS(null,"viewBox",`0 0 ${v} ${f}`);let x=S.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");let R=S.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"fill-rule","nonzero");let T=S.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");let D=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let ie of D){let oe=S.createNS("http://www.w3.org/2000/svg","ellipse");oe.setAttributeNS(null,"opacity","0.04"),oe.setAttributeNS(null,"cx","10.5"),oe.setAttributeNS(null,"cy","5.80029008"),oe.setAttributeNS(null,"rx",ie.rx),oe.setAttributeNS(null,"ry",ie.ry),T.appendChild(oe)}let k=S.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill",this._color);let L=S.createNS("http://www.w3.org/2000/svg","path");L.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),k.appendChild(L);let H=S.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"opacity","0.25"),H.setAttributeNS(null,"fill","#000000");let B=S.createNS("http://www.w3.org/2000/svg","path");B.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),H.appendChild(B);let W=S.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"transform","translate(6.0, 7.0)"),W.setAttributeNS(null,"fill","#FFFFFF");let Z=S.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"transform","translate(8.0, 8.0)");let ee=S.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#000000"),ee.setAttributeNS(null,"opacity","0.25"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962");let te=S.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#FFFFFF"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962"),Z.appendChild(ee),Z.appendChild(te),R.appendChild(T),R.appendChild(k),R.appendChild(H),R.appendChild(W),R.appendChild(Z),u.appendChild(R),u.setAttributeNS(null,"height",f*this._scale+"px"),u.setAttributeNS(null,"width",v*this._scale+"px"),this._element.appendChild(u),this._offset=o.P.convert(r&&r.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),Li(this._element,this._anchor,"marker"),r&&r.className)for(let u of r.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(r){return this.remove(),this._map=r,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",r._getUIString("Marker.Title")),r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),r.on("terrain",this._update),r.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),S.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=o.S.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){let v=Math.abs(13.5)/Math.SQRT2;r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(r){return this._subpixelPositioning=r,this}getPopup(){return this._popup}togglePopup(){let r=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:r?(r.isOpen()?r.remove():(r.setLngLat(this._lngLat),r.addTo(this._map)),this):this}_updateOpacity(r=!1){var u,f;let v=(u=this._map)===null||u===void 0?void 0:u.terrain,x=this._map.transform.isLocationOccluded(this._lngLat);if(!v||x){let W=x?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==W&&(this._element.style.opacity=W))}if(r)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}let R=this._map,T=R.terrain.depthAtPoint(this._pos),D=R.terrain.getElevationForLngLatZoom(this._lngLat,R.transform.tileZoom);if(R.transform.lngLatToCameraDepth(this._lngLat,D)-T<.006)return void(this._element.style.opacity=this._opacity);let k=-this._offset.y/R.transform.pixelsPerMeter,L=Math.sin(R.getPitch()*Math.PI/180)*k,H=R.terrain.depthAtPoint(new o.P(this._pos.x,this._pos.y-this._offset.y)),B=R.transform.lngLatToCameraDepth(this._lngLat,D+L)-H>.006;!((f=this._popup)===null||f===void 0)&&f.isOpen()&&B&&this._popup.remove(),this._element.style.opacity=B?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(r){return this._offset=o.P.convert(r),this._update(),this}addClassName(r){this._element.classList.add(r)}removeClassName(r){this._element.classList.remove(r)}toggleClassName(r){return this._element.classList.toggle(r)}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(r,u){return(this._opacity===void 0||r===void 0&&u===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),r!==void 0&&(this._opacity=r),u!==void 0&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}let Ll={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Lr=0,Or=!1,Md={maxWidth:100,unit:"metric"};function ah(w,r,u){let f=u&&u.maxWidth||100,v=w._container.clientHeight/2,x=w._container.clientWidth/2,R=w.unproject([x-f/2,v]),T=w.unproject([x+f/2,v]),D=Math.round(w.project(T).x-w.project(R).x),k=Math.min(f,D,w._container.clientWidth),L=R.distanceTo(T);if(u&&u.unit==="imperial"){let H=3.2808*L;H>5280?hn(r,k,H/5280,w._getUIString("ScaleControl.Miles")):hn(r,k,H,w._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?hn(r,k,L/1852,w._getUIString("ScaleControl.NauticalMiles")):L>=1e3?hn(r,k,L/1e3,w._getUIString("ScaleControl.Kilometers")):hn(r,k,L,w._getUIString("ScaleControl.Meters"))}function hn(w,r,u,f){let v=function(x){let R=Math.pow(10,`${Math.floor(x)}`.length-1),T=x/R;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:function(D){let k=Math.pow(10,Math.ceil(-Math.log(D)/Math.LN10));return Math.round(D*k)/k}(T),R*T}(u);w.style.width=r*(v/u)+"px",w.innerHTML=`${v}&nbsp;${f}`}let Td={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Dd=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function lh(w){if(w){if(typeof w=="number"){let r=Math.round(Math.abs(w)/Math.SQRT2);return{center:new o.P(0,0),top:new o.P(0,w),"top-left":new o.P(r,r),"top-right":new o.P(-r,r),bottom:new o.P(0,-w),"bottom-left":new o.P(r,-r),"bottom-right":new o.P(-r,-r),left:new o.P(w,0),right:new o.P(-w,0)}}if(w instanceof o.P||Array.isArray(w)){let r=o.P.convert(w);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:o.P.convert(w.center||[0,0]),top:o.P.convert(w.top||[0,0]),"top-left":o.P.convert(w["top-left"]||[0,0]),"top-right":o.P.convert(w["top-right"]||[0,0]),bottom:o.P.convert(w.bottom||[0,0]),"bottom-left":o.P.convert(w["bottom-left"]||[0,0]),"bottom-right":o.P.convert(w["bottom-right"]||[0,0]),left:o.P.convert(w.left||[0,0]),right:o.P.convert(w.right||[0,0])}}return lh(new o.P(0,0))}let Fd=l;n.AJAXError=o.cz,n.Event=o.l,n.Evented=o.E,n.LngLat=o.S,n.MercatorCoordinate=o.a1,n.Point=o.P,n.addProtocol=o.cA,n.config=o.a,n.removeProtocol=o.cB,n.AttributionControl=Rd,n.BoxZoomHandler=md,n.CanvasSource=Rn,n.CooperativeGesturesHandler=ef,n.DoubleClickZoomHandler=Yg,n.DragPanHandler=_d,n.DragRotateHandler=Jg,n.EdgeInsets=yr,n.FullscreenControl=class extends o.E{constructor(w={}){super(),this._onFullscreenChange=()=>{var r;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((r=u?.shadowRoot)===null||r===void 0)&&r.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,w&&w.container&&(w.container instanceof HTMLElement?this._container=w.container:o.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(w){return this._map=w,this._container||(this._container=this._map.getContainer()),this._controlContainer=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){S.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let w=this._fullscreenButton=S.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);S.create("span","maplibregl-ctrl-icon",w).setAttribute("aria-hidden","true"),w.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let w=this._getTitle();this._fullscreenButton.setAttribute("aria-label",w),this._fullscreenButton.title=w}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new o.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new o.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},n.GeoJSONSource=No,n.GeolocateControl=class extends o.E{constructor(w){super(),this._onSuccess=r=>{if(this._map){if(this._isOutOfMapMaxBounds(r))return this._setErrorState(),this.fire(new o.l("outofmaxbounds",r)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=r,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(r),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(r),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new o.l("geolocate",r)),this._finish()}},this._updateCamera=r=>{let u=new o.S(r.coords.longitude,r.coords.latitude),f=r.coords.accuracy,v=this._map.getBearing(),x=o.e({bearing:v},this.options.fitBoundsOptions),R=Ii.fromLngLat(u,f);this._map.fitBounds(R,x,{geolocateSource:!0})},this._updateMarker=r=>{if(r){let u=new o.S(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=r.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=r=>{if(this._map){if(r.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(r.code===3&&Or)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new o.l("error",r)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=S.create("button","maplibregl-ctrl-geolocate",this._container),S.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=r=>{if(this._map){if(r===!1){o.w("Geolocation support is not available so the GeolocateControl will be disabled.");let u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{let u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=S.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new rh({element:this._dotElement}),this._circleElement=S.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new rh({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{let f=u?.[0]instanceof ResizeObserverEntry;u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||f||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new o.l("trackuserlocationend")),this.fire(new o.l("userlocationlostfocus")))})}},this.options=o.e({},Ll,w)}onAdd(w){return this._map=w,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return o._(this,arguments,void 0,function*(r=!1){if(Ar!==void 0&&!r)return Ar;if(window.navigator.permissions===void 0)return Ar=!!window.navigator.geolocation,Ar;try{Ar=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Ar=!!window.navigator.geolocation}return Ar})}().then(r=>this._finishSetupUI(r)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),S.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Lr=0,Or=!1}_isOutOfMapMaxBounds(w){let r=this._map.getMaxBounds(),u=w.coords;return r&&(u.longitude<r.getWest()||u.longitude>r.getEast()||u.latitude<r.getSouth()||u.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){let w=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&w))return;let r=this._map.project(w),u=this._map.unproject([r.x+100,r.y]),f=w.distanceTo(u)/100,v=2*this._accuracy/f;this._circleElement.style.width=`${v.toFixed(2)}px`,this._circleElement.style.height=`${v.toFixed(2)}px`}trigger(){if(!this._setup)return o.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Lr--,Or=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new o.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.l("trackuserlocationstart")),this.fire(new o.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let w;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Lr++,Lr>1?(w={maximumAge:6e5,timeout:0},Or=!0):(w=this.options.positionOptions,Or=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,w)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},n.GlobeControl=class{constructor(){this._toggleProjection=()=>{var w;let r=(w=this._map.getProjection())===null||w===void 0?void 0:w.type;this._map.setProjection(r!=="mercator"&&r?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var w;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((w=this._map.getProjection())===null||w===void 0?void 0:w.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(w){return this._map=w,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=S.create("button","maplibregl-ctrl-globe",this._container),S.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){S.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},n.Hash=Dr,n.ImageSource=Go,n.KeyboardHandler=Ht,n.LngLatBounds=Ii,n.LogoControl=Ed,n.Map=class extends th{constructor(w){var r,u;o.cw.mark(o.cx.create);let f=Object.assign(Object.assign(Object.assign({},Ss),w),{canvasContextAttributes:Object.assign(Object.assign({},Ss.canvasContextAttributes),w.canvasContextAttributes)});if(f.minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");let v=new oi,x=new xs;if(f.minZoom!==void 0&&v.setMinZoom(f.minZoom),f.maxZoom!==void 0&&v.setMaxZoom(f.maxZoom),f.minPitch!==void 0&&v.setMinPitch(f.minPitch),f.maxPitch!==void 0&&v.setMaxPitch(f.maxPitch),f.renderWorldCopies!==void 0&&v.setRenderWorldCopies(f.renderWorldCopies),super(v,x,{bearingSnap:f.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new tf,this._controls=[],this._mapId=o.a7(),this._contextLost=T=>{T.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new o.l("webglcontextlost",{originalEvent:T}))},this._contextRestored=T=>{this._setupPainter(),this.resize(),this._update(),this.fire(new o.l("webglcontextrestored",{originalEvent:T}))},this._onMapScroll=T=>{if(T.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=f.interactive,this._maxTileCacheSize=f.maxTileCacheSize,this._maxTileCacheZoomLevels=f.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},f.canvasContextAttributes),this._trackResize=f.trackResize===!0,this._bearingSnap=f.bearingSnap,this._centerClampedToGround=f.centerClampedToGround,this._refreshExpiredTiles=f.refreshExpiredTiles===!0,this._fadeDuration=f.fadeDuration,this._crossSourceCollisions=f.crossSourceCollisions===!0,this._collectResourceTiming=f.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Pd),f.locale),this._clickTolerance=f.clickTolerance,this._overridePixelRatio=f.pixelRatio,this._maxCanvasSize=f.maxCanvasSize,this.transformCameraUpdate=f.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=f.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Q.addThrottleControl(()=>this.isMoving()),this._requestManager=new ae(f.transformRequest),typeof f.container=="string"){if(this._container=document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(f.maxBounds&&this.setMaxBounds(f.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let T=!1,D=pd(k=>{this._trackResize&&!this._removed&&(this.resize(k),this.redraw())},50);this._resizeObserver=new ResizeObserver(k=>{T?D(k):T=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ty(this,f),this._hash=f.hash&&new Dr(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,elevation:f.elevation,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,roll:f.roll}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,o.e({},f.fitBoundsOptions,{duration:0}))));let R=typeof f.style=="string"||((u=(r=f.style)===null||r===void 0?void 0:r.projection)===null||u===void 0?void 0:u.type)!=="globe";this.resize(null,R),this._localIdeographFontFamily=f.localIdeographFontFamily,this._validateStyle=f.validateStyle,f.style&&this.setStyle(f.style,{localIdeographFontFamily:f.localIdeographFontFamily}),f.attributionControl&&this.addControl(new Rd(typeof f.attributionControl=="boolean"?void 0:f.attributionControl)),f.maplibreLogo&&this.addControl(new Ed,f.logoPosition),this.on("style.load",()=>{if(R||this._resizeTransform(),this.transform.unmodified){let T=o.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(T)}}),this.on("data",T=>{this._update(T.dataType==="style"),this.fire(new o.l(`${T.dataType}data`,T))}),this.on("dataloading",T=>{this.fire(new o.l(`${T.dataType}dataloading`,T))}),this.on("dataabort",T=>{this.fire(new o.l("sourcedataabort",T))})}_getMapId(){return this._mapId}setGlobalStateProperty(w,r){return this.style.setGlobalStateProperty(w,r),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(w,r){if(r===void 0&&(r=w.getDefaultPosition?w.getDefaultPosition():"top-right"),!w||!w.onAdd)return this.fire(new o.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let u=w.onAdd(this);this._controls.push(w);let f=this._controlPositions[r];return r.indexOf("bottom")!==-1?f.insertBefore(u,f.firstChild):f.appendChild(u),this}removeControl(w){if(!w||!w.onRemove)return this.fire(new o.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let r=this._controls.indexOf(w);return r>-1&&this._controls.splice(r,1),w.onRemove(this),this}hasControl(w){return this._controls.indexOf(w)>-1}coveringTiles(w){return xe(this.transform,w)}calculateCameraOptionsFromTo(w,r,u,f){return f==null&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(w,r,u,f)}resize(w,r=!0){let[u,f]=this._containerDimensions(),v=this._getClampedPixelRatio(u,f);if(this._resizeCanvas(u,f,v),this.painter.resize(u,f,v),this.painter.overLimit()){let R=this.painter.context.gl;this._maxCanvasSize=[R.drawingBufferWidth,R.drawingBufferHeight];let T=this._getClampedPixelRatio(u,f);this._resizeCanvas(u,f,T),this.painter.resize(u,f,T)}this._resizeTransform(r);let x=!this._moving;return x&&(this.stop(),this.fire(new o.l("movestart",w)).fire(new o.l("move",w))),this.fire(new o.l("resize",w)),x&&this.fire(new o.l("moveend",w)),this}_resizeTransform(w=!0){var r;let[u,f]=this._containerDimensions();this.transform.resize(u,f,w),(r=this._requestedCameraState)===null||r===void 0||r.resize(u,f,w)}_getClampedPixelRatio(w,r){let{0:u,1:f}=this._maxCanvasSize,v=this.getPixelRatio(),x=w*v,R=r*v;return Math.min(x>u?u/x:1,R>f?f/R:1)*v}getPixelRatio(){var w;return(w=this._overridePixelRatio)!==null&&w!==void 0?w:devicePixelRatio}setPixelRatio(w){this._overridePixelRatio=w,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(w){return this.transform.setMaxBounds(Ii.convert(w)),this._update()}setMinZoom(w){if((w=w??-2)>=-2&&w<=this.transform.maxZoom)return this.transform.setMinZoom(w),this._update(),this.getZoom()<w&&this.setZoom(w),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(w){if((w=w??22)>=this.transform.minZoom)return this.transform.setMaxZoom(w),this._update(),this.getZoom()>w&&this.setZoom(w),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(w){if((w=w??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(w>=0&&w<=this.transform.maxPitch)return this.transform.setMinPitch(w),this._update(),this.getPitch()<w&&this.setPitch(w),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(w){if((w=w??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(w>=this.transform.minPitch)return this.transform.setMaxPitch(w),this._update(),this.getPitch()>w&&this.setPitch(w),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(w){return this.transform.setRenderWorldCopies(w),this._update()}project(w){return this.transform.locationToScreenPoint(o.S.convert(w),this.style&&this.terrain)}unproject(w){return this.transform.screenPointToLocation(o.P.convert(w),this.terrain)}isMoving(){var w;return this._moving||((w=this.handlers)===null||w===void 0?void 0:w.isMoving())}isZooming(){var w;return this._zooming||((w=this.handlers)===null||w===void 0?void 0:w.isZooming())}isRotating(){var w;return this._rotating||((w=this.handlers)===null||w===void 0?void 0:w.isRotating())}_createDelegatedListener(w,r,u){if(w==="mouseenter"||w==="mouseover"){let f=!1;return{layers:r,listener:u,delegates:{mousemove:x=>{let R=r.filter(D=>this.getLayer(D)),T=R.length!==0?this.queryRenderedFeatures(x.point,{layers:R}):[];T.length?f||(f=!0,u.call(this,new Us(w,this,x.originalEvent,{features:T}))):f=!1},mouseout:()=>{f=!1}}}}if(w==="mouseleave"||w==="mouseout"){let f=!1;return{layers:r,listener:u,delegates:{mousemove:R=>{let T=r.filter(D=>this.getLayer(D));(T.length!==0?this.queryRenderedFeatures(R.point,{layers:T}):[]).length?f=!0:f&&(f=!1,u.call(this,new Us(w,this,R.originalEvent)))},mouseout:R=>{f&&(f=!1,u.call(this,new Us(w,this,R.originalEvent)))}}}}{let f=v=>{let x=r.filter(T=>this.getLayer(T)),R=x.length!==0?this.queryRenderedFeatures(v.point,{layers:x}):[];R.length&&(v.features=R,u.call(this,v),delete v.features)};return{layers:r,listener:u,delegates:{[w]:f}}}}_saveDelegatedListener(w,r){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[w]=this._delegatedListeners[w]||[],this._delegatedListeners[w].push(r)}_removeDelegatedListener(w,r,u){if(!this._delegatedListeners||!this._delegatedListeners[w])return;let f=this._delegatedListeners[w];for(let v=0;v<f.length;v++){let x=f[v];if(x.listener===u&&x.layers.length===r.length&&x.layers.every(R=>r.includes(R))){for(let R in x.delegates)this.off(R,x.delegates[R]);return void f.splice(v,1)}}}on(w,r,u){if(u===void 0)return super.on(w,r);let f=typeof r=="string"?[r]:r,v=this._createDelegatedListener(w,f,u);this._saveDelegatedListener(w,v);for(let x in v.delegates)this.on(x,v.delegates[x]);return{unsubscribe:()=>{this._removeDelegatedListener(w,f,u)}}}once(w,r,u){if(u===void 0)return super.once(w,r);let f=typeof r=="string"?[r]:r,v=this._createDelegatedListener(w,f,u);for(let x in v.delegates){let R=v.delegates[x];v.delegates[x]=(...T)=>{this._removeDelegatedListener(w,f,u),R(...T)}}this._saveDelegatedListener(w,v);for(let x in v.delegates)this.once(x,v.delegates[x]);return this}off(w,r,u){return u===void 0?super.off(w,r):(this._removeDelegatedListener(w,typeof r=="string"?[r]:r,u),this)}queryRenderedFeatures(w,r){if(!this.style)return[];let u,f=w instanceof o.P||Array.isArray(w),v=f?w:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(f?{}:w)||{},v instanceof o.P||typeof v[0]=="number")u=[o.P.convert(v)];else{let x=o.P.convert(v[0]),R=o.P.convert(v[1]);u=[x,new o.P(R.x,x.y),R,new o.P(x.x,R.y),x]}return this.style.queryRenderedFeatures(u,r,this.transform)}querySourceFeatures(w,r){return this.style.querySourceFeatures(w,r)}setStyle(w,r){return(r=o.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&w?(this._diffStyle(w,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(w,r))}setTransformRequest(w){return this._requestManager.setTransformRequest(w),this}_getUIString(w){let r=this._locale[w];if(r==null)throw new Error(`Missing UI string '${w}'`);return r}_updateStyle(w,r){var u,f;if(r.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(w,r));let v=this.style&&r.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!w)),w?(this.style=new Uu(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof w=="string"?this.style.loadURL(w,r,v):this.style.loadJSON(w,r,v),this):((f=(u=this.style)===null||u===void 0?void 0:u.projection)===null||f===void 0||f.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Uu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(w,r){if(typeof w=="string"){let u=this._requestManager.transformRequest(w,"Style");o.j(u,new AbortController).then(f=>{this._updateDiff(f.data,r)}).catch(f=>{f&&this.fire(new o.k(f))})}else typeof w=="object"&&this._updateDiff(w,r)}_updateDiff(w,r){try{this.style.setState(w,r)&&this._update(!0)}catch(u){o.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(w,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.w("There is no style added to the map.")}addSource(w,r){return this._lazyInitEmptyStyle(),this.style.addSource(w,r),this._update(!0)}isSourceLoaded(w){let r=this.style&&this.style.sourceCaches[w];if(r!==void 0)return r.loaded();this.fire(new o.k(new Error(`There is no source with ID '${w}'`)))}setTerrain(w){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),w){let r=this.style.sourceCaches[w.source];if(!r)throw new Error(`cannot load terrain, because there exists no source with ID: ${w.source}`);this.terrain===null&&r.reload();for(let u in this.style._layers){let f=this.style._layers[u];f.type==="hillshade"&&f.source===w.source&&o.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),f.type==="color-relief"&&f.source===w.source&&o.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new sh(this.painter,r,w),this.painter.renderToTexture=new oh(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=u=>{var f;u.dataType==="style"?this.terrain.sourceCache.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==w.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((f=u.source)===null||f===void 0?void 0:f.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new o.l("terrain",{terrain:w})),this}getTerrain(){var w,r;return(r=(w=this.terrain)===null||w===void 0?void 0:w.options)!==null&&r!==void 0?r:null}areTilesLoaded(){let w=this.style&&this.style.sourceCaches;for(let r in w){let u=w[r]._tiles;for(let f in u){let v=u[f];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}removeSource(w){return this.style.removeSource(w),this._update(!0)}getSource(w){return this.style.getSource(w)}setSourceTileLodParams(w,r,u){if(u){let f=this.getSource(u);if(!f)throw new Error(`There is no source with ID "${u}", cannot set LOD parameters`);f.calculateTileZoom=Ue(Math.max(1,w),Math.max(1,r))}else for(let f in this.style.sourceCaches)this.style.sourceCaches[f].getSource().calculateTileZoom=Ue(Math.max(1,w),Math.max(1,r));return this._update(!0),this}refreshTiles(w,r){let u=this.style.sourceCaches[w];if(!u)throw new Error(`There is no source cache with ID "${w}", cannot refresh tile`);r===void 0?u.reload(!0):u.refreshTiles(r.map(f=>new o.a4(f.z,f.x,f.y)))}addImage(w,r,u={}){let{pixelRatio:f=1,sdf:v=!1,stretchX:x,stretchY:R,content:T,textFitWidth:D,textFitHeight:k}=u;if(this._lazyInitEmptyStyle(),!(r instanceof HTMLImageElement||o.b(r))){if(r.width===void 0||r.height===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:L,height:H,data:B}=r,W=r;return this.style.addImage(w,{data:new o.R({width:L,height:H},new Uint8Array(B)),pixelRatio:f,stretchX:x,stretchY:R,content:T,textFitWidth:D,textFitHeight:k,sdf:v,version:0,userImage:W}),W.onAdd&&W.onAdd(this,w),this}}{let{width:L,height:H,data:B}=C.getImageData(r);this.style.addImage(w,{data:new o.R({width:L,height:H},B),pixelRatio:f,stretchX:x,stretchY:R,content:T,textFitWidth:D,textFitHeight:k,sdf:v,version:0})}}updateImage(w,r){let u=this.style.getImage(w);if(!u)return this.fire(new o.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let f=r instanceof HTMLImageElement||o.b(r)?C.getImageData(r):r,{width:v,height:x,data:R}=f;if(v===void 0||x===void 0)return this.fire(new o.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==u.data.width||x!==u.data.height)return this.fire(new o.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));let T=!(r instanceof HTMLImageElement||o.b(r));return u.data.replace(R,T),this.style.updateImage(w,u),this}getImage(w){return this.style.getImage(w)}hasImage(w){return w?!!this.style.getImage(w):(this.fire(new o.k(new Error("Missing required image id"))),!1)}removeImage(w){this.style.removeImage(w)}loadImage(w){return Q.getImage(this._requestManager.transformRequest(w,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(w,r){return this._lazyInitEmptyStyle(),this.style.addLayer(w,r),this._update(!0)}moveLayer(w,r){return this.style.moveLayer(w,r),this._update(!0)}removeLayer(w){return this.style.removeLayer(w),this._update(!0)}getLayer(w){return this.style.getLayer(w)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(w,r,u){return this.style.setLayerZoomRange(w,r,u),this._update(!0)}setFilter(w,r,u={}){return this.style.setFilter(w,r,u),this._update(!0)}getFilter(w){return this.style.getFilter(w)}setPaintProperty(w,r,u,f={}){return this.style.setPaintProperty(w,r,u,f),this._update(!0)}getPaintProperty(w,r){return this.style.getPaintProperty(w,r)}setLayoutProperty(w,r,u,f={}){return this.style.setLayoutProperty(w,r,u,f),this._update(!0)}getLayoutProperty(w,r){return this.style.getLayoutProperty(w,r)}setGlyphs(w,r={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(w,r),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(w,r,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(w,r,u,f=>{f||this._update(!0)}),this}removeSprite(w){return this._lazyInitEmptyStyle(),this.style.removeSprite(w),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(w,r={}){return this._lazyInitEmptyStyle(),this.style.setSprite(w,r,u=>{u||this._update(!0)}),this}setLight(w,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(w,r),this._update(!0)}getLight(){return this.style.getLight()}setSky(w,r={}){return this._lazyInitEmptyStyle(),this.style.setSky(w,r),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(w,r){return this.style.setFeatureState(w,r),this._update()}removeFeatureState(w,r){return this.style.removeFeatureState(w,r),this._update()}getFeatureState(w){return this.style.getFeatureState(w)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let w=0,r=0;return this._container&&(w=this._container.clientWidth||400,r=this._container.clientHeight||300),[w,r]}_setupContainer(){let w=this._container;w.classList.add("maplibregl-map");let r=this._canvasContainer=S.create("div","maplibregl-canvas-container",w);this._interactive&&r.classList.add("maplibregl-interactive"),this._canvas=S.create("canvas","maplibregl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");let u=this._containerDimensions(),f=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],f);let v=this._controlContainer=S.create("div","maplibregl-control-container",w),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(R=>{x[R]=S.create("div",`maplibregl-ctrl-${R} `,v)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(w,r,u){this._canvas.width=Math.floor(u*w),this._canvas.height=Math.floor(u*r),this._canvas.style.width=`${w}px`,this._canvas.style.height=`${r}px`}_setupPainter(){let w=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0}),r=null;this._canvas.addEventListener("webglcontextcreationerror",f=>{r={requestedAttributes:w},f&&(r.statusMessage=f.statusMessage,r.type=f.type)},{once:!0});let u=null;if(u=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,w):this._canvas.getContext("webgl2",w)||this._canvas.getContext("webgl",w),!u){let f="Failed to initialize WebGL";throw r?(r.message=f,new Error(JSON.stringify(r))):new Error(f)}this.painter=new Zc(u,this.transform),P.testSupport(u)}migrateProjection(w,r){super.migrateProjection(w,r),this.painter.transform=w,this.fire(new o.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(w){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||w,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(w){return this._update(),this._renderTaskQueue.add(w)}_cancelRenderFrame(w){this._renderTaskQueue.remove(w)}_render(w){var r,u,f,v,x;let R=this._idleTriggered?this._fadeDuration:0,T=((r=this.style.projection)===null||r===void 0?void 0:r.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(w),this._removed)return;let D=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let H=this.transform.zoom,B=C.now();this.style.zoomHistory.update(H,B);let W=new o.F(H,{now:B,fadeDuration:R,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Z=W.crossFadingFactor();Z===1&&Z===this._crossFadingFactor||(D=!0,this._crossFadingFactor=Z),this.style.update(W)}let k=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0!==T;(f=this.style.projection)===null||f===void 0||f.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((v=this.style.projection)===null||v===void 0?void 0:v.transitionState,(x=this.style.projection)===null||x===void 0?void 0:x.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||k)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,R,this._crossSourceCollisions,k),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:R,showPadding:this.showPadding}),this.fire(new o.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.cw.mark(o.cx.load),this.fire(new o.l("load"))),this.style&&(this.style.hasTransitions()||D)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let L=this._sourcesDirty||this._styleDirty||this._placementDirty;return L||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.l("idle")),!this._loaded||this._fullyLoaded||L||(this._fullyLoaded=!0,o.cw.mark(o.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var w;this._hash&&this._hash.remove();for(let u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Q.removeThrottleControl(this._imageQueueHandle),(w=this._resizeObserver)===null||w===void 0||w.disconnect();let r=this.painter.context.gl.getExtension("WEBGL_lose_context");r?.loseContext&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),S.remove(this._canvasContainer),S.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),o.cw.clearMetrics(),this._removed=!0,this.fire(new o.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,C.frame(this._frameRequest,w=>{o.cw.frame(w),this._frameRequest=null;try{this._render(w)}catch(r){if(!o.cy(r)&&!function(u){return u.message===Rl}(r))throw r}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(w){this._showTileBoundaries!==w&&(this._showTileBoundaries=w,this._update())}get showPadding(){return!!this._showPadding}set showPadding(w){this._showPadding!==w&&(this._showPadding=w,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(w){this._showCollisionBoxes!==w&&(this._showCollisionBoxes=w,w?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(w){this._showOverdrawInspector!==w&&(this._showOverdrawInspector=w,this._update())}get repaint(){return!!this._repaint}set repaint(w){this._repaint!==w&&(this._repaint=w,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(w){this._vertices=w,this._update()}get version(){return nh}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(w){return this._lazyInitEmptyStyle(),this.style.setProjection(w),this._update(!0)}},n.MapMouseEvent=Us,n.MapTouchEvent=ba,n.MapWheelEvent=fd,n.Marker=rh,n.NavigationControl=class{constructor(w){this._updateZoomButtons=()=>{let r=this._map.getZoom(),u=r===this._map.getMaxZoom(),f=r===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(r,u)=>{let f=this._map._getUIString(`NavigationControl.${u}`);r.title=f,r.setAttribute("aria-label",f)},this.options=o.e({},sf,w),this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),S.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),S.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=S.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(w){return this._map=w,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Mo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){S.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(w,r){let u=S.create("button",w,this._container);return u.type="button",u.addEventListener("click",r),u}},n.Popup=class extends o.E{constructor(w){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&S.remove(this._content),this._container&&(S.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new o.l("close"))),this),this._onMouseUp=r=>{this._update(r.point)},this._onMouseMove=r=>{this._update(r.point)},this._onDrag=r=>{this._update(r.point)},this._update=r=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=S.create("div","maplibregl-popup",this._map.getContainer()),this._tip=S.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let R of this.options.className.split(" "))this._container.classList.add(R);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Ra(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!r)return;let u=this._flatPos=this._pos=this._trackPointer&&r?r:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&r?r:this._map.transform.locationToScreenPoint(this._lngLat));let f=this.options.anchor,v=lh(this.options.offset);if(!f){let R=this._container.offsetWidth,T=this._container.offsetHeight,D;D=u.y+v.bottom.y<T?["top"]:u.y>this._map.transform.height-T?["bottom"]:[],u.x<R/2?D.push("left"):u.x>this._map.transform.width-R/2&&D.push("right"),f=D.length===0?"bottom":D.join("-")}let x=u.add(v[f]);this.options.subpixelPositioning||(x=x.round()),S.setTransform(this._container,`${vi[f]} translate(${x.x}px,${x.y}px)`),Li(this._container,f,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=o.e(Object.create(Td),w)}addTo(w){return this._map&&this.remove(),this._map=w,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new o.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(w){return this._lngLat=o.S.convert(w),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(w){return this.setDOMContent(document.createTextNode(w))}setHTML(w){let r=document.createDocumentFragment(),u=document.createElement("body"),f;for(u.innerHTML=w;f=u.firstChild,f;)r.appendChild(f);return this.setDOMContent(r)}getMaxWidth(){var w;return(w=this._container)===null||w===void 0?void 0:w.style.maxWidth}setMaxWidth(w){return this.options.maxWidth=w,this._update(),this}setDOMContent(w){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=S.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(w),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(w){return this._container&&this._container.classList.add(w),this}removeClassName(w){return this._container&&this._container.classList.remove(w),this}setOffset(w){return this.options.offset=w,this._update(),this}toggleClassName(w){if(this._container)return this._container.classList.toggle(w)}setSubpixelPositioning(w){this.options.subpixelPositioning=w}_createCloseButton(){this.options.closeButton&&(this._closeButton=S.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let w=this._container.querySelector(Dd);w&&w.focus()}},n.RasterDEMTileSource=pr,n.RasterTileSource=Ho,n.ScaleControl=class{constructor(w){this._onMove=()=>{ah(this._map,this._container,this.options)},this.setUnit=r=>{this.options.unit=r,ah(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Md),w)}getDefaultPosition(){return"bottom-left"}onAdd(w){return this._map=w,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-scale",w.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){S.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},n.ScrollZoomHandler=Xg,n.Style=Uu,n.TerrainControl=class{constructor(w){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=w}onAdd(w){return this._map=w,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=S.create("button","maplibregl-ctrl-terrain",this._container),S.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){S.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},n.TwoFingersTouchPitchHandler=Sa,n.TwoFingersTouchRotateHandler=yd,n.TwoFingersTouchZoomHandler=vd,n.TwoFingersTouchZoomRotateHandler=Sd,n.VectorTileSource=xo,n.VideoSource=aa,n.addSourceType=(w,r)=>o._(void 0,void 0,void 0,function*(){if(Pn(w))throw new Error(`A source type called "${w}" already exists.`);((u,f)=>{En[u]=f})(w,r)}),n.clearPrewarmedResources=function(){let w=Bi;w&&(w.isPreloaded()&&w.numActive()===1?(w.release(Fi),Bi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},n.createTileMesh=Gu,n.getMaxParallelImageRequests=function(){return o.a.MAX_PARALLEL_IMAGE_REQUESTS},n.getRTLTextPluginStatus=function(){return Dn().getRTLTextPluginStatus()},n.getVersion=function(){return Fd},n.getWorkerCount=function(){return jt.workerCount},n.getWorkerUrl=function(){return o.a.WORKER_URL},n.importScriptInWorkers=function(w){return ro().broadcast("IS",w)},n.prewarm=function(){ji().acquire(Fi)},n.setMaxParallelImageRequests=function(w){o.a.MAX_PARALLEL_IMAGE_REQUESTS=w},n.setRTLTextPlugin=function(w,r){return Dn().setRTLTextPlugin(w,r)},n.setWorkerCount=function(w){jt.workerCount=w},n.setWorkerUrl=function(w){o.a.WORKER_URL=w}});var s=e;return s})});function op(e){return e+.5|0}var Aa=(e,t,i)=>Math.max(Math.min(e,i),t);function ip(e){return Aa(op(e*2.55),0,255)}function La(e){return Aa(op(e*255),0,255)}function Nr(e){return Aa(op(e/2.55)/100,0,1)}function L_(e){return Aa(op(e*100),0,100)}var Ko={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},t0=[..."0123456789ABCDEF"],cF=e=>t0[e&15],hF=e=>t0[(e&240)>>4]+t0[e&15],Pf=e=>(e&240)>>4===(e&15),uF=e=>Pf(e.r)&&Pf(e.g)&&Pf(e.b)&&Pf(e.a);function dF(e){var t=e.length,i;return e[0]==="#"&&(t===4||t===5?i={r:255&Ko[e[1]]*17,g:255&Ko[e[2]]*17,b:255&Ko[e[3]]*17,a:t===5?Ko[e[4]]*17:255}:(t===7||t===9)&&(i={r:Ko[e[1]]<<4|Ko[e[2]],g:Ko[e[3]]<<4|Ko[e[4]],b:Ko[e[5]]<<4|Ko[e[6]],a:t===9?Ko[e[7]]<<4|Ko[e[8]]:255})),i}var pF=(e,t)=>e<255?t(e):"";function gF(e){var t=uF(e)?cF:hF;return e?"#"+t(e.r)+t(e.g)+t(e.b)+pF(e.a,t):void 0}var fF=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function V_(e,t,i){let s=t*Math.min(i,1-i),n=(o,l=(o+e/30)%12)=>i-s*Math.max(Math.min(l-3,9-l,1),-1);return[n(0),n(8),n(4)]}function mF(e,t,i){let s=(n,o=(n+e/60)%6)=>i-i*t*Math.max(Math.min(o,4-o,1),0);return[s(5),s(3),s(1)]}function vF(e,t,i){let s=V_(e,1,.5),n;for(t+i>1&&(n=1/(t+i),t*=n,i*=n),n=0;n<3;n++)s[n]*=1-t-i,s[n]+=t;return s}function yF(e,t,i,s,n){return e===n?(t-i)/s+(t<i?6:0):t===n?(i-e)/s+2:(e-t)/s+4}function i0(e){let i=e.r/255,s=e.g/255,n=e.b/255,o=Math.max(i,s,n),l=Math.min(i,s,n),d=(o+l)/2,p,y,C;return o!==l&&(C=o-l,y=d>.5?C/(2-o-l):C/(o+l),p=yF(i,s,n,C,o),p=p*60+.5),[p|0,y||0,d]}function s0(e,t,i,s){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,i,s)).map(La)}function o0(e,t,i){return s0(V_,e,t,i)}function wF(e,t,i){return s0(vF,e,t,i)}function CF(e,t,i){return s0(mF,e,t,i)}function H_(e){return(e%360+360)%360}function bF(e){let t=fF.exec(e),i=255,s;if(!t)return;t[5]!==s&&(i=t[6]?ip(+t[5]):La(+t[5]));let n=H_(+t[2]),o=+t[3]/100,l=+t[4]/100;return t[1]==="hwb"?s=wF(n,o,l):t[1]==="hsv"?s=CF(n,o,l):s=o0(n,o,l),{r:s[0],g:s[1],b:s[2],a:i}}function xF(e,t){var i=i0(e);i[0]=H_(i[0]+t),i=o0(i),e.r=i[0],e.g=i[1],e.b=i[2]}function _F(e){if(!e)return;let t=i0(e),i=t[0],s=L_(t[1]),n=L_(t[2]);return e.a<255?`hsla(${i}, ${s}%, ${n}%, ${Nr(e.a)})`:`hsl(${i}, ${s}%, ${n}%)`}var O_={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},z_={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function SF(){let e={},t=Object.keys(z_),i=Object.keys(O_),s,n,o,l,d;for(s=0;s<t.length;s++){for(l=d=t[s],n=0;n<i.length;n++)o=i[n],d=d.replace(o,O_[o]);o=parseInt(z_[l],16),e[d]=[o>>16&255,o>>8&255,o&255]}return e}var Mf;function RF(e){Mf||(Mf=SF(),Mf.transparent=[0,0,0,0]);let t=Mf[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}var EF=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function PF(e){let t=EF.exec(e),i=255,s,n,o;if(t){if(t[7]!==s){let l=+t[7];i=t[8]?ip(l):Aa(l*255,0,255)}return s=+t[1],n=+t[3],o=+t[5],s=255&(t[2]?ip(s):Aa(s,0,255)),n=255&(t[4]?ip(n):Aa(n,0,255)),o=255&(t[6]?ip(o):Aa(o,0,255)),{r:s,g:n,b:o,a:i}}}function MF(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${Nr(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}var e0=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,Oh=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function TF(e,t,i){let s=Oh(Nr(e.r)),n=Oh(Nr(e.g)),o=Oh(Nr(e.b));return{r:La(e0(s+i*(Oh(Nr(t.r))-s))),g:La(e0(n+i*(Oh(Nr(t.g))-n))),b:La(e0(o+i*(Oh(Nr(t.b))-o))),a:e.a+i*(t.a-e.a)}}function Tf(e,t,i){if(e){let s=i0(e);s[t]=Math.max(0,Math.min(s[t]+s[t]*i,t===0?360:1)),s=o0(s),e.r=s[0],e.g=s[1],e.b=s[2]}}function N_(e,t){return e&&Object.assign(t||{},e)}function B_(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=La(e[3]))):(t=N_(e,{r:0,g:0,b:0,a:1}),t.a=La(t.a)),t}function DF(e){return e.charAt(0)==="r"?PF(e):bF(e)}var sp=class e{constructor(t){if(t instanceof e)return t;let i=typeof t,s;i==="object"?s=B_(t):i==="string"&&(s=dF(t)||RF(t)||DF(t)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var t=N_(this._rgb);return t&&(t.a=Nr(t.a)),t}set rgb(t){this._rgb=B_(t)}rgbString(){return this._valid?MF(this._rgb):void 0}hexString(){return this._valid?gF(this._rgb):void 0}hslString(){return this._valid?_F(this._rgb):void 0}mix(t,i){if(t){let s=this.rgb,n=t.rgb,o,l=i===o?.5:i,d=2*l-1,p=s.a-n.a,y=((d*p===-1?d:(d+p)/(1+d*p))+1)/2;o=1-y,s.r=255&y*s.r+o*n.r+.5,s.g=255&y*s.g+o*n.g+.5,s.b=255&y*s.b+o*n.b+.5,s.a=l*s.a+(1-l)*n.a,this.rgb=s}return this}interpolate(t,i){return t&&(this._rgb=TF(this._rgb,t._rgb,i)),this}clone(){return new e(this.rgb)}alpha(t){return this._rgb.a=La(t),this}clearer(t){let i=this._rgb;return i.a*=1-t,this}greyscale(){let t=this._rgb,i=op(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=i,this}opaquer(t){let i=this._rgb;return i.a*=1+t,this}negate(){let t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Tf(this._rgb,2,t),this}darken(t){return Tf(this._rgb,2,-t),this}saturate(t){return Tf(this._rgb,1,t),this}desaturate(t){return Tf(this._rgb,1,-t),this}rotate(t){return xF(this._rgb,t),this}};function Qn(){}var Q_=(()=>{let e=0;return()=>e++})();function qt(e){return e==null}function Si(e){if(Array.isArray&&Array.isArray(e))return!0;let t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Zt(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function Wi(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function po(e,t){return Wi(e)?e:t}function kt(e,t){return typeof e>"u"?t:e}var J_=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:+e/t,l0=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function bi(e,t,i){if(e&&typeof e.call=="function")return e.apply(i,t)}function ai(e,t,i,s){let n,o,l;if(Si(e))if(o=e.length,s)for(n=o-1;n>=0;n--)t.call(i,e[n],n);else for(n=0;n<o;n++)t.call(i,e[n],n);else if(Zt(e))for(l=Object.keys(e),o=l.length,n=0;n<o;n++)t.call(i,e[l[n]],l[n])}function ap(e,t){let i,s,n,o;if(!e||!t||e.length!==t.length)return!1;for(i=0,s=e.length;i<s;++i)if(n=e[i],o=t[i],n.datasetIndex!==o.datasetIndex||n.index!==o.index)return!1;return!0}function Af(e){if(Si(e))return e.map(Af);if(Zt(e)){let t=Object.create(null),i=Object.keys(e),s=i.length,n=0;for(;n<s;++n)t[i[n]]=Af(e[i[n]]);return t}return e}function e1(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function FF(e,t,i,s){if(!e1(e))return;let n=t[e],o=i[e];Zt(n)&&Zt(o)?Bh(n,o,s):t[e]=Af(o)}function Bh(e,t,i){let s=Si(t)?t:[t],n=s.length;if(!Zt(e))return e;i=i||{};let o=i.merger||FF,l;for(let d=0;d<n;++d){if(l=s[d],!Zt(l))continue;let p=Object.keys(l);for(let y=0,C=p.length;y<C;++y)o(p[y],e,l,i)}return e}function Hh(e,t){return Bh(e,t,{merger:IF})}function IF(e,t,i){if(!e1(e))return;let s=t[e],n=i[e];Zt(s)&&Zt(n)?Hh(s,n):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=Af(n))}var G_={"":e=>e,x:e=>e.x,y:e=>e.y};function kF(e){let t=e.split("."),i=[],s="";for(let n of t)s+=n,s.endsWith("\\")?s=s.slice(0,-1)+".":(i.push(s),s="");return i}function AF(e){let t=kF(e);return i=>{for(let s of t){if(s==="")break;i=i&&i[s]}return i}}function Ur(e,t){return(G_[t]||(G_[t]=AF(t)))(e)}function Bf(e){return e.charAt(0).toUpperCase()+e.slice(1)}var Nh=e=>typeof e<"u",Gr=e=>typeof e=="function",c0=(e,t)=>{if(e.size!==t.size)return!1;for(let i of e)if(!t.has(i))return!1;return!0};function t1(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}var Qt=Math.PI,Ri=2*Qt,LF=Ri+Qt,Lf=Number.POSITIVE_INFINITY,OF=Qt/180,Yi=Qt/2,Zl=Qt/4,W_=Qt*2/3,Wr=Math.log10,wn=Math.sign;function Gh(e,t,i){return Math.abs(e-t)<i}function h0(e){let t=Math.round(e);e=Gh(e,t,e/1e3)?t:e;let i=Math.pow(10,Math.floor(Wr(e))),s=e/i;return(s<=1?1:s<=2?2:s<=5?5:10)*i}function i1(e){let t=[],i=Math.sqrt(e),s;for(s=1;s<i;s++)e%s===0&&(t.push(s),t.push(e/s));return i===(i|0)&&t.push(i),t.sort((n,o)=>n-o).pop(),t}function zF(e){return typeof e=="symbol"||typeof e=="object"&&e!==null&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}function Yl(e){return!zF(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function s1(e,t){let i=Math.round(e);return i-t<=e&&i+t>=e}function u0(e,t,i){let s,n,o;for(s=0,n=e.length;s<n;s++)o=e[s][i],isNaN(o)||(t.min=Math.min(t.min,o),t.max=Math.max(t.max,o))}function Xo(e){return e*(Qt/180)}function Vf(e){return e*(180/Qt)}function d0(e){if(!Wi(e))return;let t=1,i=0;for(;Math.round(e*t)/t!==e;)t*=10,i++;return i}function p0(e,t){let i=t.x-e.x,s=t.y-e.y,n=Math.sqrt(i*i+s*s),o=Math.atan2(s,i);return o<-.5*Qt&&(o+=Ri),{angle:o,distance:n}}function Of(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function BF(e,t){return(e-t+LF)%Ri-Qt}function Os(e){return(e%Ri+Ri)%Ri}function Wh(e,t,i,s){let n=Os(e),o=Os(t),l=Os(i),d=Os(o-n),p=Os(l-n),y=Os(n-o),C=Os(n-l);return n===o||n===l||s&&o===l||d>p&&y<C}function Cs(e,t,i){return Math.max(t,Math.min(i,e))}function o1(e){return Cs(e,-32768,32767)}function Jn(e,t,i,s=1e-6){return e>=Math.min(t,i)-s&&e<=Math.max(t,i)+s}function Hf(e,t,i){i=i||(l=>e[l]<t);let s=e.length-1,n=0,o;for(;s-n>1;)o=n+s>>1,i(o)?n=o:s=o;return{lo:n,hi:s}}var Xn=(e,t,i,s)=>Hf(e,i,s?n=>{let o=e[n][t];return o<i||o===i&&e[n+1][t]===i}:n=>e[n][t]<i),n1=(e,t,i)=>Hf(e,i,s=>e[s][t]>=i);function r1(e,t,i){let s=0,n=e.length;for(;s<n&&e[s]<t;)s++;for(;n>s&&e[n-1]>i;)n--;return s>0||n<e.length?e.slice(s,n):e}var a1=["push","pop","shift","splice","unshift"];function l1(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),a1.forEach(i=>{let s="_onData"+Bf(i),n=e[i];Object.defineProperty(e,i,{configurable:!0,enumerable:!1,value(...o){let l=n.apply(this,o);return e._chartjs.listeners.forEach(d=>{typeof d[s]=="function"&&d[s](...o)}),l}})})}function g0(e,t){let i=e._chartjs;if(!i)return;let s=i.listeners,n=s.indexOf(t);n!==-1&&s.splice(n,1),!(s.length>0)&&(a1.forEach(o=>{delete e[o]}),delete e._chartjs)}function f0(e){let t=new Set(e);return t.size===e.length?e:Array.from(t)}var m0=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function v0(e,t){let i=[],s=!1;return function(...n){i=n,s||(s=!0,m0.call(window,()=>{s=!1,e.apply(t,i)}))}}function c1(e,t){let i;return function(...s){return t?(clearTimeout(i),i=setTimeout(e,t,s)):e.apply(this,s),t}}var Nf=e=>e==="start"?"left":e==="end"?"right":"center",zs=(e,t,i)=>e==="start"?t:e==="end"?i:(t+i)/2,h1=(e,t,i,s)=>e===(s?"left":"right")?i:e==="center"?(t+i)/2:t;function y0(e,t,i){let s=t.length,n=0,o=s;if(e._sorted){let{iScale:l,vScale:d,_parsed:p}=e,y=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,C=l.axis,{min:S,max:P,minDefined:I,maxDefined:O}=l.getUserBounds();if(I){if(n=Math.min(Xn(p,C,S).lo,i?s:Xn(t,C,l.getPixelForValue(S)).lo),y){let V=p.slice(0,n+1).reverse().findIndex(G=>!qt(G[d.axis]));n-=Math.max(0,V)}n=Cs(n,0,s-1)}if(O){let V=Math.max(Xn(p,l.axis,P,!0).hi+1,i?0:Xn(t,C,l.getPixelForValue(P),!0).hi+1);if(y){let G=p.slice(V-1).findIndex(X=>!qt(X[d.axis]));V+=Math.max(0,G)}o=Cs(V,n,s)-n}else o=s-n}return{start:n,count:o}}function w0(e){let{xScale:t,yScale:i,_scaleRanges:s}=e,n={xmin:t.min,xmax:t.max,ymin:i.min,ymax:i.max};if(!s)return e._scaleRanges=n,!0;let o=s.xmin!==t.min||s.xmax!==t.max||s.ymin!==i.min||s.ymax!==i.max;return Object.assign(s,n),o}var Df=e=>e===0||e===1,U_=(e,t,i)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*Ri/i)),j_=(e,t,i)=>Math.pow(2,-10*e)*Math.sin((e-t)*Ri/i)+1,zh={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*Yi)+1,easeOutSine:e=>Math.sin(e*Yi),easeInOutSine:e=>-.5*(Math.cos(Qt*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>Df(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Df(e)?e:U_(e,.075,.3),easeOutElastic:e=>Df(e)?e:j_(e,.075,.3),easeInOutElastic(e){return Df(e)?e:e<.5?.5*U_(e*2,.1125,.45):.5+.5*j_(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-zh.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?zh.easeInBounce(e*2)*.5:zh.easeOutBounce(e*2-1)*.5+.5};function C0(e){if(e&&typeof e=="object"){let t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function b0(e){return C0(e)?e:new sp(e)}function n0(e){return C0(e)?e:new sp(e).saturate(.5).darken(.1).hexString()}var VF=["x","y","borderWidth","radius","tension"],HF=["color","borderColor","backgroundColor"];function NF(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:HF},numbers:{type:"number",properties:VF}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function GF(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}var $_=new Map;function WF(e,t){t=t||{};let i=e+JSON.stringify(t),s=$_.get(i);return s||(s=new Intl.NumberFormat(e,t),$_.set(i,s)),s}function Uh(e,t,i){return WF(t,i).format(e)}var u1={values(e){return Si(e)?e:""+e},numeric(e,t,i){if(e===0)return"0";let s=this.chart.options.locale,n,o=e;if(i.length>1){let y=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(y<1e-4||y>1e15)&&(n="scientific"),o=UF(e,i)}let l=Wr(Math.abs(o)),d=isNaN(l)?1:Math.max(Math.min(-1*Math.floor(l),20),0),p={notation:n,minimumFractionDigits:d,maximumFractionDigits:d};return Object.assign(p,this.options.ticks.format),Uh(e,s,p)},logarithmic(e,t,i){if(e===0)return"0";let s=i[t].significand||e/Math.pow(10,Math.floor(Wr(e)));return[1,2,3,5,10,15].includes(s)||t>.8*i.length?u1.numeric.call(this,e,t,i):""}};function UF(e,t){let i=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(i)>=1&&e!==Math.floor(e)&&(i=e-Math.floor(e)),i}var lp={formatters:u1};function jF(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,i)=>i.lineWidth,tickColor:(t,i)=>i.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:lp.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}var za=Object.create(null),Gf=Object.create(null);function np(e,t){if(!t)return e;let i=t.split(".");for(let s=0,n=i.length;s<n;++s){let o=i[s];e=e[o]||(e[o]=Object.create(null))}return e}function r0(e,t,i){return typeof t=="string"?Bh(np(e,t),i):Bh(np(e,""),t)}var a0=class{constructor(t,i){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,n)=>n0(n.backgroundColor),this.hoverBorderColor=(s,n)=>n0(n.borderColor),this.hoverColor=(s,n)=>n0(n.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(i)}set(t,i){return r0(this,t,i)}get(t){return np(this,t)}describe(t,i){return r0(Gf,t,i)}override(t,i){return r0(za,t,i)}route(t,i,s,n){let o=np(this,t),l=np(this,s),d="_"+i;Object.defineProperties(o,{[d]:{value:o[i],writable:!0},[i]:{enumerable:!0,get(){let p=this[d],y=l[n];return Zt(p)?Object.assign({},y,p):kt(p,y)},set(p){this[d]=p}}})}apply(t){t.forEach(i=>i(this))}},xi=new a0({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[NF,GF,jF]);function $F(e){return!e||qt(e.size)||qt(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function rp(e,t,i,s,n){let o=t[n];return o||(o=t[n]=e.measureText(n).width,i.push(n)),o>s&&(s=o),s}function d1(e,t,i,s){s=s||{};let n=s.data=s.data||{},o=s.garbageCollect=s.garbageCollect||[];s.font!==t&&(n=s.data={},o=s.garbageCollect=[],s.font=t),e.save(),e.font=t;let l=0,d=i.length,p,y,C,S,P;for(p=0;p<d;p++)if(S=i[p],S!=null&&!Si(S))l=rp(e,n,o,l,S);else if(Si(S))for(y=0,C=S.length;y<C;y++)P=S[y],P!=null&&!Si(P)&&(l=rp(e,n,o,l,P));e.restore();let I=o.length/2;if(I>i.length){for(p=0;p<I;p++)delete n[o[p]];o.splice(0,I)}return l}function Ba(e,t,i){let s=e.currentDevicePixelRatio,n=i!==0?Math.max(i/2,.5):0;return Math.round((t-n)*s)/s+n}function x0(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function Wf(e,t,i,s){_0(e,t,i,s,null)}function _0(e,t,i,s,n){let o,l,d,p,y,C,S,P,I=t.pointStyle,O=t.rotation,V=t.radius,G=(O||0)*OF;if(I&&typeof I=="object"&&(o=I.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){e.save(),e.translate(i,s),e.rotate(G),e.drawImage(I,-I.width/2,-I.height/2,I.width,I.height),e.restore();return}if(!(isNaN(V)||V<=0)){switch(e.beginPath(),I){default:n?e.ellipse(i,s,n/2,V,0,0,Ri):e.arc(i,s,V,0,Ri),e.closePath();break;case"triangle":C=n?n/2:V,e.moveTo(i+Math.sin(G)*C,s-Math.cos(G)*V),G+=W_,e.lineTo(i+Math.sin(G)*C,s-Math.cos(G)*V),G+=W_,e.lineTo(i+Math.sin(G)*C,s-Math.cos(G)*V),e.closePath();break;case"rectRounded":y=V*.516,p=V-y,l=Math.cos(G+Zl)*p,S=Math.cos(G+Zl)*(n?n/2-y:p),d=Math.sin(G+Zl)*p,P=Math.sin(G+Zl)*(n?n/2-y:p),e.arc(i-S,s-d,y,G-Qt,G-Yi),e.arc(i+P,s-l,y,G-Yi,G),e.arc(i+S,s+d,y,G,G+Yi),e.arc(i-P,s+l,y,G+Yi,G+Qt),e.closePath();break;case"rect":if(!O){p=Math.SQRT1_2*V,C=n?n/2:p,e.rect(i-C,s-p,2*C,2*p);break}G+=Zl;case"rectRot":S=Math.cos(G)*(n?n/2:V),l=Math.cos(G)*V,d=Math.sin(G)*V,P=Math.sin(G)*(n?n/2:V),e.moveTo(i-S,s-d),e.lineTo(i+P,s-l),e.lineTo(i+S,s+d),e.lineTo(i-P,s+l),e.closePath();break;case"crossRot":G+=Zl;case"cross":S=Math.cos(G)*(n?n/2:V),l=Math.cos(G)*V,d=Math.sin(G)*V,P=Math.sin(G)*(n?n/2:V),e.moveTo(i-S,s-d),e.lineTo(i+S,s+d),e.moveTo(i+P,s-l),e.lineTo(i-P,s+l);break;case"star":S=Math.cos(G)*(n?n/2:V),l=Math.cos(G)*V,d=Math.sin(G)*V,P=Math.sin(G)*(n?n/2:V),e.moveTo(i-S,s-d),e.lineTo(i+S,s+d),e.moveTo(i+P,s-l),e.lineTo(i-P,s+l),G+=Zl,S=Math.cos(G)*(n?n/2:V),l=Math.cos(G)*V,d=Math.sin(G)*V,P=Math.sin(G)*(n?n/2:V),e.moveTo(i-S,s-d),e.lineTo(i+S,s+d),e.moveTo(i+P,s-l),e.lineTo(i-P,s+l);break;case"line":l=n?n/2:Math.cos(G)*V,d=Math.sin(G)*V,e.moveTo(i-l,s-d),e.lineTo(i+l,s+d);break;case"dash":e.moveTo(i,s),e.lineTo(i+Math.cos(G)*(n?n/2:V),s+Math.sin(G)*V);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function Yn(e,t,i){return i=i||.5,!t||e&&e.x>t.left-i&&e.x<t.right+i&&e.y>t.top-i&&e.y<t.bottom+i}function cp(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function hp(e){e.restore()}function p1(e,t,i,s,n){if(!t)return e.lineTo(i.x,i.y);if(n==="middle"){let o=(t.x+i.x)/2;e.lineTo(o,t.y),e.lineTo(o,i.y)}else n==="after"!=!!s?e.lineTo(t.x,i.y):e.lineTo(i.x,t.y);e.lineTo(i.x,i.y)}function g1(e,t,i,s){if(!t)return e.lineTo(i.x,i.y);e.bezierCurveTo(s?t.cp1x:t.cp2x,s?t.cp1y:t.cp2y,s?i.cp2x:i.cp1x,s?i.cp2y:i.cp1y,i.x,i.y)}function qF(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),qt(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function ZF(e,t,i,s,n){if(n.strikethrough||n.underline){let o=e.measureText(s),l=t-o.actualBoundingBoxLeft,d=t+o.actualBoundingBoxRight,p=i-o.actualBoundingBoxAscent,y=i+o.actualBoundingBoxDescent,C=n.strikethrough?(p+y)/2:y;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=n.decorationWidth||2,e.moveTo(l,C),e.lineTo(d,C),e.stroke()}}function KF(e,t){let i=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=i}function Va(e,t,i,s,n,o={}){let l=Si(t)?t:[t],d=o.strokeWidth>0&&o.strokeColor!=="",p,y;for(e.save(),e.font=n.string,qF(e,o),p=0;p<l.length;++p)y=l[p],o.backdrop&&KF(e,o.backdrop),d&&(o.strokeColor&&(e.strokeStyle=o.strokeColor),qt(o.strokeWidth)||(e.lineWidth=o.strokeWidth),e.strokeText(y,i,s,o.maxWidth)),e.fillText(y,i,s,o.maxWidth),ZF(e,i,s,y,o),s+=Number(n.lineHeight);e.restore()}function jh(e,t){let{x:i,y:s,w:n,h:o,radius:l}=t;e.arc(i+l.topLeft,s+l.topLeft,l.topLeft,1.5*Qt,Qt,!0),e.lineTo(i,s+o-l.bottomLeft),e.arc(i+l.bottomLeft,s+o-l.bottomLeft,l.bottomLeft,Qt,Yi,!0),e.lineTo(i+n-l.bottomRight,s+o),e.arc(i+n-l.bottomRight,s+o-l.bottomRight,l.bottomRight,Yi,0,!0),e.lineTo(i+n,s+l.topRight),e.arc(i+n-l.topRight,s+l.topRight,l.topRight,0,-Yi,!0),e.lineTo(i+l.topLeft,s)}var XF=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,YF=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function QF(e,t){let i=(""+e).match(XF);if(!i||i[1]==="normal")return t*1.2;switch(e=+i[2],i[3]){case"px":return e;case"%":e/=100;break}return t*e}var JF=e=>+e||0;function Uf(e,t){let i={},s=Zt(t),n=s?Object.keys(t):t,o=Zt(e)?s?l=>kt(e[l],e[t[l]]):l=>e[l]:()=>e;for(let l of n)i[l]=JF(o(l));return i}function S0(e){return Uf(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Ha(e){return Uf(e,["topLeft","topRight","bottomLeft","bottomRight"])}function Bs(e){let t=S0(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function gs(e,t){e=e||{},t=t||xi.font;let i=kt(e.size,t.size);typeof i=="string"&&(i=parseInt(i,10));let s=kt(e.style,t.style);s&&!(""+s).match(YF)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);let n={family:kt(e.family,t.family),lineHeight:QF(kt(e.lineHeight,t.lineHeight),i),size:i,style:s,weight:kt(e.weight,t.weight),string:""};return n.string=$F(n),n}function $h(e,t,i,s){let n=!0,o,l,d;for(o=0,l=e.length;o<l;++o)if(d=e[o],d!==void 0&&(t!==void 0&&typeof d=="function"&&(d=d(t),n=!1),i!==void 0&&Si(d)&&(d=d[i%d.length],n=!1),d!==void 0))return s&&!n&&(s.cacheable=!1),d}function f1(e,t,i){let{min:s,max:n}=e,o=l0(t,(n-s)/2),l=(d,p)=>i&&d===0?0:d+p;return{min:l(s,-Math.abs(o)),max:l(n,o)}}function jr(e,t){return Object.assign(Object.create(e),t)}function jf(e,t=[""],i,s,n=()=>e[0]){let o=i||e;typeof s>"u"&&(s=y1("_fallback",e));let l={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:o,_fallback:s,_getTarget:n,override:d=>jf([d,...e],t,o,s)};return new Proxy(l,{deleteProperty(d,p){return delete d[p],delete d._keys,delete e[0][p],!0},get(d,p){return m1(d,p,()=>aI(p,t,e,d))},getOwnPropertyDescriptor(d,p){return Reflect.getOwnPropertyDescriptor(d._scopes[0],p)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(d,p){return Z_(d).includes(p)},ownKeys(d){return Z_(d)},set(d,p,y){let C=d._storage||(d._storage=n());return d[p]=C[p]=y,delete d._keys,!0}})}function Xl(e,t,i,s){let n={_cacheable:!1,_proxy:e,_context:t,_subProxy:i,_stack:new Set,_descriptors:R0(e,s),setContext:o=>Xl(e,o,i,s),override:o=>Xl(e.override(o),t,i,s)};return new Proxy(n,{deleteProperty(o,l){return delete o[l],delete e[l],!0},get(o,l,d){return m1(o,l,()=>tI(o,l,d))},getOwnPropertyDescriptor(o,l){return o._descriptors.allKeys?Reflect.has(e,l)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,l)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(o,l){return Reflect.has(e,l)},ownKeys(){return Reflect.ownKeys(e)},set(o,l,d){return e[l]=d,delete o[l],!0}})}function R0(e,t={scriptable:!0,indexable:!0}){let{_scriptable:i=t.scriptable,_indexable:s=t.indexable,_allKeys:n=t.allKeys}=e;return{allKeys:n,scriptable:i,indexable:s,isScriptable:Gr(i)?i:()=>i,isIndexable:Gr(s)?s:()=>s}}var eI=(e,t)=>e?e+Bf(t):t,E0=(e,t)=>Zt(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function m1(e,t,i){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];let s=i();return e[t]=s,s}function tI(e,t,i){let{_proxy:s,_context:n,_subProxy:o,_descriptors:l}=e,d=s[t];return Gr(d)&&l.isScriptable(t)&&(d=iI(t,d,e,i)),Si(d)&&d.length&&(d=sI(t,d,e,l.isIndexable)),E0(t,d)&&(d=Xl(d,n,o&&o[t],l)),d}function iI(e,t,i,s){let{_proxy:n,_context:o,_subProxy:l,_stack:d}=i;if(d.has(e))throw new Error("Recursion detected: "+Array.from(d).join("->")+"->"+e);d.add(e);let p=t(o,l||s);return d.delete(e),E0(e,p)&&(p=P0(n._scopes,n,e,p)),p}function sI(e,t,i,s){let{_proxy:n,_context:o,_subProxy:l,_descriptors:d}=i;if(typeof o.index<"u"&&s(e))return t[o.index%t.length];if(Zt(t[0])){let p=t,y=n._scopes.filter(C=>C!==p);t=[];for(let C of p){let S=P0(y,n,e,C);t.push(Xl(S,o,l&&l[e],d))}}return t}function v1(e,t,i){return Gr(e)?e(t,i):e}var oI=(e,t)=>e===!0?t:typeof e=="string"?Ur(t,e):void 0;function nI(e,t,i,s,n){for(let o of t){let l=oI(i,o);if(l){e.add(l);let d=v1(l._fallback,i,n);if(typeof d<"u"&&d!==i&&d!==s)return d}else if(l===!1&&typeof s<"u"&&i!==s)return null}return!1}function P0(e,t,i,s){let n=t._rootScopes,o=v1(t._fallback,i,s),l=[...e,...n],d=new Set;d.add(s);let p=q_(d,l,i,o||i,s);return p===null||typeof o<"u"&&o!==i&&(p=q_(d,l,o,p,s),p===null)?!1:jf(Array.from(d),[""],n,o,()=>rI(t,i,s))}function q_(e,t,i,s,n){for(;i;)i=nI(e,t,i,s,n);return i}function rI(e,t,i){let s=e._getTarget();t in s||(s[t]={});let n=s[t];return Si(n)&&Zt(i)?i:n||{}}function aI(e,t,i,s){let n;for(let o of t)if(n=y1(eI(o,e),i),typeof n<"u")return E0(e,n)?P0(i,s,e,n):n}function y1(e,t){for(let i of t){if(!i)continue;let s=i[e];if(typeof s<"u")return s}}function Z_(e){let t=e._keys;return t||(t=e._keys=lI(e._scopes)),t}function lI(e){let t=new Set;for(let i of e)for(let s of Object.keys(i).filter(n=>!n.startsWith("_")))t.add(s);return Array.from(t)}function M0(e,t,i,s){let{iScale:n}=e,{key:o="r"}=this._parsing,l=new Array(s),d,p,y,C;for(d=0,p=s;d<p;++d)y=d+i,C=t[y],l[d]={r:n.parse(Ur(C,o),y)};return l}var cI=Number.EPSILON||1e-14,Vh=(e,t)=>t<e.length&&!e[t].skip&&e[t],w1=e=>e==="x"?"y":"x";function hI(e,t,i,s){let n=e.skip?t:e,o=t,l=i.skip?t:i,d=Of(o,n),p=Of(l,o),y=d/(d+p),C=p/(d+p);y=isNaN(y)?0:y,C=isNaN(C)?0:C;let S=s*y,P=s*C;return{previous:{x:o.x-S*(l.x-n.x),y:o.y-S*(l.y-n.y)},next:{x:o.x+P*(l.x-n.x),y:o.y+P*(l.y-n.y)}}}function uI(e,t,i){let s=e.length,n,o,l,d,p,y=Vh(e,0);for(let C=0;C<s-1;++C)if(p=y,y=Vh(e,C+1),!(!p||!y)){if(Gh(t[C],0,cI)){i[C]=i[C+1]=0;continue}n=i[C]/t[C],o=i[C+1]/t[C],d=Math.pow(n,2)+Math.pow(o,2),!(d<=9)&&(l=3/Math.sqrt(d),i[C]=n*l*t[C],i[C+1]=o*l*t[C])}}function dI(e,t,i="x"){let s=w1(i),n=e.length,o,l,d,p=Vh(e,0);for(let y=0;y<n;++y){if(l=d,d=p,p=Vh(e,y+1),!d)continue;let C=d[i],S=d[s];l&&(o=(C-l[i])/3,d[`cp1${i}`]=C-o,d[`cp1${s}`]=S-o*t[y]),p&&(o=(p[i]-C)/3,d[`cp2${i}`]=C+o,d[`cp2${s}`]=S+o*t[y])}}function pI(e,t="x"){let i=w1(t),s=e.length,n=Array(s).fill(0),o=Array(s),l,d,p,y=Vh(e,0);for(l=0;l<s;++l)if(d=p,p=y,y=Vh(e,l+1),!!p){if(y){let C=y[t]-p[t];n[l]=C!==0?(y[i]-p[i])/C:0}o[l]=d?y?wn(n[l-1])!==wn(n[l])?0:(n[l-1]+n[l])/2:n[l-1]:n[l]}uI(e,n,o),dI(e,o,t)}function Ff(e,t,i){return Math.max(Math.min(e,i),t)}function gI(e,t){let i,s,n,o,l,d=Yn(e[0],t);for(i=0,s=e.length;i<s;++i)l=o,o=d,d=i<s-1&&Yn(e[i+1],t),o&&(n=e[i],l&&(n.cp1x=Ff(n.cp1x,t.left,t.right),n.cp1y=Ff(n.cp1y,t.top,t.bottom)),d&&(n.cp2x=Ff(n.cp2x,t.left,t.right),n.cp2y=Ff(n.cp2y,t.top,t.bottom)))}function C1(e,t,i,s,n){let o,l,d,p;if(t.spanGaps&&(e=e.filter(y=>!y.skip)),t.cubicInterpolationMode==="monotone")pI(e,n);else{let y=s?e[e.length-1]:e[0];for(o=0,l=e.length;o<l;++o)d=e[o],p=hI(y,d,e[Math.min(o+1,l-(s?0:1))%l],t.tension),d.cp1x=p.previous.x,d.cp1y=p.previous.y,d.cp2x=p.next.x,d.cp2y=p.next.y,y=d}t.capBezierPoints&&gI(e,i)}function $f(){return typeof window<"u"&&typeof document<"u"}function qf(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function zf(e,t,i){let s;return typeof e=="string"?(s=parseInt(e,10),e.indexOf("%")!==-1&&(s=s/100*t.parentNode[i])):s=e,s}var Zf=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function fI(e,t){return Zf(e).getPropertyValue(t)}var mI=["top","right","bottom","left"];function Kl(e,t,i){let s={};i=i?"-"+i:"";for(let n=0;n<4;n++){let o=mI[n];s[o]=parseFloat(e[t+"-"+o+i])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}var vI=(e,t,i)=>(e>0||t>0)&&(!i||!i.shadowRoot);function yI(e,t){let i=e.touches,s=i&&i.length?i[0]:e,{offsetX:n,offsetY:o}=s,l=!1,d,p;if(vI(n,o,e.target))d=n,p=o;else{let y=t.getBoundingClientRect();d=s.clientX-y.left,p=s.clientY-y.top,l=!0}return{x:d,y:p,box:l}}function Na(e,t){if("native"in e)return e;let{canvas:i,currentDevicePixelRatio:s}=t,n=Zf(i),o=n.boxSizing==="border-box",l=Kl(n,"padding"),d=Kl(n,"border","width"),{x:p,y,box:C}=yI(e,i),S=l.left+(C&&d.left),P=l.top+(C&&d.top),{width:I,height:O}=t;return o&&(I-=l.width+d.width,O-=l.height+d.height),{x:Math.round((p-S)/I*i.width/s),y:Math.round((y-P)/O*i.height/s)}}function wI(e,t,i){let s,n;if(t===void 0||i===void 0){let o=e&&qf(e);if(!o)t=e.clientWidth,i=e.clientHeight;else{let l=o.getBoundingClientRect(),d=Zf(o),p=Kl(d,"border","width"),y=Kl(d,"padding");t=l.width-y.width-p.width,i=l.height-y.height-p.height,s=zf(d.maxWidth,o,"clientWidth"),n=zf(d.maxHeight,o,"clientHeight")}}return{width:t,height:i,maxWidth:s||Lf,maxHeight:n||Lf}}var If=e=>Math.round(e*10)/10;function b1(e,t,i,s){let n=Zf(e),o=Kl(n,"margin"),l=zf(n.maxWidth,e,"clientWidth")||Lf,d=zf(n.maxHeight,e,"clientHeight")||Lf,p=wI(e,t,i),{width:y,height:C}=p;if(n.boxSizing==="content-box"){let P=Kl(n,"border","width"),I=Kl(n,"padding");y-=I.width+P.width,C-=I.height+P.height}return y=Math.max(0,y-o.width),C=Math.max(0,s?y/s:C-o.height),y=If(Math.min(y,l,p.maxWidth)),C=If(Math.min(C,d,p.maxHeight)),y&&!C&&(C=If(y/2)),(t!==void 0||i!==void 0)&&s&&p.height&&C>p.height&&(C=p.height,y=If(Math.floor(C*s))),{width:y,height:C}}function T0(e,t,i){let s=t||1,n=Math.floor(e.height*s),o=Math.floor(e.width*s);e.height=Math.floor(e.height),e.width=Math.floor(e.width);let l=e.canvas;return l.style&&(i||!l.style.height&&!l.style.width)&&(l.style.height=`${e.height}px`,l.style.width=`${e.width}px`),e.currentDevicePixelRatio!==s||l.height!==n||l.width!==o?(e.currentDevicePixelRatio=s,l.height=n,l.width=o,e.ctx.setTransform(s,0,0,s,0,0),!0):!1}var x1=function(){let e=!1;try{let t={get passive(){return e=!0,!1}};$f()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function D0(e,t){let i=fI(e,t),s=i&&i.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function Oa(e,t,i,s){return{x:e.x+i*(t.x-e.x),y:e.y+i*(t.y-e.y)}}function _1(e,t,i,s){return{x:e.x+i*(t.x-e.x),y:s==="middle"?i<.5?e.y:t.y:s==="after"?i<1?e.y:t.y:i>0?t.y:e.y}}function S1(e,t,i,s){let n={x:e.cp2x,y:e.cp2y},o={x:t.cp1x,y:t.cp1y},l=Oa(e,n,i),d=Oa(n,o,i),p=Oa(o,t,i),y=Oa(l,d,i),C=Oa(d,p,i);return Oa(y,C,i)}var CI=function(e,t){return{x(i){return e+e+t-i},setWidth(i){t=i},textAlign(i){return i==="center"?i:i==="right"?"left":"right"},xPlus(i,s){return i-s},leftForLtr(i,s){return i-s}}},bI=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function Ql(e,t,i){return e?CI(t,i):bI()}function F0(e,t){let i,s;(t==="ltr"||t==="rtl")&&(i=e.canvas.style,s=[i.getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",t,"important"),e.prevTextDirection=s)}function I0(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function R1(e){return e==="angle"?{between:Wh,compare:BF,normalize:Os}:{between:Jn,compare:(t,i)=>t-i,normalize:t=>t}}function K_({start:e,end:t,count:i,loop:s,style:n}){return{start:e%i,end:t%i,loop:s&&(t-e+1)%i===0,style:n}}function xI(e,t,i){let{property:s,start:n,end:o}=i,{between:l,normalize:d}=R1(s),p=t.length,{start:y,end:C,loop:S}=e,P,I;if(S){for(y+=p,C+=p,P=0,I=p;P<I&&l(d(t[y%p][s]),n,o);++P)y--,C--;y%=p,C%=p}return C<y&&(C+=p),{start:y,end:C,loop:S,style:e.style}}function k0(e,t,i){if(!i)return[e];let{property:s,start:n,end:o}=i,l=t.length,{compare:d,between:p,normalize:y}=R1(s),{start:C,end:S,loop:P,style:I}=xI(e,t,i),O=[],V=!1,G=null,X,Q,ae,me=()=>p(n,ae,X)&&d(n,ae)!==0,fe=()=>d(o,X)===0||p(o,ae,X),_e=()=>V||me(),Ae=()=>!V||fe();for(let Oe=C,Ge=C;Oe<=S;++Oe)Q=t[Oe%l],!Q.skip&&(X=y(Q[s]),X!==ae&&(V=p(X,n,o),G===null&&_e()&&(G=d(X,n)===0?Oe:Ge),G!==null&&Ae()&&(O.push(K_({start:G,end:Oe,loop:P,count:l,style:I})),G=null),Ge=Oe,ae=X));return G!==null&&O.push(K_({start:G,end:S,loop:P,count:l,style:I})),O}function A0(e,t){let i=[],s=e.segments;for(let n=0;n<s.length;n++){let o=k0(s[n],e.points,t);o.length&&i.push(...o)}return i}function _I(e,t,i,s){let n=0,o=t-1;if(i&&!s)for(;n<t&&!e[n].skip;)n++;for(;n<t&&e[n].skip;)n++;for(n%=t,i&&(o+=n);o>n&&e[o%t].skip;)o--;return o%=t,{start:n,end:o}}function SI(e,t,i,s){let n=e.length,o=[],l=t,d=e[t],p;for(p=t+1;p<=i;++p){let y=e[p%n];y.skip||y.stop?d.skip||(s=!1,o.push({start:t%n,end:(p-1)%n,loop:s}),t=l=y.stop?p:null):(l=p,d.skip&&(t=p)),d=y}return l!==null&&o.push({start:t%n,end:l%n,loop:s}),o}function E1(e,t){let i=e.points,s=e.options.spanGaps,n=i.length;if(!n)return[];let o=!!e._loop,{start:l,end:d}=_I(i,n,o,s);if(s===!0)return X_(e,[{start:l,end:d,loop:o}],i,t);let p=d<l?d+n:d,y=!!e._fullLoop&&l===0&&d===n-1;return X_(e,SI(i,l,p,y),i,t)}function X_(e,t,i,s){return!s||!s.setContext||!i?t:RI(e,t,i,s)}function RI(e,t,i,s){let n=e._chart.getContext(),o=Y_(e.options),{_datasetIndex:l,options:{spanGaps:d}}=e,p=i.length,y=[],C=o,S=t[0].start,P=S;function I(O,V,G,X){let Q=d?-1:1;if(O!==V){for(O+=p;i[O%p].skip;)O-=Q;for(;i[V%p].skip;)V+=Q;O%p!==V%p&&(y.push({start:O%p,end:V%p,loop:G,style:X}),C=X,S=V%p)}}for(let O of t){S=d?S:O.start;let V=i[S%p],G;for(P=S+1;P<=O.end;P++){let X=i[P%p];G=Y_(s.setContext(jr(n,{type:"segment",p0:V,p1:X,p0DataIndex:(P-1)%p,p1DataIndex:P%p,datasetIndex:l}))),EI(G,C)&&I(S,P-1,O.loop,C),V=X,C=G}S<P-1&&I(S,P-1,O.loop,C)}return y}function Y_(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function EI(e,t){if(!t)return!1;let i=[],s=function(n,o){return C0(o)?(i.includes(o)||i.push(o),i.indexOf(o)):o};return JSON.stringify(e,s)!==JSON.stringify(t,s)}function kf(e,t,i){return e.options.clip?e[i]:t[i]}function PI(e,t){let{xScale:i,yScale:s}=e;return i&&s?{left:kf(i,t,"left"),right:kf(i,t,"right"),top:kf(s,t,"top"),bottom:kf(s,t,"bottom")}:t}function L0(e,t){let i=t._clip;if(i.disabled)return!1;let s=PI(t,e.chartArea);return{left:i.left===!1?0:s.left-(i.left===!0?0:i.left),right:i.right===!1?e.width:s.right+(i.right===!0?0:i.right),top:i.top===!1?0:s.top-(i.top===!0?0:i.top),bottom:i.bottom===!1?e.height:s.bottom+(i.bottom===!0?0:i.bottom)}}var q0=class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,i,s,n){let o=i.listeners[n],l=i.duration;o.forEach(d=>d({chart:t,initial:i.initial,numSteps:l,currentStep:Math.min(s-i.start,l)}))}_refresh(){this._request||(this._running=!0,this._request=m0.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let i=0;this._charts.forEach((s,n)=>{if(!s.running||!s.items.length)return;let o=s.items,l=o.length-1,d=!1,p;for(;l>=0;--l)p=o[l],p._active?(p._total>s.duration&&(s.duration=p._total),p.tick(t),d=!0):(o[l]=o[o.length-1],o.pop());d&&(n.draw(),this._notify(n,s,t,"progress")),o.length||(s.running=!1,this._notify(n,s,t,"complete"),s.initial=!1),i+=o.length}),this._lastDate=t,i===0&&(this._running=!1)}_getAnims(t){let i=this._charts,s=i.get(t);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},i.set(t,s)),s}listen(t,i,s){this._getAnims(t).listeners[i].push(s)}add(t,i){!i||!i.length||this._getAnims(t).items.push(...i)}has(t){return this._getAnims(t).items.length>0}start(t){let i=this._charts.get(t);i&&(i.running=!0,i.start=Date.now(),i.duration=i.items.reduce((s,n)=>Math.max(s,n._duration),0),this._refresh())}running(t){if(!this._running)return!1;let i=this._charts.get(t);return!(!i||!i.running||!i.items.length)}stop(t){let i=this._charts.get(t);if(!i||!i.items.length)return;let s=i.items,n=s.length-1;for(;n>=0;--n)s[n].cancel();i.items=[],this._notify(t,i,Date.now(),"complete")}remove(t){return this._charts.delete(t)}},$r=new q0,P1="transparent",MI={boolean(e,t,i){return i>.5?t:e},color(e,t,i){let s=b0(e||P1),n=s.valid&&b0(t||P1);return n&&n.valid?n.mix(s,i).hexString():t},number(e,t,i){return e+(t-e)*i}},Z0=class{constructor(t,i,s,n){let o=i[s];n=$h([t.to,n,o,t.from]);let l=$h([t.from,o,n]);this._active=!0,this._fn=t.fn||MI[t.type||typeof l],this._easing=zh[t.easing]||zh.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=i,this._prop=s,this._from=l,this._to=n,this._promises=void 0}active(){return this._active}update(t,i,s){if(this._active){this._notify(!1);let n=this._target[this._prop],o=s-this._start,l=this._duration-o;this._start=s,this._duration=Math.floor(Math.max(l,t.duration)),this._total+=o,this._loop=!!t.loop,this._to=$h([t.to,i,n,t.from]),this._from=$h([t.from,n,i])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){let i=t-this._start,s=this._duration,n=this._prop,o=this._from,l=this._loop,d=this._to,p;if(this._active=o!==d&&(l||i<s),!this._active){this._target[n]=d,this._notify(!0);return}if(i<0){this._target[n]=o;return}p=i/s%2,p=l&&p>1?2-p:p,p=this._easing(Math.min(1,Math.max(0,p))),this._target[n]=this._fn(o,d,p)}wait(){let t=this._promises||(this._promises=[]);return new Promise((i,s)=>{t.push({res:i,rej:s})})}_notify(t){let i=t?"res":"rej",s=this._promises||[];for(let n=0;n<s.length;n++)s[n][i]()}},sm=class{constructor(t,i){this._chart=t,this._properties=new Map,this.configure(i)}configure(t){if(!Zt(t))return;let i=Object.keys(xi.animation),s=this._properties;Object.getOwnPropertyNames(t).forEach(n=>{let o=t[n];if(!Zt(o))return;let l={};for(let d of i)l[d]=o[d];(Si(o.properties)&&o.properties||[n]).forEach(d=>{(d===n||!s.has(d))&&s.set(d,l)})})}_animateOptions(t,i){let s=i.options,n=DI(t,s);if(!n)return[];let o=this._createAnimations(n,s);return s.$shared&&TI(t.options.$animations,s).then(()=>{t.options=s},()=>{}),o}_createAnimations(t,i){let s=this._properties,n=[],o=t.$animations||(t.$animations={}),l=Object.keys(i),d=Date.now(),p;for(p=l.length-1;p>=0;--p){let y=l[p];if(y.charAt(0)==="$")continue;if(y==="options"){n.push(...this._animateOptions(t,i));continue}let C=i[y],S=o[y],P=s.get(y);if(S)if(P&&S.active()){S.update(P,C,d);continue}else S.cancel();if(!P||!P.duration){t[y]=C;continue}o[y]=S=new Z0(P,t,y,C),n.push(S)}return n}update(t,i){if(this._properties.size===0){Object.assign(t,i);return}let s=this._createAnimations(t,i);if(s.length)return $r.add(this._chart,s),!0}};function TI(e,t){let i=[],s=Object.keys(t);for(let n=0;n<s.length;n++){let o=e[s[n]];o&&o.active()&&i.push(o.wait())}return Promise.all(i)}function DI(e,t){if(!t)return;let i=e.options;if(!i){e.options=t;return}return i.$shared&&(e.options=i=Object.assign({},i,{$shared:!1,$animations:{}})),i}function M1(e,t){let i=e&&e.options||{},s=i.reverse,n=i.min===void 0?t:0,o=i.max===void 0?t:0;return{start:s?o:n,end:s?n:o}}function FI(e,t,i){if(i===!1)return!1;let s=M1(e,i),n=M1(t,i);return{top:n.end,right:s.end,bottom:n.start,left:s.start}}function II(e){let t,i,s,n;return Zt(e)?(t=e.top,i=e.right,s=e.bottom,n=e.left):t=i=s=n=e,{top:t,right:i,bottom:s,left:n,disabled:e===!1}}function PS(e,t){let i=[],s=e._getSortedDatasetMetas(t),n,o;for(n=0,o=s.length;n<o;++n)i.push(s[n].index);return i}function T1(e,t,i,s={}){let n=e.keys,o=s.mode==="single",l,d,p,y;if(t===null)return;let C=!1;for(l=0,d=n.length;l<d;++l){if(p=+n[l],p===i){if(C=!0,s.all)continue;break}y=e.values[p],Wi(y)&&(o||t===0||wn(t)===wn(y))&&(t+=y)}return!C&&!s.all?0:t}function kI(e,t){let{iScale:i,vScale:s}=t,n=i.axis==="x"?"x":"y",o=s.axis==="x"?"x":"y",l=Object.keys(e),d=new Array(l.length),p,y,C;for(p=0,y=l.length;p<y;++p)C=l[p],d[p]={[n]:C,[o]:e[C]};return d}function O0(e,t){let i=e&&e.options.stacked;return i||i===void 0&&t.stack!==void 0}function AI(e,t,i){return`${e.id}.${t.id}.${i.stack||i.type}`}function LI(e){let{min:t,max:i,minDefined:s,maxDefined:n}=e.getUserBounds();return{min:s?t:Number.NEGATIVE_INFINITY,max:n?i:Number.POSITIVE_INFINITY}}function OI(e,t,i){let s=e[t]||(e[t]={});return s[i]||(s[i]={})}function D1(e,t,i,s){for(let n of t.getMatchingVisibleMetas(s).reverse()){let o=e[n.index];if(i&&o>0||!i&&o<0)return n.index}return null}function F1(e,t){let{chart:i,_cachedMeta:s}=e,n=i._stacks||(i._stacks={}),{iScale:o,vScale:l,index:d}=s,p=o.axis,y=l.axis,C=AI(o,l,s),S=t.length,P;for(let I=0;I<S;++I){let O=t[I],{[p]:V,[y]:G}=O,X=O._stacks||(O._stacks={});P=X[y]=OI(n,C,V),P[d]=G,P._top=D1(P,l,!0,s.type),P._bottom=D1(P,l,!1,s.type);let Q=P._visualValues||(P._visualValues={});Q[d]=G}}function z0(e,t){let i=e.scales;return Object.keys(i).filter(s=>i[s].axis===t).shift()}function zI(e,t){return jr(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function BI(e,t,i){return jr(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:i,index:t,mode:"default",type:"data"})}function up(e,t){let i=e.controller.index,s=e.vScale&&e.vScale.axis;if(s){t=t||e._parsed;for(let n of t){let o=n._stacks;if(!o||o[s]===void 0||o[s][i]===void 0)return;delete o[s][i],o[s]._visualValues!==void 0&&o[s]._visualValues[i]!==void 0&&delete o[s]._visualValues[i]}}}var B0=e=>e==="reset"||e==="none",I1=(e,t)=>t?e:Object.assign({},e),VI=(e,t,i)=>e&&!t.hidden&&t._stacked&&{keys:PS(i,!0),values:null},Wa=(()=>{class e{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(i,s){this.chart=i,this._ctx=i.ctx,this.index=s,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){let i=this._cachedMeta;this.configure(),this.linkScales(),i._stacked=O0(i.vScale,i),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(i){this.index!==i&&up(this._cachedMeta),this.index=i}linkScales(){let i=this.chart,s=this._cachedMeta,n=this.getDataset(),o=(P,I,O,V)=>P==="x"?I:P==="r"?V:O,l=s.xAxisID=kt(n.xAxisID,z0(i,"x")),d=s.yAxisID=kt(n.yAxisID,z0(i,"y")),p=s.rAxisID=kt(n.rAxisID,z0(i,"r")),y=s.indexAxis,C=s.iAxisID=o(y,l,d,p),S=s.vAxisID=o(y,d,l,p);s.xScale=this.getScaleForId(l),s.yScale=this.getScaleForId(d),s.rScale=this.getScaleForId(p),s.iScale=this.getScaleForId(C),s.vScale=this.getScaleForId(S)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(i){return this.chart.scales[i]}_getOtherScale(i){let s=this._cachedMeta;return i===s.iScale?s.vScale:s.iScale}reset(){this._update("reset")}_destroy(){let i=this._cachedMeta;this._data&&g0(this._data,this),i._stacked&&up(i)}_dataCheck(){let i=this.getDataset(),s=i.data||(i.data=[]),n=this._data;if(Zt(s)){let o=this._cachedMeta;this._data=kI(s,o)}else if(n!==s){if(n){g0(n,this);let o=this._cachedMeta;up(o),o._parsed=[]}s&&Object.isExtensible(s)&&l1(s,this),this._syncList=[],this._data=s}}addElements(){let i=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(i.dataset=new this.datasetElementType)}buildOrUpdateElements(i){let s=this._cachedMeta,n=this.getDataset(),o=!1;this._dataCheck();let l=s._stacked;s._stacked=O0(s.vScale,s),s.stack!==n.stack&&(o=!0,up(s),s.stack=n.stack),this._resyncElements(i),(o||l!==s._stacked)&&(F1(this,s._parsed),s._stacked=O0(s.vScale,s))}configure(){let i=this.chart.config,s=i.datasetScopeKeys(this._type),n=i.getOptionScopes(this.getDataset(),s,!0);this.options=i.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(i,s){let{_cachedMeta:n,_data:o}=this,{iScale:l,_stacked:d}=n,p=l.axis,y=i===0&&s===o.length?!0:n._sorted,C=i>0&&n._parsed[i-1],S,P,I;if(this._parsing===!1)n._parsed=o,n._sorted=!0,I=o;else{Si(o[i])?I=this.parseArrayData(n,o,i,s):Zt(o[i])?I=this.parseObjectData(n,o,i,s):I=this.parsePrimitiveData(n,o,i,s);let O=()=>P[p]===null||C&&P[p]<C[p];for(S=0;S<s;++S)n._parsed[S+i]=P=I[S],y&&(O()&&(y=!1),C=P);n._sorted=y}d&&F1(this,I)}parsePrimitiveData(i,s,n,o){let{iScale:l,vScale:d}=i,p=l.axis,y=d.axis,C=l.getLabels(),S=l===d,P=new Array(o),I,O,V;for(I=0,O=o;I<O;++I)V=I+n,P[I]={[p]:S||l.parse(C[V],V),[y]:d.parse(s[V],V)};return P}parseArrayData(i,s,n,o){let{xScale:l,yScale:d}=i,p=new Array(o),y,C,S,P;for(y=0,C=o;y<C;++y)S=y+n,P=s[S],p[y]={x:l.parse(P[0],S),y:d.parse(P[1],S)};return p}parseObjectData(i,s,n,o){let{xScale:l,yScale:d}=i,{xAxisKey:p="x",yAxisKey:y="y"}=this._parsing,C=new Array(o),S,P,I,O;for(S=0,P=o;S<P;++S)I=S+n,O=s[I],C[S]={x:l.parse(Ur(O,p),I),y:d.parse(Ur(O,y),I)};return C}getParsed(i){return this._cachedMeta._parsed[i]}getDataElement(i){return this._cachedMeta.data[i]}applyStack(i,s,n){let o=this.chart,l=this._cachedMeta,d=s[i.axis],p={keys:PS(o,!0),values:s._stacks[i.axis]._visualValues};return T1(p,d,l.index,{mode:n})}updateRangeFromParsed(i,s,n,o){let l=n[s.axis],d=l===null?NaN:l,p=o&&n._stacks[s.axis];o&&p&&(o.values=p,d=T1(o,l,this._cachedMeta.index)),i.min=Math.min(i.min,d),i.max=Math.max(i.max,d)}getMinMax(i,s){let n=this._cachedMeta,o=n._parsed,l=n._sorted&&i===n.iScale,d=o.length,p=this._getOtherScale(i),y=VI(s,n,this.chart),C={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:S,max:P}=LI(p),I,O;function V(){O=o[I];let G=O[p.axis];return!Wi(O[i.axis])||S>G||P<G}for(I=0;I<d&&!(!V()&&(this.updateRangeFromParsed(C,i,O,y),l));++I);if(l){for(I=d-1;I>=0;--I)if(!V()){this.updateRangeFromParsed(C,i,O,y);break}}return C}getAllParsedValues(i){let s=this._cachedMeta._parsed,n=[],o,l,d;for(o=0,l=s.length;o<l;++o)d=s[o][i.axis],Wi(d)&&n.push(d);return n}getMaxOverflow(){return!1}getLabelAndValue(i){let s=this._cachedMeta,n=s.iScale,o=s.vScale,l=this.getParsed(i);return{label:n?""+n.getLabelForValue(l[n.axis]):"",value:o?""+o.getLabelForValue(l[o.axis]):""}}_update(i){let s=this._cachedMeta;this.update(i||"default"),s._clip=II(kt(this.options.clip,FI(s.xScale,s.yScale,this.getMaxOverflow())))}update(i){}draw(){let i=this._ctx,s=this.chart,n=this._cachedMeta,o=n.data||[],l=s.chartArea,d=[],p=this._drawStart||0,y=this._drawCount||o.length-p,C=this.options.drawActiveElementsOnTop,S;for(n.dataset&&n.dataset.draw(i,l,p,y),S=p;S<p+y;++S){let P=o[S];P.hidden||(P.active&&C?d.push(P):P.draw(i,l))}for(S=0;S<d.length;++S)d[S].draw(i,l)}getStyle(i,s){let n=s?"active":"default";return i===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(i||0,n)}getContext(i,s,n){let o=this.getDataset(),l;if(i>=0&&i<this._cachedMeta.data.length){let d=this._cachedMeta.data[i];l=d.$context||(d.$context=BI(this.getContext(),i,d)),l.parsed=this.getParsed(i),l.raw=o.data[i],l.index=l.dataIndex=i}else l=this.$context||(this.$context=zI(this.chart.getContext(),this.index)),l.dataset=o,l.index=l.datasetIndex=this.index;return l.active=!!s,l.mode=n,l}resolveDatasetElementOptions(i){return this._resolveElementOptions(this.datasetElementType.id,i)}resolveDataElementOptions(i,s){return this._resolveElementOptions(this.dataElementType.id,s,i)}_resolveElementOptions(i,s="default",n){let o=s==="active",l=this._cachedDataOpts,d=i+"-"+s,p=l[d],y=this.enableOptionSharing&&Nh(n);if(p)return I1(p,y);let C=this.chart.config,S=C.datasetElementScopeKeys(this._type,i),P=o?[`${i}Hover`,"hover",i,""]:[i,""],I=C.getOptionScopes(this.getDataset(),S),O=Object.keys(xi.elements[i]),V=()=>this.getContext(n,o,s),G=C.resolveNamedOptions(I,O,V,P);return G.$shared&&(G.$shared=y,l[d]=Object.freeze(I1(G,y))),G}_resolveAnimations(i,s,n){let o=this.chart,l=this._cachedDataOpts,d=`animation-${s}`,p=l[d];if(p)return p;let y;if(o.options.animation!==!1){let S=this.chart.config,P=S.datasetAnimationScopeKeys(this._type,s),I=S.getOptionScopes(this.getDataset(),P);y=S.createResolver(I,this.getContext(i,n,s))}let C=new sm(o,y&&y.animations);return y&&y._cacheable&&(l[d]=Object.freeze(C)),C}getSharedOptions(i){if(i.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},i))}includeOptions(i,s){return!s||B0(i)||this.chart._animationsDisabled}_getSharedOptions(i,s){let n=this.resolveDataElementOptions(i,s),o=this._sharedOptions,l=this.getSharedOptions(n),d=this.includeOptions(s,l)||l!==o;return this.updateSharedOptions(l,s,n),{sharedOptions:l,includeOptions:d}}updateElement(i,s,n,o){B0(o)?Object.assign(i,n):this._resolveAnimations(s,o).update(i,n)}updateSharedOptions(i,s,n){i&&!B0(s)&&this._resolveAnimations(void 0,s).update(i,n)}_setStyle(i,s,n,o){i.active=o;let l=this.getStyle(s,o);this._resolveAnimations(s,n,o).update(i,{options:!o&&this.getSharedOptions(l)||l})}removeHoverStyle(i,s,n){this._setStyle(i,n,"active",!1)}setHoverStyle(i,s,n){this._setStyle(i,n,"active",!0)}_removeDatasetHoverStyle(){let i=this._cachedMeta.dataset;i&&this._setStyle(i,void 0,"active",!1)}_setDatasetHoverStyle(){let i=this._cachedMeta.dataset;i&&this._setStyle(i,void 0,"active",!0)}_resyncElements(i){let s=this._data,n=this._cachedMeta.data;for(let[p,y,C]of this._syncList)this[p](y,C);this._syncList=[];let o=n.length,l=s.length,d=Math.min(l,o);d&&this.parse(0,d),l>o?this._insertElements(o,l-o,i):l<o&&this._removeElements(l,o-l)}_insertElements(i,s,n=!0){let o=this._cachedMeta,l=o.data,d=i+s,p,y=C=>{for(C.length+=s,p=C.length-1;p>=d;p--)C[p]=C[p-s]};for(y(l),p=i;p<d;++p)l[p]=new this.dataElementType;this._parsing&&y(o._parsed),this.parse(i,s),n&&this.updateElements(l,i,s,"reset")}updateElements(i,s,n,o){}_removeElements(i,s){let n=this._cachedMeta;if(this._parsing){let o=n._parsed.splice(i,s);n._stacked&&up(n,o)}n.data.splice(i,s)}_sync(i){if(this._parsing)this._syncList.push(i);else{let[s,n,o]=i;this[s](n,o)}this.chart._dataChanges.push([this.index,...i])}_onDataPush(){let i=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-i,i])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(i,s){s&&this._sync(["_removeElements",i,s]);let n=arguments.length-2;n&&this._sync(["_insertElements",i,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}return e})();function HI(e,t){if(!e._cache.$bar){let i=e.getMatchingVisibleMetas(t),s=[];for(let n=0,o=i.length;n<o;n++)s=s.concat(i[n].controller.getAllParsedValues(e));e._cache.$bar=f0(s.sort((n,o)=>n-o))}return e._cache.$bar}function NI(e){let t=e.iScale,i=HI(t,e.type),s=t._length,n,o,l,d,p=()=>{l===32767||l===-32768||(Nh(d)&&(s=Math.min(s,Math.abs(l-d)||s)),d=l)};for(n=0,o=i.length;n<o;++n)l=t.getPixelForValue(i[n]),p();for(d=void 0,n=0,o=t.ticks.length;n<o;++n)l=t.getPixelForTick(n),p();return s}function GI(e,t,i,s){let n=i.barThickness,o,l;return qt(n)?(o=t.min*i.categoryPercentage,l=i.barPercentage):(o=n*s,l=1),{chunk:o/s,ratio:l,start:t.pixels[e]-o/2}}function WI(e,t,i,s){let n=t.pixels,o=n[e],l=e>0?n[e-1]:null,d=e<n.length-1?n[e+1]:null,p=i.categoryPercentage;l===null&&(l=o-(d===null?t.end-t.start:d-o)),d===null&&(d=o+o-l);let y=o-(o-Math.min(l,d))/2*p;return{chunk:Math.abs(d-l)/2*p/s,ratio:i.barPercentage,start:y}}function UI(e,t,i,s){let n=i.parse(e[0],s),o=i.parse(e[1],s),l=Math.min(n,o),d=Math.max(n,o),p=l,y=d;Math.abs(l)>Math.abs(d)&&(p=d,y=l),t[i.axis]=y,t._custom={barStart:p,barEnd:y,start:n,end:o,min:l,max:d}}function MS(e,t,i,s){return Si(e)?UI(e,t,i,s):t[i.axis]=i.parse(e,s),t}function k1(e,t,i,s){let n=e.iScale,o=e.vScale,l=n.getLabels(),d=n===o,p=[],y,C,S,P;for(y=i,C=i+s;y<C;++y)P=t[y],S={},S[n.axis]=d||n.parse(l[y],y),p.push(MS(P,S,o,y));return p}function V0(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function jI(e,t,i){return e!==0?wn(e):(t.isHorizontal()?1:-1)*(t.min>=i?1:-1)}function $I(e){let t,i,s,n,o;return e.horizontal?(t=e.base>e.x,i="left",s="right"):(t=e.base<e.y,i="bottom",s="top"),t?(n="end",o="start"):(n="start",o="end"),{start:i,end:s,reverse:t,top:n,bottom:o}}function qI(e,t,i,s){let n=t.borderSkipped,o={};if(!n){e.borderSkipped=o;return}if(n===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}let{start:l,end:d,reverse:p,top:y,bottom:C}=$I(e);n==="middle"&&i&&(e.enableBorderRadius=!0,(i._top||0)===s?n=y:(i._bottom||0)===s?n=C:(o[A1(C,l,d,p)]=!0,n=y)),o[A1(n,l,d,p)]=!0,e.borderSkipped=o}function A1(e,t,i,s){return s?(e=ZI(e,t,i),e=L1(e,i,t)):e=L1(e,t,i),e}function ZI(e,t,i){return e===t?i:e===i?t:e}function L1(e,t,i){return e==="start"?t:e==="end"?i:e}function KI(e,{inflateAmount:t},i){e.inflateAmount=t==="auto"?i===1?.33:0:t}var XI=(()=>{class e extends Wa{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(i,s,n,o){return k1(i,s,n,o)}parseArrayData(i,s,n,o){return k1(i,s,n,o)}parseObjectData(i,s,n,o){let{iScale:l,vScale:d}=i,{xAxisKey:p="x",yAxisKey:y="y"}=this._parsing,C=l.axis==="x"?p:y,S=d.axis==="x"?p:y,P=[],I,O,V,G;for(I=n,O=n+o;I<O;++I)G=s[I],V={},V[l.axis]=l.parse(Ur(G,C),I),P.push(MS(Ur(G,S),V,d,I));return P}updateRangeFromParsed(i,s,n,o){super.updateRangeFromParsed(i,s,n,o);let l=n._custom;l&&s===this._cachedMeta.vScale&&(i.min=Math.min(i.min,l.min),i.max=Math.max(i.max,l.max))}getMaxOverflow(){return 0}getLabelAndValue(i){let s=this._cachedMeta,{iScale:n,vScale:o}=s,l=this.getParsed(i),d=l._custom,p=V0(d)?"["+d.start+", "+d.end+"]":""+o.getLabelForValue(l[o.axis]);return{label:""+n.getLabelForValue(l[n.axis]),value:p}}initialize(){this.enableOptionSharing=!0,super.initialize();let i=this._cachedMeta;i.stack=this.getDataset().stack}update(i){let s=this._cachedMeta;this.updateElements(s.data,0,s.data.length,i)}updateElements(i,s,n,o){let l=o==="reset",{index:d,_cachedMeta:{vScale:p}}=this,y=p.getBasePixel(),C=p.isHorizontal(),S=this._getRuler(),{sharedOptions:P,includeOptions:I}=this._getSharedOptions(s,o);for(let O=s;O<s+n;O++){let V=this.getParsed(O),G=l||qt(V[p.axis])?{base:y,head:y}:this._calculateBarValuePixels(O),X=this._calculateBarIndexPixels(O,S),Q=(V._stacks||{})[p.axis],ae={horizontal:C,base:G.base,enableBorderRadius:!Q||V0(V._custom)||d===Q._top||d===Q._bottom,x:C?G.head:X.center,y:C?X.center:G.head,height:C?X.size:Math.abs(G.size),width:C?Math.abs(G.size):X.size};I&&(ae.options=P||this.resolveDataElementOptions(O,i[O].active?"active":o));let me=ae.options||i[O].options;qI(ae,me,Q,d),KI(ae,me,S.ratio),this.updateElement(i[O],O,ae,o)}}_getStacks(i,s){let{iScale:n}=this._cachedMeta,o=n.getMatchingVisibleMetas(this._type).filter(S=>S.controller.options.grouped),l=n.options.stacked,d=[],p=this._cachedMeta.controller.getParsed(s),y=p&&p[n.axis],C=S=>{let P=S._parsed.find(O=>O[n.axis]===y),I=P&&P[S.vScale.axis];if(qt(I)||isNaN(I))return!0};for(let S of o)if(!(s!==void 0&&C(S))&&((l===!1||d.indexOf(S.stack)===-1||l===void 0&&S.stack===void 0)&&d.push(S.stack),S.index===i))break;return d.length||d.push(void 0),d}_getStackCount(i){return this._getStacks(void 0,i).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){let i=this.chart.scales,s=this.chart.options.indexAxis;return Object.keys(i).filter(n=>i[n].axis===s).shift()}_getAxis(){let i={},s=this.getFirstScaleIdForIndexAxis();for(let n of this.chart.data.datasets)i[kt(this.chart.options.indexAxis==="x"?n.xAxisID:n.yAxisID,s)]=!0;return Object.keys(i)}_getStackIndex(i,s,n){let o=this._getStacks(i,n),l=s!==void 0?o.indexOf(s):-1;return l===-1?o.length-1:l}_getRuler(){let i=this.options,s=this._cachedMeta,n=s.iScale,o=[],l,d;for(l=0,d=s.data.length;l<d;++l)o.push(n.getPixelForValue(this.getParsed(l)[n.axis],l));let p=i.barThickness;return{min:p||NI(s),pixels:o,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:i.grouped,ratio:p?1:i.categoryPercentage*i.barPercentage}}_calculateBarValuePixels(i){let{_cachedMeta:{vScale:s,_stacked:n,index:o},options:{base:l,minBarLength:d}}=this,p=l||0,y=this.getParsed(i),C=y._custom,S=V0(C),P=y[s.axis],I=0,O=n?this.applyStack(s,y,n):P,V,G;O!==P&&(I=O-P,O=P),S&&(P=C.barStart,O=C.barEnd-C.barStart,P!==0&&wn(P)!==wn(C.barEnd)&&(I=0),I+=P);let X=!qt(l)&&!S?l:I,Q=s.getPixelForValue(X);if(this.chart.getDataVisibility(i)?V=s.getPixelForValue(I+O):V=Q,G=V-Q,Math.abs(G)<d){G=jI(G,s,p)*d,P===p&&(Q-=G/2);let ae=s.getPixelForDecimal(0),me=s.getPixelForDecimal(1),fe=Math.min(ae,me),_e=Math.max(ae,me);Q=Math.max(Math.min(Q,_e),fe),V=Q+G,n&&!S&&(y._stacks[s.axis]._visualValues[o]=s.getValueForPixel(V)-s.getValueForPixel(Q))}if(Q===s.getPixelForValue(p)){let ae=wn(G)*s.getLineWidthForValue(p)/2;Q+=ae,G-=ae}return{size:G,base:Q,head:V,center:V+G/2}}_calculateBarIndexPixels(i,s){let n=s.scale,o=this.options,l=o.skipNull,d=kt(o.maxBarThickness,1/0),p,y,C=this._getAxisCount();if(s.grouped){let S=l?this._getStackCount(i):s.stackCount,P=o.barThickness==="flex"?WI(i,s,o,S*C):GI(i,s,o,S*C),I=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,O=this._getAxis().indexOf(kt(I,this.getFirstScaleIdForIndexAxis())),V=this._getStackIndex(this.index,this._cachedMeta.stack,l?i:void 0)+O;p=P.start+P.chunk*V+P.chunk/2,y=Math.min(d,P.chunk*P.ratio)}else p=n.getPixelForValue(this.getParsed(i)[n.axis],i),y=Math.min(d,s.min*s.ratio);return{base:p-y/2,head:p+y/2,center:p,size:y}}draw(){let i=this._cachedMeta,s=i.vScale,n=i.data,o=n.length,l=0;for(;l<o;++l)this.getParsed(l)[s.axis]!==null&&!n[l].hidden&&n[l].draw(this._ctx)}}return e})(),YI=(()=>{class e extends Wa{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(i,s,n,o){let l=super.parsePrimitiveData(i,s,n,o);for(let d=0;d<l.length;d++)l[d]._custom=this.resolveDataElementOptions(d+n).radius;return l}parseArrayData(i,s,n,o){let l=super.parseArrayData(i,s,n,o);for(let d=0;d<l.length;d++){let p=s[n+d];l[d]._custom=kt(p[2],this.resolveDataElementOptions(d+n).radius)}return l}parseObjectData(i,s,n,o){let l=super.parseObjectData(i,s,n,o);for(let d=0;d<l.length;d++){let p=s[n+d];l[d]._custom=kt(p&&p.r&&+p.r,this.resolveDataElementOptions(d+n).radius)}return l}getMaxOverflow(){let i=this._cachedMeta.data,s=0;for(let n=i.length-1;n>=0;--n)s=Math.max(s,i[n].size(this.resolveDataElementOptions(n))/2);return s>0&&s}getLabelAndValue(i){let s=this._cachedMeta,n=this.chart.data.labels||[],{xScale:o,yScale:l}=s,d=this.getParsed(i),p=o.getLabelForValue(d.x),y=l.getLabelForValue(d.y),C=d._custom;return{label:n[i]||"",value:"("+p+", "+y+(C?", "+C:"")+")"}}update(i){let s=this._cachedMeta.data;this.updateElements(s,0,s.length,i)}updateElements(i,s,n,o){let l=o==="reset",{iScale:d,vScale:p}=this._cachedMeta,{sharedOptions:y,includeOptions:C}=this._getSharedOptions(s,o),S=d.axis,P=p.axis;for(let I=s;I<s+n;I++){let O=i[I],V=!l&&this.getParsed(I),G={},X=G[S]=l?d.getPixelForDecimal(.5):d.getPixelForValue(V[S]),Q=G[P]=l?p.getBasePixel():p.getPixelForValue(V[P]);G.skip=isNaN(X)||isNaN(Q),C&&(G.options=y||this.resolveDataElementOptions(I,O.active?"active":o),l&&(G.options.radius=0)),this.updateElement(O,I,G,o)}}resolveDataElementOptions(i,s){let n=this.getParsed(i),o=super.resolveDataElementOptions(i,s);o.$shared&&(o=Object.assign({},o,{$shared:!1}));let l=o.radius;return s!=="active"&&(o.radius=0),o.radius+=kt(n&&n._custom,l),o}}return e})();function QI(e,t,i){let s=1,n=1,o=0,l=0;if(t<Ri){let d=e,p=d+t,y=Math.cos(d),C=Math.sin(d),S=Math.cos(p),P=Math.sin(p),I=(ae,me,fe)=>Wh(ae,d,p,!0)?1:Math.max(me,me*i,fe,fe*i),O=(ae,me,fe)=>Wh(ae,d,p,!0)?-1:Math.min(me,me*i,fe,fe*i),V=I(0,y,S),G=I(Yi,C,P),X=O(Qt,y,S),Q=O(Qt+Yi,C,P);s=(V-X)/2,n=(G-Q)/2,o=-(V+X)/2,l=-(G+Q)/2}return{ratioX:s,ratioY:n,offsetX:o,offsetY:l}}var gw=(()=>{class e extends Wa{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:i=>i!=="spacing",_indexable:i=>i!=="spacing"&&!i.startsWith("borderDash")&&!i.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(i){let s=i.data;if(s.labels.length&&s.datasets.length){let{labels:{pointStyle:n,color:o}}=i.legend.options;return s.labels.map((l,d)=>{let y=i.getDatasetMeta(0).controller.getStyle(d);return{text:l,fillStyle:y.backgroundColor,strokeStyle:y.borderColor,fontColor:o,lineWidth:y.borderWidth,pointStyle:n,hidden:!i.getDataVisibility(d),index:d}})}return[]}},onClick(i,s,n){n.chart.toggleDataVisibility(s.index),n.chart.update()}}}};constructor(i,s){super(i,s),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(i,s){let n=this.getDataset().data,o=this._cachedMeta;if(this._parsing===!1)o._parsed=n;else{let l=y=>+n[y];if(Zt(n[i])){let{key:y="value"}=this._parsing;l=C=>+Ur(n[C],y)}let d,p;for(d=i,p=i+s;d<p;++d)o._parsed[d]=l(d)}}_getRotation(){return Xo(this.options.rotation-90)}_getCircumference(){return Xo(this.options.circumference)}_getRotationExtents(){let i=Ri,s=-Ri;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){let o=this.chart.getDatasetMeta(n).controller,l=o._getRotation(),d=o._getCircumference();i=Math.min(i,l),s=Math.max(s,l+d)}return{rotation:i,circumference:s-i}}update(i){let s=this.chart,{chartArea:n}=s,o=this._cachedMeta,l=o.data,d=this.getMaxBorderWidth()+this.getMaxOffset(l)+this.options.spacing,p=Math.max((Math.min(n.width,n.height)-d)/2,0),y=Math.min(J_(this.options.cutout,p),1),C=this._getRingWeight(this.index),{circumference:S,rotation:P}=this._getRotationExtents(),{ratioX:I,ratioY:O,offsetX:V,offsetY:G}=QI(P,S,y),X=(n.width-d)/I,Q=(n.height-d)/O,ae=Math.max(Math.min(X,Q)/2,0),me=l0(this.options.radius,ae),fe=Math.max(me*y,0),_e=(me-fe)/this._getVisibleDatasetWeightTotal();this.offsetX=V*me,this.offsetY=G*me,o.total=this.calculateTotal(),this.outerRadius=me-_e*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-_e*C,0),this.updateElements(l,0,l.length,i)}_circumference(i,s){let n=this.options,o=this._cachedMeta,l=this._getCircumference();return s&&n.animation.animateRotate||!this.chart.getDataVisibility(i)||o._parsed[i]===null||o.data[i].hidden?0:this.calculateCircumference(o._parsed[i]*l/Ri)}updateElements(i,s,n,o){let l=o==="reset",d=this.chart,p=d.chartArea,C=d.options.animation,S=(p.left+p.right)/2,P=(p.top+p.bottom)/2,I=l&&C.animateScale,O=I?0:this.innerRadius,V=I?0:this.outerRadius,{sharedOptions:G,includeOptions:X}=this._getSharedOptions(s,o),Q=this._getRotation(),ae;for(ae=0;ae<s;++ae)Q+=this._circumference(ae,l);for(ae=s;ae<s+n;++ae){let me=this._circumference(ae,l),fe=i[ae],_e={x:S+this.offsetX,y:P+this.offsetY,startAngle:Q,endAngle:Q+me,circumference:me,outerRadius:V,innerRadius:O};X&&(_e.options=G||this.resolveDataElementOptions(ae,fe.active?"active":o)),Q+=me,this.updateElement(fe,ae,_e,o)}}calculateTotal(){let i=this._cachedMeta,s=i.data,n=0,o;for(o=0;o<s.length;o++){let l=i._parsed[o];l!==null&&!isNaN(l)&&this.chart.getDataVisibility(o)&&!s[o].hidden&&(n+=Math.abs(l))}return n}calculateCircumference(i){let s=this._cachedMeta.total;return s>0&&!isNaN(i)?Ri*(Math.abs(i)/s):0}getLabelAndValue(i){let s=this._cachedMeta,n=this.chart,o=n.data.labels||[],l=Uh(s._parsed[i],n.options.locale);return{label:o[i]||"",value:l}}getMaxBorderWidth(i){let s=0,n=this.chart,o,l,d,p,y;if(!i){for(o=0,l=n.data.datasets.length;o<l;++o)if(n.isDatasetVisible(o)){d=n.getDatasetMeta(o),i=d.data,p=d.controller;break}}if(!i)return 0;for(o=0,l=i.length;o<l;++o)y=p.resolveDataElementOptions(o),y.borderAlign!=="inner"&&(s=Math.max(s,y.borderWidth||0,y.hoverBorderWidth||0));return s}getMaxOffset(i){let s=0;for(let n=0,o=i.length;n<o;++n){let l=this.resolveDataElementOptions(n);s=Math.max(s,l.offset||0,l.hoverOffset||0)}return s}_getRingWeightOffset(i){let s=0;for(let n=0;n<i;++n)this.chart.isDatasetVisible(n)&&(s+=this._getRingWeight(n));return s}_getRingWeight(i){return Math.max(kt(this.chart.data.datasets[i].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}return e})(),JI=(()=>{class e extends Wa{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(i){let s=this._cachedMeta,{dataset:n,data:o=[],_dataset:l}=s,d=this.chart._animationsDisabled,{start:p,count:y}=y0(s,o,d);this._drawStart=p,this._drawCount=y,w0(s)&&(p=0,y=o.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!l._decimated,n.points=o;let C=this.resolveDatasetElementOptions(i);this.options.showLine||(C.borderWidth=0),C.segment=this.options.segment,this.updateElement(n,void 0,{animated:!d,options:C},i),this.updateElements(o,p,y,i)}updateElements(i,s,n,o){let l=o==="reset",{iScale:d,vScale:p,_stacked:y,_dataset:C}=this._cachedMeta,{sharedOptions:S,includeOptions:P}=this._getSharedOptions(s,o),I=d.axis,O=p.axis,{spanGaps:V,segment:G}=this.options,X=Yl(V)?V:Number.POSITIVE_INFINITY,Q=this.chart._animationsDisabled||l||o==="none",ae=s+n,me=i.length,fe=s>0&&this.getParsed(s-1);for(let _e=0;_e<me;++_e){let Ae=i[_e],Oe=Q?Ae:{};if(_e<s||_e>=ae){Oe.skip=!0;continue}let Ge=this.getParsed(_e),it=qt(Ge[O]),Xe=Oe[I]=d.getPixelForValue(Ge[I],_e),lt=Oe[O]=l||it?p.getBasePixel():p.getPixelForValue(y?this.applyStack(p,Ge,y):Ge[O],_e);Oe.skip=isNaN(Xe)||isNaN(lt)||it,Oe.stop=_e>0&&Math.abs(Ge[I]-fe[I])>X,G&&(Oe.parsed=Ge,Oe.raw=C.data[_e]),P&&(Oe.options=S||this.resolveDataElementOptions(_e,Ae.active?"active":o)),Q||this.updateElement(Ae,_e,Oe,o),fe=Ge}}getMaxOverflow(){let i=this._cachedMeta,s=i.dataset,n=s.options&&s.options.borderWidth||0,o=i.data||[];if(!o.length)return n;let l=o[0].size(this.resolveDataElementOptions(0)),d=o[o.length-1].size(this.resolveDataElementOptions(o.length-1));return Math.max(n,l,d)/2}draw(){let i=this._cachedMeta;i.dataset.updateControlPoints(this.chart.chartArea,i.iScale.axis),super.draw()}}return e})(),TS=(()=>{class e extends Wa{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(i){let s=i.data;if(s.labels.length&&s.datasets.length){let{labels:{pointStyle:n,color:o}}=i.legend.options;return s.labels.map((l,d)=>{let y=i.getDatasetMeta(0).controller.getStyle(d);return{text:l,fillStyle:y.backgroundColor,strokeStyle:y.borderColor,fontColor:o,lineWidth:y.borderWidth,pointStyle:n,hidden:!i.getDataVisibility(d),index:d}})}return[]}},onClick(i,s,n){n.chart.toggleDataVisibility(s.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(i,s){super(i,s),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(i){let s=this._cachedMeta,n=this.chart,o=n.data.labels||[],l=Uh(s._parsed[i].r,n.options.locale);return{label:o[i]||"",value:l}}parseObjectData(i,s,n,o){return M0.bind(this)(i,s,n,o)}update(i){let s=this._cachedMeta.data;this._updateRadius(),this.updateElements(s,0,s.length,i)}getMinMax(){let i=this._cachedMeta,s={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return i.data.forEach((n,o)=>{let l=this.getParsed(o).r;!isNaN(l)&&this.chart.getDataVisibility(o)&&(l<s.min&&(s.min=l),l>s.max&&(s.max=l))}),s}_updateRadius(){let i=this.chart,s=i.chartArea,n=i.options,o=Math.min(s.right-s.left,s.bottom-s.top),l=Math.max(o/2,0),d=Math.max(n.cutoutPercentage?l/100*n.cutoutPercentage:1,0),p=(l-d)/i.getVisibleDatasetCount();this.outerRadius=l-p*this.index,this.innerRadius=this.outerRadius-p}updateElements(i,s,n,o){let l=o==="reset",d=this.chart,y=d.options.animation,C=this._cachedMeta.rScale,S=C.xCenter,P=C.yCenter,I=C.getIndexAngle(0)-.5*Qt,O=I,V,G=360/this.countVisibleElements();for(V=0;V<s;++V)O+=this._computeAngle(V,o,G);for(V=s;V<s+n;V++){let X=i[V],Q=O,ae=O+this._computeAngle(V,o,G),me=d.getDataVisibility(V)?C.getDistanceFromCenterForValue(this.getParsed(V).r):0;O=ae,l&&(y.animateScale&&(me=0),y.animateRotate&&(Q=ae=I));let fe={x:S,y:P,innerRadius:0,outerRadius:me,startAngle:Q,endAngle:ae,options:this.resolveDataElementOptions(V,X.active?"active":o)};this.updateElement(X,V,fe,o)}}countVisibleElements(){let i=this._cachedMeta,s=0;return i.data.forEach((n,o)=>{!isNaN(this.getParsed(o).r)&&this.chart.getDataVisibility(o)&&s++}),s}_computeAngle(i,s,n){return this.chart.getDataVisibility(i)?Xo(this.resolveDataElementOptions(i,s).angle||n):0}}return e})(),ek=(()=>{class e extends gw{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}return e})(),tk=(()=>{class e extends Wa{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(i){let s=this._cachedMeta.vScale,n=this.getParsed(i);return{label:s.getLabels()[i],value:""+s.getLabelForValue(n[s.axis])}}parseObjectData(i,s,n,o){return M0.bind(this)(i,s,n,o)}update(i){let s=this._cachedMeta,n=s.dataset,o=s.data||[],l=s.iScale.getLabels();if(n.points=o,i!=="resize"){let d=this.resolveDatasetElementOptions(i);this.options.showLine||(d.borderWidth=0);let p={_loop:!0,_fullLoop:l.length===o.length,options:d};this.updateElement(n,void 0,p,i)}this.updateElements(o,0,o.length,i)}updateElements(i,s,n,o){let l=this._cachedMeta.rScale,d=o==="reset";for(let p=s;p<s+n;p++){let y=i[p],C=this.resolveDataElementOptions(p,y.active?"active":o),S=l.getPointPositionForValue(p,this.getParsed(p).r),P=d?l.xCenter:S.x,I=d?l.yCenter:S.y,O={x:P,y:I,angle:S.angle,skip:isNaN(P)||isNaN(I),options:C};this.updateElement(y,p,O,o)}}}return e})(),ik=(()=>{class e extends Wa{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(i){let s=this._cachedMeta,n=this.chart.data.labels||[],{xScale:o,yScale:l}=s,d=this.getParsed(i),p=o.getLabelForValue(d.x),y=l.getLabelForValue(d.y);return{label:n[i]||"",value:"("+p+", "+y+")"}}update(i){let s=this._cachedMeta,{data:n=[]}=s,o=this.chart._animationsDisabled,{start:l,count:d}=y0(s,n,o);if(this._drawStart=l,this._drawCount=d,w0(s)&&(l=0,d=n.length),this.options.showLine){this.datasetElementType||this.addElements();let{dataset:p,_dataset:y}=s;p._chart=this.chart,p._datasetIndex=this.index,p._decimated=!!y._decimated,p.points=n;let C=this.resolveDatasetElementOptions(i);C.segment=this.options.segment,this.updateElement(p,void 0,{animated:!o,options:C},i)}else this.datasetElementType&&(delete s.dataset,this.datasetElementType=!1);this.updateElements(n,l,d,i)}addElements(){let{showLine:i}=this.options;!this.datasetElementType&&i&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(i,s,n,o){let l=o==="reset",{iScale:d,vScale:p,_stacked:y,_dataset:C}=this._cachedMeta,S=this.resolveDataElementOptions(s,o),P=this.getSharedOptions(S),I=this.includeOptions(o,P),O=d.axis,V=p.axis,{spanGaps:G,segment:X}=this.options,Q=Yl(G)?G:Number.POSITIVE_INFINITY,ae=this.chart._animationsDisabled||l||o==="none",me=s>0&&this.getParsed(s-1);for(let fe=s;fe<s+n;++fe){let _e=i[fe],Ae=this.getParsed(fe),Oe=ae?_e:{},Ge=qt(Ae[V]),it=Oe[O]=d.getPixelForValue(Ae[O],fe),Xe=Oe[V]=l||Ge?p.getBasePixel():p.getPixelForValue(y?this.applyStack(p,Ae,y):Ae[V],fe);Oe.skip=isNaN(it)||isNaN(Xe)||Ge,Oe.stop=fe>0&&Math.abs(Ae[O]-me[O])>Q,X&&(Oe.parsed=Ae,Oe.raw=C.data[fe]),I&&(Oe.options=P||this.resolveDataElementOptions(fe,_e.active?"active":o)),ae||this.updateElement(_e,fe,Oe,o),me=Ae}this.updateSharedOptions(P,o,S)}getMaxOverflow(){let i=this._cachedMeta,s=i.data||[];if(!this.options.showLine){let p=0;for(let y=s.length-1;y>=0;--y)p=Math.max(p,s[y].size(this.resolveDataElementOptions(y))/2);return p>0&&p}let n=i.dataset,o=n.options&&n.options.borderWidth||0;if(!s.length)return o;let l=s[0].size(this.resolveDataElementOptions(0)),d=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(o,l,d)/2}}return e})(),sk=Object.freeze({__proto__:null,BarController:XI,BubbleController:YI,DoughnutController:gw,LineController:JI,PieController:ek,PolarAreaController:TS,RadarController:tk,ScatterController:ik});function Jl(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}var K0=class e{static override(t){Object.assign(e.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return Jl()}parse(){return Jl()}format(){return Jl()}add(){return Jl()}diff(){return Jl()}startOf(){return Jl()}endOf(){return Jl()}},ok={_date:K0};function nk(e,t,i,s){let{controller:n,data:o,_sorted:l}=e,d=n._cachedMeta.iScale,p=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(d&&t===d.axis&&t!=="r"&&l&&o.length){let y=d._reversePixels?n1:Xn;if(s){if(n._sharedOptions){let C=o[0],S=typeof C.getRange=="function"&&C.getRange(t);if(S){let P=y(o,t,i-S),I=y(o,t,i+S);return{lo:P.lo,hi:I.hi}}}}else{let C=y(o,t,i);if(p){let{vScale:S}=n._cachedMeta,{_parsed:P}=e,I=P.slice(0,C.lo+1).reverse().findIndex(V=>!qt(V[S.axis]));C.lo-=Math.max(0,I);let O=P.slice(C.hi).findIndex(V=>!qt(V[S.axis]));C.hi+=Math.max(0,O)}return C}}return{lo:0,hi:o.length-1}}function bp(e,t,i,s,n){let o=e.getSortedVisibleDatasetMetas(),l=i[t];for(let d=0,p=o.length;d<p;++d){let{index:y,data:C}=o[d],{lo:S,hi:P}=nk(o[d],t,l,n);for(let I=S;I<=P;++I){let O=C[I];O.skip||s(O,y,I)}}}function rk(e){let t=e.indexOf("x")!==-1,i=e.indexOf("y")!==-1;return function(s,n){let o=t?Math.abs(s.x-n.x):0,l=i?Math.abs(s.y-n.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(l,2))}}function H0(e,t,i,s,n){let o=[];return!n&&!e.isPointInArea(t)||bp(e,i,t,function(d,p,y){!n&&!Yn(d,e.chartArea,0)||d.inRange(t.x,t.y,s)&&o.push({element:d,datasetIndex:p,index:y})},!0),o}function ak(e,t,i,s){let n=[];function o(l,d,p){let{startAngle:y,endAngle:C}=l.getProps(["startAngle","endAngle"],s),{angle:S}=p0(l,{x:t.x,y:t.y});Wh(S,y,C)&&n.push({element:l,datasetIndex:d,index:p})}return bp(e,i,t,o),n}function lk(e,t,i,s,n,o){let l=[],d=rk(i),p=Number.POSITIVE_INFINITY;function y(C,S,P){let I=C.inRange(t.x,t.y,n);if(s&&!I)return;let O=C.getCenterPoint(n);if(!(!!o||e.isPointInArea(O))&&!I)return;let G=d(t,O);G<p?(l=[{element:C,datasetIndex:S,index:P}],p=G):G===p&&l.push({element:C,datasetIndex:S,index:P})}return bp(e,i,t,y),l}function N0(e,t,i,s,n,o){return!o&&!e.isPointInArea(t)?[]:i==="r"&&!s?ak(e,t,i,n):lk(e,t,i,s,n,o)}function O1(e,t,i,s,n){let o=[],l=i==="x"?"inXRange":"inYRange",d=!1;return bp(e,i,t,(p,y,C)=>{p[l]&&p[l](t[i],n)&&(o.push({element:p,datasetIndex:y,index:C}),d=d||p.inRange(t.x,t.y,n))}),s&&!d?[]:o}var ck={evaluateInteractionItems:bp,modes:{index(e,t,i,s){let n=Na(t,e),o=i.axis||"x",l=i.includeInvisible||!1,d=i.intersect?H0(e,n,o,s,l):N0(e,n,o,!1,s,l),p=[];return d.length?(e.getSortedVisibleDatasetMetas().forEach(y=>{let C=d[0].index,S=y.data[C];S&&!S.skip&&p.push({element:S,datasetIndex:y.index,index:C})}),p):[]},dataset(e,t,i,s){let n=Na(t,e),o=i.axis||"xy",l=i.includeInvisible||!1,d=i.intersect?H0(e,n,o,s,l):N0(e,n,o,!1,s,l);if(d.length>0){let p=d[0].datasetIndex,y=e.getDatasetMeta(p).data;d=[];for(let C=0;C<y.length;++C)d.push({element:y[C],datasetIndex:p,index:C})}return d},point(e,t,i,s){let n=Na(t,e),o=i.axis||"xy",l=i.includeInvisible||!1;return H0(e,n,o,s,l)},nearest(e,t,i,s){let n=Na(t,e),o=i.axis||"xy",l=i.includeInvisible||!1;return N0(e,n,o,i.intersect,s,l)},x(e,t,i,s){let n=Na(t,e);return O1(e,n,"x",i.intersect,s)},y(e,t,i,s){let n=Na(t,e);return O1(e,n,"y",i.intersect,s)}}},DS=["left","top","right","bottom"];function dp(e,t){return e.filter(i=>i.pos===t)}function z1(e,t){return e.filter(i=>DS.indexOf(i.pos)===-1&&i.box.axis===t)}function pp(e,t){return e.sort((i,s)=>{let n=t?s:i,o=t?i:s;return n.weight===o.weight?n.index-o.index:n.weight-o.weight})}function hk(e){let t=[],i,s,n,o,l,d;for(i=0,s=(e||[]).length;i<s;++i)n=e[i],{position:o,options:{stack:l,stackWeight:d=1}}=n,t.push({index:i,box:n,pos:o,horizontal:n.isHorizontal(),weight:n.weight,stack:l&&o+l,stackWeight:d});return t}function uk(e){let t={};for(let i of e){let{stack:s,pos:n,stackWeight:o}=i;if(!s||!DS.includes(n))continue;let l=t[s]||(t[s]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=o}return t}function dk(e,t){let i=uk(e),{vBoxMaxWidth:s,hBoxMaxHeight:n}=t,o,l,d;for(o=0,l=e.length;o<l;++o){d=e[o];let{fullSize:p}=d.box,y=i[d.stack],C=y&&d.stackWeight/y.weight;d.horizontal?(d.width=C?C*s:p&&t.availableWidth,d.height=n):(d.width=s,d.height=C?C*n:p&&t.availableHeight)}return i}function pk(e){let t=hk(e),i=pp(t.filter(y=>y.box.fullSize),!0),s=pp(dp(t,"left"),!0),n=pp(dp(t,"right")),o=pp(dp(t,"top"),!0),l=pp(dp(t,"bottom")),d=z1(t,"x"),p=z1(t,"y");return{fullSize:i,leftAndTop:s.concat(o),rightAndBottom:n.concat(p).concat(l).concat(d),chartArea:dp(t,"chartArea"),vertical:s.concat(n).concat(p),horizontal:o.concat(l).concat(d)}}function B1(e,t,i,s){return Math.max(e[i],t[i])+Math.max(e[s],t[s])}function FS(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function gk(e,t,i,s){let{pos:n,box:o}=i,l=e.maxPadding;if(!Zt(n)){i.size&&(e[n]-=i.size);let S=s[i.stack]||{size:0,count:1};S.size=Math.max(S.size,i.horizontal?o.height:o.width),i.size=S.size/S.count,e[n]+=i.size}o.getPadding&&FS(l,o.getPadding());let d=Math.max(0,t.outerWidth-B1(l,e,"left","right")),p=Math.max(0,t.outerHeight-B1(l,e,"top","bottom")),y=d!==e.w,C=p!==e.h;return e.w=d,e.h=p,i.horizontal?{same:y,other:C}:{same:C,other:y}}function fk(e){let t=e.maxPadding;function i(s){let n=Math.max(t[s]-e[s],0);return e[s]+=n,n}e.y+=i("top"),e.x+=i("left"),i("right"),i("bottom")}function mk(e,t){let i=t.maxPadding;function s(n){let o={left:0,top:0,right:0,bottom:0};return n.forEach(l=>{o[l]=Math.max(t[l],i[l])}),o}return s(e?["left","right"]:["top","bottom"])}function mp(e,t,i,s){let n=[],o,l,d,p,y,C;for(o=0,l=e.length,y=0;o<l;++o){d=e[o],p=d.box,p.update(d.width||t.w,d.height||t.h,mk(d.horizontal,t));let{same:S,other:P}=gk(t,i,d,s);y|=S&&n.length,C=C||P,p.fullSize||n.push(d)}return y&&mp(n,t,i,s)||C}function Kf(e,t,i,s,n){e.top=i,e.left=t,e.right=t+s,e.bottom=i+n,e.width=s,e.height=n}function V1(e,t,i,s){let n=i.padding,{x:o,y:l}=t;for(let d of e){let p=d.box,y=s[d.stack]||{count:1,placed:0,weight:1},C=d.stackWeight/y.weight||1;if(d.horizontal){let S=t.w*C,P=y.size||p.height;Nh(y.start)&&(l=y.start),p.fullSize?Kf(p,n.left,l,i.outerWidth-n.right-n.left,P):Kf(p,t.left+y.placed,l,S,P),y.start=l,y.placed+=S,l=p.bottom}else{let S=t.h*C,P=y.size||p.width;Nh(y.start)&&(o=y.start),p.fullSize?Kf(p,o,n.top,P,i.outerHeight-n.bottom-n.top):Kf(p,o,t.top+y.placed,P,S),y.start=o,y.placed+=S,o=p.right}}t.x=o,t.y=l}var qs={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(i){t.draw(i)}}]},e.boxes.push(t)},removeBox(e,t){let i=e.boxes?e.boxes.indexOf(t):-1;i!==-1&&e.boxes.splice(i,1)},configure(e,t,i){t.fullSize=i.fullSize,t.position=i.position,t.weight=i.weight},update(e,t,i,s){if(!e)return;let n=Bs(e.options.layout.padding),o=Math.max(t-n.width,0),l=Math.max(i-n.height,0),d=pk(e.boxes),p=d.vertical,y=d.horizontal;ai(e.boxes,V=>{typeof V.beforeLayout=="function"&&V.beforeLayout()});let C=p.reduce((V,G)=>G.box.options&&G.box.options.display===!1?V:V+1,0)||1,S=Object.freeze({outerWidth:t,outerHeight:i,padding:n,availableWidth:o,availableHeight:l,vBoxMaxWidth:o/2/C,hBoxMaxHeight:l/2}),P=Object.assign({},n);FS(P,Bs(s));let I=Object.assign({maxPadding:P,w:o,h:l,x:n.left,y:n.top},n),O=dk(p.concat(y),S);mp(d.fullSize,I,S,O),mp(p,I,S,O),mp(y,I,S,O)&&mp(p,I,S,O),fk(I),V1(d.leftAndTop,I,S,O),I.x+=I.w,I.y+=I.h,V1(d.rightAndBottom,I,S,O),e.chartArea={left:I.left,top:I.top,right:I.left+I.w,bottom:I.top+I.h,height:I.h,width:I.w},ai(d.chartArea,V=>{let G=V.box;Object.assign(G,e.chartArea),G.update(I.w,I.h,{left:0,top:0,right:0,bottom:0})})}},om=class{acquireContext(t,i){}releaseContext(t){return!1}addEventListener(t,i,s){}removeEventListener(t,i,s){}getDevicePixelRatio(){return 1}getMaximumSize(t,i,s,n){return i=Math.max(0,i||t.width),s=s||t.height,{width:i,height:Math.max(0,n?Math.floor(i/n):s)}}isAttached(t){return!0}updateConfig(t){}},X0=class extends om{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}},tm="$chartjs",vk={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},H1=e=>e===null||e==="";function yk(e,t){let i=e.style,s=e.getAttribute("height"),n=e.getAttribute("width");if(e[tm]={initial:{height:s,width:n,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",H1(n)){let o=D0(e,"width");o!==void 0&&(e.width=o)}if(H1(s))if(e.style.height==="")e.height=e.width/(t||2);else{let o=D0(e,"height");o!==void 0&&(e.height=o)}return e}var IS=x1?{passive:!0}:!1;function wk(e,t,i){e&&e.addEventListener(t,i,IS)}function Ck(e,t,i){e&&e.canvas&&e.canvas.removeEventListener(t,i,IS)}function bk(e,t){let i=vk[e.type]||e.type,{x:s,y:n}=Na(e,t);return{type:i,chart:t,native:e,x:s!==void 0?s:null,y:n!==void 0?n:null}}function nm(e,t){for(let i of e)if(i===t||i.contains(t))return!0}function xk(e,t,i){let s=e.canvas,n=new MutationObserver(o=>{let l=!1;for(let d of o)l=l||nm(d.addedNodes,s),l=l&&!nm(d.removedNodes,s);l&&i()});return n.observe(document,{childList:!0,subtree:!0}),n}function _k(e,t,i){let s=e.canvas,n=new MutationObserver(o=>{let l=!1;for(let d of o)l=l||nm(d.removedNodes,s),l=l&&!nm(d.addedNodes,s);l&&i()});return n.observe(document,{childList:!0,subtree:!0}),n}var yp=new Map,N1=0;function kS(){let e=window.devicePixelRatio;e!==N1&&(N1=e,yp.forEach((t,i)=>{i.currentDevicePixelRatio!==e&&t()}))}function Sk(e,t){yp.size||window.addEventListener("resize",kS),yp.set(e,t)}function Rk(e){yp.delete(e),yp.size||window.removeEventListener("resize",kS)}function Ek(e,t,i){let s=e.canvas,n=s&&qf(s);if(!n)return;let o=v0((d,p)=>{let y=n.clientWidth;i(d,p),y<n.clientWidth&&i()},window),l=new ResizeObserver(d=>{let p=d[0],y=p.contentRect.width,C=p.contentRect.height;y===0&&C===0||o(y,C)});return l.observe(n),Sk(e,o),l}function G0(e,t,i){i&&i.disconnect(),t==="resize"&&Rk(e)}function Pk(e,t,i){let s=e.canvas,n=v0(o=>{e.ctx!==null&&i(bk(o,e))},e);return wk(s,t,n),n}var Y0=class extends om{acquireContext(t,i){let s=t&&t.getContext&&t.getContext("2d");return s&&s.canvas===t?(yk(t,i),s):null}releaseContext(t){let i=t.canvas;if(!i[tm])return!1;let s=i[tm].initial;["height","width"].forEach(o=>{let l=s[o];qt(l)?i.removeAttribute(o):i.setAttribute(o,l)});let n=s.style||{};return Object.keys(n).forEach(o=>{i.style[o]=n[o]}),i.width=i.width,delete i[tm],!0}addEventListener(t,i,s){this.removeEventListener(t,i);let n=t.$proxies||(t.$proxies={}),l={attach:xk,detach:_k,resize:Ek}[i]||Pk;n[i]=l(t,i,s)}removeEventListener(t,i){let s=t.$proxies||(t.$proxies={}),n=s[i];if(!n)return;({attach:G0,detach:G0,resize:G0}[i]||Ck)(t,i,n),s[i]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,i,s,n){return b1(t,i,s,n)}isAttached(t){let i=t&&qf(t);return!!(i&&i.isConnected)}};function Mk(e){return!$f()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?X0:Y0}var Cn=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){let{x:i,y:s}=this.getProps(["x","y"],t);return{x:i,y:s}}hasValue(){return Yl(this.x)&&Yl(this.y)}getProps(t,i){let s=this.$animations;if(!i||!s)return this;let n={};return t.forEach(o=>{n[o]=s[o]&&s[o].active()?s[o]._to:this[o]}),n}};function Tk(e,t){let i=e.options.ticks,s=Dk(e),n=Math.min(i.maxTicksLimit||s,s),o=i.major.enabled?Ik(t):[],l=o.length,d=o[0],p=o[l-1],y=[];if(l>n)return kk(t,y,o,l/n),y;let C=Fk(o,t,n);if(l>0){let S,P,I=l>1?Math.round((p-d)/(l-1)):null;for(Xf(t,y,C,qt(I)?0:d-I,d),S=0,P=l-1;S<P;S++)Xf(t,y,C,o[S],o[S+1]);return Xf(t,y,C,p,qt(I)?t.length:p+I),y}return Xf(t,y,C),y}function Dk(e){let t=e.options.offset,i=e._tickSize(),s=e._length/i+(t?0:1),n=e._maxLength/i;return Math.floor(Math.min(s,n))}function Fk(e,t,i){let s=Ak(e),n=t.length/i;if(!s)return Math.max(n,1);let o=i1(s);for(let l=0,d=o.length-1;l<d;l++){let p=o[l];if(p>n)return p}return Math.max(n,1)}function Ik(e){let t=[],i,s;for(i=0,s=e.length;i<s;i++)e[i].major&&t.push(i);return t}function kk(e,t,i,s){let n=0,o=i[0],l;for(s=Math.ceil(s),l=0;l<e.length;l++)l===o&&(t.push(e[l]),n++,o=i[n*s])}function Xf(e,t,i,s,n){let o=kt(s,0),l=Math.min(kt(n,e.length),e.length),d=0,p,y,C;for(i=Math.ceil(i),n&&(p=n-s,i=p/Math.floor(p/i)),C=o;C<0;)d++,C=Math.round(o+d*i);for(y=Math.max(o,0);y<l;y++)y===C&&(t.push(e[y]),d++,C=Math.round(o+d*i))}function Ak(e){let t=e.length,i,s;if(t<2)return!1;for(s=e[0],i=1;i<t;++i)if(e[i]-e[i-1]!==s)return!1;return s}var Lk=e=>e==="left"?"right":e==="right"?"left":e,G1=(e,t,i)=>t==="top"||t==="left"?e[t]+i:e[t]-i,W1=(e,t)=>Math.min(t||e,e);function U1(e,t){let i=[],s=e.length/t,n=e.length,o=0;for(;o<n;o+=s)i.push(e[Math.floor(o)]);return i}function Ok(e,t,i){let s=e.ticks.length,n=Math.min(t,s-1),o=e._startPixel,l=e._endPixel,d=1e-6,p=e.getPixelForTick(n),y;if(!(i&&(s===1?y=Math.max(p-o,l-p):t===0?y=(e.getPixelForTick(1)-p)/2:y=(p-e.getPixelForTick(n-1))/2,p+=n<t?y:-y,p<o-d||p>l+d)))return p}function zk(e,t){ai(e,i=>{let s=i.gc,n=s.length/2,o;if(n>t){for(o=0;o<n;++o)delete i.data[s[o]];s.splice(0,n)}})}function gp(e){return e.drawTicks?e.tickLength:0}function j1(e,t){if(!e.display)return 0;let i=gs(e.font,t),s=Bs(e.padding);return(Si(e.text)?e.text.length:1)*i.lineHeight+s.height}function Bk(e,t){return jr(e,{scale:t,type:"scale"})}function Vk(e,t,i){return jr(e,{tick:i,index:t,type:"tick"})}function Hk(e,t,i){let s=Nf(e);return(i&&t!=="right"||!i&&t==="right")&&(s=Lk(s)),s}function Nk(e,t,i,s){let{top:n,left:o,bottom:l,right:d,chart:p}=e,{chartArea:y,scales:C}=p,S=0,P,I,O,V=l-n,G=d-o;if(e.isHorizontal()){if(I=zs(s,o,d),Zt(i)){let X=Object.keys(i)[0],Q=i[X];O=C[X].getPixelForValue(Q)+V-t}else i==="center"?O=(y.bottom+y.top)/2+V-t:O=G1(e,i,t);P=d-o}else{if(Zt(i)){let X=Object.keys(i)[0],Q=i[X];I=C[X].getPixelForValue(Q)-G+t}else i==="center"?I=(y.left+y.right)/2-G+t:I=G1(e,i,t);O=zs(s,l,n),S=i==="left"?-Yi:Yi}return{titleX:I,titleY:O,maxWidth:P,rotation:S}}var tc=class e extends Cn{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,i){return t}getUserBounds(){let{_userMin:t,_userMax:i,_suggestedMin:s,_suggestedMax:n}=this;return t=po(t,Number.POSITIVE_INFINITY),i=po(i,Number.NEGATIVE_INFINITY),s=po(s,Number.POSITIVE_INFINITY),n=po(n,Number.NEGATIVE_INFINITY),{min:po(t,s),max:po(i,n),minDefined:Wi(t),maxDefined:Wi(i)}}getMinMax(t){let{min:i,max:s,minDefined:n,maxDefined:o}=this.getUserBounds(),l;if(n&&o)return{min:i,max:s};let d=this.getMatchingVisibleMetas();for(let p=0,y=d.length;p<y;++p)l=d[p].controller.getMinMax(this,t),n||(i=Math.min(i,l.min)),o||(s=Math.max(s,l.max));return i=o&&i>s?s:i,s=n&&i>s?i:s,{min:po(i,po(s,i)),max:po(s,po(i,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){let t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){bi(this.options.beforeUpdate,[this])}update(t,i,s){let{beginAtZero:n,grace:o,ticks:l}=this.options,d=l.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=i,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=f1(this,o,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();let p=d<this.ticks.length;this._convertTicksToLabels(p?U1(this.ticks,d):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||l.source==="auto")&&(this.ticks=Tk(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),p&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,i,s;this.isHorizontal()?(i=this.left,s=this.right):(i=this.top,s=this.bottom,t=!t),this._startPixel=i,this._endPixel=s,this._reversePixels=t,this._length=s-i,this._alignToPixels=this.options.alignToPixels}afterUpdate(){bi(this.options.afterUpdate,[this])}beforeSetDimensions(){bi(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){bi(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),bi(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){bi(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){let i=this.options.ticks,s,n,o;for(s=0,n=t.length;s<n;s++)o=t[s],o.label=bi(i.callback,[o.value,s,t],this)}afterTickToLabelConversion(){bi(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){bi(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){let t=this.options,i=t.ticks,s=W1(this.ticks.length,t.ticks.maxTicksLimit),n=i.minRotation||0,o=i.maxRotation,l=n,d,p,y;if(!this._isVisible()||!i.display||n>=o||s<=1||!this.isHorizontal()){this.labelRotation=n;return}let C=this._getLabelSizes(),S=C.widest.width,P=C.highest.height,I=Cs(this.chart.width-S,0,this.maxWidth);d=t.offset?this.maxWidth/s:I/(s-1),S+6>d&&(d=I/(s-(t.offset?.5:1)),p=this.maxHeight-gp(t.grid)-i.padding-j1(t.title,this.chart.options.font),y=Math.sqrt(S*S+P*P),l=Vf(Math.min(Math.asin(Cs((C.highest.height+6)/d,-1,1)),Math.asin(Cs(p/y,-1,1))-Math.asin(Cs(P/y,-1,1)))),l=Math.max(n,Math.min(o,l))),this.labelRotation=l}afterCalculateLabelRotation(){bi(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){bi(this.options.beforeFit,[this])}fit(){let t={width:0,height:0},{chart:i,options:{ticks:s,title:n,grid:o}}=this,l=this._isVisible(),d=this.isHorizontal();if(l){let p=j1(n,i.options.font);if(d?(t.width=this.maxWidth,t.height=gp(o)+p):(t.height=this.maxHeight,t.width=gp(o)+p),s.display&&this.ticks.length){let{first:y,last:C,widest:S,highest:P}=this._getLabelSizes(),I=s.padding*2,O=Xo(this.labelRotation),V=Math.cos(O),G=Math.sin(O);if(d){let X=s.mirror?0:G*S.width+V*P.height;t.height=Math.min(this.maxHeight,t.height+X+I)}else{let X=s.mirror?0:V*S.width+G*P.height;t.width=Math.min(this.maxWidth,t.width+X+I)}this._calculatePadding(y,C,G,V)}}this._handleMargins(),d?(this.width=this._length=i.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=i.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,i,s,n){let{ticks:{align:o,padding:l},position:d}=this.options,p=this.labelRotation!==0,y=d!=="top"&&this.axis==="x";if(this.isHorizontal()){let C=this.getPixelForTick(0)-this.left,S=this.right-this.getPixelForTick(this.ticks.length-1),P=0,I=0;p?y?(P=n*t.width,I=s*i.height):(P=s*t.height,I=n*i.width):o==="start"?I=i.width:o==="end"?P=t.width:o!=="inner"&&(P=t.width/2,I=i.width/2),this.paddingLeft=Math.max((P-C+l)*this.width/(this.width-C),0),this.paddingRight=Math.max((I-S+l)*this.width/(this.width-S),0)}else{let C=i.height/2,S=t.height/2;o==="start"?(C=0,S=t.height):o==="end"&&(C=i.height,S=0),this.paddingTop=C+l,this.paddingBottom=S+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){bi(this.options.afterFit,[this])}isHorizontal(){let{axis:t,position:i}=this.options;return i==="top"||i==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let i,s;for(i=0,s=t.length;i<s;i++)qt(t[i].label)&&(t.splice(i,1),s--,i--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){let i=this.options.ticks.sampleSize,s=this.ticks;i<s.length&&(s=U1(s,i)),this._labelSizes=t=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,i,s){let{ctx:n,_longestTextCache:o}=this,l=[],d=[],p=Math.floor(i/W1(i,s)),y=0,C=0,S,P,I,O,V,G,X,Q,ae,me,fe;for(S=0;S<i;S+=p){if(O=t[S].label,V=this._resolveTickFontOptions(S),n.font=G=V.string,X=o[G]=o[G]||{data:{},gc:[]},Q=V.lineHeight,ae=me=0,!qt(O)&&!Si(O))ae=rp(n,X.data,X.gc,ae,O),me=Q;else if(Si(O))for(P=0,I=O.length;P<I;++P)fe=O[P],!qt(fe)&&!Si(fe)&&(ae=rp(n,X.data,X.gc,ae,fe),me+=Q);l.push(ae),d.push(me),y=Math.max(ae,y),C=Math.max(me,C)}zk(o,i);let _e=l.indexOf(y),Ae=d.indexOf(C),Oe=Ge=>({width:l[Ge]||0,height:d[Ge]||0});return{first:Oe(0),last:Oe(i-1),widest:Oe(_e),highest:Oe(Ae),widths:l,heights:d}}getLabelForValue(t){return t}getPixelForValue(t,i){return NaN}getValueForPixel(t){}getPixelForTick(t){let i=this.ticks;return t<0||t>i.length-1?null:this.getPixelForValue(i[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);let i=this._startPixel+t*this._length;return o1(this._alignToPixels?Ba(this.chart,i,0):i)}getDecimalForPixel(t){let i=(t-this._startPixel)/this._length;return this._reversePixels?1-i:i}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){let{min:t,max:i}=this;return t<0&&i<0?i:t>0&&i>0?t:0}getContext(t){let i=this.ticks||[];if(t>=0&&t<i.length){let s=i[t];return s.$context||(s.$context=Vk(this.getContext(),t,s))}return this.$context||(this.$context=Bk(this.chart.getContext(),this))}_tickSize(){let t=this.options.ticks,i=Xo(this.labelRotation),s=Math.abs(Math.cos(i)),n=Math.abs(Math.sin(i)),o=this._getLabelSizes(),l=t.autoSkipPadding||0,d=o?o.widest.width+l:0,p=o?o.highest.height+l:0;return this.isHorizontal()?p*s>d*n?d/s:p/n:p*n<d*s?p/s:d/n}_isVisible(){let t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){let i=this.axis,s=this.chart,n=this.options,{grid:o,position:l,border:d}=n,p=o.offset,y=this.isHorizontal(),S=this.ticks.length+(p?1:0),P=gp(o),I=[],O=d.setContext(this.getContext()),V=O.display?O.width:0,G=V/2,X=function(Yt){return Ba(s,Yt,V)},Q,ae,me,fe,_e,Ae,Oe,Ge,it,Xe,lt,St;if(l==="top")Q=X(this.bottom),Ae=this.bottom-P,Ge=Q-G,Xe=X(t.top)+G,St=t.bottom;else if(l==="bottom")Q=X(this.top),Xe=t.top,St=X(t.bottom)-G,Ae=Q+G,Ge=this.top+P;else if(l==="left")Q=X(this.right),_e=this.right-P,Oe=Q-G,it=X(t.left)+G,lt=t.right;else if(l==="right")Q=X(this.left),it=t.left,lt=X(t.right)-G,_e=Q+G,Oe=this.left+P;else if(i==="x"){if(l==="center")Q=X((t.top+t.bottom)/2+.5);else if(Zt(l)){let Yt=Object.keys(l)[0],Ct=l[Yt];Q=X(this.chart.scales[Yt].getPixelForValue(Ct))}Xe=t.top,St=t.bottom,Ae=Q+G,Ge=Ae+P}else if(i==="y"){if(l==="center")Q=X((t.left+t.right)/2);else if(Zt(l)){let Yt=Object.keys(l)[0],Ct=l[Yt];Q=X(this.chart.scales[Yt].getPixelForValue(Ct))}_e=Q-G,Oe=_e-P,it=t.left,lt=t.right}let Gt=kt(n.ticks.maxTicksLimit,S),xt=Math.max(1,Math.ceil(S/Gt));for(ae=0;ae<S;ae+=xt){let Yt=this.getContext(ae),Ct=o.setContext(Yt),Fi=d.setContext(Yt),jt=Ct.lineWidth,Jt=Ct.color,Bi=Fi.dash||[],Qi=Fi.dashOffset,ji=Ct.tickWidth,fi=Ct.tickColor,ro=Ct.tickBorderDash||[],$i=Ct.tickBorderDashOffset;me=Ok(this,ae,p),me!==void 0&&(fe=Ba(s,me,jt),y?_e=Oe=it=lt=fe:Ae=Ge=Xe=St=fe,I.push({tx1:_e,ty1:Ae,tx2:Oe,ty2:Ge,x1:it,y1:Xe,x2:lt,y2:St,width:jt,color:Jt,borderDash:Bi,borderDashOffset:Qi,tickWidth:ji,tickColor:fi,tickBorderDash:ro,tickBorderDashOffset:$i}))}return this._ticksLength=S,this._borderValue=Q,I}_computeLabelItems(t){let i=this.axis,s=this.options,{position:n,ticks:o}=s,l=this.isHorizontal(),d=this.ticks,{align:p,crossAlign:y,padding:C,mirror:S}=o,P=gp(s.grid),I=P+C,O=S?-C:I,V=-Xo(this.labelRotation),G=[],X,Q,ae,me,fe,_e,Ae,Oe,Ge,it,Xe,lt,St="middle";if(n==="top")_e=this.bottom-O,Ae=this._getXAxisLabelAlignment();else if(n==="bottom")_e=this.top+O,Ae=this._getXAxisLabelAlignment();else if(n==="left"){let xt=this._getYAxisLabelAlignment(P);Ae=xt.textAlign,fe=xt.x}else if(n==="right"){let xt=this._getYAxisLabelAlignment(P);Ae=xt.textAlign,fe=xt.x}else if(i==="x"){if(n==="center")_e=(t.top+t.bottom)/2+I;else if(Zt(n)){let xt=Object.keys(n)[0],Yt=n[xt];_e=this.chart.scales[xt].getPixelForValue(Yt)+I}Ae=this._getXAxisLabelAlignment()}else if(i==="y"){if(n==="center")fe=(t.left+t.right)/2-I;else if(Zt(n)){let xt=Object.keys(n)[0],Yt=n[xt];fe=this.chart.scales[xt].getPixelForValue(Yt)}Ae=this._getYAxisLabelAlignment(P).textAlign}i==="y"&&(p==="start"?St="top":p==="end"&&(St="bottom"));let Gt=this._getLabelSizes();for(X=0,Q=d.length;X<Q;++X){ae=d[X],me=ae.label;let xt=o.setContext(this.getContext(X));Oe=this.getPixelForTick(X)+o.labelOffset,Ge=this._resolveTickFontOptions(X),it=Ge.lineHeight,Xe=Si(me)?me.length:1;let Yt=Xe/2,Ct=xt.color,Fi=xt.textStrokeColor,jt=xt.textStrokeWidth,Jt=Ae;l?(fe=Oe,Ae==="inner"&&(X===Q-1?Jt=this.options.reverse?"left":"right":X===0?Jt=this.options.reverse?"right":"left":Jt="center"),n==="top"?y==="near"||V!==0?lt=-Xe*it+it/2:y==="center"?lt=-Gt.highest.height/2-Yt*it+it:lt=-Gt.highest.height+it/2:y==="near"||V!==0?lt=it/2:y==="center"?lt=Gt.highest.height/2-Yt*it:lt=Gt.highest.height-Xe*it,S&&(lt*=-1),V!==0&&!xt.showLabelBackdrop&&(fe+=it/2*Math.sin(V))):(_e=Oe,lt=(1-Xe)*it/2);let Bi;if(xt.showLabelBackdrop){let Qi=Bs(xt.backdropPadding),ji=Gt.heights[X],fi=Gt.widths[X],ro=lt-Qi.top,$i=0-Qi.left;switch(St){case"middle":ro-=ji/2;break;case"bottom":ro-=ji;break}switch(Ae){case"center":$i-=fi/2;break;case"right":$i-=fi;break;case"inner":X===Q-1?$i-=fi:X>0&&($i-=fi/2);break}Bi={left:$i,top:ro,width:fi+Qi.width,height:ji+Qi.height,color:xt.backdropColor}}G.push({label:me,font:Ge,textOffset:lt,options:{rotation:V,color:Ct,strokeColor:Fi,strokeWidth:jt,textAlign:Jt,textBaseline:St,translation:[fe,_e],backdrop:Bi}})}return G}_getXAxisLabelAlignment(){let{position:t,ticks:i}=this.options;if(-Xo(this.labelRotation))return t==="top"?"left":"right";let n="center";return i.align==="start"?n="left":i.align==="end"?n="right":i.align==="inner"&&(n="inner"),n}_getYAxisLabelAlignment(t){let{position:i,ticks:{crossAlign:s,mirror:n,padding:o}}=this.options,l=this._getLabelSizes(),d=t+o,p=l.widest.width,y,C;return i==="left"?n?(C=this.right+o,s==="near"?y="left":s==="center"?(y="center",C+=p/2):(y="right",C+=p)):(C=this.right-d,s==="near"?y="right":s==="center"?(y="center",C-=p/2):(y="left",C=this.left)):i==="right"?n?(C=this.left+o,s==="near"?y="right":s==="center"?(y="center",C-=p/2):(y="left",C-=p)):(C=this.left+d,s==="near"?y="left":s==="center"?(y="center",C+=p/2):(y="right",C=this.right)):y="right",{textAlign:y,x:C}}_computeLabelArea(){if(this.options.ticks.mirror)return;let t=this.chart,i=this.options.position;if(i==="left"||i==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(i==="top"||i==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){let{ctx:t,options:{backgroundColor:i},left:s,top:n,width:o,height:l}=this;i&&(t.save(),t.fillStyle=i,t.fillRect(s,n,o,l),t.restore())}getLineWidthForValue(t){let i=this.options.grid;if(!this._isVisible()||!i.display)return 0;let n=this.ticks.findIndex(o=>o.value===t);return n>=0?i.setContext(this.getContext(n)).lineWidth:0}drawGrid(t){let i=this.options.grid,s=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t)),o,l,d=(p,y,C)=>{!C.width||!C.color||(s.save(),s.lineWidth=C.width,s.strokeStyle=C.color,s.setLineDash(C.borderDash||[]),s.lineDashOffset=C.borderDashOffset,s.beginPath(),s.moveTo(p.x,p.y),s.lineTo(y.x,y.y),s.stroke(),s.restore())};if(i.display)for(o=0,l=n.length;o<l;++o){let p=n[o];i.drawOnChartArea&&d({x:p.x1,y:p.y1},{x:p.x2,y:p.y2},p),i.drawTicks&&d({x:p.tx1,y:p.ty1},{x:p.tx2,y:p.ty2},{color:p.tickColor,width:p.tickWidth,borderDash:p.tickBorderDash,borderDashOffset:p.tickBorderDashOffset})}}drawBorder(){let{chart:t,ctx:i,options:{border:s,grid:n}}=this,o=s.setContext(this.getContext()),l=s.display?o.width:0;if(!l)return;let d=n.setContext(this.getContext(0)).lineWidth,p=this._borderValue,y,C,S,P;this.isHorizontal()?(y=Ba(t,this.left,l)-l/2,C=Ba(t,this.right,d)+d/2,S=P=p):(S=Ba(t,this.top,l)-l/2,P=Ba(t,this.bottom,d)+d/2,y=C=p),i.save(),i.lineWidth=o.width,i.strokeStyle=o.color,i.beginPath(),i.moveTo(y,S),i.lineTo(C,P),i.stroke(),i.restore()}drawLabels(t){if(!this.options.ticks.display)return;let s=this.ctx,n=this._computeLabelArea();n&&cp(s,n);let o=this.getLabelItems(t);for(let l of o){let d=l.options,p=l.font,y=l.label,C=l.textOffset;Va(s,y,0,C,p,d)}n&&hp(s)}drawTitle(){let{ctx:t,options:{position:i,title:s,reverse:n}}=this;if(!s.display)return;let o=gs(s.font),l=Bs(s.padding),d=s.align,p=o.lineHeight/2;i==="bottom"||i==="center"||Zt(i)?(p+=l.bottom,Si(s.text)&&(p+=o.lineHeight*(s.text.length-1))):p+=l.top;let{titleX:y,titleY:C,maxWidth:S,rotation:P}=Nk(this,p,i,d);Va(t,s.text,0,0,o,{color:s.color,maxWidth:S,rotation:P,textAlign:Hk(d,i,n),textBaseline:"middle",translation:[y,C]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){let t=this.options,i=t.ticks&&t.ticks.z||0,s=kt(t.grid&&t.grid.z,-1),n=kt(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==e.prototype.draw?[{z:i,draw:o=>{this.draw(o)}}]:[{z:s,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:i,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(t){let i=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",n=[],o,l;for(o=0,l=i.length;o<l;++o){let d=i[o];d[s]===this.id&&(!t||d.type===t)&&n.push(d)}return n}_resolveTickFontOptions(t){let i=this.options.ticks.setContext(this.getContext(t));return gs(i.font)}_maxDigits(){let t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}},Zh=class{constructor(t,i,s){this.type=t,this.scope=i,this.override=s,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){let i=Object.getPrototypeOf(t),s;Uk(i)&&(s=this.register(i));let n=this.items,o=t.id,l=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+t);return o in n||(n[o]=t,Gk(t,l,s),this.override&&xi.override(t.id,t.overrides)),l}get(t){return this.items[t]}unregister(t){let i=this.items,s=t.id,n=this.scope;s in i&&delete i[s],n&&s in xi[n]&&(delete xi[n][s],this.override&&delete za[s])}};function Gk(e,t,i){let s=Bh(Object.create(null),[i?xi.get(i):{},xi.get(t),e.defaults]);xi.set(t,s),e.defaultRoutes&&Wk(t,e.defaultRoutes),e.descriptors&&xi.describe(t,e.descriptors)}function Wk(e,t){Object.keys(t).forEach(i=>{let s=i.split("."),n=s.pop(),o=[e].concat(s).join("."),l=t[i].split("."),d=l.pop(),p=l.join(".");xi.route(o,n,p,d)})}function Uk(e){return"id"in e&&"defaults"in e}var Q0=class{constructor(){this.controllers=new Zh(Wa,"datasets",!0),this.elements=new Zh(Cn,"elements"),this.plugins=new Zh(Object,"plugins"),this.scales=new Zh(tc,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,i,s){[...i].forEach(n=>{let o=s||this._getRegistryForType(n);s||o.isForType(n)||o===this.plugins&&n.id?this._exec(t,o,n):ai(n,l=>{let d=s||this._getRegistryForType(l);this._exec(t,d,l)})})}_exec(t,i,s){let n=Bf(t);bi(s["before"+n],[],s),i[t](s),bi(s["after"+n],[],s)}_getRegistryForType(t){for(let i=0;i<this._typedRegistries.length;i++){let s=this._typedRegistries[i];if(s.isForType(t))return s}return this.plugins}_get(t,i,s){let n=i.get(t);if(n===void 0)throw new Error('"'+t+'" is not a registered '+s+".");return n}},tr=new Q0,J0=class{constructor(){this._init=[]}notify(t,i,s,n){i==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));let o=n?this._descriptors(t).filter(n):this._descriptors(t),l=this._notify(o,t,i,s);return i==="afterDestroy"&&(this._notify(o,t,"stop"),this._notify(this._init,t,"uninstall")),l}_notify(t,i,s,n){n=n||{};for(let o of t){let l=o.plugin,d=l[s],p=[i,n,o.options];if(bi(d,p,l)===!1&&n.cancelable)return!1}return!0}invalidate(){qt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;let i=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),i}_createDescriptors(t,i){let s=t&&t.config,n=kt(s.options&&s.options.plugins,{}),o=jk(s);return n===!1&&!i?[]:qk(t,o,n,i)}_notifyStateChanges(t){let i=this._oldCache||[],s=this._cache,n=(o,l)=>o.filter(d=>!l.some(p=>d.plugin.id===p.plugin.id));this._notify(n(i,s),t,"stop"),this._notify(n(s,i),t,"start")}};function jk(e){let t={},i=[],s=Object.keys(tr.plugins.items);for(let o=0;o<s.length;o++)i.push(tr.getPlugin(s[o]));let n=e.plugins||[];for(let o=0;o<n.length;o++){let l=n[o];i.indexOf(l)===-1&&(i.push(l),t[l.id]=!0)}return{plugins:i,localIds:t}}function $k(e,t){return!t&&e===!1?null:e===!0?{}:e}function qk(e,{plugins:t,localIds:i},s,n){let o=[],l=e.getContext();for(let d of t){let p=d.id,y=$k(s[p],n);y!==null&&o.push({plugin:d,options:Zk(e.config,{plugin:d,local:i[p]},y,l)})}return o}function Zk(e,{plugin:t,local:i},s,n){let o=e.pluginScopeKeys(t),l=e.getOptionScopes(s,o);return i&&t.defaults&&l.push(t.defaults),e.createResolver(l,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function ew(e,t){let i=xi.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||i.indexAxis||"x"}function Kk(e,t){let i=e;return e==="_index_"?i=t:e==="_value_"&&(i=t==="x"?"y":"x"),i}function Xk(e,t){return e===t?"_index_":"_value_"}function $1(e){if(e==="x"||e==="y"||e==="r")return e}function Yk(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function tw(e,...t){if($1(e))return e;for(let i of t){let s=i.axis||Yk(i.position)||e.length>1&&$1(e[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function q1(e,t,i){if(i[t+"AxisID"]===e)return{axis:t}}function Qk(e,t){if(t.data&&t.data.datasets){let i=t.data.datasets.filter(s=>s.xAxisID===e||s.yAxisID===e);if(i.length)return q1(e,"x",i[0])||q1(e,"y",i[0])}return{}}function Jk(e,t){let i=za[e.type]||{scales:{}},s=t.scales||{},n=ew(e.type,t),o=Object.create(null);return Object.keys(s).forEach(l=>{let d=s[l];if(!Zt(d))return console.error(`Invalid scale configuration for scale: ${l}`);if(d._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${l}`);let p=tw(l,d,Qk(l,e),xi.scales[d.type]),y=Xk(p,n),C=i.scales||{};o[l]=Hh(Object.create(null),[{axis:p},d,C[p],C[y]])}),e.data.datasets.forEach(l=>{let d=l.type||e.type,p=l.indexAxis||ew(d,t),C=(za[d]||{}).scales||{};Object.keys(C).forEach(S=>{let P=Kk(S,p),I=l[P+"AxisID"]||P;o[I]=o[I]||Object.create(null),Hh(o[I],[{axis:P},s[I],C[S]])})}),Object.keys(o).forEach(l=>{let d=o[l];Hh(d,[xi.scales[d.type],xi.scale])}),o}function AS(e){let t=e.options||(e.options={});t.plugins=kt(t.plugins,{}),t.scales=Jk(e,t)}function LS(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function eA(e){return e=e||{},e.data=LS(e.data),AS(e),e}var Z1=new Map,OS=new Set;function Yf(e,t){let i=Z1.get(e);return i||(i=t(),Z1.set(e,i),OS.add(i)),i}var fp=(e,t,i)=>{let s=Ur(t,i);s!==void 0&&e.add(s)},iw=class{constructor(t){this._config=eA(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=LS(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){let t=this._config;this.clearCache(),AS(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Yf(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,i){return Yf(`${t}.transition.${i}`,()=>[[`datasets.${t}.transitions.${i}`,`transitions.${i}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,i){return Yf(`${t}-${i}`,()=>[[`datasets.${t}.elements.${i}`,`datasets.${t}`,`elements.${i}`,""]])}pluginScopeKeys(t){let i=t.id,s=this.type;return Yf(`${s}-plugin-${i}`,()=>[[`plugins.${i}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,i){let s=this._scopeCache,n=s.get(t);return(!n||i)&&(n=new Map,s.set(t,n)),n}getOptionScopes(t,i,s){let{options:n,type:o}=this,l=this._cachedScopes(t,s),d=l.get(i);if(d)return d;let p=new Set;i.forEach(C=>{t&&(p.add(t),C.forEach(S=>fp(p,t,S))),C.forEach(S=>fp(p,n,S)),C.forEach(S=>fp(p,za[o]||{},S)),C.forEach(S=>fp(p,xi,S)),C.forEach(S=>fp(p,Gf,S))});let y=Array.from(p);return y.length===0&&y.push(Object.create(null)),OS.has(i)&&l.set(i,y),y}chartOptionScopes(){let{options:t,type:i}=this;return[t,za[i]||{},xi.datasets[i]||{},{type:i},xi,Gf]}resolveNamedOptions(t,i,s,n=[""]){let o={$shared:!0},{resolver:l,subPrefixes:d}=K1(this._resolverCache,t,n),p=l;if(iA(l,i)){o.$shared=!1,s=Gr(s)?s():s;let y=this.createResolver(t,s,d);p=Xl(l,s,y)}for(let y of i)o[y]=p[y];return o}createResolver(t,i,s=[""],n){let{resolver:o}=K1(this._resolverCache,t,s);return Zt(i)?Xl(o,i,void 0,n):o}};function K1(e,t,i){let s=e.get(t);s||(s=new Map,e.set(t,s));let n=i.join(),o=s.get(n);return o||(o={resolver:jf(t,i),subPrefixes:i.filter(d=>!d.toLowerCase().includes("hover"))},s.set(n,o)),o}var tA=e=>Zt(e)&&Object.getOwnPropertyNames(e).some(t=>Gr(e[t]));function iA(e,t){let{isScriptable:i,isIndexable:s}=R0(e);for(let n of t){let o=i(n),l=s(n),d=(l||o)&&e[n];if(o&&(Gr(d)||tA(d))||l&&Si(d))return!0}return!1}var sA="4.5.0",oA=["top","bottom","left","right","chartArea"];function X1(e,t){return e==="top"||e==="bottom"||oA.indexOf(e)===-1&&t==="x"}function Y1(e,t){return function(i,s){return i[e]===s[e]?i[t]-s[t]:i[e]-s[e]}}function Q1(e){let t=e.chart,i=t.options.animation;t.notifyPlugins("afterRender"),bi(i&&i.onComplete,[e],t)}function nA(e){let t=e.chart,i=t.options.animation;bi(i&&i.onProgress,[e],t)}function zS(e){return $f()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}var im={},J1=e=>{let t=zS(e);return Object.values(im).filter(i=>i.canvas===t).pop()};function rA(e,t,i){let s=Object.keys(e);for(let n of s){let o=+n;if(o>=t){let l=e[n];delete e[n],(i>0||o>t)&&(e[o+i]=l)}}}function aA(e,t,i,s){return!i||e.type==="mouseout"?null:s?t:e}var cm=(()=>{class e{static defaults=xi;static instances=im;static overrides=za;static registry=tr;static version=sA;static getChart=J1;static register(...i){tr.add(...i),eS()}static unregister(...i){tr.remove(...i),eS()}constructor(i,s){let n=this.config=new iw(s),o=zS(i),l=J1(o);if(l)throw new Error("Canvas is already in use. Chart with ID '"+l.id+"' must be destroyed before the canvas with ID '"+l.canvas.id+"' can be reused.");let d=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||Mk(o)),this.platform.updateConfig(n);let p=this.platform.acquireContext(o,d.aspectRatio),y=p&&p.canvas,C=y&&y.height,S=y&&y.width;if(this.id=Q_(),this.ctx=p,this.canvas=y,this.width=S,this.height=C,this._options=d,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new J0,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=c1(P=>this.update(P),d.resizeDelay||0),this._dataChanges=[],im[this.id]=this,!p||!y){console.error("Failed to create chart: can't acquire context from the given item");return}$r.listen(this,"complete",Q1),$r.listen(this,"progress",nA),this._initialize(),this.attached&&this.update()}get aspectRatio(){let{options:{aspectRatio:i,maintainAspectRatio:s},width:n,height:o,_aspectRatio:l}=this;return qt(i)?s&&l?l:o?n/o:null:i}get data(){return this.config.data}set data(i){this.config.data=i}get options(){return this._options}set options(i){this.config.options=i}get registry(){return tr}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():T0(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return x0(this.canvas,this.ctx),this}stop(){return $r.stop(this),this}resize(i,s){$r.running(this)?this._resizeBeforeDraw={width:i,height:s}:this._resize(i,s)}_resize(i,s){let n=this.options,o=this.canvas,l=n.maintainAspectRatio&&this.aspectRatio,d=this.platform.getMaximumSize(o,i,s,l),p=n.devicePixelRatio||this.platform.getDevicePixelRatio(),y=this.width?"resize":"attach";this.width=d.width,this.height=d.height,this._aspectRatio=this.aspectRatio,T0(this,p,!0)&&(this.notifyPlugins("resize",{size:d}),bi(n.onResize,[this,d],this),this.attached&&this._doResize(y)&&this.render())}ensureScalesHaveIDs(){let s=this.options.scales||{};ai(s,(n,o)=>{n.id=o})}buildOrUpdateScales(){let i=this.options,s=i.scales,n=this.scales,o=Object.keys(n).reduce((d,p)=>(d[p]=!1,d),{}),l=[];s&&(l=l.concat(Object.keys(s).map(d=>{let p=s[d],y=tw(d,p),C=y==="r",S=y==="x";return{options:p,dposition:C?"chartArea":S?"bottom":"left",dtype:C?"radialLinear":S?"category":"linear"}}))),ai(l,d=>{let p=d.options,y=p.id,C=tw(y,p),S=kt(p.type,d.dtype);(p.position===void 0||X1(p.position,C)!==X1(d.dposition))&&(p.position=d.dposition),o[y]=!0;let P=null;if(y in n&&n[y].type===S)P=n[y];else{let I=tr.getScale(S);P=new I({id:y,type:S,ctx:this.ctx,chart:this}),n[P.id]=P}P.init(p,i)}),ai(o,(d,p)=>{d||delete n[p]}),ai(n,d=>{qs.configure(this,d,d.options),qs.addBox(this,d)})}_updateMetasets(){let i=this._metasets,s=this.data.datasets.length,n=i.length;if(i.sort((o,l)=>o.index-l.index),n>s){for(let o=s;o<n;++o)this._destroyDatasetMeta(o);i.splice(s,n-s)}this._sortedMetasets=i.slice(0).sort(Y1("order","index"))}_removeUnreferencedMetasets(){let{_metasets:i,data:{datasets:s}}=this;i.length>s.length&&delete this._stacks,i.forEach((n,o)=>{s.filter(l=>l===n._dataset).length===0&&this._destroyDatasetMeta(o)})}buildOrUpdateControllers(){let i=[],s=this.data.datasets,n,o;for(this._removeUnreferencedMetasets(),n=0,o=s.length;n<o;n++){let l=s[n],d=this.getDatasetMeta(n),p=l.type||this.config.type;if(d.type&&d.type!==p&&(this._destroyDatasetMeta(n),d=this.getDatasetMeta(n)),d.type=p,d.indexAxis=l.indexAxis||ew(p,this.options),d.order=l.order||0,d.index=n,d.label=""+l.label,d.visible=this.isDatasetVisible(n),d.controller)d.controller.updateIndex(n),d.controller.linkScales();else{let y=tr.getController(p),{datasetElementType:C,dataElementType:S}=xi.datasets[p];Object.assign(y,{dataElementType:tr.getElement(S),datasetElementType:C&&tr.getElement(C)}),d.controller=new y(this,n),i.push(d.controller)}}return this._updateMetasets(),i}_resetElements(){ai(this.data.datasets,(i,s)=>{this.getDatasetMeta(s).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(i){let s=this.config;s.update();let n=this._options=s.createResolver(s.chartOptionScopes(),this.getContext()),o=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:i,cancelable:!0})===!1)return;let l=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let d=0;for(let C=0,S=this.data.datasets.length;C<S;C++){let{controller:P}=this.getDatasetMeta(C),I=!o&&l.indexOf(P)===-1;P.buildOrUpdateElements(I),d=Math.max(+P.getMaxOverflow(),d)}d=this._minPadding=n.layout.autoPadding?d:0,this._updateLayout(d),o||ai(l,C=>{C.reset()}),this._updateDatasets(i),this.notifyPlugins("afterUpdate",{mode:i}),this._layers.sort(Y1("z","_idx"));let{_active:p,_lastEvent:y}=this;y?this._eventHandler(y,!0):p.length&&this._updateHoverStyles(p,p,!0),this.render()}_updateScales(){ai(this.scales,i=>{qs.removeBox(this,i)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){let i=this.options,s=new Set(Object.keys(this._listeners)),n=new Set(i.events);(!c0(s,n)||!!this._responsiveListeners!==i.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){let{_hiddenIndices:i}=this,s=this._getUniformDataChanges()||[];for(let{method:n,start:o,count:l}of s){let d=n==="_removeElements"?-l:l;rA(i,o,d)}}_getUniformDataChanges(){let i=this._dataChanges;if(!i||!i.length)return;this._dataChanges=[];let s=this.data.datasets.length,n=l=>new Set(i.filter(d=>d[0]===l).map((d,p)=>p+","+d.splice(1).join(","))),o=n(0);for(let l=1;l<s;l++)if(!c0(o,n(l)))return;return Array.from(o).map(l=>l.split(",")).map(l=>({method:l[1],start:+l[2],count:+l[3]}))}_updateLayout(i){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;qs.update(this,this.width,this.height,i);let s=this.chartArea,n=s.width<=0||s.height<=0;this._layers=[],ai(this.boxes,o=>{n&&o.position==="chartArea"||(o.configure&&o.configure(),this._layers.push(...o._layers()))},this),this._layers.forEach((o,l)=>{o._idx=l}),this.notifyPlugins("afterLayout")}_updateDatasets(i){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:i,cancelable:!0})!==!1){for(let s=0,n=this.data.datasets.length;s<n;++s)this.getDatasetMeta(s).controller.configure();for(let s=0,n=this.data.datasets.length;s<n;++s)this._updateDataset(s,Gr(i)?i({datasetIndex:s}):i);this.notifyPlugins("afterDatasetsUpdate",{mode:i})}}_updateDataset(i,s){let n=this.getDatasetMeta(i),o={meta:n,index:i,mode:s,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",o)!==!1&&(n.controller._update(s),o.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",o))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&($r.has(this)?this.attached&&!$r.running(this)&&$r.start(this):(this.draw(),Q1({chart:this})))}draw(){let i;if(this._resizeBeforeDraw){let{width:n,height:o}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,o)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;let s=this._layers;for(i=0;i<s.length&&s[i].z<=0;++i)s[i].draw(this.chartArea);for(this._drawDatasets();i<s.length;++i)s[i].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(i){let s=this._sortedMetasets,n=[],o,l;for(o=0,l=s.length;o<l;++o){let d=s[o];(!i||d.visible)&&n.push(d)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;let i=this.getSortedVisibleDatasetMetas();for(let s=i.length-1;s>=0;--s)this._drawDataset(i[s]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(i){let s=this.ctx,n={meta:i,index:i.index,cancelable:!0},o=L0(this,i);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(o&&cp(s,o),i.controller.draw(),o&&hp(s),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(i){return Yn(i,this.chartArea,this._minPadding)}getElementsAtEventForMode(i,s,n,o){let l=ck.modes[s];return typeof l=="function"?l(this,i,n,o):[]}getDatasetMeta(i){let s=this.data.datasets[i],n=this._metasets,o=n.filter(l=>l&&l._dataset===s).pop();return o||(o={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:s&&s.order||0,index:i,_dataset:s,_parsed:[],_sorted:!1},n.push(o)),o}getContext(){return this.$context||(this.$context=jr(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(i){let s=this.data.datasets[i];if(!s)return!1;let n=this.getDatasetMeta(i);return typeof n.hidden=="boolean"?!n.hidden:!s.hidden}setDatasetVisibility(i,s){let n=this.getDatasetMeta(i);n.hidden=!s}toggleDataVisibility(i){this._hiddenIndices[i]=!this._hiddenIndices[i]}getDataVisibility(i){return!this._hiddenIndices[i]}_updateVisibility(i,s,n){let o=n?"show":"hide",l=this.getDatasetMeta(i),d=l.controller._resolveAnimations(void 0,o);Nh(s)?(l.data[s].hidden=!n,this.update()):(this.setDatasetVisibility(i,n),d.update(l,{visible:n}),this.update(p=>p.datasetIndex===i?o:void 0))}hide(i,s){this._updateVisibility(i,s,!1)}show(i,s){this._updateVisibility(i,s,!0)}_destroyDatasetMeta(i){let s=this._metasets[i];s&&s.controller&&s.controller._destroy(),delete this._metasets[i]}_stop(){let i,s;for(this.stop(),$r.remove(this),i=0,s=this.data.datasets.length;i<s;++i)this._destroyDatasetMeta(i)}destroy(){this.notifyPlugins("beforeDestroy");let{canvas:i,ctx:s}=this;this._stop(),this.config.clearCache(),i&&(this.unbindEvents(),x0(i,s),this.platform.releaseContext(s),this.canvas=null,this.ctx=null),delete im[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...i){return this.canvas.toDataURL(...i)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){let i=this._listeners,s=this.platform,n=(l,d)=>{s.addEventListener(this,l,d),i[l]=d},o=(l,d,p)=>{l.offsetX=d,l.offsetY=p,this._eventHandler(l)};ai(this.options.events,l=>n(l,o))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});let i=this._responsiveListeners,s=this.platform,n=(y,C)=>{s.addEventListener(this,y,C),i[y]=C},o=(y,C)=>{i[y]&&(s.removeEventListener(this,y,C),delete i[y])},l=(y,C)=>{this.canvas&&this.resize(y,C)},d,p=()=>{o("attach",p),this.attached=!0,this.resize(),n("resize",l),n("detach",d)};d=()=>{this.attached=!1,o("resize",l),this._stop(),this._resize(0,0),n("attach",p)},s.isAttached(this.canvas)?p():d()}unbindEvents(){ai(this._listeners,(i,s)=>{this.platform.removeEventListener(this,s,i)}),this._listeners={},ai(this._responsiveListeners,(i,s)=>{this.platform.removeEventListener(this,s,i)}),this._responsiveListeners=void 0}updateHoverStyle(i,s,n){let o=n?"set":"remove",l,d,p,y;for(s==="dataset"&&(l=this.getDatasetMeta(i[0].datasetIndex),l.controller["_"+o+"DatasetHoverStyle"]()),p=0,y=i.length;p<y;++p){d=i[p];let C=d&&this.getDatasetMeta(d.datasetIndex).controller;C&&C[o+"HoverStyle"](d.element,d.datasetIndex,d.index)}}getActiveElements(){return this._active||[]}setActiveElements(i){let s=this._active||[],n=i.map(({datasetIndex:l,index:d})=>{let p=this.getDatasetMeta(l);if(!p)throw new Error("No dataset found at index "+l);return{datasetIndex:l,element:p.data[d],index:d}});!ap(n,s)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,s))}notifyPlugins(i,s,n){return this._plugins.notify(this,i,s,n)}isPluginEnabled(i){return this._plugins._cache.filter(s=>s.plugin.id===i).length===1}_updateHoverStyles(i,s,n){let o=this.options.hover,l=(y,C)=>y.filter(S=>!C.some(P=>S.datasetIndex===P.datasetIndex&&S.index===P.index)),d=l(s,i),p=n?i:l(i,s);d.length&&this.updateHoverStyle(d,o.mode,!1),p.length&&o.mode&&this.updateHoverStyle(p,o.mode,!0)}_eventHandler(i,s){let n={event:i,replay:s,cancelable:!0,inChartArea:this.isPointInArea(i)},o=d=>(d.options.events||this.options.events).includes(i.native.type);if(this.notifyPlugins("beforeEvent",n,o)===!1)return;let l=this._handleEvent(i,s,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,o),(l||n.changed)&&this.render(),this}_handleEvent(i,s,n){let{_active:o=[],options:l}=this,d=s,p=this._getActiveElements(i,o,n,d),y=t1(i),C=aA(i,this._lastEvent,n,y);n&&(this._lastEvent=null,bi(l.onHover,[i,p,this],this),y&&bi(l.onClick,[i,p,this],this));let S=!ap(p,o);return(S||s)&&(this._active=p,this._updateHoverStyles(p,o,s)),this._lastEvent=C,S}_getActiveElements(i,s,n,o){if(i.type==="mouseout")return[];if(!n)return s;let l=this.options.hover;return this.getElementsAtEventForMode(i,l.mode,l,o)}}return e})();function eS(){return ai(cm.instances,e=>e._plugins.invalidate())}function lA(e,t,i){let{startAngle:s,x:n,y:o,outerRadius:l,innerRadius:d,options:p}=t,{borderWidth:y,borderJoinStyle:C}=p,S=Math.min(y/l,Os(s-i));if(e.beginPath(),e.arc(n,o,l-y/2,s+S/2,i-S/2),d>0){let P=Math.min(y/d,Os(s-i));e.arc(n,o,d+y/2,i-P/2,s+P/2,!0)}else{let P=Math.min(y/2,l*Os(s-i));if(C==="round")e.arc(n,o,P,i-Qt/2,s+Qt/2,!0);else if(C==="bevel"){let I=2*P*P,O=-I*Math.cos(i+Qt/2)+n,V=-I*Math.sin(i+Qt/2)+o,G=I*Math.cos(s+Qt/2)+n,X=I*Math.sin(s+Qt/2)+o;e.lineTo(O,V),e.lineTo(G,X)}}e.closePath(),e.moveTo(0,0),e.rect(0,0,e.canvas.width,e.canvas.height),e.clip("evenodd")}function cA(e,t,i){let{startAngle:s,pixelMargin:n,x:o,y:l,outerRadius:d,innerRadius:p}=t,y=n/d;e.beginPath(),e.arc(o,l,d,s-y,i+y),p>n?(y=n/p,e.arc(o,l,p,i+y,s-y,!0)):e.arc(o,l,n,i+Yi,s-Yi),e.closePath(),e.clip()}function hA(e){return Uf(e,["outerStart","outerEnd","innerStart","innerEnd"])}function uA(e,t,i,s){let n=hA(e.options.borderRadius),o=(i-t)/2,l=Math.min(o,s*t/2),d=p=>{let y=(i-Math.min(o,p))*s/2;return Cs(p,0,Math.min(o,y))};return{outerStart:d(n.outerStart),outerEnd:d(n.outerEnd),innerStart:Cs(n.innerStart,0,l),innerEnd:Cs(n.innerEnd,0,l)}}function qh(e,t,i,s){return{x:i+e*Math.cos(t),y:s+e*Math.sin(t)}}function rm(e,t,i,s,n,o){let{x:l,y:d,startAngle:p,pixelMargin:y,innerRadius:C}=t,S=Math.max(t.outerRadius+s+i-y,0),P=C>0?C+s+i+y:0,I=0,O=n-p;if(s){let xt=C>0?C-s:0,Yt=S>0?S-s:0,Ct=(xt+Yt)/2,Fi=Ct!==0?O*Ct/(Ct+s):O;I=(O-Fi)/2}let V=Math.max(.001,O*S-i/Qt)/S,G=(O-V)/2,X=p+G+I,Q=n-G-I,{outerStart:ae,outerEnd:me,innerStart:fe,innerEnd:_e}=uA(t,P,S,Q-X),Ae=S-ae,Oe=S-me,Ge=X+ae/Ae,it=Q-me/Oe,Xe=P+fe,lt=P+_e,St=X+fe/Xe,Gt=Q-_e/lt;if(e.beginPath(),o){let xt=(Ge+it)/2;if(e.arc(l,d,S,Ge,xt),e.arc(l,d,S,xt,it),me>0){let jt=qh(Oe,it,l,d);e.arc(jt.x,jt.y,me,it,Q+Yi)}let Yt=qh(lt,Q,l,d);if(e.lineTo(Yt.x,Yt.y),_e>0){let jt=qh(lt,Gt,l,d);e.arc(jt.x,jt.y,_e,Q+Yi,Gt+Math.PI)}let Ct=(Q-_e/P+(X+fe/P))/2;if(e.arc(l,d,P,Q-_e/P,Ct,!0),e.arc(l,d,P,Ct,X+fe/P,!0),fe>0){let jt=qh(Xe,St,l,d);e.arc(jt.x,jt.y,fe,St+Math.PI,X-Yi)}let Fi=qh(Ae,X,l,d);if(e.lineTo(Fi.x,Fi.y),ae>0){let jt=qh(Ae,Ge,l,d);e.arc(jt.x,jt.y,ae,X-Yi,Ge)}}else{e.moveTo(l,d);let xt=Math.cos(Ge)*S+l,Yt=Math.sin(Ge)*S+d;e.lineTo(xt,Yt);let Ct=Math.cos(it)*S+l,Fi=Math.sin(it)*S+d;e.lineTo(Ct,Fi)}e.closePath()}function dA(e,t,i,s,n){let{fullCircles:o,startAngle:l,circumference:d}=t,p=t.endAngle;if(o){rm(e,t,i,s,p,n);for(let y=0;y<o;++y)e.fill();isNaN(d)||(p=l+(d%Ri||Ri))}return rm(e,t,i,s,p,n),e.fill(),p}function pA(e,t,i,s,n){let{fullCircles:o,startAngle:l,circumference:d,options:p}=t,{borderWidth:y,borderJoinStyle:C,borderDash:S,borderDashOffset:P,borderRadius:I}=p,O=p.borderAlign==="inner";if(!y)return;e.setLineDash(S||[]),e.lineDashOffset=P,O?(e.lineWidth=y*2,e.lineJoin=C||"round"):(e.lineWidth=y,e.lineJoin=C||"bevel");let V=t.endAngle;if(o){rm(e,t,i,s,V,n);for(let G=0;G<o;++G)e.stroke();isNaN(d)||(V=l+(d%Ri||Ri))}O&&cA(e,t,V),p.selfJoin&&V-l>=Qt&&I===0&&C!=="miter"&&lA(e,t,V),o||(rm(e,t,i,s,V,n),e.stroke())}var sw=class extends Cn{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,i,s){let n=this.getProps(["x","y"],s),{angle:o,distance:l}=p0(n,{x:t,y:i}),{startAngle:d,endAngle:p,innerRadius:y,outerRadius:C,circumference:S}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),P=(this.options.spacing+this.options.borderWidth)/2,I=kt(S,p-d),O=Wh(o,d,p)&&d!==p,V=I>=Ri||O,G=Jn(l,y+P,C+P);return V&&G}getCenterPoint(t){let{x:i,y:s,startAngle:n,endAngle:o,innerRadius:l,outerRadius:d}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:p,spacing:y}=this.options,C=(n+o)/2,S=(l+d+y+p)/2;return{x:i+Math.cos(C)*S,y:s+Math.sin(C)*S}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){let{options:i,circumference:s}=this,n=(i.offset||0)/4,o=(i.spacing||0)/2,l=i.circular;if(this.pixelMargin=i.borderAlign==="inner"?.33:0,this.fullCircles=s>Ri?Math.floor(s/Ri):0,s===0||this.innerRadius<0||this.outerRadius<0)return;t.save();let d=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(d)*n,Math.sin(d)*n);let p=1-Math.sin(Math.min(Qt,s||0)),y=n*p;t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,dA(t,this,y,o,l),pA(t,this,y,o,l),t.restore()}};function BS(e,t,i=t){e.lineCap=kt(i.borderCapStyle,t.borderCapStyle),e.setLineDash(kt(i.borderDash,t.borderDash)),e.lineDashOffset=kt(i.borderDashOffset,t.borderDashOffset),e.lineJoin=kt(i.borderJoinStyle,t.borderJoinStyle),e.lineWidth=kt(i.borderWidth,t.borderWidth),e.strokeStyle=kt(i.borderColor,t.borderColor)}function gA(e,t,i){e.lineTo(i.x,i.y)}function fA(e){return e.stepped?p1:e.tension||e.cubicInterpolationMode==="monotone"?g1:gA}function VS(e,t,i={}){let s=e.length,{start:n=0,end:o=s-1}=i,{start:l,end:d}=t,p=Math.max(n,l),y=Math.min(o,d),C=n<l&&o<l||n>d&&o>d;return{count:s,start:p,loop:t.loop,ilen:y<p&&!C?s+y-p:y-p}}function mA(e,t,i,s){let{points:n,options:o}=t,{count:l,start:d,loop:p,ilen:y}=VS(n,i,s),C=fA(o),{move:S=!0,reverse:P}=s||{},I,O,V;for(I=0;I<=y;++I)O=n[(d+(P?y-I:I))%l],!O.skip&&(S?(e.moveTo(O.x,O.y),S=!1):C(e,V,O,P,o.stepped),V=O);return p&&(O=n[(d+(P?y:0))%l],C(e,V,O,P,o.stepped)),!!p}function vA(e,t,i,s){let n=t.points,{count:o,start:l,ilen:d}=VS(n,i,s),{move:p=!0,reverse:y}=s||{},C=0,S=0,P,I,O,V,G,X,Q=me=>(l+(y?d-me:me))%o,ae=()=>{V!==G&&(e.lineTo(C,G),e.lineTo(C,V),e.lineTo(C,X))};for(p&&(I=n[Q(0)],e.moveTo(I.x,I.y)),P=0;P<=d;++P){if(I=n[Q(P)],I.skip)continue;let me=I.x,fe=I.y,_e=me|0;_e===O?(fe<V?V=fe:fe>G&&(G=fe),C=(S*C+me)/++S):(ae(),e.lineTo(me,fe),O=_e,S=0,V=G=fe),X=fe}ae()}function ow(e){let t=e.options,i=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!i?vA:mA}function yA(e){return e.stepped?_1:e.tension||e.cubicInterpolationMode==="monotone"?S1:Oa}function wA(e,t,i,s){let n=t._path;n||(n=t._path=new Path2D,t.path(n,i,s)&&n.closePath()),BS(e,t.options),e.stroke(n)}function CA(e,t,i,s){let{segments:n,options:o}=t,l=ow(t);for(let d of n)BS(e,o,d.style),e.beginPath(),l(e,t,d,{start:i,end:i+s-1})&&e.closePath(),e.stroke()}var bA=typeof Path2D=="function";function xA(e,t,i,s){bA&&!t.options.segment?wA(e,t,i,s):CA(e,t,i,s)}var hm=(()=>{class e extends Cn{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:i=>i!=="borderDash"&&i!=="fill"};constructor(i){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,i&&Object.assign(this,i)}updateControlPoints(i,s){let n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){let o=n.spanGaps?this._loop:this._fullLoop;C1(this._points,n,i,o,s),this._pointsUpdated=!0}}set points(i){this._points=i,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=E1(this,this.options.segment))}first(){let i=this.segments,s=this.points;return i.length&&s[i[0].start]}last(){let i=this.segments,s=this.points,n=i.length;return n&&s[i[n-1].end]}interpolate(i,s){let n=this.options,o=i[s],l=this.points,d=A0(this,{property:s,start:o,end:o});if(!d.length)return;let p=[],y=yA(n),C,S;for(C=0,S=d.length;C<S;++C){let{start:P,end:I}=d[C],O=l[P],V=l[I];if(O===V){p.push(O);continue}let G=Math.abs((o-O[s])/(V[s]-O[s])),X=y(O,V,G,n.stepped);X[s]=i[s],p.push(X)}return p.length===1?p[0]:p}pathSegment(i,s,n){return ow(this)(i,this,s,n)}path(i,s,n){let o=this.segments,l=ow(this),d=this._loop;s=s||0,n=n||this.points.length-s;for(let p of o)d&=l(i,this,p,{start:s,end:s+n-1});return!!d}draw(i,s,n,o){let l=this.options||{};(this.points||[]).length&&l.borderWidth&&(i.save(),xA(i,this,n,o),i.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}return e})();function tS(e,t,i,s){let n=e.options,{[i]:o}=e.getProps([i],s);return Math.abs(t-o)<n.radius+n.hitRadius}var _A=(()=>{class e extends Cn{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(i){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,i&&Object.assign(this,i)}inRange(i,s,n){let o=this.options,{x:l,y:d}=this.getProps(["x","y"],n);return Math.pow(i-l,2)+Math.pow(s-d,2)<Math.pow(o.hitRadius+o.radius,2)}inXRange(i,s){return tS(this,i,"x",s)}inYRange(i,s){return tS(this,i,"y",s)}getCenterPoint(i){let{x:s,y:n}=this.getProps(["x","y"],i);return{x:s,y:n}}size(i){i=i||this.options||{};let s=i.radius||0;s=Math.max(s,s&&i.hoverRadius||0);let n=s&&i.borderWidth||0;return(s+n)*2}draw(i,s){let n=this.options;this.skip||n.radius<.1||!Yn(this,s,this.size(n)/2)||(i.strokeStyle=n.borderColor,i.lineWidth=n.borderWidth,i.fillStyle=n.backgroundColor,Wf(i,n,this.x,this.y))}getRange(){let i=this.options||{};return i.radius+i.hitRadius}}return e})();function HS(e,t){let{x:i,y:s,base:n,width:o,height:l}=e.getProps(["x","y","base","width","height"],t),d,p,y,C,S;return e.horizontal?(S=l/2,d=Math.min(i,n),p=Math.max(i,n),y=s-S,C=s+S):(S=o/2,d=i-S,p=i+S,y=Math.min(s,n),C=Math.max(s,n)),{left:d,top:y,right:p,bottom:C}}function Ga(e,t,i,s){return e?0:Cs(t,i,s)}function SA(e,t,i){let s=e.options.borderWidth,n=e.borderSkipped,o=S0(s);return{t:Ga(n.top,o.top,0,i),r:Ga(n.right,o.right,0,t),b:Ga(n.bottom,o.bottom,0,i),l:Ga(n.left,o.left,0,t)}}function RA(e,t,i){let{enableBorderRadius:s}=e.getProps(["enableBorderRadius"]),n=e.options.borderRadius,o=Ha(n),l=Math.min(t,i),d=e.borderSkipped,p=s||Zt(n);return{topLeft:Ga(!p||d.top||d.left,o.topLeft,0,l),topRight:Ga(!p||d.top||d.right,o.topRight,0,l),bottomLeft:Ga(!p||d.bottom||d.left,o.bottomLeft,0,l),bottomRight:Ga(!p||d.bottom||d.right,o.bottomRight,0,l)}}function EA(e){let t=HS(e),i=t.right-t.left,s=t.bottom-t.top,n=SA(e,i/2,s/2),o=RA(e,i/2,s/2);return{outer:{x:t.left,y:t.top,w:i,h:s,radius:o},inner:{x:t.left+n.l,y:t.top+n.t,w:i-n.l-n.r,h:s-n.t-n.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(n.t,n.l)),topRight:Math.max(0,o.topRight-Math.max(n.t,n.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(n.b,n.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(n.b,n.r))}}}}function W0(e,t,i,s){let n=t===null,o=i===null,d=e&&!(n&&o)&&HS(e,s);return d&&(n||Jn(t,d.left,d.right))&&(o||Jn(i,d.top,d.bottom))}function PA(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function MA(e,t){e.rect(t.x,t.y,t.w,t.h)}function U0(e,t,i={}){let s=e.x!==i.x?-t:0,n=e.y!==i.y?-t:0,o=(e.x+e.w!==i.x+i.w?t:0)-s,l=(e.y+e.h!==i.y+i.h?t:0)-n;return{x:e.x+s,y:e.y+n,w:e.w+o,h:e.h+l,radius:e.radius}}var nw=class extends Cn{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){let{inflateAmount:i,options:{borderColor:s,backgroundColor:n}}=this,{inner:o,outer:l}=EA(this),d=PA(l.radius)?jh:MA;t.save(),(l.w!==o.w||l.h!==o.h)&&(t.beginPath(),d(t,U0(l,i,o)),t.clip(),d(t,U0(o,-i,l)),t.fillStyle=s,t.fill("evenodd")),t.beginPath(),d(t,U0(o,i)),t.fillStyle=n,t.fill(),t.restore()}inRange(t,i,s){return W0(this,t,i,s)}inXRange(t,i){return W0(this,t,null,i)}inYRange(t,i){return W0(this,null,t,i)}getCenterPoint(t){let{x:i,y:s,base:n,horizontal:o}=this.getProps(["x","y","base","horizontal"],t);return{x:o?(i+n)/2:i,y:o?s:(s+n)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}},TA=Object.freeze({__proto__:null,ArcElement:sw,BarElement:nw,LineElement:hm,PointElement:_A}),rw=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],iS=rw.map(e=>e.replace("rgb(","rgba(").replace(")",", 0.5)"));function NS(e){return rw[e%rw.length]}function GS(e){return iS[e%iS.length]}function DA(e,t){return e.borderColor=NS(t),e.backgroundColor=GS(t),++t}function FA(e,t){return e.backgroundColor=e.data.map(()=>NS(t++)),t}function IA(e,t){return e.backgroundColor=e.data.map(()=>GS(t++)),t}function kA(e){let t=0;return(i,s)=>{let n=e.getDatasetMeta(s).controller;n instanceof gw?t=FA(i,t):n instanceof TS?t=IA(i,t):n&&(t=DA(i,t))}}function sS(e){let t;for(t in e)if(e[t].borderColor||e[t].backgroundColor)return!0;return!1}function AA(e){return e&&(e.borderColor||e.backgroundColor)}function LA(){return xi.borderColor!=="rgba(0,0,0,0.1)"||xi.backgroundColor!=="rgba(0,0,0,0.1)"}var OA={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(e,t,i){if(!i.enabled)return;let{data:{datasets:s},options:n}=e.config,{elements:o}=n,l=sS(s)||AA(n)||o&&sS(o)||LA();if(!i.forceOverride&&l)return;let d=kA(e);s.forEach(d)}};function zA(e,t,i,s,n){let o=n.samples||s;if(o>=i)return e.slice(t,t+i);let l=[],d=(i-2)/(o-2),p=0,y=t+i-1,C=t,S,P,I,O,V;for(l[p++]=e[C],S=0;S<o-2;S++){let G=0,X=0,Q,ae=Math.floor((S+1)*d)+1+t,me=Math.min(Math.floor((S+2)*d)+1,i)+t,fe=me-ae;for(Q=ae;Q<me;Q++)G+=e[Q].x,X+=e[Q].y;G/=fe,X/=fe;let _e=Math.floor(S*d)+1+t,Ae=Math.min(Math.floor((S+1)*d)+1,i)+t,{x:Oe,y:Ge}=e[C];for(I=O=-1,Q=_e;Q<Ae;Q++)O=.5*Math.abs((Oe-G)*(e[Q].y-Ge)-(Oe-e[Q].x)*(X-Ge)),O>I&&(I=O,P=e[Q],V=Q);l[p++]=P,C=V}return l[p++]=e[y],l}function BA(e,t,i,s){let n=0,o=0,l,d,p,y,C,S,P,I,O,V,G=[],X=t+i-1,Q=e[t].x,me=e[X].x-Q;for(l=t;l<t+i;++l){d=e[l],p=(d.x-Q)/me*s,y=d.y;let fe=p|0;if(fe===C)y<O?(O=y,S=l):y>V&&(V=y,P=l),n=(o*n+d.x)/++o;else{let _e=l-1;if(!qt(S)&&!qt(P)){let Ae=Math.min(S,P),Oe=Math.max(S,P);Ae!==I&&Ae!==_e&&G.push(ht(Se({},e[Ae]),{x:n})),Oe!==I&&Oe!==_e&&G.push(ht(Se({},e[Oe]),{x:n}))}l>0&&_e!==I&&G.push(e[_e]),G.push(d),C=fe,o=0,O=V=y,S=P=I=l}}return G}function WS(e){if(e._decimated){let t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function oS(e){e.data.datasets.forEach(t=>{WS(t)})}function VA(e,t){let i=t.length,s=0,n,{iScale:o}=e,{min:l,max:d,minDefined:p,maxDefined:y}=o.getUserBounds();return p&&(s=Cs(Xn(t,o.axis,l).lo,0,i-1)),y?n=Cs(Xn(t,o.axis,d).hi+1,s,i)-s:n=i-s,{start:s,count:n}}var HA={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,t,i)=>{if(!i.enabled){oS(e);return}let s=e.width;e.data.datasets.forEach((n,o)=>{let{_data:l,indexAxis:d}=n,p=e.getDatasetMeta(o),y=l||n.data;if($h([d,e.options.indexAxis])==="y"||!p.controller.supportsDecimation)return;let C=e.scales[p.xAxisID];if(C.type!=="linear"&&C.type!=="time"||e.options.parsing)return;let{start:S,count:P}=VA(p,y),I=i.threshold||4*s;if(P<=I){WS(n);return}qt(l)&&(n._data=y,delete n.data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(V){this._data=V}}));let O;switch(i.algorithm){case"lttb":O=zA(y,S,P,s,i);break;case"min-max":O=BA(y,S,P,s);break;default:throw new Error(`Unsupported decimation algorithm '${i.algorithm}'`)}n._decimated=O})},destroy(e){oS(e)}};function NA(e,t,i){let s=e.segments,n=e.points,o=t.points,l=[];for(let d of s){let{start:p,end:y}=d;y=um(p,y,n);let C=aw(i,n[p],n[y],d.loop);if(!t.segments){l.push({source:d,target:C,start:n[p],end:n[y]});continue}let S=A0(t,C);for(let P of S){let I=aw(i,o[P.start],o[P.end],P.loop),O=k0(d,n,I);for(let V of O)l.push({source:V,target:P,start:{[i]:nS(C,I,"start",Math.max)},end:{[i]:nS(C,I,"end",Math.min)}})}}return l}function aw(e,t,i,s){if(s)return;let n=t[e],o=i[e];return e==="angle"&&(n=Os(n),o=Os(o)),{property:e,start:n,end:o}}function GA(e,t){let{x:i=null,y:s=null}=e||{},n=t.points,o=[];return t.segments.forEach(({start:l,end:d})=>{d=um(l,d,n);let p=n[l],y=n[d];s!==null?(o.push({x:p.x,y:s}),o.push({x:y.x,y:s})):i!==null&&(o.push({x:i,y:p.y}),o.push({x:i,y:y.y}))}),o}function um(e,t,i){for(;t>e;t--){let s=i[t];if(!isNaN(s.x)&&!isNaN(s.y))break}return t}function nS(e,t,i,s){return e&&t?s(e[i],t[i]):e?e[i]:t?t[i]:0}function US(e,t){let i=[],s=!1;return Si(e)?(s=!0,i=e):i=GA(e,t),i.length?new hm({points:i,options:{tension:0},_loop:s,_fullLoop:s}):null}function rS(e){return e&&e.fill!==!1}function WA(e,t,i){let n=e[t].fill,o=[t],l;if(!i)return n;for(;n!==!1&&o.indexOf(n)===-1;){if(!Wi(n))return n;if(l=e[n],!l)return!1;if(l.visible)return n;o.push(n),n=l.fill}return!1}function UA(e,t,i){let s=ZA(e);if(Zt(s))return isNaN(s.value)?!1:s;let n=parseFloat(s);return Wi(n)&&Math.floor(n)===n?jA(s[0],t,n,i):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function jA(e,t,i,s){return(e==="-"||e==="+")&&(i=t+i),i===t||i<0||i>=s?!1:i}function $A(e,t){let i=null;return e==="start"?i=t.bottom:e==="end"?i=t.top:Zt(e)?i=t.getPixelForValue(e.value):t.getBasePixel&&(i=t.getBasePixel()),i}function qA(e,t,i){let s;return e==="start"?s=i:e==="end"?s=t.options.reverse?t.min:t.max:Zt(e)?s=e.value:s=t.getBaseValue(),s}function ZA(e){let t=e.options,i=t.fill,s=kt(i&&i.target,i);return s===void 0&&(s=!!t.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function KA(e){let{scale:t,index:i,line:s}=e,n=[],o=s.segments,l=s.points,d=XA(t,i);d.push(US({x:null,y:t.bottom},s));for(let p=0;p<o.length;p++){let y=o[p];for(let C=y.start;C<=y.end;C++)YA(n,l[C],d)}return new hm({points:n,options:{}})}function XA(e,t){let i=[],s=e.getMatchingVisibleMetas("line");for(let n=0;n<s.length;n++){let o=s[n];if(o.index===t)break;o.hidden||i.unshift(o.dataset)}return i}function YA(e,t,i){let s=[];for(let n=0;n<i.length;n++){let o=i[n],{first:l,last:d,point:p}=QA(o,t,"x");if(!(!p||l&&d)){if(l)s.unshift(p);else if(e.push(p),!d)break}}e.push(...s)}function QA(e,t,i){let s=e.interpolate(t,i);if(!s)return{};let n=s[i],o=e.segments,l=e.points,d=!1,p=!1;for(let y=0;y<o.length;y++){let C=o[y],S=l[C.start][i],P=l[C.end][i];if(Jn(n,S,P)){d=n===S,p=n===P;break}}return{first:d,last:p,point:s}}var am=class{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,i,s){let{x:n,y:o,radius:l}=this;return i=i||{start:0,end:Ri},t.arc(n,o,l,i.end,i.start,!0),!s.bounds}interpolate(t){let{x:i,y:s,radius:n}=this,o=t.angle;return{x:i+Math.cos(o)*n,y:s+Math.sin(o)*n,angle:o}}};function JA(e){let{chart:t,fill:i,line:s}=e;if(Wi(i))return eL(t,i);if(i==="stack")return KA(e);if(i==="shape")return!0;let n=tL(e);return n instanceof am?n:US(n,s)}function eL(e,t){let i=e.getDatasetMeta(t);return i&&e.isDatasetVisible(t)?i.dataset:null}function tL(e){return(e.scale||{}).getPointPositionForValue?sL(e):iL(e)}function iL(e){let{scale:t={},fill:i}=e,s=$A(i,t);if(Wi(s)){let n=t.isHorizontal();return{x:n?s:null,y:n?null:s}}return null}function sL(e){let{scale:t,fill:i}=e,s=t.options,n=t.getLabels().length,o=s.reverse?t.max:t.min,l=qA(i,t,o),d=[];if(s.grid.circular){let p=t.getPointPositionForValue(0,o);return new am({x:p.x,y:p.y,radius:t.getDistanceFromCenterForValue(l)})}for(let p=0;p<n;++p)d.push(t.getPointPositionForValue(p,l));return d}function j0(e,t,i){let s=JA(t),{chart:n,index:o,line:l,scale:d,axis:p}=t,y=l.options,C=y.fill,S=y.backgroundColor,{above:P=S,below:I=S}=C||{},O=n.getDatasetMeta(o),V=L0(n,O);s&&l.points.length&&(cp(e,i),oL(e,{line:l,target:s,above:P,below:I,area:i,scale:d,axis:p,clip:V}),hp(e))}function oL(e,t){let{line:i,target:s,above:n,below:o,area:l,scale:d,clip:p}=t,y=i._loop?"angle":t.axis;e.save();let C=o;o!==n&&(y==="x"?(aS(e,s,l.top),$0(e,{line:i,target:s,color:n,scale:d,property:y,clip:p}),e.restore(),e.save(),aS(e,s,l.bottom)):y==="y"&&(lS(e,s,l.left),$0(e,{line:i,target:s,color:o,scale:d,property:y,clip:p}),e.restore(),e.save(),lS(e,s,l.right),C=n)),$0(e,{line:i,target:s,color:C,scale:d,property:y,clip:p}),e.restore()}function aS(e,t,i){let{segments:s,points:n}=t,o=!0,l=!1;e.beginPath();for(let d of s){let{start:p,end:y}=d,C=n[p],S=n[um(p,y,n)];o?(e.moveTo(C.x,C.y),o=!1):(e.lineTo(C.x,i),e.lineTo(C.x,C.y)),l=!!t.pathSegment(e,d,{move:l}),l?e.closePath():e.lineTo(S.x,i)}e.lineTo(t.first().x,i),e.closePath(),e.clip()}function lS(e,t,i){let{segments:s,points:n}=t,o=!0,l=!1;e.beginPath();for(let d of s){let{start:p,end:y}=d,C=n[p],S=n[um(p,y,n)];o?(e.moveTo(C.x,C.y),o=!1):(e.lineTo(i,C.y),e.lineTo(C.x,C.y)),l=!!t.pathSegment(e,d,{move:l}),l?e.closePath():e.lineTo(i,S.y)}e.lineTo(i,t.first().y),e.closePath(),e.clip()}function $0(e,t){let{line:i,target:s,property:n,color:o,scale:l,clip:d}=t,p=NA(i,s,n);for(let{source:y,target:C,start:S,end:P}of p){let{style:{backgroundColor:I=o}={}}=y,O=s!==!0;e.save(),e.fillStyle=I,nL(e,l,d,O&&aw(n,S,P)),e.beginPath();let V=!!i.pathSegment(e,y),G;if(O){V?e.closePath():cS(e,s,P,n);let X=!!s.pathSegment(e,C,{move:V,reverse:!0});G=V&&X,G||cS(e,s,S,n)}e.closePath(),e.fill(G?"evenodd":"nonzero"),e.restore()}}function nL(e,t,i,s){let n=t.chart.chartArea,{property:o,start:l,end:d}=s||{};if(o==="x"||o==="y"){let p,y,C,S;o==="x"?(p=l,y=n.top,C=d,S=n.bottom):(p=n.left,y=l,C=n.right,S=d),e.beginPath(),i&&(p=Math.max(p,i.left),C=Math.min(C,i.right),y=Math.max(y,i.top),S=Math.min(S,i.bottom)),e.rect(p,y,C-p,S-y),e.clip()}}function cS(e,t,i,s){let n=t.interpolate(i,s);n&&e.lineTo(n.x,n.y)}var rL={id:"filler",afterDatasetsUpdate(e,t,i){let s=(e.data.datasets||[]).length,n=[],o,l,d,p;for(l=0;l<s;++l)o=e.getDatasetMeta(l),d=o.dataset,p=null,d&&d.options&&d instanceof hm&&(p={visible:e.isDatasetVisible(l),index:l,fill:UA(d,l,s),chart:e,axis:o.controller.options.indexAxis,scale:o.vScale,line:d}),o.$filler=p,n.push(p);for(l=0;l<s;++l)p=n[l],!(!p||p.fill===!1)&&(p.fill=WA(n,l,i.propagate))},beforeDraw(e,t,i){let s=i.drawTime==="beforeDraw",n=e.getSortedVisibleDatasetMetas(),o=e.chartArea;for(let l=n.length-1;l>=0;--l){let d=n[l].$filler;d&&(d.line.updateControlPoints(o,d.axis),s&&d.fill&&j0(e.ctx,d,o))}},beforeDatasetsDraw(e,t,i){if(i.drawTime!=="beforeDatasetsDraw")return;let s=e.getSortedVisibleDatasetMetas();for(let n=s.length-1;n>=0;--n){let o=s[n].$filler;rS(o)&&j0(e.ctx,o,e.chartArea)}},beforeDatasetDraw(e,t,i){let s=t.meta.$filler;!rS(s)||i.drawTime!=="beforeDatasetDraw"||j0(e.ctx,s,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}},hS=(e,t)=>{let{boxHeight:i=t,boxWidth:s=t}=e;return e.usePointStyle&&(i=Math.min(i,t),s=e.pointStyleWidth||Math.min(s,t)),{boxWidth:s,boxHeight:i,itemHeight:Math.max(t,i)}},aL=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index,lm=class extends Cn{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,i,s){this.maxWidth=t,this.maxHeight=i,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){let t=this.options.labels||{},i=bi(t.generateLabels,[this.chart],this)||[];t.filter&&(i=i.filter(s=>t.filter(s,this.chart.data))),t.sort&&(i=i.sort((s,n)=>t.sort(s,n,this.chart.data))),this.options.reverse&&i.reverse(),this.legendItems=i}fit(){let{options:t,ctx:i}=this;if(!t.display){this.width=this.height=0;return}let s=t.labels,n=gs(s.font),o=n.size,l=this._computeTitleHeight(),{boxWidth:d,itemHeight:p}=hS(s,o),y,C;i.font=n.string,this.isHorizontal()?(y=this.maxWidth,C=this._fitRows(l,o,d,p)+10):(C=this.maxHeight,y=this._fitCols(l,n,d,p)+10),this.width=Math.min(y,t.maxWidth||this.maxWidth),this.height=Math.min(C,t.maxHeight||this.maxHeight)}_fitRows(t,i,s,n){let{ctx:o,maxWidth:l,options:{labels:{padding:d}}}=this,p=this.legendHitBoxes=[],y=this.lineWidths=[0],C=n+d,S=t;o.textAlign="left",o.textBaseline="middle";let P=-1,I=-C;return this.legendItems.forEach((O,V)=>{let G=s+i/2+o.measureText(O.text).width;(V===0||y[y.length-1]+G+2*d>l)&&(S+=C,y[y.length-(V>0?0:1)]=0,I+=C,P++),p[V]={left:0,top:I,row:P,width:G,height:n},y[y.length-1]+=G+d}),S}_fitCols(t,i,s,n){let{ctx:o,maxHeight:l,options:{labels:{padding:d}}}=this,p=this.legendHitBoxes=[],y=this.columnSizes=[],C=l-t,S=d,P=0,I=0,O=0,V=0;return this.legendItems.forEach((G,X)=>{let{itemWidth:Q,itemHeight:ae}=lL(s,i,o,G,n);X>0&&I+ae+2*d>C&&(S+=P+d,y.push({width:P,height:I}),O+=P+d,V++,P=I=0),p[X]={left:O,top:I,col:V,width:Q,height:ae},P=Math.max(P,Q),I+=ae+d}),S+=P,y.push({width:P,height:I}),S}adjustHitBoxes(){if(!this.options.display)return;let t=this._computeTitleHeight(),{legendHitBoxes:i,options:{align:s,labels:{padding:n},rtl:o}}=this,l=Ql(o,this.left,this.width);if(this.isHorizontal()){let d=0,p=zs(s,this.left+n,this.right-this.lineWidths[d]);for(let y of i)d!==y.row&&(d=y.row,p=zs(s,this.left+n,this.right-this.lineWidths[d])),y.top+=this.top+t+n,y.left=l.leftForLtr(l.x(p),y.width),p+=y.width+n}else{let d=0,p=zs(s,this.top+t+n,this.bottom-this.columnSizes[d].height);for(let y of i)y.col!==d&&(d=y.col,p=zs(s,this.top+t+n,this.bottom-this.columnSizes[d].height)),y.top=p,y.left+=this.left+n,y.left=l.leftForLtr(l.x(y.left),y.width),p+=y.height+n}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){let t=this.ctx;cp(t,this),this._draw(),hp(t)}}_draw(){let{options:t,columnSizes:i,lineWidths:s,ctx:n}=this,{align:o,labels:l}=t,d=xi.color,p=Ql(t.rtl,this.left,this.width),y=gs(l.font),{padding:C}=l,S=y.size,P=S/2,I;this.drawTitle(),n.textAlign=p.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=y.string;let{boxWidth:O,boxHeight:V,itemHeight:G}=hS(l,S),X=function(_e,Ae,Oe){if(isNaN(O)||O<=0||isNaN(V)||V<0)return;n.save();let Ge=kt(Oe.lineWidth,1);if(n.fillStyle=kt(Oe.fillStyle,d),n.lineCap=kt(Oe.lineCap,"butt"),n.lineDashOffset=kt(Oe.lineDashOffset,0),n.lineJoin=kt(Oe.lineJoin,"miter"),n.lineWidth=Ge,n.strokeStyle=kt(Oe.strokeStyle,d),n.setLineDash(kt(Oe.lineDash,[])),l.usePointStyle){let it={radius:V*Math.SQRT2/2,pointStyle:Oe.pointStyle,rotation:Oe.rotation,borderWidth:Ge},Xe=p.xPlus(_e,O/2),lt=Ae+P;_0(n,it,Xe,lt,l.pointStyleWidth&&O)}else{let it=Ae+Math.max((S-V)/2,0),Xe=p.leftForLtr(_e,O),lt=Ha(Oe.borderRadius);n.beginPath(),Object.values(lt).some(St=>St!==0)?jh(n,{x:Xe,y:it,w:O,h:V,radius:lt}):n.rect(Xe,it,O,V),n.fill(),Ge!==0&&n.stroke()}n.restore()},Q=function(_e,Ae,Oe){Va(n,Oe.text,_e,Ae+G/2,y,{strikethrough:Oe.hidden,textAlign:p.textAlign(Oe.textAlign)})},ae=this.isHorizontal(),me=this._computeTitleHeight();ae?I={x:zs(o,this.left+C,this.right-s[0]),y:this.top+C+me,line:0}:I={x:this.left+C,y:zs(o,this.top+me+C,this.bottom-i[0].height),line:0},F0(this.ctx,t.textDirection);let fe=G+C;this.legendItems.forEach((_e,Ae)=>{n.strokeStyle=_e.fontColor,n.fillStyle=_e.fontColor;let Oe=n.measureText(_e.text).width,Ge=p.textAlign(_e.textAlign||(_e.textAlign=l.textAlign)),it=O+P+Oe,Xe=I.x,lt=I.y;p.setWidth(this.width),ae?Ae>0&&Xe+it+C>this.right&&(lt=I.y+=fe,I.line++,Xe=I.x=zs(o,this.left+C,this.right-s[I.line])):Ae>0&&lt+fe>this.bottom&&(Xe=I.x=Xe+i[I.line].width+C,I.line++,lt=I.y=zs(o,this.top+me+C,this.bottom-i[I.line].height));let St=p.x(Xe);if(X(St,lt,_e),Xe=h1(Ge,Xe+O+P,ae?Xe+it:this.right,t.rtl),Q(p.x(Xe),lt,_e),ae)I.x+=it+C;else if(typeof _e.text!="string"){let Gt=y.lineHeight;I.y+=jS(_e,Gt)+C}else I.y+=fe}),I0(this.ctx,t.textDirection)}drawTitle(){let t=this.options,i=t.title,s=gs(i.font),n=Bs(i.padding);if(!i.display)return;let o=Ql(t.rtl,this.left,this.width),l=this.ctx,d=i.position,p=s.size/2,y=n.top+p,C,S=this.left,P=this.width;if(this.isHorizontal())P=Math.max(...this.lineWidths),C=this.top+y,S=zs(t.align,S,this.right-P);else{let O=this.columnSizes.reduce((V,G)=>Math.max(V,G.height),0);C=y+zs(t.align,this.top,this.bottom-O-t.labels.padding-this._computeTitleHeight())}let I=zs(d,S,S+P);l.textAlign=o.textAlign(Nf(d)),l.textBaseline="middle",l.strokeStyle=i.color,l.fillStyle=i.color,l.font=s.string,Va(l,i.text,I,C,s)}_computeTitleHeight(){let t=this.options.title,i=gs(t.font),s=Bs(t.padding);return t.display?i.lineHeight+s.height:0}_getLegendItemAt(t,i){let s,n,o;if(Jn(t,this.left,this.right)&&Jn(i,this.top,this.bottom)){for(o=this.legendHitBoxes,s=0;s<o.length;++s)if(n=o[s],Jn(t,n.left,n.left+n.width)&&Jn(i,n.top,n.top+n.height))return this.legendItems[s]}return null}handleEvent(t){let i=this.options;if(!uL(t.type,i))return;let s=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){let n=this._hoveredItem,o=aL(n,s);n&&!o&&bi(i.onLeave,[t,n,this],this),this._hoveredItem=s,s&&!o&&bi(i.onHover,[t,s,this],this)}else s&&bi(i.onClick,[t,s,this],this)}};function lL(e,t,i,s,n){let o=cL(s,e,t,i),l=hL(n,s,t.lineHeight);return{itemWidth:o,itemHeight:l}}function cL(e,t,i,s){let n=e.text;return n&&typeof n!="string"&&(n=n.reduce((o,l)=>o.length>l.length?o:l)),t+i.size/2+s.measureText(n).width}function hL(e,t,i){let s=e;return typeof t.text!="string"&&(s=jS(t,i)),s}function jS(e,t){let i=e.text?e.text.length:0;return t*i}function uL(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var dL={id:"legend",_element:lm,start(e,t,i){let s=e.legend=new lm({ctx:e.ctx,options:i,chart:e});qs.configure(e,s,i),qs.addBox(e,s)},stop(e){qs.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,i){let s=e.legend;qs.configure(e,s,i),s.options=i},afterUpdate(e){let t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,i){let s=t.datasetIndex,n=i.chart;n.isDatasetVisible(s)?(n.hide(s),t.hidden=!0):(n.show(s),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){let t=e.data.datasets,{labels:{usePointStyle:i,pointStyle:s,textAlign:n,color:o,useBorderRadius:l,borderRadius:d}}=e.legend.options;return e._getSortedDatasetMetas().map(p=>{let y=p.controller.getStyle(i?0:void 0),C=Bs(y.borderWidth);return{text:t[p.index].label,fillStyle:y.backgroundColor,fontColor:o,hidden:!p.visible,lineCap:y.borderCapStyle,lineDash:y.borderDash,lineDashOffset:y.borderDashOffset,lineJoin:y.borderJoinStyle,lineWidth:(C.width+C.height)/4,strokeStyle:y.borderColor,pointStyle:s||y.pointStyle,rotation:y.rotation,textAlign:n||y.textAlign,borderRadius:l&&(d||y.borderRadius),datasetIndex:p.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}},wp=class extends Cn{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,i){let s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=i;let n=Si(s.text)?s.text.length:1;this._padding=Bs(s.padding);let o=n*gs(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=o:this.width=o}isHorizontal(){let t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){let{top:i,left:s,bottom:n,right:o,options:l}=this,d=l.align,p=0,y,C,S;return this.isHorizontal()?(C=zs(d,s,o),S=i+t,y=o-s):(l.position==="left"?(C=s+t,S=zs(d,n,i),p=Qt*-.5):(C=o-t,S=zs(d,i,n),p=Qt*.5),y=n-i),{titleX:C,titleY:S,maxWidth:y,rotation:p}}draw(){let t=this.ctx,i=this.options;if(!i.display)return;let s=gs(i.font),o=s.lineHeight/2+this._padding.top,{titleX:l,titleY:d,maxWidth:p,rotation:y}=this._drawArgs(o);Va(t,i.text,0,0,s,{color:i.color,maxWidth:p,rotation:y,textAlign:Nf(i.align),textBaseline:"middle",translation:[l,d]})}};function pL(e,t){let i=new wp({ctx:e.ctx,options:t,chart:e});qs.configure(e,i,t),qs.addBox(e,i),e.titleBlock=i}var gL={id:"title",_element:wp,start(e,t,i){pL(e,i)},stop(e){let t=e.titleBlock;qs.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,i){let s=e.titleBlock;qs.configure(e,s,i),s.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},Qf=new WeakMap,fL={id:"subtitle",start(e,t,i){let s=new wp({ctx:e.ctx,options:i,chart:e});qs.configure(e,s,i),qs.addBox(e,s),Qf.set(e,s)},stop(e){qs.removeBox(e,Qf.get(e)),Qf.delete(e)},beforeUpdate(e,t,i){let s=Qf.get(e);qs.configure(e,s,i),s.options=i},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},vp={average(e){if(!e.length)return!1;let t,i,s=new Set,n=0,o=0;for(t=0,i=e.length;t<i;++t){let d=e[t].element;if(d&&d.hasValue()){let p=d.tooltipPosition();s.add(p.x),n+=p.y,++o}}return o===0||s.size===0?!1:{x:[...s].reduce((d,p)=>d+p)/s.size,y:n/o}},nearest(e,t){if(!e.length)return!1;let i=t.x,s=t.y,n=Number.POSITIVE_INFINITY,o,l,d;for(o=0,l=e.length;o<l;++o){let p=e[o].element;if(p&&p.hasValue()){let y=p.getCenterPoint(),C=Of(t,y);C<n&&(n=C,d=p)}}if(d){let p=d.tooltipPosition();i=p.x,s=p.y}return{x:i,y:s}}};function er(e,t){return t&&(Si(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function qr(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function mL(e,t){let{element:i,datasetIndex:s,index:n}=t,o=e.getDatasetMeta(s).controller,{label:l,value:d}=o.getLabelAndValue(n);return{chart:e,label:l,parsed:o.getParsed(n),raw:e.data.datasets[s].data[n],formattedValue:d,dataset:o.getDataset(),dataIndex:n,datasetIndex:s,element:i}}function uS(e,t){let i=e.chart.ctx,{body:s,footer:n,title:o}=e,{boxWidth:l,boxHeight:d}=t,p=gs(t.bodyFont),y=gs(t.titleFont),C=gs(t.footerFont),S=o.length,P=n.length,I=s.length,O=Bs(t.padding),V=O.height,G=0,X=s.reduce((me,fe)=>me+fe.before.length+fe.lines.length+fe.after.length,0);if(X+=e.beforeBody.length+e.afterBody.length,S&&(V+=S*y.lineHeight+(S-1)*t.titleSpacing+t.titleMarginBottom),X){let me=t.displayColors?Math.max(d,p.lineHeight):p.lineHeight;V+=I*me+(X-I)*p.lineHeight+(X-1)*t.bodySpacing}P&&(V+=t.footerMarginTop+P*C.lineHeight+(P-1)*t.footerSpacing);let Q=0,ae=function(me){G=Math.max(G,i.measureText(me).width+Q)};return i.save(),i.font=y.string,ai(e.title,ae),i.font=p.string,ai(e.beforeBody.concat(e.afterBody),ae),Q=t.displayColors?l+2+t.boxPadding:0,ai(s,me=>{ai(me.before,ae),ai(me.lines,ae),ai(me.after,ae)}),Q=0,i.font=C.string,ai(e.footer,ae),i.restore(),G+=O.width,{width:G,height:V}}function vL(e,t){let{y:i,height:s}=t;return i<s/2?"top":i>e.height-s/2?"bottom":"center"}function yL(e,t,i,s){let{x:n,width:o}=s,l=i.caretSize+i.caretPadding;if(e==="left"&&n+o+l>t.width||e==="right"&&n-o-l<0)return!0}function wL(e,t,i,s){let{x:n,width:o}=i,{width:l,chartArea:{left:d,right:p}}=e,y="center";return s==="center"?y=n<=(d+p)/2?"left":"right":n<=o/2?y="left":n>=l-o/2&&(y="right"),yL(y,e,t,i)&&(y="center"),y}function dS(e,t,i){let s=i.yAlign||t.yAlign||vL(e,i);return{xAlign:i.xAlign||t.xAlign||wL(e,t,i,s),yAlign:s}}function CL(e,t){let{x:i,width:s}=e;return t==="right"?i-=s:t==="center"&&(i-=s/2),i}function bL(e,t,i){let{y:s,height:n}=e;return t==="top"?s+=i:t==="bottom"?s-=n+i:s-=n/2,s}function pS(e,t,i,s){let{caretSize:n,caretPadding:o,cornerRadius:l}=e,{xAlign:d,yAlign:p}=i,y=n+o,{topLeft:C,topRight:S,bottomLeft:P,bottomRight:I}=Ha(l),O=CL(t,d),V=bL(t,p,y);return p==="center"?d==="left"?O+=y:d==="right"&&(O-=y):d==="left"?O-=Math.max(C,P)+n:d==="right"&&(O+=Math.max(S,I)+n),{x:Cs(O,0,s.width-t.width),y:Cs(V,0,s.height-t.height)}}function Jf(e,t,i){let s=Bs(i.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-s.right:e.x+s.left}function gS(e){return er([],qr(e))}function xL(e,t,i){return jr(e,{tooltip:t,tooltipItems:i,type:"tooltip"})}function fS(e,t){let i=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return i?e.override(i):e}var $S={beforeTitle:Qn,title(e){if(e.length>0){let t=e[0],i=t.chart.data.labels,s=i?i.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(s>0&&t.dataIndex<s)return i[t.dataIndex]}return""},afterTitle:Qn,beforeBody:Qn,beforeLabel:Qn,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");let i=e.formattedValue;return qt(i)||(t+=i),t},labelColor(e){let i=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:i.borderColor,backgroundColor:i.backgroundColor,borderWidth:i.borderWidth,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){let i=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:i.pointStyle,rotation:i.rotation}},afterLabel:Qn,afterBody:Qn,beforeFooter:Qn,footer:Qn,afterFooter:Qn};function go(e,t,i,s){let n=e[t].call(i,s);return typeof n>"u"?$S[t].call(i,s):n}var mS=(()=>{class e extends Cn{static positioners=vp;constructor(i){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=i.chart,this.options=i.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(i){this.options=i,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){let i=this._cachedAnimations;if(i)return i;let s=this.chart,n=this.options.setContext(this.getContext()),o=n.enabled&&s.options.animation&&n.animations,l=new sm(this.chart,o);return o._cacheable&&(this._cachedAnimations=Object.freeze(l)),l}getContext(){return this.$context||(this.$context=xL(this.chart.getContext(),this,this._tooltipItems))}getTitle(i,s){let{callbacks:n}=s,o=go(n,"beforeTitle",this,i),l=go(n,"title",this,i),d=go(n,"afterTitle",this,i),p=[];return p=er(p,qr(o)),p=er(p,qr(l)),p=er(p,qr(d)),p}getBeforeBody(i,s){return gS(go(s.callbacks,"beforeBody",this,i))}getBody(i,s){let{callbacks:n}=s,o=[];return ai(i,l=>{let d={before:[],lines:[],after:[]},p=fS(n,l);er(d.before,qr(go(p,"beforeLabel",this,l))),er(d.lines,go(p,"label",this,l)),er(d.after,qr(go(p,"afterLabel",this,l))),o.push(d)}),o}getAfterBody(i,s){return gS(go(s.callbacks,"afterBody",this,i))}getFooter(i,s){let{callbacks:n}=s,o=go(n,"beforeFooter",this,i),l=go(n,"footer",this,i),d=go(n,"afterFooter",this,i),p=[];return p=er(p,qr(o)),p=er(p,qr(l)),p=er(p,qr(d)),p}_createItems(i){let s=this._active,n=this.chart.data,o=[],l=[],d=[],p=[],y,C;for(y=0,C=s.length;y<C;++y)p.push(mL(this.chart,s[y]));return i.filter&&(p=p.filter((S,P,I)=>i.filter(S,P,I,n))),i.itemSort&&(p=p.sort((S,P)=>i.itemSort(S,P,n))),ai(p,S=>{let P=fS(i.callbacks,S);o.push(go(P,"labelColor",this,S)),l.push(go(P,"labelPointStyle",this,S)),d.push(go(P,"labelTextColor",this,S))}),this.labelColors=o,this.labelPointStyles=l,this.labelTextColors=d,this.dataPoints=p,p}update(i,s){let n=this.options.setContext(this.getContext()),o=this._active,l,d=[];if(!o.length)this.opacity!==0&&(l={opacity:0});else{let p=vp[n.position].call(this,o,this._eventPosition);d=this._createItems(n),this.title=this.getTitle(d,n),this.beforeBody=this.getBeforeBody(d,n),this.body=this.getBody(d,n),this.afterBody=this.getAfterBody(d,n),this.footer=this.getFooter(d,n);let y=this._size=uS(this,n),C=Object.assign({},p,y),S=dS(this.chart,n,C),P=pS(n,C,S,this.chart);this.xAlign=S.xAlign,this.yAlign=S.yAlign,l={opacity:1,x:P.x,y:P.y,width:y.width,height:y.height,caretX:p.x,caretY:p.y}}this._tooltipItems=d,this.$context=void 0,l&&this._resolveAnimations().update(this,l),i&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:s})}drawCaret(i,s,n,o){let l=this.getCaretPosition(i,n,o);s.lineTo(l.x1,l.y1),s.lineTo(l.x2,l.y2),s.lineTo(l.x3,l.y3)}getCaretPosition(i,s,n){let{xAlign:o,yAlign:l}=this,{caretSize:d,cornerRadius:p}=n,{topLeft:y,topRight:C,bottomLeft:S,bottomRight:P}=Ha(p),{x:I,y:O}=i,{width:V,height:G}=s,X,Q,ae,me,fe,_e;return l==="center"?(fe=O+G/2,o==="left"?(X=I,Q=X-d,me=fe+d,_e=fe-d):(X=I+V,Q=X+d,me=fe-d,_e=fe+d),ae=X):(o==="left"?Q=I+Math.max(y,S)+d:o==="right"?Q=I+V-Math.max(C,P)-d:Q=this.caretX,l==="top"?(me=O,fe=me-d,X=Q-d,ae=Q+d):(me=O+G,fe=me+d,X=Q+d,ae=Q-d),_e=me),{x1:X,x2:Q,x3:ae,y1:me,y2:fe,y3:_e}}drawTitle(i,s,n){let o=this.title,l=o.length,d,p,y;if(l){let C=Ql(n.rtl,this.x,this.width);for(i.x=Jf(this,n.titleAlign,n),s.textAlign=C.textAlign(n.titleAlign),s.textBaseline="middle",d=gs(n.titleFont),p=n.titleSpacing,s.fillStyle=n.titleColor,s.font=d.string,y=0;y<l;++y)s.fillText(o[y],C.x(i.x),i.y+d.lineHeight/2),i.y+=d.lineHeight+p,y+1===l&&(i.y+=n.titleMarginBottom-p)}}_drawColorBox(i,s,n,o,l){let d=this.labelColors[n],p=this.labelPointStyles[n],{boxHeight:y,boxWidth:C}=l,S=gs(l.bodyFont),P=Jf(this,"left",l),I=o.x(P),O=y<S.lineHeight?(S.lineHeight-y)/2:0,V=s.y+O;if(l.usePointStyle){let G={radius:Math.min(C,y)/2,pointStyle:p.pointStyle,rotation:p.rotation,borderWidth:1},X=o.leftForLtr(I,C)+C/2,Q=V+y/2;i.strokeStyle=l.multiKeyBackground,i.fillStyle=l.multiKeyBackground,Wf(i,G,X,Q),i.strokeStyle=d.borderColor,i.fillStyle=d.backgroundColor,Wf(i,G,X,Q)}else{i.lineWidth=Zt(d.borderWidth)?Math.max(...Object.values(d.borderWidth)):d.borderWidth||1,i.strokeStyle=d.borderColor,i.setLineDash(d.borderDash||[]),i.lineDashOffset=d.borderDashOffset||0;let G=o.leftForLtr(I,C),X=o.leftForLtr(o.xPlus(I,1),C-2),Q=Ha(d.borderRadius);Object.values(Q).some(ae=>ae!==0)?(i.beginPath(),i.fillStyle=l.multiKeyBackground,jh(i,{x:G,y:V,w:C,h:y,radius:Q}),i.fill(),i.stroke(),i.fillStyle=d.backgroundColor,i.beginPath(),jh(i,{x:X,y:V+1,w:C-2,h:y-2,radius:Q}),i.fill()):(i.fillStyle=l.multiKeyBackground,i.fillRect(G,V,C,y),i.strokeRect(G,V,C,y),i.fillStyle=d.backgroundColor,i.fillRect(X,V+1,C-2,y-2))}i.fillStyle=this.labelTextColors[n]}drawBody(i,s,n){let{body:o}=this,{bodySpacing:l,bodyAlign:d,displayColors:p,boxHeight:y,boxWidth:C,boxPadding:S}=n,P=gs(n.bodyFont),I=P.lineHeight,O=0,V=Ql(n.rtl,this.x,this.width),G=function(Ge){s.fillText(Ge,V.x(i.x+O),i.y+I/2),i.y+=I+l},X=V.textAlign(d),Q,ae,me,fe,_e,Ae,Oe;for(s.textAlign=d,s.textBaseline="middle",s.font=P.string,i.x=Jf(this,X,n),s.fillStyle=n.bodyColor,ai(this.beforeBody,G),O=p&&X!=="right"?d==="center"?C/2+S:C+2+S:0,fe=0,Ae=o.length;fe<Ae;++fe){for(Q=o[fe],ae=this.labelTextColors[fe],s.fillStyle=ae,ai(Q.before,G),me=Q.lines,p&&me.length&&(this._drawColorBox(s,i,fe,V,n),I=Math.max(P.lineHeight,y)),_e=0,Oe=me.length;_e<Oe;++_e)G(me[_e]),I=P.lineHeight;ai(Q.after,G)}O=0,I=P.lineHeight,ai(this.afterBody,G),i.y-=l}drawFooter(i,s,n){let o=this.footer,l=o.length,d,p;if(l){let y=Ql(n.rtl,this.x,this.width);for(i.x=Jf(this,n.footerAlign,n),i.y+=n.footerMarginTop,s.textAlign=y.textAlign(n.footerAlign),s.textBaseline="middle",d=gs(n.footerFont),s.fillStyle=n.footerColor,s.font=d.string,p=0;p<l;++p)s.fillText(o[p],y.x(i.x),i.y+d.lineHeight/2),i.y+=d.lineHeight+n.footerSpacing}}drawBackground(i,s,n,o){let{xAlign:l,yAlign:d}=this,{x:p,y}=i,{width:C,height:S}=n,{topLeft:P,topRight:I,bottomLeft:O,bottomRight:V}=Ha(o.cornerRadius);s.fillStyle=o.backgroundColor,s.strokeStyle=o.borderColor,s.lineWidth=o.borderWidth,s.beginPath(),s.moveTo(p+P,y),d==="top"&&this.drawCaret(i,s,n,o),s.lineTo(p+C-I,y),s.quadraticCurveTo(p+C,y,p+C,y+I),d==="center"&&l==="right"&&this.drawCaret(i,s,n,o),s.lineTo(p+C,y+S-V),s.quadraticCurveTo(p+C,y+S,p+C-V,y+S),d==="bottom"&&this.drawCaret(i,s,n,o),s.lineTo(p+O,y+S),s.quadraticCurveTo(p,y+S,p,y+S-O),d==="center"&&l==="left"&&this.drawCaret(i,s,n,o),s.lineTo(p,y+P),s.quadraticCurveTo(p,y,p+P,y),s.closePath(),s.fill(),o.borderWidth>0&&s.stroke()}_updateAnimationTarget(i){let s=this.chart,n=this.$animations,o=n&&n.x,l=n&&n.y;if(o||l){let d=vp[i.position].call(this,this._active,this._eventPosition);if(!d)return;let p=this._size=uS(this,i),y=Object.assign({},d,this._size),C=dS(s,i,y),S=pS(i,y,C,s);(o._to!==S.x||l._to!==S.y)&&(this.xAlign=C.xAlign,this.yAlign=C.yAlign,this.width=p.width,this.height=p.height,this.caretX=d.x,this.caretY=d.y,this._resolveAnimations().update(this,S))}}_willRender(){return!!this.opacity}draw(i){let s=this.options.setContext(this.getContext()),n=this.opacity;if(!n)return;this._updateAnimationTarget(s);let o={width:this.width,height:this.height},l={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;let d=Bs(s.padding),p=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;s.enabled&&p&&(i.save(),i.globalAlpha=n,this.drawBackground(l,i,o,s),F0(i,s.textDirection),l.y+=d.top,this.drawTitle(l,i,s),this.drawBody(l,i,s),this.drawFooter(l,i,s),I0(i,s.textDirection),i.restore())}getActiveElements(){return this._active||[]}setActiveElements(i,s){let n=this._active,o=i.map(({datasetIndex:p,index:y})=>{let C=this.chart.getDatasetMeta(p);if(!C)throw new Error("Cannot find a dataset at index "+p);return{datasetIndex:p,element:C.data[y],index:y}}),l=!ap(n,o),d=this._positionChanged(o,s);(l||d)&&(this._active=o,this._eventPosition=s,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(i,s,n=!0){if(s&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;let o=this.options,l=this._active||[],d=this._getActiveElements(i,l,s,n),p=this._positionChanged(d,i),y=s||!ap(d,l)||p;return y&&(this._active=d,(o.enabled||o.external)&&(this._eventPosition={x:i.x,y:i.y},this.update(!0,s))),y}_getActiveElements(i,s,n,o){let l=this.options;if(i.type==="mouseout")return[];if(!o)return s.filter(p=>this.chart.data.datasets[p.datasetIndex]&&this.chart.getDatasetMeta(p.datasetIndex).controller.getParsed(p.index)!==void 0);let d=this.chart.getElementsAtEventForMode(i,l.mode,l,n);return l.reverse&&d.reverse(),d}_positionChanged(i,s){let{caretX:n,caretY:o,options:l}=this,d=vp[l.position].call(this,i,s);return d!==!1&&(n!==d.x||o!==d.y)}}return e})(),_L={id:"tooltip",_element:mS,positioners:vp,afterInit(e,t,i){i&&(e.tooltip=new mS({chart:e,options:i}))},beforeUpdate(e,t,i){e.tooltip&&e.tooltip.initialize(i)},reset(e,t,i){e.tooltip&&e.tooltip.initialize(i)},afterDraw(e){let t=e.tooltip;if(t&&t._willRender()){let i={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",ht(Se({},i),{cancelable:!0}))===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",i)}},afterEvent(e,t){if(e.tooltip){let i=t.replay;e.tooltip.handleEvent(t.event,i,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:$S},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},SL=Object.freeze({__proto__:null,Colors:OA,Decimation:HA,Filler:rL,Legend:dL,SubTitle:fL,Title:gL,Tooltip:_L}),RL=(e,t,i,s)=>(typeof t=="string"?(i=e.push(t)-1,s.unshift({index:i,label:t})):isNaN(t)&&(i=null),i);function EL(e,t,i,s){let n=e.indexOf(t);if(n===-1)return RL(e,t,i,s);let o=e.lastIndexOf(t);return n!==o?i:n}var PL=(e,t)=>e===null?null:Cs(Math.round(e),0,t);function vS(e){let t=this.getLabels();return e>=0&&e<t.length?t[e]:e}var ML=(()=>{class e extends tc{static id="category";static defaults={ticks:{callback:vS}};constructor(i){super(i),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(i){let s=this._addedLabels;if(s.length){let n=this.getLabels();for(let{index:o,label:l}of s)n[o]===l&&n.splice(o,1);this._addedLabels=[]}super.init(i)}parse(i,s){if(qt(i))return null;let n=this.getLabels();return s=isFinite(s)&&n[s]===i?s:EL(n,i,kt(s,i),this._addedLabels),PL(s,n.length-1)}determineDataLimits(){let{minDefined:i,maxDefined:s}=this.getUserBounds(),{min:n,max:o}=this.getMinMax(!0);this.options.bounds==="ticks"&&(i||(n=0),s||(o=this.getLabels().length-1)),this.min=n,this.max=o}buildTicks(){let i=this.min,s=this.max,n=this.options.offset,o=[],l=this.getLabels();l=i===0&&s===l.length-1?l:l.slice(i,s+1),this._valueRange=Math.max(l.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let d=i;d<=s;d++)o.push({value:d});return o}getLabelForValue(i){return vS.call(this,i)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(i){return typeof i!="number"&&(i=this.parse(i)),i===null?NaN:this.getPixelForDecimal((i-this._startValue)/this._valueRange)}getPixelForTick(i){let s=this.ticks;return i<0||i>s.length-1?null:this.getPixelForValue(s[i].value)}getValueForPixel(i){return Math.round(this._startValue+this.getDecimalForPixel(i)*this._valueRange)}getBasePixel(){return this.bottom}}return e})();function TL(e,t){let i=[],{bounds:n,step:o,min:l,max:d,precision:p,count:y,maxTicks:C,maxDigits:S,includeBounds:P}=e,I=o||1,O=C-1,{min:V,max:G}=t,X=!qt(l),Q=!qt(d),ae=!qt(y),me=(G-V)/(S+1),fe=h0((G-V)/O/I)*I,_e,Ae,Oe,Ge;if(fe<1e-14&&!X&&!Q)return[{value:V},{value:G}];Ge=Math.ceil(G/fe)-Math.floor(V/fe),Ge>O&&(fe=h0(Ge*fe/O/I)*I),qt(p)||(_e=Math.pow(10,p),fe=Math.ceil(fe*_e)/_e),n==="ticks"?(Ae=Math.floor(V/fe)*fe,Oe=Math.ceil(G/fe)*fe):(Ae=V,Oe=G),X&&Q&&o&&s1((d-l)/o,fe/1e3)?(Ge=Math.round(Math.min((d-l)/fe,C)),fe=(d-l)/Ge,Ae=l,Oe=d):ae?(Ae=X?l:Ae,Oe=Q?d:Oe,Ge=y-1,fe=(Oe-Ae)/Ge):(Ge=(Oe-Ae)/fe,Gh(Ge,Math.round(Ge),fe/1e3)?Ge=Math.round(Ge):Ge=Math.ceil(Ge));let it=Math.max(d0(fe),d0(Ae));_e=Math.pow(10,qt(p)?it:p),Ae=Math.round(Ae*_e)/_e,Oe=Math.round(Oe*_e)/_e;let Xe=0;for(X&&(P&&Ae!==l?(i.push({value:l}),Ae<l&&Xe++,Gh(Math.round((Ae+Xe*fe)*_e)/_e,l,yS(l,me,e))&&Xe++):Ae<l&&Xe++);Xe<Ge;++Xe){let lt=Math.round((Ae+Xe*fe)*_e)/_e;if(Q&&lt>d)break;i.push({value:lt})}return Q&&P&&Oe!==d?i.length&&Gh(i[i.length-1].value,d,yS(d,me,e))?i[i.length-1].value=d:i.push({value:d}):(!Q||Oe===d)&&i.push({value:Oe}),i}function yS(e,t,{horizontal:i,minRotation:s}){let n=Xo(s),o=(i?Math.sin(n):Math.cos(n))||.001,l=.75*t*(""+e).length;return Math.min(t/o,l)}var Kh=class extends tc{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,i){return qt(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){let{beginAtZero:t}=this.options,{minDefined:i,maxDefined:s}=this.getUserBounds(),{min:n,max:o}=this,l=p=>n=i?n:p,d=p=>o=s?o:p;if(t){let p=wn(n),y=wn(o);p<0&&y<0?d(0):p>0&&y>0&&l(0)}if(n===o){let p=o===0?1:Math.abs(o*.05);d(o+p),t||l(n-p)}this.min=n,this.max=o}getTickLimit(){let t=this.options.ticks,{maxTicksLimit:i,stepSize:s}=t,n;return s?(n=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,n>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${n} ticks. Limiting to 1000.`),n=1e3)):(n=this.computeTickLimit(),i=i||11),i&&(n=Math.min(i,n)),n}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){let t=this.options,i=t.ticks,s=this.getTickLimit();s=Math.max(2,s);let n={maxTicks:s,bounds:t.bounds,min:t.min,max:t.max,precision:i.precision,step:i.stepSize,count:i.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:i.minRotation||0,includeBounds:i.includeBounds!==!1},o=this._range||this,l=TL(n,o);return t.bounds==="ticks"&&u0(l,this,"value"),t.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}configure(){let t=this.ticks,i=this.min,s=this.max;if(super.configure(),this.options.offset&&t.length){let n=(s-i)/Math.max(t.length-1,1)/2;i-=n,s+=n}this._startValue=i,this._endValue=s,this._valueRange=s-i}getLabelForValue(t){return Uh(t,this.chart.options.locale,this.options.ticks.format)}},lw=class extends Kh{static id="linear";static defaults={ticks:{callback:lp.formatters.numeric}};determineDataLimits(){let{min:t,max:i}=this.getMinMax(!0);this.min=Wi(t)?t:0,this.max=Wi(i)?i:1,this.handleTickRangeOptions()}computeTickLimit(){let t=this.isHorizontal(),i=t?this.width:this.height,s=Xo(this.options.ticks.minRotation),n=(t?Math.sin(s):Math.cos(s))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(i/Math.min(40,o.lineHeight/n))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}},Cp=e=>Math.floor(Wr(e)),ec=(e,t)=>Math.pow(10,Cp(e)+t);function wS(e){return e/Math.pow(10,Cp(e))===1}function CS(e,t,i){let s=Math.pow(10,i),n=Math.floor(e/s);return Math.ceil(t/s)-n}function DL(e,t){let i=t-e,s=Cp(i);for(;CS(e,t,s)>10;)s++;for(;CS(e,t,s)<10;)s--;return Math.min(s,Cp(e))}function FL(e,{min:t,max:i}){t=po(e.min,t);let s=[],n=Cp(t),o=DL(t,i),l=o<0?Math.pow(10,Math.abs(o)):1,d=Math.pow(10,o),p=n>o?Math.pow(10,n):0,y=Math.round((t-p)*l)/l,C=Math.floor((t-p)/d/10)*d*10,S=Math.floor((y-C)/Math.pow(10,o)),P=po(e.min,Math.round((p+C+S*Math.pow(10,o))*l)/l);for(;P<i;)s.push({value:P,major:wS(P),significand:S}),S>=10?S=S<15?15:20:S++,S>=20&&(o++,S=2,l=o>=0?1:l),P=Math.round((p+C+S*Math.pow(10,o))*l)/l;let I=po(e.max,P);return s.push({value:I,major:wS(I),significand:S}),s}var cw=class extends tc{static id="logarithmic";static defaults={ticks:{callback:lp.formatters.logarithmic,major:{enabled:!0}}};constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,i){let s=Kh.prototype.parse.apply(this,[t,i]);if(s===0){this._zero=!0;return}return Wi(s)&&s>0?s:null}determineDataLimits(){let{min:t,max:i}=this.getMinMax(!0);this.min=Wi(t)?Math.max(0,t):null,this.max=Wi(i)?Math.max(0,i):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Wi(this._userMin)&&(this.min=t===ec(this.min,0)?ec(this.min,-1):ec(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){let{minDefined:t,maxDefined:i}=this.getUserBounds(),s=this.min,n=this.max,o=d=>s=t?s:d,l=d=>n=i?n:d;s===n&&(s<=0?(o(1),l(10)):(o(ec(s,-1)),l(ec(n,1)))),s<=0&&o(ec(n,-1)),n<=0&&l(ec(s,1)),this.min=s,this.max=n}buildTicks(){let t=this.options,i={min:this._userMin,max:this._userMax},s=FL(i,this);return t.bounds==="ticks"&&u0(s,this,"value"),t.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(t){return t===void 0?"0":Uh(t,this.chart.options.locale,this.options.ticks.format)}configure(){let t=this.min;super.configure(),this._startValue=Wr(t),this._valueRange=Wr(this.max)-Wr(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(Wr(t)-this._startValue)/this._valueRange)}getValueForPixel(t){let i=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+i*this._valueRange)}};function hw(e){let t=e.ticks;if(t.display&&e.display){let i=Bs(t.backdropPadding);return kt(t.font&&t.font.size,xi.font.size)+i.height}return 0}function IL(e,t,i){return i=Si(i)?i:[i],{w:d1(e,t.string,i),h:i.length*t.lineHeight}}function bS(e,t,i,s,n){return e===s||e===n?{start:t-i/2,end:t+i/2}:e<s||e>n?{start:t-i,end:t}:{start:t,end:t+i}}function kL(e){let t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},i=Object.assign({},t),s=[],n=[],o=e._pointLabels.length,l=e.options.pointLabels,d=l.centerPointLabels?Qt/o:0;for(let p=0;p<o;p++){let y=l.setContext(e.getPointLabelContext(p));n[p]=y.padding;let C=e.getPointPosition(p,e.drawingArea+n[p],d),S=gs(y.font),P=IL(e.ctx,S,e._pointLabels[p]);s[p]=P;let I=Os(e.getIndexAngle(p)+d),O=Math.round(Vf(I)),V=bS(O,C.x,P.w,0,180),G=bS(O,C.y,P.h,90,270);AL(i,t,I,V,G)}e.setCenterPoint(t.l-i.l,i.r-t.r,t.t-i.t,i.b-t.b),e._pointLabelItems=zL(e,s,n)}function AL(e,t,i,s,n){let o=Math.abs(Math.sin(i)),l=Math.abs(Math.cos(i)),d=0,p=0;s.start<t.l?(d=(t.l-s.start)/o,e.l=Math.min(e.l,t.l-d)):s.end>t.r&&(d=(s.end-t.r)/o,e.r=Math.max(e.r,t.r+d)),n.start<t.t?(p=(t.t-n.start)/l,e.t=Math.min(e.t,t.t-p)):n.end>t.b&&(p=(n.end-t.b)/l,e.b=Math.max(e.b,t.b+p))}function LL(e,t,i){let s=e.drawingArea,{extra:n,additionalAngle:o,padding:l,size:d}=i,p=e.getPointPosition(t,s+n+l,o),y=Math.round(Vf(Os(p.angle+Yi))),C=HL(p.y,d.h,y),S=BL(y),P=VL(p.x,d.w,S);return{visible:!0,x:p.x,y:C,textAlign:S,left:P,top:C,right:P+d.w,bottom:C+d.h}}function OL(e,t){if(!t)return!0;let{left:i,top:s,right:n,bottom:o}=e;return!(Yn({x:i,y:s},t)||Yn({x:i,y:o},t)||Yn({x:n,y:s},t)||Yn({x:n,y:o},t))}function zL(e,t,i){let s=[],n=e._pointLabels.length,o=e.options,{centerPointLabels:l,display:d}=o.pointLabels,p={extra:hw(o)/2,additionalAngle:l?Qt/n:0},y;for(let C=0;C<n;C++){p.padding=i[C],p.size=t[C];let S=LL(e,C,p);s.push(S),d==="auto"&&(S.visible=OL(S,y),S.visible&&(y=S))}return s}function BL(e){return e===0||e===180?"center":e<180?"left":"right"}function VL(e,t,i){return i==="right"?e-=t:i==="center"&&(e-=t/2),e}function HL(e,t,i){return i===90||i===270?e-=t/2:(i>270||i<90)&&(e-=t),e}function NL(e,t,i){let{left:s,top:n,right:o,bottom:l}=i,{backdropColor:d}=t;if(!qt(d)){let p=Ha(t.borderRadius),y=Bs(t.backdropPadding);e.fillStyle=d;let C=s-y.left,S=n-y.top,P=o-s+y.width,I=l-n+y.height;Object.values(p).some(O=>O!==0)?(e.beginPath(),jh(e,{x:C,y:S,w:P,h:I,radius:p}),e.fill()):e.fillRect(C,S,P,I)}}function GL(e,t){let{ctx:i,options:{pointLabels:s}}=e;for(let n=t-1;n>=0;n--){let o=e._pointLabelItems[n];if(!o.visible)continue;let l=s.setContext(e.getPointLabelContext(n));NL(i,l,o);let d=gs(l.font),{x:p,y,textAlign:C}=o;Va(i,e._pointLabels[n],p,y+d.lineHeight/2,d,{color:l.color,textAlign:C,textBaseline:"middle"})}}function qS(e,t,i,s){let{ctx:n}=e;if(i)n.arc(e.xCenter,e.yCenter,t,0,Ri);else{let o=e.getPointPosition(0,t);n.moveTo(o.x,o.y);for(let l=1;l<s;l++)o=e.getPointPosition(l,t),n.lineTo(o.x,o.y)}}function WL(e,t,i,s,n){let o=e.ctx,l=t.circular,{color:d,lineWidth:p}=t;!l&&!s||!d||!p||i<0||(o.save(),o.strokeStyle=d,o.lineWidth=p,o.setLineDash(n.dash||[]),o.lineDashOffset=n.dashOffset,o.beginPath(),qS(e,i,l,s),o.closePath(),o.stroke(),o.restore())}function UL(e,t,i){return jr(e,{label:i,index:t,type:"pointLabel"})}var uw=class extends Kh{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:lp.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){let t=this._padding=Bs(hw(this.options)/2),i=this.width=this.maxWidth-t.width,s=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+i/2+t.left),this.yCenter=Math.floor(this.top+s/2+t.top),this.drawingArea=Math.floor(Math.min(i,s)/2)}determineDataLimits(){let{min:t,max:i}=this.getMinMax(!1);this.min=Wi(t)&&!isNaN(t)?t:0,this.max=Wi(i)&&!isNaN(i)?i:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/hw(this.options))}generateTickLabels(t){Kh.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((i,s)=>{let n=bi(this.options.pointLabels.callback,[i,s],this);return n||n===0?n:""}).filter((i,s)=>this.chart.getDataVisibility(s))}fit(){let t=this.options;t.display&&t.pointLabels.display?kL(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,i,s,n){this.xCenter+=Math.floor((t-i)/2),this.yCenter+=Math.floor((s-n)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,i,s,n))}getIndexAngle(t){let i=Ri/(this._pointLabels.length||1),s=this.options.startAngle||0;return Os(t*i+Xo(s))}getDistanceFromCenterForValue(t){if(qt(t))return NaN;let i=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*i:(t-this.min)*i}getValueForDistanceFromCenter(t){if(qt(t))return NaN;let i=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-i:this.min+i}getPointLabelContext(t){let i=this._pointLabels||[];if(t>=0&&t<i.length){let s=i[t];return UL(this.getContext(),t,s)}}getPointPosition(t,i,s=0){let n=this.getIndexAngle(t)-Yi+s;return{x:Math.cos(n)*i+this.xCenter,y:Math.sin(n)*i+this.yCenter,angle:n}}getPointPositionForValue(t,i){return this.getPointPosition(t,this.getDistanceFromCenterForValue(i))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){let{left:i,top:s,right:n,bottom:o}=this._pointLabelItems[t];return{left:i,top:s,right:n,bottom:o}}drawBackground(){let{backgroundColor:t,grid:{circular:i}}=this.options;if(t){let s=this.ctx;s.save(),s.beginPath(),qS(this,this.getDistanceFromCenterForValue(this._endValue),i,this._pointLabels.length),s.closePath(),s.fillStyle=t,s.fill(),s.restore()}}drawGrid(){let t=this.ctx,i=this.options,{angleLines:s,grid:n,border:o}=i,l=this._pointLabels.length,d,p,y;if(i.pointLabels.display&&GL(this,l),n.display&&this.ticks.forEach((C,S)=>{if(S!==0||S===0&&this.min<0){p=this.getDistanceFromCenterForValue(C.value);let P=this.getContext(S),I=n.setContext(P),O=o.setContext(P);WL(this,I,p,l,O)}}),s.display){for(t.save(),d=l-1;d>=0;d--){let C=s.setContext(this.getPointLabelContext(d)),{color:S,lineWidth:P}=C;!P||!S||(t.lineWidth=P,t.strokeStyle=S,t.setLineDash(C.borderDash),t.lineDashOffset=C.borderDashOffset,p=this.getDistanceFromCenterForValue(i.reverse?this.min:this.max),y=this.getPointPosition(d,p),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(y.x,y.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){let t=this.ctx,i=this.options,s=i.ticks;if(!s.display)return;let n=this.getIndexAngle(0),o,l;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(n),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((d,p)=>{if(p===0&&this.min>=0&&!i.reverse)return;let y=s.setContext(this.getContext(p)),C=gs(y.font);if(o=this.getDistanceFromCenterForValue(this.ticks[p].value),y.showLabelBackdrop){t.font=C.string,l=t.measureText(d.label).width,t.fillStyle=y.backdropColor;let S=Bs(y.backdropPadding);t.fillRect(-l/2-S.left,-o-C.size/2-S.top,l+S.width,C.size+S.height)}Va(t,d.label,0,-o,C,{color:y.color,strokeColor:y.textStrokeColor,strokeWidth:y.textStrokeWidth})}),t.restore()}drawTitle(){}},dm={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},fo=Object.keys(dm);function xS(e,t){return e-t}function _S(e,t){if(qt(t))return null;let i=e._adapter,{parser:s,round:n,isoWeekday:o}=e._parseOpts,l=t;return typeof s=="function"&&(l=s(l)),Wi(l)||(l=typeof s=="string"?i.parse(l,s):i.parse(l)),l===null?null:(n&&(l=n==="week"&&(Yl(o)||o===!0)?i.startOf(l,"isoWeek",o):i.startOf(l,n)),+l)}function SS(e,t,i,s){let n=fo.length;for(let o=fo.indexOf(e);o<n-1;++o){let l=dm[fo[o]],d=l.steps?l.steps:Number.MAX_SAFE_INTEGER;if(l.common&&Math.ceil((i-t)/(d*l.size))<=s)return fo[o]}return fo[n-1]}function jL(e,t,i,s,n){for(let o=fo.length-1;o>=fo.indexOf(i);o--){let l=fo[o];if(dm[l].common&&e._adapter.diff(n,s,l)>=t-1)return l}return fo[i?fo.indexOf(i):0]}function $L(e){for(let t=fo.indexOf(e)+1,i=fo.length;t<i;++t)if(dm[fo[t]].common)return fo[t]}function RS(e,t,i){if(!i)e[t]=!0;else if(i.length){let{lo:s,hi:n}=Hf(i,t),o=i[s]>=t?i[s]:i[n];e[o]=!0}}function qL(e,t,i,s){let n=e._adapter,o=+n.startOf(t[0].value,s),l=t[t.length-1].value,d,p;for(d=o;d<=l;d=+n.add(d,1,s))p=i[d],p>=0&&(t[p].major=!0);return t}function ES(e,t,i){let s=[],n={},o=t.length,l,d;for(l=0;l<o;++l)d=t[l],n[d]=l,s.push({value:d,major:!1});return o===0||!i?s:qL(e,s,n,i)}var dw=(()=>{class e extends tc{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(i){super(i),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(i,s={}){let n=i.time||(i.time={}),o=this._adapter=new ok._date(i.adapters.date);o.init(s),Hh(n.displayFormats,o.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(i),this._normalized=s.normalized}parse(i,s){return i===void 0?null:_S(this,i)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){let i=this.options,s=this._adapter,n=i.time.unit||"day",{min:o,max:l,minDefined:d,maxDefined:p}=this.getUserBounds();function y(C){!d&&!isNaN(C.min)&&(o=Math.min(o,C.min)),!p&&!isNaN(C.max)&&(l=Math.max(l,C.max))}(!d||!p)&&(y(this._getLabelBounds()),(i.bounds!=="ticks"||i.ticks.source!=="labels")&&y(this.getMinMax(!1))),o=Wi(o)&&!isNaN(o)?o:+s.startOf(Date.now(),n),l=Wi(l)&&!isNaN(l)?l:+s.endOf(Date.now(),n)+1,this.min=Math.min(o,l-1),this.max=Math.max(o+1,l)}_getLabelBounds(){let i=this.getLabelTimestamps(),s=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return i.length&&(s=i[0],n=i[i.length-1]),{min:s,max:n}}buildTicks(){let i=this.options,s=i.time,n=i.ticks,o=n.source==="labels"?this.getLabelTimestamps():this._generate();i.bounds==="ticks"&&o.length&&(this.min=this._userMin||o[0],this.max=this._userMax||o[o.length-1]);let l=this.min,d=this.max,p=r1(o,l,d);return this._unit=s.unit||(n.autoSkip?SS(s.minUnit,this.min,this.max,this._getLabelCapacity(l)):jL(this,p.length,s.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:$L(this._unit),this.initOffsets(o),i.reverse&&p.reverse(),ES(this,p,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(i=>+i.value))}initOffsets(i=[]){let s=0,n=0,o,l;this.options.offset&&i.length&&(o=this.getDecimalForValue(i[0]),i.length===1?s=1-o:s=(this.getDecimalForValue(i[1])-o)/2,l=this.getDecimalForValue(i[i.length-1]),i.length===1?n=l:n=(l-this.getDecimalForValue(i[i.length-2]))/2);let d=i.length<3?.5:.25;s=Cs(s,0,d),n=Cs(n,0,d),this._offsets={start:s,end:n,factor:1/(s+1+n)}}_generate(){let i=this._adapter,s=this.min,n=this.max,o=this.options,l=o.time,d=l.unit||SS(l.minUnit,s,n,this._getLabelCapacity(s)),p=kt(o.ticks.stepSize,1),y=d==="week"?l.isoWeekday:!1,C=Yl(y)||y===!0,S={},P=s,I,O;if(C&&(P=+i.startOf(P,"isoWeek",y)),P=+i.startOf(P,C?"day":d),i.diff(n,s,d)>1e5*p)throw new Error(s+" and "+n+" are too far apart with stepSize of "+p+" "+d);let V=o.ticks.source==="data"&&this.getDataTimestamps();for(I=P,O=0;I<n;I=+i.add(I,p,d),O++)RS(S,I,V);return(I===n||o.bounds==="ticks"||O===1)&&RS(S,I,V),Object.keys(S).sort(xS).map(G=>+G)}getLabelForValue(i){let s=this._adapter,n=this.options.time;return n.tooltipFormat?s.format(i,n.tooltipFormat):s.format(i,n.displayFormats.datetime)}format(i,s){let o=this.options.time.displayFormats,l=this._unit,d=s||o[l];return this._adapter.format(i,d)}_tickFormatFunction(i,s,n,o){let l=this.options,d=l.ticks.callback;if(d)return bi(d,[i,s,n],this);let p=l.time.displayFormats,y=this._unit,C=this._majorUnit,S=y&&p[y],P=C&&p[C],I=n[s],O=C&&P&&I&&I.major;return this._adapter.format(i,o||(O?P:S))}generateTickLabels(i){let s,n,o;for(s=0,n=i.length;s<n;++s)o=i[s],o.label=this._tickFormatFunction(o.value,s,i)}getDecimalForValue(i){return i===null?NaN:(i-this.min)/(this.max-this.min)}getPixelForValue(i){let s=this._offsets,n=this.getDecimalForValue(i);return this.getPixelForDecimal((s.start+n)*s.factor)}getValueForPixel(i){let s=this._offsets,n=this.getDecimalForPixel(i)/s.factor-s.end;return this.min+n*(this.max-this.min)}_getLabelSize(i){let s=this.options.ticks,n=this.ctx.measureText(i).width,o=Xo(this.isHorizontal()?s.maxRotation:s.minRotation),l=Math.cos(o),d=Math.sin(o),p=this._resolveTickFontOptions(0).size;return{w:n*l+p*d,h:n*d+p*l}}_getLabelCapacity(i){let s=this.options.time,n=s.displayFormats,o=n[s.unit]||n.millisecond,l=this._tickFormatFunction(i,0,ES(this,[i],this._majorUnit),o),d=this._getLabelSize(l),p=Math.floor(this.isHorizontal()?this.width/d.w:this.height/d.h)-1;return p>0?p:1}getDataTimestamps(){let i=this._cache.data||[],s,n;if(i.length)return i;let o=this.getMatchingVisibleMetas();if(this._normalized&&o.length)return this._cache.data=o[0].controller.getAllParsedValues(this);for(s=0,n=o.length;s<n;++s)i=i.concat(o[s].controller.getAllParsedValues(this));return this._cache.data=this.normalize(i)}getLabelTimestamps(){let i=this._cache.labels||[],s,n;if(i.length)return i;let o=this.getLabels();for(s=0,n=o.length;s<n;++s)i.push(_S(this,o[s]));return this._cache.labels=this._normalized?i:this.normalize(i)}normalize(i){return f0(i.sort(xS))}}return e})();function em(e,t,i){let s=0,n=e.length-1,o,l,d,p;i?(t>=e[s].pos&&t<=e[n].pos&&({lo:s,hi:n}=Xn(e,"pos",t)),{pos:o,time:d}=e[s],{pos:l,time:p}=e[n]):(t>=e[s].time&&t<=e[n].time&&({lo:s,hi:n}=Xn(e,"time",t)),{time:o,pos:d}=e[s],{time:l,pos:p}=e[n]);let y=l-o;return y?d+(p-d)*(t-o)/y:d}var pw=class extends dw{static id="timeseries";static defaults=dw.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){let t=this._getTimestampsForTable(),i=this._table=this.buildLookupTable(t);this._minPos=em(i,this.min),this._tableRange=em(i,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){let{min:i,max:s}=this,n=[],o=[],l,d,p,y,C;for(l=0,d=t.length;l<d;++l)y=t[l],y>=i&&y<=s&&n.push(y);if(n.length<2)return[{time:i,pos:0},{time:s,pos:1}];for(l=0,d=n.length;l<d;++l)C=n[l+1],p=n[l-1],y=n[l],Math.round((C+p)/2)!==y&&o.push({time:y,pos:l/(d-1)});return o}_generate(){let t=this.min,i=this.max,s=super.getDataTimestamps();return(!s.includes(t)||!s.length)&&s.splice(0,0,t),(!s.includes(i)||s.length===1)&&s.push(i),s.sort((n,o)=>n-o)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;let i=this.getDataTimestamps(),s=this.getLabelTimestamps();return i.length&&s.length?t=this.normalize(i.concat(s)):t=i.length?i:s,t=this._cache.all=t,t}getDecimalForValue(t){return(em(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){let i=this._offsets,s=this.getDecimalForPixel(t)/i.factor-i.end;return em(this._table,s*this._tableRange+this._minPos,!0)}},ZL=Object.freeze({__proto__:null,CategoryScale:ML,LinearScale:lw,LogarithmicScale:cw,RadialLinearScale:uw,TimeScale:dw,TimeSeriesScale:pw}),ZS=[sk,TA,SL,ZL];var KL=typeof global=="object"&&global&&global.Object===Object&&global,pm=KL;var XL=typeof self=="object"&&self&&self.Object===Object&&self,YL=pm||XL||Function("return this")(),Yo=YL;var QL=Yo.Symbol,Xh=QL;var KS=Object.prototype,JL=KS.hasOwnProperty,e6=KS.toString,xp=Xh?Xh.toStringTag:void 0;function t6(e){var t=JL.call(e,xp),i=e[xp];try{e[xp]=void 0;var s=!0}catch{}var n=e6.call(e);return s&&(t?e[xp]=i:delete e[xp]),n}var XS=t6;var i6=Object.prototype,s6=i6.toString;function o6(e){return s6.call(e)}var YS=o6;var n6="[object Null]",r6="[object Undefined]",QS=Xh?Xh.toStringTag:void 0;function a6(e){return e==null?e===void 0?r6:n6:QS&&QS in Object(e)?XS(e):YS(e)}var Ua=a6;function l6(e){return e!=null&&typeof e=="object"}var ir=l6;var c6=Array.isArray,_p=c6;function h6(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var mo=h6;function u6(e){return e}var gm=u6;var d6="[object AsyncFunction]",p6="[object Function]",g6="[object GeneratorFunction]",f6="[object Proxy]";function m6(e){if(!mo(e))return!1;var t=Ua(e);return t==p6||t==g6||t==d6||t==f6}var Yh=m6;var v6=Yo["__core-js_shared__"],fm=v6;var JS=function(){var e=/[^.]+$/.exec(fm&&fm.keys&&fm.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function y6(e){return!!JS&&JS in e}var e2=y6;var w6=Function.prototype,C6=w6.toString;function b6(e){if(e!=null){try{return C6.call(e)}catch{}try{return e+""}catch{}}return""}var t2=b6;var x6=/[\\^$.*+?()[\]{}|]/g,_6=/^\[object .+?Constructor\]$/,S6=Function.prototype,R6=Object.prototype,E6=S6.toString,P6=R6.hasOwnProperty,M6=RegExp("^"+E6.call(P6).replace(x6,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function T6(e){if(!mo(e)||e2(e))return!1;var t=Yh(e)?M6:_6;return t.test(t2(e))}var i2=T6;function D6(e,t){return e?.[t]}var s2=D6;function F6(e,t){var i=s2(e,t);return i2(i)?i:void 0}var Qh=F6;var o2=Object.create,I6=function(){function e(){}return function(t){if(!mo(t))return{};if(o2)return o2(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}(),n2=I6;function k6(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}var r2=k6;function A6(e,t){var i=-1,s=e.length;for(t||(t=Array(s));++i<s;)t[i]=e[i];return t}var a2=A6;var L6=800,O6=16,z6=Date.now;function B6(e){var t=0,i=0;return function(){var s=z6(),n=O6-(s-i);if(i=s,n>0){if(++t>=L6)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var l2=B6;function V6(e){return function(){return e}}var c2=V6;var H6=function(){try{var e=Qh(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Jh=H6;var N6=Jh?function(e,t){return Jh(e,"toString",{configurable:!0,enumerable:!1,value:c2(t),writable:!0})}:gm,h2=N6;var G6=l2(h2),u2=G6;var W6=9007199254740991,U6=/^(?:0|[1-9]\d*)$/;function j6(e,t){var i=typeof e;return t=t??W6,!!t&&(i=="number"||i!="symbol"&&U6.test(e))&&e>-1&&e%1==0&&e<t}var mm=j6;function $6(e,t,i){t=="__proto__"&&Jh?Jh(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}var eu=$6;function q6(e,t){return e===t||e!==e&&t!==t}var ja=q6;var Z6=Object.prototype,K6=Z6.hasOwnProperty;function X6(e,t,i){var s=e[t];(!(K6.call(e,t)&&ja(s,i))||i===void 0&&!(t in e))&&eu(e,t,i)}var d2=X6;function Y6(e,t,i,s){var n=!i;i||(i={});for(var o=-1,l=t.length;++o<l;){var d=t[o],p=s?s(i[d],e[d],d,i,e):void 0;p===void 0&&(p=e[d]),n?eu(i,d,p):d2(i,d,p)}return i}var p2=Y6;var g2=Math.max;function Q6(e,t,i){return t=g2(t===void 0?e.length-1:t,0),function(){for(var s=arguments,n=-1,o=g2(s.length-t,0),l=Array(o);++n<o;)l[n]=s[t+n];n=-1;for(var d=Array(t+1);++n<t;)d[n]=s[n];return d[t]=i(l),r2(e,this,d)}}var f2=Q6;function J6(e,t){return u2(f2(e,t,gm),e+"")}var m2=J6;var eO=9007199254740991;function tO(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=eO}var vm=tO;function iO(e){return e!=null&&vm(e.length)&&!Yh(e)}var tu=iO;function sO(e,t,i){if(!mo(i))return!1;var s=typeof t;return(s=="number"?tu(i)&&mm(t,i.length):s=="string"&&t in i)?ja(i[t],e):!1}var v2=sO;function oO(e){return m2(function(t,i){var s=-1,n=i.length,o=n>1?i[n-1]:void 0,l=n>2?i[2]:void 0;for(o=e.length>3&&typeof o=="function"?(n--,o):void 0,l&&v2(i[0],i[1],l)&&(o=n<3?void 0:o,n=1),t=Object(t);++s<n;){var d=i[s];d&&e(t,d,s,o)}return t})}var y2=oO;var nO=Object.prototype;function rO(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||nO;return e===i}var ym=rO;function aO(e,t){for(var i=-1,s=Array(e);++i<e;)s[i]=t(i);return s}var w2=aO;var lO="[object Arguments]";function cO(e){return ir(e)&&Ua(e)==lO}var fw=cO;var C2=Object.prototype,hO=C2.hasOwnProperty,uO=C2.propertyIsEnumerable,dO=fw(function(){return arguments}())?fw:function(e){return ir(e)&&hO.call(e,"callee")&&!uO.call(e,"callee")},Sp=dO;function pO(){return!1}var b2=pO;var S2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,x2=S2&&typeof module=="object"&&module&&!module.nodeType&&module,gO=x2&&x2.exports===S2,_2=gO?Yo.Buffer:void 0,fO=_2?_2.isBuffer:void 0,mO=fO||b2,wm=mO;var vO="[object Arguments]",yO="[object Array]",wO="[object Boolean]",CO="[object Date]",bO="[object Error]",xO="[object Function]",_O="[object Map]",SO="[object Number]",RO="[object Object]",EO="[object RegExp]",PO="[object Set]",MO="[object String]",TO="[object WeakMap]",DO="[object ArrayBuffer]",FO="[object DataView]",IO="[object Float32Array]",kO="[object Float64Array]",AO="[object Int8Array]",LO="[object Int16Array]",OO="[object Int32Array]",zO="[object Uint8Array]",BO="[object Uint8ClampedArray]",VO="[object Uint16Array]",HO="[object Uint32Array]",Mi={};Mi[IO]=Mi[kO]=Mi[AO]=Mi[LO]=Mi[OO]=Mi[zO]=Mi[BO]=Mi[VO]=Mi[HO]=!0;Mi[vO]=Mi[yO]=Mi[DO]=Mi[wO]=Mi[FO]=Mi[CO]=Mi[bO]=Mi[xO]=Mi[_O]=Mi[SO]=Mi[RO]=Mi[EO]=Mi[PO]=Mi[MO]=Mi[TO]=!1;function NO(e){return ir(e)&&vm(e.length)&&!!Mi[Ua(e)]}var R2=NO;function GO(e){return function(t){return e(t)}}var E2=GO;var P2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Rp=P2&&typeof module=="object"&&module&&!module.nodeType&&module,WO=Rp&&Rp.exports===P2,mw=WO&&pm.process,UO=function(){try{var e=Rp&&Rp.require&&Rp.require("util").types;return e||mw&&mw.binding&&mw.binding("util")}catch{}}(),vw=UO;var M2=vw&&vw.isTypedArray,jO=M2?E2(M2):R2,Cm=jO;var $O=Object.prototype,qO=$O.hasOwnProperty;function ZO(e,t){var i=_p(e),s=!i&&Sp(e),n=!i&&!s&&wm(e),o=!i&&!s&&!n&&Cm(e),l=i||s||n||o,d=l?w2(e.length,String):[],p=d.length;for(var y in e)(t||qO.call(e,y))&&!(l&&(y=="length"||n&&(y=="offset"||y=="parent")||o&&(y=="buffer"||y=="byteLength"||y=="byteOffset")||mm(y,p)))&&d.push(y);return d}var T2=ZO;function KO(e,t){return function(i){return e(t(i))}}var D2=KO;function XO(e){var t=[];if(e!=null)for(var i in Object(e))t.push(i);return t}var F2=XO;var YO=Object.prototype,QO=YO.hasOwnProperty;function JO(e){if(!mo(e))return F2(e);var t=ym(e),i=[];for(var s in e)s=="constructor"&&(t||!QO.call(e,s))||i.push(s);return i}var I2=JO;function ez(e){return tu(e)?T2(e,!0):I2(e)}var bm=ez;var tz=Qh(Object,"create"),Zr=tz;function iz(){this.__data__=Zr?Zr(null):{},this.size=0}var k2=iz;function sz(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var A2=sz;var oz="__lodash_hash_undefined__",nz=Object.prototype,rz=nz.hasOwnProperty;function az(e){var t=this.__data__;if(Zr){var i=t[e];return i===oz?void 0:i}return rz.call(t,e)?t[e]:void 0}var L2=az;var lz=Object.prototype,cz=lz.hasOwnProperty;function hz(e){var t=this.__data__;return Zr?t[e]!==void 0:cz.call(t,e)}var O2=hz;var uz="__lodash_hash_undefined__";function dz(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Zr&&t===void 0?uz:t,this}var z2=dz;function iu(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}iu.prototype.clear=k2;iu.prototype.delete=A2;iu.prototype.get=L2;iu.prototype.has=O2;iu.prototype.set=z2;var yw=iu;function pz(){this.__data__=[],this.size=0}var B2=pz;function gz(e,t){for(var i=e.length;i--;)if(ja(e[i][0],t))return i;return-1}var $a=gz;var fz=Array.prototype,mz=fz.splice;function vz(e){var t=this.__data__,i=$a(t,e);if(i<0)return!1;var s=t.length-1;return i==s?t.pop():mz.call(t,i,1),--this.size,!0}var V2=vz;function yz(e){var t=this.__data__,i=$a(t,e);return i<0?void 0:t[i][1]}var H2=yz;function wz(e){return $a(this.__data__,e)>-1}var N2=wz;function Cz(e,t){var i=this.__data__,s=$a(i,e);return s<0?(++this.size,i.push([e,t])):i[s][1]=t,this}var G2=Cz;function su(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}su.prototype.clear=B2;su.prototype.delete=V2;su.prototype.get=H2;su.prototype.has=N2;su.prototype.set=G2;var qa=su;var bz=Qh(Yo,"Map"),xm=bz;function xz(){this.size=0,this.__data__={hash:new yw,map:new(xm||qa),string:new yw}}var W2=xz;function _z(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var U2=_z;function Sz(e,t){var i=e.__data__;return U2(t)?i[typeof t=="string"?"string":"hash"]:i.map}var Za=Sz;function Rz(e){var t=Za(this,e).delete(e);return this.size-=t?1:0,t}var j2=Rz;function Ez(e){return Za(this,e).get(e)}var $2=Ez;function Pz(e){return Za(this,e).has(e)}var q2=Pz;function Mz(e,t){var i=Za(this,e),s=i.size;return i.set(e,t),this.size+=i.size==s?0:1,this}var Z2=Mz;function ou(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}ou.prototype.clear=W2;ou.prototype.delete=j2;ou.prototype.get=$2;ou.prototype.has=q2;ou.prototype.set=Z2;var K2=ou;var Tz=D2(Object.getPrototypeOf,Object),_m=Tz;var Dz="[object Object]",Fz=Function.prototype,Iz=Object.prototype,X2=Fz.toString,kz=Iz.hasOwnProperty,Az=X2.call(Object);function Lz(e){if(!ir(e)||Ua(e)!=Dz)return!1;var t=_m(e);if(t===null)return!0;var i=kz.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&X2.call(i)==Az}var Y2=Lz;function Oz(){this.__data__=new qa,this.size=0}var Q2=Oz;function zz(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}var J2=zz;function Bz(e){return this.__data__.get(e)}var eR=Bz;function Vz(e){return this.__data__.has(e)}var tR=Vz;var Hz=200;function Nz(e,t){var i=this.__data__;if(i instanceof qa){var s=i.__data__;if(!xm||s.length<Hz-1)return s.push([e,t]),this.size=++i.size,this;i=this.__data__=new K2(s)}return i.set(e,t),this.size=i.size,this}var iR=Nz;function nu(e){var t=this.__data__=new qa(e);this.size=t.size}nu.prototype.clear=Q2;nu.prototype.delete=J2;nu.prototype.get=eR;nu.prototype.has=tR;nu.prototype.set=iR;var sR=nu;var aR=typeof exports=="object"&&exports&&!exports.nodeType&&exports,oR=aR&&typeof module=="object"&&module&&!module.nodeType&&module,Gz=oR&&oR.exports===aR,nR=Gz?Yo.Buffer:void 0,rR=nR?nR.allocUnsafe:void 0;function Wz(e,t){if(t)return e.slice();var i=e.length,s=rR?rR(i):new e.constructor(i);return e.copy(s),s}var lR=Wz;var Uz=Yo.Uint8Array,ww=Uz;function jz(e){var t=new e.constructor(e.byteLength);return new ww(t).set(new ww(e)),t}var cR=jz;function $z(e,t){var i=t?cR(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var hR=$z;function qz(e){return typeof e.constructor=="function"&&!ym(e)?n2(_m(e)):{}}var uR=qz;function Zz(e){return function(t,i,s){for(var n=-1,o=Object(t),l=s(t),d=l.length;d--;){var p=l[e?d:++n];if(i(o[p],p,o)===!1)break}return t}}var dR=Zz;var Kz=dR(),pR=Kz;function Xz(e,t,i){(i!==void 0&&!ja(e[t],i)||i===void 0&&!(t in e))&&eu(e,t,i)}var Ep=Xz;function Yz(e){return ir(e)&&tu(e)}var gR=Yz;function Qz(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Pp=Qz;function Jz(e){return p2(e,bm(e))}var fR=Jz;function e4(e,t,i,s,n,o,l){var d=Pp(e,i),p=Pp(t,i),y=l.get(p);if(y){Ep(e,i,y);return}var C=o?o(d,p,i+"",e,t,l):void 0,S=C===void 0;if(S){var P=_p(p),I=!P&&wm(p),O=!P&&!I&&Cm(p);C=p,P||I||O?_p(d)?C=d:gR(d)?C=a2(d):I?(S=!1,C=lR(p,!0)):O?(S=!1,C=hR(p,!0)):C=[]:Y2(p)||Sp(p)?(C=d,Sp(d)?C=fR(d):(!mo(d)||Yh(d))&&(C=uR(p))):S=!1}S&&(l.set(p,C),n(C,p,s,o,l),l.delete(p)),Ep(e,i,C)}var mR=e4;function vR(e,t,i,s,n){e!==t&&pR(t,function(o,l){if(n||(n=new sR),mo(o))mR(e,t,l,i,vR,s,n);else{var d=s?s(Pp(e,l),o,l+"",e,t,n):void 0;d===void 0&&(d=o),Ep(e,l,d)}},bm)}var yR=vR;var t4=y2(function(e,t,i){yR(e,t,i)}),Sm=t4;var wR=new $y("Configuration for ngCharts");function CR(...e){return{registerables:[...ZS,...e]}}function bR(...e){let t=Sm({},...e);return{provide:wR,useValue:t}}var i4=(()=>{class e{constructor(){this.colorschemesOptions=new Th(void 0)}setColorschemesOptions(i){this.pColorschemesOptions=i,this.colorschemesOptions.next(i)}getColorschemesOptions(){return this.pColorschemesOptions}static{this.\u0275fac=function(s){return new(s||e)}}static{this.\u0275prov=Zo({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),ru=(()=>{class e{constructor(i,s,n,o){this.zone=s,this.themeService=n,this.type="bar",this.plugins=[],this.chartClick=new We,this.chartHover=new We,this.subs=[],this.themeOverrides={},o?.registerables&&cm.register(...o.registerables),o?.defaults&&xi.set(o.defaults),this.ctx=i.nativeElement.getContext("2d"),this.subs.push(this.themeService.colorschemesOptions.pipe(v_()).subscribe(l=>this.themeChanged(l)))}ngOnChanges(i){let s=["type"],n=Object.getOwnPropertyNames(i);if(n.some(o=>s.includes(o))||n.every(o=>i[o].isFirstChange()))this.render();else{let o=this.getChartConfiguration();this.chart&&(Object.assign(this.chart.config.data,o.data),this.chart.config.plugins&&Object.assign(this.chart.config.plugins,o.plugins),this.chart.config.options&&Object.assign(this.chart.config.options,o.options)),this.update()}}ngOnDestroy(){this.chart&&(this.chart.destroy(),this.chart=void 0),this.subs.forEach(i=>i.unsubscribe())}render(){return this.chart&&this.chart.destroy(),this.zone.runOutsideAngular(()=>this.chart=new cm(this.ctx,this.getChartConfiguration()))}update(i){this.chart&&this.zone.runOutsideAngular(()=>this.chart?.update(i))}hideDataset(i,s){this.chart&&(this.chart.getDatasetMeta(i).hidden=s,this.update())}isDatasetHidden(i){return this.chart?.getDatasetMeta(i)?.hidden}toBase64Image(){return this.chart?.toBase64Image()}themeChanged(i){this.themeOverrides=i,this.chart&&(this.chart.config.options&&Object.assign(this.chart.config.options,this.getChartOptions()),this.update())}getChartOptions(){return Sm({onHover:(i,s)=>{!this.chartHover.observed&&!this.chartHover.observers?.length||this.zone.run(()=>this.chartHover.emit({event:i,active:s}))},onClick:(i,s)=>{!this.chartClick.observed&&!this.chartClick.observers?.length||this.zone.run(()=>this.chartClick.emit({event:i,active:s}))}},this.themeOverrides,this.options,{plugins:{legend:{display:this.legend}}})}getChartConfiguration(){return{type:this.type,data:this.getChartData(),options:this.getChartOptions(),plugins:this.plugins}}getChartData(){return this.data?this.data:{labels:this.labels||[],datasets:this.datasets||[]}}static{this.\u0275fac=function(s){return new(s||e)(yn(ql),yn($n),yn(i4),yn(wR,8))}}static{this.\u0275dir=qn({type:e,selectors:[["canvas","baseChart",""]],inputs:{type:"type",legend:"legend",data:"data",options:"options",plugins:"plugins",labels:"labels",datasets:"datasets"},outputs:{chartClick:"chartClick",chartHover:"chartHover"},exportAs:["base-chart"],features:[Hr]})}}return e})();var Cw="#47b5ff",bw="#1363df";var au=class{chartDirective=Ci(ru);colorScheme=Ci(Lh);colors=Zn(()=>({textColor:this.colorScheme.theme()==="dark"?"white":"black",backgroundColor:this.colorScheme.theme()==="dark"?bw:Cw,borderColor:this.colorScheme.theme()==="dark"?Cw:bw}));constructor(){P_(()=>{this.chartDirective.data=this.chart().data,this.chartDirective.options=this.chart().options,this.chartDirective.type=this.chart().type,this.chartDirective.render()})}};var Rm=class e extends au{store=Ci(Kn);chart=Zn(()=>{let{backgroundColor:t,borderColor:i,textColor:s}=this.colors(),n=this.store.applicants().reduce((o,l)=>(o[l.age]=(o[l.age]||0)+1,o),{});return{type:"bar",data:{yLabels:Object.values(n),xLabels:Object.keys(n),datasets:[{label:"Applicants",data:Object.values(n),backgroundColor:t,borderColor:i,borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{ticks:{color:s},title:{text:"Age breakdown",align:"center",display:!0,color:s},type:"linear"},y:{ticks:{color:s,stepSize:1},title:{text:"Amount",align:"center",display:!0,color:s}}}}}});static \u0275fac=(()=>{let t;return function(s){return(t||(t=$l(e)))(s||e)}})();static \u0275dir=qn({type:e,selectors:[["","iisaAgeChart",""]],features:[Qd([ru]),Ih]})};var Em=class e extends au{store=Ci(Kn);chart=Zn(()=>{let{backgroundColor:t,borderColor:i,textColor:s}=this.colors(),n=this.store.applicants().reduce((o,l)=>{let d=new Date(l.created_at).toLocaleString("default",{month:"long",year:"numeric"});return o[d]=(o[d]||0)+1,o},{});return{type:"line",data:{yLabels:Object.values(n),xLabels:Object.keys(n),datasets:[{label:"Registration Date Breakdown",data:Object.values(n),backgroundColor:t,borderColor:i,showLine:!0,borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{ticks:{color:s},title:{text:"Registration Date breakdown",align:"center",display:!0,color:s}},y:{ticks:{color:s,stepSize:1},title:{text:"Amount",align:"center",display:!0,color:s}}}}}});static \u0275fac=(()=>{let t;return function(s){return(t||(t=$l(e)))(s||e)}})();static \u0275dir=qn({type:e,selectors:[["","iisaDateChart",""]],features:[Qd([ru]),Ih]})};var Oo=lF(SR(),1);var o4=["content"],n4=["*"],r4=["container"];var RR=e=>Object.keys(e).reduce((t,i)=>{let s=i;return e[s]===void 0?t:ht(Se({},t),{[s]:e[s]})},{}),Sw=(()=>{class e{constructor(){this.zone=Ci($n),this.subscriptionsPerInstance=new Map,this.mapCreated=new Uy,this.mapLoaded=new Uy,this.markersToRemove=Dh([]),this.popupsToRemove=Dh([]),this.imageIdsToRemove=Dh([]),this.mapCreated$=this.mapCreated.asObservable(),this.mapLoaded$=this.mapLoaded.asObservable()}setup(i){this.createMap(i.mapOptions),this.hookEvents(i.mapEvents),this.mapEvents=i.mapEvents,this.mapCreated.next(void 0),this.mapCreated.complete(),(i.mapOptions.terrain||i.mapOptions.projection)&&this.mapInstance.on("load",()=>{i.mapOptions.projection&&this.setProjection(i.mapOptions.projection),i.mapOptions.terrain&&this.setTerrain(i.mapOptions.terrain)})}destroyMap(){this.mapInstance&&this.mapInstance.remove()}updateMinZoom(i){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinZoom(i)})}updateMaxZoom(i){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxZoom(i)})}updateMinPitch(i){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMinPitch(i)})}updateMaxPitch(i){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxPitch(i)})}updateRenderWorldCopies(i){return this.zone.runOutsideAngular(()=>{this.mapInstance.setRenderWorldCopies(i)})}updateScrollZoom(i){return this.zone.runOutsideAngular(()=>{i?this.mapInstance.scrollZoom.enable():this.mapInstance.scrollZoom.disable()})}updateDragRotate(i){return this.zone.runOutsideAngular(()=>{i?this.mapInstance.dragRotate.enable():this.mapInstance.dragRotate.disable()})}updateTouchPitch(i){return this.zone.runOutsideAngular(()=>{i?this.mapInstance.touchPitch.enable():this.mapInstance.touchPitch.disable()})}updateTouchZoomRotate(i){return this.zone.runOutsideAngular(()=>{i?this.mapInstance.touchZoomRotate.enable():this.mapInstance.touchZoomRotate.disable()})}updateDoubleClickZoom(i){return this.zone.runOutsideAngular(()=>{i?this.mapInstance.doubleClickZoom.enable():this.mapInstance.doubleClickZoom.disable()})}updateKeyboard(i){return this.zone.runOutsideAngular(()=>{i?this.mapInstance.keyboard.enable():this.mapInstance.keyboard.disable()})}updateDragPan(i){return this.zone.runOutsideAngular(()=>{i?this.mapInstance.dragPan.enable():this.mapInstance.dragPan.disable()})}updateBoxZoom(i){return this.zone.runOutsideAngular(()=>{i?this.mapInstance.boxZoom.enable():this.mapInstance.boxZoom.disable()})}updateStyle(i){return this.zone.runOutsideAngular(()=>{this.mapInstance.setStyle(i)})}updateMaxBounds(i){return this.zone.runOutsideAngular(()=>{this.mapInstance.setMaxBounds(i)})}setProjection(i){return this.zone.runOutsideAngular(()=>{this.mapInstance.setProjection(i)})}setTerrain(i){return this.zone.runOutsideAngular(()=>{this.mapInstance.setTerrain(i)})}getTerrain(){return this.zone.runOutsideAngular(()=>this.mapInstance.getTerrain())}setCenterElevation(i){return this.zone.runOutsideAngular(()=>{this.mapInstance.setCenterElevation(i)})}changeCanvasCursor(i){let s=this.mapInstance.getCanvasContainer();s.style.cursor=i}queryRenderedFeatures(i,s){return this.mapInstance.queryRenderedFeatures(i,s)}panTo(i,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.panTo(i,s)})}move(i,s,n,o,l,d,p){return this.zone.runOutsideAngular(()=>{this.mapInstance[i](ht(Se({},s),{zoom:n??this.mapInstance.getZoom(),center:o??this.mapInstance.getCenter(),bearing:l??this.mapInstance.getBearing(),pitch:d??this.mapInstance.getPitch(),roll:p??this.mapInstance.getRoll()}))})}addLayer(i,s,n){this.zone.runOutsideAngular(()=>{if(Object.keys(i.layerOptions).forEach(d=>{let p=d;i.layerOptions[p]===void 0&&delete i.layerOptions[p]}),this.mapInstance.addLayer(i.layerOptions,n),!s)return;let o=[];o.push(this.createSubscriptionForLayer(i.layerOptions.id,"click",i.layerEvents.layerClick)),o.push(this.createSubscriptionForLayer(i.layerOptions.id,"dblclick",i.layerEvents.layerDblClick)),o.push(this.createSubscriptionForLayer(i.layerOptions.id,"mousedown",i.layerEvents.layerMouseDown)),o.push(this.createSubscriptionForLayer(i.layerOptions.id,"mouseup",i.layerEvents.layerMouseUp)),o.push(this.createSubscriptionForLayer(i.layerOptions.id,"mouseenter",i.layerEvents.layerMouseEnter)),o.push(this.createSubscriptionForLayer(i.layerOptions.id,"mouseleave",i.layerEvents.layerMouseLeave)),o.push(this.createSubscriptionForLayer(i.layerOptions.id,"mousemove",i.layerEvents.layerMouseMove)),o.push(this.createSubscriptionForLayer(i.layerOptions.id,"mouseover",i.layerEvents.layerMouseOver)),o.push(this.createSubscriptionForLayer(i.layerOptions.id,"mouseout",i.layerEvents.layerMouseOut)),o.push(this.createSubscriptionForLayer(i.layerOptions.id,"contextmenu",i.layerEvents.layerContextMenu)),o.push(this.createSubscriptionForLayer(i.layerOptions.id,"touchstart",i.layerEvents.layerTouchStart)),o.push(this.createSubscriptionForLayer(i.layerOptions.id,"touchend",i.layerEvents.layerTouchEnd)),o.push(this.createSubscriptionForLayer(i.layerOptions.id,"touchcancel",i.layerEvents.layerTouchCancel));let l=this.mapInstance.getLayer(i.layerOptions.id);l&&this.subscriptionsPerInstance.set(l,o)})}removeLayer(i){this.zone.runOutsideAngular(()=>{let s=this.mapInstance.getLayer(i);if(s!=null){let n=this.subscriptionsPerInstance.get(s)||[];for(let o of n)o.unsubscribe();this.subscriptionsPerInstance.delete(s),this.mapInstance.removeLayer(i)}})}addMarker(i){let s={offset:i.markersOptions.offset,anchor:i.markersOptions.anchor,color:i.markersOptions.color,scale:i.markersOptions.scale,draggable:!!i.markersOptions.draggable,rotationAlignment:i.markersOptions.rotationAlignment,rotation:i.markersOptions.rotation,pitchAlignment:i.markersOptions.pitchAlignment,clickTolerance:i.markersOptions.clickTolerance,element:i.markersOptions.element.childNodes.length>0?i.markersOptions.element:void 0,opacity:i.markersOptions.opacity,opacityWhenCovered:i.markersOptions.opacityWhenCovered,subpixelPositioning:i.markersOptions.subpixelPositioning},n=new Oo.Marker(s);n.on("dragstart",l=>{if(l){let{target:d}=l;this.zone.run(()=>{i.markersEvents.markerDragStart.emit(d)})}}),n.on("drag",l=>{if(l){let{target:d}=l;this.zone.run(()=>i.markersEvents.markerDrag.emit(d))}}),n.on("dragend",l=>{if(l){let{target:d}=l;this.zone.run(()=>i.markersEvents.markerDragEnd.emit(d))}});let o=i.markersOptions.feature?i.markersOptions.feature.geometry.coordinates:i.markersOptions.lngLat;return n.setLngLat(o),this.zone.runOutsideAngular(()=>(n.addTo(this.mapInstance),n))}removeMarker(i){this.markersToRemove.update(s=>[...s,i])}createPopup(i,s){return this.zone.runOutsideAngular(()=>{let n=RR(i.popupOptions),o=new Oo.Popup(n);o.setDOMContent(s);let l=[];return l.push(this.createSubscriptionForPopup(o,"open",i.popupEvents.popupOpen)),l.push(this.createSubscriptionForPopup(o,"close",i.popupEvents.popupClose)),this.subscriptionsPerInstance.set(o,l),o})}addPopupToMap(i,s){return this.zone.runOutsideAngular(()=>{i.setLngLat(s),i.addTo(this.mapInstance)})}addPopupToMarker(i,s){return this.zone.runOutsideAngular(()=>{i.setPopup(s)})}removePopupFromMap(i){if(this.subscriptionsPerInstance.has(i)){let s=this.subscriptionsPerInstance.get(i)||[];for(let n of s)n.unsubscribe();this.subscriptionsPerInstance.delete(i)}this.popupsToRemove.update(s=>[...s,i])}removePopupFromMarker(i){return this.zone.runOutsideAngular(()=>{let s=i.getPopup();if(this.subscriptionsPerInstance.has(s)){let n=this.subscriptionsPerInstance.get(s)||[];for(let o of n)o.unsubscribe();this.subscriptionsPerInstance.delete(s)}i.setPopup(void 0)})}addControl(i,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.addControl(i,s)})}removeControl(i){return this.zone.runOutsideAngular(()=>{this.mapInstance.removeControl(i)})}async loadAndAddImage(i,s,n){return this.zone.runOutsideAngular(async()=>{let o=await this.mapInstance.loadImage(s);this.addImage(i,o.data,n)})}addImage(i,s,n){return this.zone.runOutsideAngular(()=>{this.mapInstance.addImage(i,s,n)})}removeImage(i){this.imageIdsToRemove.update(s=>[...s,i])}addSource(i,s){return this.zone.runOutsideAngular(()=>{Object.keys(s).forEach(n=>s[n]===void 0&&delete s[n]),this.mapInstance.addSource(i,s)})}getSource(i){return this.mapInstance.getSource(i)}removeSource(i){this.zone.runOutsideAngular(()=>{this.findLayersBySourceId(i).forEach(s=>this.removeLayer(s.id)),this.mapInstance.removeSource(i)})}setAllLayerPaintProperty(i,s){return this.zone.runOutsideAngular(()=>{Object.keys(s).forEach(n=>{this.mapInstance.setPaintProperty(i,n,s[n])})})}setAllLayerLayoutProperty(i,s){return this.zone.runOutsideAngular(()=>{Object.keys(s).forEach(n=>{this.mapInstance.setLayoutProperty(i,n,s[n])})})}setLayerFilter(i,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.setFilter(i,s)})}setLayerBefore(i,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.moveLayer(i,s)})}setLayerZoomRange(i,s,n){return this.zone.runOutsideAngular(()=>{this.mapInstance.setLayerZoomRange(i,s||0,n||20)})}fitBounds(i,s){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitBounds(i,s)})}fitScreenCoordinates(i,s,n){return this.zone.runOutsideAngular(()=>{this.mapInstance.fitScreenCoordinates(i[0],i[1],s,n)})}clearMapElements(){this.zone.runOutsideAngular(()=>{this.removeMarkers(),this.removePopups(),this.removeImages()})}createMap(i){$n.assertNotInAngularZone();let s=RR(i);this.mapInstance=new Oo.Map(s),window&&/msie\s|trident\/|edge\//i.test(window.navigator.userAgent)&&this.mapInstance.setStyle(i.style)}removeMarkers(){for(let i of this.markersToRemove())i.remove();this.markersToRemove.set([])}removePopups(){for(let i of this.popupsToRemove())i.remove();this.popupsToRemove.set([])}removeImages(){for(let i of this.imageIdsToRemove())this.mapInstance.removeImage(i);this.imageIdsToRemove.set([])}findLayersBySourceId(i){let s=this.mapInstance.getStyle().layers;return s==null?[]:s.filter(n=>"source"in n?n.source===i:!1)}hookEvents(i){this.mapInstance.on("load",s=>{this.mapLoaded.next(void 0),this.mapLoaded.complete(),this.zone.run(()=>{i.mapLoad.emit(s.target)})}),this.mapInstance.on("resize",s=>this.zone.run(()=>{i.mapResize.emit(s)})),this.mapInstance.on("remove",s=>this.zone.run(()=>{i.mapRemove.emit(s)})),this.mapInstance.on("mousedown",s=>this.zone.run(()=>{i.mapMouseDown.emit(s)})),this.mapInstance.on("mouseup",s=>this.zone.run(()=>{i.mapMouseUp.emit(s)})),this.mapInstance.on("mousemove",s=>this.zone.run(()=>{i.mapMouseMove.emit(s)})),this.mapInstance.on("click",s=>this.zone.run(()=>{i.mapClick.emit(s)})),this.mapInstance.on("dblclick",s=>this.zone.run(()=>{i.mapDblClick.emit(s)})),this.mapInstance.on("mouseover",s=>this.zone.run(()=>{i.mapMouseOver.emit(s)})),this.mapInstance.on("mouseout",s=>this.zone.run(()=>{i.mapMouseOut.emit(s)})),this.mapInstance.on("contextmenu",s=>this.zone.run(()=>{i.mapContextMenu.emit(s)})),this.mapInstance.on("touchstart",s=>this.zone.run(()=>{i.mapTouchStart.emit(s)})),this.mapInstance.on("touchend",s=>this.zone.run(()=>{i.mapTouchEnd.emit(s)})),this.mapInstance.on("touchmove",s=>this.zone.run(()=>{i.mapTouchMove.emit(s)})),this.mapInstance.on("touchcancel",s=>this.zone.run(()=>{i.mapTouchCancel.emit(s)})),this.mapInstance.on("wheel",s=>this.zone.run(()=>{i.mapWheel.emit(s)})),this.mapInstance.on("movestart",s=>this.zone.run(()=>i.moveStart.emit(s))),this.mapInstance.on("move",s=>this.zone.run(()=>i.move.emit(s))),this.mapInstance.on("moveend",s=>this.zone.run(()=>i.moveEnd.emit(s))),this.mapInstance.on("dragstart",s=>this.zone.run(()=>{i.mapDragStart.emit(s)})),this.mapInstance.on("drag",s=>this.zone.run(()=>{i.mapDrag.emit(s)})),this.mapInstance.on("dragend",s=>this.zone.run(()=>{i.mapDragEnd.emit(s)})),this.mapInstance.on("zoomstart",s=>this.zone.run(()=>i.zoomStart.emit(s))),this.mapInstance.on("zoom",s=>this.zone.run(()=>i.zoomEvt.emit(s))),this.mapInstance.on("zoomend",s=>this.zone.run(()=>i.zoomEnd.emit(s))),this.mapInstance.on("rotatestart",s=>this.zone.run(()=>i.rotateStart.emit(s))),this.mapInstance.on("rotate",s=>this.zone.run(()=>i.rotate.emit(s))),this.mapInstance.on("rotateend",s=>this.zone.run(()=>i.rotateEnd.emit(s))),this.mapInstance.on("pitchstart",s=>this.zone.run(()=>i.pitchStart.emit(s))),this.mapInstance.on("pitch",s=>this.zone.run(()=>i.pitchEvt.emit(s))),this.mapInstance.on("pitchend",s=>this.zone.run(()=>i.pitchEnd.emit(s))),this.mapInstance.on("boxzoomstart",s=>this.zone.run(()=>i.boxZoomStart.emit(s))),this.mapInstance.on("boxzoomend",s=>this.zone.run(()=>i.boxZoomEnd.emit(s))),this.mapInstance.on("boxzoomcancel",s=>this.zone.run(()=>i.boxZoomCancel.emit(s))),this.mapInstance.on("webglcontextlost",s=>this.zone.run(()=>i.webGlContextLost.emit(s))),this.mapInstance.on("webglcontextrestored",s=>this.zone.run(()=>i.webGlContextRestored.emit(s))),this.mapInstance.on("render",s=>this.zone.run(()=>i.render.emit(s))),this.mapInstance.on("error",s=>this.zone.run(()=>{i.mapError.emit(s)})),this.mapInstance.on("data",s=>this.zone.run(()=>i.data.emit(s))),this.mapInstance.on("styledata",s=>this.zone.run(()=>i.styleData.emit(s))),this.mapInstance.on("sourcedata",s=>this.zone.run(()=>i.sourceData.emit(s))),this.mapInstance.on("dataloading",s=>this.zone.run(()=>i.dataLoading.emit(s))),this.mapInstance.on("styledataloading",s=>this.zone.run(()=>i.styleDataLoading.emit(s))),this.mapInstance.on("sourcedataloading",s=>this.zone.run(()=>i.sourceDataLoading.emit(s))),this.mapInstance.on("styleimagemissing",s=>this.zone.run(()=>i.styleImageMissing.emit(s))),this.mapInstance.on("idle",s=>this.zone.run(()=>i.idle.emit(s)))}createSubscriptionForLayer(i,s,n){let o=l=>{this.zone.run(()=>{n.emit(l)})};return this.mapInstance.on(s,i,o),{unsubscribe:()=>{this.mapInstance.off(s,i,o)}}}createSubscriptionForPopup(i,s,n){let o=l=>{this.zone.run(()=>{n.emit(l)})};return i.on(s,o),{unsubscribe:()=>{i.off(s,o)}}}static{this.\u0275fac=function(s){return new(s||e)}}static{this.\u0275prov=Zo({token:e,factory:e.\u0275fac})}}return e})();var MR=(()=>{class e{get mapInstance(){return this.mapService.mapInstance}constructor(){this.mapService=Ci(Sw),this.elementRef=Ci(ql),this.collectResourceTiming=at(),this.crossSourceCollisions=at(),this.customMapboxApiUrl=at(),this.fadeDuration=at(),this.hash=at(),this.refreshExpiredTiles=at(),this.canvasContextAttributes=at(),this.bearingSnap=at(),this.interactive=at(),this.pitchWithRotate=at(),this.clickTolerance=at(),this.attributionControl=at(),this.logoPosition=at(),this.maxTileCacheSize=at(),this.localIdeographFontFamily=at(),this.trackResize=at(),this.transformRequest=at(),this.bounds=at(),this.locale=at(),this.cooperativeGestures=at(),this.cancelPendingTileRequestsWhileZooming=at(),this.centerClampedToGround=at(),this.maplibreLogo=at(),this.maxCanvasSize=at(),this.maxTileCacheZoomLevels=at(),this.pixelRatio=at(),this.rollEnabled=at(),this.transformCameraUpdate=at(),this.validateStyle=at(),this.minZoom=at(),this.maxZoom=at(),this.minPitch=at(),this.maxPitch=at(),this.scrollZoom=at(),this.dragRotate=at(),this.touchPitch=at(),this.touchZoomRotate=at(),this.doubleClickZoom=at(),this.keyboard=at(),this.dragPan=at(),this.boxZoom=at(),this.style=at.required(),this.center=at(),this.maxBounds=at(),this.zoom=at(),this.bearing=at(),this.pitch=at(),this.roll=at(),this.fitBoundsOptions=at(),this.renderWorldCopies=at(),this.elevation=at(),this.terrain=at(),this.projection=at(),this.movingMethod=at("flyTo"),this.movingOptions=at(),this.fitBounds=at(),this.fitScreenCoordinates=at(),this.centerWithPanTo=at(),this.panToOptions=at(),this.cursorStyle=at(),this.mapResize=Et(),this.mapRemove=Et(),this.mapMouseDown=Et(),this.mapMouseUp=Et(),this.mapMouseMove=Et(),this.mapClick=Et(),this.mapDblClick=Et(),this.mapMouseOver=Et(),this.mapMouseOut=Et(),this.mapContextMenu=Et(),this.mapTouchStart=Et(),this.mapTouchEnd=Et(),this.mapTouchMove=Et(),this.mapTouchCancel=Et(),this.mapWheel=Et(),this.moveStart=Et(),this.move=Et(),this.moveEnd=Et(),this.mapDragStart=Et(),this.mapDrag=Et(),this.mapDragEnd=Et(),this.zoomStart=Et(),this.zoomEvt=Et(),this.zoomEnd=Et(),this.rotateStart=Et(),this.rotate=Et(),this.rotateEnd=Et(),this.pitchStart=Et(),this.pitchEvt=Et(),this.pitchEnd=Et(),this.boxZoomStart=Et(),this.boxZoomEnd=Et(),this.boxZoomCancel=Et(),this.webGlContextLost=Et(),this.webGlContextRestored=Et(),this.mapLoad=Et(),this.idle=Et(),this.render=Et(),this.mapError=Et(),this.data=Et(),this.styleData=Et(),this.sourceData=Et(),this.dataLoading=Et(),this.styleDataLoading=Et(),this.sourceDataLoading=Et(),this.styleImageMissing=Et(),this.mapContainer=Zy.required("container"),qy(()=>{if(this.canvasContextAttributes()?.preserveDrawingBuffer){let s=this.elementRef.nativeElement;s.setAttribute("data-cy","map"),this.mapLoad.subscribe(()=>{s.setAttribute("data-loaded","true")}),this.idle.subscribe(()=>{s.setAttribute("data-idle","true")}),this.render.subscribe(()=>{s.removeAttribute("data-idle")})}this.mapService.setup({mapOptions:{collectResourceTiming:this.collectResourceTiming(),container:this.mapContainer().nativeElement,crossSourceCollisions:this.crossSourceCollisions(),fadeDuration:this.fadeDuration(),minZoom:this.minZoom(),maxZoom:this.maxZoom(),minPitch:this.minPitch(),maxPitch:this.maxPitch(),style:this.style(),hash:this.hash(),interactive:this.interactive(),bearingSnap:this.bearingSnap(),pitchWithRotate:this.pitchWithRotate(),clickTolerance:this.clickTolerance(),attributionControl:this.attributionControl(),logoPosition:this.logoPosition(),canvasContextAttributes:this.canvasContextAttributes(),refreshExpiredTiles:this.refreshExpiredTiles(),maxBounds:this.maxBounds(),scrollZoom:this.scrollZoom(),boxZoom:this.boxZoom(),dragRotate:this.dragRotate(),dragPan:this.dragPan(),keyboard:this.keyboard(),doubleClickZoom:this.doubleClickZoom(),touchPitch:this.touchPitch(),touchZoomRotate:this.touchZoomRotate(),trackResize:this.trackResize(),center:this.center(),zoom:this.zoom(),bearing:this.bearing(),pitch:this.pitch(),roll:this.roll(),renderWorldCopies:this.renderWorldCopies(),maxTileCacheSize:this.maxTileCacheSize(),localIdeographFontFamily:this.localIdeographFontFamily(),transformRequest:this.transformRequest(),bounds:this.bounds()?this.bounds():this.fitBounds(),fitBoundsOptions:this.fitBoundsOptions(),locale:this.locale,cooperativeGestures:this.cooperativeGestures(),cancelPendingTileRequestsWhileZooming:this.cancelPendingTileRequestsWhileZooming(),centerClampedToGround:this.centerClampedToGround(),elevation:this.elevation(),maplibreLogo:this.maplibreLogo(),maxCanvasSize:this.maxCanvasSize(),maxTileCacheZoomLevels:this.maxTileCacheZoomLevels(),pixelRatio:this.pixelRatio(),rollEnabled:this.rollEnabled(),transformCameraUpdate:this.transformCameraUpdate(),validateStyle:this.validateStyle(),terrain:this.terrain(),projection:this.projection()},mapEvents:this});let i=this.cursorStyle();i&&this.mapService.changeCanvasCursor(i)}),x_(()=>{this.mapService.clearMapElements()})}ngOnDestroy(){this.mapService.destroyMap()}async ngOnChanges(i){await xf(this.mapService.mapCreated$);let s=this.zoom(),n=this.bearing(),o=this.pitch(),l=this.center();i.cursorStyle&&!i.cursorStyle.isFirstChange()&&this.mapService.changeCanvasCursor(i.cursorStyle.currentValue),i.minZoom&&!i.minZoom.isFirstChange()&&this.mapService.updateMinZoom(i.minZoom.currentValue),i.maxZoom&&!i.maxZoom.isFirstChange()&&this.mapService.updateMaxZoom(i.maxZoom.currentValue),i.minPitch&&!i.minPitch.isFirstChange()&&this.mapService.updateMinPitch(i.minPitch.currentValue),i.maxPitch&&!i.maxPitch.isFirstChange()&&this.mapService.updateMaxPitch(i.maxPitch.currentValue),i.renderWorldCopies&&!i.renderWorldCopies.isFirstChange()&&this.mapService.updateRenderWorldCopies(i.renderWorldCopies.currentValue),i.scrollZoom&&!i.scrollZoom.isFirstChange()&&this.mapService.updateScrollZoom(i.scrollZoom.currentValue),i.dragRotate&&!i.dragRotate.isFirstChange()&&this.mapService.updateDragRotate(i.dragRotate.currentValue),i.touchPitch&&!i.touchPitch.isFirstChange()&&this.mapService.updateTouchPitch(i.touchPitch.currentValue),i.touchZoomRotate&&!i.touchZoomRotate.isFirstChange()&&this.mapService.updateTouchZoomRotate(i.touchZoomRotate.currentValue),i.doubleClickZoom&&!i.doubleClickZoom.isFirstChange()&&this.mapService.updateDoubleClickZoom(i.doubleClickZoom.currentValue),i.keyboard&&!i.keyboard.isFirstChange()&&this.mapService.updateKeyboard(i.keyboard.currentValue),i.dragPan&&!i.dragPan.isFirstChange()&&this.mapService.updateDragPan(i.dragPan.currentValue),i.boxZoom&&!i.boxZoom.isFirstChange()&&this.mapService.updateBoxZoom(i.boxZoom.currentValue),i.style&&!i.style.isFirstChange()&&this.mapService.updateStyle(i.style.currentValue),i.maxBounds&&!i.maxBounds.isFirstChange()&&this.mapService.updateMaxBounds(i.maxBounds.currentValue),i.fitBounds&&i.fitBounds.currentValue&&!i.fitBounds.isFirstChange()&&this.mapService.fitBounds(i.fitBounds.currentValue,this.fitBoundsOptions()),i.fitScreenCoordinates&&i.fitScreenCoordinates.currentValue&&((l||s||o||this.fitBounds())&&i.fitScreenCoordinates.isFirstChange()&&console.warn("[ngx-maplibre-gl] center / zoom / pitch / fitBounds inputs are being overridden by fitScreenCoordinates input"),this.mapService.fitScreenCoordinates(i.fitScreenCoordinates.currentValue,n?n[0]:0,this.movingOptions())),this.centerWithPanTo()&&i.center&&!i.center.isFirstChange()&&!i.zoom&&!i.bearing&&!i.pitch&&!i.roll?this.mapService.panTo(this.center(),this.panToOptions()):(i.center&&!i.center.isFirstChange()||i.zoom&&!i.zoom.isFirstChange()||i.bearing&&!i.bearing.isFirstChange()&&!i.fitScreenCoordinates||i.pitch&&!i.pitch.isFirstChange()||i.roll&&!i.roll.isFirstChange())&&this.mapService.move(this.movingMethod(),this.movingOptions(),i.zoom&&s?s[0]:void 0,i.center?l:void 0,i.bearing&&n?n[0]:void 0,i.pitch&&o?o[0]:void 0,i.roll?i.roll.currentValue:void 0),i.terrain&&!i.terrain.isFirstChange()&&this.mapService.setTerrain(i.terrain.currentValue),i.projection&&!i.projection.isFirstChange()&&this.mapService.setProjection(i.projection.currentValue),i.elevation&&!i.elevation.isFirstChange()&&this.mapService.setCenterElevation(i.elevation.currentValue)}static{this.\u0275fac=function(s){return new(s||e)}}static{this.\u0275cmp=oo({type:e,selectors:[["mgl-map"]],viewQuery:function(s,n){s&1&&Yy(n.mapContainer,r4,5),s&2&&Qy()},inputs:{collectResourceTiming:[1,"collectResourceTiming"],crossSourceCollisions:[1,"crossSourceCollisions"],customMapboxApiUrl:[1,"customMapboxApiUrl"],fadeDuration:[1,"fadeDuration"],hash:[1,"hash"],refreshExpiredTiles:[1,"refreshExpiredTiles"],canvasContextAttributes:[1,"canvasContextAttributes"],bearingSnap:[1,"bearingSnap"],interactive:[1,"interactive"],pitchWithRotate:[1,"pitchWithRotate"],clickTolerance:[1,"clickTolerance"],attributionControl:[1,"attributionControl"],logoPosition:[1,"logoPosition"],maxTileCacheSize:[1,"maxTileCacheSize"],localIdeographFontFamily:[1,"localIdeographFontFamily"],trackResize:[1,"trackResize"],transformRequest:[1,"transformRequest"],bounds:[1,"bounds"],locale:[1,"locale"],cooperativeGestures:[1,"cooperativeGestures"],cancelPendingTileRequestsWhileZooming:[1,"cancelPendingTileRequestsWhileZooming"],centerClampedToGround:[1,"centerClampedToGround"],maplibreLogo:[1,"maplibreLogo"],maxCanvasSize:[1,"maxCanvasSize"],maxTileCacheZoomLevels:[1,"maxTileCacheZoomLevels"],pixelRatio:[1,"pixelRatio"],rollEnabled:[1,"rollEnabled"],transformCameraUpdate:[1,"transformCameraUpdate"],validateStyle:[1,"validateStyle"],minZoom:[1,"minZoom"],maxZoom:[1,"maxZoom"],minPitch:[1,"minPitch"],maxPitch:[1,"maxPitch"],scrollZoom:[1,"scrollZoom"],dragRotate:[1,"dragRotate"],touchPitch:[1,"touchPitch"],touchZoomRotate:[1,"touchZoomRotate"],doubleClickZoom:[1,"doubleClickZoom"],keyboard:[1,"keyboard"],dragPan:[1,"dragPan"],boxZoom:[1,"boxZoom"],style:[1,"style"],center:[1,"center"],maxBounds:[1,"maxBounds"],zoom:[1,"zoom"],bearing:[1,"bearing"],pitch:[1,"pitch"],roll:[1,"roll"],fitBoundsOptions:[1,"fitBoundsOptions"],renderWorldCopies:[1,"renderWorldCopies"],elevation:[1,"elevation"],terrain:[1,"terrain"],projection:[1,"projection"],movingMethod:[1,"movingMethod"],movingOptions:[1,"movingOptions"],fitBounds:[1,"fitBounds"],fitScreenCoordinates:[1,"fitScreenCoordinates"],centerWithPanTo:[1,"centerWithPanTo"],panToOptions:[1,"panToOptions"],cursorStyle:[1,"cursorStyle"]},outputs:{mapResize:"mapResize",mapRemove:"mapRemove",mapMouseDown:"mapMouseDown",mapMouseUp:"mapMouseUp",mapMouseMove:"mapMouseMove",mapClick:"mapClick",mapDblClick:"mapDblClick",mapMouseOver:"mapMouseOver",mapMouseOut:"mapMouseOut",mapContextMenu:"mapContextMenu",mapTouchStart:"mapTouchStart",mapTouchEnd:"mapTouchEnd",mapTouchMove:"mapTouchMove",mapTouchCancel:"mapTouchCancel",mapWheel:"mapWheel",moveStart:"moveStart",move:"move",moveEnd:"moveEnd",mapDragStart:"mapDragStart",mapDrag:"mapDrag",mapDragEnd:"mapDragEnd",zoomStart:"zoomStart",zoomEvt:"zoomEvt",zoomEnd:"zoomEnd",rotateStart:"rotateStart",rotate:"rotate",rotateEnd:"rotateEnd",pitchStart:"pitchStart",pitchEvt:"pitchEvt",pitchEnd:"pitchEnd",boxZoomStart:"boxZoomStart",boxZoomEnd:"boxZoomEnd",boxZoomCancel:"boxZoomCancel",webGlContextLost:"webGlContextLost",webGlContextRestored:"webGlContextRestored",mapLoad:"mapLoad",idle:"idle",render:"render",mapError:"mapError",data:"data",styleData:"styleData",sourceData:"sourceData",dataLoading:"dataLoading",styleDataLoading:"styleDataLoading",sourceDataLoading:"sourceDataLoading",styleImageMissing:"styleImageMissing"},features:[ka([Sw]),Hr],decls:2,vars:0,consts:[["container",""]],template:function(s,n){s&1&&Lo(0,"div",null,0)},styles:["[_nghost-%COMP%]{display:block}div[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0})}}return e})(),TR=(()=>{class e{constructor(){this.mapService=Ci(Sw),this.destroyRef=Ci(b_),this.offset=at(),this.anchor=at(),this.clickTolerance=at(),this.color=at(),this.scale=at(),this.opacity=at(),this.opacityWhenCovered=at(),this.subpixelPositioning=at(),this.feature=at(),this.lngLat=at(),this.draggable=at(),this.popupShown=at(),this.className=at(),this.pitchAlignment=at(),this.rotationAlignment=at(),this.rotation=at(),this.markerDragStart=Et(),this.markerDragEnd=Et(),this.markerDrag=Et(),this.content=Zy.required("content"),this.markerInstance=Dh(null),qy(()=>{this.mapService.mapCreated$.pipe(I_(this.destroyRef)).subscribe(()=>{let i=this.mapService.addMarker({markersOptions:{element:this.content().nativeElement,feature:this.feature(),lngLat:this.lngLat(),offset:this.offset(),anchor:this.anchor(),color:this.color(),scale:this.scale(),draggable:!!this.draggable(),clickTolerance:this.clickTolerance(),rotation:this.rotation(),rotationAlignment:this.rotationAlignment(),pitchAlignment:this.pitchAlignment(),opacity:this.opacity(),opacityWhenCovered:this.opacityWhenCovered(),subpixelPositioning:this.subpixelPositioning()},markersEvents:{markerDragStart:this.markerDragStart,markerDrag:this.markerDrag,markerDragEnd:this.markerDragEnd}});this.markerInstance.set(i)})})}ngOnDestroy(){this.removeMarker()}ngOnInit(){if(this.feature()&&this.lngLat())throw new Error("feature and lngLat input are mutually exclusive")}ngOnChanges(i){let s=this.markerInstance();i.lngLat&&!i.lngLat.isFirstChange()&&s.setLngLat(i.lngLat.currentValue),i.feature&&!i.feature.isFirstChange()&&s.setLngLat(i.feature.currentValue.geometry.coordinates),i.draggable&&!i.draggable.isFirstChange()&&s.setDraggable(!!i.draggable.currentValue),i.popupShown&&!i.popupShown.isFirstChange()&&(i.popupShown.currentValue?s.getPopup().addTo(this.mapService.mapInstance):s.getPopup().remove()),i.pitchAlignment&&!i.pitchAlignment.isFirstChange()&&s.setPitchAlignment(i.pitchAlignment.currentValue),i.rotationAlignment&&!i.rotationAlignment.isFirstChange()&&s.setRotationAlignment(i.rotationAlignment.currentValue),i.rotation&&!i.rotation.isFirstChange()&&s.setRotation(i.rotation.currentValue)}removeMarker(){this.mapService.removeMarker(this.markerInstance()),this.markerInstance.set(null)}togglePopup(){this.markerInstance().togglePopup()}static{this.\u0275fac=function(s){return new(s||e)}}static{this.\u0275cmp=oo({type:e,selectors:[["mgl-marker"]],viewQuery:function(s,n){s&1&&Yy(n.content,o4,5),s&2&&Qy()},inputs:{offset:[1,"offset"],anchor:[1,"anchor"],clickTolerance:[1,"clickTolerance"],color:[1,"color"],scale:[1,"scale"],opacity:[1,"opacity"],opacityWhenCovered:[1,"opacityWhenCovered"],subpixelPositioning:[1,"subpixelPositioning"],feature:[1,"feature"],lngLat:[1,"lngLat"],draggable:[1,"draggable"],popupShown:[1,"popupShown"],className:[1,"className"],pitchAlignment:[1,"pitchAlignment"],rotationAlignment:[1,"rotationAlignment"],rotation:[1,"rotation"]},outputs:{markerDragStart:"markerDragStart",markerDragEnd:"markerDragEnd",markerDrag:"markerDrag"},features:[Hr],ngContentSelectors:n4,decls:3,vars:2,consts:[["content",""]],template:function(s,n){s&1&&(Jd(),ho(0,"div",null,0),ep(2),uo()),s&2&&S_(n.className())},encapsulation:2,changeDetection:0})}}return e})();var Pm=class e{#e=Ci(M_);url(t){return`https://maps.googleapis.com/maps/api/geocode/json?address=${t}&key=${A_}`}getLocation(t){return xf(this.#e.get(this.url(t)))}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Zo({token:e,factory:e.\u0275fac,providedIn:"root"})};var a4=()=>[34.80092882883532,32.08485247343606],l4=()=>[6],c4=(e,t)=>[e,t];function h4(e,t){if(e&1&&Lo(0,"mgl-marker",1),e&2){let i=t.$implicit;kh("lngLat",E_(1,c4,i.lng,i.lat))}}var Mm=class e{applicants=Ci(Kn).entities;geocoder=Ci(Pm);colorScheme=Ci(Lh);style=Zn(()=>this.colorScheme.theme()==="dark"?"https://tiles.openfreemap.org/styles/fiord":"https://tiles.openfreemap.org/styles/liberty");markers=k_({request:this.applicants,loader:({request:t})=>m_(t.map(i=>this.geocoder.getLocation(i.city_region).then(s=>s.results[0].geometry.location)))});static \u0275fac=function(i){return new(i||e)};static \u0275cmp=oo({type:e,selectors:[["iisa-map"]],decls:3,vars:6,consts:[[1,"block","h-full",3,"center","zoom"],[3,"lngLat"]],template:function(i,s){i&1&&(ho(0,"mgl-map",0),Ky(1,h4,1,4,"mgl-marker",1,R_),uo()),i&2&&(__(s.style()),kh("center",Ef(4,a4))("zoom",Ef(5,l4)),Fh(),Xy(s.markers.value()))},dependencies:[MR,TR],encapsulation:2,changeDetection:0})};var Pw=(()=>{class e{changes=new Xd;static \u0275fac=function(s){return new(s||e)};static \u0275prov=Zo({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function u4(e){return e||new Pw}var d4={provide:Pw,deps:[[new w_,new C_,Pw]],useFactory:u4};var IR=(()=>{class e{static \u0275fac=function(s){return new(s||e)};static \u0275mod=Ia({type:e});static \u0275inj=Fa({providers:[d4],imports:[tp]})}return e})();var kR=(()=>{class e{static \u0275fac=function(s){return new(s||e)};static \u0275mod=Ia({type:e});static \u0275inj=Fa({imports:[F_]})}return e})();var AR=(()=>{class e{static \u0275fac=function(s){return new(s||e)};static \u0275mod=Ia({type:e});static \u0275inj=Fa({imports:[tp,kR,tp]})}return e})(),v4=9007199254740991,Tm=class extends Jy{_data;_renderData=new Th([]);_filter=new Th("");_internalPageChanges=new Xd;_renderChangesSubscription=null;filteredData;get data(){return this._data.value}set data(t){t=Array.isArray(t)?t:[],this._data.next(t),this._renderChangesSubscription||this._filterData(t)}get filter(){return this._filter.value}set filter(t){this._filter.next(t),this._renderChangesSubscription||this._filterData(this.data)}get sort(){return this._sort}set sort(t){this._sort=t,this._updateChangeSubscription()}_sort;get paginator(){return this._paginator}set paginator(t){this._paginator=t,this._updateChangeSubscription()}_paginator;sortingDataAccessor=(t,i)=>{let s=t[i];if(D_(s)){let n=Number(s);return n<v4?n:s}return s};sortData=(t,i)=>{let s=i.active,n=i.direction;return!s||n==""?t:t.sort((o,l)=>{let d=this.sortingDataAccessor(o,s),p=this.sortingDataAccessor(l,s),y=typeof d,C=typeof p;y!==C&&(y==="number"&&(d+=""),C==="number"&&(p+=""));let S=0;return d!=null&&p!=null?d>p?S=1:d<p&&(S=-1):d!=null?S=1:p!=null&&(S=-1),S*(n=="asc"?1:-1)})};filterPredicate=(t,i)=>{let s=i.trim().toLowerCase();return Object.values(t).some(n=>`${n}`.toLowerCase().includes(s))};constructor(t=[]){super(),this._data=new Th(t),this._updateChangeSubscription()}_updateChangeSubscription(){let t=this._sort?Yd(this._sort.sortChange,this._sort.initialized):jy(null),i=this._paginator?Yd(this._paginator.page,this._internalPageChanges,this._paginator.initialized):jy(null),s=this._data,n=Sf([s,this._filter]).pipe(_f(([d])=>this._filterData(d))),o=Sf([n,t]).pipe(_f(([d])=>this._orderData(d))),l=Sf([o,i]).pipe(_f(([d])=>this._pageData(d)));this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=l.subscribe(d=>this._renderData.next(d))}_filterData(t){return this.filteredData=this.filter==null||this.filter===""?t:t.filter(i=>this.filterPredicate(i,this.filter)),this.paginator&&this._updatePaginator(this.filteredData.length),this.filteredData}_orderData(t){return this.sort?this.sortData(t.slice(),this.sort):t}_pageData(t){if(!this.paginator)return t;let i=this.paginator.pageIndex*this.paginator.pageSize;return t.slice(i,i+this.paginator.pageSize)}_updatePaginator(t){Promise.resolve().then(()=>{let i=this.paginator;if(i&&(i.length=t,i.pageIndex>0)){let s=Math.ceil(i.length/i.pageSize)-1||0,n=Math.min(i.pageIndex,s);n!==i.pageIndex&&(i.pageIndex=n,this._internalPageChanges.next())}})}connect(){return this._renderChangesSubscription||this._updateChangeSubscription(),this._renderData}disconnect(){this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=null}};var dc=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,i){let s=t?this.allAsyncListeners:this.allSyncListeners,n=s.get(e);return!n&&i&&(n=new Set,s.set(e,n)),n}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(e,t,i=!1){this.getListeners(e,i,!0).add(t)}removeEventListener(e,t,i=!1){let s=this.getListeners(e,i,!1);s&&(s.delete(t),s.size===0&&(i?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){this.getGlobalListeners(t).add(e)}removeGlobalListener(e,t=!1){this.getGlobalListeners(t).delete(e)}dispatchEvent(e){this.dispatchToListeners(e,!0),this.dispatchToListeners(e,!1),this.firedEvents[e.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){let i=e.type;if(t&&"event"in e){let d=e.event;d instanceof Event&&(e.eventPath=d.composedPath())}let{frameworkOverrides:s}=this,n=d=>{let p=s?()=>s.wrapIncoming(d):d;t?this.dispatchAsync(p):p()},o=this.getListeners(i,t,!1);if((o?.size??0)>0){let d=new Set(o);for(let p of d)o?.has(p)&&n(()=>p(e))}let l=this.getGlobalListeners(t);if(l.size>0){let d=new Set(l);for(let p of d)n(()=>p(i,e))}}getGlobalListeners(e){return e?this.globalAsyncListeners:this.globalSyncListeners}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){let t=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(t):t(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;let e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach(t=>t())}};function Qr(e){return e==null||e===""?null:e}function st(e){return e!=null&&e!==""}function Di(e){return!st(e)}function aC(e){return e!=null&&typeof e.toString=="function"?e.toString():null}function Wp(e,t){let i=e?JSON.stringify(e):null,s=t?JSON.stringify(t):null;return i===s}function y4(e,t,i=!1){let s=e==null,n=t==null;if(e&&e.toNumber&&(e=e.toNumber()),t&&t.toNumber&&(t=t.toNumber()),s&&n)return 0;if(s)return-1;if(n)return 1;function o(l,d){return l>d?1:l<d?-1:0}if(typeof e!="string"||!i)return o(e,t);try{return e.localeCompare(t)}catch{return o(e,t)}}var w4=/[&<>"']/g,C4={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Iu(e){return e?.toString().toString()??null}function Op(e){return Iu(e)?.replace(w4,t=>C4[t])??null}function Up(e){return e.eRootDiv.getRootNode()}function zi(e){return Up(e).activeElement}function Vs(e){let{gos:t,eRootDiv:i}=e,s=null,n=t.get("getDocument");return n&&st(n)?s=n():i&&(s=i.ownerDocument),s&&st(s)?s:document}function JE(e){let t=zi(e);return t===null||t===Vs(e).body}function eP(e){return Vs(e).defaultView||window}function GC(e){let t=null,i=null;try{t=Vs(e).fullscreenElement}catch{}finally{t||(t=Up(e));let s=t.querySelector("body");s?i=s:t instanceof ShadowRoot?i=t:t instanceof Document?i=t?.documentElement:i=t}return i}function b4(e){return GC(e)?.clientWidth??(window.innerWidth||-1)}function x4(e){return GC(e)?.clientHeight??(window.innerHeight||-1)}function Sn(e,t,i){i==null||typeof i=="string"&&i==""?tP(e,t):rn(e,t,i)}function rn(e,t,i){e.setAttribute(iP(t),i.toString())}function tP(e,t){e.removeAttribute(iP(t))}function iP(e){return`aria-${e}`}function tl(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function _4(e){let t;return e==="asc"?t="ascending":e==="desc"?t="descending":e==="mixed"?t="other":t="none",t}function S4(e){return e.getAttribute("aria-label")}function Eu(e,t){Sn(e,"label",t)}function jp(e,t){Sn(e,"labelledby",t)}function sP(e,t){Sn(e,"live",t)}function R4(e,t){Sn(e,"atomic",t)}function E4(e,t){Sn(e,"relevant",t)}function P4(e,t){Sn(e,"invalid",t)}function M4(e,t){Sn(e,"disabled",t)}function oP(e,t){Sn(e,"hidden",t)}function lC(e,t){rn(e,"expanded",t)}function T4(e,t){rn(e,"setsize",t)}function D4(e,t){rn(e,"posinset",t)}function F4(e,t){rn(e,"multiselectable",t)}function I4(e,t){rn(e,"rowcount",t)}function Xm(e,t){rn(e,"rowindex",t)}function k4(e,t){rn(e,"rowspan",t)}function A4(e,t){rn(e,"colcount",t)}function nP(e,t){rn(e,"colindex",t)}function L4(e,t){rn(e,"colspan",t)}function O4(e,t){rn(e,"sort",t)}function z4(e){tP(e,"sort")}function rP(e,t){Sn(e,"selected",t)}function B4(e,t){Sn(e,"controls",t)}function V4(e,t){B4(e,t.id),jp(t,e.id)}function LR(e,t){Sn(e,"owns",t)}function yv(e,t){return t===void 0?e("ariaIndeterminate","indeterminate"):t===!0?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var H4="[tabindex], input, select, button, textarea, [href]",aP="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function WC(e){let t=Element.prototype.matches||Element.prototype.msMatchesSelector,s=t.call(e,"input, select, button, textarea"),n=t.call(e,aP),o=ur(e);return s&&!n&&o}function Ti(e,t,i={}){let{skipAriaHidden:s}=i;e.classList.toggle("ag-hidden",!t),s||oP(e,!t)}function N4(e,t,i={}){let{skipAriaHidden:s}=i;e.classList.toggle("ag-invisible",!t),s||oP(e,!t)}function $p(e,t){let i="disabled",s=t?o=>o.setAttribute(i,""):o=>o.removeAttribute(i);s(e);let n=e.querySelectorAll("input")??[];for(let o of n)s(o)}function rc(e,t,i){let s=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,typeof i=="number"){if(++s>i)break}else if(e===i)break}return!1}function yc(e){let{height:t,width:i,borderTopWidth:s,borderRightWidth:n,borderBottomWidth:o,borderLeftWidth:l,paddingTop:d,paddingRight:p,paddingBottom:y,paddingLeft:C,marginTop:S,marginRight:P,marginBottom:I,marginLeft:O,boxSizing:V}=window.getComputedStyle(e);return{height:parseFloat(t||"0"),width:parseFloat(i||"0"),borderTopWidth:parseFloat(s||"0"),borderRightWidth:parseFloat(n||"0"),borderBottomWidth:parseFloat(o||"0"),borderLeftWidth:parseFloat(l||"0"),paddingTop:parseFloat(d||"0"),paddingRight:parseFloat(p||"0"),paddingBottom:parseFloat(y||"0"),paddingLeft:parseFloat(C||"0"),marginTop:parseFloat(S||"0"),marginRight:parseFloat(P||"0"),marginBottom:parseFloat(I||"0"),marginLeft:parseFloat(O||"0"),boxSizing:V}}function UC(e){let t=yc(e);return t.boxSizing==="border-box"?t.height-t.paddingTop-t.paddingBottom:t.height}function qp(e){let t=yc(e);return t.boxSizing==="border-box"?t.width-t.paddingLeft-t.paddingRight:t.width}function lP(e){let{height:t,marginBottom:i,marginTop:s}=yc(e);return Math.floor(t+i+s)}function Ym(e){let{width:t,marginLeft:i,marginRight:s}=yc(e);return Math.floor(t+i+s)}function cP(e){let t=e.getBoundingClientRect(),{borderTopWidth:i,borderLeftWidth:s,borderRightWidth:n,borderBottomWidth:o}=yc(e);return{top:t.top+(i||0),left:t.left+(s||0),right:t.right+(n||0),bottom:t.bottom+(o||0)}}function Qm(e,t){let i=e.scrollLeft;return t&&(i=Math.abs(i)),i}function Jm(e,t,i){i&&(t*=-1),e.scrollLeft=t}function Ns(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}function yo(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function hP(e){return!!e.offsetParent}function ur(e){let t=e;return t.checkVisibility?t.checkVisibility({checkVisibilityCSS:!0}):!(!hP(e)||window.getComputedStyle(e).visibility!=="visible")}function jC(e){let t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function uP(e,t,i){i&&i.nextSibling===t||(e.firstChild?i?i.nextSibling?e.insertBefore(t,i.nextSibling):e.appendChild(t):e.firstChild&&e.firstChild!==t&&e.insertAdjacentElement("afterbegin",t):e.appendChild(t))}function dP(e,t){for(let i=0;i<t.length;i++){let s=t[i],n=e.children[i];n!==s&&e.insertBefore(s,n)}}function G4(e){return e.replace(/[A-Z]/g,t=>`-${t.toLocaleLowerCase()}`)}function og(e,t){if(t)for(let i of Object.keys(t)){let s=t[i];if(!i||!i.length||s==null)continue;let n=G4(i),o=s.toString(),l=o.replace(/\s*!important/g,""),d=l.length!=o.length?"important":void 0;e.style.setProperty(n,l,d)}}function Hm(e){return()=>{let t=e();return t?$C(t)||pP(t):!0}}function $C(e){return e.clientWidth<e.scrollWidth}function pP(e){return e.clientHeight<e.scrollHeight}function ev(e,t){t==="flex"?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):lr(e,t)}function lr(e,t){t=qC(t),e.style.width=t,e.style.maxWidth=t,e.style.minWidth=t}function zp(e,t){t=qC(t),e.style.height=t,e.style.maxHeight=t,e.style.minHeight=t}function qC(e){return typeof e=="number"?`${e}px`:e}function ZC(e){return e instanceof Node||e instanceof HTMLElement}function zo(e,t,i){i==null||i===""?e.removeAttribute(t):e.setAttribute(t,i.toString())}function nl(e,t,i){let n=eP(e).ResizeObserver,o=n?new n(i):null;return o?.observe(t),()=>o?.disconnect()}function sa(e,t){let i=eP(e);i.requestAnimationFrame?i.requestAnimationFrame(t):i.webkitRequestAnimationFrame?i.webkitRequestAnimationFrame(t):i.setTimeout(t,0)}var gP="data-ref",Mw;function OR(){return Mw??(Mw=document.createTextNode(" ")),Mw.cloneNode()}function ng(e){let{attrs:t,children:i,cls:s,ref:n,role:o,tag:l}=e,d=document.createElement(l);if(s&&(d.className=s),n&&d.setAttribute(gP,n),o&&d.setAttribute("role",o),t)for(let p of Object.keys(t))d.setAttribute(p,t[p]);if(i)if(typeof i=="string")d.textContent=i;else{let p=!0;for(let y of i)y&&(typeof y=="string"?(d.appendChild(document.createTextNode(y)),p=!1):typeof y=="function"?d.appendChild(y()):(p&&(d.appendChild(OR()),p=!1),d.append(ng(y)),d.appendChild(OR())))}return d}var W4=["touchstart","touchend","touchmove","touchcancel","scroll"],U4=["wheel"],Tw={},fP=(()=>{let e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return i=>{if(typeof Tw[i]=="boolean")return Tw[i];let s=document.createElement(e[i]||"div");return i="on"+i,Tw[i]=i in s}})();function j4(e,t){return!t||!e?!1:q4(t).indexOf(e)>=0}function $4(e){let t=[],i=e.target;for(;i;)t.push(i),i=i.parentElement;return t}function q4(e){let t=e;return t.path?t.path:t.composedPath?t.composedPath():$4(t)}function Z4(e,t,i){let s=K4(t),n;s!=null&&(n={passive:s}),e.addEventListener(t,i,n)}var K4=e=>{let t=W4.includes(e),i=U4.includes(e);if(t)return!0;if(i)return!1};function mP(e,t,i){if(i===0)return!1;let s=Math.abs(e.clientX-t.clientX),n=Math.abs(e.clientY-t.clientY);return Math.max(s,n)<=i}function Zp(e,t){return e.gos.isElementInThisInstance(t.target)}function X4(e,t,i){let n=e.getBoundingClientRect().height,o=b4(i)-2,l=x4(i)-2;if(!e.offsetParent)return;let p=cP(e.offsetParent),{clientY:y,clientX:C}=t,S=y-p.top-n/2,P=C-p.left-10,I=Vs(i),O=I.defaultView||window,V=O.pageYOffset||I.documentElement.scrollTop,G=O.pageXOffset||I.documentElement.scrollLeft;o>0&&P+e.clientWidth>o+G&&(P=o+G-e.clientWidth),P<0&&(P=0),l>0&&S+e.clientHeight>l+V&&(S=l+V-e.clientHeight),S<0&&(S=0),e.style.left=`${P}px`,e.style.top=`${S}px`}function Y4(e,t){return t}function vP(e){return e?.getLocaleTextFunc()??Y4}function Q4(e,t,i,s){let n=t[i];return e.getLocaleTextFunc()(i,typeof n=="function"?n(s):n,s)}function J4(e){return(t,i,s)=>e({key:t,defaultValue:i,variableValues:s})}function eB(e){return(t,i,s)=>{let n=e&&e[t];if(n&&s&&s.length){let o=0;for(;!(o>=s.length||n.indexOf("${variable}")===-1);)n=n.replace("${variable}",s[o++])}return n??i}}var dr=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.beans=e,this.stubContext=e.context,this.eventSvc=e.eventSvc,this.gos=e.gos}destroy(){let{destroyFunctions:e}=this;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,i){this.localEventService||(this.localEventService=new dc),this.localEventService.addEventListener(e,t,i)}removeEventListener(e,t,i){this.localEventService?.removeEventListener(e,t,i)}dispatchLocalEvent(e){this.localEventService?.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventSvc,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){let i=[];for(let s of Object.keys(t)){let n=t[s];n&&i.push(this._setupListener(e,s,n))}return i}_setupListener(e,t,i){if(this.destroyed)return()=>null;let s;if(tB(e))e.__addEventListener(t,i),s=()=>(e.__removeEventListener(t,i),null);else{let n=iB(e);e instanceof HTMLElement?Z4(e,t,i):n?e.addListener(t,i):e.addEventListener(t,i),s=n?()=>(e.removeListener(t,i),null):()=>(e.removeEventListener(t,i),null)}return this.destroyFunctions.push(s),()=>(s(),this.destroyFunctions=this.destroyFunctions.filter(n=>n!==s),null)}setupPropertyListener(e,t){let{gos:i}=this;i.addPropertyEventListener(e,t);let s=()=>(i.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(s),()=>(s(),this.destroyFunctions=this.destroyFunctions.filter(n=>n!==s),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupPropertyListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;let i=e.join("-")+this.propertyListenerId++,s=n=>{if(n.changeSet){if(n.changeSet&&n.changeSet.id===this.lastChangeSetIdLookup[i])return;this.lastChangeSetIdLookup[i]=n.changeSet.id}let o={type:"propertyChanged",changeSet:n.changeSet,source:n.source};t(o)};e.forEach(n=>this.setupPropertyListener(n,s))}getLocaleTextFunc(){return vP(this.beans.localeSvc)}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createOptionalManagedBean(e,t){return e?this.createManagedBean(e,t):void 0}createManagedBean(e,t){let i=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),i}createBean(e,t,i){return(t||this.stubContext).createBean(e,i)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function tB(e){return e.__addEventListener!==void 0}function iB(e){return e.eventServiceType==="global"}var Be=class extends dr{},zR={};function KC(e,t){zR[t]||(e(),zR[t]=!0)}var sB={pending:!1,funcs:[]},oB={pending:!1,funcs:[]};function cC(e,t="setTimeout",i){let s=t==="raf"?oB:sB;if(s.funcs.push(e),s.pending)return;s.pending=!0;let n=()=>{let o=s.funcs.slice();s.funcs.length=0,s.pending=!1,o.forEach(l=>l())};t==="raf"?sa(i,n):window.setTimeout(n,0)}function Hs(e,t,i){let s;return function(...n){let o=this;window.clearTimeout(s),s=window.setTimeout(function(){e.isAlive()&&t.apply(o,n)},i)}}function BR(e,t){let i=0;return function(...s){let n=this,o=Date.now();o-i<t||(i=o,e.apply(n,s))}}function nB(e,t,i,s=100){let n=Date.now(),o=null,l=!1,d=()=>{o!=null&&(window.clearInterval(o),o=null)};e.addDestroyFunc(d);let p=()=>{let y=Date.now()-n>s;(t()||y)&&(i(),l=!0,d())};p(),l||(o=window.setInterval(p,10))}var yP=new Set(["__proto__","constructor","prototype"]);function rB(e,t){if(e!=null){if(Array.isArray(e)){for(let i=0;i<e.length;i++)t(i.toString(),e[i]);return}for(let i of Object.keys(e).filter(s=>!yP.has(s)))t(i,e[i])}}function no(e,t,i=!0,s=!1){st(t)&&rB(t,(n,o)=>{let l=e[n];l!==o&&(s&&l==null&&o!=null&&typeof o=="object"&&o.constructor===Object&&(l={},e[n]=l),VR(o)&&VR(l)&&!Array.isArray(l)?no(l,o,i,s):(i||o!==void 0)&&(e[n]=o))})}function VR(e){return typeof e=="object"&&e!==null}var aB=(()=>{let e=class ic{static applyGlobalGridOptions(i){if(!ic.gridOptions)return Se({},i);let s={};return no(s,ic.gridOptions,!0,!0),ic.mergeStrategy==="deep"?no(s,i,!0,!0):s=Se(Se({},s),i),ic.gridOptions.context&&(s.context=ic.gridOptions.context),i.context&&(ic.mergeStrategy==="deep"&&s.context&&no(i.context,s.context,!0,!0),s.context=i.context),s}};return e.gridOptions=void 0,e.mergeStrategy="shallow",e})(),lB=aB;var cB={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,cellFlashDuration:500,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,rowDragInsertDelay:500,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1,rowNumbers:!1,enableFilterHandlers:!1},wP="https://www.ag-grid.com";function il(e,t,...i){e.get("debug")&&console.log("AG Grid: "+t,...i)}function Bp(e,...t){KC(()=>console.warn("AG Grid: "+e,...t),e+t?.join(""))}function fu(e,...t){KC(()=>console.error("AG Grid: "+e,...t),e+t?.join(""))}var nt="34.2.0",HR=2e3,NR=100,CP="_version_",bP=null,mu=`${wP}/javascript-data-grid`;function hB(e){bP=e}function uB(e){mu=e}function xP(e,t,i){return bP?.(e,t)??[fB(e,t,i)]}function XC(e,t,i,s,n){e(`${s?"warning":"error"} #${t}`,...xP(t,i,n))}function dB(e){if(!e)return String(e);let t={};for(let i of Object.keys(e))typeof e[i]!="object"&&typeof e[i]!="function"&&(t[i]=e[i]);return JSON.stringify(t)}function pB(e){let t=e;return e instanceof Error?t=e.toString():typeof e=="object"&&(t=dB(e)),t}function tv(e){return e===void 0?"undefined":e===null?"null":e}function hC(e,t){return`${e}?${t.toString()}`}function gB(e,t,i){let s=Array.from(t.entries()).sort((o,l)=>l[1].length-o[1].length),n=hC(e,t);for(let[o,l]of s){if(o===CP)continue;let d=n.length-i;if(d<=0)break;let p="...",y=d+p.length,C=l.length-y>NR?l.slice(0,l.length-y)+p:l.slice(0,NR)+p;t.set(o,C),n=hC(e,t)}return n}function _P(e,t){let i=new URLSearchParams;if(i.append(CP,nt),t)for(let o of Object.keys(t))i.append(o,pB(t[o]));let s=`${mu}/errors/${e}`,n=hC(s,i);return n.length<=HR?n:gB(s,i,HR)}var fB=(e,t,i)=>{let s=_P(e,t);return`${i?i+` 
`:""}Visit ${s}${i?"":` 
  Alternatively register the ValidationModule to see the full message in the console.`}`};function je(...e){XC(Bp,e[0],e[1],!0)}function li(...e){XC(fu,e[0],e[1],!1)}function Ap(e,t,i){XC(fu,e,t,!1,i)}function mB(e,t){let i=t[0];return`error #${i} `+xP(i,t[1],e).join(" ")}function cr(...e){return mB(void 0,e)}function SP(e,t){return e.get("rowModelType")===t}function Ms(e,t){return SP(e,"clientSide")}function ku(e,t){return SP(e,"serverSide")}function Gs(e,t){return e.get("domLayout")===t}function ac(e){return sv(e)!==void 0}function RP(e){return typeof e.get("getRowHeight")=="function"}function vB(e,t){return t?!e.get("enableStrictPivotColumnOrder"):e.get("maintainColumnOrder")}function sl(e,t,i=!1,s){let{gos:n,environment:o}=e;if(s==null&&(s=o.getDefaultRowHeight()),RP(n)){if(i)return{height:s,estimated:!0};let p={node:t,data:t.data},y=n.getCallback("getRowHeight")(p);if(uC(y))return y===0&&je(23),{height:Math.max(1,y),estimated:!1}}if(t.detail&&n.get("masterDetail"))return yB(n);let l=n.get("rowHeight");return{height:l&&uC(l)?l:s,estimated:!1}}function yB(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};let t=e.get("detailRowHeight");return uC(t)?{height:t,estimated:!1}:{height:300,estimated:!1}}function lc(e){let{environment:t,gos:i}=e,s=i.get("rowHeight");if(!s||Di(s))return t.getDefaultRowHeight();let n=t.refreshRowHeightVariable();return n!==-1?n:(je(24),t.getDefaultRowHeight())}function uC(e){return!isNaN(e)&&typeof e=="number"&&isFinite(e)}function EP(e,t,i){let s=t[e.getDomDataKey()];return s?s[i]:void 0}function pc(e,t,i,s){let n=e.getDomDataKey(),o=t[n];Di(o)&&(o={},t[n]=o),o[i]=s}function vu(e){return e.get("ensureDomOrder")?!1:e.get("animateRows")}function PP(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||Gs(e,"print"))}function nr(e){return!e.get("autoGroupColumnDef")?.comparator&&!e.get("treeData")}function dC(e){let t=e.get("groupAggFiltering");if(typeof t=="function")return e.getCallback("groupAggFiltering");if(t===!0)return()=>!0}function MP(e){return e.get("grandTotalRow")}function TP(e,t){return t?!1:e.get("groupDisplayType")==="groupRows"}function DP(e,t,i){return!!t.group&&!t.footer&&TP(e,i)}function Pu(e){let t=e.getCallback("getRowId");return t===void 0?t:i=>{let s=t(i);return typeof s!="string"&&(KC(()=>je(25,{id:s}),"getRowIdString"),s=String(s)),s}}function wB(e,t){let i=e.get("groupHideParentOfSingleChild");return!!(i===!0||i==="leafGroupsOnly"&&t.leafGroup||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")&&t.leafGroup)}function CB(e){let t=e.get("maxConcurrentDatasourceRequests");return t>0?t:void 0}function yu(e){return e?.checkboxes??!0}function Nm(e){return e?.mode==="multiRow"&&(e.headerCheckbox??!0)}function iv(e){if(typeof e=="object")return e.checkboxLocation??"selectionColumn"}function Dw(e){return e?.hideDisabledCheckboxes??!1}function bB(e){return typeof e.get("rowSelection")!="string"}function ta(e){let t=e.get("cellSelection");return t!==void 0?!!t:e.get("enableRangeSelection")}function FP(e){let t=e.get("rowSelection")??"single";if(typeof t=="string"){let i=e.get("suppressRowClickSelection"),s=e.get("suppressRowDeselection");return i&&s?!1:i?"enableDeselection":s?"enableSelection":!0}return t.mode==="singleRow"||t.mode==="multiRow"?t.enableClickSelection??!1:!1}function xB(e){let t=FP(e);return t===!0||t==="enableSelection"}function _B(e){let t=FP(e);return t===!0||t==="enableDeselection"}function pC(e){let t=e.get("rowSelection");return typeof t=="string"?e.get("isRowSelectable"):t?.isRowSelectable}function sv(e){let t="beanName"in e&&e.beanName==="gos"?e.get("rowSelection"):e.rowSelection;if(typeof t=="string")switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}switch(t?.mode){case"multiRow":case"singleRow":return t.mode;default:return}}function Kp(e){return sv(e)==="multiRow"}function SB(e){let t=e.get("rowSelection");return typeof t=="string"?e.get("rowMultiSelectWithClick"):t?.enableSelectionWithoutKeys??!1}function ov(e){let t=e.get("rowSelection");if(typeof t=="string"){let i=e.get("groupSelectsChildren"),s=e.get("groupSelectsFiltered");return i&&s?"filteredDescendants":i?"descendants":"self"}return t?.mode==="multiRow"?t.groupSelects:void 0}function IP(e,t=!0){let i=e.get("rowSelection");return typeof i!="object"?t?"all":void 0:i.mode==="multiRow"?i.selectAll:"all"}function Xp(e){let t=ov(e);return t==="descendants"||t==="filteredDescendants"}function GR(e){let t=e.get("rowSelection");return typeof t=="object"&&t.masterSelects||"self"}function RB(e){return e.isModuleRegistered("SetFilter")&&!e.get("suppressSetFilterByDefault")}function Bo(e){return e.get("columnMenu")==="legacy"}function EB(e){return!Bo(e)}function PB(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}function kP(e,t,i){typeof e!="object"&&(e={});let s=Se({},e);return i.forEach(n=>{let o=t[n];typeof o<"u"&&(s[n]=o)}),s}function AP(e,t){if(!e)return;let i={},s=!1;if(Object.keys(e).forEach(l=>{i[l]=e[l],s=!0}),!s)return;let n={type:"gridOptionsChanged",options:i};t.dispatchEvent(n);let o=Se({type:"componentStateChanged"},i);t.dispatchEvent(o)}function bt(e,t){return e.addCommon(t)}function LP(e){return e.get("treeData")?e.get("treeDataParentIdField")?"treeSelfRef":e.get("treeDataChildrenField")?"treeNested":"treePath":"group"}function WR({gos:e},t){return t.button===2||t.ctrlKey&&e.get("allowContextMenuWithControlKey")}var MB={resizable:!0,sortable:!0},TB=0;function OP(){return TB++}function ol(e){return e instanceof wc}var wc=class extends Be{constructor(e,t,i,s){super(),this.colDef=e,this.userProvidedColDef=t,this.colId=i,this.primary=s,this.isColumn=!0,this.instanceId=OP(),this.autoHeaderHeight=null,this.moving=!1,this.resizing=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.colEventSvc=new dc,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.flex=null,this.colIdSanitised=Op(i)}destroy(){super.destroy(),this.beans.rowSpanSvc?.deregister(this)}getInstanceId(){return this.instanceId}setState(){let{colDef:e,beans:{sortSvc:t,pinnedCols:i,colFlex:s}}=this;t?.initCol(this);let n=e.hide;n!==void 0?this.visible=!n:this.visible=!e.initialHide,i?.initCol(this),s?.initCol(this)}setColDef(e,t,i){let s=e.spanRows!==this.colDef.spanRows;this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),s&&(this.beans.rowSpanSvc?.deregister(this),this.initRowSpan()),this.dispatchColEvent("colDefChanged",i)}getUserProvidedColDef(){return this.userProvidedColDef}getParent(){return this.parent}getOriginalParent(){return this.originalParent}postConstruct(){this.setState(),this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.initRowSpan(),this.addPivotListener()}initDotNotation(){let{gos:e,colDef:{field:t,tooltipField:i}}=this,s=e.get("suppressFieldDotNotation");this.fieldContainsDots=st(t)&&t.indexOf(".")>=0&&!s,this.tooltipFieldContainsDots=st(i)&&i.indexOf(".")>=0&&!s}initMinAndMaxWidths(){let e=this.colDef;this.minWidth=e.minWidth??this.beans.environment.getDefaultColumnMinWidth(),this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){this.beans.tooltipSvc?.initCol(this)}initRowSpan(){this.colDef.spanRows&&this.beans.rowSpanSvc?.register(this)}addPivotListener(){let e=this.beans.pivotColDefSvc,t=this.colDef.pivotValueColumn;!e||!t||this.addManagedListeners(t,{colDefChanged:i=>{let s=e.recreateColDef(this.colDef);this.setColDef(s,s,i.source)}})}resetActualWidth(e){let t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t,i=e.width,s=e.initialWidth;return i!=null?t=i:s!=null?t=s:t=200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){return this.beans.showRowGroupCols?.isRowGroupDisplayed(this,e)??!1}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}__addEventListener(e,t){this.colEventSvc.addEventListener(e,t)}__removeEventListener(e,t){this.colEventSvc.removeEventListener(e,t)}addEventListener(e,t){this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,this.colEventSvc);let i=this.frameworkEventListenerService?.wrap(e,t)??t;this.colEventSvc.addEventListener(e,i)}removeEventListener(e,t){let i=this.frameworkEventListenerService?.unwrap(e,t)??t;this.colEventSvc.removeEventListener(e,i)}createColumnFunctionCallbackParams(e){return bt(this.gos,{node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){return this.beans.cellNavigation?.isSuppressNavigable(this,e)??!1}isCellEditable(e){return this.beans.editSvc?.isCellEditable({rowNode:e,column:this})??!1}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){return this.beans.selectionSvc?.isCellCheckboxSelection(this,e)??!1}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?.suppressPaste??null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??MB[e]}isColumnFunc(e,t){if(typeof t=="boolean")return t;if(typeof t=="function"){let i=this.createColumnFunctionCallbackParams(e);return t(i)}return!1}createColumnEvent(e,t){return bt(this.gos,{type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sort}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.sort==="asc"}isSortDescending(){return this.sort==="desc"}isSortNone(){return Di(this.sort)}isSorting(){return st(this.sort)}getSortIndex(){return this.sortIndex}isMenuVisible(){return this.menuVisible}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchColEvent("leftChanged",t))}isFilterActive(){return this.filterActive}isHovered(){return je(261),!!this.beans.colHover?.isHovered(this)}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.dispatchColEvent("firstRightPinnedChanged",t))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.dispatchColEvent("lastLeftPinnedChanged",t))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(e,t){let i=e===!0;this.visible!==i&&(this.visible=i,this.dispatchColEvent("visibleChanged",t)),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getFirstRealParent(){let e=this.getOriginalParent();for(;e&&e.isPadding();)e=e.getOriginalParent();return e}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e||!e.isPadding())return{numberOfParents:0,isSpanningTotal:!1};let t=e.getPaddingLevel()+1,i=!0;for(;e;){if(!e.isPadding()){i=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:i}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){let t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return bt(this.gos,{node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(Di(this.colDef.colSpan))return 1;let t=this.createBaseColDefParams(e),i=this.colDef.colSpan(t);return Math.max(i,1)}getRowSpan(e){if(Di(this.colDef.rowSpan))return 1;let t=this.createBaseColDefParams(e),i=this.colDef.rowSpan(t);return Math.max(i,1)}setActualWidth(e,t,i=!1){e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex!=null&&t!=="flex"&&t!=="gridInitializing"&&(this.flex=null),i||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.dispatchColEvent("widthChanged",e)}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex}isRowGroupActive(){return this.rowGroupActive}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}dispatchColEvent(e,t,i){let s=this.createColumnEvent(e,t);i&&no(s,i),this.colEventSvc.dispatchEvent(s)}dispatchStateUpdatedEvent(e){this.colEventSvc.dispatchEvent({type:"columnStateUpdated",key:e})}};function Ks(e){return e instanceof Gm}var Gm=class extends Be{constructor(e,t,i,s){super(),this.colGroupDef=e,this.groupId=t,this.padding=i,this.level=s,this.isColumn=!1,this.expandable=!1,this.instanceId=OP(),this.expandableListenerRemoveCallback=null,this.expanded=!!e?.openByDefault}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(e=>e.isVisible()):!1}isPadding(){return this.padding}setExpanded(e){this.expanded=e===void 0?!1:e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){let e=[];return this.addLeafColumns(e),e}forEachLeafColumn(e){if(this.children)for(let t of this.children)ol(t)?e(t):Ks(t)&&t.forEachLeafColumn(e)}addLeafColumns(e){this.children&&this.children.forEach(t=>{ol(t)?e.push(t):Ks(t)&&t.addLeafColumns(e)})}getColumnGroupShow(){let e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();let e=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach(t=>t.__addEventListener("visibleChanged",e)),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach(t=>t.__removeEventListener("visibleChanged",e)),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,i=!1,s=this.findChildrenRemovingPadding();for(let o=0,l=s.length;o<l;o++){let d=s[o];if(!d.isVisible())continue;let p=d.getColumnGroupShow();p==="open"?(e=!0,i=!0):p==="closed"?(t=!0,i=!0):(e=!0,t=!0)}let n=e&&t&&i;this.expandable!==n&&(this.expandable=n,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){let e=[],t=i=>{i.forEach(s=>{Ks(s)&&s.isPadding()?t(s.children):e.push(s)})};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},DB={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function UR(e,t,i){let s={},n=e.gos;return Object.assign(s,n.get("defaultColGroupDef")),Object.assign(s,t),n.validateColDef(s,i),s}var FB=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=aC(e);let i=0;for(;;){let s=e??t;if(s?i!==0&&(s+="_"+i):s=i,!this.existingKeys[s]){let n=String(s);return e&&i>0&&je(273,{providedId:e,usedId:n}),this.existingKeys[n]=!0,n}i++}}},jR=Object.freeze([]);function di(e){if(e?.length)return e[e.length-1]}function rl(e,t,i){if(e===t)return!0;if(!e||!t)return e==null&&t==null;let s=e.length;if(s!==t.length)return!1;for(let n=0;n<s;n++)if(e[n]!==t[n]&&!i?.(e[n],t[n]))return!1;return!0}function Mp(e,t){if(e)for(let i of e)t(i)}function sn(e,t){let i=e.indexOf(t);i>=0&&e.splice(i,1)}function $R(e,t,i){for(let s=0;s<t.length;s++)sn(e,t[s]);for(let s=t.length-1;s>=0;s--)e.splice(i,0,t[s])}var wv="ag-Grid-AutoColumn",zP="ag-Grid-SelectionColumn",BP="ag-Grid-RowNumbersColumn";function VP(e){let t=[],i=s=>{for(let n=0;n<s.length;n++){let o=s[n];ol(o)?t.push(o):Ks(o)&&i(o.getChildren())}};return i(e),t}function Kr(e){return e.reduce((t,i)=>t+i.getActualWidth(),0)}function nv(e,t,i){let s={};if(!t)return;Jr(null,t,o=>{s[o.getInstanceId()]=o}),i&&Jr(null,i,o=>{s[o.getInstanceId()]=null});let n=Object.values(s).filter(o=>o!=null);e.context.destroyBeans(n)}function YC(e){return e.getId().startsWith(wv)}function al(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(zP)??!1}function el(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(BP)??!1}function IB(e){return al(e)||el(e)}function rv(e){let t=[];return e instanceof Array?t=e:typeof e=="string"&&(t=e.split(",")),t}function kB(e,t){return rl(e,t,(i,s)=>i.getColId()===s.getColId())}function AB(e){e.map={},e.list.forEach(t=>e.map[t.getId()]=t)}function wu(e){return e==="optionsUpdated"?"gridOptionsChanged":e}function HP(e,t){let i=e===t,s=e.getColDef()===t,n=e.getColId()==t;return i||s||n}var LB=(e,t)=>(i,s)=>{let n={value1:void 0,value2:void 0},o=!1;return e&&(e[i]!==void 0&&(n.value1=e[i],o=!0),st(s)&&e[s]!==void 0&&(n.value2=e[s],o=!0)),!o&&t&&(t[i]!==void 0&&(n.value1=t[i]),st(s)&&t[s]!==void 0&&(n.value2=t[s])),n};function OB(e,t=null,i,s,n){let o=new FB,{existingCols:l,existingGroups:d,existingColKeys:p}=zB(s);o.addExistingKeys(p);let y=NP(e,t,0,i,l,o,d,n),{colGroupSvc:C}=e,S=C?.findMaxDepth(y,0)??0,P=C?C.balanceColumnTree(y,0,S,o):y;return Jr(null,P,(O,V)=>{Ks(O)&&O.setupExpandable(),O.originalParent=V}),{columnTree:P,treeDepth:S}}function zB(e){let t=[],i=[],s=[];return e&&Jr(null,e,n=>{if(Ks(n)){let o=n;i.push(o)}else{let o=n;s.push(o.getId()),t.push(o)}}),{existingCols:t,existingGroups:i,existingColKeys:s}}function NP(e,t,i,s,n,o,l,d){if(!t)return[];let{colGroupSvc:p}=e,y=new Array(t.length);for(let C=0;C<y.length;C++){let S=t[C];p&&WB(S)?y[C]=p.createProvidedColumnGroup(s,S,i,n,o,l,d):y[C]=BB(e,s,S,n,o,d)}return y}function BB(e,t,i,s,n,o){let l=HB(i,s);l&&s?.splice(l.idx,1);let d=l?.column;if(d){let p=gC(e,i,d.getColId());d.setColDef(p,i,o),VB(e,d,p,o)}else{let p=n.getUniqueKey(i.colId,i.field),y=gC(e,i,p);d=new wc(y,i,p,t),e.context.createBean(d)}return e.dataTypeSvc?.addColumnListeners(d),d}function GP(e,t,i,s,n,o,l,d){let{sortSvc:p,pinnedCols:y,colFlex:C}=e;i!==void 0&&t.setVisible(!i,d),p&&(p.updateColSort(t,s,d),n!==void 0&&p.setColSortIndex(t,n)),o!==void 0&&y?.setColPinned(t,o),l!==void 0&&C?.setColFlex(t,l)}function VB(e,t,i,s){GP(e,t,i.hide,i.sort,i.sortIndex,i.pinned,i.flex,s);let n=t.getFlex();if(!(n!=null&&n>0))if(i.width!=null)t.setActualWidth(i.width,s);else{let o=t.getActualWidth();t.setActualWidth(o,s)}}function HB(e,t){if(t)for(let i=0;i<t.length;i++){let s=t[i].getUserProvidedColDef();if(!s)continue;if(e.colId!=null){if(t[i].getId()===e.colId)return{idx:i,column:t[i]};continue}if(e.field!=null){if(s.field===e.field)return{idx:i,column:t[i]};continue}if(s===e)return{idx:i,column:t[i]}}}function gC(e,t,i,s){let{gos:n,dataTypeSvc:o}=e,l={},d=n.get("defaultColDef");no(l,d,!1,!0);let p=NB(e,l,t,i);p&&GB(e,p,l);let y=l.cellDataType;no(l,t,!1,!0),y!==void 0&&(l.cellDataType=y);let C=n.get("autoGroupColumnDef"),S=nr(n);return t.rowGroup&&C&&S&&no(l,{sort:C.sort,initialSort:C.initialSort},!1,!0),o&&(o.postProcess(l),o.validateColDef(l)),n.validateColDef(l,i,s),l}function NB(e,t,i,s){let n=e.dataTypeSvc?.updateColDefAndGetColumnType(t,i,s),o=i.type??n??t.type;return t.type=o,o?rv(o):void 0}function GB(e,t,i){if(!t.length)return;let s=Object.assign({},DB),n=e.gos.get("columnTypes")||{};for(let o of Object.keys(n)){let l=n[o];o in s?je(34,{key:o}):(l.type&&je(35),s[o]=l)}t.forEach(o=>{let l=s[o.trim()];l?no(i,l,!1,!0):je(36,{t:o})})}function WB(e){return e.children!==void 0}function Jr(e,t,i){if(t)for(let s=0;s<t.length;s++){let n=t[s];Ks(n)&&Jr(n,n.getChildren(),i),i(n,e)}}function WP(e,t){let i=[],s=[],n=[];return e.forEach(l=>{let d=l.getColDef().lockPosition;d==="right"?n.push(l):d==="left"||d===!0?i.push(l):s.push(l)}),t.get("enableRtl")?[...n,...s,...i]:[...i,...s,...n]}function UP(e,t){let i=!0;return Jr(null,t,s=>{if(!Ks(s))return;let n=s,o=n.getColGroupDef();if(!(o&&o.marryChildren))return;let d=[];n.getLeafColumns().forEach(P=>{let I=e.indexOf(P);d.push(I)});let p=Math.max.apply(Math,d),y=Math.min.apply(Math,d),C=p-y,S=n.getLeafColumns().length-1;C>S&&(i=!1)}),i}function jP(e,t){if(!e||e.length==0)return;let i=t(e[0]);for(let s=1;s<e.length;s++)if(i!==t(e[s]))return;return i}function $P(e,t,i){if(!t.length)return;let s=t.length===1?t[0]:null,n=jP(t,o=>o.getPinned());e.dispatchEvent({type:"columnPinned",pinned:n??null,columns:t,column:s,source:i})}function UB(e,t,i){if(!t.length)return;let s=t.length===1?t[0]:null,n=jP(t,o=>o.isVisible());e.dispatchEvent({type:"columnVisible",visible:n,columns:t,column:s,source:i})}function jB(e,t,i,s){e.dispatchEvent({type:t,columns:i,column:i&&i.length==1?i[0]:null,source:s})}function Mu(e,t,i,s,n=null){t?.length&&e.dispatchEvent({type:"columnResized",columns:t,column:t.length===1?t[0]:null,flexColumns:n,finished:i,source:s})}function _n(e,t,i){let{colModel:s,rowGroupColsSvc:n,pivotColsSvc:o,autoColSvc:l,selectionColSvc:d,colAnimation:p,visibleCols:y,pivotResultCols:C,environment:S,valueColsSvc:P,eventSvc:I,gos:O}=e,V=s.getColDefCols()??[],G=d?.getColumns();if(!V.length&&!G?.length)return!1;if(t?.state&&!t.state.forEach)return je(32),!1;let X=(fe,_e,Ae,Oe,Ge)=>{if(!fe)return;let it=LB(_e,t.defaultState),Xe=it("flex").value1;if(GP(e,fe,it("hide").value1,it("sort").value1,it("sortIndex").value1,it("pinned").value1,Xe,i),Xe==null){let lt=it("width").value1;if(lt!=null){let St=fe.getColDef().minWidth??S.getDefaultColumnMinWidth();St!=null&&lt>=St&&fe.setActualWidth(lt,i)}}Ge||!fe.isPrimary()||(P?.syncColumnWithState(fe,i,it),n?.syncColumnWithState(fe,i,it,Ae),o?.syncColumnWithState(fe,i,it,Oe))},Q=(fe,_e,Ae)=>{let Oe=qP(e,i),Ge=_e.slice(),it={},Xe={},lt=[],St=[],Gt=[],xt=0,Yt=n?.columns.slice()??[],Ct=o?.columns.slice()??[];fe.forEach(Jt=>{let Bi=Jt.colId;if(Bi.startsWith(wv)){lt.push(Jt),Gt.push(Jt);return}if(al(Bi)){St.push(Jt),Gt.push(Jt);return}let ji=Ae(Bi);ji?(X(ji,Jt,it,Xe,!1),sn(Ge,ji)):(Gt.push(Jt),xt+=1)});let Fi=Jt=>X(Jt,null,it,Xe,!1);Ge.forEach(Fi),n?.sortColumns(qR.bind(n,it,Yt)),o?.sortColumns(qR.bind(o,Xe,Ct)),s.refreshCols(!1);let jt=(Jt,Bi,Qi=[])=>{Bi.forEach(ji=>{let fi=Jt(ji.colId);sn(Qi,fi),X(fi,ji,null,null,!0)}),Qi.forEach(Fi)};return jt(Jt=>l?.getColumn(Jt)??null,lt,l?.getColumns()?.slice()),jt(Jt=>d?.getColumn(Jt)??null,St,d?.getColumns()?.slice()),qB(t,s,O),y.refresh(i),I.dispatchEvent({type:"columnEverythingChanged",source:i}),Oe(),{unmatchedAndAutoStates:Gt,unmatchedCount:xt}};p?.start();let{unmatchedAndAutoStates:ae,unmatchedCount:me}=Q(t.state||[],V,fe=>s.getColDefCol(fe));if(ae.length>0||st(t.defaultState)){let fe=C?.getPivotResultCols()?.list??[];me=Q(ae,fe,_e=>C?.getPivotResultCol(_e)??null).unmatchedCount}return p?.finish(),me===0}function $B(e,t){let{colModel:i,autoColSvc:s,selectionColSvc:n,eventSvc:o,gos:l}=e,d=i.getColDefCols();if(!d?.length)return;let p=i.getColDefColTree(),y=VP(p),C=[],S=1e3,P=1e3,I=Q=>{let ae=ZP(Q);Di(ae.rowGroupIndex)&&ae.rowGroup&&(ae.rowGroupIndex=S++),Di(ae.pivotIndex)&&ae.pivot&&(ae.pivotIndex=P++),C.push(ae)};s?.getColumns()?.forEach(I),n?.getColumns()?.forEach(I),y?.forEach(I),_n(e,{state:C},t);let O=s?.getColumns()??[],X=[...n?.getColumns()??[],...O,...d].map(Q=>({colId:Q.colId}));_n(e,{state:X,applyOrder:!0},t),o.dispatchEvent(bt(l,{type:"columnsReset",source:t}))}function qP(e,t){let{rowGroupColsSvc:i,pivotColsSvc:s,valueColsSvc:n,colModel:o,sortSvc:l,eventSvc:d}=e,p={rowGroupColumns:i?.columns.slice()??[],pivotColumns:s?.columns.slice()??[],valueColumns:n?.columns.slice()??[]},y=av(e),C={};return y.forEach(S=>{C[S.colId]=S}),()=>{let S=(_e,Ae,Oe,Ge)=>{let it=Ae.map(Ge),Xe=Oe.map(Ge);if(rl(it,Xe))return;let St=new Set(Ae);Oe.forEach(xt=>{St.delete(xt)||St.add(xt)});let Gt=[...St];d.dispatchEvent({type:_e,columns:Gt,column:Gt.length===1?Gt[0]:null,source:t})},P=_e=>{let Ae=[];return o.forAllCols(Oe=>{let Ge=C[Oe.getColId()];Ge&&_e(Ge,Oe)&&Ae.push(Oe)}),Ae},I=_e=>_e.getColId();S("columnRowGroupChanged",p.rowGroupColumns,i?.columns??[],I),S("columnPivotChanged",p.pivotColumns,s?.columns??[],I);let V=P((_e,Ae)=>{let Oe=_e.aggFunc!=null,Ge=Oe!=Ae.isValueActive(),it=Oe&&_e.aggFunc!=Ae.getAggFunc();return Ge||it});V.length>0&&jB(d,"columnValueChanged",V,t),Mu(d,P((_e,Ae)=>_e.width!=Ae.getActualWidth()),!0,t),$P(d,P((_e,Ae)=>_e.pinned!=Ae.getPinned()),t),UB(d,P((_e,Ae)=>_e.hide==Ae.isVisible()),t);let me=P((_e,Ae)=>_e.sort!=Ae.getSort()||_e.sortIndex!=Ae.getSortIndex());me.length>0&&l?.dispatchSortChangedEvents(t,me);let fe=av(e);KB(y,fe,t,o,d)}}function av(e){let{colModel:t,rowGroupColsSvc:i,pivotColsSvc:s}=e,n=t.getColDefCols();if(Di(n)||!t.isAlive())return[];let o=i?.columns,l=s?.columns,d=[],p=C=>{let S=C.isRowGroupActive()&&o?o.indexOf(C):null,P=C.isPivotActive()&&l?l.indexOf(C):null,I=C.isValueActive()?C.getAggFunc():null,O=C.getSort()!=null?C.getSort():null,V=C.getSortIndex()!=null?C.getSortIndex():null;d.push({colId:C.getColId(),width:C.getActualWidth(),hide:!C.isVisible(),pinned:C.getPinned(),sort:O,sortIndex:V,aggFunc:I,rowGroup:C.isRowGroupActive(),rowGroupIndex:S,pivot:C.isPivotActive(),pivotIndex:P,flex:C.getFlex()??null})};t.forAllCols(C=>p(C));let y=new Map(t.getCols().map((C,S)=>[C.getColId(),S]));return d.sort((C,S)=>{let P=y.has(C.colId)?y.get(C.colId):-1,I=y.has(S.colId)?y.get(S.colId):-1;return P-I}),d}function ZP(e){let t=(O,V)=>O??V??null,i=e.getColDef(),s=t(i.sort,i.initialSort),n=t(i.sortIndex,i.initialSortIndex),o=t(i.hide,i.initialHide),l=t(i.pinned,i.initialPinned),d=t(i.width,i.initialWidth),p=t(i.flex,i.initialFlex),y=t(i.rowGroupIndex,i.initialRowGroupIndex),C=t(i.rowGroup,i.initialRowGroup);y==null&&(C==null||C==!1)&&(y=null,C=null);let S=t(i.pivotIndex,i.initialPivotIndex),P=t(i.pivot,i.initialPivot);S==null&&(P==null||P==!1)&&(S=null,P=null);let I=t(i.aggFunc,i.initialAggFunc);return{colId:e.getColId(),sort:s,sortIndex:n,hide:o,pinned:l,width:d,flex:p,rowGroup:C,rowGroupIndex:y,pivot:P,pivotIndex:S,aggFunc:I}}function qB(e,t,i){if(!e.applyOrder||!e.state)return;let s=[];e.state.forEach(n=>{n.colId!=null&&s.push(n.colId)}),ZB(t.cols,s,t,i)}function ZB(e,t,i,s){if(e==null)return;let n=[],o={};t.forEach(d=>{if(o[d])return;let p=e.map[d];p&&(n.push(p),o[d]=!0)});let l=0;if(e.list.forEach(d=>{let p=d.getColId();if(o[p]!=null)return;p.startsWith(wv)?n.splice(l++,0,d):n.push(d)}),n=WP(n,s),!UP(n,i.getColTree())){je(39);return}e.list=n}function KB(e,t,i,s,n){let o={};t.forEach(C=>o[C.colId]=C);let l={};e.forEach(C=>{o[C.colId]&&(l[C.colId]=!0)});let d=e.filter(C=>l[C.colId]),p=t.filter(C=>l[C.colId]),y=[];p.forEach((C,S)=>{let P=d&&d[S];if(P&&P.colId!==C.colId){let I=s.getCol(P.colId);I&&y.push(I)}}),y.length&&n.dispatchEvent({type:"columnMoved",columns:y,column:y.length===1?y[0]:null,finished:!0,source:i})}var qR=(e,t,i,s)=>{let n=e[i.getId()],o=e[s.getId()],l=n!=null,d=o!=null;if(l&&d)return n-o;if(l)return-1;if(d)return 1;let p=t.indexOf(i),y=t.indexOf(s),C=p>=0,S=y>=0;return C&&S?p-y:C?-1:1},XB=class extends Be{constructor(){super(...arguments),this.beanName="colModel",this.pivotMode=!1,this.ready=!1,this.changeEventsDispatching=!1}postConstruct(){this.pivotMode=this.gos.get("pivotMode"),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents","rowNumbers","hidePaddedHeaderRows"],e=>this.refreshAll(wu(e.source))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],this.recreateColumnDefs.bind(this)),this.addManagedPropertyListener("pivotMode",e=>this.setPivotMode(this.gos.get("pivotMode"),wu(e.source)))}createColsFromColDefs(e){let{beans:t}=this,{valueCache:i,colAutosize:s,rowGroupColsSvc:n,pivotColsSvc:o,valueColsSvc:l,visibleCols:d,eventSvc:p,groupHierarchyColSvc:y}=t,C=this.colDefs?qP(t,e):void 0;i?.expire();let S=this.colDefCols?.list,P=this.colDefCols?.tree,I=OB(t,this.colDefs,!0,P,e);nv(t,this.colDefCols?.tree,I.columnTree);let O=I.columnTree,V=I.treeDepth,G=VP(O),X={};G.forEach(Q=>X[Q.getId()]=Q),this.colDefCols={tree:O,treeDepth:V,list:G,map:X},this.createColumnsForService([y],this.colDefCols),n?.extractCols(e,S),o?.extractCols(e,S),l?.extractCols(e,S),this.ready=!0,this.refreshCols(!0),d.refresh(e),p.dispatchEvent({type:"columnEverythingChanged",source:e}),C&&(this.changeEventsDispatching=!0,C(),this.changeEventsDispatching=!1),p.dispatchEvent({type:"newColumnsLoaded",source:e}),e==="gridInitializing"&&s?.applyAutosizeStrategy()}refreshCols(e){if(!this.colDefCols)return;let t=this.cols?.tree;this.saveColOrder();let{autoColSvc:i,selectionColSvc:s,rowNumbersSvc:n,quickFilter:o,pivotResultCols:l,showRowGroupCols:d,rowAutoHeight:p,visibleCols:y,colViewport:C,eventSvc:S}=this.beans,P=this.selectCols(l,this.colDefCols);this.createColumnsForService([i,s,n],P);let I=vB(this.gos,this.showingPivotResult);(!e||I)&&this.restoreColOrder(P),this.positionLockedCols(P),d?.refresh(),o?.refreshCols(),this.setColSpanActive(),p?.setAutoHeightActive(P),y.clear(),C.clear(),!rl(t,this.cols.tree)&&S.dispatchEvent({type:"gridColumnsChanged"})}createColumnsForService(e,t){for(let i of e)i&&(i.createColumns(t,s=>{this.lastOrder=s(this.lastOrder),this.lastPivotOrder=s(this.lastPivotOrder)}),i.addColumns(t))}selectCols(e,t){let i=e?.getPivotResultCols()??null;this.showingPivotResult=i!=null;let{map:s,list:n,tree:o,treeDepth:l}=i??t;return this.cols={list:n.slice(),map:Se({},s),tree:o.slice(),treeDepth:l},i&&(i.list.some(p=>this.cols?.map[p.getColId()]!==void 0)||(this.lastPivotOrder=null)),this.cols}getColsToShow(){if(!this.cols)return[];let{valueColsSvc:e,selectionColSvc:t,gos:i}=this.beans,s=this.isPivotMode()&&!this.showingPivotResult,n=t?.isSelectionColumnEnabled(),o=i.get("rowNumbers"),l=e?.columns;return this.cols.list.filter(p=>{let y=YC(p);if(s){let C=l?.includes(p);return y||C||n&&al(p)||o&&el(p)}else return y||p.isVisible()})}refreshAll(e){this.ready&&(this.refreshCols(!1),this.beans.visibleCols.refresh(e))}setColsVisible(e,t=!1,i){_n(this.beans,{state:e.map(s=>({colId:typeof s=="string"?s:s.getColId(),hide:!t}))},i)}restoreColOrder(e){let t=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!t)return;let i=t.filter(S=>e.map[S.getId()]!=null);if(i.length===0)return;if(i.length===e.list.length){e.list=i;return}let s=S=>{let P=S.getOriginalParent();return P?P.getChildren().length>1?!0:s(P):!1};if(!i.some(S=>s(S))){let S=new Set(i);for(let P of e.list)S.has(P)||i.push(P);e.list=i;return}let n=new Map;for(let S=0;S<i.length;S++){let P=i[S];n.set(P,S)}let o=e.list.filter(S=>!n.has(S));if(o.length===0){e.list=i;return}let l=(S,P)=>{let I=P?P.getOriginalParent():S.getOriginalParent();if(!I)return null;let O=null,V=null;for(let G of I.getChildren())if(!(G===P||G===S)){if(G instanceof wc){let X=n.get(G);if(X==null)continue;(O==null||O<X)&&(O=X,V=G);continue}G.forEachLeafColumn(X=>{let Q=n.get(X);Q!=null&&(O==null||O<Q)&&(O=Q,V=X)})}return V??l(S,I)},d=[],p=new Map;for(let S of o){let P=l(S,null);if(P==null){d.push(S);continue}let I=p.get(P);I===void 0?p.set(P,S):Array.isArray(I)?I.push(S):p.set(P,[I,S])}let y=new Array(e.list.length),C=y.length-1;for(let S=d.length-1;S>=0;S--)y[C--]=d[S];for(let S=i.length-1;S>=0;S--){let P=i[S],I=p.get(P);if(I)if(Array.isArray(I))for(let O=I.length-1;O>=0;O--){let V=I[O];y[C--]=V}else y[C--]=I;y[C--]=P}e.list=y}positionLockedCols(e){e.list=WP(e.list,this.gos)}saveColOrder(){this.showingPivotResult?this.lastPivotOrder=this.cols?.list??null:this.lastOrder=this.cols?.list??null}getColumnDefs(){return this.colDefCols?this.beans.colDefFactory?.getColumnDefs(this.colDefCols.list,this.showingPivotResult,this.lastOrder,this.cols?.list??[]):void 0}setColSpanActive(){this.colSpanActive=!!this.cols?.list.some(e=>e.getColDef().colSpan!=null)}isPivotMode(){return this.pivotMode}setPivotMode(e,t){if(e===this.pivotMode||(this.pivotMode=e,!this.ready))return;this.refreshCols(!1);let{visibleCols:i,eventSvc:s}=this.beans;i.refresh(t),s.dispatchEvent({type:"columnPivotModeChanged"})}isPivotActive(){let e=this.beans.pivotColsSvc?.columns;return this.pivotMode&&!!e?.length}recreateColumnDefs(e){if(!this.cols)return;this.beans.autoColSvc?.updateColumns(e);let t=wu(e.source);this.createColsFromColDefs(t)}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){nv(this.beans,this.colDefCols?.tree),super.destroy()}getColTree(){return this.cols?.tree??[]}getColDefColTree(){return this.colDefCols?.tree??[]}getColDefCols(){return this.colDefCols?.list??null}getCols(){return this.cols?.list??[]}forAllCols(e){let{pivotResultCols:t,autoColSvc:i,selectionColSvc:s,groupHierarchyColSvc:n}=this.beans;Mp(this.colDefCols?.list,e),Mp(i?.columns?.list,e),Mp(s?.columns?.list,e),Mp(n?.columns?.list,e),Mp(t?.getPivotResultCols()?.list,e)}getColsForKeys(e){return e?e.map(t=>this.getCol(t)).filter(t=>t!=null):[]}getColDefCol(e){return this.colDefCols?.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return e==null?null:this.getColFromCollection(e,this.cols)}getColById(e){return this.cols?.map[e]??null}getColFromCollection(e,t){if(t==null)return null;let{map:i,list:s}=t;if(typeof e=="string"&&i[e])return i[e];for(let d=0;d<s.length;d++)if(HP(s[d],e))return s[d];let{autoColSvc:n,selectionColSvc:o,groupHierarchyColSvc:l}=this.beans;return n?.getColumn(e)??o?.getColumn(e)??l?.getColumn(e)??null}};var KP=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){let t=this.existingIds[e],i;return typeof t!="number"?i=0:i=t+1,this.existingIds[e]=i,i}};function rg(e,t,i){return i&&e.addDestroyFunc(()=>t.destroyBean(i)),i??e}var ot=null;function ZR(e){return typeof e?.getGui=="function"}var XP=class{constructor(e){this.cssClassStates={},this.getGui=e}toggleCss(e,t){if(!e)return;if(e.indexOf(" ")>=0){let s=(e||"").split(" ");if(s.length>1){s.forEach(n=>this.toggleCss(n,t));return}}this.cssClassStates[e]!==t&&e.length&&(this.getGui()?.classList.toggle(e,t),this.cssClassStates[e]=t)}},YB=0,ag=class extends dr{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=YB++,this.cssManager=new XP(()=>this.eGui),this.componentSelectors=new Map((t??[]).map(i=>[i.selector,i])),e&&this.setTemplate(e)}preConstruct(){this.wireTemplate(this.getGui());let e="component-"+Object.getPrototypeOf(this)?.constructor?.name;this.css?.forEach(t=>this.beans.environment.addGlobalCSS(t,e))}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getDataRefAttribute(e){return e.getAttribute?e.getAttribute(gP):null}applyElementsToComponent(e,t,i,s=null){if(t===void 0&&(t=this.getDataRefAttribute(e)),t){let n=this[t];if(n===ot)this[t]=s??e;else{let o=i&&i[t];if(!this.suppressDataRefValidation&&!o)throw new Error(`data-ref: ${t} on ${this.constructor.name} with ${n}`)}}}createChildComponentsFromTags(e,t){let i=[];for(let s of e.childNodes??[])i.push(s);i.forEach(s=>{if(!(s instanceof HTMLElement))return;let n=this.createComponentFromElement(s,o=>{let l=o.getGui();if(l)for(let d of s.attributes??[])l.setAttribute(d.name,d.value)},t);if(n){if(n.addItems&&s.children.length){this.createChildComponentsFromTags(s,t);let o=Array.prototype.slice.call(s.children);n.addItems(o)}this.swapComponentForNode(n,e,s)}else s.childNodes&&this.createChildComponentsFromTags(s,t)})}createComponentFromElement(e,t,i){let s=e.nodeName,n=this.getDataRefAttribute(e),o=s.indexOf("AG-")===0,l=o?this.componentSelectors.get(s):null,d=null;if(l){let p=i&&n?i[n]:void 0;d=new l.component(p),d.setParentComponent(this),this.createBean(d,null,t)}else if(o)throw new Error(`selector: ${s}`);return this.applyElementsToComponent(e,n,i,d),d}swapComponentForNode(e,t,i){let s=e.getGui();t.replaceChild(s,i),t.insertBefore(document.createComment(i.nodeName),s),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e){let t=this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui()),e.forEach(i=>i.setAttribute("tabindex",t.toString()))}setTemplate(e,t,i){let s;typeof e=="string"||e==null?s=jC(e):s=ng(e),this.setTemplateFromElement(s,t,i)}setTemplateFromElement(e,t,i,s=!1){if(this.eGui=e,this.suppressDataRefValidation=s,t)for(let n=0;n<t.length;n++){let o=t[n];this.componentSelectors.set(o.selector,o)}this.wireTemplate(e,i)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let i=t;return e==null?null:(i||(i=this.eGui),ZC(e)?{element:e,parent:i}:{element:e.getGui(),parent:i})}prependChild(e,t){let{element:i,parent:s}=this.getContainerAndElement(e,t)||{};!i||!s||s.insertAdjacentElement("afterbegin",i)}appendChild(e,t){let{element:i,parent:s}=this.getContainerAndElement(e,t)||{};!i||!s||s.appendChild(i)}isDisplayed(){return this.displayed}setVisible(e,t={}){if(e!==this.visible){this.visible=e;let{skipAriaHidden:i}=t;N4(this.eGui,e,{skipAriaHidden:i})}}setDisplayed(e,t={}){if(e!==this.displayed){this.displayed=e;let{skipAriaHidden:i}=t;Ti(this.eGui,e,{skipAriaHidden:i});let s={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(s)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),super.destroy()}addGuiEventListener(e,t,i){this.eGui.addEventListener(e,t,i),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,t))}addCss(e){this.cssManager.toggleCss(e,!0)}removeCss(e){this.cssManager.toggleCss(e,!1)}toggleCss(e,t){this.cssManager.toggleCss(e,t)}registerCSS(e){this.css||(this.css=[]),this.css.push(e)}},ii=class extends ag{};function YP(e){return typeof e=="object"&&!!e.component}function QB(e,t){return new Ui(i=>{i(window.setInterval(e,t))})}var Ui=class Lp{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(i=>this.onDone(i),i=>this.onReject(i))}static all(t){return t.length?new Lp(i=>{let s=t.length,n=new Array(s);t.forEach((o,l)=>{o.then(d=>{n[l]=d,s--,s===0&&i(n)})})}):Lp.resolve()}static resolve(t=null){return new Lp(i=>i(t))}then(t){return new Lp(i=>{this.status===1?i(t(this.resolution)):this.waiters.push(s=>i(t(s)))})}onDone(t){this.status=1,this.resolution=t,this.waiters.forEach(i=>i(t))}onReject(t){}};function JB(e){return e?e.prototype&&"getGui"in e.prototype:!1}function QP(e,t,i,s){let{name:n}=i,o,l,d,p,y,C;if(t){let S=t,P=S[n+"Selector"],I=P?P(s):null,O=V=>{typeof V=="string"?o=V:V!=null&&V!==!0&&(e.isFrameworkComponent(V)?d=V:l=V)};I?(O(I.component),p=I.params,y=I.popup,C=I.popupPosition):O(S[n])}return{compName:o,jsComp:l,fwComp:d,paramsFromSelector:p,popupFromSelector:y,popupPositionFromSelector:C}}var e5=class extends Be{constructor(){super(...arguments),this.beanName="userCompFactory"}wireBeans(e){this.agCompUtils=e.agCompUtils,this.registry=e.registry,this.frameworkCompWrapper=e.frameworkCompWrapper,this.gridOptions=e.gridOptions}getCompDetailsFromGridOptions(e,t,i,s=!1){return this.getCompDetails(this.gridOptions,e,t,i,s)}getCompDetails(e,t,i,s,n=!1){let{name:o,cellRenderer:l}=t,{compName:d,jsComp:p,fwComp:y,paramsFromSelector:C,popupFromSelector:S,popupPositionFromSelector:P}=QP(this.beans.frameworkOverrides,e,t,s),I,O,V=ae=>{let me=this.registry.getUserComponent(o,ae);me&&(p=me.componentFromFramework?void 0:me.component,y=me.componentFromFramework?me.component:void 0,I=me.params,O=me.processParams)};if(d!=null&&V(d),p==null&&y==null&&i!=null&&V(i),p&&l&&!JB(p)&&(p=this.agCompUtils?.adaptFunction(t,p)),!p&&!y){let{validation:ae}=this.beans;n&&(d!==i||!i)?d?ae?.isProvidedUserComp(d)||li(50,{compName:d}):i?ae||li(260,ht(Se({},this.gos.getModuleErrorParams()),{propName:o,compName:i})):li(216,{name:o}):i&&!ae&&li(146,{comp:i});return}let G=this.mergeParams(e,t,s,C,I,O),X=p==null,Q=p??y;return{componentFromFramework:X,componentClass:Q,params:G,type:t,popupFromSelector:S,popupPositionFromSelector:P,newAgStackInstance:()=>this.newAgStackInstance(Q,X,G,t)}}newAgStackInstance(e,t,i,s){let n=!t,o;n?o=new e:o=this.frameworkCompWrapper.wrap(e,s.mandatoryMethods,s.optionalMethods,s),this.createBean(o);let l=o.init?.(i);return l==null?Ui.resolve(o):l.then(()=>o)}mergeParams(e,t,i,s=null,n,o){let l=Se(Se({},i),n),d=e,p=d&&d[t.name+"Params"];if(typeof p=="function"){let y=p(i);no(l,y)}else typeof p=="object"&&no(l,p);return no(l,s),o?o(l):l}},t5={name:"dateComponent",mandatoryMethods:["getDate","setDate"],optionalMethods:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","refresh"]},i5={name:"dragAndDropImageComponent",mandatoryMethods:["setIcon","setLabel"]},s5={name:"headerComponent",optionalMethods:["refresh"]},o5={name:"innerHeaderComponent"},n5={name:"innerHeaderGroupComponent"},r5={name:"headerGroupComponent"};var a5={name:"cellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0};var l5={name:"loadingCellRenderer",cellRenderer:!0},c5={name:"cellEditor",mandatoryMethods:["getValue"],optionalMethods:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},h5={name:"loadingOverlayComponent",optionalMethods:["refresh"]},u5={name:"noRowsOverlayComponent",optionalMethods:["refresh"]},d5={name:"tooltipComponent"},QC={name:"filter",mandatoryMethods:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethods:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},p5={name:"floatingFilterComponent",mandatoryMethods:["onParentModelChanged"],optionalMethods:["afterGuiAttached","refresh"]},g5={name:"fullWidthCellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},f5={name:"loadingCellRenderer",cellRenderer:!0},m5={name:"groupRowRenderer",optionalMethods:["afterGuiAttached"],cellRenderer:!0},v5={name:"detailCellRenderer",optionalMethods:["refresh"],cellRenderer:!0};function y5(e,t){return e.getCompDetailsFromGridOptions(i5,"agDragAndDropImage",t,!0)}function w5(e,t,i){return e.getCompDetails(t,s5,"agColumnHeader",i)}function C5(e,t,i){return e.getCompDetails(t,o5,void 0,i)}function b5(e,t){let i=t.columnGroup.getColGroupDef();return e.getCompDetails(i,r5,"agColumnGroupHeader",t)}function x5(e,t,i){return e.getCompDetails(t,n5,void 0,i)}function _5(e,t){return e.getCompDetailsFromGridOptions(g5,void 0,t,!0)}function S5(e,t){return e.getCompDetailsFromGridOptions(f5,"agLoadingCellRenderer",t,!0)}function R5(e,t){return e.getCompDetailsFromGridOptions(m5,"agGroupRowRenderer",t,!0)}function E5(e,t){return e.getCompDetailsFromGridOptions(v5,"agDetailCellRenderer",t,!0)}function KR(e,t,i){return e.getCompDetails(t,a5,void 0,i)}function XR(e,t,i){return e.getCompDetails(t,l5,"agSkeletonCellRenderer",i,!0)}function JP(e,t,i){return e.getCompDetails(t,c5,"agCellEditor",i,!0)}function P5(e,t,i,s){let n=t.filter;return YP(n)&&(t={filter:n.component,filterParams:t.filterParams}),e.getCompDetails(t,QC,s,i,!0)}function M5(e,t,i){return e.getCompDetails(t,t5,"agDateInput",i,!0)}function T5(e,t){return e.getCompDetailsFromGridOptions(h5,"agLoadingOverlay",t,!0)}function D5(e,t){return e.getCompDetailsFromGridOptions(u5,"agNoRowsOverlay",t,!0)}function F5(e,t){return e.getCompDetails(t.colDef,d5,"agTooltipComponent",t,!0)}function I5(e,t,i,s){return e.getCompDetails(t,p5,s,i)}function eM(e,t){return QP(e,t,QC)}function Fw(e,t,i){return e.mergeParams(t,QC,i)}function Yp(e){let t=e;return t!=null&&t.getFrameworkComponentInstance!=null?t.getFrameworkComponentInstance():e}function k5(e){return typeof e=="object"&&!!e.getComp}var Fe={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",ESCAPE:"Escape",SPACE:" ",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",DELETE:"Delete",F2:"F2",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",PAGE_HOME:"Home",PAGE_END:"End",A:"KeyA",C:"KeyC",D:"KeyD",V:"KeyV",X:"KeyX",Y:"KeyY",Z:"KeyZ"},JC=class extends ag{isPopup(){return!0}setParentComponent(e){e.addCss("ag-has-popup"),super.setParentComponent(e)}destroy(){let e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},Iw,kw,Aw,Lw,fC,mC,Ow;function ll(){return Iw===void 0&&(Iw=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),Iw}function tM(){return kw===void 0&&(kw=/(firefox)/i.test(navigator.userAgent)),kw}function iM(){return Aw===void 0&&(Aw=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),Aw}function cc(){return Lw===void 0&&(Lw=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),Lw}function vC(e){if(!e)return null;let t=e.tabIndex,i=e.getAttribute("tabIndex");return t===-1&&(i===null||i===""&&!tM())?null:t.toString()}function A5(){if(Ow!==void 0)return Ow;if(!document.body)return-1;let e=1e6,t=tM()?6e6:1e9,i=document.createElement("div");for(document.body.appendChild(i);;){let s=e*2;if(i.style.height=s+"px",s>t||i.clientHeight!==s)break;e=s}return document.body.removeChild(i),Ow=e,e}function L5(){return mC==null&&sM(),mC}function sM(){let e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let i=t.offsetWidth-t.clientWidth;i===0&&t.clientWidth===0&&(i=null),t.parentNode&&t.parentNode.removeChild(t),i!=null&&(mC=i,fC=i===0)}function oM(){return fC==null&&sM(),fC}var eb="T",O5=new RegExp(`[${eb} ]`),z5=new RegExp(`^\\d{4}-\\d{2}-\\d{2}(${eb}\\d{2}:\\d{2}:\\d{2}\\D?)?`);function rr(e,t){return e.toString().padStart(t,"0")}function Vo(e,t=!0,i=eb){if(!e)return null;let s=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(n=>rr(n,2)).join("-");return t&&(s+=i+[e.getHours(),e.getMinutes(),e.getSeconds()].map(n=>rr(n,2)).join(":")),s}function Dm(e,t=!0){return e?t?[String(e.getFullYear()),String(e.getMonth()+1),rr(e.getDate(),2),rr(e.getHours(),2),`:${rr(e.getMinutes(),2)}`,`:${rr(e.getSeconds(),2)}`]:[e.getFullYear(),e.getMonth()+1,rr(e.getDate(),2)].map(String):null}var zw=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"},YR=["January","February","March","April","May","June","July","August","September","October","November","December"],Bw=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function yC(e,t){if(t==null)return Vo(e,!1);let i=rr(e.getFullYear(),4),s={YYYY:()=>i.slice(i.length-4,i.length),YY:()=>i.slice(i.length-2,i.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>YR[e.getMonth()],MMM:()=>YR[e.getMonth()].slice(0,3),MM:()=>rr(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${zw(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${zw(e.getDate())}`,DD:()=>rr(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>Bw[e.getDay()],ddd:()=>Bw[e.getDay()].slice(0,3),dd:()=>Bw[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${zw(e.getDay())}`,d:()=>`${e.getDay()}`},n=new RegExp(Object.keys(s).join("|"),"g");return t.replace(n,o=>o in s?s[o]():o)}function Wm(e,t=!1){return!!Co(e,t)}function B5(e){return Wm(e,!0)}function Co(e,t=!1,i){if(!e||!i&&!z5.test(e))return null;let[s,n]=e.split(O5);if(!s)return null;let o=s.split("-").map(I=>parseInt(I,10));if(o.filter(I=>!isNaN(I)).length!==3)return null;let[l,d,p]=o,y=new Date(l,d-1,p);if(y.getFullYear()!==l||y.getMonth()!==d-1||y.getDate()!==p||!n&&t)return null;if(!n||n==="00:00:00")return y;let[C,S,P]=n.split(":").map(I=>parseInt(I,10));if(C>=0&&C<24)y.setHours(C);else if(t)return null;if(S>=0&&S<60)y.setMinutes(S);else if(t)return null;if(P>=0&&P<60)y.setSeconds(P);else if(t)return null;return y}function wC(e){let{inputValue:t,allSuggestions:i,hideIrrelevant:s,filterByPercentageOfBestMatch:n}=e,o=(i??[]).map((p,y)=>({value:p,relevance:V5(t,p),idx:y}));if(o.sort((p,y)=>p.relevance-y.relevance),s&&(o=o.filter(p=>p.relevance<Math.max(p.value.length,t.length))),o.length>0&&n&&n>0){let y=o[0].relevance*n;o=o.filter(C=>y-C.relevance<0)}let l=[],d=[];for(let p of o)l.push(p.value),d.push(p.idx);return{values:l,indices:d}}function V5(e,t){e.length<t.length&&([e,t]=[t,e]);let i=[],s=[],n=e.length,o=t.length;for(let d=0;d<=o;d++)i[d]=d;let l=0;for(let d=1;d<=n;d++){s[0]=d;for(let p=1;p<=o;p++){let y=e[d-1],C=t[p-1];if(y.toLocaleLowerCase()===C.toLocaleLowerCase())++l,y===C&&++l,d>1&&p>1&&e[d-2].toLocaleLowerCase()===t[p-2].toLocaleLowerCase()&&(++l,e[d-2]===t[p-2]&&++l),d<n/2-10&&++l,s[p]=i[p-1];else{let S=s[p-1],P=i[p],I=i[p-1];s[p]=1+Math.min(S,P,I)}}[i,s]=[s,i]}return i[o]/(l+1)}function nM(e){return e.altKey||e.ctrlKey||e.metaKey?!1:e.key?.length===1}var CC=!1,lv=0;function H5(e){lv>0||(e.addEventListener("keydown",cv),e.addEventListener("mousedown",cv))}function N5(e){lv>0||(e.removeEventListener("keydown",cv),e.removeEventListener("mousedown",cv))}function cv(e){let t=CC,i=e.type==="keydown";i&&(e.ctrlKey||e.metaKey||e.altKey)||t!==i&&(CC=i)}function G5(e){let t=Vs(e);return H5(t),lv++,()=>{lv--,N5(t)}}function W5(){return CC}function Cu(e,t,i=!1){let s=H4,n=aP;t&&(n+=", "+t),i&&(n+=', [tabindex="-1"]');let o=Array.prototype.slice.apply(e.querySelectorAll(s)).filter(p=>ur(p)),l=Array.prototype.slice.apply(e.querySelectorAll(n));return l.length?((p,y)=>p.filter(C=>y.indexOf(C)===-1))(o,l):o}function gc(e,t=!1,i=!1,s=!1){let n=Cu(e,s?".ag-tab-guard":null,i),o=t?di(n):n[0];return o?(o.focus({preventScroll:!0}),!0):!1}function Cc(e,t,i,s){let n=Cu(t,i?':not([tabindex="-1"])':null),o=zi(e),l;i?l=n.findIndex(p=>p.contains(o)):l=n.indexOf(o);let d=l+(s?-1:1);return d<0||d>=n.length?null:n[d]}function rM(e,t=5){let i=0;for(;e&&vC(e)===null&&++i<=t;)e=e.parentElement;return vC(e)===null?null:e}var U5=".ag-label{white-space:nowrap}:where(.ag-ltr) .ag-label{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-label-align-right) .ag-label{order:1}:where(.ag-ltr) :where(.ag-label-align-right) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-rtl) :where(.ag-label-align-right) .ag-label{margin-right:var(--ag-spacing)}.ag-label-align-right>*{flex:none}.ag-label-align-top{align-items:flex-start;flex-direction:column;>*{align-self:stretch}}.ag-label-ellipsis{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-label-align-top) .ag-label{margin-bottom:calc(var(--ag-spacing)*.5)}",j5=class extends ag{constructor(e,t,i){super(t,i),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{},this.registerCSS(U5)}postConstruct(){this.addCss("ag-labeled"),this.eLabel.classList.add("ag-label");let{labelSeparator:e,label:t,labelWidth:i,labelAlignment:s,disabled:n}=this.config;n!=null&&this.setDisabled(n),e!=null&&this.setLabelSeparator(e),t!=null&&this.setLabel(t),i!=null&&this.setLabelWidth(i),this.setLabelAlignment(s||this.labelAlignment),this.refreshLabel()}refreshLabel(){let{label:e,eLabel:t}=this;Ns(t),typeof e=="string"?t.innerText=e+this.labelSeparator:e&&t.appendChild(e),e===""?(Ti(t,!1),tl(t,"presentation")):(Ti(t,!0),tl(t,null))}setLabelSeparator(e){return this.labelSeparator===e?this:(this.labelSeparator=e,this.label!=null&&this.refreshLabel(),this)}getLabelId(){let e=this.eLabel;return e.id=e.id||`ag-${this.getCompId()}-label`,e.id}getLabel(){return this.label}setLabel(e){return this.label===e?this:(this.label=e,this.refreshLabel(),this)}setLabelAlignment(e){let i=this.getGui().classList;return i.toggle("ag-label-align-left",e==="left"),i.toggle("ag-label-align-right",e==="right"),i.toggle("ag-label-align-top",e==="top"),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return this.label==null?this:(ev(this.eLabel,e),this)}setDisabled(e){e=!!e;let t=this.getGui();return $p(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},aM=class extends j5{constructor(e,t,i,s){super(e,t,i),this.className=s}postConstruct(){super.postConstruct();let{width:e,value:t,onValueChange:i}=this.config;e!=null&&this.setWidth(e),t!=null&&this.setValue(t),i!=null&&this.onValueChange(i),this.className&&this.addCss(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){let e=this.getAriaElement(),t=this.getLabelId(),i=this.getLabel();i==null||i==""||S4(e)!==null?jp(e,""):jp(e,t??"")}setAriaLabel(e){return Eu(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return lr(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e?this:(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"}),this)}};function $5(e){return{tag:"div",role:"presentation",children:[{tag:"div",ref:"eLabel",cls:"ag-input-field-label"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-input-wrapper",role:"presentation",children:[{tag:e,ref:"eInput",cls:"ag-input-field-input"}]}]}}var oc=class extends aM{constructor(e,t,i="text",s="input"){super(e,e?.template??$5(s),[],t),this.inputType=i,this.displayFieldTag=s,this.eLabel=ot,this.eWrapper=ot,this.eInput=ot}postConstruct(){super.postConstruct(),this.setInputType(this.inputType);let{eLabel:e,eWrapper:t,eInput:i,className:s}=this;e.classList.add(`${s}-label`),t.classList.add(`${s}-input-wrapper`),i.classList.add(`${s}-input`),this.addCss("ag-input-field"),i.id=i.id||`ag-${this.getCompId()}-input`;let{inputName:n,inputWidth:o}=this.config;n!=null&&this.setInputName(n),o!=null&&this.setInputWidth(o),this.addInputListeners(),this.activateTabIndex([i])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(e){this.displayFieldTag==="input"&&(this.inputType=e,zo(this.eInput,"type",e))}getInputElement(){return this.eInput}setInputWidth(e){return ev(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){let t=this.eInput;return t.maxLength=e,this}setInputPlaceholder(e){return zo(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return Eu(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return $p(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(e===!0)zo(this.eInput,"autocomplete",null);else{let t=typeof e=="string"?e:"off";zo(this.eInput,"autocomplete",t)}return this}},tb=class extends oc{constructor(e,t="ag-checkbox",i="checkbox"){super(e,t,i),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();let{readOnly:e,passive:t}=this.config;typeof e=="boolean"&&this.setReadOnly(e),typeof t=="boolean"&&this.setPassive(t)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;let e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){let t=this.getInputElement();return t.name=e,this}isSelected(){return this.selected}setSelected(e,t){if(this.isSelected()===e)return;this.previousValue=this.isSelected(),e=this.selected=typeof e=="boolean"?e:void 0;let i=this.eInput;i.checked=e,i.indeterminate=e===void 0,t||this.dispatchChange(this.selected,this.previousValue)}dispatchChange(e,t,i){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:i});let s=this.getInputElement();this.eventSvc.dispatchEvent({type:"checkboxChanged",id:s.id,name:s.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;let t=this.isSelected(),i=this.selected=e.target.checked;this.refreshSelectedClass(i),this.dispatchChange(i,t,e)}refreshSelectedClass(e){let t=this.eWrapper.classList;t.toggle("ag-checked",e===!0),t.toggle("ag-indeterminate",e==null)}},ib={selector:"AG-CHECKBOX",component:tb},q5=class extends tb{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){let t=this.eInput;e.selected&&e.name&&t.name&&t.name===e.name&&e.id&&t.id!==e.id&&this.setValue(!1,!0)}};var bc=class extends oc{constructor(e,t="ag-text-field",i="text"){super(e,t,i)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){let i=this.eInput;return i.value!==e&&(i.value=st(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){let e=new RegExp(`[${this.config.allowedCharPattern}]`),t=i=>{nM(i)&&i.key&&!e.test(i.key)&&i.preventDefault()};this.addManagedListeners(this.eInput,{keydown:t,paste:i=>{let s=i.clipboardData?.getData("text");s&&s.split("").some(n=>!e.test(n))&&i.preventDefault()}})}},Cv={selector:"AG-INPUT-TEXT-FIELD",component:bc},Z5=class extends oc{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){let i=super.setValue(e,t);return this.eInput.value=e,i}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}},K5={selector:"AG-INPUT-TEXT-AREA",component:Z5},sb=class extends bc{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct();let e=this.eInput;this.addManagedListeners(e,{blur:()=>{let o=parseFloat(e.value),l=isNaN(o)?"":this.normalizeValue(o.toString());this.value!==l&&this.setValue(l)},wheel:this.onWheel.bind(this)}),e.step="any";let{precision:t,min:i,max:s,step:n}=this.config;typeof t=="number"&&this.setPrecision(t),typeof i=="number"&&this.setMin(i),typeof s=="number"&&this.setMax(s),typeof n=="number"&&this.setStep(n)}onWheel(e){zi(this.beans)===this.eInput&&e.preventDefault()}normalizeValue(e){return e===""?"":(this.precision!=null&&(e=this.adjustPrecision(e)),e)}adjustPrecision(e,t){let i=this.precision;if(i==null)return e;if(t){let n=parseFloat(e).toFixed(i);return parseFloat(n).toString()}let s=String(e).split(".");if(s.length>1){if(s[1].length<=i)return e;if(i>0)return`${s[0]}.${s[1].slice(0,i)}`}return s[0]}setMin(e){return this.min===e?this:(this.min=e,zo(this.eInput,"min",e),this)}setMax(e){return this.max===e?this:(this.max=e,zo(this.eInput,"max",e),this)}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e?this:(this.step=e,zo(this.eInput,"step",e),this)}setValue(e,t){return this.setValueOrInputValue(i=>super.setValue(i,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(t=>super.setValue(t,!0),t=>{this.eInput.value=t},e)}setValueOrInputValue(e,t,i){if(st(i)){let s=this.isScientificNotation(i);if(s&&this.eInput.validity.valid)return e(i);if(!s){i=this.adjustPrecision(i);let n=this.normalizeValue(i);s=i!=n}if(s)return t(i)}return e(i)}getValue(){let e=this.eInput;if(!e.validity.valid)return;let t=e.value;return this.isScientificNotation(t)?this.adjustPrecision(t,!0):super.getValue()}isScientificNotation(e){return typeof e=="string"&&e.includes("e")}},X5={selector:"AG-INPUT-NUMBER-FIELD",component:sb},Y5=class extends bc{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();let e=ll();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){zi(this.beans)===this.eInput&&e.preventDefault()}setMin(e){let t=e instanceof Date?Vo(e??null,!!this.includeTime)??void 0:e;return this.min===t?this:(this.min=t,zo(this.eInput,"min",t),this)}setMax(e){let t=e instanceof Date?Vo(e??null,!!this.includeTime)??void 0:e;return this.max===t?this:(this.max=t,zo(this.eInput,"max",t),this)}setStep(e){return this.step===e?this:(this.step=e,zo(this.eInput,"step",e),this)}setIncludeTime(e){return this.includeTime===e?this:(this.includeTime=e,super.setInputType(e?"datetime-local":"date"),e&&this.setStep(1),this)}getDate(){if(this.eInput.validity.valid)return Co(this.getValue())??void 0}setDate(e,t){this.setValue(Vo(e??null,this.includeTime),t)}},lM={selector:"AG-INPUT-DATE-FIELD",component:Y5},Q5=".ag-list-item{align-items:center;display:flex;height:var(--ag-list-item-height);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;&.ag-active-item{background-color:var(--ag-row-hover-color)}}",J5="ag-active-item",e8=(e,t)=>({tag:"div",cls:`ag-list-item ag-${e}-list-item`,attrs:{role:"option"},children:[{tag:"span",ref:"eText",children:t}]}),t8=class extends ag{constructor(e,t,i){super(e8(e,t)),this.label=t,this.value=i,this.eText=ot}postConstruct(){this.createTooltip(),this.addEventListeners()}setHighlighted(e){let t=this.getGui();t.classList.toggle(J5,e),rP(t,e),this.dispatchLocalEvent({type:"itemHighlighted",highlighted:e})}getHeight(){return this.getGui().clientHeight}setIndex(e,t){let i=this.getGui();D4(i,e),T4(i,t)}createTooltip(){let e={getTooltipValue:()=>this.label,getGui:()=>this.getGui(),getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>$C(this.eText)},t=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("highlightTooltipFeature",!1,e,this));t&&(this.tooltipFeature=t)}addEventListeners(){let e=this.getParentComponent();e&&(this.addGuiEventListener("mouseover",()=>{e.highlightItem(this)}),this.addGuiEventListener("mousedown",t=>{t.preventDefault(),t.stopPropagation(),e.setValue(this.value)}))}},i8=class extends ag{constructor(e="default"){super({tag:"div",cls:`ag-list ag-${e}-list`}),this.cssIdentifier=e,this.options=[],this.listItems=[],this.highlightedItem=null,this.registerCSS(Q5)}postConstruct(){let e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()})}handleKeyDown(e){let t=e.key;switch(t){case Fe.ENTER:if(!this.highlightedItem)this.setValue(this.getValue());else{let i=this.listItems.indexOf(this.highlightedItem);this.setValueByIndex(i)}break;case Fe.DOWN:case Fe.UP:e.preventDefault(),this.navigate(t);break;case Fe.PAGE_DOWN:case Fe.PAGE_UP:case Fe.PAGE_HOME:case Fe.PAGE_END:e.preventDefault(),this.navigateToPage(t);break}}addOptions(e){return e.forEach(t=>this.addOption(t)),this}addOption(e){let{value:t,text:i}=e,s=i??t;return this.options.push({value:t,text:s}),this.renderOption(t,s),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0),this.listItems.forEach(e=>{e.destroy()}),Ns(this.getGui()),this.listItems=[],this.refreshAriaRole()}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(e==null)return this.reset(t),this;let i=this.options.findIndex(s=>s.value===e);if(i!==-1){let s=this.options[i];this.value=s.value,this.displayValue=s.text,this.highlightItem(this.listItems[i]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();let e=this.options.findIndex(t=>t.value===this.value);e!==-1&&this.highlightItem(this.listItems[e])}highlightItem(e){let t=e.getGui();if(!ur(t))return;this.clearHighlighted(),e.setHighlighted(!0),this.highlightedItem=e;let i=this.getGui(),{scrollTop:s,clientHeight:n}=i,{offsetTop:o,offsetHeight:l}=t;(o+l>s+n||o<s)&&t.scrollIntoView({block:"nearest"})}hideItemTooltip(){this.highlightedItem?.tooltipFeature?.attemptToHideTooltip()}destroy(){this.hideItemTooltip(),super.destroy()}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}clearHighlighted(){this.highlightedItem?.setHighlighted(!1),this.highlightedItem=null}renderOption(e,t){let i=new t8(this.cssIdentifier,t,e);i.setParentComponent(this);let s=this.createManagedBean(i);this.listItems.push(s),this.getGui().appendChild(s.getGui())}navigate(e){let t=e===Fe.DOWN,i,{listItems:s,highlightedItem:n}=this;if(!n)i=t?s[0]:di(s);else{let l=s.indexOf(n)+(t?1:-1);l=Math.min(Math.max(l,0),s.length-1),i=s[l]}this.highlightItem(i)}navigateToPage(e){let{listItems:t,highlightedItem:i}=this;if(!i||t.length===0)return;let s=t.indexOf(i),n=this.options.length-1,o=t[0].getHeight(),l=Math.floor(this.getGui().clientHeight/o),d=-1;e===Fe.PAGE_HOME?d=0:e===Fe.PAGE_END?d=n:e===Fe.PAGE_DOWN?d=Math.min(s+l,n):e===Fe.PAGE_UP&&(d=Math.max(s-l,0)),d!==-1&&this.highlightItem(t[d])}refreshAriaRole(){tl(this.getGui(),this.options.length===0?"presentation":"listbox")}updateIndices(){this.refreshAriaRole();let e=this.listItems,t=e.length;e.forEach((i,s)=>{i.setIndex(s+1,t)})}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},s8=".ag-picker-field-display{flex:1 1 auto}.ag-picker-field{align-items:center;display:flex}.ag-picker-field-icon{border:0;cursor:pointer;display:flex;margin:0;padding:0}.ag-picker-field-wrapper{background-color:var(--ag-picker-button-background-color);border:var(--ag-picker-button-border);border-radius:5px;min-height:max(var(--ag-list-item-height),calc(var(--ag-spacing)*4));overflow:hidden;&:where(.ag-picker-has-focus),&:where(:focus-within){background-color:var(--ag-picker-button-focus-background-color);border:var(--ag-picker-button-focus-border);box-shadow:var(--ag-focus-shadow);&:where(.invalid){box-shadow:var(--ag-focus-error-shadow)}}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:disabled{opacity:.5}}",o8={tag:"div",cls:"ag-picker-field",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-picker-field-wrapper ag-picker-collapsed",children:[{tag:"div",ref:"eDisplayField",cls:"ag-picker-field-display"},{tag:"div",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},n8=class extends aM{constructor(e){if(super(e,e?.template||o8,e?.agComponents||[],e?.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=ot,this.eWrapper=ot,this.eDisplayField=ot,this.eIcon=ot,this.registerCSS(s8),this.ariaRole=e?.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;let{pickerGap:t,maxPickerHeight:i,variableWidth:s,minPickerWidth:n,maxPickerWidth:o}=e;t!=null&&(this.pickerGap=t),this.variableWidth=!!s,i!=null&&this.setPickerMaxHeight(i),n!=null&&this.setPickerMinWidth(n),o!=null&&this.setPickerMaxWidth(o)}postConstruct(){super.postConstruct(),this.setupAria();let e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);let t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});let{pickerIcon:i,inputWidth:s}=this.config;if(i){let n=this.beans.iconSvc.createIconNoSpan(i);n&&this.eIcon.appendChild(n)}s!=null&&this.setInputWidth(s)}setupAria(){let e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),lC(e,!1),this.ariaRole&&tl(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){let t=this.getFocusableElement();if(t!==this.eWrapper&&e?.target===t)return;e.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case Fe.UP:case Fe.DOWN:case Fe.ENTER:case Fe.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case Fe.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());let e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){let e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));let t=this.getLocaleTextFunc(),{config:{pickerAriaLabelKey:i,pickerAriaLabelValue:s,modalPicker:n=!0},maxPickerHeight:o,minPickerWidth:l,maxPickerWidth:d,variableWidth:p,beans:y,eWrapper:C}=this,S={modal:n,eChild:e,closeOnEsc:!0,closedCallback:()=>{let V=JE(y);this.beforeHidePicker(),V&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(i,s),anchorToElement:C};e.style.position="absolute";let P=y.popupSvc,I=P.addPopup(S);p?(l&&(e.style.minWidth=l),e.style.width=qC(Ym(C)),d&&(e.style.maxWidth=d)):ev(e,d??Ym(C));let O=o??`${UC(P.getPopupParent())}px`;return e.style.setProperty("max-height",O),this.alignPickerToComponent(),I.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;let{pickerGap:e,config:{pickerType:t},beans:{popupSvc:i,gos:s},eWrapper:n,pickerComponent:o}=this,l=s.get("enableRtl")?"right":"left";i.positionPopupByComponent({type:t,eventSource:n,ePopup:o.getGui(),position:"under",alignSide:l,keepWithinBounds:!0,nudgeY:e})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);let e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;let t=this.getAriaElement();lC(t,e);let i=this.eWrapper.classList;i.toggle("ag-picker-expanded",e),i.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){this.pickerComponent?.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&(this.hideCurrentPicker(),this.dispatchLocalEvent({type:"pickerHidden"}))}setInputWidth(e){return ev(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return typeof e=="number"&&(e=`${e}px`),this.minPickerWidth=e??void 0,this}setPickerMaxWidth(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerWidth=e??void 0,this}setPickerMaxHeight(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerHeight=e??void 0,this}destroy(){this.hidePicker(),super.destroy()}},r8=".ag-select{align-items:center;display:flex;&.ag-disabled{opacity:.5}}:where(.ag-select){.ag-picker-field-wrapper{cursor:default}&.ag-disabled .ag-picker-field-wrapper:focus{box-shadow:none}&:not(.ag-cell-editor,.ag-label-align-top){min-height:var(--ag-list-item-height)}.ag-picker-field-display{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-picker-field-icon{align-items:center;display:flex}}:where(.ag-ltr) :where(.ag-select){.ag-picker-field-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding)/2);padding-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-select){.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:calc(var(--ag-cell-horizontal-padding)/2)}}.ag-select-list{background-color:var(--ag-picker-list-background-color);border:var(--ag-picker-list-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);overflow:hidden auto}.ag-select-list-item{cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none;:where(span){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}}:where(.ag-ltr) .ag-select-list-item{padding-left:calc(var(--ag-cell-horizontal-padding)/2)}:where(.ag-rtl) .ag-select-list-item{padding-right:calc(var(--ag-cell-horizontal-padding)/2)}",ob=class extends n8{constructor(e){super(Se({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"selectOpen",ariaRole:"combobox"},e)),this.registerCSS(r8)}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{shouldDisplayTooltip:Hm(()=>this.eDisplayField),getGui:()=>this.getGui()})),super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");let{options:e,value:t,placeholder:i}=this.config;e!=null&&this.addOptions(e),t!=null&&this.setValue(t,!0),i&&t==null&&(this.eDisplayField.textContent=i),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){let e=this.createBean(new i8("select"));this.listComponent=e,e.setParentComponent(this);let t=e.getAriaElement(),i=`ag-select-list-${e.getCompId()}`;t.setAttribute("id",i),V4(this.getAriaElement(),t),e.addManagedElementListeners(e.getGui(),{mousedown:s=>{s?.preventDefault()}}),e.addManagedListeners(e,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})},fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}beforeHidePicker(){this.listComponent?.hideItemTooltip(),super.beforeHidePicker()}onKeyDown(e){let{key:t}=e;switch(t===Fe.TAB&&this.hidePicker(),t){case Fe.ENTER:case Fe.UP:case Fe.DOWN:case Fe.PAGE_UP:case Fe.PAGE_DOWN:case Fe.PAGE_HOME:case Fe.PAGE_END:e.preventDefault(),this.isPickerDisplayed?this.listComponent?.handleKeyDown(e):super.onKeyDown(e);break;case Fe.ESCAPE:super.onKeyDown(e);break;case Fe.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e);break}}showPicker(){let e=this.listComponent;e&&(super.showPicker(),e.refreshHighlighted())}addOptions(e){return e.forEach(t=>this.addOption(t)),this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){return this.listComponent?.clearOptions(),this.setValue(void 0,!0),this}setValue(e,t,i){let{listComponent:s,config:{placeholder:n},eDisplayField:o,tooltipFeature:l}=this;if(this.value===e||!s)return this;if(i||s.setValue(e,!0),s.getValue()===this.getValue())return this;let p=s.getDisplayValue();return p==null&&n&&(p=n),o.textContent=p,l?.setTooltipAndRefresh(p??null),super.setValue(e,t)}destroy(){this.listComponent=this.destroyBean(this.listComponent),super.destroy()}},a8={selector:"AG-SELECT",component:ob};var l8=':where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart),:where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]){box-sizing:border-box;&:after,&:before{box-sizing:border-box}&:where(div,span,label):focus-visible{box-shadow:inset var(--ag-focus-shadow);outline:none;&:where(.invalid){box-shadow:inset var(--ag-focus-error-shadow)}}&:where(button){color:inherit}}:where(.ag-root-wrapper,ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]) ::-ms-clear{display:none}.ag-hidden{display:none!important}.ag-invisible{visibility:hidden!important}.ag-popup-child{top:0;z-index:5;&:where(:not(.ag-tooltip-custom)){box-shadow:var(--ag-popup-shadow)}}.ag-input-wrapper,.ag-picker-field-wrapper{align-items:center;display:flex;flex:1 1 auto;line-height:normal;position:relative}.ag-input-field{align-items:center;display:flex;flex-direction:row}.ag-input-field-input:where(:not([type=checkbox],[type=radio])){flex:1 1 auto;min-width:0;width:100%}.ag-chart,.ag-dnd-ghost,.ag-external,.ag-popup,.ag-root-wrapper{cursor:default;line-height:normal;white-space:normal;-webkit-font-smoothing:antialiased;background-color:var(--ag-background-color);color:var(--ag-text-color);color-scheme:var(--ag-browser-color-scheme);font-family:var(--ag-font-family);font-size:var(--ag-font-size);--ag-indentation-level:0}:where(.ag-icon):before{align-items:center;background-color:currentcolor;color:inherit;content:"";display:flex;font-family:inherit;font-size:var(--ag-icon-size);font-style:normal;font-variant:normal;height:var(--ag-icon-size);justify-content:center;line-height:var(--ag-icon-size);-webkit-mask-size:contain;mask-size:contain;text-transform:none;width:var(--ag-icon-size)}.ag-icon{background-position:50%;background-repeat:no-repeat;background-size:contain;color:var(--ag-icon-color);display:block;height:var(--ag-icon-size);position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-icon-size)}.ag-disabled,[disabled]{.ag-icon{opacity:.5}&.ag-icon-grip{opacity:.35}}.ag-resizer{pointer-events:none;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none;z-index:1}:where(.ag-resizer){&.ag-resizer-topLeft{cursor:nwse-resize;height:5px;left:0;top:0;width:5px}&.ag-resizer-top{cursor:ns-resize;height:5px;left:5px;right:5px;top:0}&.ag-resizer-topRight{cursor:nesw-resize;height:5px;right:0;top:0;width:5px}&.ag-resizer-right{bottom:5px;cursor:ew-resize;right:0;top:5px;width:5px}&.ag-resizer-bottomRight{bottom:0;cursor:nwse-resize;height:5px;right:0;width:5px}&.ag-resizer-bottom{bottom:0;cursor:ns-resize;height:5px;left:5px;right:5px}&.ag-resizer-bottomLeft{bottom:0;cursor:nesw-resize;height:5px;left:0;width:5px}&.ag-resizer-left{bottom:5px;cursor:ew-resize;left:0;top:5px;width:5px}}',nb=typeof window!="object"||!window?.document?.fonts?.forEach,bC=!1,Tu=(e,t,i,s,n,o)=>{if(nb||bC)return;s&&(e=`@layer ${CSS.escape(s)} { ${e} }`);let l=bu.map.get(t);if(l||(l=[],bu.map.set(t,l)),l.find(C=>C.css===e))return;let d=document.createElement("style");o&&d.setAttribute("nonce",o),d.dataset.agGlobalCss=i,d.textContent=e;let p={css:e,el:d,priority:n},y;for(let C of l){if(C.priority>n)break;y=C}if(y){y.el.insertAdjacentElement("afterend",d);let C=l.indexOf(y);l.splice(C+1,0,p)}else t.insertBefore(d,t.querySelector(":not(title, meta)")),l.push(p)},cM=(e,t,i,s)=>{Tu(l8,e,"shared",t,0,i),s?.forEach((n,o)=>n.forEach(l=>Tu(l,e,o,t,0,i)))},c8=e=>{bu.grids.add(e)},h8=e=>{if(bu.grids.delete(e),bu.grids.size===0){bu.map=new WeakMap;for(let t of document.head.querySelectorAll("style[data-ag-global-css]"))t.remove()}},QR,bu=(QR=typeof window=="object"?window:{}).agStyleInjectionState??(QR.agStyleInjectionState={map:new WeakMap,grids:new Set}),on=e=>new hM(e),Qa="$default",u8=0,hM=class{constructor({feature:e,params:t,modeParams:i={},css:s,cssImports:n}){this.feature=e,this.css=s,this.cssImports=n,this.modeParams=Se({[Qa]:Se(Se({},i[Qa]??{}),t??{})},i)}use(e,t,i){let s=this._inject;if(s==null){let{css:n}=this;if(n){let o=`ag-theme-${this.feature??"part"}-${++u8}`;typeof n=="function"&&(n=n()),n=`:where(.${o}) {
${n}
}
`;for(let l of this.cssImports??[])n=`@import url(${JSON.stringify(l)});
${n}`;s={css:n,class:o}}else s=!1;this._inject=s}return s&&e&&Tu(s.css,e,s.class,t,1,i),s?s.class:!1}},d8=e=>e.replace(/[A-Z]/g,t=>`-${t}`).toLowerCase(),uM=e=>`--ag-${d8(e)}`,hr=e=>`var(${uM(e)})`,p8=(e,t,i)=>Math.max(t,Math.min(i,e)),g8=e=>{let t=new Map;return i=>{let s=i;return t.has(s)||t.set(s,e(i)),t.get(s)}},or=e=>({ref:"accentColor",mix:e}),Qo=e=>({ref:"foregroundColor",mix:e}),en=e=>({ref:"foregroundColor",mix:e,onto:"backgroundColor"}),f8=e=>({ref:"foregroundColor",mix:e,onto:"headerBackgroundColor"}),wo={ref:"backgroundColor"},du={ref:"foregroundColor"},Xr={ref:"accentColor"},Qp={backgroundColor:"#fff",foregroundColor:"#181d1f",borderColor:Qo(.15),chromeBackgroundColor:en(.02),browserColorScheme:"light"},m8=ht(Se({},Qp),{textColor:du,accentColor:"#2196f3",invalidColor:"#e02525",fontFamily:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue","sans-serif"],subtleTextColor:{ref:"textColor",mix:.5},borderWidth:1,borderRadius:4,spacing:8,fontSize:14,focusShadow:{spread:3,color:or(.5)},focusErrorShadow:{spread:3,color:{ref:"invalidColor",onto:"backgroundColor",mix:.5}},popupShadow:"0 0 16px #00000026",cardShadow:"0 1px 4px 1px #00000018",dropdownShadow:{ref:"cardShadow"},listItemHeight:{calc:"max(iconSize, dataFontSize) + widgetVerticalSpacing"},dragAndDropImageBackgroundColor:wo,dragAndDropImageBorder:!0,dragAndDropImageNotAllowedBorder:{color:{ref:"invalidColor",onto:"dragAndDropImageBackgroundColor",mix:.5}},dragAndDropImageShadow:{ref:"popupShadow"},iconSize:16,iconColor:"inherit",toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonOnBackgroundColor:Xr,toggleButtonOffBackgroundColor:en(.3),toggleButtonSwitchBackgroundColor:wo,toggleButtonSwitchInset:2,tooltipBackgroundColor:{ref:"chromeBackgroundColor"},tooltipErrorBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.1},tooltipTextColor:{ref:"textColor"},tooltipErrorTextColor:{ref:"invalidColor"},tooltipBorder:!0,tooltipErrorBorder:{color:{ref:"invalidColor",onto:"backgroundColor",mix:.25}}}),v8=["colorScheme","color","length","scale","borderStyle","border","shadow","image","fontFamily","fontWeight","duration"],y8=g8(e=>(e=e.toLowerCase(),v8.find(t=>e.endsWith(t.toLowerCase()))??"length")),bv=e=>typeof e=="object"&&e?.ref?hr(e.ref):typeof e=="string"?e:typeof e=="number"?String(e):!1,rb=e=>{if(typeof e=="string")return e;if(e&&"ref"in e){let t=hr(e.ref);return e.mix==null?t:`color-mix(in srgb, ${e.onto?hr(e.onto):"transparent"}, ${t} ${p8(e.mix*100,0,100)}%)`}return!1},w8=bv,pu=e=>typeof e=="string"?e:typeof e=="number"?`${e}px`:e&&"calc"in e?`calc(${e.calc.replace(/ ?[*/+] ?/g," $& ").replace(/-?\b[a-z][a-z0-9]*\b(?![-(])/gi,i=>i[0]==="-"?i:` ${hr(i)} `)})`:e&&"ref"in e?hr(e.ref):!1,C8=bv,xC=(e,t)=>typeof e=="string"?e:e===!0?xC({},t):e===!1?t==="columnBorder"?xC({color:"transparent"},t):"none":e&&"ref"in e?hr(e.ref):dM(e.style??"solid")+" "+pu(e.width??{ref:"borderWidth"})+" "+rb(e.color??{ref:"borderColor"}),b8=e=>typeof e=="string"?e:e===!1?"none":e&&"ref"in e?hr(e.ref):[pu(e.offsetX??0),pu(e.offsetY??0),pu(e.radius??0),pu(e.spread??0),rb(e.color??{ref:"foregroundColor"})].join(" "),dM=bv,pM=e=>typeof e=="string"?e.includes(",")?e:JR(e):e&&"googleFont"in e?pM(e.googleFont):e&&"ref"in e?hr(e.ref):Array.isArray(e)?e.map(t=>(typeof t=="object"&&"googleFont"in t&&(t=t.googleFont),JR(t))).join(", "):!1,JR=e=>/^[\w-]+$|\w\(/.test(e)?e:JSON.stringify(e),x8=bv,gM=e=>typeof e=="string"?e:e&&"url"in e?`url(${JSON.stringify(e.url)})`:e&&"svg"in e?gM({url:`data:image/svg+xml,${encodeURIComponent(e.svg)}`}):e&&"ref"in e?hr(e.ref):!1,_8=(e,t,i)=>typeof e=="string"?e:typeof e=="number"?(e>=10&&i.warn(104,{value:e,param:t}),`${e}s`):e&&"ref"in e?hr(e.ref):!1,S8={color:rb,colorScheme:w8,length:pu,scale:C8,border:xC,borderStyle:dM,shadow:b8,image:gM,fontFamily:pM,fontWeight:x8,duration:_8},R8=(e,t,i)=>{let s=y8(e);return S8[s](t,e,i)};var E8=e=>new fM(e),fM=class mM{constructor(t,i=[]){this.themeLogger=t,this.parts=i}withPart(t){return typeof t=="function"&&(t=t()),t instanceof hM?new mM(this.themeLogger,[...this.parts,t]):(this.themeLogger.preInitErr(259,"Invalid part",{part:t}),this)}withoutPart(t){return this.withPart(on({feature:t}))}withParams(t,i=Qa){return this.withPart(on({modeParams:{[i]:t}}))}_startUse({styleContainer:t,cssLayer:i,nonce:s,loadThemeGoogleFonts:n,moduleCss:o}){if(nb||bC)return;M8(),cM(t,i,s,o);let l=P8(this);if(l.length>0)for(let d of l)n&&D8(d,s);for(let d of this.parts)d.use(t,i,s)}_getCssClass(){return bC?"ag-theme-quartz":this._cssClassCache??(this._cssClassCache=eE(this.parts).map(t=>t.use(void 0,void 0,void 0)).filter(Boolean).join(" "))}_getModeParams(){let t=this._paramsCache;if(!t){let i={[Qa]:Se({},m8)};for(let s of eE(this.parts))for(let n of Object.keys(s.modeParams)){let o=s.modeParams[n];if(o){let l=i[n]??(i[n]={}),d=new Set;for(let p of Object.keys(o)){let y=o[p];y!==void 0&&(l[p]=y,d.add(p))}if(n===Qa)for(let p of Object.keys(i)){let y=i[p];if(p!==Qa)for(let C of d)delete y[C]}}}this._paramsCache=t=i}return t}_getPerInstanceCss(t){let i="##SELECTOR##",s=this._paramsCssCache;if(!s){let n="",o="",l=this._getModeParams();for(let p of Object.keys(l)){let y=l[p];if(p!==Qa){let S=`:where([data-ag-theme-mode="${typeof CSS=="object"?CSS.escape(p):p}"]) & {
`;n+=S,o+=S}for(let C of Object.keys(y).sort()){let S=y[C],P=R8(C,S,this.themeLogger);if(P===!1)this.themeLogger.error(107,{key:C,value:S});else{let I=uM(C),O=I.replace("--ag-","--ag-inherited-");n+=`	${I}: var(${O}, ${P});
`,o+=`	${O}: var(${I});
`}}p!==Qa&&(n+=`}
`,o+=`}
`)}let d=`${i} {
${n}}
`;d+=`:has(> ${i}):not(${i}) {
${o}}
`,this._paramsCssCache=s=d}return s.replaceAll(i,`:where(.${t})`)}},eE=e=>{let t=new Map;for(let s of e)t.set(s.feature,s);let i=[];for(let s of e)(!s.feature||t.get(s.feature)===s)&&i.push(s);return i},P8=e=>{let t=new Set,i=o=>{if(Array.isArray(o))o.forEach(i);else{let l=o?.googleFont;typeof l=="string"&&t.add(l)}};return Object.values(e._getModeParams()).flatMap(o=>Object.values(o)).forEach(i),Array.from(t).sort()},tE=!1,M8=()=>{if(!tE){tE=!0;for(let e of Array.from(document.head.querySelectorAll('style[data-ag-scope="legacy"]')))e.remove()}},T8=new Set,D8=async(e,t)=>{T8.add(e);let i=`@import url('https://${F8}/css2?family=${encodeURIComponent(e)}:wght@100;200;300;400;500;600;700;800;900&display=swap');
`;Tu(i,document.head,`googleFont:${e}`,void 0,0,t)},F8="fonts.googleapis.com",I8=1,k8=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,this.instanceId=I8++,!(!e||!e.beanClasses)&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){this.id=e.id,this.beans.context=this,this.destroyCallback=e.destroyCallback;for(let t of Object.keys(e.providedBeanInstances))this.beans[t]=e.providedBeanInstances[t];e.beanClasses.forEach(t=>{let i=new t;i.beanName?this.beans[i.beanName]=i:console.error(`Bean ${t.name} is missing beanName`),this.createdBeans.push(i)}),e.derivedBeans?.forEach(t=>{let{beanName:i,bean:s}=t(this);this.beans[i]=s,this.createdBeans.push(s)}),e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){return this.initBeans([e],t),e}initBeans(e,t){let i=this.beans;e.forEach(s=>{s.preWireBeans?.(i),s.wireBeans?.(i)}),e.forEach(s=>s.preConstruct?.()),t&&e.forEach(t),e.forEach(s=>s.postConstruct?.())}getBeans(){return this.beans}getBean(e){return this.beans[e]}getId(){return this.id}destroy(){if(this.destroyed)return;this.destroyed=!0;let e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[],this.destroyCallback?.()}destroyBean(e){e?.destroy?.()}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},A8=0,L8=class extends dr{constructor(){super(...arguments),this.beanName="environment",this.paramsClass=`ag-theme-params-${++A8}`,this.globalCSS=[]}wireBeans(e){this.eRootDiv=e.eRootDiv}postConstruct(){let{gos:e,eRootDiv:t}=this;e.setInstanceDomData(t),this.eStyleContainer=e.get("themeStyleContainer")??(t.getRootNode()===document?document.head:t),this.cssLayer=e.get("themeCssLayer"),this.styleNonce=e.get("styleNonce"),this.addManagedPropertyListener("theme",()=>this.handleThemeChange()),this.handleThemeChange(),this.initVariables(),this.addDestroyFunc(()=>h8(this)),this.mutationObserver=new MutationObserver(()=>{this.fireStylesChangedEvent("themeChanged")}),this.addDestroyFunc(()=>this.mutationObserver.disconnect())}applyThemeClasses(e,t=[]){let{theme:i}=this,s;i?s=`${this.paramsClass} ${i._getCssClass()}`:s=this.applyLegacyThemeClasses();for(let n of Array.from(e.classList))n.startsWith("ag-theme-")&&e.classList.remove(n);if(s){let n=e.className;e.className=`${n}${n?" ":""}${s}${t?.length?` ${t.join(" ")}`:""}`}}applyLegacyThemeClasses(){let e="";this.mutationObserver.disconnect();let t=this.eRootDiv;for(;t;){let i=!1;for(let s of Array.from(t.classList))s.startsWith("ag-theme-")&&(i=!0,e=e?`${e} ${s}`:s);i&&this.mutationObserver.observe(t,{attributes:!0,attributeFilter:["class"]}),t=t.parentElement}return e}addGlobalCSS(e,t){this.theme?Tu(e,this.eStyleContainer,t,this.cssLayer,0,this.styleNonce):this.globalCSS.push([e,t])}handleThemeChange(){let{gos:e,theme:t}=this,i=e.get("theme"),s;if(i==="legacy")s=void 0;else{let n=i??this.getDefaultTheme();n instanceof fM?s=n:this.themeError(n)}s!==t&&this.handleNewTheme(s),this.postProcessThemeChange(s,i)}handleNewTheme(e){let{gos:t,eRootDiv:i,globalCSS:s}=this,n=this.getAdditionalCss();if(e){c8(this),cM(this.eStyleContainer,this.cssLayer,this.styleNonce,n);for(let[l,d]of s)Tu(l,this.eStyleContainer,d,this.cssLayer,0,this.styleNonce);s.length=0}this.theme=e,e?._startUse({loadThemeGoogleFonts:t.get("loadThemeGoogleFonts"),styleContainer:this.eStyleContainer,cssLayer:this.cssLayer,nonce:this.styleNonce,moduleCss:n});let o=this.eParamsStyle;if(!o){o=this.eParamsStyle=ng({tag:"style"});let l=t.get("styleNonce");l&&o.setAttribute("nonce",l),i.appendChild(o)}nb||(o.textContent=e?._getPerInstanceCss(this.paramsClass)||""),this.applyThemeClasses(i),this.fireStylesChangedEvent("themeChanged")}},O8=class extends dr{constructor(){super(...arguments),this.beanName="registry"}registerDynamicBeans(e){if(e){this.dynamicBeans??(this.dynamicBeans={});for(let t of Object.keys(e))this.dynamicBeans[t]=e[t]}}createDynamicBean(e,t,...i){if(!this.dynamicBeans)throw new Error(this.getDynamicError(e,!0));let s=this.dynamicBeans[e];if(s==null){if(t)throw new Error(this.getDynamicError(e,!1));return}return new s(...i)}},z8=class extends dr{constructor(){super(...arguments),this.beanName="eventSvc",this.eventServiceType="global",this.globalSvc=new dc}addListener(e,t,i){this.globalSvc.addEventListener(e,t,i)}removeListener(e,t,i){this.globalSvc.removeEventListener(e,t,i)}addGlobalListener(e,t=!1){this.globalSvc.addGlobalListener(e,t)}removeGlobalListener(e,t=!1){this.globalSvc.removeGlobalListener(e,t)}dispatchEvent(e){this.globalSvc.dispatchEvent(this.gos.addCommon(e))}dispatchEventOnce(e){this.globalSvc.dispatchEventOnce(this.gos.addCommon(e))}},vM=class extends dr{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}postConstruct(){this.refreshTooltip()}setBrowserTooltip(e,t){let i="title",s=this.ctrl.getGui();s&&(e!=null&&(e!=""||t)?s.setAttribute(i,e):s.removeAttribute(i))}updateTooltipText(){let{getTooltipValue:e}=this.ctrl;e&&(this.tooltip=e())}createTooltipFeatureIfNeeded(){if(this.tooltipManager==null){let e=this.beans.registry.createDynamicBean("tooltipStateManager",!0,this.ctrl,()=>this.tooltip);e&&(this.tooltipManager=this.createBean(e,this.beans.context))}}attemptToShowTooltip(){this.tooltipManager?.prepareToShowTooltip()}attemptToHideTooltip(){this.tooltipManager?.hideTooltip()}setTooltipAndRefresh(e){this.tooltip=e,this.refreshTooltip()}refreshTooltip(e){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)):(this.setBrowserTooltip(e?"":null,e),this.createTooltipFeatureIfNeeded())}destroy(){this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context),super.destroy()}},B8=1e3,V8=1e3,iE=100,sE,Fm=!1,H8=class extends dr{constructor(e,t){super(),this.tooltipCtrl=e,this.getTooltipValue=t,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(e){this.popupSvc=e.popupSvc}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");let e=this.tooltipCtrl.getGui();this.tooltipTrigger===0&&this.addManagedListeners(e,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.tooltipTrigger===1&&this.addManagedListeners(e,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(e,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(e,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(e){let t=this.gos.get(e);return Math.max(200,t)}getTooltipDelay(e){return e==="show"?this.tooltipCtrl.getTooltipShowDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipShowDelay"):this.tooltipCtrl.getTooltipHideDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){let e=this.gos.get("tooltipTrigger");return!e||e==="hover"?0:1}onMouseEnter(e){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!cc()&&(Fm?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(e)},iE):this.prepareToShowTooltip(e))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){let t=e.relatedTarget,i=this.tooltipCtrl.getGui(),s=this.tooltipComp?.getGui();this.isInteractingWithTooltip||i.contains(t)||this.interactionEnabled&&s?.contains(t)||this.setToDoNothing()}onKeyDown(){this.isInteractingWithTooltip&&(this.isInteractingWithTooltip=!1),this.setToDoNothing()}prepareToShowTooltip(e){if(this.state!=0||Fm)return;let t=0;e&&(t=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=e||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),t),this.state=1}isLastTooltipHiddenRecently(){return Date.now()-sE<B8}setToDoNothing(e){!e&&this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.clearEventHandlers(),this.onDocumentKeyDownCallback&&(this.onDocumentKeyDownCallback(),this.onDocumentKeyDownCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){let e=this.getTooltipValue(),t=this.tooltipCtrl;if(!st(e)||t.shouldDisplayTooltip&&!t.shouldDisplayTooltip()){this.setToDoNothing();return}let i=this.gos.addCommon(Se({location:t.getLocation?.()??"UNKNOWN",value:e,hideTooltipCallback:()=>this.hideTooltip(!0)},t.getAdditionalParams?.()));this.state=2,this.tooltipInstanceCount++;let s=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.createTooltipComp(i,s)}hideTooltip(e){!e&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),sE=Date.now()),this.eventSvc.dispatchEvent({type:"tooltipHide",parentGui:this.tooltipCtrl.getGui()}),e&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(e,t){if(this.state!==2||this.tooltipInstanceCount!==e){this.destroyBean(t);return}let s=t.getGui();this.tooltipComp=t,s.classList.contains("ag-tooltip")||s.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&s.classList.add("ag-tooltip-animate"),this.interactionEnabled&&s.classList.add("ag-tooltip-interactive");let n=this.getLocaleTextFunc(),o=this.popupSvc?.addPopup({eChild:s,ariaLabel:n("ariaLabelTooltip","Tooltip")});if(o&&(this.tooltipPopupDestroyFunc=o.hideFunc),this.positionTooltip(),this.tooltipTrigger===1){let l=()=>this.setToDoNothing();[this.onBodyScrollEventCallback]=this.addManagedEventListeners({bodyScroll:l}),this.setEventHandlers(l)}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(s,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),[this.onDocumentKeyDownCallback]=this.addManagedElementListeners(Vs(this.beans),{keydown:l=>{s.contains(l?.target)||this.onKeyDown()}}),this.tooltipTrigger===1&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(s,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventSvc.dispatchEvent({type:"tooltipShow",tooltipGui:s,parentGui:this.tooltipCtrl.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){let e=this.tooltipComp?.getGui(),t=zi(this.beans);return!!e&&e.contains(t)}onTooltipFocusOut(e){let t=this.tooltipCtrl.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,t.contains(e.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){let e={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupSvc?.positionPopupUnderMouseEvent(ht(Se({},e),{mouseEvent:this.lastMouseEvent})):this.popupSvc?.positionPopupByComponent(ht(Se({},e),{eventSource:this.tooltipCtrl.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5}))}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");let e=this.tooltipPopupDestroyFunc,t=this.tooltipComp,i=this.tooltipTrigger===0?V8:0;window.setTimeout(()=>{e(),this.destroyBean(t)},i),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener].forEach(e=>{e&&e()}),this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){Fm=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},iE)}unlockService(){Fm=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}},N8=class extends vM{constructor(e,t,i){super(e,i),this.highlightTracker=t,this.onHighlight=this.onHighlight.bind(this)}postConstruct(){super.postConstruct(),this.wireHighlightListeners()}wireHighlightListeners(){this.addManagedPropertyListener("tooltipTrigger",({currentValue:e})=>{this.setTooltipMode(e)}),this.setTooltipMode(this.gos.get("tooltipTrigger")),this.highlightTracker.addEventListener("itemHighlighted",this.onHighlight)}onHighlight(e){this.tooltipMode===1&&(e.highlighted?this.attemptToShowTooltip():this.attemptToHideTooltip())}setTooltipMode(e="focus"){this.tooltipMode=e==="focus"?1:0}destroy(){this.highlightTracker.removeEventListener("itemHighlighted",this.onHighlight),super.destroy()}},Im=0,G8=200,W8=class extends dr{constructor(){super(...arguments),this.beanName="popupSvc",this.popupList=[]}getPopupParent(){let e=this.gos.get("popupParent");return e||this.getDefaultPopupParent()}positionPopupUnderMouseEvent(e){let{ePopup:t,nudgeX:i,nudgeY:s,skipObserver:n}=e;this.positionPopup({ePopup:t,nudgeX:i,nudgeY:s,keepWithinBounds:!0,skipObserver:n,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e,e.type,e.ePopup,null,e.mouseEvent)})}calculatePointerAlign(e){let t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){let{ePopup:t,nudgeX:i,nudgeY:s,keepWithinBounds:n,eventSource:o,alignSide:l="left",position:d="over",type:p}=e,y=o.getBoundingClientRect(),C=this.getParentRect();this.setAlignedTo(o,t);let S=()=>{let P=y.left-C.left;l==="right"&&(P-=t.offsetWidth-y.width);let I;return d==="over"?(I=y.top-C.top,this.setAlignedStyles(t,"over")):(this.setAlignedStyles(t,"under"),this.shouldRenderUnderOrAbove(t,y,C,e.nudgeY||0)==="under"?I=y.top-C.top+y.height:I=y.top-t.offsetHeight-(s||0)*2-C.top),{x:P,y:I}};this.positionPopup({ePopup:t,nudgeX:i,nudgeY:s,keepWithinBounds:n,updatePosition:S,postProcessCallback:()=>this.callPostProcessPopup(e,p,t,o,null)})}shouldRenderUnderOrAbove(e,t,i,s){let n=i.bottom-t.bottom,o=t.top-i.top,l=e.offsetHeight+s;return n>l?"under":o>l||o>n?"above":"under"}setAlignedStyles(e,t){let i=this.getPopupIndex(e);if(i===-1)return;let s=this.popupList[i],{alignedToElement:n}=s;!n||(["right","left","over","above","under"].forEach(l=>{n.classList.remove(`ag-has-popup-positioned-${l}`),e.classList.remove(`ag-popup-positioned-${l}`)}),!t)||(n.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}setAlignedTo(e,t){let i=this.getPopupIndex(t);if(i!==-1){let s=this.popupList[i];s.alignedToElement=e}}positionPopup(e){let{ePopup:t,keepWithinBounds:i,nudgeX:s,nudgeY:n,skipObserver:o,updatePosition:l}=e,d={width:0,height:0},p=(y=!1)=>{let{x:C,y:S}=l();y&&t.clientWidth===d.width&&t.clientHeight===d.height||(d.width=t.clientWidth,d.height=t.clientHeight,s&&(C+=s),n&&(S+=n),i&&(C=this.keepXYWithinBounds(t,C,1),S=this.keepXYWithinBounds(t,S,0)),t.style.left=`${C}px`,t.style.top=`${S}px`,e.postProcessCallback&&e.postProcessCallback())};if(p(),!o){let y=nl(this.beans,t,()=>p(!0));setTimeout(()=>y(),G8)}}getParentRect(){let e=Vs(this.beans),t=this.getPopupParent();return t===e.body?t=e.documentElement:getComputedStyle(t).position==="static"&&(t=t.offsetParent),cP(t)}keepXYWithinBounds(e,t,i){let s=i===0,n=s?"clientHeight":"clientWidth",o=s?"top":"left",l=s?"height":"width",d=s?"scrollTop":"scrollLeft",p=Vs(this.beans),y=p.documentElement,C=this.getPopupParent(),S=e.getBoundingClientRect(),P=C.getBoundingClientRect(),I=p.documentElement.getBoundingClientRect(),O=C===p.body,V=Math.ceil(S[l]),X=O?(s?lP:Ym)(y)+y[d]:C[n];O&&(X-=Math.abs(I[o]-P[o]));let Q=X-V;return Math.min(Math.max(t,0),Math.abs(Q))}addPopup(e){let{eChild:t,ariaLabel:i,ariaOwns:s,alwaysOnTop:n,positionCallback:o,anchorToElement:l}=e,d=this.getPopupIndex(t);if(d!==-1)return{hideFunc:this.popupList[d].hideFunc};this.initialisePopupPosition(t);let p=this.createPopupWrapper(t,!!n,i,s),y=this.addEventListenersToPopup(ht(Se({},e),{wrapperEl:p}));return o&&o(),this.addPopupToPopupList(t,p,y,l),{hideFunc:y}}initialisePopupPosition(e){let i=this.getPopupParent().getBoundingClientRect();st(e.style.top)||(e.style.top=`${i.top*-1}px`),st(e.style.left)||(e.style.left=`${i.left*-1}px`)}createPopupWrapper(e,t,i,s){let n=this.getPopupParent(),{environment:o,gos:l}=this.beans,d=ng({tag:"div"});return o.applyThemeClasses(d),d.classList.add("ag-popup"),e.classList.add(l.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||tl(e,"dialog"),i?Eu(e,i):s&&(e.id||(e.id=`popup-component-${Im}`),LR(s,e.id)),d.appendChild(e),n.appendChild(d),t?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),d}addEventListenersToPopup(e){let t=this.beans,i=Vs(t),s=this.getPopupParent(),{wrapperEl:n,eChild:o,closedCallback:l,afterGuiAttached:d,closeOnEsc:p,modal:y,ariaOwns:C}=e,S=!1,P=G=>{if(!n.contains(zi(t)))return;G.key===Fe.ESCAPE&&!this.isStopPropagation(G)&&V({keyboardEvent:G})},I=G=>V({mouseEvent:G}),O=G=>V({touchEvent:G}),V=(G={})=>{let{mouseEvent:X,touchEvent:Q,keyboardEvent:ae,forceHide:me}=G;!me&&(this.isEventFromCurrentPopup({mouseEvent:X,touchEvent:Q},o)||S)||(S=!0,s.removeChild(n),i.removeEventListener("keydown",P),i.removeEventListener("mousedown",I),i.removeEventListener("touchstart",O),i.removeEventListener("contextmenu",I),this.eventSvc.removeListener("dragStarted",I),l&&l(X||Q||ae),this.removePopupFromPopupList(o,C))};return d&&d({hidePopup:V}),window.setTimeout(()=>{p&&i.addEventListener("keydown",P),y&&(i.addEventListener("mousedown",I),this.eventSvc.addListener("dragStarted",I),i.addEventListener("touchstart",O),i.addEventListener("contextmenu",I))},0),V}addPopupToPopupList(e,t,i,s){this.popupList.push({element:e,wrapper:t,hideFunc:i,instanceId:Im,isAnchored:!!s}),s&&this.setPopupPositionRelatedToElement(e,s),Im=Im+1}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){let i=this.getPopupIndex(e);if(i===-1)return;let s=this.popupList[i];if(s.stopAnchoringPromise&&s.stopAnchoringPromise.then(o=>o&&o()),s.stopAnchoringPromise=void 0,s.isAnchored=!1,!t)return;let n=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:s.hideFunc});return s.stopAnchoringPromise=n,s.isAnchored=!0,n}removePopupFromPopupList(e,t){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),t&&LR(t,null),this.popupList=this.popupList.filter(i=>i.element!==e)}keepPopupPositionedRelativeTo(e){let t=this.getPopupParent(),i=t.getBoundingClientRect(),{element:s,ePopup:n}=e,o=s.getBoundingClientRect(),l=S=>parseInt(S.substring(0,S.length-1),10),d=(S,P)=>{let I=i[S]-o[S],O=l(n.style[S]);return{initialDiff:I,lastDiff:I,initial:O,last:O,direction:P}},p=d("top",0),y=d("left",1),C=this.beans.frameworkOverrides;return new Ui(S=>{C.wrapIncoming(()=>{QB(()=>{let P=t.getBoundingClientRect(),I=s.getBoundingClientRect();if(I.top==0&&I.left==0&&I.height==0&&I.width==0){e.hidePopup();return}let V=(G,X)=>{let Q=l(n.style[X]);G.last!==Q&&(G.initial=Q,G.last=Q);let ae=P[X]-I[X];if(ae!=G.lastDiff){let me=this.keepXYWithinBounds(n,G.initial+G.initialDiff-ae,G.direction);n.style[X]=`${me}px`,G.last=me}G.lastDiff=ae};V(p,"top"),V(y,"left")},200).then(P=>{S(()=>{P!=null&&window.clearInterval(P)})})},"popupPositioning")})}isEventFromCurrentPopup(e,t){let{mouseEvent:i,touchEvent:s}=e,n=i||s;if(!n)return!1;let o=this.getPopupIndex(t);if(o===-1)return!1;for(let l=o;l<this.popupList.length;l++){let d=this.popupList[l];if(j4(d.element,n))return!0}return this.isElementWithinCustomPopup(n.target)}isElementWithinCustomPopup(e){let t=Vs(this.beans);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||e.parentElement===null)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){let i=this.getWrapper(e);i&&(i.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(i))}bringPopupToFront(e){let t=this.getPopupParent(),i=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),s=i.length,n=this.getWrapper(e);if(!n||s<=1||!t.contains(e))return;let o=[],l=[];for(let P of i)P!==n&&(P.classList.contains("ag-always-on-top")?l.push(P):o.push(P));let d=[],p=l.length,S=n.classList.contains("ag-always-on-top")||!p?[...o,...l,n]:[...o,n,...l];for(let P=0;P<=s;P++){let I=S[P];if(i[P]===S[P]||I===n)continue;I.querySelectorAll("div").forEach(V=>{V.scrollTop!==0&&d.push([V,V.scrollTop])}),P===0?t.insertAdjacentElement("afterbegin",I):S[P-1].insertAdjacentElement("afterend",I)}for(;d.length;){let P=d.pop();P[0].scrollTop=P[1]}}},U8=class extends JC{constructor(){super({tag:"div",cls:"ag-tooltip"})}init(e){let{value:t}=e,i=this.getGui();i.textContent=Iu(t);let s=e.location.replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase();i.classList.add(`ag-${s}-tooltip`)}},j8=class extends dr{constructor(){super(...arguments),this.beanName="dragSvc",this.dragEndFunctions=[],this.dragSources=[]}destroy(){let{dragSources:e}=this;e.forEach(this.removeListener.bind(this)),e.length=0,super.destroy()}removeListener(e){let t=e.dragSource.eElement,i=e.mouseDownListener;if(t.removeEventListener("mousedown",i),e.touchEnabled){let s=e.touchStartListener;t.removeEventListener("touchstart",s,{passive:!0})}}removeDragSource(e){let{dragSources:t}=this,i=t.find(s=>s.dragSource===e);i&&(this.removeListener(i),sn(t,i))}addDragSource(e){let t=this.onMouseDown.bind(this,e),{eElement:i,includeTouch:s,stopPropagationForTouch:n}=e;i.addEventListener("mousedown",t);let o=null,l=this.gos.get("suppressTouch");s&&!l&&(o=d=>{WC(d.target)||(n&&d.stopPropagation(),this.onTouchStart(e,d))},i.addEventListener("touchstart",o,{passive:!1})),this.dragSources.push({dragSource:e,mouseDownListener:t,touchStartListener:o,touchEnabled:!!s})}onTouchStart(e,t){this.currentDragParams=e,this.dragging=!1;let i=t.touches[0];this.touchLastTime=i,this.touchStart=i;let s=p=>this.onTouchMove(p,e.eElement),n=p=>this.onTouchUp(p,e.eElement),o=p=>{p.cancelable&&p.preventDefault()},l=t.target,d=[{target:Up(this.beans),type:"touchmove",listener:o,options:{passive:!1}},{target:l,type:"touchmove",listener:s,options:{passive:!0}},{target:l,type:"touchend",listener:n,options:{passive:!0}},{target:l,type:"touchcancel",listener:n,options:{passive:!0}}];this.addTemporaryEvents(d),e.dragStartPixels===0&&this.onCommonMove(i,this.touchStart,e.eElement)}onMouseDown(e,t){let i=t;if(e.skipMouseEvent&&e.skipMouseEvent(t)||i._alreadyProcessedByDragService||(i._alreadyProcessedByDragService=!0,t.button!==0))return;this.shouldPreventMouseEvent(t)&&t.preventDefault(),this.currentDragParams=e,this.dragging=!1,this.mouseStartEvent=t,this.startTarget=t.target;let s=y=>this.onMouseMove(y,e.eElement),n=y=>this.onMouseUp(y,e.eElement),o=y=>y.preventDefault(),l=y=>{y.key===Fe.ESCAPE&&this.cancelDrag(e.eElement)},d=Up(this.beans),p=[{target:d,type:"mousemove",listener:s},{target:d,type:"mouseup",listener:n},{target:d,type:"contextmenu",listener:o},{target:d,type:"keydown",listener:l}];this.addTemporaryEvents(p),e.dragStartPixels===0&&this.onMouseMove(t,e.eElement)}addTemporaryEvents(e){e.forEach(t=>{let{target:i,type:s,listener:n,options:o}=t;i.addEventListener(s,n,o)}),this.dragEndFunctions.push(()=>{e.forEach(t=>{let{target:i,type:s,listener:n,options:o}=t;i.removeEventListener(s,n,o)})})}isEventNearStartEvent(e,t){let{dragStartPixels:i}=this.currentDragParams,s=st(i)?i:4;return mP(e,t,s)}getFirstActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}onCommonMove(e,t,i){if(!this.dragging){if(this.isEventNearStartEvent(e,t))return;if(this.dragging=!0,this.eventSvc.dispatchEvent({type:"dragStarted",target:i}),this.currentDragParams.onDragStart(t),!this.currentDragParams){this.dragging=!1;return}this.currentDragParams.onDragging(t)}this.currentDragParams?.onDragging(e)}onTouchMove(e,t){let i=this.getFirstActiveTouch(e.touches);i&&this.onCommonMove(i,this.touchStart,t)}onMouseMove(e,t){ll()&&Vs(this.beans).getSelection()?.removeAllRanges(),this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,t)}shouldPreventMouseEvent(e){let t=e.type==="mousemove",i=s=>!!s.target?.tagName.toLocaleLowerCase()?.match("^a$|textarea|input|select|button");return t&&e.cancelable&&Zp(this.beans,e)&&!i(e)}onTouchUp(e,t){let i=this.getFirstActiveTouch(e.changedTouches);i||(i=this.touchLastTime),this.onUpCommon(i,t)}onMouseUp(e,t){this.onUpCommon(e,t)}onUpCommon(e,t){this.dragging&&(this.dragging=!1,this.currentDragParams.onDragStop(e),this.eventSvc.dispatchEvent({type:"dragStopped",target:t})),this.resetDragProperties()}cancelDrag(e){this.eventSvc.dispatchEvent({type:"dragCancelled",target:e}),this.currentDragParams?.onDragCancel?.(),this.resetDragProperties()}resetDragProperties(){this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null;let{dragEndFunctions:e}=this;e.forEach(t=>t()),e.length=0}},$8=class extends dr{constructor(){super(...arguments),this.beanName="dragAndDrop",this.dragSourceAndParamsList=[],this.dragItem=null,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.dragSource=null,this.dragImageParent=null,this.dragImageCompPromise=null,this.dragImageComp=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.dropTargets=[],this.lastDropTarget=null}addDragSource(e,t=!1){let i={dragSource:e,eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:s=>this.onDragStart(e,s),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push(i),this.beans.dragSvc.addDragSource(i)}setDragImageCompIcon(e,t=!1){let i=this.dragImageComp;i&&(t||this.dragImageLastIcon!==e)&&(this.dragImageLastIcon=e,i.setIcon(e,t))}removeDragSource(e){let{dragSourceAndParamsList:t,beans:i}=this,s=t.find(n=>n.dragSource===e);s&&(i.dragSvc?.removeDragSource(s),sn(t,s))}destroy(){let{dragSourceAndParamsList:e,dropTargets:t,beans:i}=this,s=i.dragSvc;for(let n of e)s?.removeDragSource(n);e.length=0,t.length=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){let e=this.lastMouseEvent;e&&this.onDragging(e,!0)}onDragStart(e,t){this.lastMouseEvent=t,this.dragSource=e,this.dragItem=e.getDragItem(),e.onDragStarted?.(),this.createAndUpdateDragImageComp(e)}onDragStop(e){let{dragSource:t,lastDropTarget:i}=this;if(t?.onDragStopped?.(),i){let s=this.dropTargetEvent(i,e,!1);i.onDragStop?.(s)}this.clearDragAndDropProperties()}onDragCancel(){let{dragSource:e,lastDropTarget:t,lastMouseEvent:i}=this;if(e?.onDragCancelled?.(),t&&i){let s=this.dropTargetEvent(t,i,!1);t.onDragCancel?.(s)}this.clearDragAndDropProperties()}onDragging(e,t=!1){this.positionDragImageComp(e);let i=this.findCurrentDropTarget(e),{lastDropTarget:s,dragSource:n,dragItem:o}=this,l=!1;if(i!==s){if(l=!0,s){let d=this.dropTargetEvent(s,e,t);s.onDragLeave?.(d)}if(s!==null&&!i?this.handleExit(n,o):s===null&&i&&this.handleEnter(n,o),i){let d=this.dropTargetEvent(i,e,t);i.onDragEnter?.(d)}this.lastDropTarget=i}else if(i){let d=this.dropTargetEvent(i,e,t);i.onDragging?.(d),d?.changed&&(l=!0)}this.lastMouseEvent=e,l&&this.updateDragImageComp()}clearDragAndDropProperties(){this.removeDragImageComp(this.dragImageComp),this.dragImageCompPromise=null,this.dragImageParent=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.lastDropTarget=null,this.dragItem=null,this.dragSource=null}getAllContainersFromDropTarget(e){let t=e.getSecondaryContainers?e.getSecondaryContainers():null,i=[[e.getContainer()]];return t?i.concat(t):i}isMouseOnDropTarget(e,t){let i=this.getAllContainersFromDropTarget(t),s=!1,n=(d,p)=>{for(let y of p){let{width:C,height:S,left:P,right:I,top:O,bottom:V}=y.getBoundingClientRect();if(C===0||S===0)return!1;let G=d.clientX>=P&&d.clientX<I,X=d.clientY>=O&&d.clientY<V;if(!G||!X)return!1}return!0};for(let d of i)if(n(e,d)){s=!0;break}let{eElement:o,type:l}=this.dragSource;return t.targetContainsSource&&!t.getContainer().contains(o)?!1:s&&t.isInterestedIn(l,o)}findCurrentDropTarget(e){let t=this.dropTargets.filter(o=>this.isMouseOnDropTarget(e,o)),i=t.length;if(i===0)return null;if(i===1)return t[0];let n=Up(this.beans).elementsFromPoint(e.clientX,e.clientY);for(let o of n)for(let l of t)if(this.getAllContainersFromDropTarget(l).flatMap(p=>p).indexOf(o)!==-1)return l;return null}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter(t=>t.getContainer()!==e.getContainer())}hasExternalDropZones(){return this.dropTargets.some(e=>e.external)}findExternalZone(e){return this.dropTargets.find(t=>t.external&&t.getContainer()===e)||null}dropTargetEvent(e,t,i){let{dragSource:s,dragItem:n,lastDraggingEvent:o,lastMouseEvent:l}=this,d=e.getContainer(),p=d.getBoundingClientRect(),{clientX:y,clientY:C}=t,S=y-(l?.clientX||0),P=C-(l?.clientY||0),I=this.createEvent({event:t,x:y-p.left,y:C-p.top,vDirection:P>0?"down":P<0?"up":null,hDirection:S<0?"left":S>0?"right":null,dragSource:s,fromNudge:i,dragItem:n,dropZoneTarget:d,dropTarget:o?.dropTarget??null,changed:!!o?.changed});return this.lastDraggingEvent=I,I}positionDragImageComp(e){let t=this.dragImageComp?.getGui();t&&X4(t,e,this.beans)}removeDragImageComp(e){if(this.dragImageComp===e&&(this.dragImageComp=null),e){let t=e.getGui();this.dragImageParent?.removeChild(t),this.destroyBean(e)}}createAndUpdateDragImageComp(e){let t=this.createDragImageComp(e)??null;this.dragImageCompPromise=t,t?.then(i=>{if(t!==this.dragImageCompPromise||!this.lastMouseEvent||!this.isAlive()){this.destroyBean(i);return}this.dragImageCompPromise=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0;let s=this.dragImageComp;s!==i&&(this.dragImageComp=i,this.removeDragImageComp(s)),i&&(this.appendDragImageComp(i),this.updateDragImageComp())})}appendDragImageComp(e){let t=e.getGui(),i=t.style;i.setProperty("position","absolute"),i.setProperty("z-index","9999"),this.gos.setInstanceDomData(t),this.beans.environment.applyThemeClasses(t),i.top="20px",i.left="20px";let s=GC(this.beans);this.dragImageParent=s,s?s.appendChild(t):this.warnNoBody()}updateDragImageComp(){let{dragImageComp:e,dragSource:t,lastDropTarget:i,lastDraggingEvent:s,dragImageLastLabel:n}=this;if(!e)return;this.setDragImageCompIcon(i?.getIconName?.(s)??null);let o=t?.dragItemName;typeof o=="function"&&(o=o(s)),o||(o=""),n!==o&&(this.dragImageLastLabel=o,e.setLabel(o))}};var q8=class extends $8{createEvent(e){return bt(this.gos,e)}createDragImageComp(e){let{gos:t,beans:i}=this;return y5(i.userCompFactory,bt(t,{dragSource:e}))?.newAgStackInstance()}handleEnter(e,t){e?.onGridEnter?.(t)}handleExit(e,t){e?.onGridExit?.(t)}warnNoBody(){je(54)}isDropZoneWithinThisGrid(e){return this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody.contains(e.dropZoneTarget)}registerGridDropTarget(e,t){let i={getContainer:e,isInterestedIn:s=>s===1||s===0,getIconName:()=>"notAllowed"};this.addDropTarget(i),t.addDestroyFunc(()=>this.removeDropTarget(i))}};function yM(e,t){return e+"_"+t}function ns(e){return e instanceof Jp}var Jp=class extends Be{constructor(e,t,i,s){super(),this.providedColumnGroup=e,this.groupId=t,this.partId=i,this.pinned=s,this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null,this.colIdSanitised=Op(this.getUniqueId())}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}getUniqueId(){return yM(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){let e=this.getProvidedColumnGroup().getLeafColumns();return!e||e.length===0?!1:e.every(t=>t.isMoving())}checkLeft(){if(this.displayedChildren.forEach(e=>{ns(e)&&e.checkLeft()}),this.displayedChildren.length>0)if(this.gos.get("enableRtl")){let t=di(this.displayedChildren).getLeft();this.setLeft(t)}else{let e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;return this.displayedChildren?.forEach(t=>{e+=t.getActualWidth()}),e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;return this.displayedChildren.forEach(t=>{t.isResizable()&&(e=!0)}),e}getMinWidth(){let e=0;return this.displayedChildren.forEach(t=>{e+=t.getMinWidth()}),e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){let e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){let e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){return!!this.getColGroupDef()?.autoHeaderHeight}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){let t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){this.displayedChildren.forEach(t=>{ol(t)?e.push(t):ns(t)&&t.addDisplayedLeafColumns(e)})}addLeafColumns(e){this.children.forEach(t=>{ol(t)?e.push(t):ns(t)&&t.addLeafColumns(e)})}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){let e=this.getParent();return!this.isPadding()||!e||!e.isPadding()?0:1+e.getPaddingLevel()}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;e!=null&&e.isPadding();)e=e.getParent();if(!(e?e.getProvidedColumnGroup().isExpandable():!1)){this.displayedChildren=this.children,this.dispatchLocalEvent({type:"displayedChildrenChanged"});return}this.children.forEach(i=>{if(ns(i)&&!i.displayedChildren?.length)return;switch(i.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(i);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(i);break;default:this.displayedChildren.push(i);break}}),this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},_C="row-group-",ab="t-",lb="b-",Z8=0,fc=class{constructor(e){this.master=!1,this.detail=void 0,this.rowIndex=null,this.key=null,this.sourceRowIndex=-1,this.childrenMapped=null,this.treeParent=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=Z8++,this.alreadyRendered=!1,this.hovered=!1,this.__selected=!1,this.beans=e}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){let{valueCache:i,eventSvc:s}=this.beans,n=this.data;this.data=e,i?.onDataChanged(),this.updateDataOnDetailNode(),this.resetQuickFilterAggregateText();let o=this.createDataChangedEvent(e,n,t);if(this.__localEventService?.dispatchEvent(o),this.sibling){this.sibling.data=e;let d=this.sibling.createDataChangedEvent(e,n,t);this.sibling.__localEventService?.dispatchEvent(d)}s.dispatchEvent({type:"rowNodeDataChanged",node:this});let l=this.pinnedSibling;l&&(l.data=e,l.__localEventService?.dispatchEvent(l.createDataChangedEvent(e,n,t)),s.dispatchEvent({type:"rowNodeDataChanged",node:l}))}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(e,t,i){return{type:"dataChanged",node:this,oldData:t,newData:e,update:i}}getRowIndexString(){return this.rowIndex==null?(li(13),null):this.rowPinned==="top"?ab+this.rowIndex:this.rowPinned==="bottom"?lb+this.rowIndex:this.rowIndex.toString()}setDataAndId(e,t){let{selectionSvc:i}=this.beans,s=i?.createDaemonNode?.(this),n=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),i&&(i.updateRowSelectable(this),i.syncInRowNode(this,s));let o=this.createDataChangedEvent(e,n,!1);this.__localEventService?.dispatchEvent(o)}setId(e){let t=Pu(this.beans.gos);if(t)if(this.data){let i=this.parent?.getRoute()??[];this.id=t({data:this.data,parentKeys:i.length>0?i:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(_C)&&li(14,{groupPrefix:_C})}else this.id=void 0;else this.id=e}setRowTop(e){this.oldRowTop=this.rowTop,this.rowTop!==e&&(this.rowTop=e,this.dispatchRowEvent("topChanged"),this.setDisplayed(e!==null))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(e){this.hovered=e}isHovered(){return this.hovered}setRowHeight(e,t=!1){this.rowHeight=e,this.rowHeightEstimated=t,this.dispatchRowEvent("heightChanged")}setExpanded(e,t,i){this.beans.expansionSvc?.setExpanded(this,e,t,i)}setDataValue(e,t,i){let{colModel:s,valueSvc:n,gos:o,editSvc:l}=this.beans,d=typeof e!="string"?e:s.getCol(e)??s.getColDefCol(e);if(!d)return!1;let p=n.getValueForDisplay(d,this,void 0,void 0,"api").value;if(o.get("readOnlyEdit")){let{beans:{eventSvc:S},data:P,rowIndex:I,rowPinned:O}=this;return S.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:I,rowPinned:O,column:d,colDef:d.colDef,data:P,node:this,oldValue:p,newValue:t,value:t,source:i}),!1}if(l&&!l.committing){let S=l.setDataValue({rowNode:this,column:d},t,i);if(S!=null)return S}let y=n.setValue(this,d,t,i);this.dispatchCellChangedEvent(d,t,p);let C=this.pinnedSibling;return C&&y&&C.dispatchCellChangedEvent(d,t,p),y}updateHasChildren(){let e=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0,{rowChildrenSvc:t}=this.beans;t&&(e=t.getHasChildrenValue(this)),e!==this.__hasChildren&&(this.__hasChildren=!!e,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(e,t,i){let s={type:"cellChanged",node:this,column:e,newValue:t,oldValue:i};this.__localEventService?.dispatchEvent(s)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.beans.expansionSvc?.isExpandable(this)??!1}isSelected(){return this.footer?this.sibling.isSelected():this.rowPinned&&this.pinnedSibling?this.pinnedSibling.isSelected():this.__selected}depthFirstSearch(e){this.childrenAfterGroup?.forEach(t=>t.depthFirstSearch(e)),e(this)}dispatchRowEvent(e){this.__localEventService?.dispatchEvent({type:e,node:this})}setSelected(e,t=!1,i="api"){this.beans.selectionSvc?.setNodesSelected({nodes:[this],newValue:e,clearSelection:t,source:i})}isRowPinned(){return!!this.rowPinned}__addEventListener(e,t){this.__localEventService||(this.__localEventService=new dc),this.__localEventService.addEventListener(e,t)}__removeEventListener(e,t){this.removeLocalListener(e,t)}addEventListener(e,t){this.beans.validation?.checkRowEvents(e),this.__localEventService||(this.__localEventService=new dc),this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,this.__localEventService);let i=this.frameworkEventListenerService?.wrap(e,t)??t;this.__localEventService.addEventListener(e,i)}removeEventListener(e,t){let i=this.frameworkEventListenerService?.unwrap(e,t)??t;this.removeLocalListener(e,i)}removeLocalListener(e,t){this.__localEventService?.removeEventListener(e,t),this.__localEventService?.noRegisteredListenersExist()&&(this.__localEventService=null)}isFullWidthCell(){if(je(61),this.detail)return!0;let e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this}):!1}getRoute(){if(this.level===-1)return[];if(this.key==null)return;let e=[],t=this;for(;t&&t.key!=null;)e.push(t.key),t=t.parent;return e.reverse()}setDisplayed(e){this.displayed!==e&&(this.displayed=e,this.dispatchRowEvent("displayedChanged"))}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.dispatchRowEvent("rowIndexChanged"))}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.dispatchRowEvent("allChildrenCountChanged"))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.dispatchRowEvent("uiLevelChanged"))}getFirstChild(){return this.childStore?this.childStore.getFirstNode():this.childrenAfterSort?.[0]??null}};function K8(e,t,i){return bt(t,{type:i,node:e,data:e.data,rowIndex:e.rowIndex,rowPinned:e.rowPinned})}var X8=new Set(["__localEventService","__objectId","sticky","__autoHeights","__checkAutoHeightsDebounced","childStore"]);function Y8(e,t){let i=new fc(t);return Object.keys(e).forEach(s=>{X8.has(s)||(i[s]=e[s])}),i.oldRowTop=null,i}var wM={agSetColumnFilter:"agSetColumnFilterHandler",agMultiColumnFilter:"agMultiColumnFilterHandler",agGroupColumnFilter:"agGroupColumnFilterHandler",agNumberColumnFilter:"agNumberColumnFilterHandler",agDateColumnFilter:"agDateColumnFilterHandler",agTextColumnFilter:"agTextColumnFilterHandler"},Q8=new Set(Object.values(wM));function Ka(e,t){let i=e.filterUi;if(!i)return null;if(i.created)return i.promise;if(t)return null;let s=i.create(i.refreshed),n=i;return n.created=!0,n.promise=s,s}function J8(e,t,i,s,n,o){return t.refresh?.(ht(Se({},i),{model:s,source:o})),e().then(l=>{if(l){let{filter:d,filterParams:p}=l;CM(d,p,s,n,o)}})}function CM(e,t,i,s,n){e?.refresh?.(ht(Se({},t),{model:i,state:s,source:n}))}function bM(e,t,i){let s=e();s?.created&&s.promise.then(n=>{let o=t();CM(n,s.filterParams,o,i()??{model:o},"ui")})}function oE(e,t,i,s,n,o,l){let d,p=!1,y;switch(e){case"apply":{let C=s();y=C?.model??null,l&&(y=l(y)),d={state:C?.state,model:y},p=!0;break}case"clear":{d={model:null};break}case"reset":{d={model:null},p=!0,y=null;break}case"cancel":{d={model:i()};break}}n(d),p?o(y):bM(t,i,s)}function Ps(e,t){return e[t]??null}function rs(e){return ng(e)}function eV(e){return{tag:"div",cls:e}}var tV=class extends ii{constructor(e){let{className:t="ag-filter-apply-panel"}=e??{};super(eV(t)),this.listeners=[],this.validationMessage=null,this.className=t}updateButtons(e,t){let i=this.buttons;if(this.buttons=e,i===e)return;let s=this.getGui();Ns(s);let n;this.destroyListeners();let o=document.createDocumentFragment(),l=this.className,d=({type:y,label:C})=>{let S=X=>{this.dispatchLocalEvent({type:y,event:X})};["apply","clear","reset","cancel"].includes(y)||je(75);let P=y==="apply",O=rs({tag:"button",attrs:{type:P&&t?"submit":"button"},ref:`${y}FilterButton`,cls:`ag-button ag-standard-button ${l}-button${P?" "+l+"-apply-button":""}`,children:C});this.activateTabIndex([O]),P&&(n=O);let V=X=>{X.key===Fe.ENTER&&(X.preventDefault(),S(X))},G=this.listeners;O.addEventListener("click",S),G.push(()=>O.removeEventListener("click",S)),O.addEventListener("keydown",V),G.push(()=>O.removeEventListener("keydown",V)),o.append(O)};e.forEach(y=>d(y)),this.eApply=n;let p=this.validationTooltipFeature;n&&!p?this.validationTooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eApply,getLocation:()=>"advancedFilter",getTooltipShowDelayOverride:()=>1e3})):!n&&p&&(this.validationTooltipFeature=this.destroyBean(p)),s.append(o)}getApplyButton(){return this.eApply}updateValidity(e,t=null){let i=this.eApply;i&&($p(i,e===!1),this.validationMessage=t??null,this.validationTooltipFeature?.setTooltipAndRefresh(this.validationMessage))}destroyListeners(){this.listeners.forEach(e=>e()),this.listeners=[]}destroy(){this.destroyListeners(),super.destroy()}};var iV={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd",filterSummaryInactive:"is (All)",filterSummaryContains:"contains",filterSummaryNotContains:"does not contain",filterSummaryTextEquals:"equals",filterSummaryTextNotEqual:"does not equal",filterSummaryStartsWith:"begins with",filterSummaryEndsWith:"ends with",filterSummaryBlank:"is blank",filterSummaryNotBlank:"is not blank",filterSummaryEquals:"=",filterSummaryNotEqual:"!=",filterSummaryGreaterThan:">",filterSummaryGreaterThanOrEqual:">=",filterSummaryLessThan:"<",filterSummaryLessThanOrEqual:"<=",filterSummaryInRange:"between",filterSummaryInRangeValues:e=>`(${e[0]}, ${e[1]})`,filterSummaryTextQuote:e=>`"${e[0]}"`};function Ja(e,t,i){return Q4(e,iV,t,i)}function cb(e,t){let{debounceMs:i}=e;return xv(e)?(i!=null&&je(71),0):i??t}function xv(e){return(e.buttons?.indexOf("apply")??-1)>=0}var sV=class extends ii{constructor(e,t,i,s,n,o){super(),this.column=e,this.wrapper=t,this.eventParent=i,this.updateModel=s,this.isGlobalButtons=n,this.enableGlobalButtonCheck=o,this.hidePopup=null,this.applyActive=!1}postConstruct(){let{comp:e,params:t}=this.wrapper,i=t,s=i.useForm,n=s?"form":"div";this.setTemplate({tag:n,cls:"ag-filter-wrapper"}),s&&this.addManagedElementListeners(this.getGui(),{submit:o=>{o?.preventDefault()},keydown:this.handleKeyDown.bind(this)}),this.appendChild(e.getGui()),this.params=i,this.resetButtonsPanel(i),this.addManagedListeners(this.eventParent,Se({filterParamsChanged:({column:o,params:l})=>{o===this.column&&this.resetButtonsPanel(l,this.params)},filterStateChanged:({column:o,state:l})=>{o===this.column&&this.eButtons?.updateValidity(l.valid!==!1)},filterAction:({column:o,action:l,event:d})=>{o===this.column&&this.afterAction(l,d)}},this.enableGlobalButtonCheck?{filterGlobalButtons:({isGlobal:o})=>{if(o!==this.isGlobalButtons){this.isGlobalButtons=o;let l=this.params;this.resetButtonsPanel(l,l,!0)}}}:void 0))}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup)}resetButtonsPanel(e,t,i){let{buttons:s,readOnly:n}=t??{},{buttons:o,readOnly:l,useForm:d}=e;if(!i&&n===l&&Wp(s,o))return;let p=o&&o.length>0&&!e.readOnly&&!this.isGlobalButtons,y=this.eButtons;if(p){let C=o.map(S=>{let P=`${S}Filter`;return{type:S,label:Ja(this,P)}});if(this.applyActive=xv(this.params),!y){y=this.createBean(new tV),this.appendChild(y.getGui());let S=this.column,P=I=>({event:O})=>{this.updateModel(S,I),this.afterAction(I,O)};y?.addManagedListeners(y,{apply:P("apply"),clear:P("clear"),reset:P("reset"),cancel:P("cancel")}),this.eButtons=y}y.updateButtons(C,d)}else this.applyActive=!1,y&&(yo(y.getGui()),this.eButtons=this.destroyBean(y))}close(e){let t=this.hidePopup;if(!t)return;let i=e,s=i&&i.key,n;(s===Fe.ENTER||s===Fe.SPACE)&&(n={keyboardEvent:i}),t(n),this.hidePopup=null}afterAction(e,t){let{params:i,applyActive:s}=this,n=i?.closeOnApply;switch(e){case"apply":{t?.preventDefault(),n&&s&&this.close(t);break}case"reset":{n&&s&&this.close();break}case"cancel":{n&&this.close(t);break}}}handleKeyDown(e){!e.defaultPrevented&&e.key===Fe.ENTER&&this.applyActive&&(this.updateModel(this.column,"apply"),this.afterAction("apply",e))}destroy(){this.hidePopup=null,this.eButtons=this.destroyBean(this.eButtons)}},oV={tag:"div",cls:"ag-filter"},nV=class extends ii{constructor(e,t,i){super(oV),this.column=e,this.source=t,this.enableGlobalButtonCheck=i,this.wrapper=null}postConstruct(){this.beans.colFilter?.activeFilterComps.add(this),this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return this.wrapper!=null}getFilter(){return this.wrapper?.then(e=>e.comp)??null}afterInit(){return this.wrapper?.then(()=>{})??Ui.resolve()}afterGuiAttached(e){this.afterGuiAttachedParams=e,this.wrapper?.then(t=>{this.comp?.afterGuiAttached(e),t?.comp?.afterGuiAttached?.(e)})}afterGuiDetached(){this.wrapper?.then(e=>{e?.comp?.afterGuiDetached?.()})}createFilter(e){let{column:t,source:i,beans:{colFilter:s}}=this,n=s.getFilterUiForDisplay(t)??null;this.wrapper=n,n?.then(o=>{if(!o)return;let{isHandler:l,comp:d}=o,p;if(l){let y=!!this.enableGlobalButtonCheck,C=this.createBean(new sV(t,o,s,s.updateModel.bind(s),y&&s.isGlobalButtons,y));this.comp=C,p=C.getGui()}else p=d.getGui(),st(p)||je(69,{guiFromFilter:p});this.appendChild(p),e?this.eventSvc.dispatchEvent({type:"filterOpened",column:t,source:i,eGui:this.getGui()}):d.afterGuiAttached?.(this.afterGuiAttachedParams)})}onFilterDestroyed(e){let{source:t,column:i}=e;(t==="api"||t==="paramsUpdated")&&i.getId()===this.column.getId()&&this.beans.colModel.getColDefCol(this.column)&&(Ns(this.getGui()),this.comp=this.destroyBean(this.comp),this.createFilter())}destroy(){this.beans.colFilter?.activeFilterComps.delete(this),this.eventSvc.dispatchEvent({type:"filterClosed",column:this.column}),this.wrapper=null,this.comp=this.destroyBean(this.comp),this.afterGuiAttachedParams=void 0,super.destroy()}},nE={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},rE=["january","february","march","april","may","june","july","august","september","october","november","december"];function rV(e,t){return e==null?-1:t==null?1:parseFloat(e)-parseFloat(t)}function aE(e){return e instanceof Date&&!isNaN(e.getTime())}var SC={number:()=>{},boolean:()=>({maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(e,t)=>t,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(e,t)=>t===!1,numberOfInputs:0}]}),date:()=>({isValidDate:aE}),dateString:({dataTypeDefinition:e})=>({comparator:(t,i)=>{let s=e.dateParser(i);return i==null||s<t?-1:s>t?1:0},isValidDate:t=>typeof t=="string"&&aE(e.dateParser(t))}),dateTime:e=>SC.date(e),dateTimeString:e=>SC.dateString(e),object:()=>{},text:()=>{}},RC={number:()=>({comparator:rV}),boolean:({t:e})=>({valueFormatter:t=>st(t.value)?e(String(t.value),t.value?"True":"False"):e("blanks","(Blanks)")}),date:({formatValue:e,t})=>({valueFormatter:i=>{let s=e(i);return st(s)?s:t("blanks","(Blanks)")},treeList:!0,treeListFormatter:(i,s)=>{if(i==="NaN")return t("invalidDate","Invalid Date");if(s===1&&i!=null){let n=rE[Number(i)-1];return t(n,nE[n])}return i??t("blanks","(Blanks)")},treeListPathGetter:i=>Dm(i,!1)}),dateString:({formatValue:e,dataTypeDefinition:t,t:i})=>({valueFormatter:s=>{let n=e(s);return st(n)?n:i("blanks","(Blanks)")},treeList:!0,treeListPathGetter:s=>Dm(t.dateParser(s??void 0),!1),treeListFormatter:(s,n)=>{if(n===1&&s!=null){let o=rE[Number(s)-1];return i(o,nE[o])}return s??i("blanks","(Blanks)")}}),dateTime:e=>{let t=RC.date(e);return t.treeListPathGetter=Dm,t},dateTimeString(e){let t=e.dataTypeDefinition.dateParser,i=RC.dateString(e);return i.treeListPathGetter=s=>Dm(t(s??void 0)),i},object:({formatValue:e,t})=>({valueFormatter:i=>{let s=e(i);return st(s)?s:t("blanks","(Blanks)")}}),text:()=>{}};function aV(e,t,i,s,n,o,l){let d=t,p=i,y=e==="agSetColumnFilter";!p&&s.baseDataType==="object"&&!y&&(p=({column:I,node:O})=>n({column:I,node:O,value:o.valueSvc.getValue(I,O)}));let S=(y?RC:SC)[s.baseDataType],P=S({dataTypeDefinition:s,formatValue:n,t:l});return d=typeof t=="object"?Se(Se({},P),t):P,{filterParams:d,filterValueGetter:p}}var lV={boolean:"agTextColumnFilter",date:"agDateColumnFilter",dateString:"agDateColumnFilter",dateTime:"agDateColumnFilter",dateTimeString:"agDateColumnFilter",number:"agNumberColumnFilter",object:"agTextColumnFilter",text:"agTextColumnFilter"},cV={boolean:"agTextColumnFloatingFilter",date:"agDateColumnFloatingFilter",dateString:"agDateColumnFloatingFilter",dateTime:"agDateColumnFloatingFilter",dateTimeString:"agDateColumnFloatingFilter",number:"agNumberColumnFloatingFilter",object:"agTextColumnFloatingFilter",text:"agTextColumnFloatingFilter"};function hV(e,t=!1){return(t?cV:lV)[e??"text"]}var xM="ag-resizer-wrapper",Xa=(e,t)=>({tag:"div",ref:`${e}Resizer`,cls:`ag-resizer ag-resizer-${t}`}),uV={tag:"div",cls:xM,children:[Xa("eTopLeft","topLeft"),Xa("eTop","top"),Xa("eTopRight","topRight"),Xa("eRight","right"),Xa("eBottomRight","bottomRight"),Xa("eBottom","bottom"),Xa("eBottomLeft","bottomLeft"),Xa("eLeft","left")]},dV=class extends Be{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}wireBeans(e){this.popupSvc=e.popupSvc,this.dragSvc=e.dragSvc}center(e){let{clientHeight:t,clientWidth:i}=this.offsetParent,s=i/2-this.getWidth()/2,n=t/2-this.getHeight()/2;this.offsetElement(s,n,e)}initialisePosition(e){if(this.positioned)return;let{centered:t,forcePopupParentAsOffsetParent:i,minWidth:s,width:n,minHeight:o,height:l,x:d,y:p}=this.config;this.offsetParent||this.setOffsetParent();let y=0,C=0,S=ur(this.element);if(S){let P=this.findBoundaryElement(),I=window.getComputedStyle(P);if(I.minWidth!=null){let O=P.offsetWidth-this.element.offsetWidth;C=parseInt(I.minWidth,10)-O}if(I.minHeight!=null){let O=P.offsetHeight-this.element.offsetHeight;y=parseInt(I.minHeight,10)-O}}if(this.minHeight=o||y,this.minWidth=s||C,n&&this.setWidth(n),l&&this.setHeight(l),(!n||!l)&&this.refreshSize(),t)this.center(e);else if(d||p)this.offsetElement(d,p,e);else if(S&&i){let P=this.boundaryEl,I=!0;if(P||(P=this.findBoundaryElement(),I=!1),P){let O=parseFloat(P.style.top),V=parseFloat(P.style.left);I?this.offsetElement(isNaN(V)?0:V,isNaN(O)?0:O,e):this.setPosition(V,O)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;let i=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragSvc?.addDragSource(i),this.moveElementDragListener=i):(this.dragSvc?.removeDragSource(i),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),typeof e=="boolean"){if(e===!1)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach(t=>{let s=!!e[t],n=this.getResizerElement(t),o={dragStartPixels:0,eElement:n,onDragStart:l=>this.onResizeStart(l,t),onDragging:this.onResize.bind(this),onDragStop:l=>this.onResizeEnd(l,t)};(s||!this.isAlive()&&!s)&&(s?(this.dragSvc?.addDragSource(o),this.resizeListeners.push(o),n.style.pointerEvents="all"):n.style.pointerEvents="none",this.resizable[t]=s)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";let{height:e,width:t}=this.lastSize;t!==-1&&(this.element.style.width=`${t}px`),e!==-1&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){let{popup:t}=this.config,i=this.element,s=!1;if(typeof e=="string"&&e.indexOf("%")!==-1)zp(i,e),e=lP(i),s=!0;else if(e=Math.max(this.minHeight,e),this.positioned){let n=this.getAvailableHeight();n&&e>n&&(e=n)}this.getHeight()!==e&&(s?(i.style.maxHeight="unset",i.style.minHeight="unset"):t?zp(i,e):(i.style.height=`${e}px`,i.style.flex="0 0 auto",this.lastSize.height=typeof e=="number"?e:parseFloat(e)))}getAvailableHeight(){let{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();let{clientHeight:i}=this.offsetParent;if(!i)return null;let s=this.element.getBoundingClientRect(),n=this.offsetParent.getBoundingClientRect(),o=e?this.position.y:s.top,l=e?0:n.top,d=0;if(t){let y=this.element.parentElement;if(y){let{bottom:C}=y.getBoundingClientRect();d=C-s.bottom}}return i+l-o-d}getWidth(){return this.element.offsetWidth}setWidth(e){let t=this.element,{popup:i}=this.config,s=!1;if(typeof e=="string"&&e.indexOf("%")!==-1)lr(t,e),e=Ym(t),s=!0;else if(this.positioned){e=Math.max(this.minWidth,e);let{clientWidth:n}=this.offsetParent,o=i?this.position.x:this.element.getBoundingClientRect().left;n&&e+o>n&&(e=n-o)}this.getWidth()!==e&&(s?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?lr(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width=typeof e=="number"?e:parseFloat(e)))}offsetElement(e=0,t=0,i){let{forcePopupParentAsOffsetParent:s}=this.config,n=s?this.boundaryEl:this.element;n&&(this.popupSvc?.positionPopup({ePopup:n,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t}),postProcessCallback:i}),this.setPosition(parseFloat(n.style.left),parseFloat(n.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;let t=()=>{let i=this.getAvailableHeight();this.element.style.setProperty("max-height",`${i}px`)};e&&this.popupSvc?(this.resizeObserverSubscriber?.(),this.resizeObserverSubscriber=nl(this.beans,this.popupSvc?.getPopupParent(),t)):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){let{e:t,isLeft:i,isTop:s,anywhereWithin:n,topBuffer:o}=e,l=t.clientX-this.dragStartPosition.x,d=t.clientY-this.dragStartPosition.y,p=this.shouldSkipX(t,!!i,!!n,l)?0:l,y=this.shouldSkipY(t,!!s,o,d)?0:d;return{movementX:p,movementY:y}}shouldSkipX(e,t,i,s){let n=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),l=this.boundaryEl.getBoundingClientRect(),d=this.config.popup?this.position.x:n.left,p=d<=0&&o.left>=e.clientX||o.right<=e.clientX&&o.right<=l.right;return p?!0:(t?p=s<0&&e.clientX>d+o.left||s>0&&e.clientX<d+o.left:i?p=s<0&&e.clientX>l.right||s>0&&e.clientX<d+o.left:p=s<0&&e.clientX>l.right||s>0&&e.clientX<l.right,p)}shouldSkipY(e,t,i=0,s){let n=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),l=this.boundaryEl.getBoundingClientRect(),d=this.config.popup?this.position.y:n.top,p=d<=0&&o.top>=e.clientY||o.bottom<=e.clientY&&o.bottom<=l.bottom;return p?!0:(t?p=s<0&&e.clientY>d+o.top+i||s>0&&e.clientY<d+o.top:p=s<0&&e.clientY>l.bottom||s>0&&e.clientY<l.bottom,p)}createResizeMap(){let e=t=>({element:this.element.querySelector(`[data-ref=${t}Resizer]`)});this.resizerMap={topLeft:e("eTopLeft"),top:e("eTop"),topRight:e("eTopRight"),right:e("eRight"),bottomRight:e("eBottomRight"),bottom:e("eBottom"),bottomLeft:e("eBottomLeft"),left:e("eLeft")}}addResizers(){if(this.resizersAdded)return;let e=this.element;e&&(e.appendChild(rs(uV)),this.createResizeMap(),this.resizersAdded=!0)}removeResizers(){this.resizerMap=void 0;let e=this.element.querySelector(`.${xM}`);e&&this.element.removeChild(e),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");let{popup:i,forcePopupParentAsOffsetParent:s}=this.config;!i&&!s&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){let t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter(i=>!i.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){let e=this.getSiblings()||[],t=0,i=0;for(let s=0;s<e.length;s++){let n=e[s],o=!!n.style.flex&&n.style.flex!=="0 0 auto";if(n===this.element)continue;let l=this.minHeight||0,d=this.minWidth||0;if(o){let p=window.getComputedStyle(n);p.minHeight&&(l=parseInt(p.minHeight,10)),p.minWidth&&(d=parseInt(p.minWidth,10))}else l=n.offsetHeight,d=n.offsetWidth;t+=l,i+=d}return{height:t,width:i}}applySizeToSiblings(e){let t=null,i=this.getSiblings();if(i){for(let s=0;s<i.length;s++){let n=i[s];n!==t&&(e?n.style.height=`${n.offsetHeight}px`:n.style.width=`${n.offsetWidth}px`,n.style.flex="0 0 auto",n===this.element&&(t=i[s+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;let{popup:t,forcePopupParentAsOffsetParent:i}=this.config,{isTop:s,isRight:n,isBottom:o,isLeft:l}=this.currentResizer,d=n||l,p=o||s,{movementX:y,movementY:C}=this.calculateMouseMovement({e,isLeft:l,isTop:s}),S=this.position.x,P=this.position.y,I=0,O=0;if(d&&y){let V=l?-1:1,G=this.getWidth(),X=G+y*V,Q=!1;l&&(I=G-X,(S+I<=0||X<=this.minWidth)&&(Q=!0,I=0)),Q||this.setWidth(X)}if(p&&C){let V=s?-1:1,G=this.getHeight(),X=G+C*V,Q=!1;s?(O=G-X,(P+O<=0||X<=this.minHeight)&&(Q=!0,O=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&G<X&&this.getMinSizeOfSiblings().height+X>this.element.parentElement.offsetHeight&&(Q=!0),Q||this.setHeight(X)}this.updateDragStartPosition(e.clientX,e.clientY),((t||i)&&I||O)&&this.offsetElement(S+I,P+O)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){let e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;let{x:t,y:i}=this.position,s;this.config.calculateTopBuffer&&(s=this.config.calculateTopBuffer());let{movementX:n,movementY:o}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:s});this.offsetElement(t+n,i+o),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent&&this.popupSvc?this.offsetParent=this.popupSvc.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if(window.getComputedStyle(e).position!=="static")return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){let e=this.resizeListeners.pop();this.dragSvc?.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragSvc?.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},_M="__ag_Grid_Stop_Propagation";function mc(e){e[_M]=!0}function ea(e){return e[_M]===!0}var pV="ag-focus-managed",Au=class extends Be{constructor(e,t={}){super(),this.eFocusable=e,this.callbacks=t,this.callbacks=Se({shouldStopEventPropagation:()=>!1,onTabKeyDown:i=>{if(i.defaultPrevented)return;let s=Cc(this.beans,this.eFocusable,!1,i.shiftKey);s&&(s.focus(),i.preventDefault())}},t)}postConstruct(){let{eFocusable:e,callbacks:{onFocusIn:t,onFocusOut:i}}=this;e.classList.add(pV),this.addKeyDownListeners(e),t&&this.addManagedElementListeners(e,{focusin:t}),i&&this.addManagedElementListeners(e,{focusout:i})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:t=>{if(t.defaultPrevented||ea(t))return;let{callbacks:i}=this;if(i.shouldStopEventPropagation(t)){mc(t);return}t.key===Fe.TAB?i.onTabKeyDown(t):i.handleKeyDown&&i.handleKeyDown(t)}})}},gV=class extends ii{constructor(e,t){super(),this.filterNameKey=e,this.cssIdentifier=t,this.applyActive=!1,this.debouncePending=!1,this.defaultDebounceMs=0}postConstruct(){let e={tag:"div",cls:`ag-filter-body-wrapper ag-${this.cssIdentifier}-body-wrapper`,children:[this.createBodyTemplate()]};this.setTemplate(e,this.getAgComponents()),this.createManagedBean(new Au(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=this.createBean(new dV(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}))}handleKeyDown(e){}init(e){let t=e;this.setParams(t),this.setModelIntoUi(t.state.model,!0).then(()=>this.updateUiVisibility())}refresh(e){let t=e,i=this.params;this.params=t,t.source==="colDef"&&this.updateParams(t,i);let n=t.state,o=this.state;return this.state=n,(n.model!==o.model||n.state!==o.state)&&this.setModelIntoUi(n.model),!0}setParams(e){this.params=e,this.state=e.state,this.commonUpdateParams(e)}updateParams(e,t){this.commonUpdateParams(e,t)}commonUpdateParams(e,t){this.applyActive=xv(e),this.setupApplyDebounced()}doesFilterPass(e){je(283);let{getHandler:t,model:i,column:s}=this.params;return t().doesFilterPass(ht(Se({},e),{model:i,handlerParams:this.beans.colFilter.getHandlerParams(s)}))}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return je(284),this.params.model!=null}setupApplyDebounced(){let e=cb(this.params,this.defaultDebounceMs),t=Hs(this,this.checkApplyDebounce.bind(this),e);this.applyDebounced=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.doApplyModel())}getModel(){return je(285),this.params.model}setModel(e){je(286);let{beans:t,params:i}=this;return t.colFilter.setModelForColumnLegacy(i.column,e)}applyModel(e="api"){return this.doApplyModel()}canApply(e){return!0}doApplyModel(e){let{params:t,state:i}=this,s=!this.areModelsEqual(t.model,i.model);return s&&t.onAction("apply",e),s}onNewRowsLoaded(){}onUiChanged(e,t=!1){this.updateUiVisibility();let i=this.getModelFromUi(),s={model:i,state:this.getState(),valid:this.canApply(i)};this.state=s;let n=this.params;n.onStateChange(s),n.onUiChange(this.getUiChangeEventParams()),this.gos.get("enableFilterHandlers")||this.eventSvc.dispatchEvent({type:"filterModified",column:n.column,filterInstance:this}),e??(e=this.applyActive?void 0:"debounce"),e==="immediately"?this.doApplyModel({afterFloatingFilter:t,afterDataChange:!1}):e==="debounce"&&this.applyDebounced()}getState(){}getUiChangeEventParams(){}afterGuiAttached(e){this.lastContainerType=e?.container,this.refreshFilterResizer(e?.container)}refreshFilterResizer(e){let{positionableFeature:t,gos:i}=this;if(!t)return;let s=e==="floatingFilter"||e==="columnFilter";s?(t.restoreLastSize(),t.setResizable(i.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(t.removeSizeFromEl(),t.setResizable(!1)),t.constrainSizeToAvailableHeight(s)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature?.constrainSizeToAvailableHeight(!1)}destroy(){this.positionableFeature=this.destroyBean(this.positionableFeature),super.destroy()}translate(e){return Ja(this,e)}getPositionableElement(){return this.getGui()}areModelsEqual(e,t){return e===t||e==null&&t==null?!0:e==null||t==null?!1:this.areNonNullModelsEqual(e,t)}};function SM(e){return!!e.operator}function fV(e,t,i){if(t==null)return null;let s=null,{compName:n,jsComp:o,fwComp:l}=eM(e,t);return n?s={agSetColumnFilter:"agSetColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[n]:o==null&&l==null&&t.filter===!0&&(s=i()),s}var xn={AUTO_HEIGHT:"ag-layout-auto-height",NORMAL:"ag-layout-normal",PRINT:"ag-layout-print"},hb=class extends Be{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){let e=this.gos.get("domLayout"),t={autoHeight:e==="autoHeight",normal:e==="normal",print:e==="print"},i=t.autoHeight?xn.AUTO_HEIGHT:t.print?xn.PRINT:xn.NORMAL;this.view.updateLayoutClasses(i,t)}},Ya="Viewport",lE="fakeVScrollComp",Vw=["fakeHScrollComp","centerHeader","topCenter","bottomCenter","stickyTopCenter","stickyBottomCenter"],cE=100,Hw=150,mV=class extends Be{constructor(e){super(),this.clearRetryListenerFncs=[],this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.lastIsHorizontalScrollShowing=!1,this.scrollTimer=0,this.isScrollActive=!1,this.isVerticalPositionInvalidated=!0,this.isHorizontalPositionInvalidated=!0,this.eBodyViewport=e,this.resetLastHScrollDebounced=Hs(this,()=>this.lastScrollSource[1]=null,Hw),this.resetLastVScrollDebounced=Hs(this,()=>this.lastScrollSource[0]=null,Hw)}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.animationFrameSvc=e.animationFrameSvc,this.visibleCols=e.visibleCols}destroy(){super.destroy(),this.clearRetryListenerFncs=[],window.clearTimeout(this.scrollTimer)}postConstruct(){this.enableRtl=this.gos.get("enableRtl");let e=this.invalidateVerticalScroll.bind(this),t=this.invalidateHorizontalScroll.bind(this);this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),gridSizeChanged:e,scrollGapChanged:t}),this.addManagedElementListeners(this.eBodyViewport,{scroll:e}),this.ctrlsSvc.whenReady(this,i=>{this.centerRowsCtrl=i.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}invalidateHorizontalScroll(){this.isHorizontalPositionInvalidated=!0}invalidateVerticalScroll(){this.isVerticalPositionInvalidated=!0}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.eViewport,{scroll:this.onHScroll.bind(this,Ya)});for(let e of Vw){let t=this.ctrlsSvc.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){let e=this.ctrlsSvc.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),i=t?Hs(this,this.onVScroll.bind(this,Ya),cE):this.onVScroll.bind(this,Ya),s=t?Hs(this,this.onVScroll.bind(this,lE),cE):this.onVScroll.bind(this,lE);this.addManagedElementListeners(this.eBodyViewport,{scroll:i}),this.registerScrollPartner(e,s)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){this.centerRowsCtrl!=null&&(e===void 0&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(let t of[...Vw,Ya]){if(this.lastScrollSource[1]===t)continue;let i=this.getViewportForSource(t);Jm(i,e,this.enableRtl)}}getViewportForSource(e){return e===Ya?this.centerRowsCtrl.eViewport:this.ctrlsSvc.get(e).eViewport}isControllingScroll(e,t){return this.lastScrollSource[t]==null?(t===0?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;let t=this.centerRowsCtrl.eViewport,{scrollLeft:i}=t;if(this.shouldBlockScrollUpdate(1,i,!0))return;let s=Qm(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(s),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;if(e===Ya?t=this.eBodyViewport.scrollTop:t=this.ctrlsSvc.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0))return;let{animationFrameSvc:i}=this;i?.setScrollTop(t),this.nextScrollTop=t,e===Ya?this.ctrlsSvc.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,i?.active?i.schedule():this.scrollGridIfNeeded(!0),this.resetLastVScrollDebounced()}doHorizontalScroll(e){let t=this.ctrlsSvc.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}isScrolling(){return this.isScrollActive}fireScrollEvent(e){let t={type:"bodyScroll",direction:e===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.isScrollActive=!0,this.eventSvc.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout(()=>{this.scrollTimer=0,this.isScrollActive=!1,this.eventSvc.dispatchEvent(ht(Se({},t),{type:"bodyScrollEnd"}))},Hw)}shouldBlockScrollUpdate(e,t,i=!1){return i&&!cc()?!1:e===0?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t)}shouldBlockVerticalScroll(e){let t=UC(this.eBodyViewport),{scrollHeight:i}=this.eBodyViewport;return e<0||e+t>i}shouldBlockHorizontalScroll(e){let t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:i}=this.centerRowsCtrl.eViewport;if(this.enableRtl){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>i}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){let e=this.scrollLeft,t=!1;for(let i of Vw)if(this.getViewportForSource(i).scrollLeft!==e){t=!0;break}t&&this.onHScroll(Ya)}scrollGridIfNeeded(e=!1){let t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,e&&this.invalidateVerticalScroll(),this.redrawRowsAfterScroll()),t}setHorizontalScrollPosition(e,t=!1){let s=this.centerRowsCtrl.eViewport.scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(this.enableRtl?e=e>0?0:s:e=Math.min(Math.max(e,0),s)),Jm(this.centerRowsCtrl.eViewport,Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.invalidateVerticalScroll(),this.eBodyViewport.scrollTop=e}getVScrollPosition(){if(!this.isVerticalPositionInvalidated){let{lastOffsetHeight:i,lastScrollTop:s}=this;return{top:s,bottom:s+i}}this.isVerticalPositionInvalidated=!1;let{scrollTop:e,offsetHeight:t}=this.eBodyViewport;return this.lastScrollTop=e,this.lastOffsetHeight=t,{top:e,bottom:e+t}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.isHorizontalPositionInvalidated&&(this.lastIsHorizontalScrollShowing=this.centerRowsCtrl.isHorizontalScrollShowing(),this.isHorizontalPositionInvalidated=!1),this.lastIsHorizontalScrollShowing}scrollHorizontally(e){let t=this.centerRowsCtrl.eViewport.scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.eViewport.scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){let{rowModel:i}=this.beans,s=i.getRowCount(),n=-1;for(let o=0;o<s;o++){let l=i.getRow(o);if(typeof e=="function"){if(l&&e(l)){n=o;break}}else if(e===l||e===l.data){n=o;break}}n>=0&&this.ensureIndexVisible(n,t)}ensureIndexVisible(e,t,i=0){if(Gs(this.gos,"print"))return;let{rowModel:s}=this.beans,n=s.getRowCount();if(typeof e!="number"||e<0||e>=n){je(88,{index:e});return}this.clearRetryListeners();let{frameworkOverrides:o,pageBounds:l,rowContainerHeight:d,rowRenderer:p}=this.beans;o.wrapIncoming(()=>{let y=this.ctrlsSvc.getGridBodyCtrl(),C=s.getRow(e),S,P,I=0;this.invalidateVerticalScroll();do{let{stickyTopHeight:O,stickyBottomHeight:V}=y,G=C.rowTop,X=C.rowHeight,Q=l.getPixelOffset(),ae=C.rowTop-Q,me=ae+C.rowHeight,fe=this.getVScrollPosition(),_e=d.divStretchOffset,Ae=fe.top+_e,Oe=fe.bottom+_e,Ge=Oe-Ae,it=d.getScrollPositionForPixel(ae),Xe=d.getScrollPositionForPixel(me-Ge),lt=Math.min((it+Xe)/2,ae),St=Ae+O>ae,Gt=Oe-V<me,xt=null;t==="top"?xt=it-O:t==="bottom"?xt=Xe+V:t==="middle"?xt=lt:St?xt=it-O:Gt&&(Xe-it>Ge?xt=it-O:xt=Xe+V),xt!==null&&(this.setVerticalScrollPosition(xt),p.redraw({afterScroll:!0})),S=G!==C.rowTop||X!==C.rowHeight,P=O!==y.stickyTopHeight||V!==y.stickyBottomHeight,I++}while((S||P)&&I<10);if(this.animationFrameSvc?.flushAllFrames(),i<10&&(C?.stub||!this.beans.rowAutoHeight?.areRowsMeasured())){let O=this.getVScrollPosition().top;this.clearRetryListenerFncs=this.addManagedEventListeners({bodyScroll:()=>{let V=this.getVScrollPosition().top;O!==V&&this.clearRetryListeners()},modelUpdated:()=>{this.clearRetryListeners(),!(e>=s.getRowCount())&&this.ensureIndexVisible(e,t,i+1)}})}})}clearRetryListeners(){this.clearRetryListenerFncs.forEach(e=>e()),this.clearRetryListenerFncs=[]}ensureColumnVisible(e,t="auto"){let{colModel:i,frameworkOverrides:s}=this.beans,n=i.getCol(e);if(!n||n.isPinned()||!this.visibleCols.isColDisplayed(n))return;let o=this.getPositionedHorizontalScroll(n,t);s.wrapIncoming(()=>{o!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(o),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameSvc?.flushAllFrames()})}getPositionedHorizontalScroll(e,t){let{columnBeforeStart:i,columnAfterEnd:s}=this.isColumnOutsideViewport(e),n=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),o=this.centerRowsCtrl.getCenterWidth(),l=this.enableRtl,d=(l?i:s)||n,p=l?s:i;t!=="auto"&&(d=t==="start",p=t==="end");let y=t==="middle";if(d||p||y){let{colLeft:C,colMiddle:S,colRight:P}=this.getColumnBounds(e);return y?S-o/2:d?l?P:C:l?C-o:P-o}return null}isColumnOutsideViewport(e){let{start:t,end:i}=this.getViewportBounds(),{colLeft:s,colRight:n}=this.getColumnBounds(e),o=this.enableRtl,l=o?t>n:i<n,d=o?i<s:t>s;return{columnBeforeStart:l,columnAfterEnd:d}}getColumnBounds(e){let t=this.enableRtl,i=this.visibleCols.bodyWidth,s=e.getActualWidth(),n=e.getLeft(),o=t?-1:1,l=t?i-n:n,d=l+s*o,p=l+s/2*o;return{colLeft:l,colMiddle:p,colRight:d}}getViewportBounds(){let e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft(),i=t,s=e+t;return{start:i,end:s,width:e}}},ub=class extends Be{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){let e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){let e=Gs(this.gos,"print"),{visibleCols:t,scrollVisibleSvc:i}=this.beans,s=t.bodyWidth,n=t.getColsLeftWidth(),o=t.getDisplayedColumnsRightWidth(),l;e?l=s+n+o:(l=s,this.addSpacer&&(this.gos.get("enableRtl")?n:o)===0&&i.verticalScrollShowing&&(l+=i.getScrollbarWidth())),this.callback(l)}},vV=class extends Be{constructor(e){super(),this.centerContainerCtrl=e}wireBeans(e){this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){let{beans:e,centerContainerCtrl:t,gridBodyCtrl:i}=this,s=()=>{sa(e,()=>{this.onCenterViewportResized()})};t.registerViewportResizeListener(s),i.registerBodyViewportResizeListener(s)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleSvc.updateScrollGap(),this.centerContainerCtrl.isViewportInTheDOMTree()){let{pinnedCols:e,colFlex:t}=this.beans;e?.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();let i=this.centerContainerCtrl.getCenterWidth();i!==this.centerWidth&&(this.centerWidth=i,t?.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.scrollFeature.checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){let e=this.gridBodyCtrl.eBodyViewport,t=UC(e);this.bodyHeight!==t&&(this.bodyHeight=t,this.eventSvc.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){if(!this.isAlive())return;let e={horizontalScrollShowing:this.centerContainerCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleSvc.setScrollsVisible(e)}onHorizontalViewportChanged(){let e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.beans.colViewport.setScrollPosition(e,t)}};function Um(e,t,i,s){let n=t.getColDef().cellRendererParams?.suppressMouseEventHandling;return RM(e,t,i,s,n)}function yV(e,t,i,s){let n=t?.suppressMouseEventHandling;return RM(e,void 0,i,s,n)}function RM(e,t,i,s,n){return n?n(bt(e,{column:t,node:i,event:s})):!1}function EM(e,t,i){let s=t;for(;s;){let n=EP(e,s,i);if(n)return n;s=s.parentElement}return null}var hv="cellCtrl";function db(e,t){return EM(e,t,hv)}var uv="renderedRow";function wV(e,t){return EM(e,t,uv)}function EC(e,t,i,s,n){let o=s?s.getColDef().suppressKeyboardEvent:void 0;if(!o)return!1;let l=bt(e,{event:t,editing:n,column:s,node:i,data:i.data,colDef:s.getColDef()});return!!(o&&o(l))}function CV(e){let{pinnedRowModel:t,rowModel:i}=e,[s,n]=[t?.isEmpty("top")??!0,t?.isEmpty("bottom")??!0],o=s?null:"top",l,d;n?(l=null,d=i.getRowCount()-1):(l="bottom",d=t?.getPinnedBottomRowCount()??-1);let{visibleCols:p,rangeSvc:y}=e,C=p.allCols;!y||!C?.length||y.setCellRange({rowStartIndex:0,rowStartPinned:o,rowEndIndex:d,rowEndPinned:l})}var bV=65,xV=67,_V=86,SV=68,RV=90,EV=89;function PV(e){let{keyCode:t}=e,i;switch(t){case bV:i=Fe.A;break;case xV:i=Fe.C;break;case _V:i=Fe.V;break;case SV:i=Fe.D;break;case RV:i=Fe.Z;break;case EV:i=Fe.Y;break;default:i=e.code}return i}var MV=class extends Be{constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.beans.touchSvc?.mockRowContextMenu(this),this.editSvc=this.beans.editSvc}addKeyboardListeners(){let e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",fP("touchstart")?"touchstart":"mousedown"].forEach(i=>{let s=this.processMouseEvent.bind(this,i);this.addManagedElementListeners(this.element,{[i]:s})})}processMouseEvent(e,t){if(!Zp(this.beans,t)||ea(t))return;let{cellCtrl:i,rowCtrl:s}=this.getControlsForEventTarget(t.target);e==="contextmenu"?(i?.column&&i.dispatchCellContextMenuEvent(t),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(t,void 0,s,i)):(i&&i.onMouseEvent(e,t),s&&s.onMouseEvent(e,t))}getControlsForEventTarget(e){let{gos:t}=this;return{cellCtrl:db(t,e),rowCtrl:wV(t,e)}}processKeyboardEvent(e,t){let{cellCtrl:i,rowCtrl:s}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(i?this.processCellKeyboardEvent(i,e,t):s?.isFullWidth()&&this.processFullWidthRowKeyboardEvent(s,e,t))}processCellKeyboardEvent(e,t,i){let s=this.editSvc?.isEditing(e,{withOpenEditor:!0})??!1;!EC(this.gos,i,e.rowNode,e.column,s)&&t==="keydown"&&(!s&&this.beans.navigation?.handlePageScrollingKey(i)||e.onKeyDown(i),this.doGridOperations(i,s),nM(i)&&e.processCharacter(i)),t==="keydown"&&this.eventSvc.dispatchEvent(e.createEvent(i,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,i){let{rowNode:s}=e,{focusSvc:n,navigation:o}=this.beans,d=n.getFocusedCell()?.column;if(!EC(this.gos,i,s,d,!1)){let y=i.key;if(t==="keydown")switch(y){case Fe.PAGE_HOME:case Fe.PAGE_END:case Fe.PAGE_UP:case Fe.PAGE_DOWN:o?.handlePageScrollingKey(i,!0);break;case Fe.LEFT:case Fe.RIGHT:if(!this.gos.get("embedFullWidthRows"))break;case Fe.UP:case Fe.DOWN:e.onKeyboardNavigate(i);break;case Fe.TAB:e.onTabKeyDown(i);break;default:}}t==="keydown"&&this.eventSvc.dispatchEvent(e.createRowEvent("cellKeyDown",i))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!Zp(this.beans,e))return;let i=PV(e),{clipboardSvc:s,undoRedo:n}=this.beans;if(i===Fe.A)return this.onCtrlAndA(e);if(i===Fe.C)return this.onCtrlAndC(s,e);if(i===Fe.D)return this.onCtrlAndD(s,e);if(i===Fe.V)return this.onCtrlAndV(s,e);if(i===Fe.X)return this.onCtrlAndX(s,e);if(i===Fe.Y)return this.onCtrlAndY(n);if(i===Fe.Z)return this.onCtrlAndZ(n,e)}onCtrlAndA(e){let{beans:{rowModel:t,rangeSvc:i,selectionSvc:s},gos:n}=this;i&&ta(n)&&t.isRowsToRender()?CV(this.beans):s&&s?.selectAllRowNodes({source:"keyboardSelectAll",selectAll:IP(n)}),e.preventDefault()}onCtrlAndC(e,t){if(!e||this.gos.get("enableCellTextSelection"))return;let{cellCtrl:i}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||(t.preventDefault(),e.copyToClipboard())}onCtrlAndX(e,t){if(!e||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;let{cellCtrl:i}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||(t.preventDefault(),e.cutToClipboard(void 0,"ui"))}onCtrlAndV(e,t){let{cellCtrl:i}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(i,{withOpenEditor:!0})||e&&!this.gos.get("suppressClipboardPaste")&&e.pasteFromClipboard()}onCtrlAndD(e,t){e&&!this.gos.get("suppressClipboardPaste")&&e.copyRangeDown(),t.preventDefault()}onCtrlAndZ(e,t){!this.gos.get("undoRedoCellEditing")||!e||(t.preventDefault(),t.shiftKey?e.redo("ui"):e.undo("ui"))}onCtrlAndY(e){e?.redo("ui")}},PM=class extends Be{constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this,this.beans.rowContainerHeight)})}onHeightChanged(e){let t=e.uiContainerHeight,i=t!=null?`${t}px`:"";this.eContainer.style.height=i,this.eViewport&&(this.eViewport.style.height=i)}},km=e=>e.topRowCtrls,Am=e=>e.getStickyTopRowCtrls(),Lm=e=>e.getStickyBottomRowCtrls(),Om=e=>e.bottomRowCtrls,zm=e=>e.allRowCtrls,Nw=e=>e.getCtrls("top"),Gw=e=>e.getCtrls("center"),Ww=e=>e.getCtrls("bottom"),TV={center:{type:"center",name:"center-cols",getRowCtrls:zm,getSpannedRowCtrls:Gw},left:{type:"left",name:"pinned-left-cols",pinnedType:"left",getRowCtrls:zm,getSpannedRowCtrls:Gw},right:{type:"right",name:"pinned-right-cols",pinnedType:"right",getRowCtrls:zm,getSpannedRowCtrls:Gw},fullWidth:{type:"fullWidth",name:"full-width",fullWidth:!0,getRowCtrls:zm},topCenter:{type:"center",name:"floating-top",getRowCtrls:km,getSpannedRowCtrls:Nw},topLeft:{type:"left",name:"pinned-left-floating",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:km,getSpannedRowCtrls:Nw},topRight:{type:"right",name:"pinned-right-floating",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:km,getSpannedRowCtrls:Nw},topFullWidth:{type:"fullWidth",name:"floating-top-full-width",fullWidth:!0,getRowCtrls:km},stickyTopCenter:{type:"center",name:"sticky-top",getRowCtrls:Am},stickyTopLeft:{type:"left",name:"pinned-left-sticky-top",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:Am},stickyTopRight:{type:"right",name:"pinned-right-sticky-top",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:Am},stickyTopFullWidth:{type:"fullWidth",name:"sticky-top-full-width",fullWidth:!0,getRowCtrls:Am},stickyBottomCenter:{type:"center",name:"sticky-bottom",getRowCtrls:Lm},stickyBottomLeft:{type:"left",name:"pinned-left-sticky-bottom",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:Lm},stickyBottomRight:{type:"right",name:"pinned-right-sticky-bottom",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:Lm},stickyBottomFullWidth:{type:"fullWidth",name:"sticky-bottom-full-width",fullWidth:!0,getRowCtrls:Lm},bottomCenter:{type:"center",name:"floating-bottom",getRowCtrls:Om,getSpannedRowCtrls:Ww},bottomLeft:{type:"left",name:"pinned-left-floating-bottom",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:Om,getSpannedRowCtrls:Ww},bottomRight:{type:"right",name:"pinned-right-floating-bottom",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:Om,getSpannedRowCtrls:Ww},bottomFullWidth:{type:"fullWidth",name:"floating-bottom-full-width",fullWidth:!0,getRowCtrls:Om}};function MM(e){return`ag-${lg(e).name}-viewport`}function jm(e){let t=lg(e);return t.container??`ag-${t.name}-container`}function DV(e){return`ag-${lg(e).name}-spanned-cells-container`}function lg(e){return TV[e]}var FV=["topCenter","topLeft","topRight"],IV=["bottomCenter","bottomLeft","bottomRight"],kV=["center","left","right"],AV=["center","left","right","fullWidth"],LV=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],OV=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],zV=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],TM=["stickyTopCenter","stickyTopLeft","stickyTopRight"],DM=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],BV=[...TM,"stickyTopFullWidth",...DM,"stickyBottomFullWidth"],VV=[...FV,...IV,...kV,...TM,...DM],HV=class extends Be{constructor(e){super(),this.name=e,this.visible=!0,this.EMPTY_CTRLS=[],this.options=lg(e)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new vV(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.beans.ctrlsSvc.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}setComp(e,t,i,s){this.comp=e,this.eContainer=t,this.eSpannedContainer=i,this.eViewport=s,this.createManagedBean(new MV(this.eViewport??this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();let{pinnedCols:n,rangeSvc:o}=this.beans,l=()=>this.onPinnedWidthChanged();this.forContainers(OV,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(n?.createPinnedWidthFeature(!0,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:l})}),this.forContainers(zV,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(n?.createPinnedWidthFeature(!1,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:l})}),this.forContainers(AV,()=>this.createManagedBean(new PM(this.eContainer,this.name==="center"?s:void 0))),o&&this.forContainers(VV,()=>this.createManagedBean(o.createDragListenerFeature(this.eContainer))),this.forContainers(LV,()=>this.createManagedBean(new ub(d=>this.comp.setContainerWidth(`${d}px`)))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}addListeners(){let{spannedRowRenderer:e,gos:t}=this.beans,i=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({displayedColumnsChanged:i,displayedColumnsWidthChanged:i,displayedRowsChanged:s=>this.onDisplayedRowsChanged(s.afterScroll)}),i(),this.onDisplayedRowsChanged(),e&&this.options.getSpannedRowCtrls&&t.get("enableCellSpan")&&this.addManagedListeners(e,{spannedRowsUpdated:()=>{let s=this.options.getSpannedRowCtrls(e);s&&this.comp.setSpannedRowCtrls(s,!1)}})}listenOnDomOrder(){if(BV.indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}let t=()=>{let i=this.gos.get("ensureDomOrder"),s=Gs(this.gos,"print");this.comp.setDomOrder(i||s)};this.addManagedPropertyListener("domLayout",t),t()}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){let{dragSvc:e}=this.beans;if(!e)return;let t=i=>{e.dragging&&i.cancelable&&i.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",t))}onHorizontalViewportChanged(e=!1){let t=this.getCenterWidth(),i=this.getCenterViewportScrollLeft();this.beans.colViewport.setScrollPosition(t,i,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return qp(this.eViewport)}getCenterViewportScrollLeft(){return Qm(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){let t=nl(this.beans,this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportInTheDOMTree(){return hP(this.eViewport)}getViewportScrollLeft(){return Qm(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||$C(this.eViewport)}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){Jm(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(this.options.pinnedType!=null)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){let e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(e=!1){let t=this.options.getRowCtrls(this.beans.rowRenderer);if(!this.visible||t.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}let i=Gs(this.gos,"print"),n=this.gos.get("embedFullWidthRows")||i,o=t.filter(l=>{let d=l.isFullWidth();return this.options.fullWidth?!n&&d:n||!d});this.comp.setRowCtrls({rowCtrls:o,useFlushSync:e})}},FM="ag-force-vertical-scroll",NV="ag-selectable",GV="ag-column-moving",WV=class extends Be{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colModel=e.colModel,this.scrollVisibleSvc=e.scrollVisibleSvc,this.pinnedRowModel=e.pinnedRowModel,this.filterManager=e.filterManager,this.rowGroupColsSvc=e.rowGroupColsSvc}setComp(e,t,i,s,n,o,l){this.comp=e,this.eGridBody=t,this.eBodyViewport=i,this.eTop=s,this.eBottom=n,this.eStickyTop=o,this.eStickyBottom=l,this.eCenterColsViewport=i.querySelector(`.${MM("center")}`),this.eFullWidthContainer=i.querySelector(`.${jm("fullWidth")}`),this.eStickyTopFullWidthContainer=o.querySelector(`.${jm("stickyTopFullWidth")}`),this.eStickyBottomFullWidthContainer=l.querySelector(`.${jm("stickyBottomFullWidth")}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",d=>this.setCellTextSelection(d.currentValue)),this.createManagedBean(new hb(this.comp)),this.scrollFeature=this.createManagedBean(new mV(i)),this.beans.rowDragSvc?.setupRowDrag(i,this),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([s,i,n,o,l]),this.setGridRootRole(),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),this.filterManager?.setupAdvFilterHeaderComp(s),this.ctrlsSvc.register("gridBodyCtrl",this)}addEventListeners(){let e=this.setFloatingHeights.bind(this),t=this.setGridRootRole.bind(this),i=this.toggleRowResizeStyles.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.updateScrollingClasses.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,pinnedRowsChanged:e,headerHeightChanged:this.setStickyTopOffsetTop.bind(this),columnRowGroupChanged:t,columnPivotChanged:t,rowResizeStarted:i,rowResizeEnded:i}),this.addManagedPropertyListener("treeData",t)}toggleRowResizeStyles(e){let t=e.type==="rowResizeStarted";this.eBodyViewport.classList.toggle("ag-prevent-animation",t)}onGridColumnsChanged(){let e=this.beans.colModel.getCols();this.comp.setColumnCount(e.length)}onScrollVisibilityChanged(){let{scrollVisibleSvc:e}=this,t=e.verticalScrollShowing;this.setVerticalScrollPaddingVisible(t),this.setStickyWidth(t),this.setStickyBottomOffsetBottom();let i=t&&e.getScrollbarWidth()||0,s=oM()?16:0,n=`calc(100% + ${i+s}px)`;sa(this.beans,()=>this.comp.setBodyViewportWidth(n)),this.updateScrollingClasses()}setGridRootRole(){let{rowGroupColsSvc:e,colModel:t}=this,i=this.gos.get("treeData");if(!i){let s=t.isPivotMode();i=(e?e.columns.length:0)>=(s?2:1)}this.comp.setGridRootRole(i?"treegrid":"grid")}addFocusListeners(e){e.forEach(t=>{this.addManagedElementListeners(t,{focusin:i=>{let{target:s}=i,n=rc(s,"ag-root",t);t.classList.toggle("ag-has-focus",!n)},focusout:i=>{let{target:s,relatedTarget:n}=i,o=t.contains(n),l=rc(n,"ag-root",t);rc(s,"ag-root",t)||(!o||l)&&t.classList.remove("ag-has-focus")}})})}setColumnMovingCss(e){this.comp.setColumnMovingCss(GV,e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss(NV,e)}updateScrollingClasses(){let{eGridBody:{classList:e},scrollVisibleSvc:t}=this;e.toggle("ag-body-vertical-content-no-gap",!t.verticalScrollGap),e.toggle("ag-body-horizontal-content-no-gap",!t.horizontalScrollGap)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){this.beans.editSvc?.addStopEditingWhenGridLosesFocus([this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom])}updateRowCount(){let e=(this.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.filterManager?.getHeaderRowCount()??0),{rowModel:t}=this.beans,i=t.isLastRowIndexKnown()?t.getRowCount():-1,s=i===-1?-1:e+i;this.comp.setRowCount(s)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){let t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){let e=this.gos.get("alwaysShowVerticalScroll"),t=e?FM:null,i=Gs(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||i&&pP(this.eBodyViewport)}setupRowAnimationCssClass(){let{rowContainerHeight:e,environment:t}=this.beans,i=t.sizesMeasured,s=()=>{let n=i&&vu(this.gos)&&!e.stretching,o=n?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(o,n)};s(),this.addManagedEventListeners({heightScaleChanged:s}),this.addManagedPropertyListener("animateRows",s),this.addManagedEventListeners({gridStylesChanged:()=>{!i&&t.sizesMeasured&&(i=!0,s())}})}addBodyViewportListener(){let{eBodyViewport:e,eStickyTop:t,eStickyBottom:i,eTop:s,eBottom:n,beans:{popupSvc:o,touchSvc:l}}=this,d=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(e,{contextmenu:d}),l?.mockBodyContextMenu(this,d),this.addManagedElementListeners(e,{wheel:this.onBodyViewportWheel.bind(this,o)});let p=this.onStickyWheel.bind(this);for(let C of[t,i,s,n])this.addManagedElementListeners(C,{wheel:p});let y=this.onHorizontalWheel.bind(this);for(let C of["left","right","topLeft","topRight","bottomLeft","bottomRight"])this.addManagedElementListeners(this.ctrlsSvc.get(C).eContainer,{wheel:y});this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){let{deltaX:t,deltaY:i,shiftKey:s}=e;(s||Math.abs(t)>Math.abs(i))&&Zp(this.beans,e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){let{deltaY:t}=e;this.scrollVertically(t)>0&&e.preventDefault()}onHorizontalWheel(e){let{deltaX:t,deltaY:i,shiftKey:s}=e;(s||Math.abs(t)>Math.abs(i))&&this.scrollGridBodyToMatchEvent(e)}scrollGridBodyToMatchEvent(e){let{deltaX:t,deltaY:i}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||i})}onBodyViewportContextMenu(e,t,i){if(!e&&!i)return;this.gos.get("preventDefaultOnContextMenu")&&(e||i).preventDefault();let{target:s}=e||t;(s===this.eBodyViewport||s===this.ctrlsSvc.get("center").eViewport)&&this.beans.contextMenuSvc?.showContextMenu({mouseEvent:e,touchEvent:i,value:null,anchorToElement:this.eGridBody,source:"ui"})}onBodyViewportWheel(e,t){this.gos.get("suppressScrollWhenPopupsAreOpen")&&e?.hasAnchoredPopup()&&t.preventDefault()}scrollVertically(e){let t=this.eBodyViewport.scrollTop;return this.scrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}setFloatingHeights(){let{pinnedRowModel:e,beans:{environment:t}}=this,i=e?.getPinnedTopTotalHeight(),s=e?.getPinnedBottomTotalHeight(),n=t.getPinnedRowBorderWidth(),o=t.getRowBorderWidth(),l=n-o,d=i?l+i:0,p=s?l+s:0;this.comp.setTopHeight(d),this.comp.setBottomHeight(p),this.comp.setTopInvisible(d<=0),this.comp.setBottomInvisible(p<=0),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}setStickyWidth(e){if(!e)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{let t=this.scrollVisibleSvc.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}}setStickyTopOffsetTop(){let t=this.ctrlsSvc.get("gridHeaderCtrl").headerHeight+(this.filterManager?.getHeaderHeight()??0),i=this.pinnedRowModel?.getPinnedTopTotalHeight()??0,s=0;t>0&&(s+=t),i>0&&(s+=i),s>0&&(s+=1),this.comp.setStickyTopTop(`${s}px`)}setStickyBottomOffsetBottom(){let{pinnedRowModel:e,scrollVisibleSvc:t,comp:i}=this,s=e?.getPinnedBottomTotalHeight()??0,o=t.horizontalScrollShowing&&t.getScrollbarWidth()||0,l=s+o;i.setStickyBottomBottom(`${l}px`)}};function UV(e,t){return db(e,t.target)?.getFocusedCellPosition()??null}function hE(e,t){let i=Gs(e.gos,"normal"),s=t,n,o;s.clientX!=null||s.clientY!=null?(n=s.clientX,o=s.clientY):(n=s.x,o=s.y);let{pageFirstPixel:l}=e.pageBounds.getCurrentPagePixelRange();if(o+=l,i){let d=e.ctrlsSvc.getScrollFeature(),p=d.getVScrollPosition(),y=d.getHScrollPosition();n+=y.left,o+=p.top}return{x:n,y:o}}var IM=class extends ii{constructor(e,t){super(),this.direction=t,this.eViewport=ot,this.eContainer=ot,this.hideTimeout=0,this.setTemplate(e)}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.toggleCss("ag-apple-scrollbar",iM()||cc())}destroy(){super.destroy(),window.clearTimeout(this.hideTimeout)}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=oM(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){let e=this.getGui(),t=()=>this.toggleCss("ag-scrollbar-active",!0),i=()=>this.toggleCss("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:i,touchend:i})}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),sa(this.beans,()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=0),this.toggleCss("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.toggleCss("ag-scrollbar-scrolling",!1),this.hideTimeout=0},400)}})}attemptSettingScrollPosition(e){let t=this.eViewport;nB(this,()=>ur(t),()=>this.setScrollPosition(e),100)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}},jV={tag:"div",cls:"ag-body-horizontal-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eLeftSpacer",cls:"ag-horizontal-left-spacer"},{tag:"div",ref:"eViewport",cls:"ag-body-horizontal-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-horizontal-scroll-container"}]},{tag:"div",ref:"eRightSpacer",cls:"ag-horizontal-right-spacer"}]},$V=class extends IM{constructor(){super(jV,"horizontal"),this.eLeftSpacer=ot,this.eRightSpacer=ot,this.setScrollVisibleDebounce=0}wireBeans(e){this.visibleCols=e.visibleCols,this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){super.postConstruct();let e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.refreshCompBottom.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.beans.ctrlsSvc.register("fakeHScrollComp",this),this.createManagedBean(new ub(t=>this.eContainer.style.width=`${t}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}destroy(){window.clearTimeout(this.setScrollVisibleDebounce),super.destroy()}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}refreshCompBottom(){if(!this.invisibleScrollbar)return;let e=this.beans.pinnedRowModel?.getPinnedBottomTotalHeight()??0;this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){let e=this.scrollVisibleSvc.verticalScrollShowing,t=this.visibleCols.getDisplayedColumnsRightWidth(),i=!this.enableRtl&&e,s=this.scrollVisibleSvc.getScrollbarWidth();i&&(t+=s),lr(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=s);let n=this.visibleCols.getColsLeftWidth();this.enableRtl&&e&&(n+=s),lr(this.eLeftSpacer,n),this.eLeftSpacer.classList.toggle("ag-scroller-corner",n<=s)}setScrollVisible(){let e=this.scrollVisibleSvc.horizontalScrollShowing,t=this.invisibleScrollbar,i=this.gos.get("suppressHorizontalScroll"),s=e&&this.scrollVisibleSvc.getScrollbarWidth()||0,o=i?0:s===0&&t?16:s,l=()=>{this.setScrollVisibleDebounce=0,this.toggleCss("ag-scrollbar-invisible",t),zp(this.getGui(),o),zp(this.eViewport,o),zp(this.eContainer,o),o||this.eContainer.style.setProperty("min-height","1px"),this.setVisible(e,{skipAriaHidden:!0})};window.clearTimeout(this.setScrollVisibleDebounce),e?this.setScrollVisibleDebounce=window.setTimeout(l,100):l()}getScrollPosition(){return Qm(this.eViewport,this.enableRtl)}setScrollPosition(e){ur(this.eViewport)||this.attemptSettingScrollPosition(e),Jm(this.eViewport,e,this.enableRtl)}},qV={selector:"AG-FAKE-HORIZONTAL-SCROLL",component:$V},ZV={tag:"div",cls:"ag-body-vertical-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eViewport",cls:"ag-body-vertical-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-vertical-scroll-container"}]}]},KV=class extends IM{constructor(){super(ZV,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new PM(this.eContainer));let{ctrlsSvc:e}=this.beans;e.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this,e)})}setScrollVisible(){let{scrollVisibleSvc:e}=this.beans,t=e.verticalScrollShowing,i=this.invisibleScrollbar,s=t&&e.getScrollbarWidth()||0,n=s===0&&i?16:s;this.toggleCss("ag-scrollbar-invisible",i),lr(this.getGui(),n),lr(this.eViewport,n),lr(this.eContainer,n),this.setDisplayed(t,{skipAriaHidden:!0})}onRowContainerHeightChanged(e){let i=e.getGridBodyCtrl().eBodyViewport,s=this.getScrollPosition(),n=i.scrollTop;s!=n&&this.setScrollPosition(n,!0)}getScrollPosition(){return this.eViewport.scrollTop}setScrollPosition(e,t){!t&&!ur(this.eViewport)&&this.attemptSettingScrollPosition(e),this.eViewport.scrollTop=e}},XV={selector:"AG-FAKE-VERTICAL-SCROLL",component:KV},YV="ag-column-first",QV="ag-column-last";function kM(e,t,i,s){return Di(e)?[]:eH(e.headerClass,e,t,i,s)}function AM(e,t,i){e.toggleCss(YV,i.isColAtEdge(t,"first")),e.toggleCss(QV,i.isColAtEdge(t,"last"))}function JV(e,t,i,s){return bt(t,{colDef:e,column:i,columnGroup:s})}function eH(e,t,i,s,n){if(Di(e))return[];let o;if(typeof e=="function"){let l=JV(t,i,s,n);o=e(l)}else o=e;return typeof o=="string"?[o]:Array.isArray(o)?[...o]:[]}function tH(e,t,i){t.addManagedElementListeners(i,{keydown:s=>{if(!s.defaultPrevented&&s.key===Fe.TAB){let n=s.shiftKey;Cc(e,i,!1,n)||Du(e,n)&&s.preventDefault()}}})}function iH(e,t){return e.ctrlsSvc.get("gridCtrl").focusInnerElement(t)}function hc(e){return e.gos.get("suppressHeaderFocus")||!!e.overlays?.isExclusive()}function _v(e){return e.gos.get("suppressCellFocus")||!!e.overlays?.isExclusive()}function Du(e,t,i=!1){let s=e.ctrlsSvc.get("gridCtrl");return!i&&s.focusNextInnerContainer(t)?!0:((i||!t&&!s.isDetailGrid())&&s.forceFocusOutOfContainer(t),!1)}function ar(e){return e.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0}function pb(e){let t=[],i=e.ctrlsSvc.getHeaderRowContainerCtrls();for(let s of i){if(!s)continue;let n=s.getGroupRowCount()||0;for(let o=0;o<n;o++){let l=s.getGroupRowCtrlAtIndex(o),d=t[o];if(l){let p=sH(e,l);(d==null||p>d)&&(t[o]=p)}}}return t}function sH(e,t){let s=e.colModel.isPivotMode()?nH(e):OM(e),n=t.getHeaderCellCtrls();for(let o of n){let{column:l}=o,d=l.getAutoHeaderHeight();d!=null&&d>s&&l.isAutoHeaderHeight()&&(s=d)}return s}function gb(e){let i=e.colModel.isPivotMode()?oH(e):cg(e);return e.colModel.forAllCols(s=>{let n=s.getAutoHeaderHeight();n!=null&&n>i&&s.isAutoHeaderHeight()&&(i=n)}),i}function cg(e){return e.gos.get("headerHeight")??e.environment.getDefaultHeaderHeight()}function LM(e){return e.gos.get("floatingFiltersHeight")??cg(e)}function OM(e){return e.gos.get("groupHeaderHeight")??cg(e)}function oH(e){return e.gos.get("pivotHeaderHeight")??cg(e)}function nH(e){return e.gos.get("pivotGroupHeaderHeight")??OM(e)}var rH=class extends Be{setComp(e,t,i){this.comp=e,this.eGui=t;let{beans:s}=this,{headerNavigation:n,touchSvc:o,ctrlsSvc:l}=s;n&&this.createManagedBean(new Au(i,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this,s),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this,s)}),this.onPivotModeChanged(s),this.setupHeaderHeight();let d=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:d}),o?.mockHeaderContextMenu(this,d),l.register("gridHeaderCtrl",this)}setupHeaderHeight(){let e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({headerRowsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>sa(this.beans,()=>e()),gridStylesChanged:e,advancedFilterEnabledChanged:e})}setHeaderHeight(){let{beans:e}=this,t=0,i=pb(e).reduce((o,l)=>o+l,0),s=gb(e);if(e.filterManager?.hasFloatingFilters()&&(t+=LM(e)),t+=i,t+=s,this.headerHeight===t)return;this.headerHeight=t;let n=`${t+1}px`;this.comp.setHeightAndMinHeight(n),this.eventSvc.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(e){let t=e.colModel.isPivotMode();this.comp.toggleCss("ag-pivot-on",t),this.comp.toggleCss("ag-pivot-off",!t)}onDisplayedColumnsChanged(e){let i=e.visibleCols.allCols.some(s=>s.isSpanHeaderHeight());this.comp.toggleCss("ag-header-allow-overflow",i)}onTabKeyDown(e){let t=this.gos.get("enableRtl"),i=e.shiftKey,s=i!==t?"LEFT":"RIGHT",{beans:n}=this,{headerNavigation:o,focusSvc:l}=n;(o.navigateHorizontally(s,!0,e)||!i&&l.focusOverlay(!1)||Du(n,i,!0))&&e.preventDefault()}handleKeyDown(e){let t=null,{headerNavigation:i}=this.beans;switch(e.key){case Fe.LEFT:t="LEFT";case Fe.RIGHT:{st(t)||(t="RIGHT"),i.navigateHorizontally(t,!1,e)&&e.preventDefault();break}case Fe.UP:t="UP";case Fe.DOWN:{st(t)||(t="DOWN"),i.navigateVertically(t,e)&&e.preventDefault();break}default:return}}onFocusOut(e){let{relatedTarget:t}=e,{eGui:i,beans:s}=this;!t&&i.contains(zi(s))||i.contains(t)||(s.focusSvc.focusedHeader=null)}onHeaderContextMenu(e,t,i){let{menuSvc:s,ctrlsSvc:n}=this.beans;if(!e&&!i||!s?.isHeaderContextMenuEnabled())return;let{target:o}=e??t;(o===this.eGui||o===n.getHeaderRowContainerCtrl()?.eViewport)&&s.showHeaderContextMenu(void 0,e,i)}},fb=class extends ii{constructor(e,t){super(e),this.ctrl=t}getCtrl(){return this.ctrl}},aH={tag:"div",cls:"ag-header-cell",role:"columnheader",children:[{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"},{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"}]},lH=class extends fb{constructor(e){super(aH,e),this.eResize=ot,this.eHeaderCompWrapper=ot,this.headerCompVersion=0}postConstruct(){let e=this.getGui(),t=()=>{let s=this.ctrl.getSelectAllGui();s&&(this.eResize.insertAdjacentElement("afterend",s),this.addDestroyFunc(()=>s.remove()))},i={setWidth:s=>e.style.width=s,toggleCss:(s,n)=>this.toggleCss(s,n),setUserStyles:s=>og(e,s),setAriaSort:s=>s?O4(e,s):z4(e),setUserCompDetails:s=>this.setUserCompDetails(s),getUserCompInstance:()=>this.headerComp,refreshSelectAllGui:t,removeSelectAllGui:()=>this.ctrl.getSelectAllGui()?.remove()};this.ctrl.setComp(i,this.getGui(),this.eResize,this.eHeaderCompWrapper,void 0),t()}destroy(){this.destroyHeaderComp(),super.destroy()}destroyHeaderComp(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(e){this.headerCompVersion++;let t=this.headerCompVersion;e.newAgStackInstance().then(i=>this.afterCompCreated(t,i))}afterCompCreated(e,t){if(e!=this.headerCompVersion||!this.isAlive()){this.destroyBean(t);return}this.destroyHeaderComp(),this.headerComp=t,this.headerCompGui=t.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())}},cH={tag:"div",cls:"ag-header-group-cell",role:"columnheader",children:[{tag:"div",ref:"eHeaderCompWrapper",cls:"ag-header-cell-comp-wrapper",role:"presentation"},{tag:"div",ref:"eResize",cls:"ag-header-cell-resize",role:"presentation"}]},hH=class extends fb{constructor(e){super(cH,e),this.eResize=ot,this.eHeaderCompWrapper=ot}postConstruct(){let e=this.getGui(),t=(s,n)=>n!=null?e.setAttribute(s,n):e.removeAttribute(s),i={toggleCss:(s,n)=>this.toggleCss(s,n),setUserStyles:s=>og(e,s),setHeaderWrapperHidden:s=>{s?this.eHeaderCompWrapper.style.setProperty("display","none"):this.eHeaderCompWrapper.style.removeProperty("display")},setHeaderWrapperMaxHeight:s=>{s!=null?this.eHeaderCompWrapper.style.setProperty("max-height",`${s}px`):this.eHeaderCompWrapper.style.removeProperty("max-height"),this.eHeaderCompWrapper.classList.toggle("ag-header-cell-comp-wrapper-limited-height",s!=null)},setResizableDisplayed:s=>Ti(this.eResize,s),setWidth:s=>e.style.width=s,setAriaExpanded:s=>t("aria-expanded",s),setUserCompDetails:s=>this.setUserCompDetails(s),getUserCompInstance:()=>this.headerGroupComp};this.ctrl.setComp(i,e,this.eResize,this.eHeaderCompWrapper,void 0)}setUserCompDetails(e){e.newAgStackInstance().then(t=>this.afterHeaderCompCreated(t))}afterHeaderCompCreated(e){let t=()=>this.destroyBean(e);if(!this.isAlive()){t();return}let i=this.getGui(),s=e.getGui();this.eHeaderCompWrapper.appendChild(s),this.addDestroyFunc(t),this.headerGroupComp=e,this.ctrl.setDragSource(i)}},uH={tag:"div",cls:"ag-header-cell ag-floating-filter",role:"gridcell",children:[{tag:"div",ref:"eFloatingFilterBody",role:"presentation"},{tag:"div",ref:"eButtonWrapper",cls:"ag-floating-filter-button ag-hidden",role:"presentation",children:[{tag:"button",ref:"eButtonShowMainFilter",cls:"ag-button ag-floating-filter-button-button",attrs:{type:"button",tabindex:"-1"}}]}]},dH=class extends fb{constructor(e){super(uH,e),this.eFloatingFilterBody=ot,this.eButtonWrapper=ot,this.eButtonShowMainFilter=ot}postConstruct(){let e=this.getGui(),t={toggleCss:(i,s)=>this.toggleCss(i,s),setUserStyles:i=>og(e,i),addOrRemoveBodyCssClass:(i,s)=>this.eFloatingFilterBody.classList.toggle(i,s),setButtonWrapperDisplayed:i=>Ti(this.eButtonWrapper,i),setCompDetails:i=>this.setCompDetails(i),getFloatingFilterComp:()=>this.compPromise,setWidth:i=>e.style.width=i,setMenuIcon:i=>this.eButtonShowMainFilter.appendChild(i)};this.ctrl.setComp(t,e,this.eButtonShowMainFilter,this.eFloatingFilterBody,void 0)}setCompDetails(e){if(!e){this.destroyFloatingFilterComp(),this.compPromise=null;return}this.compPromise=e.newAgStackInstance(),this.compPromise.then(t=>this.afterCompCreated(t))}destroy(){this.destroyFloatingFilterComp(),super.destroy()}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui()),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(e){if(e){if(!this.isAlive()){this.destroyBean(e);return}this.destroyFloatingFilterComp(),this.floatingFilterComp=e,this.eFloatingFilterBody.appendChild(e.getGui()),e.afterGuiAttached&&e.afterGuiAttached()}}},pH=class extends ii{constructor(e){super({tag:"div",cls:e.headerRowClass,role:"row"}),this.ctrl=e,this.headerComps={}}postConstruct(){this.getGui().setAttribute("tabindex",String(this.gos.get("tabIndex"))),Xm(this.getGui(),this.ctrl.getAriaRowIndex());let t={setHeight:i=>this.getGui().style.height=i,setTop:i=>this.getGui().style.top=i,setHeaderCtrls:(i,s)=>this.setHeaderCtrls(i,s),setWidth:i=>this.getGui().style.width=i,setRowIndex:i=>Xm(this.getGui(),i)};this.ctrl.setComp(t,void 0)}destroy(){this.setHeaderCtrls([],!1),super.destroy()}setHeaderCtrls(e,t){if(!this.isAlive())return;let i=this.headerComps;if(this.headerComps={},e.forEach(s=>{let n=s.instanceId,o=i[n];delete i[n],o==null&&(o=this.createHeaderComp(s),this.getGui().appendChild(o.getGui())),this.headerComps[n]=o}),Object.values(i).forEach(s=>{this.getGui().removeChild(s.getGui()),this.destroyBean(s)}),t){let s=Object.values(this.headerComps);s.sort((o,l)=>{let d=o.getCtrl().column.getLeft(),p=l.getCtrl().column.getLeft();return d-p});let n=s.map(o=>o.getGui());dP(this.getGui(),n)}}createHeaderComp(e){let t;switch(this.ctrl.type){case"group":t=new hH(e);break;case"filter":t=new dH(e);break;default:t=new lH(e);break}return this.createBean(t),t.setParentComponent(this),t}},mb=class extends Be{constructor(e,t,i,s){super(),this.columnOrGroup=e,this.eCell=t,this.colsSpanning=s,this.columnOrGroup=e,this.ariaEl=t.querySelector("[role=columnheader]")||t,this.beans=i}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){let{beans:e,colsSpanning:t}=this;return e.gos.get("enableRtl")&&t?di(t):this.columnOrGroup}postConstruct(){let e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){let{gos:e,colAnimation:t}=this.beans,i=e.get("suppressColumnMoveAnimation"),s=st(this.columnOrGroup.getOldLeft());t?.isActive()&&s&&!i?this.animateInLeft():this.onLeftChanged()}animateInLeft(){let e=this.getColumnOrGroup(),t=this.modifyLeftForPrintLayout(e,e.getOldLeft()),i=this.modifyLeftForPrintLayout(e,e.getLeft());this.setLeft(t),this.actualLeft=i,this.beans.colAnimation.executeNextVMTurn(()=>{this.actualLeft===i&&this.setLeft(i)})}onLeftChanged(){let e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){let{gos:i,visibleCols:s}=this.beans;if(!Gs(i,"print")||e.getPinned()==="left")return t;let o=s.getColsLeftWidth();if(e.getPinned()==="right"){let l=s.bodyWidth;return o+l+t}return o+t}setLeft(e){if(st(e)&&(this.eCell.style.left=`${e}px`),ns(this.columnOrGroup)){let t=this.columnOrGroup.getLeafColumns();if(!t.length)return;t.length>1&&L4(this.ariaEl,t.length)}}},gH=0,zM="headerCtrl",vb=class extends Be{constructor(e,t){super(),this.column=e,this.rowCtrl=t,this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.reAttemptToFocus=!1,this.instanceId=e.getUniqueId()+"-"+gH++}postConstruct(){let e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}setComp(e,t,i,s,n){t.setAttribute("col-id",this.column.colIdSanitised),this.wireComp(e,t,i,s,n),this.reAttemptToFocus&&(this.reAttemptToFocus=!1,this.focus(this.lastFocusEvent??void 0))}shouldStopEventPropagation(e){let{headerRowIndex:t,column:i}=this.beans.focusSvc.focusedHeader,s=i.getDefinition(),n=s&&s.suppressHeaderKeyboardEvent;if(!st(n))return!1;let o=bt(this.gos,{colDef:s,column:i,headerRowIndex:t,event:e});return!!n(o)}getWrapperHasFocus(){return zi(this.beans)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}refreshHeaderStyles(){let e=this.column.getDefinition();if(!e)return;let{headerStyle:t}=e,i;if(typeof t=="function"){let s=this.getHeaderClassParams();i=t(s)}else i=t;i&&this.comp.setUserStyles(i)}onGuiFocus(){this.eventSvc.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){let{wrapperElement:t,checkMeasuringCallback:i,compBean:s}=e,{beans:n}=this,o=S=>{if(!this.isAlive()||!s.isAlive())return;let{paddingTop:P,paddingBottom:I,borderBottomWidth:O,borderTopWidth:V}=yc(this.eGui),G=P+I+O+V,Q=t.offsetHeight+G;if(S<5){let ae=Vs(n),me=!ae||!ae.contains(t),fe=Q==0;if(me||fe){cC(()=>o(S+1),"raf",n);return}}this.setColHeaderHeight(this.column,Q)},l=!1,d,p=()=>{let S=this.column.isAutoHeaderHeight();S&&!l&&y(),!S&&l&&C()},y=()=>{l=!0,this.comp.toggleCss("ag-header-cell-auto-height",!0),o(0),d=nl(this.beans,t,()=>o(0))},C=()=>{l=!1,d&&d(),this.comp.toggleCss("ag-header-cell-auto-height",!1),d=void 0};p(),s.addDestroyFunc(()=>C()),s.addManagedListeners(this.column,{widthChanged:()=>l&&o(0)}),s.addManagedEventListeners({sortChanged:()=>{l&&window.setTimeout(()=>o(0))}}),i&&i(p)}onDisplayedColumnsChanged(){let{comp:e,column:t,beans:i,eGui:s}=this;!e||!t||!s||(AM(e,t,i.visibleCols),nP(s,i.visibleCols.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){let e=hc(this.beans);this.eGui&&zo(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){let t=zi(this.beans),i=e.key===Fe.LEFT||e.key===Fe.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey||((this.isResizing||i)&&(e.preventDefault(),e.stopImmediatePropagation()),!i))return;let n=e.key===Fe.LEFT!==this.gos.get("enableRtl")?"left":"right";if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;let o=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(o,e.shiftKey),this.resizeFeature?.toggleColumnResizing(!0)}else this.moveHeader(n)}moveHeader(e){this.beans.colMoves?.moveHeader(e,this.eGui,this.column,this.rowCtrl.pinned,this)}getViewportAdjustedResizeDiff(e){let t=this.getResizeDiff(e),{pinnedCols:i}=this.beans;return i?i.getHeaderResizeDiff(t,this.column):t}getResizeDiff(e){let{gos:t,column:i}=this,s=e.key===Fe.LEFT!==t.get("enableRtl"),n=i.getPinned(),o=t.get("enableRtl");return n&&o!==(n==="right")&&(s=!s),(s?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{this.resizeFeature?.toggleColumnResizing(!1)},150))}handleKeyDown(e){let t=this.getWrapperHasFocus();switch(e.key){case Fe.PAGE_DOWN:case Fe.PAGE_UP:case Fe.PAGE_HOME:case Fe.PAGE_END:t&&e.preventDefault()}}addDomData(e){let t=zM,{eGui:i,gos:s}=this;pc(s,i,t,this),e.addDestroyFunc(()=>pc(s,i,t,null))}focus(e){if(!this.isAlive())return!1;let{eGui:t}=this;return t?(t.focus(),this.lastFocusEvent=e||null):this.reAttemptToFocus=!0,!0}focusThis(){this.beans.focusSvc.focusedHeader={headerRowIndex:this.rowCtrl.rowIndex,column:this.column}}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop?.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,i){let s=e??t,{menuSvc:n,gos:o}=this.beans;o.get("preventDefaultOnContextMenu")&&s.preventDefault(),n?.isHeaderContextMenuEnabled(i)&&n.showHeaderContextMenu(i,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",i)}dispatchColumnMouseEvent(e,t){this.eventSvc.dispatchEvent({type:e,column:t})}setColHeaderHeight(e,t){if(!e.setAutoHeaderHeight(t))return;let{eventSvc:i}=this;e.isColumn?i.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"}):i.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.rowCtrl=null}},fH=class extends vb{constructor(){super(...arguments),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map}wireComp(e,t,i,s,n){this.comp=e;let{rowCtrl:o,column:l,beans:d}=this,{colResize:p,context:y,colHover:C,rangeSvc:S}=d,P=rg(this,y,n);this.setGui(t,P),this.updateState(),this.setupWidth(P),this.setupMovingCss(P),this.setupMenuClass(P),this.setupSortableClass(P),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:s,checkMeasuringCallback:O=>this.setRefreshFunction("measuring",O),compBean:P}),this.addColumnHoverListener(P),this.setupFilterClass(P),this.setupStylesFromColDef(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(P),this.setupSelectAll(P),this.setupUserComp(),this.refreshAria(),p?this.resizeFeature=P.createManagedBean(p.createResizeFeature(o.pinned,l,i,e,this)):Ti(i,!1),C?.createHoverFeature(P,[l],t),S?.createRangeHighlightFeature(P,l,e),P.createManagedBean(new mb(l,t,d)),P.createManagedBean(new Au(t,{shouldStopEventPropagation:O=>this.shouldStopEventPropagation(O),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(P),P.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader","enableAdvancedFilter"],()=>this.refresh()),P.addManagedListeners(l,{colDefChanged:()=>this.refresh()}),P.addManagedListeners(l,{headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});let I=()=>this.checkDisplayName();P.addManagedEventListeners({columnValueChanged:I,columnRowGroupChanged:I,columnPivotChanged:I,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),P.addDestroyFunc(()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()})}resizeHeader(e,t){this.beans.colResize?.resizeHeader(this.column,e,t)}getHeaderClassParams(){let{column:e,beans:t}=this,i=e.colDef;return bt(t.gos,{colDef:i,column:e,floatingFilter:!1})}setupUserComp(){let e=this.lookupUserCompDetails();e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){let e=this.createParams(),t=this.column.getColDef();return w5(this.beans.userCompFactory,t,e)}createParams(){let{menuSvc:e,sortSvc:t,colFilter:i,gos:s}=this.beans;return bt(s,{column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&!!e?.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!!i&&(!this.openFilterEnabled||Bo(this.gos)),showColumnMenu:(o,l)=>{e?.showColumnMenu({column:this.column,buttonElement:o,positionBy:"button",onClosedCallback:l})},showColumnMenuAfterMouseClick:(o,l)=>{e?.showColumnMenu({column:this.column,mouseEvent:o,positionBy:"mouse",onClosedCallback:l})},showFilter:o=>{e?.showFilterMenu({column:this.column,buttonElement:o,containerType:"columnFilter",positionBy:"button"})},progressSort:o=>{t?.progressSort(this.column,!!o,"uiColumnSorted")},setSort:(o,l)=>{t?.setSortForColumn(this.column,o,!!l,"uiColumnSorted")},eGridHeader:this.eGui,setTooltip:(o,l)=>{s.assertModuleRegistered("Tooltip",3),this.setupTooltip(o,l)}})}setupSelectAll(e){let{selectionSvc:t}=this.beans;t&&(this.selectAllFeature=e.createOptionalManagedBean(t.createSelectAllFeature(this.column)),this.selectAllFeature?.setComp(this),e.addManagedPropertyListener("rowSelection",()=>{let i=t.createSelectAllFeature(this.column);i&&!this.selectAllFeature?(this.selectAllFeature=e.createManagedBean(i),this.selectAllFeature?.setComp(this),this.comp.refreshSelectAllGui()):this.selectAllFeature&&!i&&(this.comp.removeSelectAllGui(),this.selectAllFeature=this.destroyBean(this.selectAllFeature))}))}getSelectAllGui(){return this.selectAllFeature?.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===Fe.SPACE&&this.selectAllFeature?.onSpaceKeyDown(e),e.key===Fe.ENTER&&this.onEnterKeyDown(e),e.key===Fe.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){e.ctrlKey||e.metaKey?this.showMenuOnKeyPress(e,!0):this.sortable&&this.beans.sortSvc?.progressSort(this.column,e.shiftKey,"uiColumnSorted")}showMenuOnKeyPress(e,t){let i=this.comp.getUserCompInstance();uE(i)&&i.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription()),W5()&&this.setActiveHeader(!0)}onFocusOut(e){this.eGui.contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderTooltip(this.tooltipFeature,this,e,t)}setupStylesFromColDef(){this.setRefreshFunction("headerStyles",this.refreshHeaderStyles.bind(this)),this.refreshHeaderStyles()}setupClassesFromColDef(){let e=()=>{let t=this.column.getColDef(),i=kM(t,this.gos,this.column,null),s=this.userHeaderClasses;this.userHeaderClasses=new Set(i),i.forEach(n=>{s.has(n)?s.delete(n):this.comp.toggleCss(n,!0)}),s.forEach(n=>this.comp.toggleCss(n,!1))};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){this.dragSourceElement=e,this.removeDragSource(),!(!e||!this.draggable)&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null)}updateState(){let{menuSvc:e}=this.beans;this.menuEnabled=!!e?.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=!!e?.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),Object.values(this.refreshFunctions).forEach(e=>e())}refreshHeaderComp(){let e=this.lookupUserCompDetails();if(!e)return;(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==e.componentClass?this.attemptHeaderCompRefresh(e.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){let t=this.comp.getUserCompInstance();return!t||!t.refresh?!1:t.refresh(e)}calculateDisplayName(){return this.beans.colNames.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){let e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){let t=()=>{let i=this.column.getActualWidth();this.comp.setWidth(`${i}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){let t=()=>{this.comp.toggleCss("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){let t=()=>{this.comp?.toggleCss("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){let t=()=>{this.comp.toggleCss("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){let t=()=>{let i=this.column.isFilterActive();this.comp.toggleCss("ag-header-cell-filtered",i),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){let e=()=>{let t=!!this.column.getColDef().wrapHeaderText;this.comp.toggleCss("ag-header-cell-wrap-text",t)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){let e=this.column.getHighlighted(),t=e===0,i=e===1;this.comp.toggleCss("ag-header-highlight-before",t),this.comp.toggleCss("ag-header-highlight-after",i)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){let{eGui:e,column:t,comp:i,beans:s}=this,n=pb(this.beans),o=n.reduce((P,I)=>P+=I,0)===0;if(i.toggleCss("ag-header-parent-hidden",o),!t.isSpanHeaderHeight()){e.style.removeProperty("top"),e.style.removeProperty("height"),i.toggleCss("ag-header-span-height",!1),i.toggleCss("ag-header-span-total",!1);return}let{numberOfParents:l,isSpanningTotal:d}=this.column.getColumnGroupPaddingInfo();i.toggleCss("ag-header-span-height",l>0);let p=gb(s);if(l===0){i.toggleCss("ag-header-span-total",!1),e.style.setProperty("top","0px"),e.style.setProperty("height",`${p}px`);return}i.toggleCss("ag-header-span-total",d);let y=(this.column.getFirstRealParent()?.getLevel()??-1)+1,C=n.length-y,S=0;for(let P=0;P<C;P++)S+=n[n.length-1-P];e.style.setProperty("top",`${-S}px`),e.style.setProperty("height",`${p+S}px`)}refreshAriaSort(){if(this.sortable){let e=this.getLocaleTextFunc(),t=this.beans.sortSvc?.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(_4(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){let e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!Bo(this.gos)){let e=this.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){let e=this.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){t!=null?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){if(!this.eGui.contains(zi(this.beans)))return;let e=Array.from(this.ariaDescriptionProperties.keys()).sort((t,i)=>t==="filter"?-1:i.charCodeAt(0)-t.charCodeAt(0)).map(t=>this.ariaDescriptionProperties.get(t)).join(". ");this.beans.ariaAnnounce?.announceValue(e,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(e){this.beans.colHover?.addHeaderColumnHoverListener(e,this.comp,this.column)}addActiveHeaderMouseListeners(e){let t=n=>this.handleMouseOverChange(n.type==="mouseenter"),i=()=>{this.setActiveHeader(!0),this.dispatchColumnMouseEvent("columnHeaderClicked",this.column)},s=n=>this.handleContextMenuMouseEvent(n,void 0,this.column);e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:i,contextmenu:s})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.toggleCss("ag-header-active",e)}getAnchorElementForMenu(e){let t=this.comp.getUserCompInstance();return uE(t)?t.getAnchorElementForMenu(e):this.eGui}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function uE(e){return typeof e?.getAnchorElementForMenu=="function"&&typeof e.onMenuKeyboardShortcut=="function"}var mH=0,Uw=class extends Be{constructor(e,t,i){super(),this.rowIndex=e,this.pinned=t,this.type=i,this.instanceId=mH++,this.comp=null,this.allCtrls=[];let s="ag-header-row-column";i==="group"?s="ag-header-row-group":i==="filter"&&(s="ag-header-row-filter"),this.headerRowClass=`ag-header-row ${s}`}setRowIndex(e){this.rowIndex=e,this.comp?.setRowIndex(this.getAriaRowIndex()),this.onRowHeightChanged()}postConstruct(){this.isPrintLayout=Gs(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return this.comp?this.allCtrls.every(e=>e.eGui!=null):!1}setComp(e,t,i=!0){this.comp=e,t=rg(this,this.beans.context,t),i&&(this.setRowIndex(this.rowIndex),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){let t=this.onRowHeightChanged.bind(this),i=this.onDisplayedColumnsChanged.bind(this);e.addManagedEventListeners({columnResized:this.setWidth.bind(this),displayedColumnsChanged:i,virtualColumnsChanged:s=>this.onVirtualColumnsChanged(s.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,gridStylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",i),e.addManagedPropertyListener("ensureDomOrder",s=>this.isEnsureDomOrder=s.currentValue),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}onDisplayedColumnsChanged(){this.isPrintLayout=Gs(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}setWidth(){if(!this.comp)return;let e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){let{visibleCols:e}=this.beans;return this.isPrintLayout?this.pinned!=null?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){if(!this.comp)return;let{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){let e=0,t=pb(this.beans);for(let n=0;n<t.length;n++){if(n===this.rowIndex&&this.type==="group")return{topOffset:e,rowHeight:t[n]};e+=t[n]}let i=gb(this.beans);if(this.type==="column")return{topOffset:e,rowHeight:i};e+=i;let s=LM(this.beans);return{topOffset:e,rowHeight:s}}onVirtualColumnsChanged(e=!1){if(!this.comp)return;let t=this.getUpdatedHeaderCtrls(),i=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,i,e)}getUpdatedHeaderCtrls(){let e=this.ctrlsById;this.ctrlsById=new Map;let t=this.getColumnsInViewport();for(let s of t)this.recycleAndCreateHeaderCtrls(s,this.ctrlsById,e);let i=s=>{let{focusSvc:n,visibleCols:o}=this.beans;return n.isHeaderWrapperFocused(s)?o.isVisible(s.column):!1};if(e)for(let[s,n]of e)i(n)?this.ctrlsById.set(s,n):this.destroyBean(n);return this.allCtrls=Array.from(this.ctrlsById.values()),this.allCtrls}getHeaderCellCtrls(){return this.allCtrls}recycleAndCreateHeaderCtrls(e,t,i){if(e.isEmptyGroup())return;let s=e.getUniqueId(),n;if(i&&(n=i.get(s),i.delete(s)),n&&n.column!=e&&(this.destroyBean(n),n=void 0),n==null)switch(this.type){case"filter":{n=this.createBean(this.beans.registry.createDynamicBean("headerFilterCellCtrl",!0,e,this));break}case"group":n=this.createBean(this.beans.registry.createDynamicBean("headerGroupCellCtrl",!0,e,this));break;default:n=this.createBean(new fH(e,this));break}t.set(s,n)}getColumnsInViewport(){if(!this.isPrintLayout)return this.getComponentsToRender();if(this.pinned)return[];let e=[];return["left",null,"right"].forEach(t=>{e.push(...this.getComponentsToRender(t))}),e}getComponentsToRender(e=this.pinned){return this.type==="group"?this.beans.colViewport.getHeadersToRender(e,this.rowIndex):this.beans.colViewport.getColumnHeadersToRender(e)}focusHeader(e,t){let i=this.allCtrls.find(n=>n.column==e);return i?i.focus(t):!1}destroy(){this.allCtrls=this.destroyBeans(this.allCtrls),this.ctrlsById=void 0,this.comp=null,super.destroy()}},vH=class extends Be{constructor(e){super(),this.pinned=e,this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[]}setComp(e,t){this.comp=e,this.eViewport=t;let{pinnedCols:i,ctrlsSvc:s,colModel:n,colMoves:o}=this.beans;this.setupCenterWidth(),i?.setupHeaderPinnedWidth(this),this.setupDragAndDrop(o,this.eViewport);let l=this.refresh.bind(this,!0);this.addManagedEventListeners({displayedColumnsChanged:l,advancedFilterEnabledChanged:l});let d=`${typeof this.pinned=="string"?this.pinned:"center"}Header`;s.register(d,this),n.ready&&this.refresh()}getAllCtrls(){let e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(e=!1){let{focusSvc:t,filterManager:i,visibleCols:s}=this.beans,n=0,o=t.getFocusHeaderToUseAfterRefresh(),l=()=>{let S=s.headerGroupRowCount;n=S;let P=this.groupsRowCtrls.length;if(P!==S){if(P>S){for(let I=S;I<P;I++)this.destroyBean(this.groupsRowCtrls[I]);this.groupsRowCtrls.length=S;return}for(let I=P;I<S;I++){let O=this.createBean(new Uw(I,this.pinned,"group"));this.groupsRowCtrls.push(O)}}},d=()=>{let S=n++;if(this.hidden){this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl);return}this.columnsRowCtrl==null||!e?(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.columnsRowCtrl=this.createBean(new Uw(S,this.pinned,"column"))):this.columnsRowCtrl.rowIndex!==S&&this.columnsRowCtrl.setRowIndex(S)},p=()=>{this.includeFloatingFilter=!!i?.hasFloatingFilters()&&!this.hidden;let S=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){S();return}e||S();let P=n++;this.filtersRowCtrl?this.filtersRowCtrl.rowIndex!==P&&this.filtersRowCtrl.setRowIndex(P):this.filtersRowCtrl=this.createBean(new Uw(P,this.pinned,"filter"))},y=this.getAllCtrls();l(),d(),p();let C=this.getAllCtrls();this.comp.setCtrls(C),this.restoreFocusOnHeader(t,o),y.length!==C.length&&this.beans.eventSvc.dispatchEvent({type:"headerRowsChanged"})}getHeaderCtrlForColumn(e){let t=i=>i?.getHeaderCellCtrls().find(s=>s.column===e);if(ol(e))return t(this.columnsRowCtrl);if(this.groupsRowCtrls.length!==0)for(let i=0;i<this.groupsRowCtrls.length;i++){let s=t(this.groupsRowCtrls[i]);if(s)return s}}getHtmlElementForColumnHeader(e){return this.getHeaderCtrlForColumn(e)?.eGui??null}getRowType(e){return this.getAllCtrls()[e]?.type}focusHeader(e,t,i){let n=this.getAllCtrls()[e];return n?n.focusHeader(t,i):!1}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}destroy(){this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl),this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls),super.destroy()}setupDragAndDrop(e,t){let i=e?.createBodyDropTarget(this.pinned,t);i&&this.createManagedBean(i)}restoreFocusOnHeader(e,t){if(!t)return;let{column:i}=t;i.getPinned()==this.pinned&&e.focusHeaderPosition({headerPosition:t})}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new ub(e=>this.comp.setCenterWidth(`${e}px`),!0))}},yH=class extends Be{constructor(){super(...arguments),this.beanName="menuSvc"}postConstruct(){let{enterpriseMenuFactory:e,filterMenuFactory:t}=this.beans;this.activeMenuFactory=e??t}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){this.showColumnMenuCommon(pE(this.beans),e,e.containerType,!0)}showHeaderContextMenu(e,t,i){this.activeMenuFactory?.showMenuAfterContextMenuEvent(e,t,i)}hidePopupMenu(){this.beans.contextMenuSvc?.hideActiveMenu(),this.activeMenuFactory?.hideActiveMenu()}hideFilterMenu(){pE(this.beans)?.hideActiveMenu()}isColumnMenuInHeaderEnabled(e){let{suppressHeaderMenuButton:t}=e.getColDef();return!t&&!!this.activeMenuFactory?.isMenuEnabled(e)&&(Bo(this.gos)||!!this.beans.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){return!e.getColDef().suppressHeaderFilterButton&&!!this.beans.filterManager?.isFilterAllowed(e)}isHeaderContextMenuEnabled(e){return!(e&&ol(e)?e.getColDef():e?.getColGroupDef())?.suppressHeaderContextMenu&&this.gos.get("columnMenu")==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){let e=!this.isSuppressMenuHide();return!(cc()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!Bo(this.gos)&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){return!!this.beans.filterManager?.isFilterAllowed(e)&&!Bo(this.gos)&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isFloatingFilterButtonEnabled(e){return!e.getColDef().suppressFloatingFilterButton}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){let e=this.gos,t=e.get("suppressMenuHide");return Bo(e)?e.exists("suppressMenuHide")?t:!1:t}showColumnMenuCommon(e,t,i,s){let{positionBy:n,onClosedCallback:o}=t,l=t.column;if(n==="button"){let{buttonElement:d}=t;e?.showMenuAfterButtonClick(l,d,i,o,s)}else if(n==="mouse"){let{mouseEvent:d}=t;e?.showMenuAfterMouseEvent(l,d,i,o,s)}else if(l){let d=this.beans,p=d.ctrlsSvc;p.getScrollFeature().ensureColumnVisible(l,"auto"),sa(d,()=>{let y=p.getHeaderRowContainerCtrl(l.getPinned())?.getHeaderCtrlForColumn(l);y&&e?.showMenuAfterButtonClick(l,y.getAnchorElementForMenu(s),i,o,s)})}}};function dE(e,t,i){e.menuVisible!==t&&(e.menuVisible=t,e.dispatchColEvent("menuVisibleChanged",i))}function pE(e){let{enterpriseMenuFactory:t,filterMenuFactory:i,gos:s}=e;return t&&Bo(s)?t:i}var Sv=class extends JC{constructor(){super(...arguments),this.errorMessages=null}init(e){this.params=e,this.initialiseEditor(e),this.eEditor.onValueChange(()=>e.validate())}destroy(){this.errorMessages=null}},BM=class extends ii{constructor(){super()}},wH={tag:"span",cls:"ag-overlay-loading-center"},CH=class extends BM{init(){let e=Qr(this.gos.get("overlayLoadingTemplate")?.trim());if(this.setTemplate(e??wH),!e){let i=this.getLocaleTextFunc()("loadingOoo","Loading...");this.getGui().textContent=i,this.beans.ariaAnnounce.announceValue(i,"overlay")}}},bH={tag:"span",cls:"ag-overlay-no-rows-center"},xH=class extends BM{init(){let e=Qr(this.gos.get("overlayNoRowsTemplate")?.trim());if(this.setTemplate(e??bH),!e){let i=this.getLocaleTextFunc()("noRowsToShow","No Rows To Show");this.getGui().textContent=i,this.beans.ariaAnnounce.announceValue(i,"overlay")}}};function _H(e,t,i){let s=tn(e,t,i);if(s){let{className:o}=s;if(typeof o=="string"&&o.indexOf("ag-icon")>-1||typeof o=="object"&&o["ag-icon"])return s}let n=rs({tag:"span"});return n.appendChild(s),n}function tn(e,t,i){let s=null;e==="smallDown"?je(262):e==="smallLeft"?je(263):e==="smallRight"&&je(264);let n=i&&i.getColDef().icons;if(n&&(s=n[e]),t.gos&&!s){let o=t.gos.get("icons");o&&(s=o[e])}if(s){let o;if(typeof s=="function")o=s();else if(typeof s=="string")o=s;else{je(38,{iconName:e});return}if(typeof o=="string")return jC(o);if(ZC(o))return o;je(133,{iconName:e});return}else{let o=t.registry.getIcon(e);return o||t.validation?.validateIcon(e),rs({tag:"span",cls:`ag-icon ag-icon-${o??e}`,role:"presentation",attrs:{unselectable:"on"}})}}var SH=".ag-dnd-ghost{align-items:center;background-color:var(--ag-drag-and-drop-image-background-color);border:var(--ag-drag-and-drop-image-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-drag-and-drop-image-shadow);color:var(--ag-text-color);cursor:move;display:flex;font-weight:500;gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);text-overflow:ellipsis;transform:translateY(calc(var(--ag-spacing)*2));white-space:nowrap}.ag-dnd-ghost-not-allowed{border:var(--ag-drag-and-drop-image-not-allowed-border)}",RH={tag:"div",children:[{tag:"div",ref:"eGhost",cls:"ag-dnd-ghost ag-unselectable",children:[{tag:"span",ref:"eIcon",cls:"ag-dnd-ghost-icon ag-shake-left-to-right"},{tag:"div",ref:"eLabel",cls:"ag-dnd-ghost-label"}]}]},EH=class extends ii{constructor(){super(),this.dragSource=null,this.eIcon=ot,this.eLabel=ot,this.eGhost=ot,this.registerCSS(SH)}postConstruct(){let e=t=>_H(t,this.beans,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate(RH),this.beans.environment.applyThemeClasses(this.eGhost)}destroy(){this.dragSource=null,super.destroy()}setIcon(e,t){let{eGhost:i,eIcon:s,dragSource:n,dropIconMap:o,gos:l}=this;Ns(s);let d=null;e||(e=n?.getDefaultIconName?n.getDefaultIconName():"notAllowed"),d=o[e],i.classList.toggle("ag-dnd-ghost-not-allowed",e==="notAllowed"),s.classList.toggle("ag-shake-left-to-right",t),!(d===o.hide&&l.get("suppressDragLeaveHidesColumns"))&&d&&s.appendChild(d)}setLabel(e){this.eLabel.textContent=e}},PH=".ag-checkbox-cell{height:100%}",MH={tag:"div",cls:"ag-cell-wrapper ag-checkbox-cell",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},TH=class extends ii{constructor(){super(MH,[ib]),this.eCheckbox=ot,this.registerCSS(PH)}init(e){this.refresh(e);let{eCheckbox:t,beans:i}=this,s=t.getInputElement();s.setAttribute("tabindex","-1"),sP(s,"polite"),this.addManagedListeners(s,{click:n=>{if(mc(n),t.isDisabled())return;let o=t.getValue();this.onCheckboxChanged(o)},dblclick:n=>{mc(n)}}),this.addManagedElementListeners(e.eGridCell,{keydown:n=>{if(n.key===Fe.SPACE&&!t.isDisabled()){e.eGridCell===zi(i)&&t.toggle();let o=t.getValue();this.onCheckboxChanged(o),n.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){let t,i=!0,{value:s,column:n,node:o}=e;if(o.group&&n)if(typeof s=="boolean")t=s;else{let S=n.getColId();S.startsWith(wv)?t=s==null||s===""?void 0:s==="true":o.aggData&&o.aggData[S]!==void 0||o.sourceRowIndex>=0?t=s??void 0:i=!1}else t=s??void 0;let{eCheckbox:l}=this;if(!i){l.setDisplayed(!1);return}l.setValue(t);let d=e.disabled??!n?.isCellEditable(o);l.setDisabled(d);let p=this.getLocaleTextFunc(),y=yv(p,t),C=d?y:`${p("ariaToggleCellValue","Press SPACE to toggle cell value")} (${y})`;l.setInputAriaLabel(C)}onCheckboxChanged(e){let{params:t}=this,{column:i,node:s,value:n}=t;this.beans?.editSvc?.setEditingCells([{column:i,colId:i.getColId(),rowIndex:s.rowIndex,rowPinned:s.rowPinned,state:"changed",oldValue:n,newValue:n}],{update:!0,forceRefreshOfEditCellsOnly:!0});let o=s.setDataValue(i,e,"renderer");this.beans.editSvc?.stopEditing({rowNode:s,column:i},{source:this.beans.editSvc?.isBatchEditing()?"ui":"api"}),o||this.updateCheckbox(t)}},gE=class{constructor(e,t){this.beans=e,this.floating=t,this.all=new Set,this.visible=new Set,this.order=[],this.queued=new Set}size(){return this.visible.size}add(e){let{all:t,visible:i,order:s}=this;t.has(e)||(t.add(e),i.add(e),s.push(e),this.sort())}delete(e){this.all.delete(e),this.visible.delete(e),this.queued.delete(e.id),sn(this.order,e)}has(e){return this.visible.has(e)}forEach(e){this.order.forEach(e)}getByIndex(e){return this.order[e]}getById(e){for(let t of this.visible)if(t.id==e)return t}clear(){let{all:e,visible:t,order:i,queued:s}=this;e.clear(),s.clear(),t.clear(),i.length=0}sort(){let{sortSvc:e,rowNodeSorter:t,gos:i}=this.beans,s=e?.getSortOptions()??[],n=IH(this.order);if(this.order.sort((l,d)=>(l.pinnedSibling?.rowIndex??0)-(d.pinnedSibling?.rowIndex??0)),this.order=t?.doFullSort(this.order,s)??this.order,!n)return;let o=MP(i);o==="bottom"||o==="pinnedBottom"?this.order.push(n):this.order.unshift(n)}hide(e){let{all:t,visible:i}=this;t.forEach(s=>e(s)?i.delete(s):i.add(s)),this.order=Array.from(i),this.sort()}queue(e){this.queued.add(e)}unqueue(e){this.queued.delete(e)}forEachQueued(e){this.queued.forEach(e)}};function VM(e){if(e.level===-1)return!0;let t=e.parent;return t?.childrenAfterSort?.some(i=>i==e)?VM(t):!1}function jw(e,t){let{gos:i,rowModel:s,filterManager:n}=e;return ku(i,s)?!s.getRowNode(t.id):n?.isAnyFilterPresent()?!VM(t):i.get("pivotMode")?!t.group:!1}function DH(e){return!!e.footer&&e.level===-1}function FH(e){return!!e.pinnedSibling&&DH(e.pinnedSibling)}function IH(e){let t=e.findIndex(FH);if(t>-1)return e.splice(t,1)?.[0]}var fE=class extends Be{postConstruct(){let{gos:e,beans:t}=this;this.top=new gE(t,"top"),this.bottom=new gE(t,"bottom");let i=n=>jw(t,n.pinnedSibling),s=()=>{let n=e.get("isRowPinned");n&&e.get("enableRowPinning")&&t.rowModel.forEachNode(o=>this.pinRow(o,n(o)),!0),this.refreshRowPositions(),this.dispatchRowPinnedEvents()};this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this),modelUpdated:({keepRenderedRows:n})=>{this.tryToEmptyQueues(),this.pinGrandTotalRow(),this.forContainers(l=>l.hide(i));let o=this.refreshRowPositions();(!n||o)&&this.dispatchRowPinnedEvents()},columnRowGroupChanged:()=>{this.forContainers(AH),this.refreshRowPositions()},rowNodeDataChanged:({node:n})=>{(e.get("isRowPinnable")?.(n)??!0)||this.pinRow(n,null)},firstDataRendered:s}),this.addManagedPropertyListener("pivotMode",()=>{this.forContainers(n=>n.hide(i)),this.dispatchRowPinnedEvents()}),this.addManagedPropertyListener("grandTotalRow",({currentValue:n})=>{this._grandTotalPinned=n==="pinnedBottom"?"bottom":n==="pinnedTop"?"top":null}),this.addManagedPropertyListener("isRowPinned",s)}destroy(){this.reset(!1),super.destroy()}reset(e=!0){this.forContainers(t=>{let i=[];t.forEach(s=>i.push(s)),i.forEach(s=>this.pinRow(s,null)),t.clear()}),e&&this.dispatchRowPinnedEvents()}pinRow(e,t,i){if(e.footer&&e.level>-1)return;if(e.footer&&e.level===-1){this._grandTotalPinned=t,OH(this.beans);return}let s=e.rowPinned??e.pinnedSibling?.rowPinned;if(s!=null&&t!=null&&t!=s){let l=e.rowPinned?e:e.pinnedSibling,d=e.rowPinned?e.pinnedSibling:e;this.pinRow(l,null,i),this.pinRow(d,t,i);return}let o=i&&LH(this.beans,e,i);if(o){o.forEach(l=>this.pinRow(l,t));return}if(t==null){let l=e.rowPinned?e:e.pinnedSibling,d=this.findPinnedRowNode(l);if(!d)return;d.delete(l);let p=l.pinnedSibling;$w(l),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(p)}else{let l=mE(this.beans,e,t),d=this.getContainer(t);d.add(l),jw(this.beans,e)&&d.hide(p=>jw(this.beans,p.pinnedSibling)),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(e)}}isManual(){return!0}isEmpty(e){return this.getContainer(e).size()===0}isRowsToRender(e){return!this.isEmpty(e)}ensureRowHeightsValid(){let e=!1,t=0,i=s=>{if(s.rowHeightEstimated){let n=sl(this.beans,s);s.setRowTop(t),s.setRowHeight(n.height),t+=n.height,e=!0}};return this.bottom.forEach(i),t=0,this.top.forEach(i),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}getPinnedTopTotalHeight(){return vE(this.top)}getPinnedBottomTotalHeight(){return vE(this.bottom)}getPinnedTopRowCount(){return this.top.size()}getPinnedBottomRowCount(){return this.bottom.size()}getPinnedTopRow(e){return this.top.getByIndex(e)}getPinnedBottomRow(e){return this.bottom.getByIndex(e)}getPinnedRowById(e,t){return this.getContainer(t).getById(e)}forEachPinnedRow(e,t){this.getContainer(e).forEach(t)}getPinnedState(){let e=t=>{let i=[];return this.forEachPinnedRow(t,s=>i.push(s.pinnedSibling.id)),i};return{top:e("top"),bottom:e("bottom")}}setPinnedState(e){this.forContainers((t,i)=>{for(let s of e[i]){let n=this.beans.rowModel.getRowNode(s);n?this.pinRow(n,i):t.queue(s)}})}getGrandTotalPinned(){return this._grandTotalPinned}setGrandTotalPinned(e){this._grandTotalPinned=e}tryToEmptyQueues(){this.forContainers((e,t)=>{let i=new Set;e.forEachQueued(s=>{let n=this.beans.rowModel.getRowNode(s);n&&i.add(n)});for(let s of i)e.unqueue(s.id),this.pinRow(s,t)})}pinGrandTotalRow(){let{gos:e,beans:t,_grandTotalPinned:i}=this,s=t.rowModel;if(!Ms(e,s))return;let n=s.rootNode?.sibling;if(!n)return;let o=n.pinnedSibling,l=o&&this.findPinnedRowNode(o);if(i){if(l&&l.floating!==i&&(l.delete(o),$w(o)),!l||l.floating!==i){let d=mE(t,n,i);this.getContainer(i).add(d)}}else{if(!l)return;l.delete(o),$w(o)}}onGridStylesChanges(e){e.rowHeightChanged&&this.forContainers(t=>t.forEach(i=>i.setRowHeight(i.rowHeight,!0)))}getContainer(e){return e==="top"?this.top:this.bottom}findPinnedRowNode(e){if(this.top.has(e))return this.top;if(this.bottom.has(e))return this.bottom}refreshRowPositions(e){let t=s=>kH(this.beans,s);if(e)return t(this.getContainer(e));let i=!1;return this.forContainers(s=>{let n=t(s);i||(i=n)}),i}forContainers(e){e(this.top,"top"),e(this.bottom,"bottom")}dispatchRowPinnedEvents(e){this.eventSvc.dispatchEvent({type:"pinnedRowsChanged"}),e?.dispatchRowEvent("rowPinned")}};function kH(e,t){let i=0,s=!1;return t.forEach((n,o)=>{if(s||(s=n.rowTop!==i),n.setRowTop(i),n.rowHeightEstimated||n.rowHeight==null){let l=sl(e,n).height;s||(s=n.rowHeight!==l),n.setRowHeight(l)}n.setRowIndex(o),i+=n.rowHeight}),s}function mE(e,t,i){if(t.pinnedSibling)return t.pinnedSibling;let s=Y8(t,e);s.setRowTop(null),s.setRowIndex(null),s.rowPinned=i;let n=i==="top"?ab:lb;return s.id=`${n}${i}-${t.id}`,s.pinnedSibling=t,t.pinnedSibling=s,s}function $w(e){if(!e.pinnedSibling)return;e.rowPinned=null,e.setRowTop(null),e.setRowIndex(null);let t=e.pinnedSibling;e.pinnedSibling=void 0,t&&(t.pinnedSibling=void 0,t.rowPinned=null)}function AH(e){let t=new Set;e.forEach(i=>{i.group&&t.add(i)}),t.forEach(i=>e.delete(i))}function LH(e,t,i){let{rowSpanSvc:s}=e,n=(i&&s?.isCellSpanning(i,t))??!1;if(i&&n)return s?.getCellSpan(i,t)?.spannedNodes}function vE(e){let t=e.size();if(t===0)return 0;let i=e.getByIndex(t-1);return i===void 0?0:i.rowTop+i.rowHeight}function OH({gos:e,rowModel:t}){Ms(e,t)&&t.refreshModel({step:"map"})}var yE=class extends Be{constructor(){super(...arguments),this.nextId=0,this.pinnedTopRows={cache:{},order:[]},this.pinnedBottomRows={cache:{},order:[]}}postConstruct(){let e=this.gos;this.setPinnedRowData(e.get("pinnedTopRowData"),"top"),this.setPinnedRowData(e.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",t=>this.setPinnedRowData(t.currentValue,"top")),this.addManagedPropertyListener("pinnedBottomRowData",t=>this.setPinnedRowData(t.currentValue,"bottom")),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this)})}reset(){}isEmpty(e){return this.getCache(e).order.length===0}isRowsToRender(e){return!this.isEmpty(e)}isManual(){return!1}pinRow(e,t){}onGridStylesChanges(e){if(e.rowHeightChanged){let t=i=>{i.setRowHeight(i.rowHeight,!0)};Tp(this.pinnedBottomRows,t),Tp(this.pinnedTopRows,t)}}ensureRowHeightsValid(){let e=!1,t=0,i=s=>{if(s.rowHeightEstimated){let n=sl(this.beans,s);s.setRowTop(t),s.setRowHeight(n.height),t+=n.height,e=!0}};return Tp(this.pinnedBottomRows,i),t=0,Tp(this.pinnedTopRows,i),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}setPinnedRowData(e,t){this.updateNodesFromRowData(e,t),this.eventSvc.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(e,t){let i=this.getCache(t);if(e===void 0){i.order.length=0,i.cache={};return}let s=Pu(this.gos),n=t==="top"?ab:lb,o=new Set(i.order),l=[],d=new Set,p=0,y=-1;for(let C of e){let S=s?.({data:C,level:0,rowPinned:t})??n+this.nextId++;if(d.has(S)){je(96,{id:S,data:C});continue}y++,d.add(S),l.push(S);let P=Vp(i,S);if(P!==void 0)P.data!==C&&P.updateData(C),p+=this.setRowTopAndRowIndex(P,p,y),o.delete(S);else{let I=new fc(this.beans);I.id=S,I.data=C,I.rowPinned=t,p+=this.setRowTopAndRowIndex(I,p,y),i.cache[S]=I,i.order.push(S)}}o.forEach(C=>{Vp(i,C)?.clearRowTopAndRowIndex(),delete i.cache[C]}),i.order=l}setRowTopAndRowIndex(e,t,i){return e.setRowTop(t),e.setRowHeight(sl(this.beans,e).height),e.setRowIndex(i),e.rowHeight}getPinnedTopTotalHeight(){return wE(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return wE(this.pinnedBottomRows)}getPinnedTopRowCount(){return MC(this.pinnedTopRows)}getPinnedBottomRowCount(){return MC(this.pinnedBottomRows)}getPinnedTopRow(e){return PC(this.pinnedTopRows,e)}getPinnedBottomRow(e){return PC(this.pinnedBottomRows,e)}getPinnedRowById(e,t){return Vp(this.getCache(t),e)}forEachPinnedRow(e,t){return Tp(this.getCache(e),t)}getCache(e){return e==="top"?this.pinnedTopRows:this.pinnedBottomRows}getPinnedState(){return{top:[],bottom:[]}}setPinnedState(){}getGrandTotalPinned(){}setGrandTotalPinned(){}};function wE(e){let t=MC(e);if(t===0)return 0;let i=PC(e,t-1);return i===void 0?0:i.rowTop+i.rowHeight}function Vp(e,t){return e.cache[t]}function PC(e,t){return Vp(e,e.order[t])}function Tp(e,t){e.order.forEach((i,s)=>{let n=Vp(e,i);n&&t(n,s)})}function MC(e){return e.order.length}var zH=class extends Be{constructor(){super(...arguments),this.beanName="pinnedRowModel"}postConstruct(){let{gos:e}=this,t=()=>{let i=e.get("enableRowPinning"),s=MP(e),o=!!i||(s==="pinnedBottom"||s==="pinnedTop"),l=o?this.inner instanceof yE:this.inner instanceof fE;this.inner&&l&&this.destroyBean(this.inner),(l||!this.inner)&&(this.inner=this.createManagedBean(o?new fE:new yE))};this.addManagedPropertyListeners(["enableRowPinning","grandTotalRow"],t),t()}reset(){return this.inner.reset()}isEmpty(e){return this.inner.isEmpty(e)}isManual(){return this.inner.isManual()}isRowsToRender(e){return this.inner.isRowsToRender(e)}pinRow(e,t,i){return this.inner.pinRow(e,t,i)}ensureRowHeightsValid(){return this.inner.ensureRowHeightsValid()}getPinnedRowById(e,t){return this.inner.getPinnedRowById(e,t)}getPinnedTopTotalHeight(){return this.inner.getPinnedTopTotalHeight()}getPinnedBottomTotalHeight(){return this.inner.getPinnedBottomTotalHeight()}getPinnedTopRowCount(){return this.inner.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.inner.getPinnedBottomRowCount()}getPinnedTopRow(e){return this.inner.getPinnedTopRow(e)}getPinnedBottomRow(e){return this.inner.getPinnedBottomRow(e)}forEachPinnedRow(e,t){return this.inner.forEachPinnedRow(e,t)}getPinnedState(){return this.inner.getPinnedState()}setPinnedState(e){return this.inner.setPinnedState(e)}setGrandTotalPinned(e){return this.inner.setGrandTotalPinned(e)}getGrandTotalPinned(){return this.inner.getGrandTotalPinned()}},BH="ROOT_NODE_ID",VH=class extends Be{constructor(){super(...arguments),this.nextId=0,this.allNodesMap={},this.rootNode=null}getRowNode(e){return this.allNodesMap[e]}extractRowData(){return this.rootNode?.allLeafChildren?.map(e=>e.data)}activate(e){this.rootNode=e,e.group=!0,e.level=-1,e.id=BH,e.allLeafChildren=[],e.childrenAfterGroup=[],e.childrenAfterSort=[],e.childrenAfterAggFilter=[],e.childrenAfterFilter=[],this.updateRootSiblingArrays(e)}deactivate(){this.rootNode&&(this.allNodesMap={},this.rootNode=null)}destroy(){super.destroy(),this.allNodesMap={},this.rootNode=null}setNewRowData(e){let t=this.rootNode;t&&(this.dispatchRowDataUpdateStartedEvent(e),t.childrenAfterFilter=null,t.childrenAfterGroup=null,t.childrenAfterAggFilter=null,t.childrenAfterSort=null,t.childrenMapped=null,t.updateHasChildren(),this.allNodesMap={},this.nextId=0,this.loadNewRowData(e),this.updateRootSiblingArrays(t))}updateRootSiblingArrays(e){let t=e.sibling;t&&(t.childrenAfterFilter=e.childrenAfterFilter,t.childrenAfterGroup=e.childrenAfterGroup,t.childrenAfterAggFilter=e.childrenAfterAggFilter,t.childrenAfterSort=e.childrenAfterSort,t.childrenMapped=e.childrenMapped,t.allLeafChildren=e.allLeafChildren)}loadNewRowData(e){this.rootNode.allLeafChildren=e?.map((t,i)=>this.createRowNode(t,i))??[]}setImmutableRowData(e,t){let i=Pu(this.gos),s=!this.gos.get("suppressMaintainUnsortedOrder"),n=e.changedRowNodes,o=new Set,l=this.rootNode,d=l.allLeafChildren,p=d.length,y=!1,C=!1,S=!1,P=!1;for(let O=0,V=-1,G=t.length;O<G;O++){let X=t[O],Q=this.getRowNode(i({data:X,level:0}));if(!Q)y=!0,Q=this.createRowNode(X,-1),n.add(Q);else{if(s){let ae=Q.sourceRowIndex;P||(P=ae<=V||y),V=ae}Q.data!==X&&(S=!0,Q.updateData(X),n.update(Q))}o.add(Q)}let I=[];for(let O=0;O<p;O++){let V=d[O];o.has(V)||(C=!0,V.isSelected()&&I.push(V),V.pinnedSibling&&this.beans.pinnedRowModel?.pinRow(V.pinnedSibling,null),this.rowNodeDeleted(V),n.remove(V))}if(y||C||P){let O=new Array(o.size),V=0;if(!s)for(let X=0;X<p;++X){let Q=d[X];o.delete(Q)&&(Q.sourceRowIndex=V,O[V++]=Q)}for(let X of o)X.sourceRowIndex=V,O[V++]=X;l.allLeafChildren=O;let G=l.sibling;G&&(G.allLeafChildren=O),e.rowNodesOrderChanged||(e.rowNodesOrderChanged=P)}(y||C||P||S)&&(this.deselectNodes(I),e.rowDataUpdated=!0)}rowNodeDeleted(e){e.clearRowTopAndRowIndex();let t=e.id,i=this.allNodesMap;i[t]===e&&delete i[t]}updateRowData(e,t){this.dispatchRowDataUpdateStartedEvent(e.add);let i={changedRowNodes:t,rowNodeTransaction:{remove:[],update:[],add:[]},rowsInserted:!1},s=[],n=Pu(this.gos);return this.executeRemove(n,e,i,s),this.executeUpdate(n,e,i,s),this.executeAdd(e,i),this.deselectNodes(s),i}executeAdd(e,t){let i=e.add;if(!i?.length)return;let s=this.rootNode.allLeafChildren,n=s.length;if(typeof e.addIndex=="number"&&(n=this.sanitizeAddIndex(e.addIndex),n>0&&this.gos.get("treeData")&&this.gos.get("getDataPath"))){for(let S=0;S<s.length;S++)if(s[S]?.rowIndex==n-1){n=S+1;break}}let o=i.length,l=t.changedRowNodes,d=new Array(o);for(let C=0;C<o;C++){let S=this.createRowNode(i[C],n+C);l.add(S),d[C]=S}let p=this.rootNode;if(n<s.length){let C=s.slice(0,n),S=s.slice(n,s.length),P=C.length+d.length;for(let I=0,O=S.length;I<O;++I)S[I].sourceRowIndex=P+I;s=[...C,...d,...S],t.rowsInserted=!0}else s=s.concat(d);p.allLeafChildren=s;let y=p.sibling;y&&(y.allLeafChildren=s),t.rowNodeTransaction.add=d}executeRemove(e,t,{changedRowNodes:i,rowNodeTransaction:s},n){let{remove:o}=t;if(!o?.length)return;let l={};o.forEach(y=>{let C=this.lookupRowNode(e,y);C&&(C.isSelected()&&n.push(C),C.pinnedSibling&&this.beans.pinnedRowModel?.pinRow(C.pinnedSibling,null),C.clearRowTopAndRowIndex(),l[C.id]=!0,delete this.allNodesMap[C.id],s.remove.push(C),i.remove(C))});let d=this.rootNode;d.allLeafChildren=d.allLeafChildren?.filter(y=>!l[y.id])??null,d.allLeafChildren?.forEach((y,C)=>{y.sourceRowIndex=C});let p=d.sibling;p&&(p.allLeafChildren=d.allLeafChildren)}executeUpdate(e,t,{changedRowNodes:i,rowNodeTransaction:s},n){let{update:o}=t;o?.length&&o.forEach(l=>{let d=this.lookupRowNode(e,l);d&&(d.updateData(l),!d.selectable&&d.isSelected()&&n.push(d),s.update.push(d),i.update(d))})}dispatchRowDataUpdateStartedEvent(e){this.eventSvc.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e?.length?e[0]:null})}deselectNodes(e){let t="rowDataChanged",i=this.beans.selectionSvc,s=e.length>0;s&&i?.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),i?.updateGroupsFromChildrenSelections?.(t),s&&this.eventSvc.dispatchEvent({type:"selectionChanged",source:t,selectedNodes:i?.getSelectedNodes()??null,serverSideState:null})}sanitizeAddIndex(e){let t=this.rootNode.allLeafChildren?.length??0;return e<0||e>=t||Number.isNaN(e)?t:Math.ceil(e)}createRowNode(e,t){let i=new fc(this.beans);return i.parent=this.rootNode,i.level=0,i.group=!1,i.expanded=!1,i.sourceRowIndex=t,i.setDataAndId(e,String(this.nextId)),this.allNodesMap[i.id]&&je(2,{nodeId:i.id}),this.allNodesMap[i.id]=i,this.nextId++,i}lookupRowNode(e,t){let i;if(e){let s=e({data:t,level:0});if(i=this.allNodesMap[s],!i)return li(4,{id:s}),null}else if(i=this.rootNode?.allLeafChildren?.find(s=>s.data===t),!i)return li(5,{data:t}),null;return i||null}};function hg(e){return!!(e.rowPinned&&e.pinnedSibling)}function Jo(e,t,i,s){let n=t==="top";if(!i)return Jo(e,t,n?e.getPinnedTopRow(0):e.getPinnedBottomRow(0),s);if(!s){let p=n?e.getPinnedTopRowCount():e.getPinnedBottomRowCount();return Jo(e,t,i,n?e.getPinnedTopRow(p-1):e.getPinnedBottomRow(p-1))}let o=!1,l=!1,d=[];return e.forEachPinnedRow(t,p=>{if(p===i&&!o){o=!0,d.push(p);return}if(o&&p===s){l=!0,d.push(p);return}o&&!l&&d.push(p)}),d}var HH={tag:"div",cls:"ag-selection-checkbox",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},NH=class extends ii{constructor(){super(HH,[ib]),this.eCheckbox=ot}postConstruct(){this.eCheckbox.setPassive(!0)}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){let e=this.getLocaleTextFunc(),{rowNode:t,eCheckbox:i}=this,s=t.isSelected(),n=yv(e,s),[o,l]=t.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],d=e(o,l);i.setValue(s,!0),i.setInputAriaLabel(`${d} (${n})`)}init(e){if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getInputElement(),{dblclick:mc,click:s=>{mc(s),this.beans.selectionSvc?.handleSelectionEvent(s,this.rowNode,"checkboxSelected")}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)}),this.addManagedPropertyListener("rowSelection",({currentValue:s,previousValue:n})=>{let o=typeof s=="object"?Dw(s):void 0,l=typeof n=="object"?Dw(n):void 0;o!==l&&this.onSelectableChanged()}),pC(this.gos)||typeof this.getIsVisible()=="function"){let s=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:s}),this.addManagedListeners(this.rowNode,{dataChanged:s,cellChanged:s}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}showOrHideSelect(){let{column:e,rowNode:t,overrides:i,gos:s}=this,n=t.selectable,o=this.getIsVisible(),l;if(typeof o=="function"){let S=i?.callbackParams;if(!e)l=o(ht(Se({},S),{node:t,data:t.data}));else{let P=e.createColumnFunctionCallbackParams(t);l=o(Se(Se({},S),P))}}else l=o??!1;let d=n&&!l||!n&&l,p=n||l,y=s.get("rowSelection"),C=y&&typeof y!="string"?!Dw(y):!!e?.getColDef().showDisabledCheckboxes;if(this.setVisible(p&&(d?C:!0)),this.setDisplayed(p&&(d?C:!0)),p&&this.eCheckbox.setDisabled(d),i?.removeHidden){this.setDisplayed(p);return}}getIsVisible(){let e=this.overrides;if(e)return e.isVisible;let t=this.gos.get("rowSelection");return t&&typeof t!="string"?yu(t):this.column?.getColDef()?.checkboxSelection}},GH=class{constructor(e,t){this.rowModel=e,this.pinnedRowModel=t,this.selectAll=!1,this.rootId=null,this.endId=null,this.cachedRange=[]}reset(){this.rootId=null,this.endId=null,this.cachedRange.length=0}setRoot(e){this.rootId=e.id,this.endId=null,this.cachedRange.length=0}setEndRange(e){this.endId=e.id,this.cachedRange.length=0}getRange(){if(this.cachedRange.length===0){let e=this.getRoot(),t=this.getEnd();if(e==null||t==null)return this.cachedRange;this.cachedRange=this.getNodesInRange(e,t)??[]}return this.cachedRange}isInRange(e){return this.rootId===null?!1:this.getRange().some(t=>t.id===e.id)}getRoot(e){if(this.rootId)return this.getRowNode(this.rootId);if(e)return this.setRoot(e),e}getEnd(){if(this.endId)return this.getRowNode(this.endId)}getRowNode(e){let t,{rowModel:i,pinnedRowModel:s}=this;return t??(t=i.getRowNode(e)),s?.isManual()&&(t??(t=s.getPinnedRowById(e,"top")),t??(t=s.getPinnedRowById(e,"bottom"))),t}truncate(e){let t=this.getRange();if(t.length===0)return{keep:[],discard:[]};let i=t[0].id===this.rootId,s=t.findIndex(n=>n.id===e.id);if(s>-1){let n=t.slice(0,s),o=t.slice(s+1);return this.setEndRange(e),i?{keep:n,discard:o}:{keep:o,discard:n}}else return{keep:t,discard:[]}}extend(e,t=!1){let i=this.getRoot();if(i==null){let n=this.getRange().slice();return t&&e.depthFirstSearch(o=>!o.group&&n.push(o)),n.push(e),this.setRoot(e),{keep:n,discard:[]}}let s=this.getNodesInRange(i,e);if(!s)return this.setRoot(e),{keep:[e],discard:[]};if(s.find(n=>n.id===this.endId))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{let n=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:n}}}getNodesInRange(e,t){let{pinnedRowModel:i,rowModel:s}=this;if(!i?.isManual())return s.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&!t.rowPinned)return Jo(i,"top",e,void 0).concat(s.getNodesInRangeForSelection(s.getRow(0),t)??[]);if(e.rowPinned==="bottom"&&!t.rowPinned){let n=Jo(i,"bottom",void 0,e),o=s.getRowCount(),l=s.getRow(o-1);return(s.getNodesInRangeForSelection(t,l)??[]).concat(n)}if(!e.rowPinned&&!t.rowPinned)return s.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&t.rowPinned==="top")return Jo(i,"top",e,t);if(e.rowPinned==="bottom"&&t.rowPinned==="top"){let n=Jo(i,"top",t,void 0),o=Jo(i,"bottom",void 0,e),l=s.getRow(0),d=s.getRow(s.getRowCount()-1);return n.concat(s.getNodesInRangeForSelection(l,d)??[]).concat(o)}if(!e.rowPinned&&t.rowPinned==="top")return Jo(i,"top",t,void 0).concat(s.getNodesInRangeForSelection(s.getRow(0),e)??[]);if(e.rowPinned==="top"&&t.rowPinned==="bottom"){let n=Jo(i,"top",e,void 0),o=Jo(i,"bottom",void 0,t),l=s.getRow(0),d=s.getRow(s.getRowCount()-1);return n.concat(s.getNodesInRangeForSelection(l,d)??[]).concat(o)}if(e.rowPinned==="bottom"&&t.rowPinned==="bottom")return Jo(i,"bottom",e,t);if(!e.rowPinned&&t.rowPinned==="bottom"){let n=Jo(i,"bottom",void 0,t),o=s.getRow(s.getRowCount());return(s.getNodesInRangeForSelection(e,o)??[]).concat(n)}return null}},WH=class extends Be{constructor(e){super(),this.column=e,this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1}onSpaceKeyDown(e){let t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(zi(this.beans))&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e;let t=this.createManagedBean(new tb);this.cbSelectAll=t,t.addCss("ag-header-select-all"),tl(t.getGui(),"presentation"),this.showOrHideSelectAll();let i=this.updateStateOfCheckbox.bind(this);this.addManagedEventListeners({newColumnsLoaded:()=>this.showOrHideSelectAll(),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:i,paginationChanged:i,modelUpdated:i}),this.addManagedPropertyListener("rowSelection",({currentValue:s,previousValue:n})=>{let o=l=>typeof l=="string"||!l||l.mode==="singleRow"?void 0:l.selectAll;o(s)!==o(n)&&this.showOrHideSelectAll(),this.updateStateOfCheckbox()}),this.addManagedListeners(t,{fieldValueChanged:this.onCbSelectAll.bind(this)}),t.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onDisplayedColumnsChanged(e){this.isAlive()&&this.showOrHideSelectAll(e.source==="uiColumnMoved")}showOrHideSelectAll(e=!1){let t=this.isCheckboxSelection();this.cbSelectAllVisible=t,this.cbSelectAll.setDisplayed(t),t&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel(e)}updateStateOfCheckbox(){if(!this.cbSelectAllVisible||this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;let e=this.getSelectAllMode(),t=this.beans.selectionSvc,i=this.cbSelectAll,s=t.getSelectAllState(e);i.setValue(s);let n=t.hasNodesToSelect(e);i.setDisabled(!n),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(e=!1){let t=this.getLocaleTextFunc(),{headerCellCtrl:i,cbSelectAll:s,cbSelectAllVisible:n}=this,o=s.getValue(),l=yv(t,o),d=t("ariaRowSelectAll","Press Space to toggle all rows selection");i.setAriaDescriptionProperty("selectAll",n?`${d} (${l})`:null),s.setInputAriaLabel(t("ariaHeaderSelection","Column with Header Selection")),e||i.announceAriaDescription()}checkSelectionType(e){return Kp(this.gos)?!0:(je(128,{feature:e}),!1)}checkRightRowModelType(e){let{gos:t,rowModel:i}=this.beans;return Ms(t)||ku(t)?!0:(je(129,{feature:e,rowModel:i.getType()}),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;let e=this.cbSelectAll.getValue(),t=this.getSelectAllMode(),i="uiSelectAll";t==="currentPage"?i="uiSelectAllCurrentPage":t==="filtered"&&(i="uiSelectAllFiltered");let s={source:i,selectAll:t},n=this.beans.selectionSvc;e?n.selectAllRowNodes(s):n.deselectAllRowNodes(s)}isCheckboxSelection(){let{column:e,gos:t,beans:i}=this,o=typeof t.get("rowSelection")=="object"?"headerCheckbox":"headerCheckboxSelection";return HM(i,e)&&this.checkRightRowModelType(o)&&this.checkSelectionType(o)}getSelectAllMode(){let e=IP(this.gos,!1);if(e)return e;let{headerCheckboxSelectionCurrentPageOnly:t,headerCheckboxSelectionFilteredOnly:i}=this.column.getColDef();return t?"currentPage":i?"filtered":"all"}destroy(){super.destroy(),this.cbSelectAll=void 0,this.headerCellCtrl=void 0}};function HM({gos:e,selectionColSvc:t},i){let s=e.get("rowSelection"),n=i.getColDef(),{headerCheckboxSelection:o}=n,l=!1;if(typeof s=="object"){let p=al(i),y=YC(i);(iv(s)==="autoGroupColumn"&&y||p&&t?.isSelectionColumnEnabled())&&(l=Nm(s))}else typeof o=="function"?l=o(bt(e,{column:i,colDef:n})):l=!!o;return l}var UH=class extends Be{postConstruct(){let{gos:e,beans:t}=this;this.selectionCtx=new GH(t.rowModel,t.pinnedRowModel),this.addManagedPropertyListeners(["isRowSelectable","rowSelection"],()=>{let i=pC(e);i!==this.isRowSelectable&&(this.isRowSelectable=i,this.updateSelectable())}),this.isRowSelectable=pC(e),this.addManagedEventListeners({cellValueChanged:i=>this.updateRowSelectable(i.node),rowNodeDataChanged:i=>this.updateRowSelectable(i.node)})}destroy(){super.destroy(),this.selectionCtx.reset()}createCheckboxSelectionComponent(){return new NH}createSelectAllFeature(e){if(HM(this.beans,e))return new WH(e)}isMultiSelect(){return Kp(this.gos)}onRowCtrlSelected(e,t,i){let s=!!e.rowNode.isSelected();e.forEachGui(i,n=>{n.rowComp.toggleCss("ag-row-selected",s);let o=n.element;rP(o,s),o.contains(zi(this.beans))&&t(n)})}announceAriaRowSelection(e){if(this.isRowSelectionBlocked(e))return;let t=e.isSelected();if(!e.selectable)return;let s=this.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${t?"deselect":"select"} this row`);this.beans.ariaAnnounce?.announceValue(s,"rowSelection")}isRowSelectionBlocked(e){return!e.selectable||e.rowPinned&&!hg(e)||!ac(this.gos)}updateRowSelectable(e,t){let i=e.rowPinned&&e.pinnedSibling?e.pinnedSibling.selectable:this.isRowSelectable?.(e)??!0;return this.setRowSelectable(e,i,t),i}setRowSelectable(e,t,i){if(e.selectable!==t){if(e.selectable=t,e.dispatchRowEvent("selectableChanged"),i)return;if(Xp(this.gos)){let n=this.calculateSelectedFromChildren(e);this.setNodesSelected({nodes:[e],newValue:n??!1,source:"selectableChanged"});return}e.isSelected()&&!e.selectable&&this.setNodesSelected({nodes:[e],newValue:!1,source:"selectableChanged"})}}calculateSelectedFromChildren(e){let t=!1,i=!1;if(!e.childrenAfterGroup?.length)return e.selectable?e.__selected:null;for(let s=0;s<e.childrenAfterGroup.length;s++){let n=e.childrenAfterGroup[s],o=n.isSelected();if(!n.selectable){let l=this.calculateSelectedFromChildren(n);if(l===null)continue;o=l}switch(o){case!0:t=!0;break;case!1:i=!0;break;default:return}}if(!(t&&i))return t?!0:i?!1:e.selectable?e.__selected:null}selectRowNode(e,t,i,s="api"){let n=!e.selectable&&t,o=e.__selected===t;if(n||o)return!1;e.__selected=t,e.dispatchRowEvent("rowSelected");let l=e.sibling;l&&l.footer&&l.__localEventService&&l.dispatchRowEvent("rowSelected");let d=e.pinnedSibling;return d&&d.rowPinned&&d.__localEventService&&d.dispatchRowEvent("rowSelected"),this.eventSvc.dispatchEvent(ht(Se({},K8(e,this.gos,"rowSelected")),{event:i||null,source:s})),!0}isCellCheckboxSelection(e,t){let i=this.gos.get("rowSelection");if(i&&typeof i!="string"){let s=al(e)&&yu(i);return e.isColumnFunc(t,s)}else return e.isColumnFunc(t,e.colDef.checkboxSelection)}inferNodeSelections(e,t,i,s){let{gos:n,selectionCtx:o}=this,l=e.isSelected(),d=Xp(n),p=xB(n),y=_B(n),C=this.isMultiSelect(),S=s==="rowClicked";if(S&&!(p||y))return null;if(t&&i&&C){let P=o.getRoot();if(P)if(P.isSelected()){let I=o.isInRange(e)?o.truncate(e):o.extend(e,d);return{deselect:I.discard,select:I.keep,reset:!1}}else{let I=o.extend(e,d);return{select:[],deselect:I.keep,reset:!1}}else return null}else if(t&&C){let P=o.selectAll?this.beans.rowModel.getRow(0):void 0,I=o.getRoot(P),O=o.isInRange(e)?o.truncate(e):o.extend(e,d);return{select:O.keep,deselect:O.discard,reset:o.selectAll||!!(I&&!I.isSelected())}}else if(i){if(S){let P=!l;return P&&!p||!P&&!y?null:(o.setRoot(e),{node:e,newValue:P,clearSelection:!1})}return o.setRoot(e),{node:e,newValue:!l,clearSelection:!C}}else{o.setRoot(e);let P=SB(n),I=ov(n)==="filteredDescendants",O=S&&(!P||!p);if(I&&l===void 0&&Ms(n))return{node:e,newValue:!1,checkFilteredNodes:!0,clearSelection:!C||O};if(S){let V=l?!P:p;return V===l&&!O||V&&!p||!V&&!y?null:{node:e,newValue:V,clearSelection:!C||O,keepDescendants:e.group&&d}}return{node:e,newValue:!l,clearSelection:!C||O}}}},qw={TAB_GUARD:"ag-tab-guard",TAB_GUARD_TOP:"ag-tab-guard-top",TAB_GUARD_BOTTOM:"ag-tab-guard-bottom"},jH=class extends Be{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;let{comp:t,eTopGuard:i,eBottomGuard:s,focusTrapActive:n,forceFocusOutWhenTabGuardsAreEmpty:o,isFocusableContainer:l,focusInnerElement:d,onFocusIn:p,onFocusOut:y,shouldStopEventPropagation:C,onTabKeyDown:S,handleKeyDown:P,isEmpty:I,eFocusableElement:O}=e;this.comp=t,this.eTopGuard=i,this.eBottomGuard=s,this.providedFocusInnerElement=d,this.eFocusableElement=O,this.focusTrapActive=!!n,this.forceFocusOutWhenTabGuardsAreEmpty=!!o,this.isFocusableContainer=!!l,this.providedFocusIn=p,this.providedFocusOut=y,this.providedShouldStopEventPropagation=C,this.providedOnTabKeyDown=S,this.providedHandleKeyDown=P,this.providedIsEmpty=I}postConstruct(){this.createManagedBean(new Au(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach(e=>this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)}))}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;let e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&(this.providedIsEmpty?this.providedIsEmpty():Cu(this.eFocusableElement,".ag-tab-guard").length===0)){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;let t=e.target===this.eBottomGuard;!(this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t))&&this.forceFocusOutWhenTabGuardsAreEmpty&&this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}findNextElementOutsideAndFocus(e){let t=Vs(this.beans),i=Cu(t.body,null,!0),s=i.indexOf(e?this.eTopGuard:this.eBottomGuard);if(s===-1)return;let n,o;e?(n=0,o=s):(n=s+1,o=i.length);let l=i.slice(n,o),d=this.gos.get("tabIndex");l.sort((p,y)=>{let C=parseInt(p.getAttribute("tabindex")||"0"),S=parseInt(y.getAttribute("tabindex")||"0");return S===d?1:C===d?-1:C===0?1:S===0?-1:C-S}),l[e?l.length-1:0]?.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;let t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();let i=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),i&&(i.focus(),e.preventDefault())}focusInnerElement(e=!1){let t=Cu(this.eFocusableElement);return this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length?(t[e?t.length-1:0].focus({preventScroll:!0}),!0):!1}getNextFocusableElement(e){return Cc(this.beans,this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;let t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},$H=class extends Be{constructor(e){super(),this.comp=e}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();let{eTopGuard:t,eBottomGuard:i,eFocusableElement:s}=this,n=[t,i],o={setTabIndex:G=>{n.forEach(X=>G!=null?X.setAttribute("tabindex",G):X.removeAttribute("tabindex"))}};this.addTabGuards(t,i);let{focusTrapActive:l=!1,onFocusIn:d,onFocusOut:p,focusInnerElement:y,handleKeyDown:C,onTabKeyDown:S,shouldStopEventPropagation:P,isEmpty:I,forceFocusOutWhenTabGuardsAreEmpty:O,isFocusableContainer:V}=e;this.tabGuardCtrl=this.createManagedBean(new jH({comp:o,focusTrapActive:l,eTopGuard:t,eBottomGuard:i,eFocusableElement:s,onFocusIn:d,onFocusOut:p,focusInnerElement:y,handleKeyDown:C,onTabKeyDown:S,shouldStopEventPropagation:P,isEmpty:I,forceFocusOutWhenTabGuardsAreEmpty:O,isFocusableContainer:V}))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){let t=Vs(this.beans).createElement("div"),i=e==="top"?qw.TAB_GUARD_TOP:qw.TAB_GUARD_BOTTOM;return t.classList.add(qw.TAB_GUARD,i),tl(t,"presentation"),t}addTabGuards(e,t){let i=this.eFocusableElement;i.insertAdjacentElement("afterbegin",e),i.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){let e=[this.eTopGuard,this.eBottomGuard];Ns(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(e=!1){this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,i){ZC(t)||(t=t.getGui());let{eBottomGuard:s}=this;s?s.insertAdjacentElement("beforebegin",t):e(t,i)}destroy(){let{eTopGuard:e,eBottomGuard:t}=this;yo(e),yo(t),super.destroy()}},NM=class extends ii{initialiseTabGuard(e){this.tabGuardFeature=this.createManagedBean(new $H(this)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(e=!1){this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}},sc=class{constructor(e,t=!1){this.DOUBLE_TAP_MILLIS=500,this.destroyFuncs=[],this.touching=!1,this.localEventService=new dc,this.preventMouseClick=t;let i=this.onTouchStart.bind(this),s=this.onTouchMove.bind(this),n=this.onTouchEnd.bind(this);e.addEventListener("touchstart",i,{passive:!0}),e.addEventListener("touchmove",s,{passive:!0}),e.addEventListener("touchend",n,{passive:!1}),this.destroyFuncs.push(()=>{e.removeEventListener("touchstart",i,{passive:!0}),e.removeEventListener("touchmove",s,{passive:!0}),e.removeEventListener("touchend",n,{passive:!1})})}getActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}addEventListener(e,t){this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService.removeEventListener(e,t)}onTouchStart(e){if(this.touching)return;this.touchStart=e.touches[0],this.touching=!0,this.moved=!1;let t=this.touchStart;window.setTimeout(()=>{let i=this.touchStart===t;if(this.touching&&i&&!this.moved){this.moved=!0;let s={type:"longTap",touchStart:this.touchStart,touchEvent:e};this.localEventService.dispatchEvent(s)}},500)}onTouchMove(e){if(!this.touching)return;let t=this.getActiveTouch(e.touches);if(!t)return;!mP(t,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(e){if(this.touching){if(!this.moved){let t={type:"tap",touchStart:this.touchStart};this.localEventService.dispatchEvent(t),this.checkForDoubleTap()}this.preventMouseClick&&e.cancelable&&e.preventDefault(),this.touching=!1}}checkForDoubleTap(){let e=Date.now();if(this.lastTapTime&&this.lastTapTime>0)if(e-this.lastTapTime>this.DOUBLE_TAP_MILLIS){let i={type:"doubleTap",touchStart:this.touchStart};this.localEventService.dispatchEvent(i),this.lastTapTime=null}else this.lastTapTime=e;else this.lastTapTime=e}destroy(){this.destroyFuncs.forEach(e=>e())}};var qH=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=e.scrollAxis.indexOf("x")!==-1,this.scrollVertically=e.scrollAxis.indexOf("y")!==-1,this.scrollByTick=e.scrollByTick!=null?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}check(e,t=!1){let i=t||this.shouldSkipVerticalScroll();if(i&&this.shouldSkipHorizontalScroll())return;let s=this.scrollContainer.getBoundingClientRect(),n=this.scrollByTick;this.tickLeft=e.clientX<s.left+n,this.tickRight=e.clientX>s.right-n,this.tickUp=e.clientY<s.top+n&&!i,this.tickDown=e.clientY>s.bottom-n&&!i,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;let e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){let t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){let t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},yb=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.batchFrameworkComps=!1,this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t(),this.baseDocLink=`${wP}/${this.frameworkName}-data-grid`,uB(this.baseDocLink)}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return`${this.baseDocLink}${e?`/${e}`:""}`}};function ZH(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionSvc").api}}var KH=["licenseManager","environment","eventSvc","gos","paginationAutoPageSizeSvc","apiFunctionSvc","gridApi","registry","agCompUtils","userCompFactory","rowContainerHeight","horizontalResizeSvc","localeSvc","pinnedRowModel","dragSvc","colGroupSvc","visibleCols","popupSvc","selectionSvc","colFilter","quickFilter","filterManager","colModel","headerNavigation","pageBounds","pagination","pageBoundsListener","rowSpanSvc","stickyRowSvc","rowRenderer","expressionSvc","alignedGridsSvc","navigation","valueCache","valueSvc","autoWidthCalc","filterMenuFactory","dragAndDrop","focusSvc","cellNavigation","cellStyles","scrollVisibleSvc","sortSvc","colHover","colAnimation","autoColSvc","selectionColSvc","changeDetectionSvc","animationFrameSvc","undoRedo","colDefFactory","rowStyleSvc","rowNodeBlockLoader","rowNodeSorter","ctrlsSvc","pinnedCols","dataTypeSvc","syncSvc","overlays","stateSvc","expansionSvc","apiEventSvc","ariaAnnounce","menuSvc","colMoves","colAutosize","colFlex","colResize","pivotColsSvc","valueColsSvc","rowGroupColsSvc","colNames","colViewport","pivotResultCols","showRowGroupCols","validation"],CE=Object.fromEntries(KH.map((e,t)=>[e,t]));function XH(e,t){let i=(e.beanName?CE[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER,s=(t.beanName?CE[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER;return i-s}function YH(e,t){return e?.beanName==="gridDestroySvc"?-1:t?.beanName==="gridDestroySvc"?1:0}var QH={tag:"div",cls:"ag-pinned-left-header",role:"rowgroup"},JH={tag:"div",cls:"ag-pinned-right-header",role:"rowgroup"},eN={tag:"div",cls:"ag-header-viewport",role:"rowgroup",attrs:{tabindex:"-1"},children:[{tag:"div",ref:"eCenterContainer",cls:"ag-header-container",role:"presentation"}]},Zw=class extends ii{constructor(e){super(),this.eCenterContainer=ot,this.headerRowComps={},this.rowCompsList=[],this.pinned=e}postConstruct(){this.selectAndSetTemplate();let e={setDisplayed:i=>this.setDisplayed(i),setCtrls:i=>this.setCtrls(i),setCenterWidth:i=>this.eCenterContainer.style.width=i,setViewportScrollLeft:i=>this.getGui().scrollLeft=i,setPinnedContainerWidth:i=>{let s=this.getGui();s.style.width=i,s.style.maxWidth=i,s.style.minWidth=i}};this.createManagedBean(new vH(this.pinned)).setComp(e,this.getGui())}selectAndSetTemplate(){let e=this.pinned=="left",t=this.pinned=="right",i=e?QH:t?JH:eN;this.setTemplate(i),this.eRowContainer=this.eCenterContainer!==ot?this.eCenterContainer:this.getGui()}destroy(){this.setCtrls([]),super.destroy()}destroyRowComp(e){this.destroyBean(e),this.eRowContainer.removeChild(e.getGui())}setCtrls(e){let t=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[];let i,s=n=>{let o=n.getGui();o.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(o),i&&uP(this.eRowContainer,o,i),i=o};e.forEach(n=>{let o=n.instanceId,l=t[o];delete t[o];let d=l||this.createBean(new pH(n));this.headerRowComps[o]=d,this.rowCompsList.push(d),s(d)}),Object.values(t).forEach(n=>this.destroyRowComp(n))}},tN={tag:"div",cls:"ag-header",role:"presentation"},iN=class extends ii{constructor(){super(tN)}postConstruct(){let e={toggleCss:(s,n)=>this.toggleCss(s,n),setHeightAndMinHeight:s=>{this.getGui().style.height=s,this.getGui().style.minHeight=s}};this.createManagedBean(new rH).setComp(e,this.getGui(),this.getFocusableElement());let i=s=>{this.createManagedBean(s),this.appendChild(s)};i(new Zw("left")),i(new Zw(null)),i(new Zw("right"))}},sN={selector:"AG-HEADER-ROOT",component:iN},oN=class extends ii{constructor(e,t,i,s,n){super(),this.cellCtrl=t,this.rendererVersion=0,this.editorVersion=0,this.beans=e,this.gos=e.gos,this.column=t.column,this.rowNode=t.rowNode,this.eRow=s;let o=rs({tag:"div",role:t.getCellAriaRole(),attrs:{"comp-id":`${this.getCompId()}`,"col-id":t.column.colIdSanitised}});this.eCell=o;let l;t.isCellSpanning()?(l=rs({tag:"div",cls:"ag-spanned-cell-wrapper",role:"presentation"}),l.appendChild(o),this.setTemplateFromElement(l)):this.setTemplateFromElement(o),this.cellCssManager=new XP(()=>o),this.forceWrapper=t.isForceWrapper(),this.refreshWrapper(!1);let d={toggleCss:(p,y)=>this.cellCssManager.toggleCss(p,y),setUserStyles:p=>og(o,p),getFocusableElement:()=>o,setIncludeSelection:p=>this.includeSelection=p,setIncludeRowDrag:p=>this.includeRowDrag=p,setIncludeDndSource:p=>this.includeDndSource=p,setRenderDetails:(p,y,C)=>this.setRenderDetails(p,y,C),setEditDetails:(p,y,C)=>this.setEditDetails(p,y,C),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue(),refreshEditStyles:(p,y)=>this.refreshEditStyles(p,y)};t.setComp(d,o,l,this.eCellWrapper,i,n,void 0)}getParentOfValue(){return this.eCellValue??this.eCellWrapper??this.eCell}setRenderDetails(e,t,i){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=this.firstRender==null;let n=this.refreshWrapper(!1);this.refreshEditStyles(!1),e?!(i||n)&&this.refreshCellRenderer(e)||(this.destroyRenderer(),this.createCellRendererInstance(e)):(this.destroyRenderer(),this.insertValueWithoutCellRenderer(t)),this.rowDraggingComp?.refreshVisibility()}setEditDetails(e,t,i){e?this.createCellEditorInstance(e,t,i):this.destroyEditor()}removeControls(){let e=this.beans.context;this.checkboxSelectionComp=e.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=e.destroyBean(this.dndSourceComp),this.rowDraggingComp=e.destroyBean(this.rowDraggingComp)}refreshWrapper(e){let t=this.includeRowDrag||this.includeDndSource||this.includeSelection,i=t||this.forceWrapper,s=i&&this.eCellWrapper==null;s&&(this.eCellWrapper=rs({tag:"div",cls:"ag-cell-wrapper",role:"presentation"}),this.eCell.appendChild(this.eCellWrapper));let n=!i&&this.eCellWrapper!=null;n&&(yo(this.eCellWrapper),this.eCellWrapper=void 0),this.cellCssManager.toggleCss("ag-cell-value",!i);let o=!e&&i,l=o&&this.eCellValue==null;l&&(this.eCellValue=rs({tag:"span",cls:"ag-cell-value",role:"presentation"}),this.eCellWrapper.appendChild(this.eCellValue));let d=!o&&this.eCellValue!=null;d&&(yo(this.eCellValue),this.eCellValue=void 0);let p=s||n||l||d;return p&&this.removeControls(),!e&&t&&this.addControls(),p}addControls(){let{cellCtrl:e,eCellWrapper:t,eCellValue:i,includeRowDrag:s,includeDndSource:n,includeSelection:o}=this,l=d=>{d&&t.insertBefore(d.getGui(),i)};s&&this.rowDraggingComp==null&&(this.rowDraggingComp=e.createRowDragComp(),l(this.rowDraggingComp)),n&&this.dndSourceComp==null&&(this.dndSourceComp=e.createDndSource(),l(this.dndSourceComp)),o&&this.checkboxSelectionComp==null&&(this.checkboxSelectionComp=e.createSelectionCheckbox(),l(this.checkboxSelectionComp))}createCellEditorInstance(e,t,i){let s=this.editorVersion,n=e.newAgStackInstance(),{params:o}=e;n.then(d=>this.afterCellEditorCreated(s,d,o,t,i)),Di(this.cellEditor)&&o.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(e){let t=this.getParentOfValue();Ns(t);let i=Iu(e);i!=null&&(t.textContent=i)}destroyRenderer(){let{context:e}=this.beans;this.cellRenderer=e.destroyBean(this.cellRenderer),yo(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){let{context:e}=this.beans;(this.cellEditorPopupWrapper?.getGui().contains(zi(this.beans))||this.cellCtrl.hasBrowserFocus())&&this.eCell.focus({preventScroll:!0}),this.hideEditorPopup?.(),this.hideEditorPopup=void 0,this.cellEditor=e.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=e.destroyBean(this.cellEditorPopupWrapper),yo(this.cellEditorGui),this.cellCtrl.disableEditorTooltipFeature(),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(e){if(this.cellRenderer?.refresh==null||this.cellRendererClass!==e.componentClass)return!1;let t=this.cellRenderer.refresh(e.params);return t===!0||t===void 0}createCellRendererInstance(e){let t=this.rendererVersion,i=o=>l=>{if(this.rendererVersion!==t||!this.isAlive())return;let p=o.newAgStackInstance(),y=this.afterCellRendererCreated.bind(this,t,o.componentClass);p?.then(y)},{animationFrameSvc:s}=this.beans,n;if(s?.active&&this.firstRender?n=(o,l=!1)=>{s.createTask(i(o),this.rowNode.rowIndex,"p2",o.componentFromFramework,l)}:n=o=>i(o)(),e.params?.deferRender&&!this.cellCtrl.rowNode.group){let{loadingComp:o,onReady:l}=this.cellCtrl.getDeferLoadingCellRenderer();o&&(n(o),l.then(()=>n(e,!0)))}else n(e)}afterCellRendererCreated(e,t,i){if(!this.isAlive()||e!==this.rendererVersion){this.beans.context.destroyBean(i);return}this.cellRenderer=i,this.cellRendererClass=t;let n=i.getGui();if(this.cellRendererGui=n,n!=null){let o=this.getParentOfValue();Ns(o),o.appendChild(n)}}afterCellEditorCreated(e,t,i,s,n){let o=e!==this.editorVersion,{context:l}=this.beans;if(o){l.destroyBean(t);return}if(t.isCancelBeforeStart&&t.isCancelBeforeStart()){l.destroyBean(t),this.cellCtrl.stopEditing(!0);return}if(!t.getGui){je(97,{colId:this.column.getId()}),l.destroyBean(t);return}this.cellEditor=t,this.cellEditorGui=t.getGui();let p=s||t.isPopup!==void 0&&t.isPopup();p?this.addPopupCellEditor(i,n):this.addInCellEditor(),this.refreshEditStyles(!0,p),t.afterGuiAttached?.(),this.cellCtrl.enableEditorTooltipFeature(t),this.cellCtrl.cellEditorAttached()}refreshEditStyles(e,t){let{cellCssManager:i}=this;i.toggleCss("ag-cell-inline-editing",e&&!t),i.toggleCss("ag-cell-popup-editing",e&&!!t),i.toggleCss("ag-cell-not-inline-editing",!e||!!t)}addInCellEditor(){let{eCell:e}=this;e.contains(zi(this.beans))&&e.focus(),this.destroyRenderer(),this.refreshWrapper(!0),Ns(this.getParentOfValue()),this.cellEditorGui&&this.getParentOfValue().appendChild(this.cellEditorGui)}addPopupCellEditor(e,t){let{gos:i,context:s,popupSvc:n,editSvc:o}=this.beans;i.get("editType")==="fullRow"&&je(98);let l=this.cellEditorPopupWrapper=s.createBean(o.createPopupEditorWrapper(e)),{cellEditor:d,cellEditorGui:p,eCell:y,rowNode:C,column:S,cellCtrl:P}=this,I=l.getGui();p&&I.appendChild(p);let O=i.get("stopEditingWhenCellsLoseFocus"),V=t??d.getPopupPosition?.()??"over",G=i.get("enableRtl"),X={ePopup:I,column:S,rowNode:C,type:"popupCellEditor",eventSource:y,position:V,alignSide:G?"right":"left",keepWithinBounds:!0},Q=n.positionPopupByComponent.bind(n,X),ae=n.addPopup({modal:O,eChild:I,closeOnEsc:!0,closedCallback:()=>{P.onPopupEditorClosed()},anchorToElement:y,positionCallback:Q,ariaOwns:y});ae&&(this.hideEditorPopup=ae.hideFunc)}detach(){this.eRow.removeChild(this.getGui())}destroy(){this.destroyRenderer(),this.destroyEditor(),this.removeControls(),super.destroy()}},nN=class extends ii{constructor(e,t,i){super(),this.cellComps=new Map,this.beans=t,this.rowCtrl=e;let s=rs({tag:"div",role:"row",attrs:{"comp-id":`${this.getCompId()}`}});this.setInitialStyle(s,i),this.setTemplateFromElement(s);let n=s.style;this.domOrder=this.rowCtrl.getDomOrder();let o={setDomOrder:l=>this.domOrder=l,setCellCtrls:l=>this.setCellCtrls(l),showFullWidth:l=>this.showFullWidth(l),getFullWidthCellRenderer:()=>this.fullWidthCellRenderer,getFullWidthCellRendererParams:()=>this.fullWidthCellRendererParams,toggleCss:(l,d)=>this.toggleCss(l,d),setUserStyles:l=>og(s,l),setTop:l=>n.top=l,setTransform:l=>n.transform=l,setRowIndex:l=>s.setAttribute("row-index",l),setRowId:l=>s.setAttribute("row-id",l),setRowBusinessKey:l=>s.setAttribute("row-business-key",l),refreshFullWidth:l=>{let d=l();return this.fullWidthCellRendererParams=d,this.fullWidthCellRenderer?.refresh?.(d)??!1}};e.setComp(o,this.getGui(),i,void 0),this.addDestroyFunc(()=>{e.unsetComp(i)})}setInitialStyle(e,t){let i=this.rowCtrl.getInitialTransform(t);if(i)e.style.setProperty("transform",i);else{let s=this.rowCtrl.getInitialRowTop(t);s&&e.style.setProperty("top",s)}}showFullWidth(e){let t=s=>{if(this.isAlive()){let n=s.getGui();this.getGui().appendChild(n),this.rowCtrl.setupDetailRowAutoHeight(n),this.setFullWidthRowComp(s,e.params)}else this.beans.context.destroyBean(s)};e.newAgStackInstance().then(t)}setCellCtrls(e){let t=new Map(this.cellComps);for(let i of e){let s=i.instanceId;this.cellComps.has(s)?t.delete(s):this.newCellComp(i)}this.destroyCells(t),this.ensureDomOrder(e)}ensureDomOrder(e){if(!this.domOrder)return;let t=[];for(let i of e){let s=this.cellComps.get(i.instanceId);s&&t.push(s.getGui())}dP(this.getGui(),t)}newCellComp(e){let t=this.beans.editSvc?.isEditing(e,{withOpenEditor:!0})??!1,i=new oN(this.beans,e,this.rowCtrl.printLayout,this.getGui(),t);this.cellComps.set(e.instanceId,i),this.getGui().appendChild(i.getGui())}destroy(){super.destroy(),this.destroyCells(this.cellComps)}setFullWidthRowComp(e,t){this.fullWidthCellRenderer=e,this.fullWidthCellRendererParams=t,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer),this.fullWidthCellRendererParams=void 0})}destroyCells(e){for(let t of e.values()){if(!t)return;let i=t.cellCtrl.instanceId;if(this.cellComps.get(i)!==t)return;t.detach(),t.destroy(),this.cellComps.delete(i)}}};function rN(e,t,i){let s=!!i.gos.get("enableCellSpan")&&!!t.getSpannedRowCtrls,n={tag:"div",ref:"eContainer",cls:jm(e),role:"rowgroup"};if(t.type==="center"||s){let o={tag:"div",ref:"eSpannedContainer",cls:`ag-spanning-container ${DV(e)}`,role:"presentation"};return n.role="presentation",{tag:"div",ref:"eViewport",cls:`ag-viewport ${MM(e)}`,role:"rowgroup",children:[n,s?o:null]}}return n}var aN=class extends ii{constructor(e){super(),this.eViewport=ot,this.eContainer=ot,this.eSpannedContainer=ot,this.rowCompsNoSpan={},this.rowCompsWithSpan={},this.name=e?.name,this.options=lg(this.name)}postConstruct(){this.setTemplate(rN(this.name,this.options,this.beans));let e={setHorizontalScroll:i=>this.eViewport.scrollLeft=i,setViewportHeight:i=>this.eViewport.style.height=i,setRowCtrls:({rowCtrls:i})=>this.setRowCtrls(i),setSpannedRowCtrls:i=>this.setRowCtrls(i,!0),setDomOrder:i=>{this.domOrder=i},setContainerWidth:i=>{this.eContainer.style.width=i,this.eSpannedContainer&&(this.eSpannedContainer.style.width=i)},setOffsetTop:i=>{let s=`translateY(${i})`;this.eContainer.style.transform=s,this.eSpannedContainer&&(this.eSpannedContainer.style.transform=s)}};this.createManagedBean(new HV(this.name)).setComp(e,this.eContainer,this.eSpannedContainer,this.eViewport)}destroy(){this.setRowCtrls([]),this.setRowCtrls([],!0),super.destroy(),this.lastPlacedElement=null}setRowCtrls(e,t){let{beans:i,options:s}=this,n=t?this.eSpannedContainer:this.eContainer,o=t?Se({},this.rowCompsWithSpan):Se({},this.rowCompsNoSpan),l={};t?this.rowCompsWithSpan=l:this.rowCompsNoSpan=l,this.lastPlacedElement=null;let d=[];for(let p of e){let y=p.instanceId,C=o[y],S;if(C)S=C,delete o[y];else{if(!p.rowNode.displayed)continue;S=new nN(p,i,s.type)}l[y]=S,d.push([S,!C])}this.removeOldRows(Object.values(o),n),this.addRowNodes(d,n)}addRowNodes(e,t){let{domOrder:i}=this;for(let[s,n]of e){let o=s.getGui();i?this.ensureDomOrder(o,t):n&&t.appendChild(o)}}removeOldRows(e,t){for(let i of e)t.removeChild(i.getGui()),i.destroy()}ensureDomOrder(e,t){uP(t,e,this.lastPlacedElement),this.lastPlacedElement=e}},lN={selector:"AG-ROW-CONTAINER",component:aN};function Dp(e,t){return t.map(i=>{let s=`e${i[0].toUpperCase()+i.substring(1)}RowContainer`;return e[s]={name:i},{tag:"ag-row-container",ref:s,attrs:{name:i}}})}function cN(e){let t={},i={tag:"div",ref:"eGridRoot",cls:"ag-root ag-unselectable",children:[{tag:"ag-header-root"},{tag:"div",ref:"eTop",cls:"ag-floating-top",role:"presentation",children:Dp(t,["topLeft","topCenter","topRight","topFullWidth"])},{tag:"div",ref:"eBody",cls:"ag-body",role:"presentation",children:[{tag:"div",ref:"eBodyViewport",cls:"ag-body-viewport",role:"presentation",children:Dp(t,["left","center","right","fullWidth"])},{tag:"ag-fake-vertical-scroll"}]},{tag:"div",ref:"eStickyTop",cls:"ag-sticky-top",role:"presentation",children:Dp(t,["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"])},{tag:"div",ref:"eStickyBottom",cls:"ag-sticky-bottom",role:"presentation",children:Dp(t,["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"])},{tag:"div",ref:"eBottom",cls:"ag-floating-bottom",role:"presentation",children:Dp(t,["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"])},{tag:"ag-fake-horizontal-scroll"},e?{tag:"ag-overlay-wrapper"}:null]};return{paramsMap:t,elementParams:i}}var hN=class extends ii{constructor(){super(...arguments),this.eGridRoot=ot,this.eBodyViewport=ot,this.eStickyTop=ot,this.eStickyBottom=ot,this.eTop=ot,this.eBottom=ot,this.eBody=ot}postConstruct(){let{overlays:e,rangeSvc:t}=this.beans,i=e?.getOverlayWrapperSelector(),{paramsMap:s,elementParams:n}=cN(!!i);this.setTemplate(n,[...i?[i]:[],qV,XV,sN,lN],s);let o=(d,p)=>{let y=`${d}px`;p.style.minHeight=y,p.style.height=y},l={setRowAnimationCssOnBodyViewport:(d,p)=>this.setRowAnimationCssOnBodyViewport(d,p),setColumnCount:d=>A4(this.getGui(),d),setRowCount:d=>I4(this.getGui(),d),setTopHeight:d=>o(d,this.eTop),setBottomHeight:d=>o(d,this.eBottom),setTopInvisible:d=>this.eTop.classList.toggle("ag-invisible",d),setBottomInvisible:d=>this.eBottom.classList.toggle("ag-invisible",d),setStickyTopHeight:d=>this.eStickyTop.style.height=d,setStickyTopTop:d=>this.eStickyTop.style.top=d,setStickyTopWidth:d=>this.eStickyTop.style.width=d,setStickyBottomHeight:d=>{this.eStickyBottom.style.height=d,this.eStickyBottom.classList.toggle("ag-invisible",d==="0px")},setStickyBottomBottom:d=>this.eStickyBottom.style.bottom=d,setStickyBottomWidth:d=>this.eStickyBottom.style.width=d,setColumnMovingCss:(d,p)=>this.toggleCss(d,p),updateLayoutClasses:(d,p)=>{let y=[this.eBodyViewport.classList,this.eBody.classList];for(let C of y)C.toggle(xn.AUTO_HEIGHT,p.autoHeight),C.toggle(xn.NORMAL,p.normal),C.toggle(xn.PRINT,p.print);this.toggleCss(xn.AUTO_HEIGHT,p.autoHeight),this.toggleCss(xn.NORMAL,p.normal),this.toggleCss(xn.PRINT,p.print)},setAlwaysVerticalScrollClass:(d,p)=>this.eBodyViewport.classList.toggle(FM,p),registerBodyViewportResizeListener:d=>{let p=nl(this.beans,this.eBodyViewport,d);this.addDestroyFunc(()=>p())},setPinnedTopBottomOverflowY:d=>this.eTop.style.overflowY=this.eBottom.style.overflowY=d,setCellSelectableCss:(d,p)=>{[this.eTop,this.eBodyViewport,this.eBottom].forEach(y=>y.classList.toggle(d,p))},setBodyViewportWidth:d=>this.eBodyViewport.style.width=d,setGridRootRole:d=>tl(this.eGridRoot,d)};this.ctrl=this.createManagedBean(new WV),this.ctrl.setComp(l,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop,this.eStickyBottom),(t&&ta(this.gos)||Kp(this.gos))&&F4(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(e,t){let i=this.eBodyViewport.classList;i.toggle("ag-row-animation",t),i.toggle("ag-row-no-animation",!t)}},uN={selector:"AG-GRID-BODY",component:hN},dN=class extends Be{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}setComp(e,t,i){this.view=e,this.eGridHostDiv=t,this.eGui=i,this.eGui.setAttribute("grid-id",this.beans.context.getId());let{dragAndDrop:s,ctrlsSvc:n}=this.beans;s?.registerGridDropTarget(()=>this.eGui,this),this.createManagedBean(new hb(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr");let o=nl(this.beans,this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>o()),n.register("gridCtrl",this)}isDetailGrid(){return rM(this.getGui())?.getAttribute("row-id")?.startsWith("detail")||!1}getOptionalSelectors(){let e=this.beans;return{paginationSelector:e.pagination?.getPaginationSelector(),gridHeaderDropZonesSelector:e.registry?.getSelector("AG-GRID-HEADER-DROP-ZONES"),sideBarSelector:e.sideBar?.getSelector(),statusBarSelector:e.registry?.getSelector("AG-STATUS-BAR"),watermarkSelector:e.licenseManager?.getWatermarkSelector()}}onGridSizeChanged(){this.eventSvc.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){let{view:t}=this;if(e===!1)t.setCursor(null);else{let i=e===1?"ew-resize":"ns-resize";t.setCursor(i)}}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){let t=this.getFocusableContainers(),{indexWithFocus:i,nextIndex:s}=this.getNextFocusableIndex(t,e);if(s<0||s>=t.length)return!1;if(s===0){if(i>0){let{visibleCols:n,focusSvc:o}=this.beans,l=n.allCols,d=di(l);if(o.focusGridView({column:d,backwards:!0}))return!0}return!1}return this.focusContainer(t[s],e)}focusInnerElement(e){let t=this.gos.getCallback("focusGridInnerElement");if(t&&t({fromBottom:!!e}))return!0;let i=this.getFocusableContainers(),{focusSvc:s,visibleCols:n}=this.beans,o=n.allCols;if(e){if(i.length>1)return this.focusContainer(di(i),e);let l=di(o);if(s.focusGridView({column:l,backwards:e}))return!0}if(this.gos.get("headerHeight")===0||hc(this.beans)){if(s.focusGridView({column:o[0],backwards:e}))return!0;for(let l=1;l<i.length;l++)if(gc(i[l].getGui(),e))return!0;return!1}return s.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){let t=this.view.getFocusableContainers(),{nextIndex:i,indexWithFocus:s}=this.getNextFocusableIndex(t,e);if(s===-1||i<0||i>=t.length)return;let n=t[i];n.setAllowFocus?.(!0),setTimeout(()=>{n.setAllowFocus?.(!1)})}isFocusable(){let e=this.beans;return!_v(e)||!hc(e)||!!e.sideBar?.comp?.isDisplayed()}getNextFocusableIndex(e,t){let i=zi(this.beans),s=e.findIndex(o=>o.getGui().contains(i)),n=s+(t?-1:1);return{indexWithFocus:s,nextIndex:n}}focusContainer(e,t){e.setAllowFocus?.(!0);let i=gc(e.getGui(),t,!1,!0);return e.setAllowFocus?.(!1),i}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},pN=class extends NM{constructor(e){super(),this.gridBody=ot,this.sideBar=ot,this.pagination=ot,this.rootWrapperBody=ot,this.eGridDiv=e}postConstruct(){let e={destroyGridUi:()=>this.destroyBean(this),setRtlClass:o=>this.addCss(o),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:o=>{this.getGui().style.userSelect=o??"",this.getGui().style.webkitUserSelect=o??""},setCursor:o=>{this.getGui().style.cursor=o??""}},t=this.createManagedBean(new dN),i=t.getOptionalSelectors(),s=this.createTemplate(i),n=[uN,...Object.values(i).filter(o=>!!o)];this.setTemplate(s,n),t.setComp(e,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:o=>t.focusInnerElement(o),forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:()=>!t.isFocusable()})}insertGridIntoDom(){let e=this.getGui();this.eGridDiv.appendChild(e),this.addDestroyFunc(()=>{this.eGridDiv.removeChild(e),il(this.gos,"Grid removed from DOM")})}updateLayoutClasses(e,t){let i=this.rootWrapperBody.classList,{AUTO_HEIGHT:s,NORMAL:n,PRINT:o}=xn,{autoHeight:l,normal:d,print:p}=t;i.toggle(s,l),i.toggle(n,d),i.toggle(o,p),this.toggleCss(s,l),this.toggleCss(n,d),this.toggleCss(o,p)}createTemplate(e){let t=e.gridHeaderDropZonesSelector?{tag:"ag-grid-header-drop-zones"}:null,i=e.sideBarSelector?{tag:"ag-side-bar",ref:"sideBar"}:null,s=e.statusBarSelector?{tag:"ag-status-bar"}:null,n=e.watermarkSelector?{tag:"ag-watermark"}:null,o=e.paginationSelector?{tag:"ag-pagination",ref:"pagination"}:null;return{tag:"div",cls:"ag-root-wrapper",role:"presentation",children:[t,{tag:"div",ref:"rootWrapperBody",cls:"ag-root-wrapper-body",role:"presentation",children:[{tag:"ag-grid-body",ref:"gridBody"},i]},s,o,n]}}getFocusableElement(){return this.rootWrapperBody}forceFocusOutOfContainer(e=!1){if(!e&&this.pagination?.isDisplayed()){this.pagination.forceFocusOutOfContainer(e);return}super.forceFocusOutOfContainer(e)}getFocusableContainers(){let e=[this.gridBody];return[this.sideBar,this.pagination].forEach(t=>{t&&e.push(t)}),e.filter(t=>ur(t.getGui()))}},Mt=(e,t)=>{for(let i of Object.keys(t))t[i]=e;return t},bE=Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se(Se({dispatchEvent:"CommunityCore"},Mt("CommunityCore",{destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0,isModuleRegistered:0})),Mt("GridState",{getState:0,setState:0})),Mt("SharedRowSelection",{setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0})),Mt("RowApi",{redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRowIndex:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0})),Mt("ScrollApi",{getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0})),Mt("KeyboardNavigation",{getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0})),Mt("EventApi",{addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0})),Mt("ValueCache",{expireValueCache:0})),Mt("CellApi",{getCellValue:0})),Mt("SharedMenu",{showColumnMenu:0,hidePopupMenu:0})),Mt("Sort",{onSortChanged:0})),Mt("PinnedRow",{getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0,forEachPinnedRow:0})),Mt("Overlay",{showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0})),Mt("RenderApi",{setGridAriaProperty:0,refreshCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0})),Mt("HighlightChanges",{flashCells:0})),Mt("RowDrag",{addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0,getRowDropPositionIndicator:0,setRowDropPositionIndicator:0})),Mt("ColumnApi",{getColumnDefs:0,getColumnDef:0,getDisplayNameForColumn:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnsVisible:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0})),Mt("ColumnAutoSize",{sizeColumnsToFit:0,autoSizeColumns:0,autoSizeAllColumns:0})),Mt("ColumnGroup",{setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumnGroup:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0})),Mt("ColumnMove",{moveColumnByIndex:0,moveColumns:0})),Mt("ColumnResize",{setColumnWidths:0})),Mt("ColumnHover",{isColumnHovered:0})),Mt("EditCore",{getCellEditorInstances:0,getEditingCells:0,getEditRowValues:0,stopEditing:0,startEditingCell:0,isEditing:0,validateEdit:0})),Mt("BatchEdit",{startBatchEdit:0,cancelBatchEdit:0,commitBatchEdit:0,isBatchEditing:0})),Mt("UndoRedoEdit",{undoCellEditing:0,redoCellEditing:0,getCurrentUndoSize:0,getCurrentRedoSize:0})),Mt("FilterCore",{isAnyFilterPresent:0,onFilterChanged:0})),Mt("ColumnFilter",{isColumnFilterPresent:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0,hideColumnFilter:0,getColumnFilterHandler:0,doFilterAction:0})),Mt("QuickFilter",{isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0})),Mt("Find",{findGetActiveMatch:0,findGetTotalMatches:0,findGoTo:0,findNext:0,findPrevious:0,findGetNumMatches:0,findGetParts:0,findClearActive:0,findRefresh:0})),Mt("Pagination",{paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0})),Mt("CsrmSsrmSharedApi",{expandAll:0,collapseAll:0})),Mt("SsrmInfiniteSharedApi",{setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0})),Mt("ClientSideRowModelApi",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0,onRowHeightChanged:0,resetRowHeights:0})),Mt("CsvExport",{getDataAsCsv:0,exportDataAsCsv:0})),Mt("InfiniteRowModel",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0})),Mt("AdvancedFilter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0})),Mt("IntegratedCharts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0})),Mt("Clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0})),Mt("ExcelExport",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0})),Mt("SharedMasterDetail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0})),Mt("ContextMenu",{showContextMenu:0})),Mt("ColumnMenu",{showColumnChooser:0,hideColumnChooser:0})),Mt("CellSelection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0})),Mt("SharedRowGrouping",{setRowGroupColumns:0,removeRowGroupColumns:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0})),Mt("SharedAggregation",{addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0})),Mt("SharedPivot",{isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumns:0,addValueColumns:0,setPivotColumns:0,removePivotColumns:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0})),Mt("ServerSideRowModelApi",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0,onRowHeightChanged:0,resetRowHeights:0})),Mt("SideBar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0})),Mt("StatusBar",{getStatusPanel:0})),Kw={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},gN=(e,t)=>e.eventSvc.dispatchEvent(t),GM=class{};Reflect.defineProperty(GM,"name",{value:"GridApi"});var fN=class extends Be{constructor(){super(),this.beanName="apiFunctionSvc",this.api=new GM,this.fns=ht(Se({},Kw),{dispatchEvent:gN}),this.preDestroyLink="";let{api:e}=this;for(let t of Object.keys(bE))e[t]=this.makeApi(t)[t]}postConstruct(){this.preDestroyLink=this.beans.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){let{fns:i,beans:s}=this;i!==Kw&&(i[e]=s?.validation?.validateApiFunction(e,t)??t)}makeApi(e){return{[e]:(...t)=>{let{beans:i,fns:{[e]:s}}=this;return s?s(i,...t):this.apiNotFound(e)}}}apiNotFound(e){let{beans:t,gos:i,preDestroyLink:s}=this;if(!t)je(26,{fnName:e,preDestroyLink:s});else{let n=bE[e];i.assertModuleRegistered(n,`api.${e}`)&&je(27,{fnName:e,module:n})}}destroy(){super.destroy(),this.fns=Kw,this.beans=null}};function mN(e){return e.context.getId()}function vN(e){e.gridDestroySvc.destroy()}function yN(e){return e.gridDestroySvc.destroyCalled}function wN(e,t){return e.gos.get(t)}function CN(e,t,i){WM(e,{[t]:i})}function WM(e,t){e.gos.updateGridOptions({options:t})}function bN(e,t){let i=t.replace(/Module$/,"");return e.gos.isModuleRegistered(i)}var xN={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{draggable:"true"}},_N=class extends ii{constructor(e,t,i){super(xN),this.rowNode=e,this.column=t,this.eCell=i}postConstruct(){this.getGui().appendChild(tn("rowDrag",this.beans,null)),this.addGuiEventListener("mousedown",t=>{t.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){let{rowNode:t,column:i,eCell:s,gos:n}=this,o=i.getColDef().dndSourceOnRowDrag,l=e.dataTransfer;if(l.setDragImage(s,0,0),o){let d=bt(n,{rowNode:t,dragEvent:e});o(d)}else try{let d=JSON.stringify(t.data);l.setData("application/json",d),l.setData("text/plain",d)}catch{}}checkVisibility(){let e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}};function SN(e,t){e.rowDragSvc?.rowDragFeature?.addRowDropZone(t)}function RN(e,t){let i=e.dragAndDrop?.findExternalZone(t.getContainer());i&&e.dragAndDrop?.removeDropTarget(i)}function EN(e,t){return e.rowDragSvc?.rowDragFeature?.getRowDropZone(t)}function PN(e){let t=e.rowDropHighlightSvc;return t?{row:t.row,dropIndicatorPosition:t.position}:{row:null,dropIndicatorPosition:"none"}}function MN(e,t){let i=e.rowDropHighlightSvc;if(!i)return;let s=t?.row,n=t?.dropIndicatorPosition;n!=="above"&&n!=="below"&&n!=="inside"&&(n="none");let o=s?.rowIndex;o==null||n==="none"?i.clear():i.set(s,n)}var TN=class extends j8{shouldPreventMouseEvent(e){return this.gos.get("enableCellTextSelection")&&super.shouldPreventMouseEvent(e)}},DN=class extends Be{constructor(){super(...arguments),this.beanName="horizontalResizeSvc"}addResizeBar(e){let t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0},{dragSvc:i}=this.beans;return i.addDragSource(t),()=>i.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();let i=t instanceof MouseEvent&&t.shiftKey===!0;e.onResizeStart(i)}setResizeIcons(){let e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(1),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){let e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},FN={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{"aria-hidden":"true"}},IN=class extends ii{constructor(e,t,i,s,n,o=!1){super(),this.cellValueFn=e,this.rowNode=t,this.column=i,this.customGui=s,this.dragStartPixels=n,this.alwaysVisible=o,this.dragSource=null}isCustomGui(){return this.customGui!=null}postConstruct(){let{beans:e,customGui:t}=this;t?this.setDragElement(t,this.dragStartPixels):(this.setTemplate(FN),this.getGui().appendChild(tn("rowDrag",e,null)),this.addDragSource()),this.alwaysVisible||this.initCellDrag()}initCellDrag(){let{beans:e,gos:t,rowNode:i}=this,s=this.refreshVisibility.bind(this);this.addManagedPropertyListener("suppressRowDrag",s),this.addManagedListeners(i,{dataChanged:s,cellChanged:s}),this.addManagedListeners(e.eventSvc,t.get("rowDragManaged")?{sortChanged:s,filterChanged:s,columnRowGroupChanged:s,newColumnsLoaded:s}:{newColumnsLoaded:s})}setDragElement(e,t){this.setTemplateFromElement(e,void 0,void 0,!0),this.addDragSource(t)}refreshVisibility(){if(this.alwaysVisible)return;let e={skipAriaHidden:!0};if(this.isNeverDisplayed()){this.setDisplayed(!1,e);return}let t=this.column,i=typeof t?.getColDef().rowDrag=="function",s=!t||this.isCustomGui()||t.isRowDrag(this.rowNode);s&&this.rowNode.footer&&this.gos.get("rowDragManaged")&&(s=!1,i=!0),this.setDisplayed(i||s,e),this.setVisible(s,e)}isNeverDisplayed(){let{gos:e,beans:t}=this;return!!(e.get("suppressRowDrag")||e.get("rowDragManaged")&&t.rowDragSvc.rowDragFeature?.shouldPreventRowMove()&&!t.dragAndDrop?.hasExternalDropZones())}getSelectedNodes(){let e=this.rowNode;if(!this.gos.get("rowDragMultiRow"))return[e];let i=this.beans.selectionSvc?.getSelectedNodes()??[];return i.indexOf(e)!==-1?i:[e]}getDragItem(){let{column:e,rowNode:t}=this;return{rowNode:t,rowNodes:this.getSelectedNodes(),columns:e?[e]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(e){if(e){let t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gos.get("rowDragText")}addDragSource(e=4){if(this.dragSource&&this.removeDragSource(),this.gos.get("rowDragManaged")&&this.rowNode.footer)return;let t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:s=>{s?.preventDefault()}})[0]);let i=this.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:s=>{let n=s?.dragItem||this.getDragItem(),o=(s?.dropTarget?.rows.length??n.rowNodes?.length)||1,l=this.getRowDragText(this.column);return l?l(n,o):o===1?this.cellValueFn():`${o} ${i("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDrop.addDragSource(this.dragSource,!0)}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}};function oa(e){let t=e.rowModel;return t.getType()==="clientSide"?t:void 0}function Rv(e){let t=e.rowModel;return t.getType()==="infinite"?t:void 0}function kN(e){let t=e.rowModel;return t.getType()==="serverSide"?t:void 0}function AN(e){let{rowIndex:t,rowPinned:i,column:s}=e;return`${t}.${i??"null"}.${s.getId()}`}function UM(e,t){let i=e.column===t.column,s=e.rowPinned===t.rowPinned,n=e.rowIndex===t.rowIndex;return i&&s&&n}function LN(e,t){switch(e.rowPinned){case"top":if(t.rowPinned!=="top")return!0;break;case"bottom":if(t.rowPinned!=="bottom")return!1;break;default:if(st(t.rowPinned))return t.rowPinned!=="top";break}return e.rowIndex<t.rowIndex}function ON(e,t){return!e&&!t?!0:e&&!t||!e&&t?!1:e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned}function zN(e){let t=0,i,{pinnedRowModel:s,rowModel:n,pageBounds:o}=e;return s?.getPinnedTopRowCount()?i="top":n.getRowCount()?(i=null,t=o.getFirstRow()):s?.getPinnedBottomRowCount()&&(i="bottom"),i===void 0?null:{rowIndex:t,rowPinned:i}}function BN(e){let t,i=null,{pinnedRowModel:s,pageBounds:n}=e,o=s?.getPinnedBottomRowCount(),l=s?.getPinnedTopRowCount();return o?(i="bottom",t=o-1):e.rowModel.getRowCount()?(i=null,t=n.getLastRow()):l&&(i="top",t=l-1),t===void 0?null:{rowIndex:t,rowPinned:i}}function ia(e,t){switch(t.rowPinned){case"top":return e.pinnedRowModel?.getPinnedTopRow(t.rowIndex);case"bottom":return e.pinnedRowModel?.getPinnedBottomRow(t.rowIndex);default:return e.rowModel.getRow(t.rowIndex)}}function gu(e,t){let i=e.spannedRowRenderer?.getCellByPosition(t);if(i)return i;let s=e.rowRenderer.getRowByPosition(t);return s?s.getCellCtrl(t.column):null}function VN(e,t,i){let{rowModel:s,pinnedRowModel:n}=e,o;return o??(o=s?.getRowNode(t)),i?o??(o=n?.getPinnedRowById(t,i)):(o??(o=n?.getPinnedRowById(t,"top")),o??(o=n?.getPinnedRowById(t,"bottom"))),o}function dv(e,t,i=!1){let{rowIndex:s,rowPinned:n}=t,{pageBounds:o,pinnedRowModel:l,rowModel:d}=e;if(s===0)return n==="top"?null:n==="bottom"&&d.isRowsToRender()?{rowIndex:o.getLastRow(),rowPinned:null}:l?.isRowsToRender("top")?{rowIndex:l.getPinnedTopRowCount()-1,rowPinned:"top"}:null;if(i){let p=n?void 0:d.getRow(s);return jM(e,p,!0)??{rowIndex:s-1,rowPinned:n}}return{rowIndex:s-1,rowPinned:n}}function xE(e,t,i=!1){let{rowIndex:s,rowPinned:n}=t,{pageBounds:o,pinnedRowModel:l,rowModel:d}=e;if(HN(e,t))return n==="bottom"?null:n==="top"&&d.isRowsToRender()?{rowIndex:o.getFirstRow(),rowPinned:null}:l?.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;if(i){let p=n?void 0:d.getRow(s);return jM(e,p)??{rowIndex:s+1,rowPinned:n}}return{rowIndex:s+1,rowPinned:n}}function jM(e,t,i=!1){let{gos:s,rowRenderer:n}=e;if(!t?.sticky||!PP(s))return;let o=n.getStickyTopRowCtrls(),l=n.getStickyBottomRowCtrls(),d=!l.some(S=>S.rowNode.rowIndex===t.rowIndex),p=d?o:l,y=(i?-1:1)*(d?-1:1),C;for(let S=0;S<p.length;S++)if(p[S].rowNode.rowIndex===t.rowIndex){C=p[S+y];break}return C?{rowIndex:C.rowNode.rowIndex,rowPinned:null}:void 0}function HN(e,t){let{rowPinned:i,rowIndex:s}=t,{pinnedRowModel:n,pageBounds:o}=e;return i==="top"?(n?.getPinnedTopRowCount()??0)-1<=s:i==="bottom"?(n?.getPinnedBottomRowCount()??0)-1<=s:o.getLastRow()<=s}var eg=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}depthFirstSearchChangedPath(e,t){let{rowNode:i,children:s}=e;if(s)for(let n=0;n<s.length;++n)this.depthFirstSearchChangedPath(s[n],t);t(i)}depthFirstSearchEverything(e,t,i){let s=e.childrenAfterGroup;if(s)for(let n=0,o=s.length;n<o;++n){let l=s[n];l.childrenAfterGroup?this.depthFirstSearchEverything(l,t,i):i&&t(l)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,i=!1){this.active&&!i?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,i=0;for(;!this.mapToItems[t.id];){let s={rowNode:t,children:null};this.mapToItems[t.id]=s,i++,t=t.parent}return i}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let i=e;for(;i;)this.nodeIdsToColumns[i.id]||(this.nodeIdsToColumns[i.id]={}),t.forEach(s=>this.nodeIdsToColumns[i.id][s.getId()]=!0),i=i.parent}linkPathItems(e,t){let i=e;for(let s=0;s<t;s++){let n=this.mapToItems[i.id],o=this.mapToItems[i.parent.id];o.children||(o.children=[]),o.children.push(n),i=i.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;let i=this.createPathItems(e);this.linkPathItems(e,i),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;let i=this.nodeIdsToColumns[e.id];return t.filter(n=>i[n.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;let i=this.nodeIdsToColumns[e.id];return t.filter(n=>!i[n.getId()])}},NN=class{constructor(e,t){this.beans=e,this.groupThrottled=!1,this.oldVScroll=null,this.groupTimer=null,this.groupTarget=null,this.onGroupThrottle=()=>{this.groupTimer=null,this.groupThrottled=!0,this.beans.dragAndDrop?.nudge()};let i=()=>t.scrollFeature.getVScrollPosition().top;this.autoScroll=new qH({scrollContainer:t.eBodyViewport,scrollAxis:"y",getVerticalPosition:i,setVerticalPosition:s=>t.scrollFeature.setVerticalScrollPosition(s),onScrollCallback:()=>{let s=i(),n=this.oldVScroll;this.oldVScroll=s,n!==null&&n!==s&&this.beans.dragAndDrop?.nudge()}})}updateGroup(e,t){this.groupTarget&&this.groupTarget!==e&&this.clearGroup(),e&&(t&&this.groupThrottled&&!e.expanded&&e.childrenAfterSort?.length&&e.isExpandable()&&e.setExpanded(!0,void 0,!0),e.expanded&&e.childrenAfterSort?.length&&(this.groupThrottled=!0,this.groupTarget=e))}startGroup(e){this.groupTarget=e,this.groupTimer===null&&(this.groupTimer=window.setTimeout(this.onGroupThrottle,this.beans.gos.get("rowDragInsertDelay")))}clearGroup(){this.groupThrottled=!1,this.groupTarget=null;let e=this.groupTimer;e!==null&&(this.groupTimer=null,window.clearTimeout(e))}clear(){this.clearGroup(),this.autoScroll.ensureCleared(),this.oldVScroll=null}},GN=class extends Be{constructor(e){super(),this.eContainer=e,this.lastDraggingEvent=null,this.nudger=null}postConstruct(){let e=this.beans;this.clientSideRowModel=oa(e),e.ctrlsSvc.whenReady(this,t=>{this.nudger=new NN(e,t.gridBodyCtrl)})}destroy(){super.destroy(),this.nudger?.clear(),this.nudger=null,this.lastDraggingEvent=null,this.eContainer=null}getContainer(){return this.eContainer}isInterestedIn(e){return e===2}getIconName(e){return e?.dropTarget?.allowed===!1||this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?"notAllowed":"move"}shouldPreventRowMove(){let{rowGroupColsSvc:e,filterManager:t,sortSvc:i}=this.beans;return!!((e?.columns??[]).length||t?.isAnyFilterPresent()||i?.isSortActive())}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];let t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){let i=this.beans.selectionSvc?.getSelectedNodes();if(i&&i.indexOf(t)>=0)return i.slice().sort(jN)}return[t]}onDragEnter(e){this.dragging(e,!0)}onDragging(e){this.dragging(e,!1)}dragging(e,t){let{lastDraggingEvent:i,beans:s}=this;if(t){let l=this.getRowNodes(e);e.dragItem.rowNodes=l,RE(l,!0)}this.lastDraggingEvent=e;let n=e.fromNudge,o=this.makeRowsDrop(i,e,n,!1);s.rowDropHighlightSvc?.fromDrag(e),t&&this.dispatchGridEvent("rowDragEnter",e),this.dispatchGridEvent("rowDragMove",e),!n&&o?.rowDragManaged&&o.moved&&o.allowed&&o.sameGrid&&!o.suppressMoveWhenRowDragging&&this.dropRows(o),this.nudger?.autoScroll.check(e.event)}isFromThisGrid(e){return e.dragSource.dragSourceDomDataKey===this.gos.getDomDataKey()}makeRowsDrop(e,t,i,s){let{beans:n,gos:o,clientSideRowModel:l}=this,d=this.newRowsDrop(t,s);if(t.dropTarget=d,t.changed=!1,!d)return null;let{sameGrid:p,rootNode:y,source:C,target:S,rows:P}=d;S??(S=l.getRow(l.getRowCount()-1)??null);let O=LP(o)!=="group"&&p,V=null;if(S?.footer){let me=$m(l,-1,S)??$m(l,1,S);V=S.sibling??y,S=me??null}S?.detail&&(S=S.parent),d.moved&&(d.moved=C!==S);let G=.5;if(S&&(p&&d.moved&&(V||!O)?G=C.rowIndex>S.rowIndex?-.5:.5:G=(d.y-S.rowTop-S.rowHeight/2)/S.rowHeight||0),!O&&p&&S&&d.moved){let me=$N(l,d);me&&(G=C.rowIndex>me.rowIndex?-.5:.5,S=me,d.moved&&(d.moved=C!==S))}let X=this.nudger;X?.updateGroup(S,i),O&&!V&&X&&(!S||G>=.5&&S.rowIndex===n.pageBounds.getLastRow()?V=y:d.moved&&this.targetShouldBeParent(S,G,P)&&(X.groupThrottled&&(V=S),!i&&(!V||S&&!S.expanded&&S.childrenAfterSort?.length)&&X.startGroup(S)),V??(V=S?.parent??y));let Q=!1;if(V){if(V===S&&V!==y){let me=V.expanded?$m(l,1,S):null;me?.parent===V?(S=me,G=-.5):Q=!0}if(S&&!Q){let me=S;for(;me&&me!==y&&me!==V;)S=me,me=me.parent}}d.target=S,d.newParent=V,d.moved&&(d.moved=C!==S);let ae=G<0?"above":"below";return d.position=d.moved?Q?"inside":ae:"none",this.validateRowsDrop(d,O,ae,s),t.changed||(t.changed=UN(e?.dropTarget,d)),d}newRowsDrop(e,t){let{beans:i,gos:s,clientSideRowModel:n}=this,o=n.rootNode,l=s.get("rowDragManaged"),d=s.get("suppressMoveWhenRowDragging"),p=this.isFromThisGrid(e),{rowNode:y,rowNodes:C}=e.dragItem;if(C||(C=y?[y]:[]),y||(y=C[0]),!y||!o)return null;let S=this.beans.dragAndDrop.isDropZoneWithinThisGrid(e),P=!0;l&&(!C.length||this.shouldPreventRowMove()||(d||!p)&&!S)&&(P=!1);let I=hE(i,e).y,O=this.getOverNode(I);return{api:i.gridApi,context:i.gridOptions.context,draggingEvent:e,rowDragManaged:l,suppressMoveWhenRowDragging:d,sameGrid:p,withinGrid:S,rootNode:o,moved:y!==O,y:I,overNode:O,overIndex:O?.rowIndex??-1,position:"none",source:y,target:O??null,newParent:null,rows:C,allowed:P,highlight:!t&&l&&d&&(S||!p)}}validateRowsDrop(e,t,i,s){let{rowDragManaged:n,suppressMoveWhenRowDragging:o}=e;t||(e.newParent=null),o&&!e.moved&&(e.allowed=!1);let l=(!n||e.allowed)&&this.gos.get("isRowValidDropPosition");if(l){t&&e.newParent&&_E(e.rows,e.newParent)&&(e.newParent=null);let d=l(e);if(!d)e.allowed=!1;else if(typeof d=="object"){d.rows!==void 0&&(e.rows=d.rows??[]),t&&d.newParent!==void 0&&(e.newParent=d.newParent),d.target!==void 0&&(e.target=d.target),d.position&&(e.position=d.position),d.allowed!==void 0?e.allowed=d.allowed:n||(e.allowed=!0);let p=e.draggingEvent;d.changed&&p&&(p.changed=!0),!s&&d.highlight!==void 0&&(e.highlight=d.highlight)}}n&&(e.rows=this.filterRows(e)),t&&e.newParent&&_E(e.rows,e.newParent)&&(e.newParent=null),o&&(!e.rows.length||e.position==="none")&&(e.allowed=!1),(!e.allowed||!e.newParent)&&e.position==="inside"&&(e.position=i)}targetShouldBeParent(e,t,i){let s=e.rowIndex,n=.25;if(t<-.5+n)return!1;if(t<.5-n)return!0;let o,l=s+1,d=this.clientSideRowModel;do o=d.getRow(l++);while(o&&o.footer);let p=e.childrenAfterGroup;if(o&&o.parent===e&&p?.length){let y=new Set(i);for(let C of p)if(C.rowIndex!==null&&!y.has(C))return!0}return!1}addRowDropZone(e){if(!e.getContainer()){je(55);return}let t=this.beans.dragAndDrop;if(t.findExternalZone(e.getContainer())){je(56);return}let i=e.fromGrid?e:{getContainer:e.getContainer,onDragEnter:e.onDragEnter&&(n=>e.onDragEnter(this.rowDragEvent("rowDragEnter",n))),onDragLeave:e.onDragLeave&&(n=>e.onDragLeave(this.rowDragEvent("rowDragLeave",n))),onDragging:e.onDragging&&(n=>e.onDragging(this.rowDragEvent("rowDragMove",n))),onDragStop:e.onDragStop&&(n=>e.onDragStop(this.rowDragEvent("rowDragEnd",n))),onDragCancel:e.onDragCancel&&(n=>e.onDragCancel(this.rowDragEvent("rowDragCancel",n)))},s=Se({isInterestedIn:n=>n===2,getIconName:()=>"move",external:!0},i);t.addDropTarget(s),this.addDestroyFunc(()=>t.removeDropTarget(s))}getRowDropZone(e){return{getContainer:this.getContainer.bind(this),onDragEnter:i=>{this.onDragEnter(i),e?.onDragEnter?.(this.rowDragEvent("rowDragEnter",i))},onDragLeave:i=>{this.onDragLeave(i),e?.onDragLeave?.(this.rowDragEvent("rowDragLeave",i))},onDragging:i=>{this.onDragging(i),e?.onDragging?.(this.rowDragEvent("rowDragMove",i))},onDragStop:i=>{this.onDragStop(i),e?.onDragStop?.(this.rowDragEvent("rowDragEnd",i))},onDragCancel:i=>{this.onDragCancel(i),e?.onDragCancel?.(this.rowDragEvent("rowDragCancel",i))},fromGrid:!0}}getOverNode(e){let{pageBounds:t,rowModel:i}=this.beans,n=e>t.getCurrentPagePixelRange().pageLastPixel?-1:i.getRowIndexAtPixel(e);return n>=0?i.getRow(n):void 0}rowDragEvent(e,t){let i=this.beans,{dragItem:s,dropTarget:n,event:o,vDirection:l}=t,d=n?.rootNode===this.clientSideRowModel.rootNode,p=d?n.y:hE(i,t).y,y=d?n.overNode:this.getOverNode(p),C=d?n.overIndex:y?.rowIndex??-1;return{api:i.gridApi,context:i.gridOptions.context,type:e,event:o,node:s.rowNode,nodes:s.rowNodes,overIndex:C,overNode:y,y:p,vDirection:l,rowsDrop:n}}dispatchGridEvent(e,t){let i=this.rowDragEvent(e,t);this.eventSvc.dispatchEvent(i)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e)}onDragStop(e){let t=this.makeRowsDrop(this.lastDraggingEvent,e,!1,!0);this.dispatchGridEvent("rowDragEnd",e),t?.allowed&&t.rowDragManaged&&(t.suppressMoveWhenRowDragging||!t.sameGrid)&&this.dropRows(t),this.stopDragging(e)}onDragCancel(e){this.dispatchGridEvent("rowDragCancel",e),this.stopDragging(e)}stopDragging(e){this.nudger?.clear(),this.beans.rowDropHighlightSvc?.fromDrag(null),RE(e.dragItem.rowNodes,!1)}dropRows(e){return e.sameGrid?this.moveRows(e):this.addRows(e)}addRows({position:e,target:t,rows:i}){let s=Pu(this.gos),n=this.clientSideRowModel,o=i.filter(({data:d,rowPinned:p})=>!n.getRowNode(s?.({data:d,level:0,rowPinned:p})??d.id)).map(({data:d})=>d);if(o.length===0)return!1;let l=t?SE(t)+(e==="above"?0:1):void 0;return n.updateRowData({add:o,addIndex:l}),!0}filterRows({newParent:e,rows:t}){let i=this.clientSideRowModel,s;for(let n=0,o=t.length;n<o;++n){let l=!0,d=t[n];!d||d.footer||d.rowTop===null&&d!==i.getRowNode(d.id)||e&&d.parent!==e&&WN(d,e)?l=!1:TC(d)||(l=!1),l?s?.push(d):s??(s=t.slice(0,n))}return s??t}moveRows({position:e,target:t,rows:i,newParent:s,rootNode:n}){let o=!1,l=new Set;for(let C of i){s&&C.parent!==s&&(C.treeParent=s,o=!0);let S=TC(C);S&&l.add(S)}if(!o&&l.size===0)return!1;let d=this.beans.focusSvc,p=d.getFocusedCell(),y=p&&gu(this.beans,p);return l.size&&this.reorderLeafChildren(l,...this.getMoveRowsBounds(l,t,e==="above"))&&(o=!0),o?(this.clientSideRowModel.refreshModel({step:"group",keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedPath:new eg(!1,n),rowNodesOrderChanged:!0}),y?y.focusCell():d.clearFocusedCell(),!0):!1}getMoveRowsBounds(e,t,i){let s=this.clientSideRowModel.rootNode?.allLeafChildren.length??0,n=SE(t);n<0||n>=s?n=s:i||++n;let o=n,l=Math.min(n,s-1);for(let d of e){let p=d.sourceRowIndex;p<o&&(o=p),p>l&&(l=p)}return[o,n,l]}reorderLeafChildren(e,t,i,s){let n=!1,o=this.clientSideRowModel.rootNode?.allLeafChildren;if(!e.size||!o)return!1;let l=t;for(let p=t;p<i;++p){let y=o[p];e.has(y)||(y.sourceRowIndex!==l&&(y.sourceRowIndex=l,o[l]=y,n=!0),++l)}let d=s;for(let p=s;p>=i;--p){let y=o[p];e.has(y)||(y.sourceRowIndex!==d&&(y.sourceRowIndex=d,o[d]=y,n=!0),--d)}for(let p of e)p.sourceRowIndex!==l&&(p.sourceRowIndex=l,o[l]=p,n=!0),++l;return n}},$m=(e,t,i)=>{if(i){let s=e.getRowCount(),n=i.rowIndex+t;for(;n>=0&&n<s;){let o=e.getRow(n);if(!o||!o.footer&&!o.detail)return o;n+=t}}},WN=(e,t)=>{let i=t;for(;i;){if(i===e)return!0;i=i.parent}return!1},_E=(e,t)=>{for(let i=0,s=e.length;i<s;++i)if(e[i].parent!==t)return!1;return!0},SE=e=>{let t=TC(e);return t!==void 0?t.sourceRowIndex:-1},TC=e=>{for(;e;){if(e.sourceRowIndex>=0)return e;let t=e.childrenAfterGroup;if(!t?.length)return;e=t[0]}},UN=(e,t)=>e!==t&&(!e||e.sameGrid!==t.sameGrid||e.allowed!==t.allowed||e.position!==t.position||e.target!==t.target||e.source!==t.source||e.newParent!==t.newParent||!rl(e.rows,t.rows)),jN=({rowIndex:e},{rowIndex:t})=>e!==null&&t!==null?e-t:0,RE=(e,t)=>{for(let i=0,s=e?.length||0;i<s;++i){let n=e[i];n.dragging!==t&&(n.dragging=t,n.dispatchRowEvent("draggingChanged"))}},$N=(e,t)=>{let i=null,s=t.target;if(s&&t.rows.indexOf(s)<0)return null;let n=t.source;if(!s||!n)return null;let o=s.rowIndex-n.rowIndex,l=o<0?-1:1;o=t.suppressMoveWhenRowDragging?Math.abs(o):1;let d=new Set(t.rows);do{let p=$m(e,l,s);if(!p)break;d.has(p)||(i=p,--o),s=p}while(o>0);return i},qN=class extends Be{constructor(){super(...arguments),this.beanName="rowDragSvc"}setupRowDrag(e,t){let i=t.createManagedBean(new GN(e)),s=this.beans.dragAndDrop;s.addDropTarget(i),t.addDestroyFunc(()=>s.removeDropTarget(i)),this.rowDragFeature=i}createRowDragComp(e,t,i,s,n,o){return new IN(e,t,i,s,n,o)}createRowDragCompForRow(e,t){if(ta(this.gos))return;let i=this.getLocaleTextFunc();return this.createRowDragComp(()=>`1 ${i("rowDragRow","row")}`,e,void 0,t,void 0,!0)}createRowDragCompForCell(e,t,i,s,n,o){let l=this.gos;return l.get("rowDragManaged")&&(!Ms(l)||l.get("pagination"))?void 0:this.createRowDragComp(i,e,t,s,n,o)}},ZN=class extends Be{constructor(){super(...arguments),this.beanName="rowDropHighlightSvc",this.uiLevel=0,this.dragging=!1,this.row=null,this.position="none"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this)})}onModelUpdated(){let e=this.row,t=this.dragging;!e||e.rowIndex===null||this.position==="none"?this.clear():this.set(e,this.position),this.dragging=t}destroy(){this.clear(),super.destroy()}clear(){let e=this.row;this.dragging=!1,e&&(this.uiLevel=0,this.position="none",this.row=null,e.dispatchRowEvent("rowHighlightChanged"))}set(e,t){let i=e!==this.row,s=e.uiLevel,n=t!==this.position,o=s!==this.uiLevel;this.dragging=!1,(i||n||o)&&(i&&this.clear(),this.uiLevel=s,this.position=t,this.row=e,e.dispatchRowEvent("rowHighlightChanged"))}fromDrag(e){let t=e?.dropTarget;if(t){let{highlight:i,target:s,position:n}=t;if(i&&s&&n!=="none"){this.set(s,n),this.dragging=!0;return}}this.dragging&&this.clear()}},$M={moduleName:"Drag",version:nt,beans:[TN]},KN={moduleName:"DragAndDrop",version:nt,dynamicBeans:{dndSourceComp:_N},icons:{rowDrag:"grip"}},qM={moduleName:"SharedDragAndDrop",version:nt,beans:[q8],dependsOn:[$M],userComponents:{agDragAndDropImage:EH},icons:{columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",rowDrag:"grip"}},XN={moduleName:"RowDrag",version:nt,beans:[ZN,qN],apiFunctions:{addRowDropZone:SN,removeRowDropZone:RN,getRowDropZoneParams:EN,getRowDropPositionIndicator:PN,setRowDropPositionIndicator:MN},dependsOn:[qM]},YN={moduleName:"HorizontalResize",version:nt,beans:[DN],dependsOn:[$M]},QN=":where(.ag-ltr) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:left .2s}.ag-header-group-cell{transition:left .2s,width .2s}}:where(.ag-rtl) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:right .2s}.ag-header-group-cell{transition:right .2s,width .2s}}",JN=class extends Be{constructor(){super(...arguments),this.beanName="colAnimation",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){if(this.active)return;let{gos:e}=this;e.get("suppressColumnMoveAnimation")||e.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush(()=>this.activeNext=!1,()=>this.active=!1)}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;let e=this.animationThreadCount,{gridBodyCtrl:t}=this;t.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&t.setColumnMovingCss(!1)})}flush(e,t){let{executeNextFuncs:i,executeLaterFuncs:s}=this;if(i.length===0&&s.length===0){e(),t();return}let n=o=>{for(;o.length;){let l=o.pop();l&&l()}};this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e(),n(i)},0),window.setTimeout(()=>{t(),n(s)},200)})}};function eG(e,t,i){e.colMoves?.moveColumnByIndex(t,i,"api")}function tG(e,t,i){e.colMoves?.moveColumns(t,i,"api")}var iG=class extends Be{constructor(e){super(),this.pinned=e,this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[]}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;let t=e.dragItem.columns;t&&t.forEach(i=>{i.isPrimary()&&(i.isAnyFunctionActive()||(i.isAllowValue()?this.columnsToAggregate.push(i):i.isAllowRowGroup()?this.columnsToGroup.push(i):i.isAllowPivot()&&this.columnsToPivot.push(i)))})}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){let{valueColsSvc:t,rowGroupColsSvc:i,pivotColsSvc:s}=this.beans;this.columnsToAggregate.length>0&&t?.addColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&i?.addColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&s?.addColumns(this.columnsToPivot,"toolPanelDragAndDrop")}onDragCancel(){this.clearColumnsList()}};function sG(e,t){!t||t.length<=1||t.filter(s=>e.indexOf(s)<0).length>0||t.sort((s,n)=>{let o=e.indexOf(s),l=e.indexOf(n);return o-l})}function oG(e){let t=[...e];return e.forEach(i=>{let s=null,n=i.getParent();for(;n!=null&&n.getDisplayedLeafColumns().length===1;)s=n,n=n.getParent();s!=null&&(!!s.getColGroupDef()?.marryChildren?s.getProvidedColumnGroup().getLeafColumns():s.getLeafColumns()).forEach(d=>{t.includes(d)||t.push(d)})}),t}function nG(e,t,i,s){let n=s.allCols,o=null,l=null;for(let d=0;d<e.length;d++){let p=e[d],y=i.getProposedColumnOrder(t,p);if(!i.doesOrderPassRules(y))continue;let C=y.filter(P=>n.includes(P));if(l===null)l=C;else if(!rl(C,l))break;let S=aG(y);(o===null||S<o.fragCount)&&(o={move:p,fragCount:S})}return o}function ZM(e){let{isFromHeader:t,fromLeft:i,xPosition:s,fromEnter:n,fakeEvent:o,pinned:l,gos:d,colModel:p,colMoves:y,visibleCols:C}=e,{allMovingColumns:S}=e;t&&(S=oG(S));let P=S.slice();sG(p.getCols(),P);let I=cG({movingCols:P,draggingRight:i,xPosition:s,pinned:l,gos:d,colModel:p,visibleCols:C}),O=rG(P,p);if(I.length===0)return;let V=I[0];if(O!==null&&(t||!n)&&!o&&(!i&&V>=O||i&&V<=O))return;let X=nG(I,P,y,C);if(!X)return;let Q=X.move;if(!(Q>p.getCols().length-P.length))return{columns:P,toIndex:Q}}function KM(e){let{columns:t,toIndex:i}=ZM(e)||{},{finished:s,colMoves:n}=e;return!t||i==null?null:(n.moveColumns(t,i,"uiColumnMoved",s),s?null:{columns:t,toIndex:i})}function rG(e,t){let i=t.getCols(),s=e.map(p=>i.indexOf(p)).sort((p,y)=>p-y),n=s[0];return di(s)-n!==s.length-1?null:n}function aG(e){function t(s){let n=[],o=s.getOriginalParent();for(;o!=null;)n.push(o),o=o.getOriginalParent();return n}let i=0;for(let s=0;s<e.length-1;s++){let n=t(e[s]),o=t(e[s+1]);[n,o]=n.length>o.length?[n,o]:[o,n],n.forEach(l=>{o.indexOf(l)===-1&&i++})}return i}function lG(e,t){switch(t){case"left":return e.leftCols;case"right":return e.rightCols;default:return e.centerCols}}function cG(e){let{movingCols:t,draggingRight:i,xPosition:s,pinned:n,gos:o,colModel:l,visibleCols:d}=e;if(o.get("suppressMovableColumns")||t.some(ae=>ae.getColDef().suppressMovable))return[];let y=lG(d,n),C=l.getCols(),S=y.filter(ae=>t.includes(ae)),P=y.filter(ae=>!t.includes(ae)),I=C.filter(ae=>!t.includes(ae)),O=0,V=s;if(i){let ae=0;S.forEach(me=>ae+=me.getActualWidth()),V-=ae}if(V>0){for(let ae=0;ae<P.length;ae++){let me=P[ae];if(V-=me.getActualWidth(),V<0)break;O++}i&&O++}let G;if(O>0){let ae=P[O-1];G=I.indexOf(ae)+1}else G=I.indexOf(P[0]),G===-1&&(G=0);let X=[G],Q=(ae,me)=>ae-me;if(i){let ae=G+1,me=C.length-1;for(;ae<=me;)X.push(ae),ae++;X.sort(Q)}else{let ae=G,me=C.length-1,fe=C[ae];for(;ae<=me&&y.indexOf(fe)<0;)ae++,X.push(ae),fe=C[ae];ae=G-1;let _e=0;for(;ae>=_e;)X.push(ae),ae--;X.sort(Q).reverse()}return X}function DC(e){let{pinned:t,fromKeyboard:i,gos:s,ctrlsSvc:n,useHeaderRow:o,skipScrollPadding:l}=e,d=n.getHeaderRowContainerCtrl(t)?.eViewport,{x:p}=e;return d?(i&&(p-=d.getBoundingClientRect().left),s.get("enableRtl")&&(o&&(d=d.querySelector(".ag-header-row")),p=d.clientWidth-p),t==null&&!l&&(p+=n.get("center").getCenterViewportScrollLeft()),p):0}function Xw(e,t){for(let i of e)i.moving=t,i.dispatchColEvent("movingChanged","uiColumnMoved")}var EE=7,FC=100,Bm=FC/2,hG=5,uG=100,dG=class extends Be{constructor(e){super(),this.pinned=e,this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.isCenterContainer=!st(e)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){let{pinned:e,lastDraggingEvent:t}=this,{dragItem:i}=t||{},s=i?.columns??[];for(let n of s){let o=n.getPinned();if(n.getColDef().lockPinned){if(o==e)return"move";continue}let l=i?.containerType;if(l===e||!e)return"move";if(e&&(!o||l!==e))return"pinned"}return"notAllowed"}onDragEnter(e){let t=e.dragItem,i=t.columns;if(e.dragSource.type===0)this.setColumnsVisible(i,!0,"uiColumnDragged");else{let n=t.visibleState,o=(i||[]).filter(l=>n[l.getId()]&&!l.isVisible());this.setColumnsVisible(o,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(i,this.pinned),this.onDragging(e,!0,!0)}onDragging(e=this.lastDraggingEvent,t=!1,i=!1,s=!1){let{gos:n,ctrlsSvc:o}=this.beans,l=n.get("suppressMoveWhenColumnDragging");if(s&&!l){this.finishColumnMoving();return}if(this.lastDraggingEvent=e,!e||!s&&Di(e.hDirection))return;let d=DC({x:e.x,pinned:this.pinned,gos:n,ctrlsSvc:o});t||this.checkCenterForScrolling(d),l?this.handleColumnDragWhileSuppressingMovement(e,t,i,d,s):this.handleColumnDragWhileAllowingMovement(e,t,i,d,s)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.updateDragItemContainerType(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,i){if(!e?.length)return;let s=e.filter(n=>!n.getColDef().lockVisible);s.length&&this.beans.colModel.setColsVisible(s,t,i)}finishColumnMoving(){this.clearHighlighted();let e=this.lastMovedInfo;if(!e)return;let{columns:t,toIndex:i}=e;this.beans.colMoves.moveColumns(t,i,"uiColumnMoved",!0)}updateDragItemContainerType(){let{lastDraggingEvent:e}=this;if(this.gos.get("suppressMoveWhenColumnDragging")||!e)return;let t=e.dragItem;t&&(t.containerType=this.pinned)}handleColumnDragWhileSuppressingMovement(e,t,i,s,n){let o=this.getAllMovingColumns(e,!0);if(n){let l=this.isAttemptingToPin(o);l&&this.attemptToPinColumns(o,void 0,!0);let{fromLeft:d,xPosition:p}=this.getNormalisedXPositionInfo(o,l)||{};if(d==null||p==null){this.finishColumnMoving();return}this.moveColumnsAfterHighlight({allMovingColumns:o,xPosition:p,fromEnter:t,fakeEvent:i,fromLeft:d})}else{if(!this.beans.dragAndDrop.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(o,s)}}handleColumnDragWhileAllowingMovement(e,t,i,s,n){let o=this.getAllMovingColumns(e),l=this.normaliseDirection(e.hDirection)==="right",d=e.dragSource.type===1,p=this.getMoveColumnParams({allMovingColumns:o,isFromHeader:d,xPosition:s,fromLeft:l,fromEnter:t,fakeEvent:i}),y=KM(ht(Se({},p),{finished:n}));y&&(this.lastMovedInfo=y)}getAllMovingColumns(e,t=!1){let i=e.dragSource.getDragItem(),s=null;t?(s=i.columnsInSplit,s||(s=i.columns)):s=i.columns;let n=o=>o.getColDef().lockPinned?o.getPinned()==this.pinned:!0;return s?s.filter(n):[]}getMoveColumnParams(e){let{allMovingColumns:t,isFromHeader:i,xPosition:s,fromLeft:n,fromEnter:o,fakeEvent:l}=e,{gos:d,colModel:p,colMoves:y,visibleCols:C}=this.beans;return{allMovingColumns:t,isFromHeader:i,fromLeft:n,xPosition:s,pinned:this.pinned,fromEnter:o,fakeEvent:l,gos:d,colModel:p,colMoves:y,visibleCols:C}}highlightHoveredColumn(e,t){let{gos:i,colModel:s}=this.beans,n=i.get("enableRtl"),o=s.getCols().filter(C=>C.isVisible()&&C.getPinned()===this.pinned),l=null,d=null,p=null;for(let C of o){if(d=C.getActualWidth(),l=this.getNormalisedColumnLeft(C,0,n),l!=null){let S=l+d;if(l<=t&&S>=t){p=C;break}}l=null,d=null}if(p)e.indexOf(p)!==-1&&(p=null);else{for(let C=o.length-1;C>=0;C--){let S=o[C],P=o[C].getParent();if(!P){p=S;break}let I=P?.getDisplayedLeafColumns();if(I.length){p=di(I);break}}if(!p)return;l=this.getNormalisedColumnLeft(p,0,n),d=p.getActualWidth()}if(this.lastHighlightedColumn?.column!==p&&this.clearHighlighted(),p==null||l==null||d==null)return;let y;t-l<d/2!==n?y=0:y=1,PE(p,y),this.lastHighlightedColumn={column:p,position:y}}getNormalisedXPositionInfo(e,t){let{gos:i,visibleCols:s}=this.beans,n=i.get("enableRtl"),{firstMovingCol:o,column:l,position:d}=this.getColumnMoveAndTargetInfo(e,t,n);if(!o||!l||d==null)return;let p=s.allCols,y=p.indexOf(o),C=p.indexOf(l),S=d===0!==n,P=y<C||y===C&&!S,I=0;if(S?P&&(I-=1):P||(I+=1),C+I===y)return;let O=p[C+I];if(!O)return;let V=this.getNormalisedColumnLeft(O,20,n);return{fromLeft:P,xPosition:V}}getColumnMoveAndTargetInfo(e,t,i){let s=this.lastHighlightedColumn||{},{firstMovingCol:n,lastMovingCol:o}=pG(e);if(!n||!o||s.column||!t)return Se({firstMovingCol:n},s);let d=this.getPinDirection()==="left";return{firstMovingCol:n,position:d?1:0,column:d!==i?n:o}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case"left":return"right";case"right":return"left"}return e}getNormalisedColumnLeft(e,t,i){let{gos:s,ctrlsSvc:n}=this.beans,o=e.getLeft();if(o==null)return null;let l=e.getActualWidth();return DC({x:i?o+l-t:o+t,pinned:e.getPinned(),useHeaderRow:i,skipScrollPadding:!0,gos:s,ctrlsSvc:n})}isAttemptingToPin(e){let t=this.needToMoveLeft||this.needToMoveRight,i=this.failedMoveAttempts>EE;return t&&i||e.some(s=>s.getPinned()!==this.pinned)}moveColumnsAfterHighlight(e){let{allMovingColumns:t,xPosition:i,fromEnter:s,fakeEvent:n,fromLeft:o}=e,l=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:i,fromLeft:o,fromEnter:s,fakeEvent:n}),{columns:d,toIndex:p}=ZM(l)||{};d&&p!=null&&(this.lastMovedInfo={columns:d,toIndex:p}),this.finishColumnMoving()}clearHighlighted(){let{lastHighlightedColumn:e}=this;e&&(PE(e.column,null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;let t=this.beans.ctrlsSvc.get("center"),i=t.getCenterViewportScrollLeft(),s=i+t.getCenterWidth(),n,o;this.gos.get("enableRtl")?(n=e<i+Bm,o=e>s-Bm):(o=e<i+Bm,n=e>s-Bm),this.needToMoveRight=n,this.needToMoveLeft=o,o||n?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),uG),this.beans.dragAndDrop.setDragImageCompIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.beans.dragAndDrop.setDragImageCompIcon(this.getIconName()))}moveInterval(){let e;this.intervalCount++,e=10+this.intervalCount*hG,e>FC&&(e=FC);let t=null,i=this.gridBodyCon.scrollFeature;if(this.needToMoveLeft?t=i.scrollHorizontally(-e):this.needToMoveRight&&(t=i.scrollHorizontally(e)),t!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;let{pinnedCols:s,dragAndDrop:n,gos:o}=this.beans;if(this.failedMoveAttempts<=EE+1||!s)return;if(n.setDragImageCompIcon("pinned"),!o.get("suppressMoveWhenColumnDragging")){let l=this.lastDraggingEvent?.dragItem.columns;this.attemptToPinColumns(l,void 0,!0)}}}getPinDirection(){if(this.needToMoveLeft||this.pinned==="left")return"left";if(this.needToMoveRight||this.pinned==="right")return"right"}attemptToPinColumns(e,t,i=!1){let s=(e||[]).filter(l=>!l.getColDef().lockPinned);if(!s.length)return 0;i&&(t=this.getPinDirection());let{pinnedCols:n,dragAndDrop:o}=this.beans;return n?.setColsPinned(s,t,"uiColumnDragged"),i&&o.nudge(),s.length}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}};function PE(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchColEvent("headerHighlightChanged","uiColumnMoved"))}function pG(e){let t=e.length,i,s;for(let n=0;n<t;n++){if(!i){let o=e[n];o.getLeft()!=null&&(i=o)}if(!s){let o=e[t-1-n];o.getLeft()!=null&&(s=o)}if(i&&s)break}return{firstMovingCol:i,lastMovingCol:s}}var gG=class extends Be{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){let{ctrlsSvc:e,dragAndDrop:t}=this.beans,i=this.pinned;e.whenReady(this,s=>{let n,o=s.gridBodyCtrl.eBodyViewport;switch(i){case"left":n=[[o,s.left.eContainer],[s.bottomLeft.eContainer],[s.topLeft.eContainer]];break;case"right":n=[[o,s.right.eContainer],[s.bottomRight.eContainer],[s.topRight.eContainer]];break;default:n=[[o,s.center.eViewport],[s.bottomCenter.eViewport],[s.topCenter.eViewport]];break}this.eSecondaryContainers=n}),this.moveColumnFeature=this.createManagedBean(new dG(i)),this.bodyDropPivotTarget=this.createManagedBean(new iG(i)),t.addDropTarget(this),this.addDestroyFunc(()=>t.removeDropTarget(this))}isInterestedIn(e){return e===1||e===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.beans.colModel.isPivotMode()&&e.dragSource.type===0}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},fG=class extends Be{constructor(){super(...arguments),this.beanName="colMoves"}moveColumnByIndex(e,t,i){let s=this.beans.colModel.getCols();if(!s)return;let n=s[e];this.moveColumns([n],t,i)}moveColumns(e,t,i,s=!0){let{colModel:n,colAnimation:o,visibleCols:l,eventSvc:d}=this.beans,p=n.getCols();if(!p)return;if(t>p.length-e.length){je(30,{toIndex:t});return}o?.start();let y=n.getColsForKeys(e);this.doesMovePassRules(y,t)&&($R(n.getCols(),y,t),l.refresh(i),d.dispatchEvent({type:"columnMoved",columns:y,column:y.length===1?y[0]:null,toIndex:t,finished:s,source:i})),o?.finish()}doesMovePassRules(e,t){let i=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(i)}doesOrderPassRules(e){let{colModel:t,gos:i}=this.beans;return!(!UP(e,t.getColTree())||!(n=>{let o=y=>y?y==="left"||y===!0?-1:1:0,l=i.get("enableRtl"),d=l?1:-1,p=!0;return n.forEach(y=>{let C=o(y.getColDef().lockPosition);l?C>d&&(p=!1):C<d&&(p=!1),d=C}),p})(e))}getProposedColumnOrder(e,t){let s=this.beans.colModel.getCols().slice();return $R(s,e,t),s}createBodyDropTarget(e,t){return new gG(e,t)}moveHeader(e,t,i,s,n){let{ctrlsSvc:o,gos:l,colModel:d,visibleCols:p,focusSvc:y}=this.beans,C=t.getBoundingClientRect(),S=C.left,P=ns(i),I=P?C.width:i.getActualWidth(),O=e==="left"!==l.get("enableRtl"),V=DC({x:O?S-20:S+I+20,pinned:s,fromKeyboard:!0,gos:l,ctrlsSvc:o}),G=y.focusedHeader;KM({allMovingColumns:P?i.getLeafColumns():[i],isFromHeader:!0,fromLeft:e==="right",xPosition:V,pinned:s,fromEnter:!1,fakeEvent:!1,gos:l,colModel:d,colMoves:this,visibleCols:p,finished:!0});let X;if(P){let Q=i.getDisplayedLeafColumns();X=O?Q[0]:di(Q)}else X=i;if(o.getScrollFeature().ensureColumnVisible(X,"auto"),(!n.isAlive()||l.get("ensureDomOrder"))&&G){let Q;if(P){let ae=i.getGroupId(),me=i.getLeafColumns();if(!me.length)return;let fe=me[0].getParent();if(!fe)return;Q=mG(fe,ae)}else Q=i;Q&&y.focusHeaderPosition({headerPosition:ht(Se({},G),{column:Q})})}}setDragSourceForHeader(e,t,i){let{gos:s,colModel:n,dragAndDrop:o,visibleCols:l}=this.beans,d=!s.get("suppressDragLeaveHidesColumns"),p=ns(t),y=p?t.getProvidedColumnGroup().getLeafColumns():[t],S={type:1,eElement:e,getDefaultIconName:()=>d?"hide":"notAllowed",getDragItem:p?()=>yG(t,l.allCols):()=>vG(t),dragItemName:i,onDragStarted:()=>{d=!s.get("suppressDragLeaveHidesColumns"),Xw(y,!0)},onDragStopped:()=>Xw(y,!1),onDragCancelled:()=>Xw(y,!1),onGridEnter:P=>{if(d){let{columns:I=[],visibleState:O}=P??{},V=p?X=>!O||O[X.getColId()]:()=>!0,G=I.filter(X=>!X.getColDef().lockVisible&&V(X));n.setColsVisible(G,!0,"uiColumnMoved")}},onGridExit:P=>{if(d){let I=P?.columns?.filter(O=>!O.getColDef().lockVisible)||[];n.setColsVisible(I,!1,"uiColumnMoved")}}};return o.addDragSource(S,!0),S}};function mG(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}}function vG(e){let t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t,containerType:e.pinned}}function yG(e,t){let i=e.getProvidedColumnGroup().getLeafColumns(),s={};i.forEach(d=>s[d.getId()]=d.isVisible());let n=[];t.forEach(d=>{i.indexOf(d)>=0&&(n.push(d),sn(i,d))}),i.forEach(d=>n.push(d));let o=[],l=e.getLeafColumns();for(let d of n)l.indexOf(d)!==-1&&o.push(d);return{columns:n,columnsInSplit:o,visibleState:s,containerType:o[0]?.pinned}}var wG={moduleName:"ColumnMove",version:nt,beans:[fG,JN],apiFunctions:{moveColumnByIndex:eG,moveColumns:tG},dependsOn:[qM],css:[QN]},CG=class extends Be{constructor(){super(...arguments),this.beanName="autoWidthCalc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){let i=this.getHeaderCellForColumn(e);if(!i)return-1;let s=this.beans.rowRenderer.getAllCellsNotSpanningForColumn(e);return t||s.push(i),this.getPreferredWidthForElements(s)}getPreferredWidthForColumnGroup(e){let t=this.getHeaderCellForColumn(e);return t?this.getPreferredWidthForElements([t]):-1}getPreferredWidthForElements(e,t){let i=document.createElement("form");i.style.position="fixed";let s=this.centerRowContainerCtrl.eContainer;e.forEach(o=>this.cloneItemIntoDummy(o,i)),s.appendChild(i);let n=i.offsetWidth;return s.removeChild(i),t=t??this.gos.get("autoSizePadding"),n+t}getHeaderCellForColumn(e){let t=null;return this.beans.ctrlsSvc.getHeaderRowContainerCtrls().forEach(i=>{let s=i.getHtmlElementForColumnHeader(e);s!=null&&(t=s)}),t}cloneItemIntoDummy(e,t){let i=e.cloneNode(!0);i.style.width="",i.style.position="static",i.style.left="";let s=document.createElement("div"),n=s.classList;["ag-header-cell","ag-header-group-cell"].some(d=>i.classList.contains(d))?(n.add("ag-header","ag-header-row"),s.style.position="static"):n.add("ag-row");let l=e.parentElement;for(;l;){if(["ag-header-row","ag-row"].some(p=>l.classList.contains(p))){for(let p=0;p<l.classList.length;p++){let y=l.classList[p];y!="ag-row-position-absolute"&&n.add(y)}break}l=l.parentElement}s.appendChild(i),t.appendChild(s)}},XM={moduleName:"AutoWidth",version:nt,beans:[CG]};function bG(e,t,i=!0,s="api"){e.colResize?.setColumnWidths(t,!1,i,s)}var xG=class extends Be{constructor(e,t,i,s){super(),this.comp=e,this.eResize=t,this.pinned=i,this.columnGroup=s}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}let{horizontalResizeSvc:e,gos:t,colAutosize:i}=this.beans,s=e.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});this.addDestroyFunc(s),!t.get("suppressAutoSize")&&i&&this.addDestroyFunc(i.addColumnGroupResize(this.eResize,this.columnGroup,()=>this.resizeLeafColumnsToFit("uiColumnResized")))}onResizeStart(e){let{columnsToResize:t,resizeStartWidth:i,resizeRatios:s,groupAfterColumns:n,groupAfterStartWidth:o,groupAfterRatios:l}=this.getInitialValues(e);this.resizeCols=t,this.resizeStartWidth=i,this.resizeRatios=s,this.resizeTakeFromCols=n,this.resizeTakeFromStartWidth=o,this.resizeTakeFromRatios=l,this.toggleColumnResizing(!0)}onResizing(e,t,i="uiColumnResized"){let s=this.normaliseDragChange(t),n=this.resizeStartWidth+s;this.resizeColumnsFromLocalValues(n,i,e)}getInitialValues(e){let t=p=>p.reduce((y,C)=>y+C.getActualWidth(),0),i=(p,y)=>p.map(C=>C.getActualWidth()/y),s=this.getColumnsToResize(),n=t(s),o=i(s,n),l={columnsToResize:s,resizeStartWidth:n,resizeRatios:o},d=null;if(e&&(d=this.beans.colGroupSvc?.getGroupAtDirection(this.columnGroup,"After")??null),d){let p=d.getDisplayedLeafColumns(),y=l.groupAfterColumns=p.filter(S=>S.isResizable()),C=l.groupAfterStartWidth=t(y);l.groupAfterRatios=i(y,C)}else l.groupAfterColumns=void 0,l.groupAfterStartWidth=void 0,l.groupAfterRatios=void 0;return l}resizeLeafColumnsToFit(e){let t=this.beans.autoWidthCalc.getPreferredWidthForColumnGroup(this.columnGroup),i=this.getInitialValues();t>i.resizeStartWidth&&this.resizeColumns(i,t,e,!0)}resizeColumnsFromLocalValues(e,t,i=!0){if(!this.resizeCols||!this.resizeRatios)return;let s={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols,groupAfterStartWidth:this.resizeTakeFromStartWidth,groupAfterRatios:this.resizeTakeFromRatios};this.resizeColumns(s,e,t,i)}resizeColumns(e,t,i,s=!0){let{columnsToResize:n,resizeStartWidth:o,resizeRatios:l,groupAfterColumns:d,groupAfterStartWidth:p,groupAfterRatios:y}=e,C=[];if(C.push({columns:n,ratios:l,width:t}),d){let S=t-o;C.push({columns:d,ratios:y,width:p-S})}this.beans.colResize?.resizeColumnSets({resizeSets:C,finished:s,source:i}),s&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.toggleCss("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?this.pinned!=="left"&&(t*=-1):this.pinned==="right"&&(t*=-1),t}destroy(){super.destroy(),this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}},_G=class extends Be{constructor(e,t,i,s,n){super(),this.pinned=e,this.column=t,this.eResize=i,this.comp=s,this.ctrl=n}postConstruct(){let e=[],t,i,s=()=>{if(Ti(this.eResize,t),!t)return;let{horizontalResizeSvc:l,colAutosize:d}=this.beans,p=l.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});e.push(p),i&&d&&e.push(d.addColumnAutosize(this.eResize,this.column))},n=()=>{e.forEach(l=>l()),e.length=0},o=()=>{let l=this.column.isResizable(),d=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(l!==t||d!==i)&&(t=l,i=d,n(),s())};o(),this.addDestroyFunc(n),this.ctrl.setRefreshFunction("resize",o)}onResizing(e,t){let{column:i,lastResizeAmount:s,resizeStartWidth:n,beans:o}=this,l=this.normaliseResizeAmount(t),d=n+l,p=[{key:i,newWidth:d}],{pinnedCols:y,ctrlsSvc:C,colResize:S}=o;if(this.column.getPinned()){let P=y?.leftWidth??0,I=y?.rightWidth??0,O=qp(C.getGridBodyCtrl().eBodyViewport)-50;if(P+I+(l-s)>O)return}this.lastResizeAmount=l,S?.setColumnWidths(p,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.column.resizing=e,this.comp.toggleCss("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e,i=this.pinned!=="left",s=this.pinned==="right";return this.gos.get("enableRtl")?i&&(t*=-1):s&&(t*=-1),t}},SG=class extends Be{constructor(){super(...arguments),this.beanName="colResize"}setColumnWidths(e,t,i,s){let n=[],{colModel:o,gos:l,visibleCols:d}=this.beans;e.forEach(p=>{let y=o.getColDefCol(p.key)||o.getCol(p.key);if(!y)return;if(n.push({width:p.newWidth,ratios:[1],columns:[y]}),l.get("colResizeDefault")==="shift"&&(t=!t),t){let S=d.getColAfter(y);if(!S)return;let P=y.getActualWidth()-p.newWidth,I=S.getActualWidth()+P;n.push({width:I,ratios:[1],columns:[S]})}}),n.length!==0&&this.resizeColumnSets({resizeSets:n,finished:i,source:s})}resizeColumnSets(e){let{resizeSets:t,finished:i,source:s}=e;if(!(!t||t.every(C=>RG(C)))){if(i){let C=t&&t.length>0?t[0].columns:null;Mu(this.eventSvc,C,i,s)}return}let o=[],l=[];t.forEach(C=>{let{width:S,columns:P,ratios:I}=C,O={},V={};P.forEach(Q=>l.push(Q));let G=!0,X=0;for(;G;){if(X++,X>1e3){li(31);break}G=!1;let Q=[],ae=0,me=S;P.forEach((_e,Ae)=>{if(V[_e.getId()])me-=O[_e.getId()];else{Q.push(_e);let Ge=I[Ae];ae+=Ge}});let fe=1/ae;Q.forEach((_e,Ae)=>{let Oe=Ae===Q.length-1,Ge;Oe?Ge=me:(Ge=Math.round(I[Ae]*S*fe),me-=Ge);let it=_e.getMinWidth(),Xe=_e.getMaxWidth();Ge<it?(Ge=it,V[_e.getId()]=!0,G=!0):Xe>0&&Ge>Xe&&(Ge=Xe,V[_e.getId()]=!0,G=!0),O[_e.getId()]=Ge})}P.forEach(Q=>{let ae=O[Q.getId()];Q.getActualWidth()!==ae&&(Q.setActualWidth(ae,s),o.push(Q))})});let d=o.length>0,p=[];if(d){let{colFlex:C,visibleCols:S,colViewport:P}=this.beans;p=C?.refreshFlexedColumns({resizingCols:l,skipSetLeft:!0})??[],S.setLeftValues(s),S.updateBodyWidths(),P.checkViewportColumns()}let y=l.concat(p);(d||i)&&Mu(this.eventSvc,y,i,s,p)}resizeHeader(e,t,i){if(!e.isResizable())return;let s=e.getActualWidth(),n=e.getMinWidth(),o=e.getMaxWidth(),l=Math.min(Math.max(s+t,n),o);this.setColumnWidths([{key:e,newWidth:l}],i,!0,"uiColumnResized")}createResizeFeature(e,t,i,s,n){return new _G(e,t,i,s,n)}createGroupResizeFeature(e,t,i,s){return new xG(e,t,i,s)}};function RG(e){let{columns:t,width:i}=e,s=0,n=0,o=!0;t.forEach(p=>{let y=p.getMinWidth();s+=y||0;let C=p.getMaxWidth();C>0?n+=C:o=!1});let l=i>=s,d=!o||i<=n;return l&&d}var EG={moduleName:"ColumnResize",version:nt,beans:[SG],apiFunctions:{setColumnWidths:bG},dependsOn:[YN,XM]},PG=class extends Be{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();let e=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(t=>{t.__addEventListener("widthChanged",e),t.__addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.__removeEventListener("widthChanged",e),t.__removeEventListener("visibleChanged",e)})})}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach(e=>e()),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){let e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.toggleCss("ag-hidden",e===0)}},MG=class extends vb{constructor(){super(...arguments),this.onSuppressColMoveChange=()=>{!this.isAlive()||this.isSuppressMoving()?this.removeDragSource():this.dragSource||this.setDragSource(this.eGui)}}wireComp(e,t,i,s,n){let{column:o,beans:l}=this,{context:d,colNames:p,colHover:y,rangeSvc:C,colResize:S}=l;this.comp=e,n=rg(this,d,n),this.setGui(t,n),this.displayName=p.getDisplayNameForColumnGroup(o,"header"),this.refreshHeaderStyles(),this.addClasses(),this.setupMovingCss(n),this.setupExpandable(n),this.setupTooltip(),this.setupAutoHeight({wrapperElement:s,compBean:n}),this.setupUserComp(),this.addHeaderMouseListeners(n),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();let P=this.rowCtrl.pinned,I=o.getProvidedColumnGroup().getLeafColumns();y?.createHoverFeature(n,I,t),C?.createRangeHighlightFeature(n,o,e),n.createManagedBean(new mb(o,t,l)),n.createManagedBean(new PG(e,o)),S?this.resizeFeature=n.createManagedBean(S.createGroupResizeFeature(e,i,P,o)):e.setResizableDisplayed(!1),n.createManagedBean(new Au(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(n,I),n.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(n),n.addDestroyFunc(()=>this.clearComponent())}getHeaderClassParams(){let{column:e,beans:t}=this,i=e.getDefinition();return bt(t.gos,{colDef:i,columnGroup:e,floatingFilter:!1})}refreshMaxHeaderHeight(){let{gos:e,comp:t}=this,i=e.get("groupHeaderHeight");i!=null?i===0?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(i):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(let i of t)e.addManagedListeners(i,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,i)})}onLeafColumnHighlightChanged(e){let t=this.column.getDisplayedLeafColumns(),i=t[0]===e,s=di(t)===e;if(!i&&!s)return;let n=e.getHighlighted(),o=!!this.rowCtrl.getHeaderCellCtrls().find(p=>p.column.isMoving()),l=!1,d=!1;if(o){let p=this.beans.gos.get("enableRtl"),y=n===1,C=n===0;i&&(p?d=y:l=C),s&&(p?l=C:d=y)}this.comp.toggleCss("ag-header-highlight-before",l),this.comp.toggleCss("ag-header-highlight-after",d)}resizeHeader(e,t){let{resizeFeature:i}=this;if(!i)return;let s=i.getInitialValues(t);i.resizeColumns(s,s.resizeStartWidth+e,"uiColumnResized",!0)}resizeLeafColumnsToFit(e){this.resizeFeature?.resizeLeafColumnsToFit(e)}setupUserComp(){let{colGroupSvc:e,userCompFactory:t,gos:i,enterpriseMenuFactory:s}=this.beans,n=this.column,o=n.getProvidedColumnGroup(),l=bt(i,{displayName:this.displayName,columnGroup:n,setExpanded:p=>{e.setColumnGroupOpened(o,p,"gridInitializing")},setTooltip:(p,y)=>{i.assertModuleRegistered("Tooltip",3),this.setupTooltip(p,y)},showColumnMenu:(p,y)=>s?.showMenuAfterButtonClick(o,p,"columnMenu",y),showColumnMenuAfterMouseClick:(p,y)=>s?.showMenuAfterMouseEvent(o,p,"columnMenu",y),eGridHeader:this.eGui}),d=b5(t,l);d&&this.comp.setUserCompDetails(d)}addHeaderMouseListeners(e){let t=n=>this.handleMouseOverChange(n.type==="mouseenter"),i=()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),s=n=>this.handleContextMenuMouseEvent(n,void 0,this.column.getProvidedColumnGroup());e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:i,contextmenu:s})}handleMouseOverChange(e){this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderGroupTooltip(this.tooltipFeature,this,e,t)}setupExpandable(e){let t=this.column.getProvidedColumnGroup();this.refreshExpanded();let i=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:i,expandableChanged:i})}refreshExpanded(){let{column:e}=this;this.expandable=e.isExpandable();let t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0),this.refreshHeaderStyles()}addClasses(){let{column:e}=this,t=e.getColGroupDef(),i=kM(t,this.gos,null,e);e.isPadding()?(i.push("ag-header-group-cell-no-group"),e.getLeafColumns().every(n=>n.isSpanHeaderHeight())&&i.push("ag-header-span-height")):(i.push("ag-header-group-cell-with-group"),t?.wrapHeaderText&&i.push("ag-header-cell-wrap-text")),i.forEach(s=>this.comp.toggleCss(s,!0))}setupMovingCss(e){let{column:t}=this,s=t.getProvidedColumnGroup().getLeafColumns(),n=()=>this.comp.toggleCss("ag-header-cell-moving",t.isMoving());s.forEach(o=>{e.addManagedListeners(o,{movingChanged:n})}),n()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||this.focusThis()}handleKeyDown(e){super.handleKeyDown(e);let t=this.getWrapperHasFocus();if(!(!this.expandable||!t)&&e.key===Fe.ENTER){let i=this.column,s=!i.isExpanded();this.beans.colGroupSvc.setColumnGroupOpened(i.getProvidedColumnGroup(),s,"uiColumnExpanded")}}setDragSource(e){!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),e&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null))}isSuppressMoving(){return this.gos.get("suppressMovableColumns")||this.column.getLeafColumns().some(e=>e.getColDef().suppressMovable||e.getColDef().lockPosition)}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function TG(e,t,i){e.colGroupSvc?.setColumnGroupOpened(t,i,"api")}function DG(e,t,i){return e.colGroupSvc?.getColumnGroup(t,i)??null}function FG(e,t){return e.colGroupSvc?.getProvidedColGroup(t)??null}function IG(e,t,i){return e.colNames.getDisplayNameForColumnGroup(t,i)||""}function kG(e){return e.colGroupSvc?.getColumnGroupState()??[]}function AG(e,t){e.colGroupSvc?.setColumnGroupState(t,"api")}function LG(e){e.colGroupSvc?.resetColumnGroupState("api")}function OG(e){return e.visibleCols.treeLeft}function zG(e){return e.visibleCols.treeCenter}function BG(e){return e.visibleCols.treeRight}function VG(e){return e.visibleCols.getAllTrees()}function HG(e,t){for(let i=0;i<t.length;i++){let s=e.indexOf(t[i]);s>=0&&(e[s]=e[e.length-1],e.pop())}}var NG=class extends Be{constructor(){super(...arguments),this.beanName="visibleCols",this.colsAndGroupsMap={},this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.headerGroupRowCount=0,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.isBodyWidthDirty=!0}refresh(e,t=!1){let{colFlex:i,colModel:s,colGroupSvc:n,colViewport:o,selectionColSvc:l}=this.beans;t||this.buildTrees(s,n),n?.updateOpenClosedVisibility(),this.leftCols=Yw(this.treeLeft),this.centerCols=Yw(this.treeCenter),this.rightCols=Yw(this.treeRight),l?.refreshVisibility(this.leftCols,this.centerCols,this.rightCols),this.joinColsAriaOrder(s),this.joinCols(),this.headerGroupRowCount=this.getHeaderRowCount(),this.setLeftValues(e),this.autoHeightCols=this.allCols.filter(d=>d.isAutoHeight()),i?.refreshFlexedColumns(),this.updateBodyWidths(),this.setFirstRightAndLastLeftPinned(s,this.leftCols,this.rightCols,e),o.checkViewportColumns(!1),this.eventSvc.dispatchEvent({type:"displayedColumnsChanged",source:e})}getHeaderRowCount(){if(!this.gos.get("hidePaddedHeaderRows"))return this.beans.colModel.cols.treeDepth;let e=0;for(let t of this.allCols){let i=t.getParent();for(;i;){if(!i.isPadding()){let s=i.getProvidedColumnGroup().getLevel()+1;s>e&&(e=s);break}i=i.getParent()}}return e}updateBodyWidths(){let e=Kr(this.centerCols),t=Kr(this.leftCols),i=Kr(this.rightCols);this.isBodyWidthDirty=this.bodyWidth!==e,(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==i)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=i,this.eventSvc.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventSvc.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e,t,i,s){let n,o;this.gos.get("enableRtl")?(n=t?t[0]:null,o=i?di(i):null):(n=t?di(t):null,o=i?i[0]:null),e.getCols().forEach(l=>{l.setLastLeftPinned(l===n,s),l.setFirstRightPinned(l===o,s)})}buildTrees(e,t){let i=e.getColsToShow(),s=i.filter(p=>p.getPinned()=="left"),n=i.filter(p=>p.getPinned()=="right"),o=i.filter(p=>p.getPinned()!="left"&&p.getPinned()!="right"),l=new KP,d=p=>t?t.createColumnGroups(p):p.columns;this.treeLeft=d({columns:s,idCreator:l,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=d({columns:n,idCreator:l,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=d({columns:o,idCreator:l,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.ariaOrderColumns=[]}joinColsAriaOrder(e){let t=e.getCols(),i=[],s=[],n=[];for(let o of t){let l=o.getPinned();l?l===!0||l==="left"?i.push(o):n.push(o):s.push(o)}this.ariaOrderColumns=i.concat(s).concat(n)}getAriaColIndex(e){let t;return ns(e)?t=e.getLeafColumns()[0]:t=e,this.ariaOrderColumns.indexOf(t)+1}setLeftValuesOfGroups(){[this.treeLeft,this.treeRight,this.treeCenter].forEach(e=>{e.forEach(t=>{ns(t)&&t.checkLeft()})})}setLeftValuesOfCols(e){let{colModel:t}=this.beans;if(!t.getColDefCols())return;let s=t.getCols().slice(0),n=this.gos.get("enableRtl");[this.leftCols,this.rightCols,this.centerCols].forEach(o=>{if(n){let l=Kr(o);o.forEach(d=>{l-=d.getActualWidth(),d.setLeft(l,e)})}else{let l=0;o.forEach(d=>{d.setLeft(l,e),l+=d.getActualWidth()})}HG(s,o)}),s.forEach(o=>{o.setLeft(null,e)})}joinCols(){this.gos.get("enableRtl")?this.allCols=this.rightCols.concat(this.centerCols).concat(this.leftCols):this.allCols=this.leftCols.concat(this.centerCols).concat(this.rightCols)}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}isColDisplayed(e){return this.allCols.indexOf(e)>=0}getLeftColsForRow(e){let{leftCols:t,beans:{colModel:i}}=this;return i.colSpanActive?this.getColsForRow(e,t):t}getRightColsForRow(e){let{rightCols:t,beans:{colModel:i}}=this;return i.colSpanActive?this.getColsForRow(e,t):t}getColsForRow(e,t,i,s){let n=[],o=null;for(let l=0;l<t.length;l++){let d=t[l],p=t.length-l,y=Math.min(d.getColSpan(e),p),C=[d];if(y>1){let P=y-1;for(let I=1;I<=P;I++)C.push(t[l+I]);l+=P}let S;i?(S=!1,C.forEach(P=>{i(P)&&(S=!0)})):S=!0,S&&(n.length===0&&o&&(s&&s(d))&&n.push(o),n.push(d)),o=d}return n}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getColBefore(e){let t=this.allCols,i=t.indexOf(e);return i>0?t[i-1]:null}isPinningLeft(){return this.leftCols.length>0}isPinningRight(){return this.rightCols.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};let e=t=>{this.colsAndGroupsMap[t.getUniqueId()]=t};uc(this.treeCenter,!1,e),uc(this.treeLeft,!1,e),uc(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}getFirstColumn(){let e=this.gos.get("enableRtl"),t=["leftCols","centerCols","rightCols"];e&&t.reverse();for(let i=0;i<t.length;i++){let s=this[t[i]];if(s.length)return e?di(s):s[0]}return null}getColAfter(e){let t=this.allCols,i=t.indexOf(e);return i<t.length-1?t[i+1]:null}getColsLeftWidth(){return Kr(this.leftCols)}getDisplayedColumnsRightWidth(){return Kr(this.rightCols)}isColAtEdge(e,t){let i=this.allCols;if(!i.length)return!1;let s=t==="first",n;if(ns(e)){let o=e.getDisplayedLeafColumns();if(!o.length)return!1;n=s?o[0]:di(o)}else n=e;return(s?i[0]:di(i))===n}};function uc(e,t,i){if(e)for(let s=0;s<e.length;s++){let n=e[s];if(ns(n)){let o=t?n.getDisplayedChildren():n.getChildren();uc(o,t,i)}i(n)}}function Yw(e){let t=[];return uc(e,!0,i=>{ol(i)&&t.push(i)}),t}var GG=class extends Be{constructor(){super(...arguments),this.beanName="colGroupSvc"}getColumnGroupState(){let e=[],t=this.beans.colModel.getColTree();return Jr(null,t,i=>{Ks(i)&&e.push({groupId:i.getGroupId(),open:i.isExpanded()})}),e}resetColumnGroupState(e){let t=this.beans.colModel.getColDefColTree();if(!t)return;let i=[];Jr(null,t,s=>{if(Ks(s)){let n=s.getColGroupDef(),o={groupId:s.getGroupId(),open:n?n.openByDefault:void 0};i.push(o)}}),this.setColumnGroupState(i,e)}setColumnGroupState(e,t){let{colModel:i,colAnimation:s,visibleCols:n,eventSvc:o}=this.beans;if(!i.getColTree().length)return;s?.start();let d=[];e.forEach(p=>{let y=p.groupId,C=p.open,S=this.getProvidedColGroup(y);S&&S.isExpanded()!==C&&(S.setExpanded(C),d.push(S))}),n.refresh(t,!0),d.length&&o.dispatchEvent({type:"columnGroupOpened",columnGroup:d.length===1?d[0]:void 0,columnGroups:d}),s?.finish()}setColumnGroupOpened(e,t,i){let s;Ks(e)?s=e.getId():s=e||"",this.setColumnGroupState([{groupId:s,open:t}],i)}getProvidedColGroup(e){let t=null;return Jr(null,this.beans.colModel.getColTree(),i=>{Ks(i)&&i.getId()===e&&(t=i)}),t}getGroupAtDirection(e,t){let i=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),s=e.getDisplayedLeafColumns(),n=t==="After"?di(s):s[0],o=`getCol${t}`;for(;;){let l=this.beans.visibleCols[o](n);if(!l)return null;let d=this.getColGroupAtLevel(l,i);if(d!==e)return d}}getColGroupAtLevel(e,t){let i=e.getParent(),s,n;for(;s=i.getProvidedColumnGroup().getLevel(),n=i.getPaddingLevel(),!(s+n<=t);)i=i.getParent();return i}updateOpenClosedVisibility(){let e=this.beans.visibleCols.getAllTrees();uc(e,!1,t=>{ns(t)&&t.calculateDisplayedColumns()})}getColumnGroup(e,t){if(!e)return null;if(ns(e))return e;let i=this.beans.visibleCols.getAllTrees(),s=typeof t=="number",n=null;return uc(i,!1,o=>{if(ns(o)){let l=o,d;s?d=e===l.getGroupId()&&t===l.getPartId():d=e===l.getGroupId(),d&&(n=l)}}),n}createColumnGroups(e){let{columns:t,idCreator:i,pinned:s,oldDisplayedGroups:n,isStandaloneStructure:o}=e,l=this.mapOldGroupsById(n),d=[],p=t;for(;p.length;){let y=p;p=[];let C=0,S=P=>{let I=C;C=P;let O=y[I],G=(ns(O)?O.getProvidedColumnGroup():O).getOriginalParent();if(G==null){for(let Q=I;Q<P;Q++)d.push(y[Q]);return}let X=this.createColumnGroup(G,i,l,s,o);for(let Q=I;Q<P;Q++)X.addChild(y[Q]);p.push(X)};for(let P=1;P<y.length;P++){let I=y[P],V=(ns(I)?I.getProvidedColumnGroup():I).getOriginalParent(),G=y[C],Q=(ns(G)?G.getProvidedColumnGroup():G).getOriginalParent();V!==Q&&S(P)}C<y.length&&S(y.length)}return o||this.setupParentsIntoCols(d,null),d}createProvidedColumnGroup(e,t,i,s,n,o,l){let d=n.getUniqueKey(t.groupId||null,null),p=UR(this.beans,t,d),y=new Gm(p,d,!1,i);this.createBean(y);let C=this.findExistingGroup(t,o);C&&o.splice(C.idx,1);let S=C?.group;S&&y.setExpanded(S.isExpanded());let P=NP(this.beans,p.children,i+1,e,s,n,o,l);return y.setChildren(P),y}balanceColumnTree(e,t,i,s){let n=[];for(let o=0;o<e.length;o++){let l=e[o];if(Ks(l)){let d=l,p=this.balanceColumnTree(d.getChildren(),t+1,i,s);d.setChildren(p),n.push(d)}else{let d,p;for(let y=t;y<i;y++){let C=s.getUniqueKey(null,null),S=UR(this.beans,null,C),P=new Gm(S,C,!0,y);this.createBean(P),p&&p.setChildren([P]),p=P,d||(d=p)}if(d&&p)if(n.push(d),e.some(C=>Ks(C))){p.setChildren([l]);continue}else{p.setChildren(e);break}n.push(l)}}return n}findDepth(e){let t=0,i=e;for(;i&&i[0]&&Ks(i[0]);)t++,i=i[0].getChildren();return t}findMaxDepth(e,t){let i=t;for(let s=0;s<e.length;s++){let n=e[s];if(Ks(n)){let o=n,l=this.findMaxDepth(o.getChildren(),t+1);i<l&&(i=l)}}return i}balanceTreeForAutoCols(e,t){let i=[];return e.forEach(s=>{let n=s;for(let o=t-1;o>=0;o--){let l=new Gm(null,`FAKE_PATH_${s.getId()}}_${o}`,!0,o);this.createBean(l),l.setChildren([n]),n.originalParent=l,n=l}t===0&&(s.originalParent=null),i.push(n)}),i}findExistingGroup(e,t){if(e.groupId!=null)for(let s=0;s<t.length;s++){let n=t[s];if(n.getColGroupDef()&&n.getId()===e.groupId)return{idx:s,group:n}}}createColumnGroup(e,t,i,s,n){let o=e.getGroupId(),l=t.getInstanceIdForKey(o),d=yM(o,l),p=i[d];return p&&p.getProvidedColumnGroup()!==e&&(p=null),st(p)?p.reset():(p=new Jp(e,o,l,s),n||this.createBean(p)),p}mapOldGroupsById(e){let t={},i=s=>{s.forEach(n=>{if(ns(n)){let o=n;t[n.getUniqueId()]=o,i(o.getChildren())}})};return e&&i(e),t}setupParentsIntoCols(e,t){e.forEach(i=>{if(i.parent!==t&&(this.beans.colViewport.colsWithinViewportHash=""),i.parent=t,ns(i)){let s=i;this.setupParentsIntoCols(s.getChildren(),s)}})}},WG={moduleName:"ColumnGroup",version:nt,dynamicBeans:{headerGroupCellCtrl:MG},beans:[GG],apiFunctions:{getAllDisplayedColumnGroups:VG,getCenterDisplayedColumnGroups:zG,getColumnGroup:DG,getColumnGroupState:kG,getDisplayNameForColumnGroup:IG,getLeftDisplayedColumnGroups:OG,getProvidedColumnGroup:FG,getRightDisplayedColumnGroups:BG,resetColumnGroupState:LG,setColumnGroupOpened:TG,setColumnGroupState:AG}},UG={tag:"div",cls:"ag-skeleton-container"},jG=class extends ii{constructor(){super(UG)}init(e){let t=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",t),this.addDestroyFunc(()=>jp(e.eParentOfValue)),jp(e.eParentOfValue,t),e.deferRender?this.setupLoading(e):e.node.failedLoad?this.setupFailed():this.setupLoading(e)}setupFailed(){let e=this.getLocaleTextFunc();this.getGui().textContent=e("loadingError","ERR");let t=e("ariaSkeletonCellLoadingFailed","Row failed to load");Eu(this.getGui(),t)}setupLoading(e){let t=rs({tag:"div",cls:"ag-skeleton-effect"}),i=e.node.rowIndex;if(i!=null){let o=75+25*(i%2===0?Math.sin(i):Math.cos(i));t.style.width=`${o}%`}this.getGui().appendChild(t);let s=this.getLocaleTextFunc(),n=e.deferRender?s("ariaDeferSkeletonCellLoading","Cell is loading"):s("ariaSkeletonCellLoading","Row data is loading");Eu(this.getGui(),n)}refresh(e){return!1}},$G={moduleName:"CheckboxCellRenderer",version:nt,userComponents:{agCheckboxCellRenderer:TH}},qG={moduleName:"SkeletonCellRenderer",version:nt,userComponents:{agSkeletonCellRenderer:jG}};function ZG(e,t){let i=e.colModel.getColDefCol(t);return i?i.getColDef():null}function KG(e){return e.colModel.getColumnDefs()}function XG(e,t,i){return e.colNames.getDisplayNameForColumn(t,i)||""}function YG(e,t){return e.colModel.getColDefCol(t)}function QG(e){return e.colModel.getColDefCols()}function JG(e,t){return _n(e,t,"api")}function e7(e){return av(e)}function t7(e){$B(e,"api")}function i7(e){return e.visibleCols.isPinningLeft()||e.visibleCols.isPinningRight()}function s7(e){return e.visibleCols.isPinningLeft()}function o7(e){return e.visibleCols.isPinningRight()}function n7(e,t){return e.visibleCols.getColAfter(t)}function r7(e,t){return e.visibleCols.getColBefore(t)}function a7(e,t,i){e.colModel.setColsVisible(t,i,"api")}function l7(e,t,i){e.pinnedCols?.setColsPinned(t,i,"api")}function c7(e){return e.colModel.getCols()}function h7(e){return e.visibleCols.leftCols}function u7(e){return e.visibleCols.centerCols}function d7(e){return e.visibleCols.rightCols}function p7(e){return e.visibleCols.allCols}function g7(e){return e.colViewport.getViewportColumns()}function IC(e,t){if(!e)return;let i=e,s={};return Object.keys(i).forEach(n=>{if(t&&t.indexOf(n)>=0||yP.has(n))return;let o=i[n];typeof o=="object"&&o!==null&&o.constructor===Object?s[n]=IC(o):s[n]=o}),s}var f7=class extends Be{constructor(){super(...arguments),this.beanName="colDefFactory"}wireBeans(e){this.rowGroupColsSvc=e.rowGroupColsSvc,this.pivotColsSvc=e.pivotColsSvc}getColumnDefs(e,t,i,s){let n=e.slice();t?n.sort((d,p)=>i.indexOf(d)-i.indexOf(p)):i&&n.sort((d,p)=>s.indexOf(d)-s.indexOf(p));let o=this.rowGroupColsSvc?.columns,l=this.pivotColsSvc?.columns;return this.buildColumnDefs(n,o,l)}buildColumnDefs(e,t=[],i=[]){let s=[],n={};return e.forEach(o=>{let l=this.createDefFromColumn(o,t,i),d=!0,p=l,y=o.getOriginalParent(),C=null;for(;y;){let S=null;if(y.isPadding()){y=y.getOriginalParent();continue}let P=n[y.getGroupId()];if(P){P.children.push(p),d=!1;break}if(S=this.createDefFromGroup(y),S&&(S.children=[p],n[S.groupId]=S,p=S,y=y.getOriginalParent()),y!=null&&C===y){d=!1;break}C=y}d&&s.push(p)}),s}createDefFromGroup(e){let t=IC(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,i){let s=IC(e.getColDef());return s.colId=e.getColId(),s.width=e.getActualWidth(),s.rowGroup=e.isRowGroupActive(),s.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,s.pivot=e.isPivotActive(),s.pivotIndex=e.isPivotActive()?i.indexOf(e):null,s.aggFunc=e.isValueActive()?e.getAggFunc():null,s.hide=e.isVisible()?void 0:!0,s.pinned=e.isPinned()?e.getPinned():null,s.sort=e.getSort()?e.getSort():null,s.sortIndex=e.getSortIndex()!=null?e.getSortIndex():null,s}},m7=class extends Be{constructor(){super(...arguments),this.beanName="colFlex"}refreshFlexedColumns(e={}){let t=e.source??"flex";e.viewportWidth!=null&&(this.flexViewportWidth=e.viewportWidth);let i=this.flexViewportWidth,{visibleCols:s,colDelayRenderSvc:n}=this.beans,o=s.centerCols,l=-1;if(e.resizingCols){let V=new Set(e.resizingCols);for(let G=o.length-1;G>=0;G--)if(V.has(o[G])){l=G;break}}let d=!1,p=o.map((V,G)=>{let X=V.getFlex(),Q=X!=null&&X>0&&G>l;return d||(d=Q),{col:V,isFlex:Q,flex:Math.max(0,X??0),initialSize:V.getActualWidth(),min:V.getMinWidth(),max:V.getMaxWidth(),targetSize:0}});if(d&&n?.hideColumns("colFlex"),!i||!d)return[];let y=p.length,C=p.reduce((V,G)=>V+G.flex,0),S=i,P=(V,G)=>{V.frozenSize=G,V.col.setActualWidth(G,t),S-=G,C-=V.flex,y-=1},I=V=>V.frozenSize!=null;for(let V of p)V.isFlex||P(V,V.initialSize);for(;y>0;){let V=Math.round(C<1?S*C:S),G,X=0,Q=0;for(let fe of p){if(I(fe))continue;G=fe,Q+=V*(fe.flex/C);let _e=Q-X,Ae=Math.round(_e);fe.targetSize=Ae,X+=Ae}G&&(G.targetSize+=V-X);let ae=0;for(let fe of p){if(I(fe))continue;let _e=fe.targetSize,Ae=Math.min(Math.max(_e,fe.min),fe.max);ae+=Ae-_e,fe.violationType=Ae===_e?void 0:Ae<_e?"max":"min",fe.targetSize=Ae}let me=ae===0?"all":ae>0?"min":"max";for(let fe of p)I(fe)||(me==="all"||fe.violationType===me)&&P(fe,fe.targetSize)}e.skipSetLeft||s.setLeftValues(t),e.updateBodyWidths&&s.updateBodyWidths();let O=p.filter(V=>V.isFlex&&!V.violationType).map(V=>V.col);if(e.fireResizedEvent){let V=p.filter(X=>X.initialSize!==X.frozenSize).map(X=>X.col),G=p.filter(X=>X.flex).map(X=>X.col);Mu(this.eventSvc,V,!0,t,G)}return n?.revealColumns("colFlex"),O}initCol(e){let{flex:t,initialFlex:i}=e.colDef;t!==void 0?e.flex=t:i!==void 0&&(e.flex=i)}setColFlex(e,t){e.flex=t??null,e.dispatchStateUpdatedEvent("flex")}};function Hp(e,t,i){if(!t||!e)return;if(!i)return e[t];let s=t.split("."),n=e;for(let o=0;o<s.length;o++){if(n==null)return;n=n[s[o]]}return n}var v7=["dateTimeString","dateString","text","number","boolean","date"],y7=class extends Be{constructor(){super(...arguments),this.beanName="dataTypeSvc",this.dataTypeDefinitions={},this.isPendingInference=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[],this.columnDefinitionPropsPerDataType={number(){return{cellEditor:"agNumberCellEditor"}},boolean(){return{cellEditor:"agCheckboxCellEditor",cellRenderer:"agCheckboxCellRenderer",getFindText:()=>null,suppressKeyboardEvent:e=>!!e.colDef.editable&&e.event.key===Fe.SPACE}},date({formatValue:e}){return{cellEditor:"agDateCellEditor",keyCreator:e}},dateString({formatValue:e}){return{cellEditor:"agDateStringCellEditor",keyCreator:e}},dateTime(e){return this.date(e)},dateTimeString(e){return this.dateString(e)},object({formatValue:e,colModel:t,colId:i}){return{cellEditorParams:{useFormatter:!0},comparator:(s,n)=>{let o=t.getColDefCol(i),l=o?.getColDef();if(!o||!l)return 0;let d=s==null?"":e({column:o,node:null,value:s}),p=n==null?"":e({column:o,node:null,value:n});return d===p?0:d>p?1:-1},keyCreator:e}},text(){return{}}}}wireBeans(e){this.colModel=e.colModel}postConstruct(){this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.colModel.recreateColumnDefs(e)})}processDataTypeDefinitions(){let e=this.getDefaultDataTypes(),t={},i={},s=C=>S=>{let{column:P,node:I,value:O}=S,V=P.getColDef().valueFormatter;return V===C.groupSafeValueFormatter&&(V=C.valueFormatter),this.beans.valueSvc.formatValue(P,I,O,V)};for(let C of Object.keys(e)){let S=e[C],P=ht(Se({},S),{groupSafeValueFormatter:DE(S,this.gos)});t[C]=P,i[C]=s(P)}let n=this.gos.get("dataTypeDefinitions")??{},o={};for(let C of Object.keys(n)){let S=n[C],P=this.processDataTypeDefinition(S,n,[C],e);P&&(t[C]=P,S.dataTypeMatcher&&(o[C]=S.dataTypeMatcher),i[C]=s(P))}let{valueParser:l,valueFormatter:d}=e.object,{valueParser:p,valueFormatter:y}=t.object;this.hasObjectValueParser=p!==l,this.hasObjectValueFormatter=y!==d,this.formatValueFuncs=i,this.dataTypeDefinitions=t,this.dataTypeMatchers=this.sortKeysInMatchers(o,e)}sortKeysInMatchers(e,t){let i=Se({},e);for(let s of v7)delete i[s],i[s]=e[s]??t[s].dataTypeMatcher;return i}processDataTypeDefinition(e,t,i,s){let n,o=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let l=s[o],d=t[o];if(l&&d&&(l=d),!TE(e,l,o))return;n=ME(l,e)}else{if(i.includes(o)){je(44);return}let l=t[o];if(!TE(e,l,o))return;let d=this.processDataTypeDefinition(l,t,[...i,o],s);if(!d)return;n=ME(d,e)}return ht(Se({},n),{groupSafeValueFormatter:DE(n,this.gos)})}updateColDefAndGetColumnType(e,t,i){let{cellDataType:s}=t,{field:n}=t;if(s===void 0&&(s=e.cellDataType),(s==null||s===!0)&&(s=this.canInferCellDataType(e,t)?this.inferCellDataType(n,i):!1),!s){e.cellDataType=!1;return}let o=this.dataTypeDefinitions[s];if(!o){je(47,{cellDataType:s});return}return e.cellDataType=s,o.groupSafeValueFormatter&&(e.valueFormatter=o.groupSafeValueFormatter),o.valueParser&&(e.valueParser=o.valueParser),o.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,s,o,i),o.columnTypes}addColumnListeners(e){if(!this.isPendingInference)return;let t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;let i=s=>{t.add(s.key)};e.__addEventListener("columnStateUpdated",i),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.__removeEventListener("columnStateUpdated",i))}canInferCellDataType(e,t){let{gos:i}=this;if(!Ms(i))return!1;let s={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(Qw(t,s))return!1;let n=t.type===null?e.type:t.type;if(n){let o=i.get("columnTypes")??{};if(rv(n).some(d=>{let p=o[d.trim()];return p&&Qw(p,s)}))return!1}return!Qw(e,s)}inferCellDataType(e,t){if(!e)return;let i,s=this.getInitialData();if(s){let o=e.indexOf(".")>=0&&!this.gos.get("suppressFieldDotNotation");i=Hp(s,e,o)}else this.initWaitForRowData(t);return i==null?void 0:Object.keys(this.dataTypeMatchers).find(o=>this.dataTypeMatchers[o](i))??"object"}getInitialData(){let e=this.gos.get("rowData");if(e?.length)return e[0];if(this.initialData)return this.initialData;{let t=this.beans.rowModel.rootNode?.allLeafChildren;if(t?.length)return t[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isPendingInference)return;this.isPendingInference=!0;let t=this.isColumnTypeOverrideInDataTypeDefinitions,{colAutosize:i,eventSvc:s}=this.beans;t&&i&&(i.shouldQueueResizeOperations=!0);let[n]=this.addManagedEventListeners({rowDataUpdateStarted:o=>{let{firstRowData:l}=o;l&&(n?.(),this.isPendingInference=!1,this.processColumnsPendingInference(l,t),this.columnStateUpdatesPendingInference={},t&&i?.processResizeOperations(),s.dispatchEvent({type:"dataTypesInferred"}))}})}processColumnsPendingInference(e,t){this.initialData=e;let i=[];this.destroyColumnStateUpdateListeners();let s={},n={};for(let o of Object.keys(this.columnStateUpdatesPendingInference)){let l=this.columnStateUpdatesPendingInference[o],d=this.colModel.getCol(o);if(!d)return;let p=d.getColDef();if(!this.resetColDefIntoCol(d,"cellDataTypeInferred"))return;let y=d.getColDef();if(t&&y.type&&y.type!==p.type){let C=C7(d,l);C.rowGroup&&C.rowGroupIndex==null&&(s[o]=C),C.pivot&&C.pivotIndex==null&&(n[o]=C),i.push(C)}}t&&i.push(...this.generateColumnStateForRowGroupAndPivotIndexes(s,n)),i.length&&_n(this.beans,{state:i},"cellDataTypeInferred"),this.initialData=null}generateColumnStateForRowGroupAndPivotIndexes(e,t){let i={},{rowGroupColsSvc:s,pivotColsSvc:n}=this.beans;return s?.restoreColumnOrder(i,e),n?.restoreColumnOrder(i,t),Object.values(i)}resetColDefIntoCol(e,t){let i=e.getUserProvidedColDef();if(!i)return!1;let s=gC(this.beans,i,e.getColId());return e.setColDef(s,i,t),!0}getDateStringTypeDefinition(e){let{dateString:t}=this.dataTypeDefinitions;return e?this.getDataTypeDefinition(e)??t:t}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDateIncludesTimeFlag(e){return e==="dateTime"||e==="dateTimeString"}getDataTypeDefinition(e){let t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){return this.getDataTypeDefinition(e)?.baseDataType}checkType(e,t){if(t==null)return!0;let i=this.getDataTypeDefinition(e)?.dataTypeMatcher;return i?i(t):!0}validateColDef(e){let t=i=>je(48,{property:i});if(e.cellDataType==="object"){let{object:i}=this.dataTypeDefinitions;e.valueFormatter===i.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&t("Formatter"),e.editable&&e.valueParser===i.valueParser&&!this.hasObjectValueParser&&t("Parser")}}postProcess(e){let t=e.cellDataType;if(!t||typeof t!="string")return;let{dataTypeDefinitions:i,beans:s,formatValueFuncs:n}=this,o=i[t];o&&s.colFilter?.setColDefPropsForDataType(e,o,n[t])}getFormatValue(e){return this.formatValueFuncs[e]}isColPendingInference(e){return this.isPendingInference&&!!this.columnStateUpdatesPendingInference[e]}setColDefPropertiesForBaseDataType(e,t,i,s){let n=this.formatValueFuncs[t],o=this.columnDefinitionPropsPerDataType[i.baseDataType]({colDef:e,cellDataType:t,colModel:this.colModel,dataTypeDefinition:i,colId:s,formatValue:n});Object.assign(e,o)}getDateObjectTypeDef(e){let t=this.getLocaleTextFunc(),i=this.getDateIncludesTimeFlag(e);return{baseDataType:e,valueParser:s=>Co(s.newValue&&String(s.newValue)),valueFormatter:s=>s.value==null?"":!(s.value instanceof Date)||isNaN(s.value.getTime())?t("invalidDate","Invalid Date"):Vo(s.value,i)??"",dataTypeMatcher:s=>s instanceof Date}}getDateStringTypeDef(e){let t=this.getDateIncludesTimeFlag(e);return{baseDataType:e,dateParser:i=>Co(i)??void 0,dateFormatter:i=>Vo(i??null,t)??void 0,valueParser:i=>Wm(String(i.newValue))?i.newValue:null,valueFormatter:i=>Wm(String(i.value))?String(i.value):"",dataTypeMatcher:i=>typeof i=="string"&&Wm(i)}}getDefaultDataTypes(){let e=this.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:t=>t.newValue?.trim?.()===""?null:Number(t.newValue),valueFormatter:t=>t.value==null?"":typeof t.value!="number"||isNaN(t.value)?e("invalidNumber","Invalid Number"):String(t.value),dataTypeMatcher:t=>typeof t=="number"},text:{baseDataType:"text",valueParser:t=>t.newValue===""?null:aC(t.newValue),dataTypeMatcher:t=>typeof t=="string"},boolean:{baseDataType:"boolean",valueParser:t=>t.newValue==null?t.newValue:t.newValue?.trim?.()===""?null:String(t.newValue).toLowerCase()==="true",valueFormatter:t=>t.value==null?"":String(t.value),dataTypeMatcher:t=>typeof t=="boolean"},date:this.getDateObjectTypeDef("date"),dateString:this.getDateStringTypeDef("dateString"),dateTime:this.getDateObjectTypeDef("dateTime"),dateTimeString:ht(Se({},this.getDateStringTypeDef("dateTimeString")),{dataTypeMatcher:t=>typeof t=="string"&&B5(t)}),object:{baseDataType:"object",valueParser:()=>null,valueFormatter:t=>aC(t.value)??""}}}destroyColumnStateUpdateListeners(){this.columnStateUpdateListenerDestroyFuncs.forEach(e=>e()),this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}};function ME(e,t){let i=Se(Se({},e),t);return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(i.columnTypes=[...rv(e.columnTypes),...rv(t.columnTypes)]),i}function TE(e,t,i){return t?t.baseDataType!==e.baseDataType?(je(46),!1):!0:(je(45,{parentCellDataType:i}),!1)}function DE(e,t){if(e.valueFormatter)return i=>{if(i.node?.group){let s=(i.colDef.pivotValueColumn??i.column).getAggFunc();if(s){if(s==="first"||s==="last")return e.valueFormatter(i);if(e.baseDataType==="number"&&s!=="count"){if(typeof i.value=="number")return e.valueFormatter(i);if(typeof i.value=="object"){if(!i.value)return;if("toNumber"in i.value)return e.valueFormatter(ht(Se({},i),{value:i.value.toNumber()}));if("value"in i.value)return e.valueFormatter(ht(Se({},i),{value:i.value.value}))}}return}}else if(t.get("groupHideOpenParents")&&i.column.isRowGroupActive()&&typeof i.value=="string"&&!e.dataTypeMatcher?.(i.value))return;return e.valueFormatter(i)}}function w7(e,t,i,s){if(!t[i])return!1;let n=e[i];return n===null?(t[i]=!1,!1):s===void 0?!!n:n===s}function Qw(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([i,s])=>w7(e,t,i,s))}function C7(e,t){let i=ZP(e);return t.forEach(s=>{delete i[s],s==="rowGroup"?delete i.rowGroupIndex:s==="pivot"&&delete i.pivotIndex}),i}var b7={moduleName:"DataType",version:nt,beans:[y7],dependsOn:[$G]},x7={moduleName:"ColumnFlex",version:nt,beans:[m7]},YM={moduleName:"ColumnApi",version:nt,beans:[f7],apiFunctions:{getColumnDef:ZG,getDisplayNameForColumn:XG,getColumn:YG,getColumns:QG,applyColumnState:JG,getColumnState:e7,resetColumnState:t7,isPinning:i7,isPinningLeft:s7,isPinningRight:o7,getDisplayedColAfter:n7,getDisplayedColBefore:r7,setColumnsVisible:a7,setColumnsPinned:l7,getAllGridColumns:c7,getDisplayedLeftColumns:h7,getDisplayedCenterColumns:u7,getDisplayedRightColumns:d7,getAllDisplayedColumns:p7,getAllDisplayedVirtualColumns:g7,getColumnDefs:KG}};function _7(e){if(!e||e==null)return null;let t=/([a-z])([A-Z])/g,i=/([A-Z]+)([A-Z])([a-z])/g;return e.replace(t,"$1 $2").replace(i,"$1 $2$3").replace(/\./g," ").split(" ").map(n=>n.substring(0,1).toUpperCase()+(n.length>1?n.substring(1,n.length):"")).join(" ")}var S7=class extends Be{constructor(){super(...arguments),this.beanName="colNames"}getDisplayNameForColumn(e,t,i=!1){if(!e)return null;let s=this.getHeaderName(e.getColDef(),e,null,null,t),{aggColNameSvc:n}=this.beans;return i&&n?n.getHeaderName(e,s):s}getDisplayNameForProvidedColumnGroup(e,t,i){let s=t?.getColGroupDef();return s?this.getHeaderName(s,null,e,t,i):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,i,s,n){let o=e.headerValueGetter;if(o){let l=bt(this.gos,{colDef:e,column:t,columnGroup:i,providedColumnGroup:s,location:n});return typeof o=="function"?o(l):typeof o=="string"?this.beans.expressionSvc?.evaluate(o,l)??null:""}else{if(e.headerName!=null)return e.headerName;if(e.field)return _7(e.field)}return""}},R7=class extends Be{constructor(){super(...arguments),this.beanName="colViewport",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.columnsToRenderLeft=[],this.columnsToRenderRight=[],this.columnsToRenderCenter=[]}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t,i=!1){let{visibleCols:s}=this,n=s.isBodyWidthDirty;if(!(e===this.scrollWidth&&t===this.scrollPosition&&!n)){if(this.scrollWidth=e,this.scrollPosition=t,s.isBodyWidthDirty=!0,this.gos.get("enableRtl")){let l=s.bodyWidth;this.viewportLeft=l-t-e,this.viewportRight=l-t}else this.viewportLeft=t,this.viewportRight=e+t;this.colModel.ready&&this.checkViewportColumns(i)}}getColumnHeadersToRender(e){switch(e){case"left":return this.columnsToRenderLeft;case"right":return this.columnsToRenderRight;default:return this.columnsToRenderCenter}}getHeadersToRender(e,t){let i;switch(e){case"left":i=this.rowsOfHeadersToRenderLeft[t];break;case"right":i=this.rowsOfHeadersToRenderRight[t];break;default:i=this.rowsOfHeadersToRenderCenter[t];break}return i??[]}extractViewportColumns(){let e=this.visibleCols.centerCols;this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(e){return e.isAutoHeaderHeight()||E7(e)?!0:this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;let t=e.getLeft()||0,i=t+e.getActualWidth(),s=this.viewportLeft-200,n=this.viewportRight+200,o=t<s&&i<s,l=t>n&&i>n;return!o&&!l}getViewportColumns(){let{leftCols:e,rightCols:t}=this.visibleCols;return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.colModel.colSpanActive)return this.colsWithinViewport;let t=o=>{let l=o.getLeft();return st(l)&&l>this.viewportLeft},i=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),{visibleCols:s}=this,n=s.centerCols;return s.getColsForRow(e,n,i,t)}checkViewportColumns(e=!1){this.extractViewport()&&this.eventSvc.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}calculateHeaderRows(){let{leftCols:e,rightCols:t}=this.visibleCols;this.columnsToRenderLeft=e,this.columnsToRenderRight=t,this.columnsToRenderCenter=this.colsWithinViewport;let i=s=>{let n=new Set,o={};for(let l of s){let d=l.getParent(),p=l.isSpanHeaderHeight();for(;d&&!n.has(d);){if(p&&d.isPadding()){d=d.getParent();continue}let C=d.getProvidedColumnGroup().getLevel();o[C]??(o[C]=[]),o[C].push(d),n.add(d),d=d.getParent()}}return o};this.rowsOfHeadersToRenderLeft=i(e),this.rowsOfHeadersToRenderRight=i(t),this.rowsOfHeadersToRenderCenter=i(this.headerColsWithinViewport)}extractViewport(){let e=s=>`${s.getId()}-${s.getPinned()||"normal"}`;this.extractViewportColumns();let t=this.getViewportColumns().map(e).join("#"),i=this.colsWithinViewportHash!==t;return i&&(this.colsWithinViewportHash=t,this.calculateHeaderRows()),i}};function E7(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}var P7=class extends Be{constructor(){super(...arguments),this.beanName="agCompUtils"}adaptFunction(e,t){if(!e.cellRenderer)return null;class i{refresh(){return!1}getGui(){return this.eGui}init(n){let o=t(n),l=typeof o;if(l==="string"||l==="number"||l==="boolean"){this.eGui=jC("<span>"+o+"</span>");return}if(o==null){this.eGui=rs({tag:"span"});return}this.eGui=o}}return i}},M7={moduleName:"CellRendererFunction",version:nt,beans:[P7]},T7=class extends O8{constructor(){super(...arguments),this.agGridDefaults={},this.agGridDefaultOverrides={},this.jsComps={},this.selectors={},this.icons={}}postConstruct(){let e=this.gos.get("components");if(e!=null)for(let t of Object.keys(e))this.jsComps[t]=e[t]}registerModule(e){let{icons:t,userComponents:i,dynamicBeans:s,selectors:n}=e;if(i){let o=(l,d,p,y)=>{this.agGridDefaults[l]=d,(p||y)&&(this.agGridDefaultOverrides[l]={params:p,processParams:y})};for(let l of Object.keys(i)){let d=i[l];if(k5(d)&&(d=d.getComp(this.beans)),typeof d=="object"){let{classImp:p,params:y,processParams:C}=d;o(l,p,y,C)}else o(l,d)}}if(this.registerDynamicBeans(s),n?.forEach(o=>{this.selectors[o.selector]=o}),t)for(let o of Object.keys(t))this.icons[o]=t[o]}getUserComponent(e,t){let i=(d,p,y,C)=>({componentFromFramework:p,component:d,params:y,processParams:C}),{frameworkOverrides:s}=this.beans,n=s.frameworkComponent(t,this.gos.get("components"));if(n!=null)return i(n,!0);let o=this.jsComps[t];if(o){let d=s.isFrameworkComponent(o);return i(o,d)}let l=this.agGridDefaults[t];if(l){let d=this.agGridDefaultOverrides[t];return i(l,!1,d?.params,d?.processParams)}return this.beans.validation?.missingUserComponent(e,t,this.agGridDefaults,this.jsComps),null}getSelector(e){return this.selectors[e]}getIcon(e){return this.icons[e]}getDynamicError(e,t){return t?cr(279,{name:e}):this.beans.validation?.missingDynamicBean(e)??cr(256)}},D7=23,F7=class extends Be{constructor(){super(...arguments),this.beanName="ctrlsSvc",this.params={},this.ready=!1,this.readyCallbacks=[]}postConstruct(){this.addEventListener("ready",()=>{this.updateReady(),this.ready&&(this.readyCallbacks.forEach(e=>e(this.params)),this.readyCallbacks.length=0)},this.beans.frameworkOverrides.runWhenReadyAsync?.()??!1)}updateReady(){let e=Object.values(this.params);this.ready=e.length===D7&&e.every(t=>t?.isAlive()??!1)}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc(()=>{let i=this.readyCallbacks.indexOf(t);i>=0&&this.readyCallbacks.splice(i,1)})}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc(()=>{this.updateReady()})}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){let{leftHeader:e,centerHeader:t,rightHeader:i}=this.params;return[e,i,t]}getHeaderRowContainerCtrl(e){let t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}getScrollFeature(){return this.getGridBodyCtrl().scrollFeature}},QM=new Set,pv={},xu={},qm,JM=!1,eT=!1,I7=!1;function k7(e){let[t,i]=e.version.split(".")||[],[s,n]=qm.split(".")||[];return t===s&&i===n}function A7(e){qm||(qm=e.version);let t=i=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${i} Please update all modules to the same version.`;if(e.version?k7(e)||fu(t(`'${e.moduleName}' is version ${e.version} but the other modules are version ${qm}.`)):fu(t(`'${e.moduleName}' is incompatible.`)),e.validate){let i=e.validate();i.isValid||fu(`${i.message}`)}}function tg(e,t,i=!1){i||(JM=!0),A7(e);let s=e.rowModels??["all"];QM.add(e);let n;t!==void 0?(eT=!0,xu[t]===void 0&&(xu[t]={}),n=xu[t]):n=pv,s.forEach(o=>{n[o]===void 0&&(n[o]={}),n[o][e.moduleName]=e}),e.dependsOn&&e.dependsOn.forEach(o=>tg(o,t,i))}function L7(e){delete xu[e]}function kC(e,t,i){let s=n=>!!pv[n]?.[e]||!!xu[t]?.[n]?.[e];return s(i)||s("all")}function wb(){return eT}function O7(e,t){let i=xu[e]??{};return[...Object.values(pv.all??{}),...Object.values(i.all??{}),...Object.values(pv[t]??{}),...Object.values(i[t]??{})]}function z7(){return new Set(QM)}function B7(){return JM}function V7(){return I7}var tT=class{static register(e){tg(e,void 0)}static registerModules(e){e.forEach(t=>tg(t,void 0))}},H7='.ag-aria-description-container{border:0;z-index:9999;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.ag-unselectable{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text}.ag-tab-guard{display:block;height:0;position:absolute;width:0}:where(.ag-virtual-list-viewport) .ag-tab-guard{position:sticky}.ag-tab-guard-top{top:1px}.ag-tab-guard-bottom{bottom:1px}.ag-shake-left-to-right{animation-direction:alternate;animation-duration:.2s;animation-iteration-count:infinite;animation-name:ag-shake-left-to-right}@keyframes ag-shake-left-to-right{0%{padding-left:6px;padding-right:2px}to{padding-left:2px;padding-right:6px}}.ag-body-horizontal-scroll-viewport,.ag-body-vertical-scroll-viewport,.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport,.ag-virtual-list-viewport{flex:1 1 auto;height:100%;min-width:0;overflow:hidden;position:relative}.ag-viewport{position:relative}.ag-spanning-container{position:absolute;top:0;z-index:1}.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{overflow-x:auto;-ms-overflow-style:none!important;scrollbar-width:none!important;&::-webkit-scrollbar{display:none!important}}.ag-body-viewport{display:flex;overflow-x:hidden;&:where(.ag-layout-normal){overflow-y:auto;-webkit-overflow-scrolling:touch}}.ag-floating-bottom-container,.ag-floating-top-container,.ag-sticky-bottom-container,.ag-sticky-top-container{min-height:1px}.ag-center-cols-viewport{min-height:100%;width:100%}.ag-body-horizontal-scroll-viewport{overflow-x:scroll}.ag-body-vertical-scroll-viewport{overflow-y:scroll}.ag-virtual-list-viewport{overflow:auto;width:100%}.ag-body-container,.ag-body-horizontal-scroll-container,.ag-body-vertical-scroll-container,.ag-center-cols-container,.ag-floating-bottom-container,.ag-floating-bottom-full-width-container,.ag-floating-top-container,.ag-full-width-container,.ag-header-container,.ag-pinned-left-cols-container,.ag-pinned-right-cols-container,.ag-sticky-bottom-container,.ag-sticky-top-container,.ag-virtual-list-container{position:relative}.ag-floating-bottom-container,.ag-floating-top-container,.ag-header-container,.ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top,.ag-sticky-bottom-container,.ag-sticky-top-container{height:100%;white-space:nowrap}.ag-center-cols-container,.ag-pinned-right-cols-container{display:block}.ag-body-horizontal-scroll-container{height:100%}.ag-body-vertical-scroll-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container,.ag-full-width-container,.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{pointer-events:none;position:absolute;top:0}:where(.ag-ltr) .ag-floating-bottom-full-width-container,:where(.ag-ltr) .ag-floating-top-full-width-container,:where(.ag-ltr) .ag-full-width-container,:where(.ag-ltr) .ag-sticky-bottom-full-width-container,:where(.ag-ltr) .ag-sticky-top-full-width-container{left:0}:where(.ag-rtl) .ag-floating-bottom-full-width-container,:where(.ag-rtl) .ag-floating-top-full-width-container,:where(.ag-rtl) .ag-full-width-container,:where(.ag-rtl) .ag-sticky-bottom-full-width-container,:where(.ag-rtl) .ag-sticky-top-full-width-container{right:0}.ag-full-width-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container{display:inline-block;height:100%;overflow:hidden;width:100%}.ag-virtual-list-container{overflow:hidden}.ag-body{display:flex;flex:1 1 auto;flex-direction:row!important;min-height:0;position:relative}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:flex;min-height:0;min-width:0;position:relative;&:where(.ag-scrollbar-invisible){bottom:0;position:absolute;&:where(.ag-apple-scrollbar){opacity:0;transition:opacity .4s;visibility:hidden;&:where(.ag-scrollbar-scrolling,.ag-scrollbar-active){opacity:1;visibility:visible}}}}.ag-body-horizontal-scroll{width:100%;&:where(.ag-scrollbar-invisible){left:0;right:0}}.ag-body-vertical-scroll{height:100%;&:where(.ag-scrollbar-invisible){top:0;z-index:10}}:where(.ag-ltr) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){right:0}}:where(.ag-rtl) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){left:0}}.ag-force-vertical-scroll{overflow-y:scroll!important}.ag-horizontal-left-spacer,.ag-horizontal-right-spacer{height:100%;min-width:0;overflow-x:scroll;&:where(.ag-scroller-corner){overflow-x:hidden}}:where(.ag-row-animation) .ag-row{transition:transform .4s,top .4s,opacity .2s;&:where(.ag-after-created){transition:transform .4s,top .4s,height .4s,opacity .2s}}:where(.ag-row-animation.ag-prevent-animation) .ag-row{transition:none!important;&:where(.ag-row.ag-after-created){transition:none!important}}:where(.ag-row-no-animation) .ag-row{transition:none}.ag-row-loading{align-items:center;display:flex}.ag-row-position-absolute{position:absolute}.ag-row-position-relative{position:relative}.ag-full-width-row{overflow:hidden;pointer-events:all}.ag-row-inline-editing{z-index:1}.ag-row-dragging{z-index:2}.ag-stub-cell{align-items:center;display:flex}.ag-cell{display:inline-block;height:100%;position:absolute;white-space:nowrap;&:focus-visible{box-shadow:none}}.ag-cell-value{flex:1 1 auto}.ag-cell-value,.ag-group-value{overflow:hidden;text-overflow:ellipsis}.ag-cell-wrap-text{white-space:normal;word-break:break-word}:where(.ag-cell) .ag-icon{display:inline-block;vertical-align:middle}.ag-floating-top{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-top:not(.ag-invisible)){border-bottom:var(--ag-pinned-row-border)}.ag-floating-bottom{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-bottom:not(.ag-invisible)){border-top:var(--ag-pinned-row-border)}.ag-sticky-bottom,.ag-sticky-top{background-color:var(--ag-background-color);display:flex;height:0;overflow:hidden;position:absolute;width:100%;z-index:1}.ag-opacity-zero{opacity:0!important}.ag-cell-label-container{align-items:center;display:flex;flex-direction:row-reverse;height:100%;justify-content:space-between;width:100%}:where(.ag-right-aligned-header){.ag-cell-label-container{flex-direction:row}.ag-header-cell-text{text-align:end}}.ag-column-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr){direction:ltr;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row}}:where(.ag-rtl){direction:rtl;text-align:right;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row-reverse}.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{display:block}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(180deg)}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(-180deg)}}.ag-measurement-container{height:0;overflow:hidden;visibility:hidden;width:0}.ag-measurement-element-border{display:inline-block;&:before{border-left:var(--ag-internal-measurement-border);content:"";display:block}}.ag-group{position:relative;width:100%}.ag-group-title-bar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-title{display:inline;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-group-title-bar) .ag-group-title{cursor:default}.ag-group-toolbar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-container{display:flex}.ag-disabled .ag-group-container{pointer-events:none}.ag-disabled-group-container,.ag-disabled-group-title-bar{opacity:.5}.ag-group-container-horizontal{flex-flow:row wrap}.ag-group-container-vertical{flex-direction:column}.ag-group-title-bar-icon{cursor:pointer;flex:none}:where(.ag-ltr) .ag-group-title-bar-icon{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-group-title-bar-icon{margin-left:var(--ag-spacing)}:where(.ag-group-item-alignment-stretch) .ag-group-item{align-items:stretch}:where(.ag-group-item-alignment-start) .ag-group-item{align-items:flex-start}:where(.ag-group-item-alignment-end) .ag-group-item{align-items:flex-end}:where(.ag-ltr) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-left:var(--ag-row-group-indent-size)}:where(.ag-rtl) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-right:var(--ag-row-group-indent-size)}:where(.ag-ltr) .ag-row-group-leaf-indent{margin-left:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}:where(.ag-rtl) .ag-row-group-leaf-indent{margin-right:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-value-change-delta{padding:0 2px}.ag-value-change-delta-up{color:var(--ag-value-change-delta-up-color)}.ag-value-change-delta-down{color:var(--ag-value-change-delta-down-color)}.ag-value-change-value{background-color:transparent;border-radius:1px;padding-left:1px;padding-right:1px;transition:background-color 1s}.ag-value-change-value-highlight{background-color:var(--ag-value-change-value-highlight-background-color);transition:background-color .1s}.ag-cell-data-changed{background-color:var(--ag-value-change-value-highlight-background-color)!important}.ag-cell-data-changed-animation{background-color:transparent}.ag-cell-highlight{background-color:var(--ag-range-selection-highlight-color)!important}.ag-row,.ag-spanned-row{color:var(--ag-cell-text-color);font-family:var(--ag-cell-font-family);font-size:var(--ag-data-font-size);white-space:nowrap;--ag-internal-content-line-height:calc(min(var(--ag-row-height), var(--ag-line-height, 1000px)) - var(--ag-internal-row-border-width, 1px) - 2px)}.ag-row{background-color:var(--ag-background-color);border-bottom:var(--ag-row-border);height:var(--ag-row-height);width:100%;&.ag-row-editing-invalid{background-color:var(--ag-full-row-edit-invalid-background-color)}}:where(.ag-body-vertical-content-no-gap>div>div>div,.ag-body-vertical-content-no-gap>div>div>div>div)>.ag-row-last{border-bottom-color:transparent}.ag-sticky-bottom{border-top:var(--ag-row-border);box-sizing:content-box!important}.ag-group-contracted,.ag-group-expanded{cursor:pointer}.ag-cell,.ag-full-width-row .ag-cell-wrapper.ag-row-group{border:1px solid transparent;line-height:var(--ag-internal-content-line-height);-webkit-font-smoothing:subpixel-antialiased}:where(.ag-ltr) .ag-cell{border-right:var(--ag-column-border)}:where(.ag-rtl) .ag-cell{border-left:var(--ag-column-border)}.ag-spanned-cell-wrapper{background-color:var(--ag-background-color);position:absolute}.ag-spanned-cell-wrapper>.ag-spanned-cell{display:block;position:relative}:where(.ag-ltr) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-right-color:transparent}:where(.ag-rtl) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-left-color:transparent}.ag-cell-wrapper{align-items:center;display:flex;>:where(:not(.ag-cell-value,.ag-group-value)){align-items:center;display:flex;height:var(--ag-internal-content-line-height)}&:where(.ag-row-group){align-items:flex-start}:where(.ag-full-width-row) &:where(.ag-row-group){align-items:center;height:100%}}:where(.ag-ltr) .ag-cell-wrapper{padding-left:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-rtl) .ag-cell-wrapper{padding-right:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-cell-wrap-text:not(.ag-cell-auto-height)) .ag-cell-wrapper{align-items:normal;height:100%;:where(.ag-cell-value){height:100%}}:where(.ag-ltr) .ag-row>.ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}:where(.ag-rtl) .ag-row>.ag-cell-wrapper.ag-row-group{padding-right:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-cell-focus:not(.ag-cell-range-selected):focus-within,.ag-cell-range-single-cell,.ag-cell-range-single-cell.ag-cell-range-handle,.ag-context-menu-open .ag-cell-focus:not(.ag-cell-range-selected),.ag-context-menu-open .ag-full-width-row.ag-row-focus .ag-cell-wrapper.ag-row-group,.ag-full-width-row.ag-row-focus:focus .ag-cell-wrapper.ag-row-group{border:1px solid;border-color:var(--ag-range-selection-border-color);border-style:var(--ag-range-selection-border-style);outline:initial}.ag-full-width-row.ag-row-focus:focus{box-shadow:none}:where(.ag-ltr) .ag-group-contracted,:where(.ag-ltr) .ag-group-expanded,:where(.ag-ltr) .ag-row-drag,:where(.ag-ltr) .ag-selection-checkbox{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-contracted,:where(.ag-rtl) .ag-group-expanded,:where(.ag-rtl) .ag-row-drag,:where(.ag-rtl) .ag-selection-checkbox{margin-left:var(--ag-cell-widget-spacing)}:where(.ag-ltr) .ag-group-child-count{margin-left:3px}:where(.ag-rtl) .ag-group-child-count{margin-right:3px}.ag-row-highlight-above:after,.ag-row-highlight-below:after,.ag-row-highlight-inside:after{background-color:var(--ag-range-selection-border-color);content:"";height:1px;pointer-events:none;position:absolute;width:calc(100% - 1px)}:where(.ag-ltr) .ag-row-highlight-above:after,:where(.ag-ltr) .ag-row-highlight-below:after,:where(.ag-ltr) .ag-row-highlight-inside:after{left:1px}:where(.ag-rtl) .ag-row-highlight-above:after,:where(.ag-rtl) .ag-row-highlight-below:after,:where(.ag-rtl) .ag-row-highlight-inside:after{right:1px}.ag-row-highlight-above:after{top:0}.ag-row-highlight-below:after{bottom:0}.ag-row-highlight-indent:after{display:block;width:auto}:where(.ag-ltr) .ag-row-highlight-indent:after{left:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size));right:1px}:where(.ag-rtl) .ag-row-highlight-indent:after{left:1px;right:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size))}.ag-row-highlight-inside:after{background-color:var(--ag-selected-row-background-color);border:1px solid var(--ag-range-selection-border-color);display:block;height:auto;inset:0;width:auto}.ag-row-odd{background-color:var(--ag-odd-row-background-color)}.ag-row-selected:before{background-color:var(--ag-selected-row-background-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-full-width-row.ag-row-group:before,.ag-row-hover:not(.ag-full-width-row):before{background-color:var(--ag-row-hover-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-row-selected:before{background-color:var(--ag-row-hover-color);background-image:linear-gradient(var(--ag-selected-row-background-color),var(--ag-selected-row-background-color))}.ag-row.ag-full-width-row.ag-row-group>*{position:relative}.ag-column-hover{background-color:var(--ag-column-hover-color)}.ag-header-range-highlight{background-color:var(--ag-range-header-highlight-color)}.ag-right-aligned-cell{font-variant-numeric:tabular-nums}:where(.ag-ltr) .ag-right-aligned-cell{text-align:right}:where(.ag-rtl) .ag-right-aligned-cell{text-align:left}.ag-right-aligned-cell .ag-cell-value,.ag-right-aligned-cell .ag-group-value{margin-left:auto}:where(.ag-ltr) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-ltr) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level));padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}:where(.ag-rtl) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-rtl) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-row>.ag-cell-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-row-dragging{cursor:move;opacity:.5}.ag-details-row{background-color:var(--ag-background-color);padding:calc(var(--ag-spacing)*3.75)}.ag-layout-auto-height,.ag-layout-print{.ag-center-cols-container,.ag-center-cols-viewport{min-height:150px}}.ag-overlay-loading-wrapper{background-color:var(--ag-modal-overlay-background-color)}.ag-skeleton-container{align-content:center;height:100%;width:100%}.ag-skeleton-effect{animation:ag-skeleton-loading 1.5s ease-in-out .5s infinite;background-color:var(--ag-row-loading-skeleton-effect-color);border-radius:.25rem;height:1em;width:100%}:where(.ag-ltr) .ag-right-aligned-cell .ag-skeleton-effect{margin-left:auto}:where(.ag-rtl) .ag-right-aligned-cell .ag-skeleton-effect{margin-right:auto}@keyframes ag-skeleton-loading{0%{background-color:var(--ag-row-loading-skeleton-effect-color)}50%{background-color:color-mix(in srgb,transparent,var(--ag-row-loading-skeleton-effect-color) 40%)}to{background-color:var(--ag-row-loading-skeleton-effect-color)}}.ag-loading{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-loading{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-loading{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-ltr) .ag-loading-icon{padding-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-loading-icon{padding-left:var(--ag-cell-widget-spacing)}.ag-icon-loading{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ag-header{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);color:var(--ag-header-text-color);display:flex;font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);overflow:hidden;white-space:nowrap;width:100%}.ag-header-row{height:var(--ag-header-height);position:absolute}.ag-floating-filter-button-button,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,:where(.ag-header-cell-sortable) .ag-header-cell-label{cursor:pointer}:where(.ag-ltr) .ag-header-expand-icon{margin-left:4px}:where(.ag-rtl) .ag-header-expand-icon{margin-right:4px}.ag-header-row:where(:not(:first-child)){:where(.ag-header-cell:not(.ag-header-span-height.ag-header-span-total,.ag-header-parent-hidden),.ag-header-group-cell.ag-header-group-cell-with-group){border-top:var(--ag-header-row-border)}}.ag-header-row:where(:not(.ag-header-row-column-group)){overflow:hidden}:where(.ag-header.ag-header-allow-overflow) .ag-header-row{overflow:visible}.ag-header-cell{display:inline-flex;overflow:hidden}.ag-header-group-cell{contain:paint;display:flex}.ag-header-cell,.ag-header-group-cell{align-items:center;gap:var(--ag-cell-widget-spacing);height:100%;padding:0 var(--ag-cell-horizontal-padding);position:absolute}@property --ag-internal-moving-color{syntax:"<color>";inherits:false;initial-value:transparent}@property --ag-internal-hover-color{syntax:"<color>";inherits:false;initial-value:transparent}.ag-header-cell:where(:not(.ag-floating-filter)),.ag-header-group-cell{&:before{background-image:linear-gradient(var(--ag-internal-hover-color),var(--ag-internal-hover-color)),linear-gradient(var(--ag-internal-moving-color),var(--ag-internal-moving-color));content:"";inset:0;position:absolute;--ag-internal-moving-color:transparent;--ag-internal-hover-color:transparent;transition:--ag-internal-moving-color var(--ag-header-cell-background-transition-duration),--ag-internal-hover-color var(--ag-header-cell-background-transition-duration)}&:where(:hover):before{--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}&:where(.ag-header-cell-moving):before{--ag-internal-moving-color:var(--ag-header-cell-moving-background-color);--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}}:where(.ag-header-cell:not(.ag-floating-filter) *,.ag-header-group-cell *){position:relative;z-index:1}.ag-header-cell-menu-button:where(:not(.ag-header-menu-always-show)){opacity:0;transition:opacity .2s}.ag-header-cell-filter-button,:where(.ag-header-cell.ag-header-active) .ag-header-cell-menu-button{opacity:1}.ag-header-cell-label,.ag-header-group-cell-label{align-items:center;align-self:stretch;display:flex;flex:1 1 auto;overflow:hidden;padding:5px 0}:where(.ag-ltr) .ag-sort-indicator-icon{padding-left:var(--ag-spacing)}:where(.ag-rtl) .ag-sort-indicator-icon{padding-right:var(--ag-spacing)}.ag-header-cell-label{text-overflow:ellipsis}.ag-header-group-cell-label.ag-sticky-label{flex:none;max-width:100%;overflow:visible;position:sticky}:where(.ag-ltr) .ag-header-group-cell-label.ag-sticky-label{left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-header-group-cell-label.ag-sticky-label{right:var(--ag-cell-horizontal-padding)}.ag-header-cell-text,.ag-header-group-text{overflow:hidden;text-overflow:ellipsis}.ag-header-cell-text{word-break:break-word}.ag-header-cell-comp-wrapper{width:100%}:where(.ag-header-group-cell) .ag-header-cell-comp-wrapper{display:flex}:where(.ag-header-cell:not(.ag-header-cell-auto-height)) .ag-header-cell-comp-wrapper{align-items:center;display:flex;height:100%}.ag-header-cell-wrap-text .ag-header-cell-comp-wrapper{white-space:normal}.ag-header-cell-comp-wrapper-limited-height>*{overflow:hidden}:where(.ag-right-aligned-header) .ag-header-cell-label{flex-direction:row-reverse}:where(.ag-ltr) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-ltr) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-header-cell:after,.ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{content:"";height:var(--ag-header-column-border-height);position:absolute;top:calc(50% - var(--ag-header-column-border-height)*.5);z-index:1}:where(.ag-ltr) .ag-header-cell:after,:where(.ag-ltr) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-right:var(--ag-header-column-border);right:0}:where(.ag-rtl) .ag-header-cell:after,:where(.ag-rtl) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-left:var(--ag-header-column-border);left:0}.ag-header-highlight-after:after,.ag-header-highlight-before:after{background-color:var(--ag-accent-color);content:"";height:100%;position:absolute;width:1px}:where(.ag-ltr) .ag-header-highlight-before:after{left:0}:where(.ag-rtl) .ag-header-highlight-before:after{right:0}:where(.ag-ltr) .ag-header-highlight-after:after{right:0;:where(.ag-pinned-left-header) &{right:1px}}:where(.ag-rtl) .ag-header-highlight-after:after{left:0;:where(.ag-pinned-left-header) &{left:1px}}.ag-header-cell-resize{align-items:center;cursor:ew-resize;display:flex;height:100%;position:absolute;top:0;width:8px;z-index:2;&:after{background-color:var(--ag-header-column-resize-handle-color);content:"";height:var(--ag-header-column-resize-handle-height);position:absolute;top:calc(50% - var(--ag-header-column-resize-handle-height)*.5);width:var(--ag-header-column-resize-handle-width);z-index:1}}:where(.ag-ltr) .ag-header-cell-resize{right:-3px;&:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-rtl) .ag-header-cell-resize{left:-3px;&:after{right:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-header-cell.ag-header-span-height) .ag-header-cell-resize:after{height:calc(100% - var(--ag-spacing)*4);top:calc(var(--ag-spacing)*2)}.ag-header-group-cell-no-group:where(.ag-header-span-height){display:none}.ag-sort-indicator-container{display:flex;gap:var(--ag-spacing)}.ag-layout-print{&.ag-body{display:block;height:unset}&.ag-root-wrapper{display:inline-block}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:none}&.ag-force-vertical-scroll{overflow-y:visible!important}}@media print{.ag-root-wrapper.ag-layout-print{display:table;.ag-body-horizontal-scroll-viewport,.ag-body-viewport,.ag-center-cols-container,.ag-center-cols-viewport,.ag-root,.ag-root-wrapper-body,.ag-virtual-list-viewport{display:block!important;height:auto!important;overflow:hidden!important}.ag-cell,.ag-row{-moz-column-break-inside:avoid;break-inside:avoid}}}ag-grid,ag-grid-angular{display:block}.ag-root-wrapper{border:var(--ag-wrapper-border);border-radius:var(--ag-wrapper-border-radius);display:flex;flex-direction:column;overflow:hidden;position:relative;&.ag-layout-normal{height:100%}}.ag-root-wrapper-body{display:flex;flex-direction:row;&.ag-layout-normal{flex:1 1 auto;height:0;min-height:0}}.ag-root{display:flex;flex-direction:column;position:relative;&.ag-layout-auto-height,&.ag-layout-normal{flex:1 1 auto;overflow:hidden;width:0}&.ag-layout-normal{height:100%}}.ag-virtual-list-item{height:var(--ag-list-item-height);position:absolute;width:100%}.ag-list-item-hovered:after{background-color:var(--ag-accent-color);content:"";height:1px;left:0;position:absolute;right:0}.ag-item-highlight-top:after{top:0}.ag-item-highlight-bottom:after{bottom:0}.ag-drag-handle{color:var(--ag-drag-handle-color);cursor:grab;:where(.ag-icon){color:var(--ag-drag-handle-color)}}.ag-chart-menu-icon,.ag-chart-settings-next,.ag-chart-settings-prev,.ag-column-group-icons,.ag-column-select-header-icon,.ag-filter-toolpanel-expand,.ag-floating-filter-button-button,.ag-group-title-bar-icon,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,.ag-panel-title-bar-button-icon,.ag-set-filter-group-icons,:where(.ag-group-contracted) .ag-icon,:where(.ag-group-expanded) .ag-icon{background-color:var(--ag-icon-button-background-color);border-radius:var(--ag-icon-button-border-radius);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-background-color);color:var(--ag-icon-button-color);&:hover{background-color:var(--ag-icon-button-hover-background-color);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-hover-background-color);color:var(--ag-icon-button-hover-color)}}.ag-filter-active{background-image:linear-gradient(var(--ag-icon-button-active-background-color),var(--ag-icon-button-active-background-color));border-radius:1px;outline:solid var(--ag-icon-button-background-spread) var(--ag-icon-button-active-background-color);position:relative;&:after{background-color:var(--ag-icon-button-active-indicator-color);border-radius:50%;content:"";height:6px;position:absolute;top:-1px;width:6px}:where(.ag-icon-filter){clip-path:path("M8,0C8,4.415 11.585,8 16,8L16,16L0,16L0,0L8,0Z");color:var(--ag-icon-button-active-color)}}:where(.ag-ltr) .ag-filter-active{&:after{right:-1px}}:where(.ag-rtl) .ag-filter-active{&:after{left:-1px}}.ag-menu{background-color:var(--ag-menu-background-color);border:var(--ag-menu-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-menu-shadow);color:var(--ag-menu-text-color);max-height:100%;overflow-y:auto;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}',N7={wrapperBorder:!0,rowBorder:!0,headerRowBorder:!0,footerRowBorder:{ref:"rowBorder"},columnBorder:{style:"solid",width:1,color:"transparent"},headerColumnBorder:!1,headerColumnBorderHeight:"100%",pinnedColumnBorder:!0,pinnedRowBorder:!0,sidePanelBorder:!0,sideBarPanelWidth:250,sideBarBackgroundColor:{ref:"chromeBackgroundColor"},sideButtonBarBackgroundColor:{ref:"sideBarBackgroundColor"},sideButtonBarTopPadding:0,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineColor:"transparent",sideButtonSelectedUnderlineTransitionDuration:0,sideButtonBackgroundColor:"transparent",sideButtonTextColor:{ref:"textColor"},sideButtonHoverBackgroundColor:{ref:"sideButtonBackgroundColor"},sideButtonHoverTextColor:{ref:"sideButtonTextColor"},sideButtonSelectedBackgroundColor:wo,sideButtonSelectedTextColor:{ref:"sideButtonTextColor"},sideButtonBorder:"solid 1px transparent",sideButtonSelectedBorder:!0,sideButtonLeftPadding:{ref:"spacing"},sideButtonRightPadding:{ref:"spacing"},sideButtonVerticalPadding:{calc:"spacing * 3"},headerBackgroundColor:{ref:"chromeBackgroundColor"},headerFontFamily:{ref:"fontFamily"},cellFontFamily:{ref:"fontFamily"},headerFontWeight:500,headerFontSize:{ref:"fontSize"},dataFontSize:{ref:"fontSize"},headerTextColor:{ref:"textColor"},headerCellHoverBackgroundColor:"transparent",headerCellMovingBackgroundColor:{ref:"headerCellHoverBackgroundColor"},headerCellBackgroundTransitionDuration:"0.2s",cellTextColor:{ref:"textColor"},rangeSelectionBorderStyle:"solid",rangeSelectionBorderColor:Xr,rangeSelectionBackgroundColor:or(.2),rangeSelectionChartBackgroundColor:"#0058FF1A",rangeSelectionChartCategoryBackgroundColor:"#00FF841A",rangeSelectionHighlightColor:or(.5),rangeHeaderHighlightColor:f8(.08),rowNumbersSelectedColor:or(.5),rowHoverColor:or(.08),columnHoverColor:or(.05),selectedRowBackgroundColor:or(.12),modalOverlayBackgroundColor:{ref:"backgroundColor",mix:.66},oddRowBackgroundColor:wo,wrapperBorderRadius:8,cellHorizontalPadding:{calc:"spacing * 2 * cellHorizontalPaddingScale"},cellWidgetSpacing:{calc:"spacing * 1.5"},cellHorizontalPaddingScale:1,rowGroupIndentSize:{calc:"cellWidgetSpacing + iconSize"},valueChangeDeltaUpColor:"#43a047",valueChangeDeltaDownColor:"#e53935",valueChangeValueHighlightBackgroundColor:"#16a08580",rowHeight:{calc:"max(iconSize, dataFontSize) + spacing * 3.25 * rowVerticalPaddingScale"},rowVerticalPaddingScale:1,headerHeight:{calc:"max(iconSize, dataFontSize) + spacing * 4 * headerVerticalPaddingScale"},headerVerticalPaddingScale:1,paginationPanelHeight:{ref:"rowHeight",calc:"max(rowHeight, 22px)"},dragHandleColor:Qo(.7),headerColumnResizeHandleHeight:"30%",headerColumnResizeHandleWidth:2,headerColumnResizeHandleColor:{ref:"borderColor"},widgetContainerHorizontalPadding:{calc:"spacing * 1.5"},widgetContainerVerticalPadding:{calc:"spacing * 1.5"},widgetHorizontalSpacing:{calc:"spacing * 1.5"},widgetVerticalSpacing:{ref:"spacing"},iconButtonColor:{ref:"iconColor"},iconButtonBackgroundColor:"transparent",iconButtonBackgroundSpread:4,iconButtonBorderRadius:1,iconButtonHoverColor:{ref:"iconButtonColor"},iconButtonHoverBackgroundColor:Qo(.1),iconButtonActiveColor:Xr,iconButtonActiveBackgroundColor:or(.28),iconButtonActiveIndicatorColor:Xr,menuBorder:{color:Qo(.2)},menuBackgroundColor:en(.03),menuTextColor:en(.95),menuShadow:{ref:"popupShadow"},menuSeparatorColor:{ref:"borderColor"},setFilterIndentSize:{ref:"iconSize"},chartMenuPanelWidth:260,chartMenuLabelColor:Qo(.8),dialogShadow:{ref:"popupShadow"},cellEditingBorder:{color:Xr},cellEditingShadow:{ref:"cardShadow"},fullRowEditInvalidBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.25},dialogBorder:{color:Qo(.2)},panelBackgroundColor:wo,panelTitleBarBackgroundColor:{ref:"headerBackgroundColor"},panelTitleBarIconColor:{ref:"headerTextColor"},panelTitleBarTextColor:{ref:"headerTextColor"},panelTitleBarFontWeight:{ref:"headerFontWeight"},panelTitleBarBorder:!0,columnSelectIndentSize:{ref:"iconSize"},toolPanelSeparatorBorder:!0,columnDropCellBackgroundColor:Qo(.07),columnDropCellTextColor:{ref:"textColor"},columnDropCellDragHandleColor:{ref:"textColor"},columnDropCellBorder:{color:Qo(.13)},selectCellBackgroundColor:Qo(.07),selectCellBorder:{color:Qo(.13)},advancedFilterBuilderButtonBarBorder:!0,advancedFilterBuilderIndentSize:{calc:"spacing * 2 + iconSize"},advancedFilterBuilderJoinPillColor:"#f08e8d",advancedFilterBuilderColumnPillColor:"#a6e194",advancedFilterBuilderOptionPillColor:"#f3c08b",advancedFilterBuilderValuePillColor:"#85c0e4",filterPanelApplyButtonColor:wo,filterPanelApplyButtonBackgroundColor:Xr,filterPanelCardSubtleColor:{ref:"textColor",mix:.7},filterPanelCardSubtleHoverColor:{ref:"textColor"},findMatchColor:du,findMatchBackgroundColor:"#ffff00",findActiveMatchColor:du,findActiveMatchBackgroundColor:"#ffa500",filterToolPanelGroupIndent:{ref:"spacing"},rowLoadingSkeletonEffectColor:Qo(.15),statusBarLabelColor:du,statusBarLabelFontWeight:500,statusBarValueColor:du,statusBarValueFontWeight:500,pinnedSourceRowTextColor:{ref:"textColor"},pinnedSourceRowBackgroundColor:{ref:"backgroundColor"},pinnedSourceRowFontWeight:600,pinnedRowFontWeight:600,pinnedRowBackgroundColor:{ref:"backgroundColor"},pinnedRowTextColor:{ref:"textColor"}},G7=".ag-cell-batch-edit{background-color:var(--ag-cell-batch-edit-background-color);color:var(--ag-cell-batch-edit-text-color);display:inherit}.ag-row-batch-edit{background-color:var(--ag-row-batch-edit-background-color);color:var(--ag-row-batch-edit-text-color)}",iT={cellBatchEditBackgroundColor:"rgba(220 181 139 / 16%)",cellBatchEditTextColor:"#422f00",rowBatchEditBackgroundColor:{ref:"cellBatchEditBackgroundColor"},rowBatchEditTextColor:{ref:"cellBatchEditTextColor"}},W7=ht(Se({},iT),{cellBatchEditTextColor:"#f3d0b3"}),U7=()=>on({feature:"batchEditStyle",params:iT,css:G7}),j7=U7(),$7=":where(.ag-button){background:none;border:none;color:inherit;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0;text-indent:inherit;text-shadow:inherit;text-transform:inherit;word-spacing:inherit;&:disabled{cursor:default}&:focus-visible{box-shadow:var(--ag-focus-shadow);outline:none}}.ag-standard-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--ag-button-background-color);border:var(--ag-button-border);border-radius:var(--ag-button-border-radius);color:var(--ag-button-text-color);cursor:pointer;font-weight:var(--ag-button-font-weight);padding:var(--ag-button-vertical-padding) var(--ag-button-horizontal-padding);&:hover{background-color:var(--ag-button-hover-background-color);border:var(--ag-button-hover-border);color:var(--ag-button-hover-text-color)}&:active{background-color:var(--ag-button-active-background-color);border:var(--ag-button-active-border);color:var(--ag-button-active-text-color)}&:disabled{background-color:var(--ag-button-disabled-background-color);border:var(--ag-button-disabled-border);color:var(--ag-button-disabled-text-color)}}",q7={buttonTextColor:"inherit",buttonFontWeight:"normal",buttonBackgroundColor:"transparent",buttonBorder:!1,buttonBorderRadius:{ref:"borderRadius"},buttonHorizontalPadding:{calc:"spacing * 2"},buttonVerticalPadding:{ref:"spacing"},buttonHoverTextColor:{ref:"buttonTextColor"},buttonHoverBackgroundColor:{ref:"buttonBackgroundColor"},buttonHoverBorder:{ref:"buttonBorder"},buttonActiveTextColor:{ref:"buttonHoverTextColor"},buttonActiveBackgroundColor:{ref:"buttonHoverBackgroundColor"},buttonActiveBorder:{ref:"buttonHoverBorder"},buttonDisabledTextColor:{ref:"inputDisabledTextColor"},buttonDisabledBackgroundColor:{ref:"inputDisabledBackgroundColor"},buttonDisabledBorder:{ref:"inputDisabledBorder"}};var Z7=()=>on({feature:"buttonStyle",params:ht(Se({},q7),{buttonBackgroundColor:wo,buttonBorder:!0,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBorder:{color:Xr}}),css:$7}),K7=Z7();var X7=".ag-column-drop-vertical-empty-message{align-items:center;border:dashed var(--ag-border-width);border-color:var(--ag-border-color);display:flex;inset:0;justify-content:center;margin:calc(var(--ag-spacing)*1.5) calc(var(--ag-spacing)*2);overflow:hidden;padding:calc(var(--ag-spacing)*2);position:absolute}";var Y7=()=>on({feature:"columnDropStyle",css:X7}),sT=Y7();var Q7={warn:(...e)=>{je(e[0],e[1])},error:(...e)=>{li(e[0],e[1])},preInitErr:(...e)=>{Ap(e[0],e[2],e[1])}},J7=()=>E8(Q7).withParams(N7).withPart(K7).withPart(sT).withPart(j7),eW='.ag-checkbox-input-wrapper,.ag-radio-button-input-wrapper{background-color:var(--ag-checkbox-unchecked-background-color);border:solid var(--ag-checkbox-border-width) var(--ag-checkbox-unchecked-border-color);flex:none;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);:where(input){-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:block;height:var(--ag-icon-size);margin:0;opacity:0;width:var(--ag-icon-size)}&:after{content:"";display:block;inset:0;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;pointer-events:none;position:absolute}&:where(.ag-checked){background-color:var(--ag-checkbox-checked-background-color);border-color:var(--ag-checkbox-checked-border-color);&:after{background-color:var(--ag-checkbox-checked-shape-color)}}&:where(:focus-within,:active){box-shadow:var(--ag-focus-shadow)}&:where(.ag-disabled){filter:grayscale();opacity:.5}}.ag-checkbox-input-wrapper{border-radius:var(--ag-checkbox-border-radius);&:where(.ag-checked):after{-webkit-mask-image:var(--ag-checkbox-checked-shape-image);mask-image:var(--ag-checkbox-checked-shape-image)}&:where(.ag-indeterminate){background-color:var(--ag-checkbox-indeterminate-background-color);border-color:var(--ag-checkbox-indeterminate-border-color);&:after{background-color:var(--ag-checkbox-indeterminate-shape-color);-webkit-mask-image:var(--ag-checkbox-indeterminate-shape-image);mask-image:var(--ag-checkbox-indeterminate-shape-image)}}}.ag-cell-editing-error .ag-checkbox-input-wrapper:focus-within{box-shadow:var(--ag-focus-error-shadow)}.ag-radio-button-input-wrapper{border-radius:100%;&:where(.ag-checked):after{-webkit-mask-image:var(--ag-radio-checked-shape-image);mask-image:var(--ag-radio-checked-shape-image)}}',tW=()=>on({feature:"checkboxStyle",params:{checkboxBorderWidth:1,checkboxBorderRadius:{ref:"borderRadius"},checkboxUncheckedBackgroundColor:wo,checkboxUncheckedBorderColor:en(.3),checkboxCheckedBackgroundColor:Xr,checkboxCheckedBorderColor:{ref:"checkboxCheckedBackgroundColor"},checkboxCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="7" fill="none"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M1 3.5 3.5 6l5-5"/></svg>'},checkboxCheckedShapeColor:wo,checkboxIndeterminateBackgroundColor:en(.3),checkboxIndeterminateBorderColor:{ref:"checkboxIndeterminateBackgroundColor"},checkboxIndeterminateShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="2" fill="none"><rect width="10" height="2" fill="#000" rx="1"/></svg>'},checkboxIndeterminateShapeColor:wo,radioCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" fill="none"><circle cx="3" cy="3" r="3" fill="#000"/></svg>'}},css:eW}),iW=tW(),sW=()=>on({feature:"colorScheme",params:Qp}),oT=sW();var nT=()=>ht(Se(Se({},Qp),W7),{backgroundColor:"hsl(217, 0%, 17%)",foregroundColor:"#FFF",chromeBackgroundColor:en(.05),rowHoverColor:or(.15),selectedRowBackgroundColor:or(.2),menuBackgroundColor:en(.1),browserColorScheme:"dark",popupShadow:"0 0px 20px #000A",cardShadow:"0 1px 4px 1px #000A",advancedFilterBuilderJoinPillColor:"#7a3a37",advancedFilterBuilderColumnPillColor:"#355f2d",advancedFilterBuilderOptionPillColor:"#5a3168",advancedFilterBuilderValuePillColor:"#374c86",filterPanelApplyButtonColor:du,findMatchColor:wo,findActiveMatchColor:wo,checkboxUncheckedBorderColor:en(.4),toggleButtonOffBackgroundColor:en(.4),rowBatchEditBackgroundColor:en(.1)});var rT=()=>ht(Se({},nT()),{backgroundColor:"#1f2836"});var oW=()=>on({feature:"colorScheme",params:rT()}),aT=oW(),nW=()=>on({feature:"colorScheme",params:Qp,modeParams:{light:Qp,dark:nT(),"dark-blue":rT()}}),rW=nW();var lT={aggregation:'<path d="M18 7V4H6l6 8-6 8h12v-3"/>',arrows:'<polyline points="5 9 2 12 5 15"/><polyline points="9 5 12 2 15 5"/><polyline points="15 19 12 22 9 19"/><polyline points="19 9 22 12 19 15"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/>',asc:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',cancel:'<path d="m18 6-12 12"/><path d="m6 6 12 12"/>',chart:'<line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/>',"color-picker":'<path d="m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z"/><path d="m5 2 5 5"/><path d="M2 13h15"/><path d="M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z"/>',columns:'<path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>',contracted:'<path d="m9 18 6-6-6-6"/>',copy:'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>',cross:'<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',csv:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',cut:'<circle cx="6" cy="6" r="3"/><path d="M8.12 8.12 12 12"/><path d="M20 4 8.12 15.88"/><circle cx="6" cy="18" r="3"/><path d="M14.8 14.8 20 20"/>',desc:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',down:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',excel:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',expanded:'<path d="m15 18-6-6 6-6"/>',"eye-slash":'<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>',eye:'<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',filter:'<path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/>',first:'<path d="m17 18-6-6 6-6"/><path d="M7 6v12"/>',group:'<path d="M16 12H3"/><path d="M16 18H3"/><path d="M10 6H3"/><path d="M21 18V8a2 2 0 0 0-2-2h-5"/><path d="m16 8-2-2 2-2"/>',last:'<path d="m7 18 6-6-6-6"/><path d="M17 6v12"/>',left:'<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>',linked:'<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>',loading:'<line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/>',maximize:'<polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/>',menu:'<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',"menu-alt":'<circle cx="12" cy="5" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="12" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="19" r="0.75" fill="#D9D9D9"/>',minimize:'<polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" x2="21" y1="10" y2="3"/><line x1="3" x2="10" y1="21" y2="14"/>',minus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/>',next:'<path d="m9 18 6-6-6-6"/>',none:'<path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/>',"not-allowed":'<circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/>',paste:'<path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/><path d="m17 10 4 4-4 4"/>',pin:'<line x1="12" x2="12" y1="17" y2="22"/><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"/>',pivot:'<path d="M15 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M21 9H3"/><path d="M21 15H3"/>',plus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/>',previous:'<path d="m15 18-6-6 6-6"/>',right:'<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',save:'<path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/>',"small-left":'<path d="m15 18-6-6 6-6"/>',"small-right":'<path d="m9 18 6-6-6-6"/>',tick:'<path d="M20 6 9 17l-5-5"/>',"tree-closed":'<path d="m9 18 6-6-6-6"/>',"tree-indeterminate":'<path d="M5 12h14"/>',"tree-open":'<path d="m6 9 6 6 6-6"/>',unlinked:'<path d="M9 17H7A5 5 0 0 1 7 7"/><path d="M15 7h2a5 5 0 0 1 4 8"/><line x1="8" x2="12" y1="12" y2="12"/><line x1="2" x2="22" y1="2" y2="22"/>',up:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',grip:'<circle cx="5" cy="8" r="0.5"/><circle cx="12" cy="8" r="0.5"/><circle cx="19" cy="8" r="0.5"/><circle cx="5" cy="16" r="0.5"/><circle cx="12" cy="16" r="0.5"/><circle cx="19" cy="16" r="0.5"/><g stroke="none" fill="currentColor"><circle cx="5" cy="8" r="1"/><circle cx="12" cy="8" r="1"/><circle cx="19" cy="8" r="1"/><circle cx="5" cy="16" r="1"/><circle cx="12" cy="16" r="1"/><circle cx="19" cy="16" r="1"/></g>',settings:'<path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/>'},cT={"column-arrow":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 32 32"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 26C0 28.2092 1.79086 30 4 30H14C16.2091 30 18 28.2092 18 26V15H25.8786L24.4394 16.4393C23.8536 17.0251 23.8536 17.9749 24.4394 18.5607C25.0252 19.1464 25.9748 19.1464 26.5606 18.5607L30.5606 14.5607C31.1464 13.9749 31.1464 13.0251 30.5606 12.4393L26.5606 8.43934C25.9748 7.85356 25.0252 7.85356 24.4394 8.43934C23.8536 9.02512 23.8536 9.97488 24.4394 10.5607L25.8786 12H18V6C18 3.79086 16.2091 2 14 2H4C1.79086 2 0 3.79086 0 6V26ZM14 5H10.5V12H15V6C15 5.44772 14.5523 5 14 5ZM4 5H7.5V12H3V6C3 5.44772 3.44772 5 4 5ZM10.5 15H15V26C15 26.5522 14.5523 27 14 27H10.5V15ZM4 27H7.5V15H3V26C3 26.5522 3.44772 27 4 27Z" fill="currentColor"/></svg>',"small-down":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 10.667 16 21.334l8.667-10.667H7.334Z"/></svg>',"small-up":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 21.333 16 10.666l8.667 10.667H7.334Z"/></svg>',"pinned-top":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.53 3.72A.75.75 0 0 1 12 5H4a.75.75 0 0 1 0-1.5h8a.75.75 0 0 1 .53.22ZM3.269 10.744a.75.75 0 0 1 .2-.524l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 1 1-1.06 1.06L8.75 8.56V14a.75.75 0 0 1-1.5 0V8.56l-2.72 2.72a.75.75 0 0 1-1.26-.536Z"/></svg>',"pinned-bottom":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M3.47 12.28A.75.75 0 0 1 4 11h8a.75.75 0 0 1 0 1.5H4a.75.75 0 0 1-.53-.22ZM12.731 5.256a.75.75 0 0 1-.2.524l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 1 1 1.06-1.06l2.72 2.72V2a.75.75 0 0 1 1.5 0v5.44l2.72-2.72a.75.75 0 0 1 1.26.536Z"/></svg>',"un-pin":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M8 11a.75.75 0 0 0-.75.75v3.333a.75.75 0 1 0 1.5 0V11.75A.75.75 0 0 0 8 11Z"/><path fill="currentColor" d="M13.11 1.436a.75.75 0 0 0-1.22-.872l-10 14a.75.75 0 1 0 1.22.872L5.207 12.5h7.376a.75.75 0 0 0 .75-.75v-1.174a2.08 2.08 0 0 0-1.153-1.863l-1.185-.599-.005-.002a.58.58 0 0 1-.323-.522V5.165a2.083 2.083 0 0 0 1.854-2.904l.589-.825Zm-3.943 5.52v.634a2.08 2.08 0 0 0 1.153 1.863l1.185.6.005.002a.58.58 0 0 1 .323.522V11H6.28l2.887-4.044ZM9.277 1H5.25a2.084 2.084 0 0 0-.083 4.165v1.676l1.5-2.132v-.292a.75.75 0 0 0-.75-.75H5.25a.584.584 0 0 1 0-1.167h2.972L9.277 1Z"/></svg>',"chevron-down":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 6L8 10L4 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-up":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 10L8 6L12 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-left":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-right":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"filter-add":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.12126 7.75L10.8517 7.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M6.65934 11.748L9.32778 11.748" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M12.2943 1.04872V6.19184M14.9886 3.74341H9.68478" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M8.25488 3C8.04799 3.18323 7.91706 3.45099 7.91699 3.74902C7.91713 4.04868 8.04988 4.31681 8.25879 4.5H2C1.58579 4.5 1.25 4.16421 1.25 3.75C1.25 3.33579 1.58579 3 2 3H8.25488Z" fill="currentColor"/></svg>',edit:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 10.6262V12.5012H5.375L10.905 6.97122L9.03 5.09622L3.5 10.6262ZM12.355 5.52122C12.4014 5.47497 12.4381 5.42002 12.4632 5.35953C12.4883 5.29905 12.5012 5.23421 12.5012 5.16872C12.5012 5.10324 12.4883 5.0384 12.4632 4.97791C12.4381 4.91742 12.4014 4.86248 12.355 4.81622L11.185 3.64622C11.1387 3.59987 11.0838 3.5631 11.0233 3.53801C10.9628 3.51291 10.898 3.5 10.8325 3.5C10.767 3.5 10.7022 3.51291 10.6417 3.53801C10.5812 3.5631 10.5263 3.59987 10.48 3.64622L9.565 4.56122L11.44 6.43622L12.355 5.52122Z" fill="currentColor"/></svg>'},aW=(e={})=>{let t="";for(let i of[...Object.keys(lT),...Object.keys(cT)]){let s=lW(i,e.strokeWidth);t+=`.ag-icon-${i}::before { mask-image: url('data:image/svg+xml,${encodeURIComponent(s)}'); }
`}return t},lW=(e,t=1.5)=>{let i=cT[e];if(i)return i;let s=lT[e];if(!s)throw new Error(`Missing icon data for ${e}`);return`<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="black" stroke-width="${t}" viewBox="0 0 24 24"><style>* { vector-effect: non-scaling-stroke; }</style>`+s+"</svg>"},cW=(e={})=>on({feature:"iconSet",css:()=>aW(e)});var hW=cW();var uW=':where(.ag-input-field-input[type=number]:not(.ag-number-field-input-stepper)){-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}}.ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);color:var(--ag-input-text-color);font-family:inherit;font-size:inherit;line-height:inherit;margin:0;min-height:var(--ag-input-height);padding:0;&:where(:disabled){background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}&:where(:focus){background-color:var(--ag-input-focus-background-color);border:var(--ag-input-focus-border);box-shadow:var(--ag-input-focus-shadow);color:var(--ag-input-focus-text-color);outline:none}&:where(:invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&::-moz-placeholder{color:var(--ag-input-placeholder-text-color)}&::placeholder{color:var(--ag-input-placeholder-text-color)}}:where(.ag-ltr) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-left:var(--ag-input-padding-start)}:where(.ag-rtl) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-right:var(--ag-input-padding-start)}:where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{background-color:currentcolor;color:var(--ag-input-icon-color);content:"";display:block;height:12px;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;opacity:.5;position:absolute;width:12px}}:where(.ag-ltr) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-left:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-left:calc(var(--ag-spacing)*1.5 + 12px)}}:where(.ag-rtl) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select){.ag-input-wrapper:before{margin-right:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-right:calc(var(--ag-spacing)*1.5 + 12px)}}',dW=".ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){&:focus{box-shadow:var(--ag-focus-shadow);&:where(.invalid),&:where(:invalid){box-shadow:var(--ag-focus-error-shadow)}}}";var pW={inputBackgroundColor:"transparent",inputBorder:!1,inputBorderRadius:0,inputTextColor:{ref:"textColor"},inputPlaceholderTextColor:{ref:"inputTextColor",mix:.5},inputPaddingStart:0,inputHeight:{calc:"max(iconSize, fontSize) + spacing * 2"},inputFocusBackgroundColor:{ref:"inputBackgroundColor"},inputFocusBorder:{ref:"inputBorder"},inputFocusShadow:"none",inputFocusTextColor:{ref:"inputTextColor"},inputDisabledBackgroundColor:{ref:"inputBackgroundColor"},inputDisabledBorder:{ref:"inputBorder"},inputDisabledTextColor:{ref:"inputTextColor"},inputInvalidBackgroundColor:{ref:"inputBackgroundColor"},inputInvalidBorder:{ref:"inputBorder"},inputInvalidTextColor:{ref:"inputTextColor"},inputIconColor:{ref:"inputTextColor"},pickerButtonBorder:!1,pickerButtonFocusBorder:{ref:"inputFocusBorder"},pickerButtonBackgroundColor:{ref:"backgroundColor"},pickerButtonFocusBackgroundColor:{ref:"backgroundColor"},pickerListBorder:!1,pickerListBackgroundColor:{ref:"backgroundColor"},colorPickerThumbSize:18,colorPickerTrackSize:12,colorPickerThumbBorderWidth:3,colorPickerTrackBorderRadius:12,colorPickerColorBorderRadius:4};var gW=()=>on({feature:"inputStyle",params:ht(Se({},pW),{inputBackgroundColor:wo,inputBorder:!0,inputBorderRadius:{ref:"borderRadius"},inputPaddingStart:{ref:"spacing"},inputFocusBorder:{color:Xr},inputFocusShadow:{ref:"focusShadow"},inputDisabledBackgroundColor:en(.06),inputDisabledTextColor:{ref:"textColor",mix:.5},inputInvalidBorder:{color:{ref:"invalidColor"}},pickerButtonBorder:!0,pickerListBorder:!0}),css:()=>uW+dW}),fW=gW();var mW='.ag-tabs-header{background-color:var(--ag-tab-bar-background-color);border-bottom:var(--ag-tab-bar-border);display:flex;flex:1;gap:var(--ag-tab-spacing);padding:var(--ag-tab-bar-top-padding) var(--ag-tab-bar-horizontal-padding) 0}.ag-tabs-header-wrapper{display:flex}.ag-tabs-close-button-wrapper{align-items:center;border:0;display:flex;padding:var(--ag-spacing)}:where(.ag-ltr) .ag-tabs-close-button-wrapper{border-right:solid var(--ag-border-width) var(--ag-border-color)}:where(.ag-rtl) .ag-tabs-close-button-wrapper{border-left:solid var(--ag-border-width) var(--ag-border-color)}.ag-tabs-close-button{background-color:unset;border:0;cursor:pointer;padding:0}.ag-tab{align-items:center;background-color:var(--ag-tab-background-color);border-left:var(--ag-tab-selected-border-width) solid transparent;border-right:var(--ag-tab-selected-border-width) solid transparent;color:var(--ag-tab-text-color);cursor:pointer;display:flex;flex:1;justify-content:center;padding:var(--ag-tab-top-padding) var(--ag-tab-horizontal-padding) var(--ag-tab-bottom-padding);position:relative;&:hover{background-color:var(--ag-tab-hover-background-color);color:var(--ag-tab-hover-text-color)}&.ag-tab-selected{background-color:var(--ag-tab-selected-background-color);color:var(--ag-tab-selected-text-color)}&:after{background-color:var(--ag-tab-selected-underline-color);bottom:0;content:"";display:block;height:var(--ag-tab-selected-underline-width);left:0;opacity:0;position:absolute;right:0;transition:opacity var(--ag-tab-selected-underline-transition-duration)}&.ag-tab-selected:after{opacity:1}}:where(.ag-ltr) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-left-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-right-color:var(--ag-tab-selected-border-color)}}}:where(.ag-rtl) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-right-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-left-color:var(--ag-tab-selected-border-color)}}}';var vW={tabBarBackgroundColor:"transparent",tabBarHorizontalPadding:0,tabBarTopPadding:0,tabBackgroundColor:"transparent",tabTextColor:{ref:"textColor"},tabHorizontalPadding:{ref:"spacing"},tabTopPadding:{ref:"spacing"},tabBottomPadding:{ref:"spacing"},tabSpacing:"0",tabHoverBackgroundColor:{ref:"tabBackgroundColor"},tabHoverTextColor:{ref:"tabTextColor"},tabSelectedBackgroundColor:{ref:"tabBackgroundColor"},tabSelectedTextColor:{ref:"tabTextColor"},tabSelectedBorderWidth:{ref:"borderWidth"},tabSelectedBorderColor:"transparent",tabSelectedUnderlineColor:"transparent",tabSelectedUnderlineWidth:0,tabSelectedUnderlineTransitionDuration:0,tabBarBorder:!1};var yW=()=>on({feature:"tabStyle",params:ht(Se({},vW),{tabBarBorder:!0,tabBarBackgroundColor:Qo(.05),tabTextColor:{ref:"textColor",mix:.7},tabSelectedTextColor:{ref:"textColor"},tabHoverTextColor:{ref:"textColor"},tabSelectedBorderColor:{ref:"borderColor"},tabSelectedBackgroundColor:wo}),css:mW}),wW=yW();var CW=()=>J7().withPart(iW).withPart(rW).withPart(hW).withPart(wW).withPart(fW).withPart(sT).withParams({fontFamily:[{googleFont:"IBM Plex Sans"},"-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu"]}),Cb=CW();var bW={cssName:"--ag-cell-horizontal-padding",changeKey:"cellHorizontalPaddingChanged",defaultValue:16},xW={cssName:"--ag-indentation-level",changeKey:"indentationLevelChanged",defaultValue:0,noWarn:!0,cacheDefault:!0},_W={cssName:"--ag-row-group-indent-size",changeKey:"rowGroupIndentSizeChanged",defaultValue:0},FE={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},IE={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},kE={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},Jw={cssName:"--ag-row-border",changeKey:"rowBorderWidthChanged",defaultValue:1,border:!0},AE={cssName:"--ag-pinned-row-border",changeKey:"pinnedRowBorderWidthChanged",defaultValue:1,border:!0};function SW(e,t){t.sort((i,s)=>i.moduleName.localeCompare(s.moduleName)).forEach(i=>{let s=i.css;s&&e.set(`module-${i.moduleName}`,s)})}var RW=class extends L8{constructor(){super(...arguments),this.sizeEls=new Map,this.lastKnownValues=new Map,this.sizesMeasured=!1}initVariables(){this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.getSizeEl(FE),this.getSizeEl(IE),this.getSizeEl(kE),this.getSizeEl(Jw),this.getSizeEl(AE),this.refreshRowBorderWidthVariable()}getPinnedRowBorderWidth(){return this.getCSSVariablePixelValue(AE)}getRowBorderWidth(){return this.getCSSVariablePixelValue(Jw)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(FE)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(IE)}getDefaultCellHorizontalPadding(){return this.getCSSVariablePixelValue(bW)}getCellPaddingLeft(){let e=this.getDefaultCellHorizontalPadding(),t=this.getCSSVariablePixelValue(xW),i=this.getCSSVariablePixelValue(_W);return e-1+i*t}getCellPadding(){let e=this.getDefaultCellHorizontalPadding()-1;return this.getCellPaddingLeft()+e}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(kE)}refreshRowHeightVariable(){let{eRootDiv:e}=this,t=e.style.getPropertyValue("--ag-line-height").trim(),i=this.gos.get("rowHeight");if(i==null||isNaN(i)||!isFinite(i))return t!==null&&e.style.setProperty("--ag-line-height",null),-1;let s=`${i}px`;return t!=s?(e.style.setProperty("--ag-line-height",s),i):t!=""?parseFloat(t):-1}getCSSVariablePixelValue(e){let t=this.lastKnownValues.get(e);if(t!=null)return t;let i=this.measureSizeEl(e);return i==="detached"||i==="no-styles"?(e.cacheDefault&&this.lastKnownValues.set(e,e.defaultValue),e.defaultValue):(this.lastKnownValues.set(e,i),i)}measureSizeEl(e){let t=this.getSizeEl(e);if(t.offsetParent==null)return"detached";let i=t.offsetWidth;return i===eC?"no-styles":(this.sizesMeasured=!0,i)}getMeasurementContainer(){let e=this.eMeasurementContainer;return e||(e=this.eMeasurementContainer=rs({tag:"div",cls:"ag-measurement-container"}),this.eRootDiv.appendChild(e)),e}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;let i=this.getMeasurementContainer();t=rs({tag:"div"});let{border:s,noWarn:n}=e;s?(t.className="ag-measurement-element-border",t.style.setProperty("--ag-internal-measurement-border",`var(${e.cssName}, solid ${eC}px)`)):t.style.width=`var(${e.cssName}, ${eC}px)`,i.appendChild(t),this.sizeEls.set(e,t);let o=this.measureSizeEl(e);o==="no-styles"&&!n&&je(9,{variable:e});let l=nl(this.beans,t,()=>{let d=this.measureSizeEl(e);d==="detached"||d==="no-styles"||(this.lastKnownValues.set(e,d),d!==o&&(o=d,this.fireStylesChangedEvent(e.changeKey)))});return this.addDestroyFunc(()=>l()),t}fireStylesChangedEvent(e){e==="rowBorderWidthChanged"&&this.refreshRowBorderWidthVariable(),this.eventSvc.dispatchEvent({type:"gridStylesChanged",[e]:!0})}refreshRowBorderWidthVariable(){let e=this.getCSSVariablePixelValue(Jw);this.eRootDiv.style.setProperty("--ag-internal-row-border-width",`${e}px`)}postProcessThemeChange(e,t){e&&getComputedStyle(this.getMeasurementContainer()).getPropertyValue("--ag-legacy-styles-loaded")&&li(t?106:239)}getAdditionalCss(){let e=new Map;return e.set("core",[H7]),SW(e,Array.from(z7())),e}getDefaultTheme(){return Cb}themeError(e){li(240,{theme:e})}},eC=15538,EW=class extends z8{postConstruct(){let{globalListener:e,globalSyncListener:t}=this.beans;e&&this.addGlobalListener(e,!0),t&&this.addGlobalListener(t,!1)}};function hT(e,t,i){let s=e.visibleCols.headerGroupRowCount;if(i>=s)return{column:t,headerRowIndex:i};let n=t.getParent();for(;n&&n.getProvidedColumnGroup().getLevel()>i;)n=n.getParent();let o=t.isSpanHeaderHeight();return!n||o&&n.isPadding()?{column:t,headerRowIndex:s}:{column:n,headerRowIndex:n.getProvidedColumnGroup().getLevel()}}var PW=class extends Be{constructor(){super(...arguments),this.beanName="headerNavigation",this.currentHeaderRowWithoutSpan=-1}postConstruct(){let e=this.beans;e.ctrlsSvc.whenReady(this,i=>{this.gridBodyCon=i.gridBodyCtrl});let t=Vs(e);this.addManagedElementListeners(t,{mousedown:()=>{this.currentHeaderRowWithoutSpan=-1}})}getHeaderPositionForColumn(e,t){let i,{colModel:s,colGroupSvc:n,ctrlsSvc:o}=this.beans;if(typeof e=="string"?(i=s.getCol(e),i||(i=n?.getColumnGroup(e)??null)):i=e,!i)return null;let d=o.getHeaderRowContainerCtrl()?.getAllCtrls(),p=di(d||[]).type==="filter",y=ar(this.beans)-1,C=-1,S=i;for(;S;)C++,S=S.getParent();let P=C;return t&&p&&P===y-1&&P++,P===-1?null:{headerRowIndex:P,column:i}}navigateVertically(e,t){let{focusSvc:i,visibleCols:s}=this.beans,{focusedHeader:n}=i;if(!n)return!1;let{headerRowIndex:o}=n,l=n.column,d=ar(this.beans),p=this.getHeaderRowType(o),y=s.headerGroupRowCount,{headerRowIndex:C,column:S,headerRowIndexWithoutSpan:P}=e==="UP"?MW(p,l,o):TW(l,o,y),I=!1;return C<0&&(C=0,S=l,I=!0),C>=d?(C=-1,this.currentHeaderRowWithoutSpan=-1):P!==void 0&&(this.currentHeaderRowWithoutSpan=P),!I&&!S?!1:i.focusHeaderPosition({headerPosition:{headerRowIndex:C,column:S},allowUserOverride:!0,event:t})}navigateHorizontally(e,t=!1,i){let{focusSvc:s,gos:n}=this.beans,o=Se({},s.focusedHeader),l,d;this.currentHeaderRowWithoutSpan!==-1?o.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=o.headerRowIndex,e==="LEFT"!==n.get("enableRtl")?(d="Before",l=this.findHeader(o,d)):(d="After",l=this.findHeader(o,d));let p=n.getCallback("tabToNextHeader");if(t&&p){let y=s.focusHeaderPositionFromUserFunc({userFunc:p,headerPosition:l,direction:d});if(y){let{headerRowIndex:C}=s.focusedHeader||{};C!=null&&C!=o.headerRowIndex&&(this.currentHeaderRowWithoutSpan=C)}return y}return l||!t?s.focusHeaderPosition({headerPosition:l,direction:d,fromTab:t,allowUserOverride:!0,event:i}):this.focusNextHeaderRow(o,d,i)}focusNextHeaderRow(e,t,i){let s=this.beans,n=e.headerRowIndex,o=null,l,d=ar(s),p=this.beans.visibleCols.allCols;if(t==="Before"){if(n<=0)return!1;o=di(p),l=n-1,this.currentHeaderRowWithoutSpan-=1}else o=p[0],l=n+1,this.currentHeaderRowWithoutSpan<d?this.currentHeaderRowWithoutSpan+=1:this.currentHeaderRowWithoutSpan=-1;let{column:y,headerRowIndex:C}=hT(this.beans,o,l);return C>=d&&(C=-1),s.focusSvc.focusHeaderPosition({headerPosition:{column:y,headerRowIndex:C},direction:t,fromTab:!0,allowUserOverride:!0,event:i})}scrollToColumn(e,t="After"){if(e.getPinned())return;let i;if(ns(e)){let s=e.getDisplayedLeafColumns();i=t==="Before"?di(s):s[0]}else i=e;this.gridBodyCon.scrollFeature.ensureColumnVisible(i)}findHeader(e,t){let{colGroupSvc:i,visibleCols:s}=this.beans,n=e.column;if(n instanceof Jp){let p=n.getDisplayedLeafColumns();n=t==="Before"?p[0]:p[p.length-1]}let o=t==="Before"?s.getColBefore(n):s.getColAfter(n);if(!o)return;let l=s.headerGroupRowCount;if(e.headerRowIndex>=l)return{headerRowIndex:e.headerRowIndex,column:o};let d=i?.getColGroupAtLevel(o,e.headerRowIndex);return d?d.isPadding()&&o.isSpanHeaderHeight()?{headerRowIndex:s.headerGroupRowCount,column:o}:{headerRowIndex:e.headerRowIndex,column:d??o}:{headerRowIndex:o instanceof wc&&o.isSpanHeaderHeight()?s.headerGroupRowCount:e.headerRowIndex,column:o}}getHeaderRowType(e){let t=this.beans.ctrlsSvc.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}};function MW(e,t,i){let s=i-1;if(e!=="filter"){let n=t instanceof wc&&t.isSpanHeaderHeight(),o=t.getParent();for(;o&&(o.getProvidedColumnGroup().getLevel()>s||n&&o.isPadding());)o=o.getParent();if(o)return n?{column:o,headerRowIndex:o.getProvidedColumnGroup().getLevel(),headerRowIndexWithoutSpan:s}:{column:o,headerRowIndex:s,headerRowIndexWithoutSpan:s}}return{column:t,headerRowIndex:s,headerRowIndexWithoutSpan:s}}function TW(e,t,i){let s=t+1,n={column:e,headerRowIndex:s,headerRowIndexWithoutSpan:s};if(e instanceof Jp){if(s>=i)return{column:e.getDisplayedLeafColumns()[0],headerRowIndex:i,headerRowIndexWithoutSpan:s};let l=e.getDisplayedChildren()[0];if(l instanceof Jp&&l.isPadding()){let p=l.getDisplayedLeafColumns()[0];p.isSpanHeaderHeight()&&(l=p)}n.column=l,l instanceof wc&&l.isSpanHeaderHeight()&&(n.headerRowIndex=i,n.headerRowIndexWithoutSpan=s)}return n}var DW=class extends Be{constructor(){super(...arguments),this.beanName="focusSvc",this.focusFallbackTimeout=null,this.needsFocusRestored=!1}wireBeans(e){this.colModel=e.colModel,this.visibleCols=e.visibleCols,this.rowRenderer=e.rowRenderer,this.navigation=e.navigation,this.filterManager=e.filterManager,this.overlays=e.overlays}postConstruct(){let e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.addDestroyFunc(G5(this.beans))}attemptToRecoverFocus(){this.needsFocusRestored=!0,this.focusFallbackTimeout!=null&&clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=window.setTimeout(this.setFocusRecovered.bind(this),100)}setFocusRecovered(){this.needsFocusRestored=!1,this.focusFallbackTimeout!=null&&(clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=null)}shouldTakeFocus(){return this.gos.get("suppressFocusAfterRefresh")?(this.setFocusRecovered(),!1):this.needsFocusRestored?(this.setFocusRecovered(),!0):this.doesRowOrCellHaveBrowserFocus()}onColumnEverythingChanged(){if(!this.focusedCell)return;let e=this.focusedCell.column,t=this.colModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}getFocusCellToUseAfterRefresh(){let{gos:e,focusedCell:t}=this;return e.get("suppressFocusAfterRefresh")||e.get("suppressCellFocus")||!t||!this.doesRowOrCellHaveBrowserFocus()?null:t}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeader||!this.isDomDataPresentInHierarchy(zi(this.beans),zM)?null:this.focusedHeader}doesRowOrCellHaveBrowserFocus(){let e=zi(this.beans);return this.isDomDataPresentInHierarchy(e,hv)?!0:this.isDomDataPresentInHierarchy(e,uv)}isDomDataPresentInHierarchy(e,t){let i=e;for(;i;){if(EP(this.gos,i,t))return!0;i=i.parentNode}return!1}getFocusedCell(){return this.focusedCell}getFocusEventParams(e){let{rowIndex:t,rowPinned:i,column:s}=e,n={rowIndex:t,rowPinned:i,column:s,isFullWidthCell:!1},o=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:i});return o&&(n.isFullWidthCell=o.isFullWidth()),n}clearFocusedCell(){if(this.focusedCell==null)return;let e=this.getFocusEventParams(this.focusedCell);this.focusedCell=null,this.eventSvc.dispatchEvent(Se({type:"cellFocusCleared"},e))}setFocusedCell(e){this.setFocusRecovered();let{column:t,rowIndex:i,rowPinned:s,forceBrowserFocus:n=!1,preventScrollOnBrowserFocus:o=!1,sourceEvent:l}=e,d=this.colModel.getCol(t);if(!d){this.focusedCell=null;return}this.focusedCell={rowIndex:i,rowPinned:Qr(s),column:d};let p=this.getFocusEventParams(this.focusedCell);this.eventSvc.dispatchEvent(ht(Se(Se({type:"cellFocused"},p),this.previousCellFocusParams&&{previousParams:this.previousCellFocusParams}),{forceBrowserFocus:n,preventScrollOnBrowserFocus:o,sourceEvent:l})),this.previousCellFocusParams=p}isCellFocused(e){return this.focusedCell==null?!1:UM(e,this.focusedCell)}isHeaderWrapperFocused(e){if(this.focusedHeader==null)return!1;let{column:t,rowCtrl:{rowIndex:i,pinned:s}}=e,{column:n,headerRowIndex:o}=this.focusedHeader;return t===n&&i===o&&s==n.getPinned()}focusHeaderPosition(e){if(this.setFocusRecovered(),hc(this.beans))return!1;let{direction:t,fromTab:i,allowUserOverride:s,event:n,fromCell:o,rowWithoutSpanValue:l}=e,{headerPosition:d}=e;if(o&&this.filterManager?.isAdvFilterHeaderActive())return this.focusAdvancedFilter(d);if(s){let p=this.focusedHeader,y=ar(this.beans);if(i){let C=this.gos.getCallback("tabToNextHeader");C&&(d=this.getHeaderPositionFromUserFunc({userFunc:C,direction:t,currentPosition:p,headerPosition:d,headerRowCount:y}))}else{let C=this.gos.getCallback("navigateToNextHeader");if(C&&n){let S={key:n.key,previousHeaderPosition:p,nextHeaderPosition:d,headerRowCount:y,event:n};d=C(S)}}}return d?this.focusProvidedHeaderPosition({headerPosition:d,direction:t,event:n,fromCell:o,rowWithoutSpanValue:l}):!1}focusHeaderPositionFromUserFunc(e){if(hc(this.beans))return!1;let{userFunc:t,headerPosition:i,direction:s,event:n}=e,o=this.focusedHeader,l=ar(this.beans),d=this.getHeaderPositionFromUserFunc({userFunc:t,direction:s,currentPosition:o,headerPosition:i,headerRowCount:l});return!!d&&this.focusProvidedHeaderPosition({headerPosition:d,direction:s,event:n})}getHeaderPositionFromUserFunc(e){let{userFunc:t,direction:i,currentPosition:s,headerPosition:n,headerRowCount:o}=e,d=t({backwards:i==="Before",previousHeaderPosition:s,nextHeaderPosition:n,headerRowCount:o});return d===!0?s:d===!1?null:d}focusProvidedHeaderPosition(e){let{headerPosition:t,direction:i,fromCell:s,rowWithoutSpanValue:n,event:o}=e,{column:l,headerRowIndex:d}=t,{filterManager:p,ctrlsSvc:y,headerNavigation:C}=this.beans;if(d===-1)return p?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView({column:l,event:o});C?.scrollToColumn(l,i);let P=y.getHeaderRowContainerCtrl(l.getPinned())?.focusHeader(t.headerRowIndex,l,o)||!1;return C&&P&&(n!=null||s)&&(C.currentHeaderRowWithoutSpan=n??-1),P}focusFirstHeader(){if(this.overlays?.isExclusive()&&this.focusOverlay())return!0;let e=this.visibleCols.allCols[0];if(!e)return!1;let t=hT(this.beans,e,0);return this.focusHeaderPosition({headerPosition:t,rowWithoutSpanValue:0})}focusLastHeader(e){if(this.overlays?.isExclusive()&&this.focusOverlay(!0))return!0;let t=ar(this.beans)-1,i=di(this.visibleCols.allCols);return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:i},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){return this.filterManager?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCell}isRowFocused(e,t){return this.focusedCell==null?!1:this.focusedCell.rowIndex===e&&this.focusedCell.rowPinned===Qr(t)}focusOverlay(e){let t=this.overlays?.isVisible()&&this.overlays.eWrapper?.getGui();return!!t&&gc(t,e)}focusGridView(e){let{backwards:t=!1,canFocusOverlay:i=!0,event:s}=e;if(this.overlays?.isExclusive())return i&&this.focusOverlay(t);if(_v(this.beans))return t&&!hc(this.beans)?this.focusLastHeader():i&&this.focusOverlay(t)?!0:t?!1:Du(this.beans,t);let n=t?BN(this.beans):zN(this.beans);if(n){let o=e.column??this.focusedHeader?.column,{rowIndex:l,rowPinned:d}=n,p=ia(this.beans,n);if(!o||!p||l==null)return!1;if(o.isSuppressNavigable(p)){let y=this.gos.get("enableRtl"),C;return!s||s.key===Fe.TAB?C=y?Fe.LEFT:Fe.RIGHT:C=s.key,this.beans.navigation?.navigateToNextCell(null,C,{rowIndex:l,column:o,rowPinned:d||null},!0),!0}return this.navigation?.ensureCellVisible({rowIndex:l,column:o,rowPinned:d}),t&&this.rowRenderer.getRowByPosition(n)?.isFullWidth()&&this.navigation?.tryToFocusFullWidthRow(n,t)||(this.setFocusedCell({rowIndex:l,column:o,rowPinned:Qr(d),forceBrowserFocus:!0}),this.beans.rangeSvc?.setRangeToCell({rowIndex:l,rowPinned:d,column:o})),!0}return!!(i&&this.focusOverlay(t)||t&&this.focusLastHeader())}focusAdvancedFilter(e){return this.advFilterFocusColumn=e?.column,this.beans.advancedFilter?.getCtrl().focusHeaderComp()??!1}focusNextFromAdvancedFilter(e,t){let i=(t?void 0:this.advFilterFocusColumn)??this.visibleCols.allCols?.[0];return e?this.focusHeaderPosition({headerPosition:{column:i,headerRowIndex:ar(this.beans)-1}}):this.focusGridView({column:i})}clearAdvancedFilterColumn(){this.advFilterFocusColumn=void 0}},FW=class extends Be{constructor(){super(...arguments),this.beanName="scrollVisibleSvc"}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colAnimation=e.colAnimation}postConstruct(){this.horizontalScrollShowing=this.gos.get("alwaysShowHorizontalScroll")===!0,this.verticalScrollShowing=this.gos.get("alwaysShowVerticalScroll")===!0,this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.updateScrollVisible.bind(this),displayedColumnsWidthChanged:this.updateScrollVisible.bind(this)})}updateScrollVisible(){let{colAnimation:e}=this;e?.isActive()?e.executeLaterVMTurn(()=>{e.executeLaterVMTurn(()=>this.updateScrollVisibleImpl())}):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){let e=this.ctrlsSvc.get("center");if(!e||this.colAnimation?.isActive())return;let t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.verticalScrollShowing};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){let e=this.ctrlsSvc.get("center"),t=e.hasHorizontalScrollGap(),i=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==i)&&(this.horizontalScrollGap=t,this.verticalScrollGap=i,this.eventSvc.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventSvc.dispatchEvent({type:"scrollVisibilityChanged"}))}getScrollbarWidth(){if(this.scrollbarWidth==null){let e=this.gos.get("scrollbarWidth"),i=typeof e=="number"&&e>=0?e:L5();i!=null&&(this.scrollbarWidth=i,this.eventSvc.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},IW=class extends Be{constructor(){super(...arguments),this.beanName="gridDestroySvc",this.destroyCalled=!1}destroy(){if(this.destroyCalled)return;let{stateSvc:e,ctrlsSvc:t,context:i}=this.beans;this.eventSvc.dispatchEvent({type:"gridPreDestroyed",state:e?.getState()??{}}),this.destroyCalled=!0,t.get("gridCtrl")?.destroyGridUi(),i.destroy(),super.destroy()}},Zm=new Set(["gridPreDestroyed","fillStart","pasteStart"]),kW=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","pinnedRowsChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterUiChanged","filterOpened","floatingFilterUiChanged","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel","findChanged","rowResizeStarted","rowResizeEnded","columnsReset","bulkEditingStarted","bulkEditingStopped","batchEditingStarted","batchEditingStopped"];var bb=kW.reduce((e,t)=>(e[t]=PB(t),e),{}),Fp=(e,t)=>({tag:"span",ref:`eSort${e}`,cls:`ag-sort-indicator-icon ag-sort-${t} ag-hidden`,attrs:{"aria-hidden":"true"}}),AW={tag:"span",cls:"ag-sort-indicator-container",children:[Fp("Order","order"),Fp("Asc","ascending-icon"),Fp("Desc","descending-icon"),Fp("Mixed","mixed-icon"),Fp("None","none-icon")]},xb=class extends ii{constructor(e){super(),this.eSortOrder=ot,this.eSortAsc=ot,this.eSortDesc=ot,this.eSortMixed=ot,this.eSortNone=ot,e||this.setTemplate(AW)}attachCustomElements(e,t,i,s,n){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=i,this.eSortMixed=s,this.eSortNone=n}setupSort(e,t=!1){if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!e.isSortable()&&!e.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e);let i=this.updateIcons.bind(this),s=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",i),this.addManagedEventListeners({newColumnsLoaded:i,sortChanged:s,columnRowGroupChanged:s}),this.onSortChanged()}addInIcon(e,t,i){if(t==null)return;let s=tn(e,this.beans,i);s&&t.appendChild(s)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){let{eSortAsc:e,eSortDesc:t,eSortNone:i,column:s,gos:n,beans:o}=this,l=o.sortSvc.getDisplaySortForColumn(s);if(e&&Ti(e,l==="asc",{skipAriaHidden:!0}),t&&Ti(t,l==="desc",{skipAriaHidden:!0}),i){let d=!s.getColDef().unSortIcon&&!n.get("unSortIcon"),p=l==null;Ti(i,!d&&p,{skipAriaHidden:!0})}}setupMultiSortIndicator(){let{eSortMixed:e,column:t,gos:i}=this;this.addInIcon("sortUnSort",e,t);let s=t.getColDef().showRowGroup;nr(i)&&s&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){let{eSortMixed:e,beans:t,column:i}=this;if(e){let s=t.sortSvc.getDisplaySortForColumn(i)==="mixed";Ti(e,s,{skipAriaHidden:!0})}}updateSortOrder(){let{eSortOrder:e,column:t,beans:{sortSvc:i}}=this;if(!e)return;let s=i.getColumnsWithSortingOrdered(),n=i.getDisplaySortIndexForColumn(t)??-1,o=s.some(d=>i.getDisplaySortIndexForColumn(d)??!1),l=n>=0&&o;Ti(e,l,{skipAriaHidden:!0}),n>=0?e.textContent=(n+1).toString():Ns(e)}},LW={selector:"AG-SORT-INDICATOR",component:xb},ig=["asc","desc",null],OW=class extends Be{constructor(){super(...arguments),this.beanName="sortSvc"}progressSort(e,t,i){let s=this.getNextSortDirection(e);this.setSortForColumn(e,s,t,i)}progressSortFromEvent(e,t){let s=this.gos.get("multiSortKey")==="ctrl"?t.ctrlKey||t.metaKey:t.shiftKey;this.progressSort(e,s,"uiColumnSorted")}setSortForColumn(e,t,i,s){t!=="asc"&&t!=="desc"&&(t=null);let{gos:n,showRowGroupCols:o}=this.beans,l=nr(n),d=[e];if(l&&e.getColDef().showRowGroup){let S=o?.getSourceColumnsForGroupColumn?.(e)?.filter(P=>P.isSortable());S&&(d=[e,...S])}d.forEach(C=>this.setColSort(C,t,s));let p=(i||n.get("alwaysMultiSort"))&&!n.get("suppressMultiSort"),y=[];if(!p){let C=this.clearSortBarTheseColumns(d,s);y.push(...C)}this.updateSortIndex(e),y.push(...d),this.dispatchSortChangedEvents(s,y)}updateSortIndex(e){let{gos:t,colModel:i,showRowGroupCols:s}=this.beans,n=nr(t),o=s?.getShowRowGroupCol(e.getId()),l=n&&o||e,d=this.getColumnsWithSortingOrdered();i.forAllCols(C=>this.setColSortIndex(C,null));let p=d.filter(C=>n&&C.getColDef().showRowGroup?!1:C!==l);(l.getSort()?[...p,l]:p).forEach((C,S)=>this.setColSortIndex(C,S))}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){let e=!1;return this.beans.colModel.forAllCols(t=>{t.getSort()&&(e=!0)}),e}dispatchSortChangedEvents(e,t){let i={type:"sortChanged",source:e};t&&(i.columns=t),this.eventSvc.dispatchEvent(i)}clearSortBarTheseColumns(e,t){let i=[];return this.beans.colModel.forAllCols(s=>{e.includes(s)||(s.getSort()&&i.push(s),this.setColSort(s,void 0,t))}),i}getNextSortDirection(e){let t=e.getColDef().sortingOrder??this.gos.get("sortingOrder")??ig,i=t.indexOf(e.getSort()),s=i<0,n=i==t.length-1;return s||n?t[0]:t[i+1]}getIndexedSortMap(){let{gos:e,colModel:t,showRowGroupCols:i,rowGroupColsSvc:s}=this.beans,n=[];if(t.forAllCols(y=>{y.getSort()&&n.push(y)}),t.isPivotMode()){let y=nr(e);n=n.filter(C=>{let S=!!C.getAggFunc(),P=!C.isPrimary(),I=y?i?.getShowRowGroupCol(C.getId()):C.getColDef().showRowGroup;return S||P||I})}let o=s?.columns.filter(y=>!!y.getSort())??[],l={};n.forEach((y,C)=>l[y.getId()]=C),n.sort((y,C)=>{let S=y.getSortIndex(),P=C.getSortIndex();if(S!=null&&P!=null)return S-P;if(S==null&&P==null){let I=l[y.getId()],O=l[C.getId()];return I>O?1:-1}else return P==null?-1:1});let d=nr(e)&&!!o.length;d&&(n=[...new Set(n.map(y=>i?.getShowRowGroupCol(y.getId())??y))]);let p=new Map;return n.forEach((y,C)=>p.set(y,C)),d&&o.forEach(y=>{let C=i.getShowRowGroupCol(y.getId());p.set(y,p.get(C))}),p}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([,e],[,t])=>e-t).map(([e])=>e)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),colId:e.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(e=>e.getSort()).map(e=>({sort:e.getSort(),column:e}))}canColumnDisplayMixedSort(e){let t=nr(this.gos),i=!!e.getColDef().showRowGroup;return t&&i}getDisplaySortForColumn(e){let t=this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!t?.length)return e.getSort();let s=e.getColDef().field!=null||!!e.getColDef().valueGetter?[e,...t]:t,n=s[0].getSort();return s.every(l=>l.getSort()==n)?n:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}setupHeader(e,t,i){let s=0;e.addManagedListeners(t,{movingChanged:()=>{s=Date.now()}}),i&&e.addManagedElementListeners(i,{click:o=>{let l=t.isMoving(),p=Date.now()-s<50;l||p||this.progressSortFromEvent(t,o)}});let n=()=>{let o=t.getSort();if(e.toggleCss("ag-header-cell-sorted-asc",o==="asc"),e.toggleCss("ag-header-cell-sorted-desc",o==="desc"),e.toggleCss("ag-header-cell-sorted-none",!o),t.getColDef().showRowGroup){let p=!this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(t)?.every(y=>t.getSort()==y.getSort());e.toggleCss("ag-header-cell-sorted-mixed",p)}};e.addManagedEventListeners({sortChanged:n,columnRowGroupChanged:n})}initCol(e){let{sort:t,initialSort:i,sortIndex:s,initialSortIndex:n}=e.colDef;t!==void 0?(t==="asc"||t==="desc")&&(e.sort=t):(i==="asc"||i==="desc")&&(e.sort=i),s!==void 0?s!==null&&(e.sortIndex=s):n!==null&&(e.sortIndex=n)}updateColSort(e,t,i){t!==void 0&&(t==="desc"||t==="asc"?this.setColSort(e,t,i):this.setColSort(e,void 0,i))}setColSort(e,t,i){e.sort!==t&&(e.sort=t,e.dispatchColEvent("sortChanged",i)),e.dispatchStateUpdatedEvent("sort")}setColSortIndex(e,t){e.sortIndex=t,e.dispatchStateUpdatedEvent("sortIndex")}createSortIndicator(e){return new xb(e)}getSortIndicatorSelector(){return LW}},_u={agSetColumnFilter:"SetFilter",agSetColumnFloatingFilter:"SetFilter",agMultiColumnFilter:"MultiFilter",agMultiColumnFloatingFilter:"MultiFilter",agGroupColumnFilter:"GroupFilter",agGroupColumnFloatingFilter:"GroupFilter",agGroupCellRenderer:"GroupCellRenderer",agGroupRowRenderer:"GroupCellRenderer",agRichSelect:"RichSelect",agRichSelectCellEditor:"RichSelect",agDetailCellRenderer:"SharedMasterDetail",agSparklineCellRenderer:"Sparklines",agDragAndDropImage:"SharedDragAndDrop",agColumnHeader:"ColumnHeaderComp",agColumnGroupHeader:"ColumnGroupHeaderComp",agSortIndicator:"Sort",agAnimateShowChangeCellRenderer:"HighlightChanges",agAnimateSlideCellRenderer:"HighlightChanges",agLoadingCellRenderer:"LoadingCellRenderer",agSkeletonCellRenderer:"SkeletonCellRenderer",agCheckboxCellRenderer:"CheckboxCellRenderer",agLoadingOverlay:"Overlay",agNoRowsOverlay:"Overlay",agTooltipComponent:"Tooltip",agReadOnlyFloatingFilter:"CustomFilter",agTextColumnFilter:"TextFilter",agNumberColumnFilter:"NumberFilter",agDateColumnFilter:"DateFilter",agDateInput:"DateFilter",agTextColumnFloatingFilter:"TextFilter",agNumberColumnFloatingFilter:"NumberFilter",agDateColumnFloatingFilter:"DateFilter",agCellEditor:"TextEditor",agSelectCellEditor:"SelectEditor",agTextCellEditor:"TextEditor",agNumberCellEditor:"NumberEditor",agDateCellEditor:"DateEditor",agDateStringCellEditor:"DateEditor",agCheckboxCellEditor:"CheckboxEditor",agLargeTextCellEditor:"LargeTextEditor",agMenuItem:"MenuItem",agColumnsToolPanel:"ColumnsToolPanel",agFiltersToolPanel:"FiltersToolPanel",agNewFiltersToolPanel:"NewFiltersToolPanel",agAggregationComponent:"StatusBar",agSelectedRowCountComponent:"StatusBar",agTotalRowCountComponent:"StatusBar",agFilteredRowCountComponent:"StatusBar",agTotalAndFilteredRowCountComponent:"StatusBar",agFindCellRenderer:"Find"},zW=()=>({checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."}}),BW={aggFunc:"SharedAggregation",autoHeight:"RowAutoHeight",cellClass:"CellStyle",cellClassRules:"CellStyle",cellEditor:({cellEditor:e,editable:t})=>t?typeof e=="string"?_u[e]??"CustomEditor":"CustomEditor":null,cellRenderer:({cellRenderer:e})=>typeof e!="string"?null:_u[e],cellStyle:"CellStyle",columnChooserParams:"ColumnMenu",contextMenuItems:"ContextMenu",dndSource:"DragAndDrop",dndSourceOnRowDrag:"DragAndDrop",editable:({editable:e,cellEditor:t})=>e&&!t?"TextEditor":null,enableCellChangeFlash:"HighlightChanges",enablePivot:"SharedPivot",enableRowGroup:"SharedRowGrouping",enableValue:"SharedAggregation",filter:({filter:e})=>e&&typeof e!="string"&&typeof e!="boolean"?"CustomFilter":typeof e=="string"?_u[e]??"ColumnFilter":"ColumnFilter",floatingFilter:"ColumnFilter",getQuickFilterText:"QuickFilter",headerTooltip:"Tooltip",mainMenuItems:"ColumnMenu",menuTabs:e=>{let t=["columnsMenuTab","generalMenuTab"];return e.menuTabs?.some(i=>t.includes(i))?"ColumnMenu":null},pivot:"SharedPivot",pivotIndex:"SharedPivot",rowDrag:"RowDrag",rowGroup:"SharedRowGrouping",rowGroupIndex:"SharedRowGrouping",tooltipField:"Tooltip",tooltipValueGetter:"Tooltip",spanRows:"CellSpan",rowGroupingHierarchy:"SharedRowGrouping"},VW=()=>({autoHeight:{supportedRowModels:["clientSide","serverSide"],validate:(t,{paginationAutoPageSize:i})=>i?"colDef.autoHeight is not supported with paginationAutoPageSize.":null},cellRendererParams:{validate:t=>(t.rowGroup!=null||t.rowGroupIndex!=null||t.cellRenderer==="agGroupCellRenderer")&&"checkbox"in t.cellRendererParams?'Since v33.0, `cellRendererParams.checkbox` has been deprecated. Use `rowSelection.checkboxLocation = "autoGroupColumn"` instead.':null},flex:{validate:(t,i)=>i.autoSizeStrategy?"colDef.flex is not supported with gridOptions.autoSizeStrategy":null},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:i})=>i==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerValueGetter:{validate:t=>{let i=t.headerValueGetter;return typeof i=="function"||typeof i=="string"?null:"headerValueGetter must be a function or a valid string expression"}},icons:{validate:({icons:t})=>{if(t){if(t.smallDown)return cr(262);if(t.smallLeft)return cr(263);if(t.smallRight)return cr(264)}return null}},sortingOrder:{validate:t=>{let i=t.sortingOrder;if(Array.isArray(i)&&i.length>0){let s=i.filter(n=>!ig.includes(n));if(s.length>0)return`sortingOrder must be an array with elements from [${ig.map(tv).join()}], currently it includes [${s.map(tv).join()}]`}else if(!Array.isArray(i)||i.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${i}`;return null}},type:{validate:t=>{let i=t.type;return i instanceof Array?i.some(n=>typeof n!="string")?"if colDef.type is supplied an array it should be of type 'string[]'":null:typeof i=="string"?null:"colDef.type should be of type 'string' | 'string[]'"}},rowSpan:{validate:(t,{suppressRowTransform:i})=>i?null:"colDef.rowSpan requires suppressRowTransform to be enabled."},spanRows:{dependencies:{editable:{required:[!1,void 0]},rowDrag:{required:[!1,void 0]},colSpan:{required:[void 0]},rowSpan:{required:[void 0]}},validate:(t,{rowSelection:i,cellSelection:s,suppressRowTransform:n,enableCellSpan:o,rowDragEntireRow:l,enableCellTextSelection:d})=>typeof i=="object"&&i?.mode==="singleRow"&&i?.enableClickSelection?"colDef.spanRows is not supported with rowSelection.clickSelection":s?"colDef.spanRows is not supported with cellSelection.":n?"colDef.spanRows is not supported with suppressRowTransform.":o?l?"colDef.spanRows is not supported with rowDragEntireRow.":d?"colDef.spanRows is not supported with enableCellTextSelection.":null:"colDef.spanRows requires enableCellSpan to be enabled."},rowGroupingHierarchy:{validate(t,{groupHierarchyConfig:i={}},s){let n=new Set(["year","quarter","month","formattedMonth","day","hour","minute","second"]),o=[];if(t.rowGroupingHierarchy?.forEach(l=>{if(typeof l=="object")return s.validation?.validateColDef(l),null;!n.has(l)&&!(l in i)&&o.push(l)}),o.length>0){let l=`The following parts of colDef.rowGroupingHierarchy are not recognised: ${o.map(p=>`"${p}"`).join(", ")}.`,d=`Choose one of ${[...n].map(p=>`"${p}"`).join(", ")}, or define your own parts in gridOptions.groupHierarchyConfig.`;return`${l}
${d}`}return null}}}),HW={headerName:void 0,columnGroupShow:void 0,headerStyle:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,spanRows:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0,dateComponent:void 0,dateComponentParams:void 0,getFindText:void 0,rowGroupingHierarchy:void 0},NW=()=>Object.keys(HW),GW=()=>({objectName:"colDef",allProperties:NW(),docsUrl:"column-properties/",deprecations:zW(),validations:VW()}),WW=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","treeDataChildrenField","treeDataParentIdField","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","invalidEditValueMode","grandTotalRow","themeCssLayer","findSearchValue","styleNonce","renderingMode"],UW=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","themeStyleContainer","statusBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterParent","advancedFilterBuilderParams","advancedFilterParams","initialState","autoSizeStrategy","selectionColumnDef","findOptions","filterHandlers","groupHierarchyConfig"],jW=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"],uT=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns","rowDragInsertDelay"],$W=["theme","rowSelection"],_b=["cellSelection","sideBar","rowNumbers","suppressGroupChangesColumnVisibility","groupAggFiltering","suppressStickyTotalRow","groupHideParentOfSingleChild","enableRowPinning"],dT=["loadThemeGoogleFonts","suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","allowContextMenuWithControlKey","suppressContextMenu","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","enableCellSpan","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault","enableFilterHandlers","suppressStartEditOnTab","hidePaddedHeaderRows","ssrmExpandAllAffectsAllRows"],qW=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getFullRowEditValidationErrors","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","chartMenuItems","groupTotalRow","alwaysPassFilter","isRowPinnable","isRowPinned","isRowValidDropPosition"],ZW=()=>[...jW,...UW,...WW,...uT,...qW,...dT,..._b,...$W],KW=()=>({suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."},groupRemoveSingleChildren:{version:"33",message:"Use `groupHideParentOfSingleChild` instead."},groupRemoveLowestSingleChildren:{version:"33",message:'Use `groupHideParentOfSingleChild: "leafGroupsOnly"` instead.'},suppressRowGroupHidesColumns:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressHideOnGroup"` instead.'},suppressMakeColumnVisibleAfterUnGroup:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressShowOnUngroup"` instead.'},unSortIcon:{version:"33",message:"Use `defaultColDef.unSortIcon` instead."},sortingOrder:{version:"33",message:"Use `defaultColDef.sortingOrder` instead."},suppressPropertyNamesCheck:{version:"33",message:"`gridOptions` and `columnDefs` both have a `context` property that should be used for arbitrary user data. This means that column definitions and gridOptions should only contain valid properties making this property redundant."},suppressAdvancedFilterEval:{version:"34",message:"Advanced filter no longer uses function evaluation, so this option has no effect."}});function sr(e,t,i){return typeof t=="number"||t==null?t==null||t>=i?null:`${e}: value should be greater than or equal to ${i}`:`${e}: value should be a number`}var XW={alignedGrids:"AlignedGrids",allowContextMenuWithControlKey:"ContextMenu",autoSizeStrategy:"ColumnAutoSize",cellSelection:"CellSelection",columnHoverHighlight:"ColumnHover",datasource:"InfiniteRowModel",doesExternalFilterPass:"ExternalFilter",editType:"EditCore",invalidEditValueMode:"EditCore",enableAdvancedFilter:"AdvancedFilter",enableCellSpan:"CellSpan",enableCharts:"IntegratedCharts",enableRangeSelection:"CellSelection",enableRowPinning:"PinnedRow",findSearchValue:"Find",getFullRowEditValidationErrors:"EditCore",getContextMenuItems:"ContextMenu",getLocaleText:"Locale",getMainMenuItems:"ColumnMenu",getRowClass:"RowStyle",getRowStyle:"RowStyle",groupTotalRow:"SharedRowGrouping",grandTotalRow:"SharedRowGrouping",initialState:"GridState",isExternalFilterPresent:"ExternalFilter",isRowPinnable:"PinnedRow",isRowPinned:"PinnedRow",localeText:"Locale",masterDetail:"SharedMasterDetail",pagination:"Pagination",pinnedBottomRowData:"PinnedRow",pinnedTopRowData:"PinnedRow",pivotMode:"SharedPivot",pivotPanelShow:"RowGroupingPanel",quickFilterText:"QuickFilter",rowClass:"RowStyle",rowClassRules:"RowStyle",rowData:"ClientSideRowModel",rowDragManaged:"RowDrag",rowGroupPanelShow:"RowGroupingPanel",rowNumbers:"RowNumbers",rowSelection:"SharedRowSelection",rowStyle:"RowStyle",serverSideDatasource:"ServerSideRowModel",sideBar:"SideBar",statusBar:"StatusBar",treeData:"SharedTreeData",undoRedoCellEditing:"UndoRedoEdit",valueCache:"ValueCache",viewportDatasource:"ViewportRowModel"},YW=()=>{let e={autoSizePadding:{validate({autoSizePadding:i}){return sr("autoSizePadding",i,0)}},cacheBlockSize:{supportedRowModels:["serverSide","infinite"],validate({cacheBlockSize:i}){return sr("cacheBlockSize",i,1)}},cacheOverflowSize:{validate({cacheOverflowSize:i}){return sr("cacheOverflowSize",i,1)}},datasource:{supportedRowModels:["infinite"]},domLayout:{validate:i=>{let s=i.domLayout,n=["autoHeight","normal","print"];return s&&!n.includes(s)?`domLayout must be one of [${n.join()}], currently it's ${s}`:null}},enableFillHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeSelection:{dependencies:{rowDragEntireRow:{required:[!1,void 0]}}},enableRowPinning:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,pinnedTopRowData:s,pinnedBottomRowData:n}){return i&&(s||n)?"Manual row pinning cannot be used together with pinned row data. Either set `enableRowPinning` to `false`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":null}},isRowPinnable:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,isRowPinnable:s,pinnedTopRowData:n,pinnedBottomRowData:o}){return s&&(n||o)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinnable`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!i&&s?"`isRowPinnable` requires `enableRowPinning` to be set.":null}},isRowPinned:{supportedRowModels:["clientSide"],validate({enableRowPinning:i,isRowPinned:s,pinnedTopRowData:n,pinnedBottomRowData:o}){return s&&(n||o)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinned`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!i&&s?"`isRowPinned` requires `enableRowPinning` to be set.":null}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:{required:[void 0,"bottom"]},treeData:{required:[void 0,!1],reason:"Tree Data has values at the group level so it doesn't make sense to hide them."}}},groupHideParentOfSingleChild:{dependencies:{groupHideOpenParents:{required:[void 0,!1]}}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveSingleChildren:{required:[void 0,!1]}}},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveLowestSingleChildren:{required:[void 0,!1]}}},groupSelectsChildren:{dependencies:{rowSelection:{required:["multiple"]}}},groupHierarchyConfig:{validate({groupHierarchyConfig:i={}},s,n){for(let o of Object.keys(i))n.validation?.validateColDef(i[o]);return null}},icons:{validate:({icons:i})=>{if(i){if(i.smallDown)return cr(262);if(i.smallLeft)return cr(263);if(i.smallRight)return cr(264)}return null}},infiniteInitialRowCount:{validate({infiniteInitialRowCount:i}){return sr("infiniteInitialRowCount",i,1)}},initialGroupOrderComparator:{supportedRowModels:["clientSide"]},ssrmExpandAllAffectsAllRows:{validate:i=>{if(typeof i.ssrmExpandAllAffectsAllRows=="boolean"){if(i.rowModelType!=="serverSide")return"'ssrmExpandAllAffectsAllRows' is only supported with the Server Side Row Model.";if(i.ssrmExpandAllAffectsAllRows&&typeof i.getRowId!="function")return"'getRowId' callback must be provided for Server Side Row Model grouping to work correctly."}return null}},keepDetailRowsCount:{validate({keepDetailRowsCount:i}){return sr("keepDetailRowsCount",i,1)}},paginationPageSize:{validate({paginationPageSize:i}){return sr("paginationPageSize",i,1)}},paginationPageSizeSelector:{validate:i=>{let s=i.paginationPageSizeSelector;return typeof s=="boolean"||s==null||s.length?null:`'paginationPageSizeSelector' cannot be an empty array.
                    If you want to hide the page size selector, set paginationPageSizeSelector to false.`}},pivotMode:{dependencies:{treeData:{required:[!1,void 0],reason:"Pivot Mode is not supported with Tree Data."}}},quickFilterText:{supportedRowModels:["clientSide"]},rowBuffer:{validate({rowBuffer:i}){return sr("rowBuffer",i,0)}},rowClass:{validate:i=>typeof i.rowClass=="function"?"rowClass should not be a function, please use getRowClass instead":null},rowData:{supportedRowModels:["clientSide"]},rowDragManaged:{supportedRowModels:["clientSide"],dependencies:{pagination:{required:[!1,void 0]}}},rowSelection:{validate({rowSelection:i}){return i&&typeof i=="string"?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':i&&typeof i!="object"?"Expected `RowSelectionOptions` object for the `rowSelection` property.":i&&i.mode!=="multiRow"&&i.mode!=="singleRow"?`Selection mode "${i.mode}" is invalid. Use one of 'singleRow' or 'multiRow'.`:null}},rowStyle:{validate:i=>{let s=i.rowStyle;return s&&typeof s=="function"?"rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead":null}},serverSideDatasource:{supportedRowModels:["serverSide"]},serverSideInitialRowCount:{supportedRowModels:["serverSide"],validate({serverSideInitialRowCount:i}){return sr("serverSideInitialRowCount",i,1)}},serverSideOnlyRefreshFilteredGroups:{supportedRowModels:["serverSide"]},serverSideSortAllLevels:{supportedRowModels:["serverSide"]},sortingOrder:{validate:i=>{let s=i.sortingOrder;if(Array.isArray(s)&&s.length>0){let n=s.filter(o=>!ig.includes(o));if(n.length>0)return`sortingOrder must be an array with elements from [${ig.map(tv).join()}], currently it includes [${n.map(tv).join()}]`}else if(!Array.isArray(s)||s.length<=0)return`sortingOrder must be an array with at least one element, currently it's ${s}`;return null}},tooltipHideDelay:{validate:i=>i.tooltipHideDelay&&i.tooltipHideDelay<0?"tooltipHideDelay should not be lower than 0":null},tooltipShowDelay:{validate:i=>i.tooltipShowDelay&&i.tooltipShowDelay<0?"tooltipShowDelay should not be lower than 0":null},treeData:{supportedRowModels:["clientSide","serverSide"],validate:i=>{let s=i.rowModelType??"clientSide";switch(s){case"clientSide":{let{treeDataChildrenField:n,treeDataParentIdField:o,getDataPath:l,getRowId:d}=i;if(!n&&!o&&!l)return"treeData requires either 'treeDataChildrenField' or 'treeDataParentIdField' or 'getDataPath' in the clientSide row model.";if(n){if(l)return"Cannot use both 'treeDataChildrenField' and 'getDataPath' at the same time.";if(o)return"Cannot use both 'treeDataChildrenField' and 'treeDataParentIdField' at the same time."}if(o){if(!d)return"getRowId callback not provided, tree data with parent id cannot be built.";if(l)return"Cannot use both 'treeDataParentIdField' and 'getDataPath' at the same time."}return null}case"serverSide":{let n=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${s} row model.`;return i.isServerSideGroup&&i.getServerSideGroupKey?null:n}}return null}},viewportDatasource:{supportedRowModels:["viewport"]},viewportRowModelBufferSize:{validate({viewportRowModelBufferSize:i}){return sr("viewportRowModelBufferSize",i,0)}},viewportRowModelPageSize:{validate({viewportRowModelPageSize:i}){return sr("viewportRowModelPageSize",i,1)}},rowDragEntireRow:{dependencies:{cellSelection:{required:[void 0]}}},autoGroupColumnDef:{validate({autoGroupColumnDef:i,showOpenedGroup:s}){return i?.field&&s?"autoGroupColumnDef.field and showOpenedGroup are not supported when used together.":i?.valueGetter&&s?"autoGroupColumnDef.valueGetter and showOpenedGroup are not supported when used together.":null}},renderingMode:{validate:i=>{let s=i.renderingMode,n=["default","legacy"];return s&&!n.includes(s)?`renderingMode must be one of [${n.join()}], currently it's ${s}`:null}}},t={};return dT.forEach(i=>{t[i]={expectedType:"boolean"}}),uT.forEach(i=>{t[i]={expectedType:"number"}}),no(t,e),t},QW=()=>({objectName:"gridOptions",allProperties:[...ZW(),...Object.values(bb)],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:KW(),validations:YW()}),JW=0,e9=0,LE="__ag_grid_instance",t9=class extends Be{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.instanceId=e9++,this.gridReadyFired=!1,this.queueEvents=[],this.propEventSvc=new dc,this.globalEventHandlerFactory=e=>(t,i)=>{if(!this.isAlive())return;let s=Zm.has(t);if(s&&!e||!s&&e||!i9(t))return;let n=(o,l)=>{let d=bb[o],p=this.gridOptions[d];typeof p=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>p(l))};if(this.gridReadyFired)n(t,i);else if(t==="gridReady"){n(t,i),this.gridReadyFired=!0;for(let o of this.queueEvents)n(o.eventName,o.event);this.queueEvents=[]}else this.queueEvents.push({eventName:t,event:i})}}wireBeans(e){this.gridOptions=e.gridOptions,this.validation=e.validation,this.api=e.gridApi,this.gridId=e.context.getId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){this.validateGridOptions(this.gridOptions),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory().bind(this),!0),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propEventSvc.setFrameworkOverrides(this.beans.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:({options:e})=>{this.updateGridOptions({options:e,force:!0,source:"optionsUpdated"})}})}destroy(){super.destroy(),this.queueEvents=[]}get(e){return this.gridOptions[e]??cB[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return st(this.gridOptions[e])}mergeGridCommonParams(e){return e&&(i=>e(this.addCommon(i)))}updateGridOptions({options:e,force:t,source:i="api"}){let s={id:JW++,properties:[]},n=[],{gridOptions:o,validation:l}=this;for(let d of Object.keys(e)){let p=e[d];l?.warnOnInitialPropertyUpdate(i,d);let y=t||typeof p=="object"&&i==="api",C=o[d];if(y||C!==p){o[d]=p;let S={type:d,currentValue:p,previousValue:C,changeSet:s,source:i};n.push(S)}}this.validateGridOptions(this.gridOptions),s.properties=n.map(d=>d.type),n.forEach(d=>{il(this,`Updated property ${d.type} from`,d.previousValue," to ",d.currentValue),this.propEventSvc.dispatchEvent(d)})}addPropertyEventListener(e,t){this.propEventSvc.addEventListener(e,t)}removePropertyEventListener(e,t){this.propEventSvc.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}addCommon(e){return e.api=this.api,e.context=this.gridOptionsContext,e}validateOptions(e,t){for(let i of Object.keys(e)){let s=e[i];if(s==null||s===!1)continue;let n=t[i];typeof n=="function"&&(n=n(e,this.gridOptions,this.beans)),n&&this.assertModuleRegistered(n,i)}}validateGridOptions(e){this.validateOptions(e,XW),this.validation?.processGridOptions(e)}validateColDef(e,t,i){(i||!this.beans.dataTypeSvc?.isColPendingInference(t))&&(this.validateOptions(e,BW),this.validation?.validateColDef(e))}assertModuleRegistered(e,t){let i=Array.isArray(e)?e.some(s=>this.isModuleRegistered(s)):this.isModuleRegistered(e);return i||li(200,ht(Se({},this.getModuleErrorParams()),{moduleName:e,reasonOrId:t})),i}getModuleErrorParams(){return{gridId:this.gridId,gridScoped:wb(),rowModelType:this.get("rowModelType"),isUmd:V7()}}isModuleRegistered(e){return kC(e,this.gridId,this.get("rowModelType"))}setInstanceDomData(e){e[LE]=this.instanceId}isElementInThisInstance(e){let t=e;for(;t;){let i=t[LE];if(st(i))return i===this.instanceId;t=t.parentElement}return!1}};function i9(e){return!!bb[e]}function pT(e){let t={"aria-hidden":"true"};return{tag:"div",cls:"ag-cell-label-container",role:"presentation",children:[{tag:"span",ref:"eMenu",cls:"ag-header-icon ag-header-cell-menu-button",attrs:t},{tag:"span",ref:"eFilterButton",cls:"ag-header-icon ag-header-cell-filter-button",attrs:t},{tag:"div",ref:"eLabel",cls:"ag-header-cell-label",role:"presentation",children:[{tag:"span",ref:"eText",cls:"ag-header-cell-text"},{tag:"span",ref:"eFilter",cls:"ag-header-icon ag-header-label-icon ag-filter-icon",attrs:t},e?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:null]}]}}var s9=pT(!0),o9=pT(!1),n9=class extends ii{constructor(){super(...arguments),this.eFilter=ot,this.eFilterButton=ot,this.eSortIndicator=ot,this.eMenu=ot,this.eLabel=ot,this.eText=ot,this.eSortOrder=ot,this.eSortAsc=ot,this.eSortDesc=ot,this.eSortMixed=ot,this.eSortNone=ot,this.isLoadingInnerComponent=!1}refresh(e){let t=this.params;if(this.params=e,this.workOutTemplate(e,!!this.beans?.sortSvc)!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||e.enableSorting!=this.currentSort||this.currentSuppressMenuHide!=null&&this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||t.enableFilterButton!=e.enableFilterButton||t.enableFilterIcon!=e.enableFilterIcon)return!1;if(this.innerHeaderComponent){let i=Se({},e);no(i,e.innerHeaderComponentParams),this.innerHeaderComponent.refresh?.(i)}else this.setDisplayName(e);return!0}workOutTemplate(e,t){let i=e.template;return i?i?.trim?i.trim():i:t?s9:o9}init(e){this.params=e;let{sortSvc:t,touchSvc:i,rowNumbersSvc:s,userCompFactory:n}=this.beans,o=t?.getSortIndicatorSelector();this.currentTemplate=this.workOutTemplate(e,!!o),this.setTemplate(this.currentTemplate,o?[o]:void 0),i?.setupForHeader(this),this.setMenu(),this.setupSort(),s?.setupForHeader(this),this.setupFilterIcon(),this.setupFilterButton(),this.workOutInnerHeaderComponent(n,e),this.setDisplayName(e)}workOutInnerHeaderComponent(e,t){let i=C5(e,t,t);i&&(this.isLoadingInnerComponent=!0,i.newAgStackInstance().then(s=>{this.isLoadingInnerComponent=!1,s&&(this.isAlive()?(this.innerHeaderComponent=s,this.eText&&this.eText.appendChild(s.getGui())):this.destroyBean(s))}))}setDisplayName(e){let{displayName:t}=e,i=this.currentDisplayName;this.currentDisplayName=t,!(!this.eText||i===t||this.innerHeaderComponent||this.isLoadingInnerComponent)&&(this.eText.textContent=Iu(t))}addInIcon(e,t,i){let s=tn(e,this.beans,i);s&&t.appendChild(s)}workOutShowMenu(){return this.params.enableMenu&&!!this.beans.menuSvc?.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return!!this.beans.menuSvc?.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){yo(this.eMenu),this.eMenu=void 0;return}let{gos:e,eMenu:t,params:i}=this,s=Bo(e);this.addInIcon(s?"menu":"menuAlt",t,i.column),t.classList.toggle("ag-header-menu-icon",!s);let n=this.shouldSuppressMenuHide();this.currentSuppressMenuHide=n,this.addManagedElementListeners(t,{click:()=>this.showColumnMenu(this.eMenu)}),this.toggleMenuAlwaysShow(n)}toggleMenuAlwaysShow(e){this.eMenu?.classList.toggle("ag-header-menu-always-show",e)}showColumnMenu(e){let{currentSuppressMenuHide:t,params:i}=this;t||this.toggleMenuAlwaysShow(!0),i.showColumnMenu(e,()=>{t||this.toggleMenuAlwaysShow(!1)})}onMenuKeyboardShortcut(e){let{params:t,gos:i,beans:s,eMenu:n,eFilterButton:o}=this,l=t.column,d=Bo(i);if(e&&!d){if(s.menuSvc?.isFilterMenuInHeaderEnabled(l))return t.showFilter(o??n??this.getGui()),!0}else if(t.enableMenu)return this.showColumnMenu(n??o??this.getGui()),!0;return!1}setupSort(){let{sortSvc:e}=this.beans;if(!e)return;let{enableSorting:t,column:i}=this.params;if(this.currentSort=t,!this.eSortIndicator){this.eSortIndicator=this.createBean(e.createSortIndicator(!0));let{eSortIndicator:s,eSortOrder:n,eSortAsc:o,eSortDesc:l,eSortMixed:d,eSortNone:p}=this;s.attachCustomElements(n,o,l,d,p)}this.eSortIndicator.setupSort(i),this.currentSort&&e.setupHeader(this,i,this.eLabel)}setupFilterIcon(){let{eFilter:e,params:t}=this;if(!e)return;let i=()=>{let s=t.column.isFilterActive();Ti(e,s,{skipAriaHidden:!0})};this.configureFilter(t.enableFilterIcon,e,i,"filterActive")}setupFilterButton(){let{eFilterButton:e,params:t}=this;if(!e)return;this.configureFilter(t.enableFilterButton,e,this.onFilterChangedButton.bind(this),"filter")?this.addManagedElementListeners(e,{click:()=>t.showFilter(e)}):this.eFilterButton=void 0}configureFilter(e,t,i,s){if(!e)return yo(t),!1;let n=this.params.column;return this.addInIcon(s,t,n),this.addManagedListeners(n,{filterChanged:i}),i(),!0}onFilterChangedButton(){let e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){let{eFilterButton:t,eMenu:i}=this;return e?t??i??this.getGui():i??t??this.getGui()}destroy(){super.destroy(),this.innerHeaderComponent&&(this.destroyBean(this.innerHeaderComponent),this.innerHeaderComponent=void 0)}},r9={tag:"div",cls:"ag-header-group-cell-label",role:"presentation",children:[{tag:"span",ref:"agLabel",cls:"ag-header-group-text",role:"presentation"},{tag:"span",ref:"agOpened",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"},{tag:"span",ref:"agClosed",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"}]},a9=class extends ii{constructor(){super(r9),this.agOpened=ot,this.agClosed=ot,this.agLabel=ot,this.isLoadingInnerComponent=!1}init(e){let{userCompFactory:t,touchSvc:i}=this.beans;this.params=e,this.checkWarnings(),this.workOutInnerHeaderGroupComponent(t,e),this.setupLabel(e),this.addGroupExpandIcon(e),this.setupExpandIcons(),i?.setupForHeaderGroup(this)}checkWarnings(){this.params.template&&je(89)}workOutInnerHeaderGroupComponent(e,t){let i=x5(e,t,t);i&&(this.isLoadingInnerComponent=!0,i.newAgStackInstance().then(s=>{this.isLoadingInnerComponent=!1,s&&(this.isAlive()?(this.innerHeaderGroupComponent=s,this.agLabel.appendChild(s.getGui())):this.destroyBean(s))}))}setupExpandIcons(){let{agOpened:e,agClosed:t,params:{columnGroup:i},beans:s}=this;this.addInIcon("columnGroupOpened",e),this.addInIcon("columnGroupClosed",t);let n=p=>{if(ea(p))return;let y=!i.isExpanded();s.colGroupSvc.setColumnGroupOpened(i.getProvidedColumnGroup(),y,"uiColumnExpanded")};this.addTouchAndClickListeners(s,t,n),this.addTouchAndClickListeners(s,e,n);let o=p=>{mc(p)};this.addManagedElementListeners(t,{dblclick:o}),this.addManagedElementListeners(e,{dblclick:o}),this.addManagedElementListeners(this.getGui(),{dblclick:n}),this.updateIconVisibility();let l=i.getProvidedColumnGroup(),d=this.updateIconVisibility.bind(this);this.addManagedListeners(l,{expandedChanged:d,expandableChanged:d})}addTouchAndClickListeners(e,t,i){e.touchSvc?.setupForHeaderGroupElement(this,t,i),this.addManagedElementListeners(t,{click:i})}updateIconVisibility(){let{agOpened:e,agClosed:t,params:{columnGroup:i}}=this;if(i.isExpandable()){let s=i.isExpanded();Ti(e,s),Ti(t,!s)}else Ti(e,!1),Ti(t,!1)}addInIcon(e,t){let i=tn(e,this.beans,null);i&&t.appendChild(i)}addGroupExpandIcon(e){if(!e.columnGroup.isExpandable()){let{agOpened:t,agClosed:i}=this;Ti(t,!1),Ti(i,!1);return}}setupLabel(e){let{displayName:t,columnGroup:i}=e,s=this.innerHeaderGroupComponent||this.isLoadingInnerComponent;st(t)&&!s&&(this.agLabel.textContent=Iu(t)),this.toggleCss("ag-sticky-label",!i.getColGroupDef()?.suppressStickyLabel)}destroy(){super.destroy(),this.innerHeaderGroupComponent&&(this.destroyBean(this.innerHeaderGroupComponent),this.innerHeaderGroupComponent=void 0)}},l9={moduleName:"ColumnHeaderComp",version:nt,userComponents:{agColumnHeader:n9},icons:{menu:"menu",menuAlt:"menu-alt"}},c9={moduleName:"ColumnGroupHeaderComp",version:nt,userComponents:{agColumnGroupHeader:a9},icons:{columnGroupOpened:"expanded",columnGroupClosed:"contracted"}},h9=class extends Be{constructor(){super(...arguments),this.beanName="animationFrameSvc",this.p1={list:[],sorted:!1},this.p2={list:[],sorted:!1},this.f1={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastScrollTop=0,this.taskCount=0}setScrollTop(e){this.scrollGoingDown=e>=this.lastScrollTop,e===0&&(this.scrollGoingDown=!0),this.lastScrollTop=e}postConstruct(){this.active=!this.gos.get("suppressAnimationFrame"),this.batchFrameworkComps=this.beans.frameworkOverrides.batchFrameworkComps}verify(){this.active===!1&&je(92)}createTask(e,t,i,s,n=!1){this.verify();let o=i;s&&this.batchFrameworkComps&&(o="f1");let l={task:e,index:t,createOrder:++this.taskCount,deferred:n};this.addTaskToList(this[o],l),this.schedule()}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;let t=this.scrollGoingDown?1:-1;e.list.sort((i,s)=>i.deferred!==s.deferred?i.deferred?-1:1:i.index!==s.index?t*(s.index-i.index):s.createOrder-i.createOrder),e.sorted=!0}addDestroyTask(e){this.verify(),this.destroyTasks.push(e),this.schedule()}executeFrame(e){let{p1:t,p2:i,f1:s,destroyTasks:n,beans:o}=this,{ctrlsSvc:l,frameworkOverrides:d}=o,p=t.list,y=i.list,C=s.list,S=Date.now(),P=0,I=e<=0,O=l.getScrollFeature();for(;I||P<e;){if(!O.scrollGridIfNeeded()){let G;if(p.length)this.sortTaskList(t),G=p.pop().task;else if(y.length)this.sortTaskList(i),G=y.pop().task;else if(C.length)d.wrapOutgoing(()=>{for(;(I||P<e)&&!O.scrollGridIfNeeded();){if(C.length)this.sortTaskList(s),G=C.pop().task,G();else break;P=Date.now()-S}}),G=()=>{};else if(n.length)G=n.pop();else break;G()}P=Date.now()-S}p.length||y.length||C.length||n.length?this.requestFrame():this.ticking=!1}flushAllFrames(){this.active&&this.executeFrame(-1)}schedule(){this.active&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){let e=this.executeFrame.bind(this,60);sa(this.beans,e)}isQueueEmpty(){return!this.ticking}},u9={moduleName:"AnimationFrame",version:nt,beans:[h9]},d9=class extends Be{constructor(){super(...arguments),this.beanName="iconSvc"}createIconNoSpan(e,t){return tn(e,this.beans,t?.column)}},p9=class extends Be{constructor(){super(...arguments),this.beanName="touchSvc"}mockBodyContextMenu(e,t){this.mockContextMenu(e,e.eBodyViewport,t)}mockHeaderContextMenu(e,t){this.mockContextMenu(e,e.eGui,t)}mockRowContextMenu(e){if(!cc())return;let t=(i,s,n)=>{let{rowCtrl:o,cellCtrl:l}=e.getControlsForEventTarget(n?.target??null);l?.column&&l.dispatchCellContextMenuEvent(n??null),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(void 0,n,o,l)};this.mockContextMenu(e,e.element,t)}handleCellDoubleClick(e,t){return(()=>{if(!cc()||fP("dblclick"))return!1;let s=Date.now(),n=s-e.lastIPadMouseClickEvent<200;return e.lastIPadMouseClickEvent=s,n})()?(e.onCellDoubleClicked(t),t.preventDefault(),!0):!1}setupForHeader(e){let{gos:t,sortSvc:i,menuSvc:s}=this.beans;if(t.get("suppressTouch"))return;let{params:n,eMenu:o,eFilterButton:l}=e,d=new sc(e.getGui(),!0),p=e.shouldSuppressMenuHide(),y=p&&st(o)&&n.enableMenu,C=y?new sc(o,!0):d;if(n.enableMenu||s?.isHeaderContextMenuEnabled(n.column)){let S=y?"tap":"longTap",P=I=>n.showColumnMenuAfterMouseClick(I.touchStart);e.addManagedListeners(C,{[S]:P})}if(n.enableSorting){let S=P=>{let I=P.touchStart.target;p&&(o?.contains(I)||l?.contains(I))||i?.progressSort(n.column,!1,"uiColumnSorted")};e.addManagedListeners(d,{tap:S})}if(n.enableFilterButton&&l){let S=new sc(l,!0);e.addManagedListeners(S,{tap:()=>n.showFilter(l)}),e.addDestroyFunc(()=>S.destroy())}e.addDestroyFunc(()=>d.destroy()),y&&e.addDestroyFunc(()=>C.destroy())}setupForHeaderGroup(e){let t=e.params;if(this.beans.menuSvc?.isHeaderContextMenuEnabled(t.columnGroup.getProvidedColumnGroup())){let i=new sc(t.eGridHeader,!0),s=n=>t.showColumnMenuAfterMouseClick(n.touchStart);e.addManagedListeners(i,{longTap:s}),e.addDestroyFunc(()=>i.destroy())}}setupForHeaderGroupElement(e,t,i){let s=new sc(t,!0);e.addManagedListeners(s,{tap:i}),e.addDestroyFunc(()=>s.destroy())}mockContextMenu(e,t,i){if(!cc())return;let s=new sc(t),n=o=>{Zp(this.beans,o.touchEvent)&&i(void 0,o.touchStart,o.touchEvent)};e.addManagedListeners(s,{longTap:n}),e.addDestroyFunc(()=>s.destroy())}},g9={moduleName:"Touch",version:nt,beans:[p9]},f9=class extends Be{constructor(){super(...arguments),this.beanName="cellNavigation"}wireBeans(e){this.rowSpanSvc=e.rowSpanSvc}getNextCellToFocus(e,t,i=!1){return i?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){let i=e===Fe.UP,s=e===Fe.DOWN,n=e===Fe.LEFT,o,l,{pageBounds:d,gos:p,visibleCols:y,pinnedRowModel:C}=this.beans,{rowPinned:S}=t;if(i||s)S&&C?i?l=0:l=S==="top"?C.getPinnedTopRowCount()-1:C.getPinnedBottomRowCount()-1:l=i?d.getFirstRow():d.getLastRow(),o=t.column;else{let P=p.get("enableRtl");l=t.rowIndex,o=(n!==P?y.allCols:[...y.allCols].reverse()).find(O=>this.isCellGoodToFocusOn({rowIndex:l,rowPinned:null,column:O}))}return o?{rowIndex:l,rowPinned:S,column:o}:null}getNextCellToFocusWithoutCtrlPressed(e,t){let i=t,s=!1;for(;!s;){switch(e){case Fe.UP:i=this.getCellAbove(i);break;case Fe.DOWN:i=this.getCellBelow(i);break;case Fe.RIGHT:i=this.gos.get("enableRtl")?this.getCellToLeft(i):this.getCellToRight(i);break;case Fe.LEFT:i=this.gos.get("enableRtl")?this.getCellToRight(i):this.getCellToLeft(i);break;default:i=null,je(8,{key:e});break}i?s=this.isCellGoodToFocusOn(i):s=!0}return i}isCellGoodToFocusOn(e){let t=e.column,i,{pinnedRowModel:s,rowModel:n}=this.beans;switch(e.rowPinned){case"top":i=s?.getPinnedTopRow(e.rowIndex);break;case"bottom":i=s?.getPinnedBottomRow(e.rowIndex);break;default:i=n.getRow(e.rowIndex);break}return i?!this.isSuppressNavigable(t,i):!1}getCellToLeft(e){if(!e)return null;let t=this.beans.visibleCols.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;let t=this.beans.visibleCols.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellBelow(e){if(!e)return null;let t=this.rowSpanSvc?.getCellEnd(e)??e,i=xE(this.beans,t,!0);return i?{rowIndex:i.rowIndex,column:e.column,rowPinned:i.rowPinned}:null}getCellAbove(e){if(!e)return null;let t=this.rowSpanSvc?.getCellStart(e)??e,i=dv(this.beans,{rowIndex:t.rowIndex,rowPinned:t.rowPinned},!0);return i?{rowIndex:i.rowIndex,column:e.column,rowPinned:i.rowPinned}:null}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){let{visibleCols:t,pagination:i}=this.beans,s=t.allCols,n=e.rowIndex,o=e.rowPinned,l=t.getColAfter(e.column);if(!l){l=s[0];let d=xE(this.beans,e,!0);if(Di(d)||!d.rowPinned&&!(i?.isRowInPage(d.rowIndex)??!0))return null;n=d?d.rowIndex:null,o=d?d.rowPinned:null}return{rowIndex:n,column:l,rowPinned:o}}getNextTabbedCellBackwards(e){let{beans:t}=this,{visibleCols:i,pagination:s}=t,n=i.allCols,o=e.rowIndex,l=e.rowPinned,d=i.getColBefore(e.column);if(!d){d=di(n);let p=dv(t,{rowIndex:e.rowIndex,rowPinned:e.rowPinned},!0);if(Di(p)||!p.rowPinned&&!(s?.isRowInPage(p.rowIndex)??!0))return null;o=p?p.rowIndex:null,l=p?p.rowPinned:null}return{rowIndex:o,column:d,rowPinned:l}}isSuppressNavigable(e,t){let{suppressNavigable:i}=e.colDef;if(typeof i=="boolean")return i;if(typeof i=="function"){let s=e.createColumnFunctionCallbackParams(t);return i(s)}return!1}};function m9(e){return e.focusSvc.getFocusedCell()}function v9(e){return e.focusSvc.clearFocusedCell()}function y9(e,t,i,s){e.focusSvc.setFocusedCell({rowIndex:t,column:i,rowPinned:s,forceBrowserFocus:!0})}function w9(e,t){return e.navigation?.tabToNextCell(!1,t)??!1}function C9(e,t){return e.navigation?.tabToNextCell(!0,t)??!1}function b9(e,t,i=!1){let s=e.headerNavigation?.getHeaderPositionForColumn(t,i);s&&e.focusSvc.focusHeaderPosition({headerPosition:s})}var x9=class extends Be{constructor(){super(...arguments),this.beanName="editModelSvc",this.edits=new Map,this.cellValidations=new gT,this.rowValidations=new fT,this.suspendEdits=!1}suspend(e){this.suspendEdits=e}removeEdits({rowNode:e,column:t}){if(!this.hasEdits({rowNode:e})||!e)return;let i=this.getEditRow(e);t?i.delete(t):i.clear(),i.size===0&&this.edits.delete(e)}getEditRow(e,t={}){if(this.suspendEdits||this.edits.size===0)return;let i=e&&this.edits.get(e);if(i)return i;if(t.checkSiblings){let s=e.pinnedSibling;if(s)return this.getEditRow(s)}}getEditRowDataValue(e,{checkSiblings:t}={}){if(!e||this.edits.size===0)return;let i=this.getEditRow(e),s=e.pinnedSibling,n=t&&s&&this.getEditRow(s);if(!i&&!n)return;let o=Object.assign({},e.data),l=(d,p)=>d.forEach(({pendingValue:y},C)=>{y!==nn&&(p[C.getColId()]=y)});return i&&l(i,o),n&&l(n,o),o}getEdit(e,t){let i=this._getEdit(e);return t&&i?Se({},i):i}_getEdit(e){if(!this.suspendEdits&&this.edits.size!==0)return e.rowNode&&e.column&&this.getEditRow(e.rowNode)?.get(e.column)}getEditMap(e=!0){if(this.suspendEdits||this.edits.size===0)return new Map;if(!e)return this.edits;let t=new Map;return this.edits.forEach((i,s)=>{let n=new Map;i.forEach((p,d)=>{var y=p,{editorState:o}=y,l=Kd(y,["editorState"]);return n.set(d,Se({},l))}),t.set(s,n)}),t}setEditMap(e){this.edits.clear(),e.forEach((t,i)=>{let s=new Map;t.forEach((n,o)=>s.set(o,Se({},n))),this.edits.set(i,s)})}setEdit(e,t){(this.edits.size===0||!this.edits.has(e.rowNode))&&this.edits.set(e.rowNode,new Map);let i=this._getEdit(e),s=Object.assign(Se(Se({editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}},i),t));return this.getEditRow(e.rowNode).set(e.column,s),s}clearEditValue(e){let{rowNode:t,column:i}=e;if(t)if(i){let s=this._getEdit(e);s&&(s.editorValue=void 0,s.pendingValue=s.sourceValue,s.state="changed")}else this.getEditRow(t)?.forEach(s=>{s.editorValue=void 0,s.pendingValue=s.sourceValue,s.state="changed"})}getState(e){if(!this.suspendEdits)return this.getEdit(e)?.state}getEditPositions(e){if(this.suspendEdits||(e??this.edits).size===0)return[];let t=[];return(e??this.edits).forEach((i,s)=>{for(let o of i.keys()){let n=i.get(o),{editorState:l}=n,d=Kd(n,["editorState"]);t.push(Se({rowNode:s,column:o},d))}}),t}hasRowEdits(e,t){return this.suspendEdits||this.edits.size===0?!1:!!this.getEditRow(e,t)}hasEdits(e={},t={}){if(this.suspendEdits||this.edits.size===0)return!1;let{rowNode:i,column:s}=e,{withOpenEditor:n}=t;if(i){let o=this.getEditRow(i,t);return o?s?n?this.getEdit(e)?.state==="editing":o.has(s)??!1:o.size!==0?n?Array.from(o.values()).some(({state:l})=>l==="editing"):!0:!1:!1}return n?this.getEditPositions().some(({state:o})=>o==="editing"):this.edits.size>0}start(e){let t=this.getEditRow(e.rowNode)??new Map,{rowNode:i,column:s}=e;s&&!t.has(s)&&t.set(s,{editorValue:void 0,pendingValue:nn,sourceValue:this.beans.valueSvc.getValue(s,i,!1,"api"),state:"editing",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}}),this.edits.set(i,t)}stop(e){this.hasEdits(e)&&(e?this.removeEdits(e):this.clear())}clear(){for(let e of this.edits.values())e.clear();this.edits.clear()}getCellValidationModel(){return this.cellValidations}getRowValidationModel(){return this.rowValidations}setCellValidationModel(e){this.cellValidations=e}setRowValidationModel(e){this.rowValidations=e}destroy(){super.destroy(),this.clear()}},gT=class{constructor(){this.cellValidations=new Map}getCellValidation(e){let{rowNode:t,column:i}=e||{};return this.cellValidations?.get(t)?.get(i)}hasCellValidation(e){return!e||!e.rowNode||!e.column?this.cellValidations.size>0:!!this.getCellValidation(e)}setCellValidation(e,t){let{rowNode:i,column:s}=e;this.cellValidations.has(i)||this.cellValidations.set(i,new Map),this.cellValidations.get(i).set(s,t)}clearCellValidation(e){let{rowNode:t,column:i}=e;this.cellValidations.get(t)?.delete(i)}setCellValidationMap(e){this.cellValidations=e}getCellValidationMap(){return this.cellValidations}clearCellValidationMap(){this.cellValidations.clear()}},fT=class{constructor(){this.rowValidations=new Map}getRowValidation(e){let{rowNode:t}=e||{};return this.rowValidations.get(t)}hasRowValidation(e){return!e||!e.rowNode?this.rowValidations.size>0:!!this.getRowValidation(e)}setRowValidation({rowNode:e},t){this.rowValidations.set(e,t)}clearRowValidation({rowNode:e}){this.rowValidations.delete(e)}setRowValidationMap(e){this.rowValidations=e}getRowValidationMap(){return this.rowValidations}clearRowValidationMap(){this.rowValidations.clear()}};function Sb(e,t={}){let{rowIndex:i,rowId:s,rowCtrl:n,rowPinned:o}=t;if(n)return n;let{rowModel:l,rowRenderer:d}=e,{rowNode:p}=t;return p||(s?p=VN(e,s,o):i!=null&&(p=l.getRow(i))),d.getRowCtrls(p?[p]:[])?.[0]}function Oi(e,t={}){let{cellCtrl:i,colId:s,columnId:n,column:o}=t;if(i)return i;let l=e.colModel.getCol(s??n??AC(o)),d=t.rowCtrl??Sb(e,t),p=d?.getCellCtrl(l)??void 0;if(p)return p;let y=t.rowNode??d?.rowNode;if(y)return e.rowRenderer.getCellCtrls([y],[l])?.[0]}function OE(e){let{editSvc:t}=e;t?.isBatchEditing()?Su(e):t?.stopEditing(void 0,{source:"api"})}function _9(e,t,i){let{gos:s,popupSvc:n}=t;if(!s.get("stopEditingWhenCellsLoseFocus"))return;let o=l=>{let d=l.relatedTarget;if(vC(d)===null){OE(t);return}let p=i.some(y=>y.contains(d))&&s.isElementInThisInstance(d);p||(p=!!n&&(n.getActivePopups().some(y=>y.contains(d))||n.isElementWithinCustomPopup(d))),p||OE(t)};i.forEach(l=>e.addManagedElementListeners(l,{focusout:o}))}function AC(e){if(e)return typeof e=="string"?e:e.getColId()}var nn=Symbol("unedited");function mT(e,t={}){let i=[],s=e.rowRenderer.getCellCtrls(t.rowNodes,t.columns);for(let n of s){let o=n.comp?.getCellEditor();o&&i.push({ctrl:n,editor:Yp(o)})}return i}var S9=(e,t={})=>mT(e,t).map(i=>i.editor);function R9(e,t,i,s,n,o){t.length===0&&i?.rowNode&&i?.column&&Fu(e,i,{key:s,event:n,cellStartedEdit:o});let{valueSvc:l,editSvc:d,editModelSvc:p}=e,{rowNode:y,column:C}=i??{};for(let S of t){let{rowNode:P,column:I}=S,O=Oi(e,S);if(!O){if(P&&I){let G=l.getValue(I,P,void 0,"api"),ae=(i?.rowNode===P&&i?.column===I&&s||void 0)??d?.getCellDataValue(S,!1)??l.getValueForDisplay(I,P)?.value??G??nn;p?.setEdit(S,{pendingValue:ae,sourceValue:G,state:"editing"})}continue}let V=o&&y===O.rowNode&&O.column===C;Fu(e,{rowNode:y,column:O.column},{key:V?s:null,event:V?n:null,cellStartedEdit:V&&o})}}function Yr({pendingValue:e,sourceValue:t}){return e===nn&&(e=t),e!==t}function Fu(e,t,i){let s=e.gos.get("enableGroupEdit"),{key:n,event:o,cellStartedEdit:l,silent:d}=i??{},p=Oi(e,t),y=p?.comp?.getCellEditor(),C=yT(e,t,n,l&&!d),S=e.editModelSvc?.getEdit(t),P=C.value;if(P===void 0&&(P=S?.sourceValue),e.editModelSvc?.setEdit(t,{editorValue:P,state:"editing"}),y){y.refresh?.(C);return}let I=t.column.getColDef(),O=JP(e.userCompFactory,I,C),V=O?.popupFromSelector!=null?O.popupFromSelector:!!I.cellEditorPopup,G=O?.popupPositionFromSelector!=null?O.popupPositionFromSelector:I.cellEditorPopupPosition;if(wT(O.params,o),p){p.editCompDetails=O,p.comp?.setEditDetails(O,V,G,e.gos.get("reactiveCustomComponents")),p?.rowCtrl?.refreshRow({suppressFlash:!0});let X=e.editModelSvc?.getEdit(t,!0);!d&&!X?.editorState?.cellStartedEditing&&(e.editSvc?.dispatchCellEvent(t,o,"cellEditingStarted",s?{value:P}:{}),e.editModelSvc?.setEdit(t,{editorState:{cellStartedEditing:!0}}))}}function vT(e,t,i){let s={editorValueExists:!1};if(Rb(e)&&(t.getValidationErrors?.()?.length??0)>0||i?.isCancelling)return s;if(i?.isStopping){let o=t?.isCancelAfterEnd?.();if(o)return ht(Se({},s),{isCancelAfterEnd:o})}return{editorValue:t.getValue(),editorValueExists:!0}}function yT(e,t,i,s){let{valueSvc:n,gos:o,editSvc:l}=e,d=e.gos.get("enableGroupEdit"),p=Oi(e,t),y=t.rowNode?.rowIndex??void 0,C=l?.isBatchEditing(),S=e.colModel.getCol(t.column.getId()),{rowNode:P,column:I}=t,O=p.comp?.getCellEditor(),V=l?.getCellDataValue(t,!1)??(O?vT(e,O)?.editorValue:void 0),G=V===nn?n.getValueForDisplay(S,P)?.value:V;return bt(o,{value:d?V:G,eventKey:i??null,column:I,colDef:I.getColDef(),rowIndex:y,node:P,data:P.data,cellStartedEdit:s??!1,onKeyDown:p?.onKeyDown.bind(p),stopEditing:X=>{l.stopEditing(t,{source:C?"ui":"api",suppressNavigateAfterEdit:X}),gv(e,t)},eGridCell:p?.eGui,parseValue:X=>n.parseValue(S,P,X,p?.value),formatValue:p?.formatValue.bind(p),validate:()=>{l?.validateEdit()}})}function LC(e,t){let{editModelSvc:i}=e;i?.getEditMap().forEach((s,n)=>{s.forEach((o,l)=>{!t&&(o.state==="editing"||o.pendingValue===nn)||!Yr(o)&&(o.state!=="editing"||t)&&i?.removeEdits({rowNode:n,column:l})})})}function E9(e,t){let i=t.comp?.getCellEditor();if(!i?.refresh)return;let{eventKey:s,cellStartedEdit:n}=t.editCompDetails.params,{column:o}=t,l=yT(e,t,s,n),d=o.getColDef(),p=JP(e.userCompFactory,d,l);i.refresh(wT(p.params,s))}function wT(e,t){return t instanceof KeyboardEvent&&e.column.getColDef().cellEditor==="agNumberCellEditor"?e.suppressPreventDefault=["-","+",".","e"].includes(t?.key??"")||e.suppressPreventDefault:t?.preventDefault?.(),e}function nc(e,t){e.editModelSvc?.getEditPositions().forEach(i=>{let s=Oi(e,i);if(!s)return;let n=s.comp?.getCellEditor();if(!n)return;let{editorValue:o,editorValueExists:l,isCancelAfterEnd:d}=vT(e,n,t);d&&e.editModelSvc?.setEdit(i,{editorState:{isCancelAfterEnd:d}}),Km(e,i,o,void 0,!l,t)})}function Km(e,t,i,s,n,o){let{editModelSvc:l,valueSvc:d}=e;if(!l)return;let{rowNode:p,column:y}=t;if(!(p&&y))return;let C=l.getEdit(t,!0);C?.sourceValue||(C=l.setEdit(t,{sourceValue:d.getValue(y,p,void 0,"api"),pendingValue:C?C.editorValue:nn})),l.setEdit(t,{editorValue:n?C.sourceValue:i}),o?.persist&&P9(e,t)}function P9(e,t){let{editModelSvc:i}=e,s=i?.getEdit(t,!0);i?.setEdit(t,{pendingValue:s?.editorValue})}function Su(e,t,i){t||(t=e.editModelSvc?.getEditPositions()),t.forEach(s=>gv(e,s,i))}function gv(e,t,i){let s=e.gos.get("enableGroupEdit"),{editModelSvc:n}=e,o=Oi(e,t),l=n?.getEdit(t,!0);if(!o){l&&n?.setEdit(t,{state:"changed"});return}let{comp:d}=o;if(d&&!d.getCellEditor()){if(o?.refreshCell(),l){n?.setEdit(t,{state:"changed"});let y=s?zE(i,l):{valueChanged:!1,newValue:void 0,oldValue:l.sourceValue};BE(e,t,y,i)}return}if(Rb(e)){let y=d?.getCellEditor()?.getValidationErrors?.(),C=n?.getCellValidationModel();y?.length?C?.setCellValidation(t,{errorMessages:y}):C?.clearCellValidation(t)}n?.setEdit(t,{state:"changed"}),d?.setEditDetails(),d?.refreshEditStyles(!1,!1),o?.refreshCell({force:!0,suppressFlash:!0});let p=n?.getEdit(t);if(p&&p.state==="changed"){let y=s?zE(i,p):{valueChanged:Yr(p)&&!i?.cancel,newValue:i?.cancel||p.editorState.isCancelAfterEnd?void 0:p?.editorValue??l?.pendingValue,oldValue:p?.sourceValue};BE(e,t,y,i)}}function zE(e,t){return e?.cancel?{valueChanged:!1,oldValue:t.sourceValue,newValue:void 0,value:t.sourceValue}:{valueChanged:!1,oldValue:t.sourceValue,newValue:t.pendingValue,value:t.sourceValue}}function BE(e,t,i,{silent:s,event:n}={}){let{editSvc:o,editModelSvc:l}=e,d=l?.getEdit(t),{editorState:p}=d||{},{isCancelBeforeStart:y}=p||{};!s&&!y&&(o?.dispatchCellEvent(t,n,"cellEditingStopped",i),l?.setEdit(t,{editorState:{cellStoppedEditing:!0}}))}function Rb(e){let{gos:t,colModel:i}=e,s=!!t.get("getFullRowEditValidationErrors"),n=i.getColumnDefs()?.filter(l=>l.editable).some(({cellEditorParams:l})=>{let{minLength:d,maxLength:p,getValidationErrors:y,min:C,max:S}=l||{};return d!==void 0||p!==void 0||y!==void 0||C!==void 0||S!==void 0}),o=e.gridApi.getCellEditorInstances().some(l=>l.getValidationElement||l.getValidationErrors);return n||s||o}function vc(e,t){if(!(t||Rb(e)))return;let i=mT(e),s=new gT,{ariaAnnounce:n,localeSvc:o,editModelSvc:l,gos:d}=e,p=d.get("editType")==="fullRow",C=vP(o)("ariaValidationErrorPrefix","Cell Editor Validation");for(let P of i){let{ctrl:I,editor:O}=P,{rowNode:V,column:G}=I,X=O.getValidationErrors?.()??[],Q=O.getValidationElement?.(!1)||!O.isPopup?.()&&I.eGui;if(Q){let ae=X!=null&&X.length>0,me=ae?X.join(". "):"";P4(Q,ae),ae&&n.announceValue(`${C} ${X}`,"editorValidation"),Q instanceof HTMLInputElement?Q.setCustomValidity(me):Q.classList.toggle("invalid",ae)}X?.length>0&&s.setCellValidation({rowNode:V,column:G},{errorMessages:X})}nc(e,{persist:!1}),l?.setCellValidationModel(s);let S=new Set;for(let{ctrl:P}of i)S.add(P.rowCtrl);if(p){let P=M9(e);l?.setRowValidationModel(P)}for(let P of S.values()){P.rowEditStyleFeature?.applyRowStyles();for(let I of P.getAllCellCtrls())I.tooltipFeature?.refreshTooltip(!0),I.editorTooltipFeature?.refreshTooltip(!0),I.editStyleFeature?.applyCellStyles?.()}}var M9=e=>{let t=new fT,i=e.gos.get("getFullRowEditValidationErrors"),s=e.editModelSvc?.getEditMap();if(!s)return t;for(let n of s.keys()){let o=s.get(n);if(!o)continue;let l=[],{rowIndex:d,rowPinned:p}=n;for(let C of o.keys()){let S=o.get(C);if(!S)continue;let{editorValue:P,pendingValue:I,sourceValue:O}=S,V=P??(I===nn?void 0:I)??O;l.push({column:C,colId:C.getColId(),rowIndex:d,rowPinned:p,oldValue:O,newValue:V})}let y=i?.({editorsState:l})??[];y.length>0&&t.setRowValidation({rowNode:n},{errorMessages:y})}return t};function T9(e){vc(e,!0);let t=e.editModelSvc?.getCellValidationModel().getCellValidationMap();if(!t)return null;let i=[];return t.forEach((s,n)=>{s.forEach(({errorMessages:o},l)=>{i.push({column:l,rowIndex:n.rowIndex,rowPinned:n.rowPinned,messages:o??null})})}),i}function D9(e,t,i,{rowNode:s,column:n},o){return bt(e.gos,{type:i,node:s,data:s.data,value:o,column:n,colDef:n.getColDef(),rowPinned:s.rowPinned,event:t,rowIndex:s.rowIndex})}function F9(e,t=!1){return e===Fe.DELETE?!0:!t&&e===Fe.BACKSPACE?iM():!1}var I9=class extends Be{constructor(e,t,i,s){super(),this.cellCtrl=e,this.rowNode=i,this.rowCtrl=s,this.beans=t}init(){this.eGui=this.cellCtrl.eGui}onKeyDown(e){let t=e.key;switch(t){case Fe.ENTER:this.onEnterKeyDown(e);break;case Fe.F2:this.onF2KeyDown(e);break;case Fe.ESCAPE:this.onEscapeKeyDown(e);break;case Fe.TAB:this.onTabKeyDown(e);break;case Fe.BACKSPACE:case Fe.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case Fe.DOWN:case Fe.UP:case Fe.RIGHT:case Fe.LEFT:this.onNavigationKeyDown(e,t);break}}onNavigationKeyDown(e,t){let{cellCtrl:i,beans:s}=this;if(!s.editSvc?.isEditing(i,{withOpenEditor:!0})){if(e.shiftKey&&i.isRangeSelectionEnabled())this.onShiftRangeSelect(e);else{let n=i.getFocusedCellPosition();s.navigation?.navigateToNextCell(e,t,n,!0)}e.preventDefault()}}onShiftRangeSelect(e){let{rangeSvc:t,navigation:i}=this.beans;if(!t)return;let s=t.extendLatestRangeInDirection(e);s&&(e.key===Fe.LEFT||e.key===Fe.RIGHT?i?.ensureColumnVisible(s.column):i?.ensureRowVisible(s.rowIndex))}onTabKeyDown(e){this.beans.navigation?.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){let{cellCtrl:i,beans:s,rowNode:n}=this,{gos:o,rangeSvc:l,eventSvc:d,editSvc:p}=s;if(d.dispatchEvent({type:"keyShortcutChangedCellStart"}),F9(e,o.get("enableCellEditingOnBackspace"))&&!p?.isEditing(i,{withOpenEditor:!0})){if(l&&ta(o))l.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(i.isCellEditable()){let{column:y}=i,C=this.beans.valueSvc.getDeleteValue(y,n);n.setDataValue(y,C,"cellClear")}}else p?.isEditing(i,{withOpenEditor:!0})||s.editSvc?.startEditing(i,{startedEdit:!0,event:t});d.dispatchEvent({type:"keyShortcutChangedCellEnd"})}onEnterKeyDown(e){let{cellCtrl:t,beans:i}=this,{editSvc:s,navigation:n}=i,o=s?.isEditing(t,{withOpenEditor:!0}),l=t.rowNode,d=s?.isRowEditing(l,{withOpenEditor:!0}),p=y=>{s?.startEditing(y,{startedEdit:!0,event:e,source:"edit"})&&e.preventDefault()};if(o||d){if(this.isCtrlEnter(e)){s?.applyBulkEdit(t,i?.rangeSvc?.getCellRanges()||[]);return}if(vc(i),s?.checkNavWithValidation(void 0,e)==="block-stop")return;s?.isEditing(t,{withOpenEditor:!0})?s?.stopEditing(t,{event:e,source:"edit"}):d&&!t.isCellEditable()?s?.stopEditing({rowNode:l},{event:e,source:"edit"}):p(t)}else if(i.gos.get("enterNavigatesVertically")){let y=e.shiftKey?Fe.UP:Fe.DOWN;n?.navigateToNextCell(null,y,t.cellPosition,!1)}else{if(s?.hasValidationErrors())return;s?.hasValidationErrors(t)&&s.revertSingleCellEdit(t,!0),p(t)}}isCtrlEnter(e){return(e.ctrlKey||e.metaKey)&&e.key===Fe.ENTER}onF2KeyDown(e){let{cellCtrl:t,beans:{editSvc:i}}=this;i?.isEditing()&&(vc(this.beans),i?.checkNavWithValidation(void 0,e)==="block-stop")||i?.startEditing(t,{startedEdit:!0,event:e})}onEscapeKeyDown(e){let{cellCtrl:t,beans:{editSvc:i}}=this;i?.checkNavWithValidation(t,e)==="block-stop"&&i.revertSingleCellEdit(t),i?.stopEditing(t,{event:e,cancel:!0})}processCharacter(e){let i=e.target!==this.eGui,{beans:{editSvc:s},cellCtrl:n}=this;if(i||s?.isEditing(n,{withOpenEditor:!0}))return;if(e.key===Fe.SPACE)this.onSpaceKeyDown(e);else if(s?.isCellEditable(n,"ui")){if(s?.hasValidationErrors()&&!s?.hasValidationErrors(n))return;s?.startEditing(n,{startedEdit:!0,event:e,source:"api"}),!n.editCompDetails?.params?.suppressPreventDefault&&e.preventDefault()}}onSpaceKeyDown(e){let{gos:t,editSvc:i}=this.beans,{rowNode:s}=this.cellCtrl;!i?.isEditing(this.cellCtrl,{withOpenEditor:!0})&&ac(t)&&this.beans.selectionSvc?.handleSelectionEvent(e,s,"spaceKey"),e.preventDefault()}},k9=class extends Be{constructor(e,t,i){super(),this.cellCtrl=e,this.column=i,this.beans=t}onMouseEvent(e,t){if(!ea(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t);break}}onCellClicked(e){if(this.beans.touchSvc?.handleCellDoubleClick(this,e))return;let{eventSvc:t,rangeSvc:i,editSvc:s,editModelSvc:n,frameworkOverrides:o,gos:l}=this.beans,d=e.ctrlKey||e.metaKey,{cellCtrl:p}=this,{column:y,cellPosition:C,rowNode:S}=p,P=Um(l,y,S,e);i&&d&&!P&&i.getCellRangeCount(C)>1&&i.intersectLastRange(!0);let I=p.createEvent(e,"cellClicked");I.isEventHandlingSuppressed=P,t.dispatchEvent(I);let O=y.getColDef();if(O.onCellClicked&&window.setTimeout(()=>{o.wrapOutgoing(()=>{O.onCellClicked(I)})},0),!P&&n?.getState(p)!=="editing"){let V=s?.isEditing(),G=n?.getCellValidationModel().getCellValidationMap().size??0,X=n?.getRowValidationModel().getRowValidationMap().size??0;if(V&&(G>0||X>0))return;s?.shouldStartEditing(p,e)?s?.startEditing(p,{event:e}):s?.shouldStopEditing(p,e)&&(this.beans.gos.get("editType")==="fullRow"?s?.stopEditing(p,{event:e,source:"edit"}):s?.stopEditing(void 0,{event:e,source:"edit"}))}}onCellDoubleClicked(e){let{column:t,beans:i,cellCtrl:s}=this,{eventSvc:n,frameworkOverrides:o,editSvc:l,editModelSvc:d,gos:p}=i,y=Um(p,s.column,s.rowNode,e),C=t.getColDef(),S=s.createEvent(e,"cellDoubleClicked");if(S.isEventHandlingSuppressed=y,n.dispatchEvent(S),typeof C.onCellDoubleClicked=="function"&&window.setTimeout(()=>{o.wrapOutgoing(()=>{C.onCellDoubleClicked(S)})},0),!y&&l?.shouldStartEditing(s,e)&&d?.getState(s)!=="editing"){let P=l?.isEditing(),I=d?.getCellValidationModel().getCellValidationMap().size??0,O=d?.getRowValidationModel().getRowValidationMap().size??0;if(P&&(I>0||O>0))return;l?.startEditing(s,{event:e})}}onMouseDown(e){let{ctrlKey:t,metaKey:i,shiftKey:s}=e,n=e.target,{cellCtrl:o,beans:l}=this,{eventSvc:d,rangeSvc:p,rowNumbersSvc:y,focusSvc:C,gos:S,editSvc:P}=l,{column:I,rowNode:O,cellPosition:V}=o,G=Um(S,I,O,e),X=()=>{let fe=o.createEvent(e,"cellMouseDown");fe.isEventHandlingSuppressed=G,d.dispatchEvent(fe)};if(G){X();return}if(this.isRightClickInExistingRange(e))return;let Q=p&&!p.isEmpty(),ae=this.containsWidget(n),me=el(I);if(y&&me&&!y.handleMouseDownOnCell(V,e)){p&&e.preventDefault(),e.stopImmediatePropagation();return}if(!s||!Q){let fe=P?.isEditing(o),Ae=S.get("enableCellTextSelection")&&e.defaultPrevented,Oe=(ll()||Ae)&&!fe&&!WC(n)&&!ae;o.focusCell(Oe,e)}if(s&&Q&&!C.isCellFocused(V)){e.preventDefault();let fe=C.getFocusedCell();if(fe){let{column:_e,rowIndex:Ae,rowPinned:Oe}=fe;P?.isEditing(fe)&&P?.stopEditing(fe),C.setFocusedCell({column:_e,rowIndex:Ae,rowPinned:Oe,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,sourceEvent:e})}}if(!ae){if(p){me&&e.preventDefault();let fe=WR(l,e)&&me;if(s)p.extendLatestRangeToCell(V);else if(!fe){let _e=t||i;p.setRangeToCell(V,_e)}}X()}}isRightClickInExistingRange(e){let{rangeSvc:t}=this.beans;if(t){let i=t.isCellInAnyRange(this.cellCtrl.cellPosition),s=WR(this.beans,e);if(i&&s)return!0}return!1}containsWidget(e){return rc(e,"ag-selection-checkbox",3)||rc(e,"ag-drag-handle",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;let{eventSvc:t,colHover:i}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),i?.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;let{eventSvc:t,colHover:i}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),i?.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;let t=this.cellCtrl.eGui,i=t.contains(e.target),s=t.contains(e.relatedTarget);return i&&s}},A9=class extends Be{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.column,this.rowNode=e.rowNode}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}init(){this.eSetLeft=this.cellCtrl.getRootElement(),this.eContent=this.cellCtrl.eGui;let e=this.cellCtrl.getCellSpan();if(e||(this.setupColSpan(),this.setupRowSpan()),this.onLeftChanged(),this.onWidthChanged(),e||this._legacyApplyRowSpan(),e){let t=this.refreshSpanHeight.bind(this,e);t(),this.addManagedListeners(this.beans.eventSvc,{paginationChanged:t,recalculateRowBounds:t,pinnedHeightChanged:t})}}refreshSpanHeight(e){let t=e.getCellHeight();t!=null&&(this.eContent.style.height=`${t}px`)}onNewColumnsLoaded(){let e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this._legacyApplyRowSpan(!0))}onDisplayColumnsChanged(){let e=this.getColSpanningList();rl(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eContent)return;let e=this.getCellWidth();this.eContent.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){let{column:e,rowNode:t}=this,i=e.getColSpan(t),s=[];if(i===1)s.push(e);else{let n=e,o=e.getPinned();for(let l=0;n&&l<i&&(s.push(n),n=this.beans.visibleCols.getColAfter(n),!(!n||Di(n)||o!==n.getPinned()));l++);}return s}onLeftChanged(){if(!this.eSetLeft)return;let e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eSetLeft.style.left=e+"px"}getCellLeft(){let e;return this.beans.gos.get("enableRtl")&&this.colsSpanning?e=di(this.colsSpanning):e=this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.printLayout||this.column.getPinned()==="left")return e;let{visibleCols:t}=this.beans,i=t.getColsLeftWidth();if(this.column.getPinned()==="right"){let s=t.bodyWidth;return i+s+(e||0)}return i+(e||0)}_legacyApplyRowSpan(e){if(this.rowSpan===1&&!e)return;let i=lc(this.beans)*this.rowSpan;this.eContent.style.height=`${i}px`,this.eContent.style.zIndex="1"}destroy(){super.destroy()}},L9="ag-cell",O9="ag-cell-auto-height",z9="ag-cell-normal-height",B9="ag-cell-focus",V9="ag-cell-first-right-pinned",H9="ag-cell-last-left-pinned",N9="ag-cell-not-inline-editing",G9="ag-cell-wrap-text",W9=0,Ru=class extends Be{constructor(e,t,i,s){super(),this.column=e,this.rowNode=t,this.rowCtrl=s,this.rangeFeature=void 0,this.rowResizeFeature=void 0,this.positionFeature=void 0,this.customStyleFeature=void 0,this.editStyleFeature=void 0,this.mouseListener=void 0,this.keyboardListener=void 0,this.suppressRefreshCell=!1,this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.focusEventWhileNotReady=null,this.hasBeenFocused=!1,this.hasEdit=!1,this.tooltipFeature=void 0,this.editorTooltipFeature=void 0,this.beans=i,this.gos=i.gos,this.editSvc=i.editSvc,this.hasEdit=!!i.editSvc;let{colId:n}=e;this.instanceId=n+"-"+W9++,this.createCellPosition(),this.updateAndFormatValue(!1)}addFeatures(){let{beans:e}=this;this.positionFeature=new A9(this,e),this.customStyleFeature=e.cellStyles?.createCellCustomStyleFeature(this,e),this.editStyleFeature=e.editSvc?.createCellStyleFeature(this,e),this.mouseListener=new k9(this,e,this.column),this.keyboardListener=new I9(this,e,this.rowNode,this.rowCtrl),this.enableTooltipFeature();let{rangeSvc:t}=e;t&&ta(e.gos)&&(this.rangeFeature=t.createCellRangeFeature(e,this)),el(this.column)&&(this.rowResizeFeature=this.beans.rowNumbersSvc.createRowNumbersRowResizerFeature(e,this))}isCellSpanning(){return!1}getCellSpan(){}removeFeatures(){let e=this.beans.context;this.positionFeature=e.destroyBean(this.positionFeature),this.editorTooltipFeature=e.destroyBean(this.editorTooltipFeature),this.customStyleFeature=e.destroyBean(this.customStyleFeature),this.editStyleFeature=e.destroyBean(this.editStyleFeature),this.mouseListener=e.destroyBean(this.mouseListener),this.keyboardListener=e.destroyBean(this.keyboardListener),this.rangeFeature=e.destroyBean(this.rangeFeature),this.rowResizeFeature=e.destroyBean(this.rowResizeFeature),this.disableTooltipFeature()}enableTooltipFeature(e,t){this.tooltipFeature=this.beans.tooltipSvc?.enableCellTooltipFeature(this,e,t)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}enableEditorTooltipFeature(e){this.editorTooltipFeature&&this.disableEditorTooltipFeature(),this.editorTooltipFeature=this.beans.tooltipSvc?.setupCellEditorTooltip(this,e),vc(this.beans)}disableEditorTooltipFeature(){this.editorTooltipFeature=this.beans.context.destroyBean(this.editorTooltipFeature)}setComp(e,t,i,s,n,o,l){this.comp=e,this.eGui=t,this.printLayout=n,l??(l=this),this.addDomData(l),this.addFeatures(),l.addDestroyFunc(()=>this.removeFeatures()),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.setupFocus(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(s,l),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),this.positionFeature?.init(),this.customStyleFeature?.setComp(e),this.editStyleFeature?.setComp(e),this.tooltipFeature?.refreshTooltip(),this.keyboardListener?.init(),this.rangeFeature?.setComp(e),this.rowResizeFeature?.refreshRowResizer(),o&&this.isCellEditable()||this.hasEdit&&this.editSvc?.isEditing(this,{withOpenEditor:!0})?this.editSvc?.startEditing(this,{startedEdit:!1,source:"api",silent:!0,continueEditing:!0}):this.showValue(!1,!0),this.onCompAttachedFuncs.length&&(this.onCompAttachedFuncs.forEach(d=>d()),this.onCompAttachedFuncs=[])}setupAutoHeight(e,t){this.isAutoHeight=this.beans.rowAutoHeight?.setupCellAutoHeight(this,e,t)??!1}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){let e=this.column.getColDef();return e.cellRenderer!=null||e.cellRendererSelector!=null}getValueToDisplay(){return this.valueFormatted??this.value}getDeferLoadingCellRenderer(){let{beans:e,column:t}=this,{userCompFactory:i,ctrlsSvc:s,eventSvc:n}=e,o=t.getColDef(),l=this.createCellRendererParams();l.deferRender=!0;let d=XR(i,o,l);if(s.getGridBodyCtrl()?.scrollFeature?.isScrolling()){let p,y=new Ui(C=>{p=C});return this.addManagedListeners(n,{bodyScrollEnd:()=>p()}),{loadingComp:d,onReady:y}}return{loadingComp:d,onReady:Ui.resolve()}}showValue(e,t){let{beans:i,column:s,rowNode:n,rangeFeature:o}=this,{userCompFactory:l}=i,d=this.getValueToDisplay(),p,y=n.stub&&n.groupData?.[s.getId()]==null,C=s.getColDef();if(y||this.isCellRenderer()){let S=this.createCellRendererParams();!y||el(s)?p=KR(l,C,S):p=XR(l,C,S)}if(!p&&!y&&i.findSvc?.isMatch(n,s)){let S=this.createCellRendererParams();p=KR(l,ht(Se({},s.getColDef()),{cellRenderer:"agFindCellRenderer"}),S)}if(this.hasEdit&&this.editSvc.isBatchEditing()&&this.editSvc.isRowEditing(n,{checkSiblings:!0})){let S=this.editSvc.prepDetailsDuringBatch(this,{compDetails:p,valueToDisplay:d});S&&(S.compDetails?p=S.compDetails:S.valueToDisplay&&(d=S.valueToDisplay))}this.comp.setRenderDetails(p,d,e),this.customRowDragComp?.refreshVisibility(),!t&&o&&sa(i,()=>o?.refreshHandle()),this.rowResizeFeature?.refreshRowResizer()}setupControlComps(){let e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e),!0),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.comp.setIncludeSelection(this.includeSelection),this.comp.setIncludeDndSource(this.includeDndSource),this.comp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(e,t=!1){return(this.rowNode.rowPinned==null||t&&hg(this.rowNode))&&!!e}isCheckboxSelection(e){let{rowSelection:t,groupDisplayType:i}=this.beans.gridOptions,s=iv(t),n=al(this.column);return i==="custom"&&s!=="selectionColumn"&&n?!1:e.checkboxSelection||n&&typeof t=="object"&&yu(t)}refreshShouldDestroy(){let e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e),!0),i=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),s=this.includeDndSource!=this.isIncludeControl(e.dndSource),n=this.isAutoHeight!=this.column.isAutoHeight();return t||i||s||n}onPopupEditorClosed(){let{editSvc:e}=this.beans;e?.isEditing(this,{withOpenEditor:!0})&&e?.stopEditing(this,{source:e?.isBatchEditing()?"ui":"api"})}stopEditing(e=!1){let{editSvc:t}=this.beans;return t?.stopEditing(this,{cancel:e,source:t?.isBatchEditing()?"ui":"api"})??!1}createCellRendererParams(){let{value:e,valueFormatted:t,column:i,rowNode:s,comp:n,eGui:o,beans:{valueSvc:l,gos:d,editSvc:p}}=this;return bt(d,{value:e,valueFormatted:t,getValue:()=>l.getValueForDisplay(i,s).value,setValue:C=>p?.setDataValue({rowNode:s,column:i},C)||s.setDataValue(i,C),formatValue:this.formatValue.bind(this),data:s.data,node:s,pinned:i.getPinned(),colDef:i.getColDef(),column:i,refreshCell:this.refreshCell.bind(this),eGridCell:o,eParentOfValue:n.getParentOfValue(),registerRowDragger:(C,S,P,I)=>this.registerRowDragger(C,S,I),setTooltip:(C,S)=>{d.assertModuleRegistered("Tooltip",3),this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(C,S),this.tooltipFeature?.refreshTooltip()}})}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){if(this.refreshShouldDestroy()?this.rowCtrl?.recreateCell(this):this.refreshCell(e),this.hasEdit&&this.editCompDetails){let{editSvc:t,comp:i}=this;!i?.getCellEditor()&&t.isEditing(this,{withOpenEditor:!0})&&t.startEditing(this,{startedEdit:!1,source:"api",silent:!0})}}refreshCell({force:e,suppressFlash:t,newData:i}={}){if(this.suppressRefreshCell)return;let s=this.column.getColDef(),n=s.field==null&&s.valueGetter==null&&s.showRowGroup==null,o=e||n||i,l=!!this.comp,d=this.updateAndFormatValue(l),p=o||d;if(l){if(p){this.showValue(!!i,!1);let y=this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering();!t&&!y&&s.enableCellChangeFlash&&this.beans.cellFlashSvc?.flashCell(this),this.editStyleFeature?.applyCellStyles?.(),this.customStyleFeature?.applyUserStyles(),this.customStyleFeature?.applyClassesFromColDef()}this.tooltipFeature?.refreshTooltip(),this.customStyleFeature?.applyCellClassRules()}}isCellEditable(){return this.column.isCellEditable(this.rowNode)}formatValue(e){return this.callValueFormatter(e)??e}callValueFormatter(e){return this.beans.valueSvc.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){let t=this.value,i=this.valueFormatted,{value:s,valueFormatted:n}=this.beans.valueSvc.getValueForDisplay(this.column,this.rowNode,!0);return this.value=s,this.valueFormatted=n,e?!this.valuesAreEqual(t,this.value)||this.valueFormatted!=i:!0}valuesAreEqual(e,t){let i=this.column.getColDef();return i.equals?i.equals(e,t):e===t}addDomData(e){let t=this.eGui;pc(this.beans.gos,t,hv,this),e.addDestroyFunc(()=>pc(this.beans.gos,t,hv,null))}createEvent(e,t){let{rowNode:i,column:s,value:n,beans:o}=this;return D9(o,e,t,{rowNode:i,column:s},n)}processCharacter(e){this.keyboardListener?.processCharacter(e)}onKeyDown(e){this.keyboardListener?.onKeyDown(e)}onMouseEvent(e,t){this.mouseListener?.onMouseEvent(e,t)}getColSpanningList(){return this.positionFeature?.getColSpanningList()??[]}onLeftChanged(){this.comp&&this.positionFeature?.onLeftChanged()}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){let{comp:e,column:t,beans:i}=this;AM(e,t,i.visibleCols)}refreshAriaColIndex(){let e=this.beans.visibleCols.getAriaColIndex(this.column);nP(this.eGui,e)}onWidthChanged(){return this.positionFeature?.onWidthChanged()}getRowPosition(){let{rowIndex:e,rowPinned:t}=this.cellPosition;return{rowIndex:e,rowPinned:t}}updateRangeBordersIfRangeCount(){this.comp&&this.rangeFeature?.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){this.comp&&this.rangeFeature?.onCellSelectionChanged()}isRangeSelectionEnabled(){return this.rangeFeature!=null}focusCell(e=!1,t){let i=this.editSvc?.allowedFocusTargetOnValidation(this);i&&i!==this||this.beans.focusSvc.setFocusedCell(ht(Se({},this.getFocusedCellPosition()),{forceBrowserFocus:e,sourceEvent:t}))}restoreFocus(e=!1){let{beans:{editSvc:t,focusSvc:i},comp:s}=this;if(!s||t?.isEditing(this)||!this.isCellFocused()||!i.shouldTakeFocus())return;let n=()=>{if(!this.isAlive())return;let o=s.getFocusableElement();this.isCellFocused()&&o.focus({preventScroll:!0})};if(e){setTimeout(n,0);return}n()}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.restoreFocus(),this.rangeFeature?.onCellSelectionChanged(),this.rowResizeFeature?.refreshRowResizer()}onSuppressCellFocusChanged(e){let t=this.eGui;t&&(el(this.column)&&(e=!0),zo(t,"tabindex",e?void 0:-1))}onFirstRightPinnedChanged(){if(!this.comp)return;let e=this.column.isFirstRightPinned();this.comp.toggleCss(V9,e)}onLastLeftPinnedChanged(){if(!this.comp)return;let e=this.column.isLastLeftPinned();this.comp.toggleCss(H9,e)}checkCellFocused(){return this.beans.focusSvc.isCellFocused(this.cellPosition)}isCellFocused(){let e=this.checkCellFocused();return this.hasBeenFocused||(this.hasBeenFocused=e),e}setupFocus(){this.restoreFocus(!0),this.onCellFocused(this.focusEventWhileNotReady??void 0)}onCellFocused(e){let{beans:t}=this;if(_v(t))return;if(!this.comp){e&&(this.focusEventWhileNotReady=e);return}let i=this.isCellFocused(),s=t.editSvc?.isEditing(this)??!1;if(this.comp.toggleCss(B9,i),i&&e&&e.forceBrowserFocus){let n=this.comp.getFocusableElement();if(s){let o=Cu(n,null,!0);o.length&&(n=o[0])}n.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}i&&this.rowCtrl.announceDescription()}createCellPosition(){let{rowIndex:e,rowPinned:t}=this.rowNode;this.cellPosition={rowIndex:e,rowPinned:Qr(t),column:this.column}}applyStaticCssClasses(){let{comp:e}=this;e.toggleCss(L9,!0),e.toggleCss(N9,!0);let t=this.column.isAutoHeight()==!0;e.toggleCss(O9,t),e.toggleCss(z9,!t)}onColumnHover(){this.beans.colHover?.onCellColumnHover(this.column,this.comp)}onColDefChanged(){this.comp&&(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editSvc?.isEditing(this)?this.editSvc?.handleColDefChanged(this):this.refreshOrDestroyCell({force:!0,suppressFlash:!0}))}setWrapText(){let e=this.column.getColDef().wrapText==!0;this.comp.toggleCss(G9,e)}dispatchCellContextMenuEvent(e){let t=this.column.getColDef(),i=this.createEvent(e,"cellContextMenu"),{beans:s}=this;s.eventSvc.dispatchEvent(i),t.onCellContextMenu&&window.setTimeout(()=>{s.frameworkOverrides.wrapOutgoing(()=>{t.onCellContextMenu(i)})},0)}getCellRenderer(){return this.comp?.getCellRenderer()??null}destroy(){this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.isCellFocused()&&this.hasBrowserFocus()&&this.beans.focusSvc.attemptToRecoverFocus(),super.destroy()}hasBrowserFocus(){return this.eGui?.contains(zi(this.beans))??!1}createSelectionCheckbox(){let e=this.beans.selectionSvc?.createCheckboxSelectionComponent();if(e)return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){let e=this.beans.registry.createDynamicBean("dndSourceComp",!1,this.rowNode,this.column,this.eGui);return e&&this.beans.context.createBean(e),e}registerRowDragger(e,t,i){if(this.customRowDragComp){this.customRowDragComp.setDragElement(e,t);return}let s=this.createRowDragComp(e,t,i);s&&(this.customRowDragComp=s,this.addDestroyFunc(()=>{this.beans.context.destroyBean(s),this.customRowDragComp=null}),s.refreshVisibility())}createRowDragComp(e,t,i){let s=this.beans.rowDragSvc?.createRowDragCompForCell(this.rowNode,this.column,()=>this.value,e,t,i);if(s)return this.beans.context.createBean(s),s}cellEditorAttached(){this.onEditorAttachedFuncs.forEach(e=>e()),this.onEditorAttachedFuncs=[]}setFocusedCellPosition(e){}getFocusedCellPosition(){return this.cellPosition}refreshAriaRowIndex(){}getRootElement(){return this.eGui}};function Eb(e,t,i,s,n,o){if(i==null&&t==null)return;let l={},d={},p=(y,C)=>{y.split(" ").forEach(S=>{S.trim()!=""&&C(S)})};if(i){let y=Object.keys(i);for(let C=0;C<y.length;C++){let S=y[C],P=i[S],I;typeof P=="string"?I=e?e.evaluate(P,s):!0:typeof P=="function"&&(I=P(s)),p(S,O=>{I?l[O]=!0:d[O]=!0})}}t&&o&&Object.keys(t).forEach(y=>p(y,C=>{l[C]||(d[C]=!0)})),o&&Object.keys(d).forEach(o),Object.keys(l).forEach(n)}function VE(e){if(e.group)return e.level;let t=e.parent;return t?t.level+1:0}var U9=class extends Be{constructor(){super(...arguments),this.beanName="rowStyleSvc"}processClassesFromGridOptions(e,t){let i=this.gos,s=l=>{typeof l=="string"?e.push(l):Array.isArray(l)&&l.forEach(d=>e.push(d))},n=i.get("rowClass");n&&s(n);let o=i.getCallback("getRowClass");if(o){let l={data:t.data,node:t,rowIndex:t.rowIndex},d=o(l);s(d)}}preProcessRowClassRules(e,t){this.processRowClassRules(t,i=>{e.push(i)},()=>{})}processRowClassRules(e,t,i){let{gos:s,expressionSvc:n}=this.beans,o=bt(s,{data:e.data,node:e,rowIndex:e.rowIndex});Eb(n,void 0,s.get("rowClassRules"),o,t,i)}processStylesFromGridOptions(e){let t=this.gos,i=t.get("rowStyle"),s=t.getCallback("getRowStyle"),n;if(s){let o={data:e.data,node:e,rowIndex:e.rowIndex};n=s(o)}if(n||i)return Object.assign({},i,n)}},j9=0,fv=class extends Be{constructor(e,t,i,s,n){super(),this.rowNode=e,this.useAnimationFrameForCreate=s,this.printLayout=n,this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKey=null,this.beans=t,this.gos=t.gos,this.paginationPage=t.pagination?.getCurrentPage()??0,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+j9++,this.rowId=Op(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusSvc.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=VE(this.rowNode),this.setRowType(),this.setAnimateFlags(i),this.rowStyles=this.processStylesFromGridOptions(),this.rowEditStyleFeature=t.editSvc?.createRowStyleFeature(this,t),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;let e=this.businessKeyForNodeFunc(this.rowNode);this.businessKey=Op(e)}updateGui(e,t){e==="left"?this.leftGui=t:e==="right"?this.rightGui=t:e==="fullWidth"?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,i,s){let{context:n,focusSvc:o}=this.beans;s=rg(this,n,s);let l={rowComp:e,element:t,containerType:i,compBean:s};this.allRowGuis.push(l),this.updateGui(i,l),this.initialiseRowComp(l);let d=this.rowNode,p=this.rowType==="FullWidthLoading"||d.stub,y=!d.data&&this.beans.rowModel.getType()==="infinite";!p&&!y&&!d.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent();let C=this.fullWidthGui?.element;C&&!this.beans.editSvc?.isEditing(this)&&o.isRowFocused(d.rowIndex,d.rowPinned)&&o.shouldTakeFocus()&&setTimeout(()=>C.focus({preventScroll:!0}),0)}unsetComp(e){this.allRowGuis=this.allRowGuis.filter(t=>t.containerType!==e),this.updateGui(e,void 0)}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(e){let t=e?"none":"";this.allRowGuis.forEach(i=>i.element.style.display=t)}initialiseRowComp(e){let t=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(!1,e),ac(t)&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);let i=e.rowComp;this.getInitialRowClasses(e.containerType).forEach(n=>i.toggleCss(n,!0)),this.executeSlideAndFadeAnimations(e),this.rowNode.group&&lC(e.element,this.rowNode.expanded==!0),this.setRowCompRowId(i),this.setRowCompRowBusinessKey(i),pc(t,e.element,uv,this),e.compBean.addDestroyFunc(()=>pc(t,e.element,uv,null)),this.useAnimationFrameForCreate?this.beans.animationFrameSvc.createTask(this.addHoverFunctionality.bind(this,e),this.rowNode.rowIndex,"p2",!1):this.addHoverFunctionality(e),this.isFullWidth()&&this.setupFullWidth(e),t.get("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameSvc.addDestroyTask(()=>{this.isAlive()&&e.rowComp.toggleCss("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){this.businessKey!=null&&e.setRowBusinessKey(this.businessKey)}setRowCompRowId(e){let t=Op(this.rowNode.id);this.rowId=t,t!=null&&e.setRowId(t)}executeSlideAndFadeAnimations(e){let{containerType:t}=e;this.slideInAnimation[t]&&(cC(()=>{this.onTopChanged()}),this.slideInAnimation[t]=!1),this.fadeInAnimation[t]&&(cC(()=>{e.rowComp.toggleCss("ag-opacity-zero",!1)}),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){let t=this.beans.rowDragSvc?.createRowDragCompForRow(this.rowNode,e.element);if(!t)return;let i=this.createBean(t,this.beans.context);this.rowDragComps.push(i),e.compBean.addDestroyFunc(()=>{this.rowDragComps=this.rowDragComps.filter(s=>s!==i),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,this.beans.context),this.destroyBean(i,this.beans.context)})}setupFullWidth(e){let t=this.getPinnedForContainer(e.containerType),i=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(i)}getFullWidthCellRenderers(){return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(e=>e?.rowComp?.getFullWidthCellRenderer()):[this.fullWidthGui?.rowComp?.getFullWidthCellRenderer()]}executeProcessRowPostCreateFunc(){let e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;let t={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};e(t)}areAllContainersReady(){let{leftGui:e,centerGui:t,rightGui:i,beans:{visibleCols:s}}=this,n=!!e||!s.isPinningLeft(),o=!!t,l=!!i||!s.isPinningRight();return n&&o&&l}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;let e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this.rowNode}):!1}setRowType(){let e=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow")&&!this.gos.get("groupHideOpenParents"),t=this.isNodeFullWidthCell(),i=this.gos.get("masterDetail")&&this.rowNode.detail,s=this.beans.colModel.isPivotMode(),n=DP(this.gos,this.rowNode,s);e?this.rowType="FullWidthLoading":i?this.rowType="FullWidthDetail":t?this.rowType="FullWidth":n?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(e=!1,t=!1){if(this.isFullWidth())return;let{animationFrameSvc:i}=this.beans;if(!i?.active||e||this.printLayout){this.updateColumnListsImpl(t);return}this.updateColumnListsPending||(i.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"p1",!1),this.updateColumnListsPending=!0)}getNewCellCtrl(e){if(!this.beans.rowSpanSvc?.isCellSpanning(e,this.rowNode))return new Ru(e,this.rowNode,this.beans,this)}isCorrectCtrlForSpan(e){return!this.beans.rowSpanSvc?.isCellSpanning(e.column,this.rowNode)}createCellCtrls(e,t,i=null){let s={list:[],map:{}},n=(y,C,S)=>{S!=null?s.list.splice(S,0,C):s.list.push(C),s.map[y]=C},o=[];for(let y of t){let C=y.getInstanceId(),S=e.map[C];S&&!this.isCorrectCtrlForSpan(S)&&(S.destroy(),S=void 0),S||(S=this.getNewCellCtrl(y)),S&&n(C,S)}for(let y of e.list){let C=y.column.getInstanceId();if(s.map[C]!=null)continue;!this.isCellEligibleToBeRemoved(y,i)?o.push([C,y]):y.destroy()}if(o.length)for(let[y,C]of o){let S=s.list.findIndex(I=>I.column.getLeft()>C.column.getLeft()),P=S===-1?void 0:Math.max(S-1,0);n(y,C,P)}let{focusSvc:l,visibleCols:d}=this.beans,p=l.getFocusedCell();if(p&&p.column.getPinned()==i){let y=p.column.getInstanceId();if(!s.map[y]&&d.allCols.includes(p.column)){let S=this.createFocusedCellCtrl();if(S){let P=s.list.findIndex(O=>O.column.getLeft()>S.column.getLeft()),I=P===-1?void 0:Math.max(P-1,0);n(y,S,I)}}}return s}createFocusedCellCtrl(){let{focusSvc:e,rowSpanSvc:t}=this.beans,i=e.getFocusedCell();if(!i)return;let s=t?.getCellSpan(i.column,this.rowNode);if(s){if(s.firstNode!==this.rowNode||!s.doesSpanContain(i))return}else if(!e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned))return;return this.getNewCellCtrl(i.column)}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){this.allRowGuis.forEach(t=>{let i=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(i,e)})}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){let e=this.beans.colViewport,t=this.beans.visibleCols;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.allCols),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{let i=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,i);let s=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,s,"left");let n=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,n,"right")}}isCellEligibleToBeRemoved(e,t){let{column:n}=e;if(n.getPinned()!=t||!this.isCorrectCtrlForSpan(e))return!0;let{visibleCols:o,editSvc:l}=this.beans,d=l?.isEditing(e),p=e.isCellFocused();return d||p?!(o.allCols.indexOf(n)>=0):!0}getDomOrder(){return this.gos.get("ensureDomOrder")||Gs(this.gos,"print")}listenOnDomOrder(e){let t=()=>{e.rowComp.setDomOrder(this.getDomOrder())};e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],t)}setAnimateFlags(e){if(this.rowNode.sticky||!e)return;let t=st(this.rowNode.oldRowTop),{visibleCols:i}=this.beans,s=i.isPinningLeft(),n=i.isPinningRight();if(t){let{slideInAnimation:o}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){o.fullWidth=!0;return}o.center=!0,o.left=s,o.right=n}else{let{fadeInAnimation:o}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){o.fullWidth=!0;return}o.center=!0,o.left=s,o.right=n}}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){let e=(l,d)=>l?l.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(l.element,d).params):!0,t=e(this.fullWidthGui,null),i=e(this.centerGui,null),s=e(this.leftGui,"left"),n=e(this.rightGui,"right");return t&&i&&s&&n}addListeners(){let{beans:e,gos:t,rowNode:i}=this,{expansionSvc:s,eventSvc:n,context:o,rowSpanSvc:l}=e;this.addManagedListeners(this.rowNode,Se({heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this)},s?.getRowExpandedListeners(this)??{})),i.detail&&this.addManagedListeners(i.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(i,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this),rowPinned:this.onRowPinned.bind(this)}),this.addManagedListeners(n,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),l&&this.addManagedListeners(l,{spannedCellsUpdated:({pinned:d})=>{d&&!i.rowPinned||this.updateColumnLists()}}),this.addDestroyFunc(()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,o),this.tooltipFeature=this.destroyBean(this.tooltipFeature,o),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,o)}),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",()=>{if(t.get("rowDragEntireRow")){this.allRowGuis.forEach(p=>{this.addRowDraggerToRow(p)});return}this.rowDragComps=this.destroyBeans(this.rowDragComps,o)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>this.getAllCellCtrls().forEach(e=>e.onRowIndexChanged()),cellChanged:e=>this.getAllCellCtrls().forEach(t=>t.onCellChanged(e))})}onRowPinned(){for(let e of this.allRowGuis)e.rowComp.toggleCss("ag-row-pinned-source",!!this.rowNode.pinnedSibling)}onRowNodeDataChanged(e){this.refreshRow({suppressFlash:!e.update,newData:!e.update})}refreshRow(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}this.getAllCellCtrls().forEach(i=>i.refreshCell(e)),this.allRowGuis.forEach(i=>{this.setRowCompRowId(i.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(i.rowComp)}),this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.rowEditStyleFeature?.applyRowStyles(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){let e=this.beans.rowDropHighlightSvc,t=e?.row===this.rowNode?e.position:"none",i=t==="above",s=t==="inside",n=t==="below",l=this.gos.get("treeData")&&(n||i),d=this.rowNode.uiLevel.toString();this.allRowGuis.forEach(p=>{let y=p.rowComp;y.toggleCss("ag-row-highlight-above",i),y.toggleCss("ag-row-highlight-inside",s),y.toggleCss("ag-row-highlight-below",n),y.toggleCss("ag-row-highlight-indent",l),l?p.element.style.setProperty("--ag-row-highlight-level",d):p.element.style.removeProperty("--ag-row-highlight-level")})}postProcessRowDragging(){let e=this.rowNode.dragging;this.allRowGuis.forEach(t=>t.rowComp.toggleCss("ag-row-dragging",e))}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.rowAutoHeight?.requestCheckAutoHeight()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:Qr(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(e){let t=this.findFullWidthInfoForEvent(e);if(!t)return;let{rowGui:i,column:s}=t;if(!(i.element===e.target))return;let l=this.rowNode,{focusSvc:d,navigation:p}=this.beans,y=d.getFocusedCell(),C={rowIndex:l.rowIndex,rowPinned:l.rowPinned,column:y?.column??s};p?.navigateToNextCell(e,e.key,C,!0),e.preventDefault()}onTabKeyDown(e){if(e.defaultPrevented||ea(e))return;let t=this.allRowGuis.find(d=>d.element.contains(e.target)),i=t?t.element:null,s=i===e.target,n=zi(this.beans),o=!1;i&&n&&(o=i.contains(n)&&n.classList.contains("ag-cell"));let l=null;!s&&!o&&(l=Cc(this.beans,i,!1,e.shiftKey)),(this.isFullWidth()&&s||!l)&&this.beans.navigation?.onTabKeyDown(this,e)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){let e=this.allRowGuis.find(t=>ur(t.element))?.element;return e?e.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){let t=this.isFullWidth()&&e?void 0:this.gos.get("tabIndex");this.allRowGuis.forEach(i=>{zo(i.element,"tabindex",t)})}onFullWidthRowFocused(e){let t=this.rowNode,i=e?this.isFullWidth()&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned:!1,s;if(this.fullWidthGui)s=this.fullWidthGui.element;else{let o=this.beans.colModel.getCol(e?.column)?.pinned;o?s=o==="right"?this.rightGui?.element:this.leftGui?.element:s=this.centerGui?.element}s&&(s.classList.toggle("ag-full-width-focus",i),i&&e?.forceBrowserFocus&&s.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){let i={list:[],map:{}};return e.list.forEach(s=>{s!==t&&(i.list.push(s),i.map[s.column.getInstanceId()]=s)}),i}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t);break}}createRowEvent(e,t){let{rowNode:i}=this;return bt(this.gos,{type:e,node:i,data:i.data,rowIndex:i.rowIndex,rowPinned:i.rowPinned,event:t})}createRowEventWithSource(e,t){let i=this.createRowEvent(e,t);return i.source=this,i}onRowDblClick(e){if(ea(e))return;let t=this.createRowEventWithSource("rowDoubleClicked",e);t.isEventHandlingSuppressed=this.isSuppressMouseEvent(e),this.beans.eventSvc.dispatchEvent(t)}findFullWidthInfoForEvent(e){if(!e)return;let t=this.findFullWidthRowGui(e.target),i=this.getColumnForFullWidth(t);if(!(!t||!i))return{rowGui:t,column:i}}findFullWidthRowGui(e){return this.allRowGuis.find(t=>t.element.contains(e))}getColumnForFullWidth(e){let{visibleCols:t}=this.beans;switch(e?.containerType){case"center":return t.centerCols[0];case"left":return t.leftCols[0];case"right":return t.rightCols[0];default:return t.allCols[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=rc(e.target,"ag-row-drag",3),!this.isFullWidth()||this.isSuppressMouseEvent(e))return;let{rangeSvc:t,focusSvc:i}=this.beans;t?.removeAllCellRanges();let s=this.findFullWidthInfoForEvent(e);if(!s)return;let{rowGui:n,column:o}=s,l=n.element,d=e.target,p=this.rowNode,y=e.defaultPrevented||ll();l&&l.contains(d)&&WC(d)&&(y=!1),i.setFocusedCell({rowIndex:p.rowIndex,column:o,rowPinned:p.rowPinned,forceBrowserFocus:y})}isSuppressMouseEvent(e){let{gos:t,rowNode:i}=this;if(this.isFullWidth()){let n=this.findFullWidthRowGui(e.target);return yV(t,n?.rowComp.getFullWidthCellRendererParams(),i,e)}let s=db(t,e.target);return s!=null&&Um(t,s.column,i,e)}onRowClick(e){if(ea(e)||this.lastMouseDownOnDragger)return;let i=this.isSuppressMouseEvent(e),{eventSvc:s,selectionSvc:n}=this.beans,o=this.createRowEventWithSource("rowClicked",e);o.isEventHandlingSuppressed=i,s.dispatchEvent(o),!i&&n?.handleSelectionEvent(e,this.rowNode,"rowClicked")}setupDetailRowAutoHeight(e){this.rowType==="FullWidthDetail"&&this.beans.masterDetailSvc?.setupDetailRowAutoHeight(this,e)}createFullWidthCompDetails(e,t){let{gos:i,rowNode:s}=this,n=bt(i,{fullWidth:!0,data:s.data,node:s,value:s.key,valueFormatted:s.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(l,d,p,y)=>this.addFullWidthRowDragging(l,d,p,y),setTooltip:(l,d)=>{i.assertModuleRegistered("Tooltip",3),this.setupFullWidthRowTooltip(l,d)}}),o=this.beans.userCompFactory;switch(this.rowType){case"FullWidthDetail":return E5(o,n);case"FullWidthGroup":{let{value:l,valueFormatted:d}=this.beans.valueSvc.getValueForDisplay(void 0,this.rowNode,!0);return n.value=l,n.valueFormatted=d,R5(o,n)}case"FullWidthLoading":return S5(o,n);default:return _5(o,n)}}setupFullWidthRowTooltip(e,t){this.fullWidthGui&&(this.tooltipFeature=this.beans.tooltipSvc?.setupFullWidthRowTooltip(this.tooltipFeature,this,e,t))}addFullWidthRowDragging(e,t,i="",s){let{rowDragSvc:n,context:o}=this.beans;if(!n||!this.isFullWidth())return;let l=n.createRowDragComp(()=>i,this.rowNode,void 0,e,t,s);this.createBean(l,o),this.addDestroyFunc(()=>{this.destroyBean(l,o)})}onUiLevelChanged(){let e=VE(this.rowNode);if(this.rowLevel!=e){let t="ag-row-level-"+e,i="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach(s=>{s.rowComp.toggleCss(t,!0),s.rowComp.toggleCss(i,!1)})}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getLastRow()}refreshFirstAndLastRowStyles(){let e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();this.firstRowOnPage!==e&&(this.firstRowOnPage=e,this.allRowGuis.forEach(i=>i.rowComp.toggleCss("ag-row-first",e))),this.lastRowOnPage!==t&&(this.lastRowOnPage=t,this.allRowGuis.forEach(i=>i.rowComp.toggleCss("ag-row-last",t)))}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){let e=[];this.beans.rowStyleSvc?.processClassesFromGridOptions(e,this.rowNode),e.length&&e.forEach(t=>{this.allRowGuis.forEach(i=>i.rowComp.toggleCss(t,!0))})}postProcessRowClassRules(){this.beans.rowStyleSvc?.processRowClassRules(this.rowNode,e=>{this.allRowGuis.forEach(t=>t.rowComp.toggleCss(e,!0))},e=>{this.allRowGuis.forEach(t=>t.rowComp.toggleCss(e,!1))})}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,i=>i.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(e){return e==="left"||e==="right"?e:null}getInitialRowClasses(e){let t=this.getPinnedForContainer(e),i=this.isFullWidth(),{rowNode:s,beans:n}=this,o=[];o.push("ag-row"),o.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeInAnimation[e]&&o.push("ag-opacity-zero"),o.push(s.rowIndex%2===0?"ag-row-even":"ag-row-odd"),s.isRowPinned()&&(o.push("ag-row-pinned"),n.pinnedRowModel?.isManual()&&o.push("ag-row-pinned-manual")),!s.isRowPinned()&&s.pinnedSibling&&o.push("ag-row-pinned-source"),s.isSelected()&&o.push("ag-row-selected"),s.footer&&o.push("ag-row-footer"),o.push("ag-row-level-"+this.rowLevel),s.stub&&o.push("ag-row-loading"),i&&o.push("ag-full-width-row"),n.expansionSvc?.addExpandedCss(o,s),s.dragging&&o.push("ag-row-dragging");let{rowStyleSvc:l}=n;return l&&(l.processClassesFromGridOptions(o,s),l.preProcessRowClassRules(o,s)),o.push(this.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),this.isFirstRowOnPage()&&o.push("ag-row-first"),this.isLastRowOnPage()&&o.push("ag-row-last"),i&&(t==="left"&&o.push("ag-cell-last-left-pinned"),t==="right"&&o.push("ag-cell-first-right-pinned")),o}processStylesFromGridOptions(){return this.beans.rowStyleSvc?.processStylesFromGridOptions(this.rowNode)??this.emptyStyle}onRowSelected(e){this.beans.selectionSvc?.onRowCtrlSelected(this,t=>{(t===this.centerGui||t===this.fullWidthGui)&&this.announceDescription()},e)}announceDescription(){this.beans.selectionSvc?.announceAriaRowSelection(this.rowNode)}addHoverFunctionality(e){if(!this.active)return;let{element:t,compBean:i}=e,{rowNode:s,beans:n,gos:o}=this;i.addManagedListeners(t,{pointerenter:l=>{l.pointerType==="mouse"&&s.dispatchRowEvent("mouseEnter")},pointerleave:l=>{l.pointerType==="mouse"&&s.dispatchRowEvent("mouseLeave")}}),i.addManagedListeners(s,{mouseEnter:()=>{!n.dragSvc?.dragging&&!o.get("suppressRowHoverHighlight")&&(t.classList.add("ag-row-hover"),s.setHovered(!0))},mouseLeave:()=>{this.resetHoveredStatus(t)}})}resetHoveredStatus(e){let t=e?[e]:this.allRowGuis.map(i=>i.element);for(let i of t)i.classList.remove("ag-row-hover");this.rowNode.setHovered(!1)}roundRowTopToBounds(e){let t=this.beans.ctrlsSvc.getScrollFeature().getApproximateVScollPosition(),i=this.applyPaginationOffset(t.top,!0)-100,s=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(i,e),s)}forEachGui(e,t){e?t(e):this.allRowGuis.forEach(t)}isRowRendered(){return this.allRowGuis.length>0}onRowHeightChanged(e){if(this.rowNode.rowHeight==null)return;let t=this.rowNode.rowHeight,i=this.beans.environment.getDefaultRowHeight(),n=RP(this.gos)?sl(this.beans,this.rowNode).height:void 0,o=n?`${Math.min(i,n)-2}px`:void 0;this.forEachGui(e,l=>{l.element.style.height=`${t}px`,o&&l.element.style.setProperty("--ag-line-height",o)})}destroyFirstPass(e=!1){this.active=!1;let{rowNode:t}=this;if(!e&&vu(this.gos)&&!t.sticky)if(t.rowTop!=null){let n=this.roundRowTopToBounds(t.rowTop);this.setRowTop(n)}else this.allRowGuis.forEach(n=>n.rowComp.toggleCss("ag-opacity-zero",!0));this.fullWidthGui?.element.contains(zi(this.beans))&&this.beans.focusSvc.attemptToRecoverFocus(),t.setHovered(!1);let i=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(i),this.beans.eventSvc.dispatchEvent(i),super.destroy()}destroySecondPass(){this.allRowGuis.length=0;let e=t=>(t.list.forEach(i=>i.destroy()),{list:[],map:{}});this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,t=>{t.rowComp.toggleCss("ag-row-focus",this.rowFocused),t.rowComp.toggleCss("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){let{focusSvc:e}=this.beans,t=e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses())}onPaginationChanged(){let e=this.beans.pagination?.getCurrentPage()??0;this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e,t=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;let i=this.beans.pageBounds.getPixelOffset();return e+i*(t?1:-1)}setRowTop(e){if(!this.printLayout&&st(e)){let t=this.applyPaginationOffset(e),n=`${this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeight.getRealPixelPosition(t)}px`;this.setRowTopStyle(n)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";let t=this.rowNode,i;if(t.sticky)i=t.stickyRowTop;else{let s=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,n=this.applyPaginationOffset(s);i=t.isRowPinned()?n:this.beans.rowContainerHeight.getRealPixelPosition(n)}return i+"px"}setRowTopStyle(e){this.allRowGuis.forEach(t=>this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform(`translateY(${e})`))}getCellCtrl(e,t=!1){let i=null;return this.getAllCellCtrls().forEach(s=>{s.column==e&&(i=s)}),i!=null||t||this.getAllCellCtrls().forEach(s=>{s?.getColSpanningList().indexOf(e)>=0&&(i=s)}),i}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(e){let t=this.rowNode.getRowIndexString();if(t===null)return;let i=(this.beans.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.beans.filterManager?.getHeaderRowCount()??0),s=this.rowNode.rowIndex%2===0,n=i+this.rowNode.rowIndex+1;this.forEachGui(e,o=>{o.rowComp.setRowIndex(t),o.rowComp.toggleCss("ag-row-even",s),o.rowComp.toggleCss("ag-row-odd",!s),Xm(o.element,n)})}},$9=class extends Be{constructor(){super(),this.beanName="navigation",this.onPageDown=BR(this.onPageDown,100),this.onPageUp=BR(this.onPageUp,100)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){let i=e.key,s=e.altKey,n=e.ctrlKey||e.metaKey,o=!!this.beans.rangeSvc&&e.shiftKey,l=UV(this.gos,e),d=!1;switch(i){case Fe.PAGE_HOME:case Fe.PAGE_END:!n&&!s&&(this.onHomeOrEndKey(i),d=!0);break;case Fe.LEFT:case Fe.RIGHT:case Fe.UP:case Fe.DOWN:if(!l)return!1;n&&!s&&!o&&(this.onCtrlUpDownLeftRight(i,l),d=!0);break;case Fe.PAGE_DOWN:case Fe.PAGE_UP:!n&&!s&&(d=this.handlePageUpDown(i,l,t));break}return d&&e.preventDefault(),d}handlePageUpDown(e,t,i){return i&&(t=this.beans.focusSvc.getFocusedCell()),t?(e===Fe.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0):!1}navigateTo({scrollIndex:e,scrollType:t,scrollColumn:i,focusIndex:s,focusColumn:n,isAsync:o,rowPinned:l}){let{scrollFeature:d}=this.gridBodyCon;st(i)&&!i.isPinned()&&d.ensureColumnVisible(i),st(e)&&d.ensureIndexVisible(e,t),o||d.ensureIndexVisible(s);let{focusSvc:p,rangeSvc:y}=this.beans;p.setFocusedCell({rowIndex:s,column:n,rowPinned:l,forceBrowserFocus:!0}),y?.setRangeToCell({rowIndex:s,rowPinned:l,column:n})}onPageDown(e){let t=this.beans,i=tC(t),s=this.getViewportHeight(),{pageBounds:n,rowModel:o,rowAutoHeight:l}=t,d=n.getPixelOffset(),p=i.top+s,y=o.getRowIndexAtPixel(p+d);l?.active?this.navigateToNextPageWithAutoHeight(e,y):this.navigateToNextPage(e,y)}onPageUp(e){let t=this.beans,i=tC(t),{pageBounds:s,rowModel:n,rowAutoHeight:o}=t,l=s.getPixelOffset(),d=i.top,p=n.getRowIndexAtPixel(d+l);o?.active?this.navigateToNextPageWithAutoHeight(e,p,!0):this.navigateToNextPage(e,p,!0)}navigateToNextPage(e,t,i=!1){let{pageBounds:s,rowModel:n}=this.beans,o=this.getViewportHeight(),l=s.getFirstRow(),d=s.getLastRow(),p=s.getPixelOffset(),y=n.getRow(e.rowIndex),C=i?y?.rowHeight-o-p:o-p,S=y?.rowTop+C,P=n.getRowIndexAtPixel(S+p);if(P===e.rowIndex){let O=i?-1:1;t=P=e.rowIndex+O}let I;i?(I="bottom",P<l&&(P=l),t<l&&(t=l)):(I="top",P>d&&(P=d),t>d&&(t=d)),this.isRowTallerThanView(n.getRow(P))&&(t=P,I="top"),this.navigateTo({scrollIndex:t,scrollType:I,scrollColumn:null,focusIndex:P,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,i=!1){this.navigateTo({scrollIndex:t,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{let s=this.getNextFocusIndexForAutoHeight(e,i);this.navigateTo({scrollIndex:t,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:s,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){let i=t?-1:1,s=this.getViewportHeight(),{pageBounds:n,rowModel:o}=this.beans,l=n.getLastRow(),d=0,p=e.rowIndex;for(;p>=0&&p<=l;){let y=o.getRow(p);if(y){let C=y.rowHeight??0;if(d+C>s)break;d+=C}p+=i}return Math.max(0,Math.min(p,l))}getViewportHeight(){let e=this.beans,t=tC(e),i=this.beans.scrollVisibleSvc.getScrollbarWidth(),s=t.bottom-t.top;return e.ctrlsSvc.get("center").isHorizontalScrollShowing()&&(s-=i),s}isRowTallerThanView(e){if(!e)return!1;let t=e.rowHeight;return typeof t!="number"?!1:t>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){let i=this.beans.cellNavigation.getNextCellToFocus(e,t,!0),s=this.getNormalisedPosition(i),{rowIndex:n,rowPinned:o,column:l}=s??i,d=l;this.navigateTo({scrollIndex:n,scrollType:null,scrollColumn:d,focusIndex:n,focusColumn:d,rowPinned:o})}onHomeOrEndKey(e){let t=e===Fe.PAGE_HOME,{visibleCols:i,pageBounds:s,rowModel:n}=this.beans,o=i.allCols,l=t?s.getFirstRow():s.getLastRow(),d=n.getRow(l);if(!d)return;let p=(t?o:[...o].reverse()).find(y=>!y.isSuppressNavigable(d));p&&this.navigateTo({scrollIndex:l,scrollType:null,scrollColumn:p,focusIndex:l,focusColumn:p})}onTabKeyDown(e,t){let i=t.shiftKey,s=this.tabToNextCellCommon(e,i,t),n=this.beans,{ctrlsSvc:o,pageBounds:l,focusSvc:d,gos:p}=n;if(s!==!1){s?t.preventDefault():s===null&&o.get("gridCtrl").allowFocusForNextCoreContainer(i);return}if(i){let{rowIndex:y,rowPinned:C}=e.getRowPosition();(C?y===0:y===l.getFirstRow())&&(p.get("headerHeight")===0||hc(n)?Du(n,!0,!0):(t.preventDefault(),d.focusPreviousFromFirstCell(t)))}else e instanceof Ru&&e.focusCell(!0),(!i&&d.focusOverlay(!1)||Du(n,i))&&t.preventDefault()}tabToNextCell(e,t){let i=this.beans,{focusSvc:s,rowRenderer:n}=i,o=s.getFocusedCell();if(!o)return!1;let l=gu(i,o);return!l&&(l=n.getRowByPosition(o),!l||!l.isFullWidth())?!1:!!this.tabToNextCellCommon(l,e,t,"api")}tabToNextCellCommon(e,t,i,s="ui"){let{editSvc:n,focusSvc:o}=this.beans,l,d=e instanceof Ru?e:e.getAllCellCtrls()?.[0];return n?.isEditing()?l=n?.moveToNextCell(d,t,i,s):l=this.moveToNextCellNotEditing(e,t,i),l===null?l:l||!!o.focusedHeader}moveToNextCellNotEditing(e,t,i){let s=this.beans.visibleCols.allCols,n;if(e instanceof fv){if(n=ht(Se({},e.getRowPosition()),{column:t?s[0]:di(s)}),this.gos.get("embedFullWidthRows")&&i){let l=e.findFullWidthInfoForEvent(i);l&&(n.column=l.column)}}else n=e.getFocusedCellPosition();let o=this.findNextCellToFocusOn(n,{backwards:t,startEditing:!1});if(o===!1)return null;if(o instanceof Ru)o.focusCell(!0);else if(o)return this.tryToFocusFullWidthRow(o,t);return st(o)}findNextCellToFocusOn(e,{backwards:t,startEditing:i,skipToNextEditableCell:s}){let n=e,o=this.beans,{cellNavigation:l,gos:d,focusSvc:p,rowRenderer:y,rangeSvc:C}=o;for(;;){e!==n&&(e=n),t||(n=this.getLastCellOfColSpan(n)),n=l.getNextTabbedCell(n,t);let S=d.getCallback("tabToNextCell");if(st(S)){let V=S({backwards:t,editing:i,previousCellPosition:e,nextCellPosition:n||null});if(V===!0)n=e;else{if(V===!1)return!1;n={rowIndex:V.rowIndex,column:V.column,rowPinned:V.rowPinned}}}if(!n)return null;if(n.rowIndex<0){let O=ar(o);return p.focusHeaderPosition({headerPosition:{headerRowIndex:O+n.rowIndex,column:n.column},fromCell:!0}),null}let P=d.get("editType")==="fullRow";if(i&&(!P||s)&&!this.isCellEditable(n))continue;this.ensureCellVisible(n);let I=gu(o,n);if(!I){let O=y.getRowByPosition(n);if(!O||!O.isFullWidth()||i)continue;return ht(Se({},O.getRowPosition()),{column:n?.column})}if(!l.isSuppressNavigable(I.column,I.rowNode))return I.setFocusedCellPosition(n),C?.setRangeToCell(n),I}}isCellEditable(e){let t=this.lookupRowNodeForCell(e);return t?e.column.isCellEditable(t):!1}lookupRowNodeForCell({rowIndex:e,rowPinned:t}){let{pinnedRowModel:i,rowModel:s}=this.beans;return t==="top"?i?.getPinnedTopRow(e):t==="bottom"?i?.getPinnedBottomRow(e):s.getRow(e)}navigateToNextCell(e,t,i,s){let n=i,o=!1,l=this.beans,{cellNavigation:d,focusSvc:p,gos:y}=l;for(;n&&(n===i||!this.isValidNavigateCell(n));)y.get("enableRtl")?t===Fe.LEFT&&(n=this.getLastCellOfColSpan(n)):t===Fe.RIGHT&&(n=this.getLastCellOfColSpan(n)),n=d.getNextCellToFocus(t,n),o=Di(n);if(o&&e&&e.key===Fe.UP&&(n={rowIndex:-1,rowPinned:null,column:i.column}),s){let S=y.getCallback("navigateToNextCell");if(st(S)){let I=S({key:t,previousCellPosition:i,nextCellPosition:n||null,event:e});st(I)?n={rowPinned:I.rowPinned,rowIndex:I.rowIndex,column:I.column}:n=null}}if(!n)return;if(n.rowIndex<0){let S=ar(l);p.focusHeaderPosition({headerPosition:{headerRowIndex:S+n.rowIndex,column:i.column},event:e||void 0,fromCell:!0});return}let C=this.getNormalisedPosition(n);C?this.focusPosition(C):this.tryToFocusFullWidthRow(n)}getNormalisedPosition(e){if(!!this.beans.spannedRowRenderer?.getCellByPosition(e))return e;this.ensureCellVisible(e);let i=gu(this.beans,e);return i?(e=i.getFocusedCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){let{visibleCols:i,rowRenderer:s,focusSvc:n,eventSvc:o}=this.beans,l=i.allCols,d=s.getRowByPosition(e);if(!d||!d.isFullWidth())return!1;let p=n.getFocusedCell(),y={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?di(l):l[0])};this.focusPosition(y);let C=t??(p!=null&&LN(y,p));return o.dispatchEvent({type:"fullWidthRowFocused",rowIndex:y.rowIndex,rowPinned:y.rowPinned,column:y.column,isFullWidthCell:!0,fromBelow:C}),!0}focusPosition(e){let{focusSvc:t,rangeSvc:i}=this.beans;t.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),i?.setRangeToCell(e)}isValidNavigateCell(e){return!!ia(this.beans,e)}getLastCellOfColSpan(e){let t=gu(this.beans,e);if(!t)return e;let i=t.getColSpanningList();return i.length===1?e:{rowIndex:e.rowIndex,column:di(i),rowPinned:e.rowPinned}}ensureCellVisible(e){let t=PP(this.gos),i=this.beans.rowModel.getRow(e.rowIndex),s=t&&i?.sticky,{scrollFeature:n}=this.gridBodyCon;!s&&Di(e.rowPinned)&&n.ensureIndexVisible(e.rowIndex),e.column.isPinned()||n.ensureColumnVisible(e.column)}ensureColumnVisible(e){let t=this.gridBodyCon.scrollFeature;e.isPinned()||t.ensureColumnVisible(e)}ensureRowVisible(e){this.gridBodyCon.scrollFeature.ensureIndexVisible(e)}};function tC(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}var q9={moduleName:"KeyboardNavigation",version:nt,beans:[$9,f9,PW],apiFunctions:{getFocusedCell:m9,clearFocusedCell:v9,setFocusedCell:y9,setFocusedHeader:b9,tabToNextCell:w9,tabToPreviousCell:C9}},Z9=class extends Be{constructor(){super(...arguments),this.beanName="pageBoundsListener"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages(),this.eventSvc.dispatchEvent({type:"paginationChanged",animate:e?.animate??!1,newData:e?.newData??!1,newPage:e?.newPage??!1,newPageSize:e?.newPageSize??!1,keepRenderedRows:e?.keepRenderedRows??!1})}calculatePages(){let{pageBounds:e,pagination:t,rowModel:i}=this.beans;t?t.calculatePages():e.calculateBounds(0,i.getRowCount()-1)}},K9=class extends Be{constructor(){super(...arguments),this.beanName="pageBounds",this.pixelOffset=0}getFirstRow(){return this.topRowBounds?.rowIndex??-1}getLastRow(){return this.bottomRowBounds?.rowIndex??-1}getCurrentPageHeight(){let{topRowBounds:e,bottomRowBounds:t}=this;return!e||!t?0:Math.max(t.rowTop+t.rowHeight-e.rowTop,0)}getCurrentPagePixelRange(){let{topRowBounds:e,bottomRowBounds:t}=this,i=e?.rowTop??0,s=t?t.rowTop+t.rowHeight:0;return{pageFirstPixel:i,pageLastPixel:s}}calculateBounds(e,t){let{rowModel:i}=this.beans,s=i.getRowBounds(e);s&&(s.rowIndex=e),this.topRowBounds=s;let n=i.getRowBounds(t);n&&(n.rowIndex=t),this.bottomRowBounds=n,this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){let e=this.topRowBounds?.rowTop??0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventSvc.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},X9=".ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top{min-width:0;overflow:hidden;position:relative}.ag-pinned-left-sticky-top,.ag-pinned-right-sticky-top{height:100%;overflow:hidden;position:relative}.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{height:100%;overflow:hidden;width:100%}.ag-pinned-left-header,.ag-pinned-right-header{display:inline-block;height:100%;overflow:hidden;position:relative}.ag-body-horizontal-scroll:not(.ag-scrollbar-invisible){.ag-horizontal-left-spacer:not(.ag-scroller-corner){border-right:var(--ag-pinned-column-border)}.ag-horizontal-right-spacer:not(.ag-scroller-corner){border-left:var(--ag-pinned-column-border)}}.ag-pinned-right-header{border-left:var(--ag-pinned-column-border)}.ag-pinned-left-header{border-right:var(--ag-pinned-column-border)}.ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-left:var(--ag-pinned-column-border)}.ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-right:var(--ag-pinned-column-border)}.ag-pinned-left-header .ag-header-cell-resize:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}.ag-pinned-right-header .ag-header-cell-resize:after{left:50%}.ag-pinned-left-header .ag-header-cell-resize{right:-3px}.ag-pinned-right-header .ag-header-cell-resize{left:-3px}",Y9=class extends Be{constructor(e,t){super(),this.isLeft=e,this.elements=t,this.getWidth=e?()=>this.beans.pinnedCols.leftWidth:()=>this.beans.pinnedCols.rightWidth}postConstruct(){this.addManagedEventListeners({[`${this.isLeft?"left":"right"}PinnedWidthChanged`]:this.onPinnedWidthChanged.bind(this)})}onPinnedWidthChanged(){let e=this.getWidth(),t=e>0;for(let i of this.elements)i&&(Ti(i,t),lr(i,e))}},Q9=class extends Be{constructor(){super(...arguments),this.beanName="pinnedCols"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridBodyCtrl=t.gridBodyCtrl});let e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){let{gos:e,visibleCols:t,eventSvc:i}=this.beans,s=Gs(e,"print"),n=s?0:t.getColsLeftWidth(),o=s?0:t.getDisplayedColumnsRightWidth();n!=this.leftWidth&&(this.leftWidth=n,i.dispatchEvent({type:"leftPinnedWidthChanged"})),o!=this.rightWidth&&(this.rightWidth=o,i.dispatchEvent({type:"rightPinnedWidthChanged"}))}keepPinnedColumnsNarrowerThanViewport(){let e=this.gridBodyCtrl.eBodyViewport,t=qp(e);if(t<=50)return;let i=this.getPinnedColumnsOverflowingViewport(t-50),s=this.gos.getCallback("processUnpinnedColumns"),{columns:n,hasLockedPinned:o}=i,l=n;!l.length&&!o||(s&&(l=s({columns:l,viewportWidth:t})),!(!l||!l.length)&&(l=l.filter(d=>!el(d)),this.setColsPinned(l,null,"viewportSizeFeature")))}createPinnedWidthFeature(e,...t){return new Y9(e,t)}setColsPinned(e,t,i){let{colModel:s,colAnimation:n,visibleCols:o,gos:l}=this.beans;if(!s.cols||!e?.length)return;if(Gs(l,"print")){je(37);return}n?.start();let d;t===!0||t==="left"?d="left":t==="right"?d="right":d=null;let p=[];e.forEach(y=>{if(!y)return;let C=s.getCol(y);C&&C.getPinned()!==d&&(this.setColPinned(C,d),p.push(C))}),p.length&&(o.refresh(i),$P(this.eventSvc,p,i)),n?.finish()}initCol(e){let{pinned:t,initialPinned:i}=e.colDef;t!==void 0?this.setColPinned(e,t):this.setColPinned(e,i)}setColPinned(e,t){t===!0||t==="left"?e.pinned="left":t==="right"?e.pinned="right":e.pinned=null,e.dispatchStateUpdatedEvent("pinned")}setupHeaderPinnedWidth(e){let{scrollVisibleSvc:t}=this.beans;if(e.pinned==null)return;let i=e.pinned==="left",s=e.pinned==="right";e.hidden=!0;let n=()=>{let o=i?this.leftWidth:this.rightWidth;if(o==null)return;let l=o==0,d=e.hidden!==l,p=this.gos.get("enableRtl"),y=t.getScrollbarWidth(),S=t.verticalScrollShowing&&(p&&i||!p&&s)?o+y:o;e.comp.setPinnedContainerWidth(`${S}px`),e.comp.setDisplayed(!l),d&&(e.hidden=l,e.refresh())};e.addManagedEventListeners({leftPinnedWidthChanged:n,rightPinnedWidthChanged:n,scrollVisibilityChanged:n,scrollbarWidthChanged:n})}getHeaderResizeDiff(e,t){if(t.getPinned()){let{leftWidth:s,rightWidth:n}=this,o=qp(this.beans.ctrlsSvc.getGridBodyCtrl().eBodyViewport)-50;if(s+n+e>o)if(o>s+n)e=o-s-n;else return 0}return e}getPinnedColumnsOverflowingViewport(e){let t=this.rightWidth??0,i=this.leftWidth??0,s=t+i,n=!1;if(s<e)return{columns:[],hasLockedPinned:n};let{visibleCols:o}=this.beans,l=[...o.leftCols],d=[...o.rightCols],p=0,y=0,C=0,S=[],P=s-C-e;for(;(y<l.length||p<d.length)&&P>0;){if(p<d.length){let I=d[p++];if(I.colDef.lockPinned){n=!0;continue}P-=I.getActualWidth(),S.push(I)}if(y<l.length&&P>0){let I=l[y++];if(I.colDef.lockPinned){n=!0;continue}P-=I.getActualWidth(),S.push(I)}}return{columns:S,hasLockedPinned:n}}},J9={moduleName:"PinnedColumn",version:nt,beans:[Q9],css:[X9]},eU=class extends Be{constructor(){super(),this.beanName="ariaAnnounce",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.lastAnnouncement="",this.updateAnnouncement=Hs(this,this.updateAnnouncement.bind(this),200)}postConstruct(){let e=this.beans,t=Vs(e),i=this.descriptionContainer=t.createElement("div");i.classList.add("ag-aria-description-container"),sP(i,"polite"),E4(i,"additions text"),R4(i,!0),e.eGridDiv.appendChild(i)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;let e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout(()=>{this.handleAnnouncementUpdate(e)},50)}handleAnnouncementUpdate(e){if(!this.isAlive()||!this.descriptionContainer)return;let t=e;if(t==null||t.replace(/[ .]/g,"")==""){this.lastAnnouncement="";return}this.lastAnnouncement===t&&(t=`${t}\u200B`),this.lastAnnouncement=t,this.descriptionContainer.textContent=t}destroy(){super.destroy();let{descriptionContainer:e}=this;e&&(Ns(e),e.parentElement?.removeChild(e)),this.descriptionContainer=null,this.pendingAnnouncements.clear()}},tU={moduleName:"Aria",version:nt,beans:[eU]},iU=":where(.ag-delay-render){.ag-cell,.ag-header-cell,.ag-header-group-cell,.ag-row,.ag-spanned-cell-wrapper{visibility:hidden}}",HE="ag-delay-render",sU=class extends Be{constructor(){super(...arguments),this.beanName="colDelayRenderSvc",this.hideRequested=!1,this.alreadyRevealed=!1,this.timesRetried=0,this.requesters=new Set}hideColumns(e){this.alreadyRevealed||this.requesters.has(e)||(this.requesters.add(e),this.hideRequested||(this.beans.ctrlsSvc.whenReady(this,t=>{t.gridBodyCtrl.eGridBody.classList.add(HE)}),this.hideRequested=!0))}revealColumns(e){if(this.alreadyRevealed||!this.isAlive()||(this.requesters.delete(e),this.requesters.size>0))return;let{renderStatus:t,ctrlsSvc:i}=this.beans;if(t){if(!t.areHeaderCellsRendered()&&this.timesRetried<5){this.timesRetried++,setTimeout(()=>this.revealColumns(e));return}this.timesRetried=0}i.getGridBodyCtrl().eGridBody.classList.remove(HE),this.alreadyRevealed=!0}},oU={moduleName:"ColumnDelayRender",version:nt,beans:[sU],css:[iU]};function nU(e){e.overlays?.showLoadingOverlay()}function rU(e){e.overlays?.showNoRowsOverlay()}function aU(e){e.overlays?.hideOverlay()}var lU=".ag-overlay{inset:0;pointer-events:none;position:absolute;z-index:2}.ag-overlay-panel,.ag-overlay-wrapper{display:flex;height:100%;width:100%}.ag-overlay-wrapper{align-items:center;flex:none;justify-content:center;text-align:center}.ag-overlay-loading-wrapper{pointer-events:all}.ag-overlay-loading-center{background:var(--ag-background-color);border:solid var(--ag-border-width) var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-popup-shadow);padding:var(--ag-spacing)}",cU={tag:"div",cls:"ag-overlay",role:"presentation",children:[{tag:"div",cls:"ag-overlay-panel",role:"presentation",children:[{tag:"div",ref:"eOverlayWrapper",cls:"ag-overlay-wrapper",role:"presentation"}]}]},CT=class extends ii{constructor(){super(cU),this.eOverlayWrapper=ot,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeCssClass=null,this.elToFocusAfter=null,this.registerCSS(lU)}handleKeyDown(e){if(e.key!==Fe.TAB||e.defaultPrevented||ea(e))return;let t=this.beans;if(Cc(t,this.eOverlayWrapper,!1,e.shiftKey))return;let s=!1;e.shiftKey?s=t.focusSvc.focusGridView({column:di(t.visibleCols.allCols),backwards:!0,canFocusOverlay:!1}):s=Du(t,!1),s&&e.preventDefault()}updateLayoutClasses(e,t){let i=this.eOverlayWrapper.classList,{AUTO_HEIGHT:s,NORMAL:n,PRINT:o}=xn;i.toggle(s,t.autoHeight),i.toggle(n,t.normal),i.toggle(o,t.print)}postConstruct(){this.createManagedBean(new hb(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.beans.overlays.setOverlayWrapperComp(this),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}setWrapperTypeClass(e){let t=this.eOverlayWrapper.classList;this.activeCssClass&&t.toggle(this.activeCssClass,!1),this.activeCssClass=e,t.toggle(e,!0)}showOverlay(e,t,i,s){if(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,!!e){if(this.setDisplayed(!0,{skipAriaHidden:!0}),i&&this.isGridFocused()){let n=zi(this.beans);n&&!JE(this.beans)&&(this.elToFocusAfter=n)}e.then(n=>{if(this.activePromise!==e){this.activeOverlay!==n&&(this.destroyBean(n),n=null);return}if(this.activePromise=null,!!n){if(this.activeOverlay!==n&&(this.eOverlayWrapper.appendChild(n.getGui()),this.activeOverlay=n,s)){let o=n;this.updateListenerDestroyFunc=this.addManagedPropertyListener(s,({currentValue:l})=>{o.refresh?.(bt(this.gos,Se({},l??{})))})}i&&this.isGridFocused()&&gc(this.eOverlayWrapper)}})}}updateOverlayWrapperPaddingTop(e){this.eOverlayWrapper.style.setProperty("padding-top",`${e}px`)}destroyActiveOverlay(){this.activePromise=null;let e=this.activeOverlay;if(!e)return;let t=this.elToFocusAfter;this.activeOverlay=null,this.elToFocusAfter=null,t&&!this.isGridFocused()&&(t=null);let i=this.updateListenerDestroyFunc;i&&(i(),this.updateListenerDestroyFunc=null),this.destroyBean(e),Ns(this.eOverlayWrapper),t?.focus?.({preventScroll:!0})}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}isGridFocused(){let e=zi(this.beans);return!!e&&this.beans.eGridDiv.contains(e)}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.beans.overlays.setOverlayWrapperComp(void 0),super.destroy()}},hU={selector:"AG-OVERLAY-WRAPPER",component:CT},uU=class extends Be{constructor(){super(...arguments),this.beanName="overlays",this.state=0,this.showInitialOverlay=!0,this.wrapperPadding=0}postConstruct(){this.isClientSide=Ms(this.gos),this.isServerSide=!this.isClientSide&&ku(this.gos);let e=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e,gridSizeChanged:this.refreshWrapperPadding.bind(this),rowCountReady:()=>{this.showInitialOverlay=!1,this.updateOverlayVisibility()}}),this.addManagedPropertyListener("loading",e)}setOverlayWrapperComp(e){this.eWrapper=e,this.updateOverlayVisibility()}isVisible(){return this.state!==0&&!!this.eWrapper}isExclusive(){return this.state===1&&!!this.eWrapper}showLoadingOverlay(){this.showInitialOverlay=!1;let e=this.gos,t=e.get("loading");!t&&(t!==void 0||e.get("suppressLoadingOverlay"))||this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1;let e=this.gos;e.get("loading")||e.get("suppressNoRowsOverlay")||this.doShowNoRowsOverlay()}hideOverlay(){if(this.showInitialOverlay=!1,this.gos.get("loading")){je(99);return}this.doHideOverlay()}getOverlayWrapperSelector(){return hU}getOverlayWrapperCompClass(){return CT}updateOverlayVisibility(){if(!this.eWrapper){this.state=0;return}let{state:e,isClientSide:t,isServerSide:i,beans:{gos:s,colModel:n,rowModel:o}}=this,l=this.gos.get("loading");l!==void 0&&(this.showInitialOverlay=!1),this.showInitialOverlay&&l===void 0&&!s.get("suppressLoadingOverlay")&&(l=!s.get("columnDefs")||!n.ready||!s.get("rowData")&&t),l?e!==1&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,t&&o.isEmpty()&&!s.get("suppressNoRowsOverlay")?e!==2&&this.doShowNoRowsOverlay():(e===1||!i&&e!==0)&&this.doHideOverlay())}doShowLoadingOverlay(){this.eWrapper&&(this.state=1,this.showOverlay(T5(this.beans.userCompFactory,bt(this.gos,{})),"ag-overlay-loading-wrapper","loadingOverlayComponentParams"),this.updateExclusive())}doShowNoRowsOverlay(){this.eWrapper&&(this.state=2,this.showOverlay(D5(this.beans.userCompFactory,bt(this.gos,{})),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams"),this.updateExclusive())}doHideOverlay(){this.eWrapper&&(this.state=0,this.eWrapper.hideOverlay(),this.updateExclusive())}showOverlay(e,t,i){let s=e?.newAgStackInstance()??null;this.eWrapper?.showOverlay(s,t,this.isExclusive(),i),this.refreshWrapperPadding()}updateExclusive(){let e=this.exclusive;this.exclusive=this.isExclusive(),this.exclusive!==e&&this.eventSvc.dispatchEvent({type:"overlayExclusiveChanged"})}refreshWrapperPadding(){let e=this.eWrapper;if(!e)return;let t=0;this.state===2?t=this.beans.ctrlsSvc.get("gridHeaderCtrl")?.headerHeight||0:this.wrapperPadding!==0&&(t=0),this.wrapperPadding!==t&&(this.wrapperPadding=t,e.updateOverlayWrapperPaddingTop(t))}},dU={moduleName:"Overlay",version:nt,userComponents:{agLoadingOverlay:CH,agNoRowsOverlay:xH},apiFunctions:{showLoadingOverlay:nU,showNoRowsOverlay:rU,hideOverlay:aU},beans:[uU]},pU=class extends Be{constructor(){super(...arguments),this.beanName="rowContainerHeight",this.scrollY=0,this.uiBodyHeight=0}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=A5(),il(this.gos,"RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}updateOffset(){if(!this.stretching)return;let e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;let e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;il(this.gos,`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventSvc.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){let t=typeof e=="number"?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventSvc.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=e!=null&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){let e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;let t=this.modelHeight-this.getUiBodyHeight(),i=e/t;return this.maxScrollY*i}},gU=400,fU=class extends Be{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{let e=()=>{this.getAllCellCtrls().forEach(o=>o.onCellSelectionChanged())},t=()=>{this.getAllCellCtrls().forEach(o=>o.updateRangeBordersIfRangeCount())},i=()=>{this.eventSvc.addListener("cellSelectionChanged",e),this.eventSvc.addListener("columnMoved",t),this.eventSvc.addListener("columnPinned",t),this.eventSvc.addListener("columnVisible",t)},s=()=>{this.eventSvc.removeListener("cellSelectionChanged",e),this.eventSvc.removeListener("columnMoved",t),this.eventSvc.removeListener("columnPinned",t),this.eventSvc.removeListener("columnVisible",t)};this.addDestroyFunc(()=>s()),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{ta(this.gos)?i():s()}),ta(this.gos)&&i()}}wireBeans(e){this.pageBounds=e.pageBounds,this.colModel=e.colModel,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusSvc=e.focusSvc,this.rowContainerHeight=e.rowContainerHeight,this.ctrlsSvc=e.ctrlsSvc,this.editSvc=e.editSvc}postConstruct(){this.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),pinnedRowsChanged:this.onPinnedRowsChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListener("suppressCellFocus",s=>this.onSuppressCellFocusChanged(s.currentValue)),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.addManagedPropertyListener("cellSelection",({currentValue:s,previousValue:n})=>{(!n&&s||n&&!s)&&this.redrawRows()});let{stickyRowSvc:e,gos:t,showRowGroupCols:i}=this.beans;if(i&&this.addManagedPropertyListener("showOpenedGroup",()=>{let s=i.getShowRowGroupCols();s.length&&this.refreshCells({columns:s,force:!0})}),e)this.stickyRowFeature=e.createStickyRowFeature(this,this.createRowCon.bind(this),this.destroyRowCtrls.bind(this));else{let s=this.gridBodyCtrl;s.setStickyTopHeight(0),s.setStickyBottomHeight(0)}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=Gs(t,"print"),this.embedFullWidthRows=this.printLayout||t.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){let e=this.getKeepDetailRowsCount(),t=e??3;this.cachedRowCtrls=new mU(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?.stickyTopRowCtrls??[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?.stickyBottomRowCtrls??[]}updateAllRowCtrls(){let e=Object.values(this.rowCtrlsByRowIndex),t=Object.values(this.zombieRowCtrls),i=this.cachedRowCtrls?.getEntries()??[];t.length>0||i.length>0?this.allRowCtrls=[...e,...t,...i]:this.allRowCtrls=e}isCellBeingRendered(e,t){let i=this.rowCtrlsByRowIndex[e];return!t||!i?!!i:i.isFullWidth()?!0:!!this.beans.spannedRowRenderer?.getCellByPosition({rowIndex:e,column:t,rowPinned:null})||!!i.getCellCtrl(t)||!i.isRowRendered()}updateCellFocus(e){this.getAllCellCtrls().forEach(t=>t.onCellFocused(e)),this.getFullWidthRowCtrls().forEach(t=>t.onFullWidthRowFocused(e))}onCellFocusChanged(e){if(e&&e.rowIndex!=null&&!e.rowPinned){let t=this.beans.colModel.getCol(e.column)??void 0;this.isCellBeingRendered(e.rowIndex,t)||this.redraw()}this.updateCellFocus(e)}onSuppressCellFocusChanged(e){this.getAllCellCtrls().forEach(t=>t.onSuppressCellFocusChanged(e)),this.getFullWidthRowCtrls().forEach(t=>t.onSuppressCellFocusChanged(e))}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>this.onCellFocusChanged(e),cellFocusCleared:()=>this.updateCellFocus(),flashCells:e=>{let{cellFlashSvc:t}=this.beans;t&&this.getAllCellCtrls().forEach(i=>t.onFlashCells(i,e))},columnHoverChanged:()=>{this.getAllCellCtrls().forEach(e=>e.onColumnHover())},displayedColumnsChanged:()=>{this.getAllCellCtrls().forEach(e=>e.onDisplayedColumnsChanged())},displayedColumnsWidthChanged:()=>{this.printLayout&&this.getAllCellCtrls().forEach(e=>e.onLeftChanged())}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach(e=>e()),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners(),this.colModel.getCols().forEach(t=>{let i=p=>{this.getAllCellCtrls().forEach(y=>{y.column===t&&p(y)})},s=()=>{i(p=>p.onLeftChanged())},n=()=>{i(p=>p.onWidthChanged())},o=()=>{i(p=>p.onFirstRightPinnedChanged())},l=()=>{i(p=>p.onLastLeftPinnedChanged())},d=()=>{i(p=>p.onColDefChanged())};t.__addEventListener("leftChanged",s),t.__addEventListener("widthChanged",n),t.__addEventListener("firstRightPinnedChanged",o),t.__addEventListener("lastLeftPinnedChanged",l),t.__addEventListener("colDefChanged",d),this.destroyFuncsForColumnListeners.push(()=>{t.__removeEventListener("leftChanged",s),t.__removeEventListener("widthChanged",n),t.__removeEventListener("firstRightPinnedChanged",o),t.__removeEventListener("lastLeftPinnedChanged",l),t.__removeEventListener("colDefChanged",d)})})}onDomLayoutChanged(){let e=Gs(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),i=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,i&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;let e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){let t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsNotSpanningForColumn(e){let t=[];return this.getAllRowCtrls().forEach(i=>{let s=i.getCellCtrl(e,!0)?.eGui;s&&t.push(s)}),t}refreshFloatingRowComps(e=!0){this.refreshFloatingRows(this.topRowCtrls,"top",e),this.refreshFloatingRows(this.bottomRowCtrls,"bottom",e)}refreshFloatingRows(e,t,i){let{pinnedRowModel:s,beans:n,printLayout:o}=this,l=Object.fromEntries(e.map(p=>[p.rowNode.id,p]));s?.forEachPinnedRow(t,(p,y)=>{let C=e[y];C&&s.getPinnedRowById(C.rowNode.id,t)===void 0&&(C.destroyFirstPass(),C.destroySecondPass()),p.id in l&&i?(e[y]=l[p.id],delete l[p.id]):e[y]=new fv(p,n,!1,!1,o)});let d=(t==="top"?s?.getPinnedTopRowCount():s?.getPinnedBottomRowCount())??0;e.length=d}onPinnedRowDataChanged(){let e={recycleRows:!0};this.redrawAfterModelUpdate(e)}onPinnedRowsChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(e,t=!1){if(e.sticky)this.stickyRowFeature?.refreshStickyNode(e);else if(this.cachedRowCtrls?.has(e)){this.cachedRowCtrls.removeRow(e);return}else{let i=s=>{let n=s[e.rowIndex];n&&n.rowNode===e&&(n.destroyFirstPass(),n.destroySecondPass(),s[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":i(this.topRowCtrls);break;case"bottom":i(this.bottomRowCtrls);break;default:i(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){let{editSvc:t}=this.beans;if(t?.isEditing()&&(t.isBatchEditing()?t.cleanupEditors():t.stopEditing(void 0,{source:"api"})),e!=null){e?.forEach(s=>this.redrawRow(s,!0)),this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}redrawAfterModelUpdate(e={}){this.getLockOnRefresh();let t=this.beans.focusSvc?.getFocusCellToUseAfterRefresh();this.updateContainerHeights(),this.scrollToTopIfNewData(e);let i=!e.domLayoutChanged&&!!e.recycleRows,s=e.animate&&vu(this.gos),n=i?this.getRowsToRecycle():null;i||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender();let{stickyRowFeature:o,gos:l}=this;if(o){o.checkStickyRows();let d=o.extraTopHeight+o.extraBottomHeight;d&&this.updateContainerHeights(d)}this.recycleRows(n,s),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(l.get("enableRowPinning")?i:void 0),this.dispatchDisplayedRowsChanged(),t!=null&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){let t=e.newData||e.newPage,i=this.gos.get("suppressScrollOnNewData");t&&!i&&(this.gridBodyCtrl.scrollFeature.scrollToTop(),this.stickyRowFeature?.resetOffsets())}updateContainerHeights(e=0){let{rowContainerHeight:t}=this;if(this.printLayout){t.setModelHeight(null);return}let i=this.pageBounds.getCurrentPageHeight();i===0&&(i=1),t.setModelHeight(i+e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error(cr(252));this.refreshInProgress=!0,this.beans.frameworkOverrides.getLockOnRefresh?.()}releaseLockOnRefresh(){this.refreshInProgress=!1,this.beans.frameworkOverrides.releaseLockOnRefresh?.()}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){if(!e)return;let t=this.beans.focusSvc,i=this.findPositionToFocus(e);if(!i){t.focusHeaderPosition({headerPosition:{headerRowIndex:ar(this.beans)-1,column:e.column}});return}if(e.rowIndex!==i.rowIndex||e.rowPinned!=i.rowPinned){t.setFocusedCell(ht(Se({},i),{preventScrollOnBrowserFocus:!0,forceBrowserFocus:!0}));return}t.doesRowOrCellHaveBrowserFocus()||this.updateCellFocus(bt(this.gos,ht(Se({},i),{forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"})))}findPositionToFocus(e){let{pagination:t,pageBounds:i}=this.beans,s=e;for(s.rowPinned==null&&t&&i&&!t.isRowInPage(s.rowIndex)&&(s={rowPinned:null,rowIndex:i.getFirstRow()});s;){if(s.rowPinned==null&&i)if(s.rowIndex<i.getFirstRow()){if(s=dv(this.beans,{rowPinned:null,rowIndex:0}),!s)return null}else s.rowIndex>i.getLastRow()&&(s={rowPinned:null,rowIndex:i.getLastRow()});let n=this.getRowByPosition(s);if(n?.isAlive())return ht(Se({},n.getRowPosition()),{column:e.column});s=dv(this.beans,s)}return null}getAllCellCtrls(){let e=[],t=this.getAllRowCtrls(),i=t.length;for(let s=0;s<i;s++){let n=t[s].getAllCellCtrls(),o=n.length;for(let l=0;l<o;l++)e.push(n[l])}return e}getAllRowCtrls(){let{spannedRowRenderer:e}=this.beans,t=this.getStickyTopRowCtrls(),i=this.getStickyBottomRowCtrls();return[...this.topRowCtrls,...this.bottomRowCtrls,...t,...i,...e?.getCtrls("top")??[],...e?.getCtrls("bottom")??[],...e?.getCtrls("center")??[],...Object.values(this.rowCtrlsByRowIndex)]}addRenderedRowListener(e,t,i){let s=this.rowCtrlsByRowIndex[t];s&&s.addEventListener(e,i)}refreshCells({rowNodes:e,columns:t,force:i,suppressFlash:s}={}){let n={force:i,newData:!1,suppressFlash:s};for(let o of this.getCellCtrls(e,t))o.refreshOrDestroyCell(n);this.refreshFullWidth(e)}refreshRows(e={}){this.getRowCtrls(e.rowNodes).forEach(t=>t.refreshRow(e)),this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=!1;for(let i of this.getRowCtrls(e)){if(!i.isFullWidth())continue;i.refreshFullWidth()||(t=!0,this.redrawRow(i.rowNode,!0))}t&&this.dispatchDisplayedRowsChanged(!1)}getRowCtrls(e){let t=OC(e),i=this.getAllRowCtrls();return!e||!t?i:i.filter(s=>{let n=s.rowNode;return zC(n,t)})}getCellCtrls(e,t){let i;st(t)&&(i={},t.forEach(n=>{let o=this.colModel.getCol(n);st(o)&&(i[o.getId()]=!0)}));let s=[];return this.getRowCtrls(e).forEach(n=>{n.getAllCellCtrls().forEach(o=>{let l=o.column.getId();i&&!i[l]||s.push(o)})}),s}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(e=!1){let t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),this.stickyRowFeature?.destroyStickyCtrls()}getRowsToRecycle(){let e=[];for(let i of Object.keys(this.rowCtrlsByRowIndex))this.rowCtrlsByRowIndex[i].rowNode.id==null&&e.push(i);this.removeRowCtrls(e);let t={};for(let i of Object.values(this.rowCtrlsByRowIndex)){let s=i.rowNode;t[s.id]=i}return this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){e.forEach(i=>{let s=this.rowCtrlsByRowIndex[i];s&&(s.destroyFirstPass(t),s.destroySecondPass()),delete this.rowCtrlsByRowIndex[i]})}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(e={}){let{focusSvc:t,animationFrameSvc:i}=this.beans,{afterScroll:s}=e,n,o=this.stickyRowFeature;o&&(n=t?.getFocusCellToUseAfterRefresh()||void 0);let l=this.firstRenderedRow,d=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let p=!1;if(o){p=o.checkStickyRows();let C=o.extraTopHeight+o.extraBottomHeight;C&&this.updateContainerHeights(C)}let y=this.firstRenderedRow!==l||this.lastRenderedRow!==d;if(!(s&&!p&&!y)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,s),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(s&&!p),n!=null)){let C=t?.getFocusCellToUseAfterRefresh();n!=null&&C==null&&(i?.flushAllFrames(),this.restoreFocusedCell(n))}}removeRowCompsNotToDraw(e,t){let i={};e.forEach(o=>i[o]=!0);let n=Object.keys(this.rowCtrlsByRowIndex).filter(o=>!i[o]);this.removeRowCtrls(n,t)}calculateIndexesToDraw(e){let t=[];for(let l=this.firstRenderedRow;l<=this.lastRenderedRow;l++)t.push(l);let i=this.beans.pagination,s=this.beans.focusSvc?.getFocusedCell()?.rowIndex;s!=null&&(s<this.firstRenderedRow||s>this.lastRenderedRow)&&(!i||i.isRowInPage(s))&&s<this.rowModel.getRowCount()&&t.push(s);let n=l=>{let d=l.rowNode.rowIndex;d==null||d===s||(d<this.firstRenderedRow||d>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(l)&&t.push(d)};for(let l of Object.values(this.rowCtrlsByRowIndex))n(l);if(e)for(let l of Object.values(e))n(l);t.sort((l,d)=>l-d);let o=[];for(let l=0;l<t.length;l++){let d=t[l],p=this.rowModel.getRow(d);p&&!p.sticky&&o.push(d)}return o}recycleRows(e,t=!1,i=!1){let s=this.calculateIndexesToDraw(e);(this.printLayout||i)&&(t=!1),this.removeRowCompsNotToDraw(s,!t);let n=[];if(s.forEach(o=>{let l=this.createOrUpdateRowCtrl(o,e,t,i);st(l)&&n.push(l)}),e){let{animationFrameSvc:o}=this.beans;o?.active&&i&&!this.printLayout?o.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){this.eventSvc.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){let{visibleCols:e}=this.beans,t=e.isPinningLeft(),i=e.isPinningRight();(this.pinningLeft!==t||i!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=i,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){let e=[];this.getFullWidthRowCtrls().forEach(t=>{let i=t.rowNode.rowIndex;e.push(i.toString())}),this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){let t=OC(e);return this.getAllRowCtrls().filter(i=>{if(!i.isFullWidth())return!1;let s=i.rowNode;return!(t!=null&&!zC(s,t))})}createOrUpdateRowCtrl(e,t,i,s){let n,o=this.rowCtrlsByRowIndex[e];if(o||(n=this.rowModel.getRow(e),st(n)&&st(t)&&t[n.id]&&n.alreadyRendered&&(o=t[n.id],t[n.id]=null)),!o)if(n||(n=this.rowModel.getRow(e)),st(n))o=this.createRowCon(n,i,s);else return;return n&&(n.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=o,o}destroyRowCtrls(e,t){let i=[];if(e){for(let s of Object.values(e))if(s){if(this.cachedRowCtrls&&s.isCacheable()){this.cachedRowCtrls.addRow(s);continue}if(s.destroyFirstPass(!t),t){let n=s.instanceId;this.zombieRowCtrls[n]=s,i.push(()=>{s.destroySecondPass(),delete this.zombieRowCtrls[n]})}else s.destroySecondPass()}}t&&(i.push(()=>{this.isAlive()&&(this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged())}),window.setTimeout(()=>i.forEach(s=>s()),gU))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){let e=this.getRowBuffer(),t=lc(this.beans);return e*t}workOutFirstAndLastRowsToRender(){let{rowContainerHeight:e,pageBounds:t,rowModel:i}=this;e.updateOffset();let s,n;if(!i.isRowsToRender())s=0,n=-1;else if(this.printLayout)this.beans.environment.refreshRowHeightVariable(),s=t.getFirstRow(),n=t.getLastRow();else{let C=this.getRowBufferInPixels(),S=this.ctrlsSvc.getScrollFeature(),P=this.gos.get("suppressRowVirtualisation"),I=!1,O,V;do{let me=t.getPixelOffset(),{pageFirstPixel:fe,pageLastPixel:_e}=t.getCurrentPagePixelRange(),Ae=e.divStretchOffset,Oe=S.getVScrollPosition(),Ge=Oe.top,it=Oe.bottom;P?(O=fe+Ae,V=_e+Ae):(O=Math.max(Ge+me-C,fe)+Ae,V=Math.min(it+me+C,_e)+Ae),this.firstVisibleVPixel=Math.max(Ge+me,fe)+Ae,this.lastVisibleVPixel=Math.min(it+me,_e)+Ae,I=this.ensureAllRowsInRangeHaveHeightsCalculated(O,V)}while(I);let G=i.getRowIndexAtPixel(O),X=i.getRowIndexAtPixel(V),Q=t.getFirstRow(),ae=t.getLastRow();G<Q&&(G=Q),X>ae&&(X=ae),s=G,n=X}let o=Gs(this.gos,"normal"),l=this.gos.get("suppressMaxRenderedRowRestriction"),d=Math.max(this.getRowBuffer(),500);o&&!l&&n-s>d&&(n=s+d);let p=s!==this.firstRenderedRow,y=n!==this.lastRenderedRow;(p||y)&&(this.firstRenderedRow=s,this.lastRenderedRow=n,this.eventSvc.dispatchEvent({type:"viewportChanged",firstRow:s,lastRow:n}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,sa(this.beans,()=>{this.beans.eventSvc.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})}))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){let i=this.pinnedRowModel?.ensureRowHeightsValid(),s=this.stickyRowFeature?.ensureRowHeightsValid(),{pageBounds:n,rowModel:o}=this,l=o.ensureRowHeightsValid(e,t,n.getFirstRow(),n.getLastRow());return(l||s)&&this.eventSvc.dispatchEvent({type:"recalculateRowBounds"}),s||l||i?(this.updateContainerHeights(),!0):!1}doNotUnVirtualiseRow(e){let s=e.rowNode,n=this.focusSvc.isRowFocused(s.rowIndex,s.rowPinned),o=this.editSvc?.isEditing(e),l=s.detail;return n||o||l?!!this.isRowPresent(s):!1}isRowPresent(e){return this.rowModel.isRowPresent(e)?this.beans.pagination?.isRowInPage(e.rowIndex)??!0:!1}createRowCon(e,t,i){let s=this.cachedRowCtrls?.getRow(e)??null;if(s)return s;let n=i&&!this.printLayout&&!!this.beans.animationFrameSvc?.active;return new fv(e,this.beans,t,n,this.printLayout)}getRenderedNodes(){let e=Object.values(this.rowCtrlsByRowIndex).map(s=>s.rowNode),t=this.getStickyTopRowCtrls().map(s=>s.rowNode),i=this.getStickyBottomRowCtrls().map(s=>s.rowNode);return[...t,...e,...i]}getRowByPosition(e){let t,{rowIndex:i}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[i];break;case"bottom":t=this.bottomRowCtrls[i];break;default:t=this.rowCtrlsByRowIndex[i],t||(t=this.getStickyTopRowCtrls().find(s=>s.rowNode.rowIndex===i)||null,t||(t=this.getStickyBottomRowCtrls().find(s=>s.rowNode.rowIndex===i)||null));break}return t}isRangeInRenderedViewport(e,t){if(e==null||t==null)return!1;let s=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!s}},mU=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.rowNode.id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){let t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if(e==null||e.id==null)return null;let t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.rowNode!=e?null:t):null}has(e){return this.entriesMap[e.id]!=null}removeRow(e){let t=e.id,i=this.entriesMap[t];delete this.entriesMap[t],sn(this.entriesList,i)}removeFromCache(e){let t=e.rowNode.id;delete this.entriesMap[t],sn(this.entriesList,e)}getEntries(){return this.entriesList}};function OC(e){if(!e)return;let t={top:{},bottom:{},normal:{}};return e.forEach(i=>{let s=i.id;switch(i.rowPinned){case"top":t.top[s]=i;break;case"bottom":t.bottom[s]=i;break;default:t.normal[s]=i;break}}),t}function zC(e,t){let i=e.id;switch(e.rowPinned){case"top":return t.top[i]!=null;case"bottom":return t.bottom[i]!=null;default:return t.normal[i]!=null}}var vU=class extends Be{constructor(){super(...arguments),this.beanName="rowNodeSorter"}postConstruct(){let{gos:e}=this;this.isAccentedSort=e.get("accentedSort"),this.primaryColumnsSortGroups=nr(e),this.addManagedPropertyListener("accentedSort",t=>this.isAccentedSort=t.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=nr(e))}doFullSort(e,t){let i=e.map((s,n)=>({currentPos:n,rowNode:s}));return i.sort(this.compareRowNodes.bind(this,t)),i.map(s=>s.rowNode)}compareRowNodes(e,t,i){let s=t.rowNode,n=i.rowNode;for(let o=0,l=e.length;o<l;o++){let d=e[o],p=d.sort==="desc",y=this.getValue(s,d.column),C=this.getValue(n,d.column),S,P=this.getComparator(d,s);if(P?S=P(y,C,s,n,p):S=y4(y,C,this.isAccentedSort),!isNaN(S)&&S!==0)return d.sort==="asc"?S:S*-1}return t.currentPos-i.currentPos}getComparator(e,t){let i=e.column,s=i.getColDef().comparator;if(s!=null)return s;if(!i.getColDef().showRowGroup)return;let n=!t.group&&i.getColDef().field;if(!n)return;let o=this.beans.colModel.getColDefCol(n);if(o)return o.getColDef().comparator}getValue(e,t){let{valueSvc:i,colModel:s,showRowGroupCols:n,gos:o}=this.beans;if(!this.primaryColumnsSortGroups)return i.getValue(t,e,!1);if(e.rowGroupColumn===t){if(TP(o,s.isPivotActive())){let y=e.allLeafChildren?.[0];return y?i.getValue(t,y,!1):void 0}let p=n?.getShowRowGroupCol(t.getId());return p?e.groupData?.[p.getId()]:void 0}if(!(e.group&&t.getColDef().showRowGroup))return i.getValue(t,e,!1)}};function yU(e){e.sortSvc?.onSortChanged("api")}var bT={moduleName:"Sort",version:nt,beans:[OW,vU],apiFunctions:{onSortChanged:yU},userComponents:{agSortIndicator:xb},icons:{sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"}},wU=class extends Be{constructor(){super(...arguments),this.beanName="syncSvc",this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.beans.ctrlsSvc.whenReady(this,()=>{let e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){let{colModel:t,rowModel:i}=this.beans;t.setColumnDefs(e??[],"gridInitializing"),i.start()}gridReady(){let{eventSvc:e,gos:t}=this;e.dispatchEvent({type:"gridReady"}),il(t,`initialised successfully, enterprise = ${t.isModuleRegistered("EnterpriseCore")}`)}setColumnDefs(e){let t=this.gos.get("columnDefs");if(t){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(t);return}this.beans.colModel.setColumnDefs(t,wu(e.source))}}};function CU(e){e.valueCache?.expire()}function bU(e,t){let{colKey:i,rowNode:s,useFormatter:n}=t,o=e.colModel.getColDefCol(i)??e.colModel.getCol(i);if(Di(o))return null;let l=e.valueSvc.getValueForDisplay(o,s,n);return n?l.valueFormatted??Iu(l.value):l.value}var xU="paste",_U=class extends Be{constructor(){super(...arguments),this.beanName="changeDetectionSvc",this.clientSideRowModel=null}postConstruct(){let{gos:e,rowModel:t}=this.beans;Ms(e,t)&&(this.clientSideRowModel=t),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){let{gos:t,rowRenderer:i}=this.beans;if(e.source===xU||t.get("suppressChangeDetection"))return;let s=e.node,n=[s],o=this.clientSideRowModel,l=o?.rootNode;if(l&&!s.isRowPinned()){let d=t.get("aggregateOnlyChangedColumns"),p=new eg(d,l);p.addParentNode(s.parent,[e.column]),o.doAggregate(p),p.forEachChangedNodeDepthFirst(y=>{n.push(y),y.sibling&&n.push(y.sibling)})}i.refreshCells({rowNodes:n})}},SU=class extends Be{constructor(){super(...arguments),this.beanName="expressionSvc",this.cache={}}evaluate(e,t){if(typeof e=="string")return this.evaluateExpression(e,t);li(15,{expression:e})}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(i){return li(16,{expression:e,params:t,e:i}),null}}createExpressionFunction(e){let t=this.cache;if(t[e])return t[e];let i=this.createFunctionBody(e),s=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",i);return t[e]=s,s}createFunctionBody(e){return e.indexOf("return")>=0?e:"return "+e+";"}},RU=class extends Be{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){let e=this.gos;this.active=e.get("valueCache"),this.neverExpires=e.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,i){if(this.active){let s=this.cacheVersion;e.__cacheVersion!==s&&(e.__cacheVersion=s,e.__cacheData={}),e.__cacheData[t]=i}}getValue(e,t){if(!(!this.active||e.__cacheVersion!==this.cacheVersion))return e.__cacheData[t]}},EU={moduleName:"ValueCache",version:nt,beans:[RU],apiFunctions:{expireValueCache:CU}},PU={moduleName:"Expression",version:nt,beans:[SU]},MU={moduleName:"ChangeDetection",version:nt,beans:[_U]},TU={moduleName:"CellApi",version:nt,apiFunctions:{getCellValue:bU}},DU=class extends Be{constructor(){super(...arguments),this.beanName="valueSvc",this.hasEditSvc=!1,this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionSvc=e.expressionSvc,this.colModel=e.colModel,this.valueCache=e.valueCache,this.dataTypeSvc=e.dataTypeSvc,this.editSvc=e.editSvc,this.hasEditSvc=!!e.editSvc}postConstruct(){this.initialised||this.init()}init(){this.executeValueGetter=this.valueCache?this.executeValueGetterWithValueCache.bind(this):this.executeValueGetterWithoutValueCache.bind(this),this.isSsrm=ku(this.gos),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;let e=t=>this.callColumnCellValueChangedHandler(t);this.eventSvc.addListener("cellValueChanged",e,!0),this.addDestroyFunc(()=>this.eventSvc.removeListener("cellValueChanged",e,!0)),this.addManagedPropertyListener("treeData",t=>this.isTreeData=t.currentValue)}getValueForDisplay(e,t,i=!1,s=!1,n="ui"){let{showRowGroupColValueSvc:o}=this.beans,l=!e&&t.group,d=e?.colDef.showRowGroup,p=!this.isTreeData||t.footer;if(o&&p&&(l||d)){let V=o.getGroupValue(t,e);if(V==null)return{value:null,valueFormatted:null};if(!i)return{value:V.value,valueFormatted:null};let G=o.formatAndPrefixGroupColValue(V,e,s);return{value:V.value,valueFormatted:G}}if(!e)return{value:t.key,valueFormatted:null};let y=t.leafGroup&&this.colModel.isPivotMode(),C=t.group&&t.expanded&&!t.footer&&!y,S=this.gos.get("groupSuppressBlankHeader")||!t.sibling,P=C&&!S,I=this.getValue(e,t,P,n),O=i&&!(s&&e.colDef.useValueFormatterForExport===!1);return{value:I,valueFormatted:O?this.formatValue(e,t,I):null}}getValue(e,t,i=!1,s="ui"){if(this.initialised||this.init(),!t)return;let n=e.getColDef(),o=n.field,l=e.getColId(),d=t.data;if(this.hasEditSvc&&s==="ui"){let V=this.editSvc;if(V.isEditing()){let G=V.getCellDataValue({rowNode:t,column:e},!0);if(G!==void 0)return G}}let p,y=n.showRowGroup;if(typeof y=="string"&&(this.beans.rowGroupColsSvc?.getColumnIndex(y)??-1)>t.level)return null;let C=typeof y!="string"||!t.group,S=t.groupData&&l in t.groupData,P=!i&&t.aggData&&t.aggData[l]!==void 0,I=this.isSsrm&&i&&!!n.aggFunc,O=this.isSsrm&&t.footer&&t.field&&(n.showRowGroup===!0||n.showRowGroup===t.field);if(this.isTreeData&&P)p=t.aggData[l];else if(this.isTreeData&&n.valueGetter)p=this.executeValueGetter(n.valueGetter,d,e,t);else if(this.isTreeData&&o&&d)p=Hp(d,o,e.isFieldContainsDots());else if(S)p=t.groupData[l];else if(P)p=t.aggData[l];else if(n.valueGetter&&!I){if(!C)return p;p=this.executeValueGetter(n.valueGetter,d,e,t)}else if(O)p=Hp(d,t.field,e.isFieldContainsDots());else if(o&&d&&!I){if(!C)return p;p=Hp(d,o,e.isFieldContainsDots())}if(this.cellExpressions&&typeof p=="string"&&p.indexOf("=")===0){let V=p.substring(1);p=this.executeValueGetter(V,d,e,t)}return p}parseValue(e,t,i,s){let n=e.getColDef(),o=n.valueParser;if(st(o)){let l=bt(this.gos,{node:t,data:t?.data,oldValue:s,newValue:i,colDef:n,column:e});return typeof o=="function"?o(l):this.expressionSvc?.evaluate(o,l)}return i}getDeleteValue(e,t){return st(e.getColDef().valueParser)?this.parseValue(e,t,"",this.getValueForDisplay(e,t).value)??null:null}formatValue(e,t,i,s,n=!0){let{expressionSvc:o}=this.beans,l=null,d,p=e.getColDef();if(s?d=s:n&&(d=p.valueFormatter),d){let y=t?t.data:null,C=bt(this.gos,{value:i,node:t,data:y,colDef:p,column:e});typeof d=="function"?l=d(C):l=o?o.evaluate(d,C):null}else if(p.refData)return p.refData[i]||"";return l==null&&Array.isArray(i)&&(l=i.join(", ")),l}setValue(e,t,i,s){let n=this.colModel.getColDefCol(t);if(!e||!n)return!1;Di(e.data)&&(e.data={});let{field:o,valueSetter:l}=n.getColDef();if(Di(o)&&Di(l))return je(17),!1;if(this.dataTypeSvc&&!this.dataTypeSvc.checkType(n,i))return je(135),!1;let d=bt(this.gos,{node:e,data:e.data,oldValue:this.getValue(n,e,void 0,s),newValue:i,colDef:n.getColDef(),column:n});d.newValue=i;let p;if(st(l)?typeof l=="function"?p=l(d):p=this.expressionSvc?.evaluate(l,d):p=this.setValueUsingField(e.data,o,i,n.isFieldContainsDots()),p===void 0&&(p=!0),!p)return!1;e.resetQuickFilterAggregateText(),this.valueCache?.onDataChanged();let y=this.getValue(n,e);return this.dispatchCellValueChangedEvent(e,d,y,s),e.pinnedSibling&&this.dispatchCellValueChangedEvent(e.pinnedSibling,d,y,s),!0}dispatchCellValueChangedEvent(e,t,i,s){this.eventSvc.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:t.column,colDef:t.colDef,data:e.data,node:e,oldValue:t.oldValue,newValue:i,value:i,source:s})}callColumnCellValueChangedHandler(e){let t=e.colDef.onCellValueChanged;typeof t=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})})}setValueUsingField(e,t,i,s){if(!t)return!1;let n=!1;if(!s)n=e[t]===i,n||(e[t]=i);else{let o=t.split("."),l=e;for(;o.length>0&&l;){let d=o.shift();o.length===0?(n=l[d]===i,n||(l[d]=i)):l=l[d]}}return!n}executeValueGetterWithValueCache(e,t,i,s){let n=i.getColId(),o=this.valueCache.getValue(s,n);if(o!==void 0)return o;let l=this.executeValueGetterWithoutValueCache(e,t,i,s);return this.valueCache.setValue(s,n,l),l}executeValueGetterWithoutValueCache(e,t,i,s){let n=bt(this.gos,{data:t,node:s,column:i,colDef:i.getColDef(),getValue:this.getValueCallback.bind(this,s)}),o;return typeof e=="function"?o=e(n):o=this.expressionSvc?.evaluate(e,n),o}getValueCallback(e,t){let i=this.colModel.getColDefCol(t);return i?this.getValue(i,e):null}getKeyForNode(e,t){let i=this.getValue(e,t),s=e.getColDef().keyCreator,n=i;if(s){let o=bt(this.gos,{value:i,colDef:e.getColDef(),column:e,node:t,data:t.data});n=s(o)}return typeof n=="string"||n==null||(n=String(n),n==="[object Object]"&&je(121)),n}},FU={moduleName:"CommunityCore",version:nt,beans:[IW,fN,T7,e5,pU,NG,EW,t9,XB,K9,Z9,fU,DU,DW,RW,FW,F7,wU,S7,R7,d9],icons:{selectOpen:"small-down",smallDown:"small-down",colorPicker:"color-picker",smallUp:"small-up",checkboxChecked:"small-up",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off",smallLeft:"small-left",smallRight:"small-right"},apiFunctions:{getGridId:mN,destroy:vN,isDestroyed:yN,getGridOption:wN,setGridOption:CN,updateGridOptions:WM,isModuleRegistered:bN},dependsOn:[b7,wG,EG,bT,l9,WG,c9,dU,MU,u9,q9,J9,tU,g9,M7,x7,PU,qG,oU]},xT={AdvancedFilter:1,AllEnterprise:1,BatchEdit:1,CellSelection:1,Clipboard:1,ColumnMenu:1,ColumnsToolPanel:1,ContextMenu:1,ExcelExport:1,FiltersToolPanel:1,Find:1,GridCharts:1,IntegratedCharts:1,GroupFilter:1,MasterDetail:1,Menu:1,MultiFilter:1,NewFiltersToolPanel:1,Pivot:1,RangeSelection:1,RichSelect:1,RowNumbers:1,RowGrouping:1,RowGroupingPanel:1,ServerSideRowModelApi:1,ServerSideRowModel:1,SetFilter:1,SideBar:1,Sparklines:1,StatusBar:1,TreeData:1,ViewportRowModel:1},iC=["TextFilter","NumberFilter","DateFilter","SetFilter","MultiFilter","GroupFilter","CustomFilter"],IU={EditCore:["TextEditor","NumberEditor","DateEditor","CheckboxEditor","LargeTextEditor","SelectEditor","RichSelect","CustomEditor"],CheckboxCellRenderer:["AllCommunity"],ClientSideRowModelHierarchy:["RowGrouping","Pivot","TreeData"],ColumnFilter:iC,ColumnGroupHeaderComp:["AllCommunity"],ColumnGroup:["AllCommunity"],ColumnHeaderComp:["AllCommunity"],ColumnMove:["AllCommunity"],ColumnResize:["AllCommunity"],CommunityCore:["AllCommunity"],CsrmSsrmSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],RowModelSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],EnterpriseCore:["AllEnterprise"],FilterCore:[...iC,"QuickFilter","ExternalFilter","AdvancedFilter"],GroupCellRenderer:["RowGrouping","Pivot","TreeData","MasterDetail","ServerSideRowModel"],KeyboardNavigation:["AllCommunity"],LoadingCellRenderer:["ServerSideRowModel"],MenuCore:["ColumnMenu","ContextMenu"],MenuItem:["ColumnMenu","ContextMenu","MultiFilter","IntegratedCharts","ColumnsToolPanel"],Overlay:["AllCommunity"],PinnedColumn:["AllCommunity"],SharedAggregation:["RowGrouping","Pivot","TreeData","ServerSideRowModel"],SharedDragAndDrop:["AllCommunity"],SharedMasterDetail:["MasterDetail","ServerSideRowModel"],SharedMenu:[...iC,"ColumnMenu","ContextMenu"],SharedPivot:["Pivot","ServerSideRowModel"],SharedRowGrouping:["RowGrouping","ServerSideRowModel"],SharedRowSelection:["RowSelection","ServerSideRowModel"],SkeletonCellRenderer:["ServerSideRowModel"],Sort:["AllCommunity"],SsrmInfiniteSharedApi:["InfiniteRowModel","ServerSideRowModelApi"],SharedTreeData:["TreeData","ServerSideRowModel"]},kU={InfiniteRowModel:"infinite",ClientSideRowModelApi:"clientSide",ClientSideRowModel:"clientSide",ServerSideRowModelApi:"serverSide",ServerSideRowModel:"serverSide",ViewportRowModel:"viewport"};function AU(e,t){let i=[];return(Array.isArray(e)?e:[e]).forEach(s=>{let n=IU[s];n?n.forEach(o=>{let l=kU[o];(!l||l===t)&&i.push(o)}):i.push(s)}),i}var _T=()=>`No AG Grid modules are registered! It is recommended to start with all Community features via the AllCommunityModule:
                    
    import { ModuleRegistry, AllCommunityModule } from 'ag-grid-community';
    
    ModuleRegistry.registerModules([ AllCommunityModule ]);
    `,LU=e=>{let t=e.map(s=>`import { ${Np(s)} } from '${xT[s]?"ag-grid-enterprise":"ag-grid-community"}';`);return e.some(s=>s==="IntegratedCharts"||s==="Sparklines")&&t.push("import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';"),`import { ModuleRegistry } from 'ag-grid-community'; 
${t.join(` 
`)} 

ModuleRegistry.registerModules([ ${e.map(s=>Np(s,!0)).join(", ")} ]); 

For more info see: ${mu}/modules/`};function Np(e,t=!1){return t&&(e==="IntegratedCharts"||e==="Sparklines")?`${e}Module.with(AgChartsEnterpriseModule)`:`${e}Module`}function OU(e,t){let i=t.filter(o=>o==="IntegratedCharts"||o==="Sparklines"),s="";return!globalThis?.agCharts&&i.length>0?s=`Unable to use ${e} as either the ag-charts-community or ag-charts-enterprise script needs to be included alongside ag-grid-enterprise.
`:t.some(o=>xT[o])&&(s=s+`Unable to use ${e} as that requires the ag-grid-enterprise script to be included.
`),s}function ST({moduleName:e,rowModelType:t}){return`To use the ${e}Module you must set the gridOption "rowModelType='${t}'"`}var NE=({reasonOrId:e,moduleName:t,gridScoped:i,gridId:s,rowModelType:n,additionalText:o,isUmd:l})=>{let d=AU(t,n),p=typeof e=="string"?e:HU[e];if(l)return OU(p,d);let y=d.filter(P=>P==="IntegratedCharts"||P==="Sparklines"),C=y.length>0?`${y.map(P=>Np(P)).join()} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.`:"";return`${`Unable to use ${p} as ${d.length>1?"one of "+d.map(P=>Np(P)).join(", "):Np(d[0])} is not registered${i?" for gridId: "+s:""}. ${C} Check if you have registered the module:
`}
${LU(d)}`+(o?` 

${o}`:"")},GE=e=>`${e} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.

import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';
import { ModuleRegistry } from 'ag-grid-community';
import { ${e} } from 'ag-grid-enterprise';
    
ModuleRegistry.registerModules([${e}.with(AgChartsEnterpriseModule)]);
    `,zU=e=>`AG Grid: Unable to use the Clipboard API (navigator.clipboard.${e}()). The reason why it could not be used has been logged in the previous line. For this reason the grid has defaulted to using a workaround which doesn't perform as well. Either fix why Clipboard API is blocked, OR stop this message from appearing by setting grid property suppressClipboardApi=true (which will default the grid to using the workaround rather than the API.`,BU={1:()=>"`rowData` must be an array",2:({nodeId:e})=>`Duplicate node id '${e}' detected from getRowId callback, this could cause issues in your grid.`,3:()=>"Calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.",4:({id:e})=>`Could not find row id=${e}, data item was not found for this id`,5:({data:e})=>["Could not find data item as object was not found.",e," Consider using getRowId to help the Grid find matching row data"],6:()=>"'groupHideOpenParents' only works when specifying specific columns for 'colDef.showRowGroup'",7:()=>"Pivoting is not supported with aligned grids as it may produce different columns in each grid.",8:({key:e})=>`Unknown key for navigation ${e}`,9:({variable:e})=>`No value for ${e?.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${e?.defaultValue} will be used and updated when styles load.`,10:({eventType:e})=>`As of v33, the '${e}' event is deprecated. Use the global 'modelUpdated' event to determine when row children have changed.`,11:()=>"No gridOptions provided to createGrid",12:({colKey:e})=>["column ",e," not found"],13:()=>"Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid.",14:({groupPrefix:e})=>`Row IDs cannot start with ${e}, this is a reserved prefix for AG Grid's row grouping feature.`,15:({expression:e})=>["value should be either a string or a function",e],16:({expression:e,params:t,e:i})=>["Processing of the expression failed","Expression = ",e,"Params = ",t,"Exception = ",i],17:()=>"you need either field or valueSetter set on colDef for editing to work",18:()=>"alignedGrids contains an undefined option.",19:()=>"alignedGrids - No api found on the linked grid.",20:()=>`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`,21:()=>"pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.",22:({key:e})=>`${e} is an initial property and cannot be updated.`,23:()=>"The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.",24:()=>"row height must be a number if not using standard row model",25:({id:e})=>["The getRowId callback must return a string. The ID ",e," is being cast to a string."],26:({fnName:e,preDestroyLink:t})=>`Grid API function ${e}() cannot be called as the grid has been destroyed.
 Either clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
 To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${t}`,27:({fnName:e,module:t})=>`API function '${e}' not registered to module '${t}'`,28:()=>"setRowCount cannot be used while using row grouping.",29:()=>"tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?",30:({toIndex:e})=>["tried to insert columns in invalid location, toIndex = ",e,"remember that you should not count the moving columns when calculating the new index"],31:()=>"infinite loop in resizeColumnSets",32:()=>"applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state.",33:()=>"stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON.",34:({key:e})=>`the column type '${e}' is a default column type and cannot be overridden.`,35:()=>"Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type.",36:({t:e})=>"colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes",37:()=>"Changing the column pinning status is not allowed with domLayout='print'",38:({iconName:e})=>`provided icon '${e}' needs to be a string or a function`,39:()=>"Applying column order broke a group where columns should be married together. Applying new order has been discarded.",40:({e,method:t})=>`${e}
${zU(t)}`,41:()=>"Browser did not allow document.execCommand('copy'). Ensure 'api.copySelectedRowsToClipboard() is invoked via a user event, i.e. button click, otherwise the browser will prevent it for security reasons.",42:()=>"Browser does not support document.execCommand('copy') for clipboard operations",43:({iconName:e})=>`As of v33, icon '${e}' is deprecated. Use the icon CSS name instead.`,44:()=>'Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.',45:({parentCellDataType:e})=>`The data type definition ${e} does not exist.`,46:()=>'The "baseDataType" property of a data type definition must match that of its parent.',47:({cellDataType:e})=>`Missing data type definition - "${e}"`,48:({property:e})=>`Cell data type is "object" but no Value ${e} has been provided. Please either provide an object data type definition with a Value ${e}, or set "colDef.value${e}"`,49:({methodName:e})=>`Framework component is missing the method ${e}()`,50:({compName:e})=>`Could not find component ${e}, did you forget to configure this component?`,51:()=>"Export cancelled. Export is not allowed as per your configuration.",52:()=>"There is no `window` associated with the current `document`",53:()=>"unknown value type during csv conversion",54:()=>"Could not find document body, it is needed for drag and drop and context menu.",55:()=>"addRowDropZone - A container target needs to be provided",56:()=>"addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.",57:()=>"unable to show popup filter, filter instantiation failed",58:()=>"no values found for select cellEditor",59:()=>"cannot select pinned rows",60:()=>"cannot select node until it has finished loading",61:()=>"since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option.",62:({colId:e})=>`setFilterModel() - no column found for colId: ${e}`,63:({colId:e})=>`setFilterModel() - unable to fully apply model, filtering disabled for colId: ${e}`,64:({colId:e})=>`setFilterModel() - unable to fully apply model, unable to create filter for colId: ${e}`,65:()=>"filter missing setModel method, which is needed for setFilterModel",66:()=>"filter API missing getModel method, which is needed for getFilterModel",67:()=>"Filter is missing isFilterActive() method",68:()=>"Column Filter API methods have been disabled as Advanced Filters are enabled.",69:({guiFromFilter:e})=>`getGui method from filter returned ${e}; it should be a DOM element.`,70:({newFilter:e})=>`Grid option quickFilterText only supports string inputs, received: ${typeof e}`,71:()=>"debounceMs is ignored when apply button is present",72:({keys:e})=>["ignoring FilterOptionDef as it doesn't contain one of ",e],73:()=>"invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'",74:()=>"no filter options for filter",75:()=>"Unknown button type specified",76:({filterModelType:e})=>['Unexpected type of filter "',e,'", it looks like the filter was configured with incorrect Filter Options'],77:()=>"Filter model is missing 'conditions'",78:()=>'Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.',79:()=>'"filterParams.maxNumConditions" must be greater than or equal to zero.',80:()=>'"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.',81:()=>'"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".',82:({param:e})=>`DateFilter ${e} is not a number`,83:()=>"DateFilter minValidYear should be <= maxValidYear",84:()=>"DateFilter minValidDate should be <= maxValidDate",85:()=>"DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored.",86:()=>"DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored.",87:()=>"DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.",88:({index:e})=>`Invalid row index for ensureIndexVisible: ${e}`,89:()=>"A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)",90:()=>"datasource is missing getRows method",91:()=>"Filter is missing method doesFilterPass",92:()=>"AnimationFrameService called but animation frames are off",93:()=>"cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`",94:({paginationPageSizeOption:e,pageSizeSet:t,pageSizesSet:i,pageSizeOptions:s})=>`'paginationPageSize=${e}'${t?"":" (default value)"}, but ${e} is not included in${i?"":" the default"} paginationPageSizeSelector=[${s?.join(", ")}].`,95:({paginationPageSizeOption:e,paginationPageSizeSelector:t})=>`Either set '${t}' to an array that includes ${e} or to 'false' to disable the page size selector.`,96:({id:e,data:t})=>["Duplicate ID",e,"found for pinned row with data",t,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter."],97:({colId:e})=>`cellEditor for column ${e} is missing getGui() method`,98:()=>"popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.",99:()=>"Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead.",101:({propertyName:e,componentName:t,agGridDefaults:i,jsComps:s})=>{let n=[],o=[...Object.keys(i??[]).filter(d=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(d)),...Object.keys(s??[]).filter(d=>!!s[d])],l=wC({inputValue:t,allSuggestions:o,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return n.push(`Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.
`),l.length>0&&n.push(`         Did you mean: [${l.slice(0,3)}]?
`),n.push("If using a custom component check it has been registered correctly."),n},102:()=>"selectAll: 'filtered' only works when gridOptions.rowModelType='clientSide'",103:()=>"Invalid selection state. When using client-side row model, the state must conform to `string[]`.",104:({value:e,param:t})=>`Numeric value ${e} passed to ${t} param will be interpreted as ${e} seconds. If this is intentional use "${e}s" to silence this warning.`,105:({e})=>["chart rendering failed",e],106:()=>`Theming API and Legacy Themes are both used in the same page. A Theming API theme has been provided to the 'theme' grid option, but the file (ag-grid.css) is also included and will cause styling issues. Remove ag-grid.css from the page. See the migration guide: ${mu}/theming-migration/`,107:({key:e,value:t})=>`Invalid value for theme param ${e} - ${t}`,108:({e})=>["chart update failed",e],109:({inputValue:e,allSuggestions:t})=>{let i=wC({inputValue:e,allSuggestions:t,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return[`Could not find '${e}' aggregate function. It was configured as "aggFunc: '${e}'" but it wasn't found in the list of registered aggregations.`,i.length>0?`         Did you mean: [${i.slice(0,3)}]?`:"","If using a custom aggregation function check it has been registered correctly."].join(`
`)},110:()=>"groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup",111:()=>"Invalid selection state. When `groupSelects` is enabled, the state must conform to `IServerSideGroupSelectionState`.",113:()=>"Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values",114:({component:e})=>`Could not find component with name of ${e}. Is it in Vue.components?`,116:()=>"Invalid selection state. The state must conform to `IServerSideSelectionState`.",117:()=>"selectAll must be of boolean type.",118:()=>"Infinite scrolling must be enabled in order to set the row count.",119:()=>"Unable to instantiate filter",120:()=>"MultiFloatingFilterComp expects MultiFilter as its parent",121:()=>"a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (see AG Grid docs) or b) to toString() on the object to return a key",122:()=>"could not find the document, document is empty",123:()=>"Advanced Filter is only supported with the Client-Side Row Model or Server-Side Row Model.",124:()=>"No active charts to update.",125:({chartId:e})=>`Unable to update chart. No active chart found with ID: ${e}.`,126:()=>"unable to restore chart as no chart model is provided",127:({allRange:e})=>`unable to create chart as ${e?"there are no columns in the grid":"no range is selected"}.`,128:({feature:e})=>`${e} is only available if using 'multiRow' selection mode.`,129:({feature:e,rowModel:t})=>`${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`,130:()=>'cannot multi select unless selection mode is "multiRow"',132:()=>"Row selection features are not available unless `rowSelection` is enabled.",133:({iconName:e})=>`icon '${e}' function should return back a string or a dom object`,134:({iconName:e})=>`Did not find icon '${e}'`,135:()=>"Data type of the new value does not match the cell data type of the column",136:()=>"Unable to update chart as the 'type' is missing. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'.",137:({type:e,currentChartType:t})=>`Unable to update chart as a '${e}' update type is not permitted on a ${t}.`,138:({chartType:e})=>`invalid chart type supplied: ${e}`,139:({customThemeName:e})=>`a custom chart theme with the name ${e} has been supplied but not added to the 'chartThemes' list`,140:({name:e})=>`no stock theme exists with the name '${e}' and no custom chart theme with that name was supplied to 'customChartThemes'`,141:()=>"cross filtering with row grouping is not supported.",142:()=>"cross filtering is only supported in the client side row model.",143:({panel:e})=>`'${e}' is not a valid Chart Tool Panel name`,144:({type:e})=>`Invalid charts data panel group name supplied: '${e}'`,145:({group:e})=>`As of v32, only one charts customize panel group can be expanded at a time. '${e}' will not be expanded.`,146:({comp:e})=>`Unable to instantiate component '${e}' as its module hasn't been loaded. Add 'ValidationModule' to see which module is required.`,147:({group:e})=>`Invalid charts customize panel group name supplied: '${e}'`,148:({group:e})=>`invalid chartGroupsDef config '${e}'`,149:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,150:()=>"'seriesChartTypes' are required when the 'customCombo' chart type is specified.",151:({chartType:e})=>`invalid chartType '${e}' supplied in 'seriesChartTypes', converting to 'line' instead.`,152:({colId:e})=>`no 'seriesChartType' found for colId = '${e}', defaulting to 'line'.`,153:({chartDataType:e})=>`unexpected chartDataType value '${e}' supplied, instead use 'category', 'series' or 'excluded'`,154:({colId:e})=>`cross filtering requires a 'agSetColumnFilter' or 'agMultiColumnFilter' to be defined on the column with id: ${e}`,155:({option:e})=>`'${e}' is not a valid Chart Toolbar Option`,156:({panel:e})=>`Invalid panel in chartToolPanelsDef.panels: '${e}'`,157:({unrecognisedGroupIds:e})=>["unable to find group(s) for supplied groupIds:",e],158:()=>"can not expand a column item that does not represent a column group header",159:()=>"Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty.",160:()=>"Export cancelled. Export is not allowed as per your configuration.",161:()=>"The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'",162:({id:e,dataType:t})=>`Unrecognized data type for excel export [${e}.dataType=${t}]`,163:({featureName:e})=>`Excel table export does not work with ${e}. The exported Excel file will not contain any Excel tables.
 Please turn off ${e} to enable Excel table exports.`,164:()=>"Unable to add data table to Excel sheet: A table already exists.",165:()=>"Unable to add data table to Excel sheet: Missing required parameters.",166:({unrecognisedGroupIds:e})=>["unable to find groups for these supplied groupIds:",e],167:({unrecognisedColIds:e})=>["unable to find columns for these supplied colIds:",e],168:()=>"detailCellRendererParams.template should be function or string",169:()=>'Reference to eDetailGrid was missing from the details template. Please add data-ref="eDetailGrid" to the template.',170:({providedStrategy:e})=>`invalid cellRendererParams.refreshStrategy = ${e} supplied, defaulting to refreshStrategy = 'rows'.`,171:()=>"could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions",172:()=>"could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData",173:({group:e})=>`invalid chartGroupsDef config '${e}'`,174:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,175:({menuTabName:e,itemsToConsider:t})=>[`Trying to render an invalid menu item '${e}'. Check that your 'menuTabs' contains one of `,t],176:({key:e})=>`unknown menu item type ${e}`,177:()=>"valid values for cellSelection.handle.direction are 'x', 'y' and 'xy'. Default to 'xy'.",178:({colId:e})=>`column ${e} is not visible`,179:()=>"totalValueGetter should be either a function or a string (expression)",180:()=>"agRichSelectCellEditor requires cellEditorParams.values to be set",181:()=>"agRichSelectCellEditor cannot have `multiSelect` and `allowTyping` set to `true`. AllowTyping has been turned off.",182:()=>'you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data',183:()=>"Group Column Filter only works on group columns. Please use a different filter.",184:({parentGroupData:e,childNodeData:t})=>["duplicate group keys for row data, keys should be unique",[e,t]],185:({data:e})=>["getDataPath() should not return an empty path",[e]],186:({rowId:e,rowData:t,duplicateRowsData:i})=>["duplicate group keys for row data, keys should be unique",e,t,...i??[]],187:({rowId:e,firstData:t,secondData:i})=>[`Duplicate node id ${e}. Row IDs are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values.`,"first instance",t,"second instance",i],188:e=>`getRowId callback must be provided for Server Side Row Model ${e?.feature||"selection"} to work correctly.`,189:({startRow:e})=>`invalid value ${e} for startRow, the value should be >= 0`,190:({rowGroupId:e,data:t})=>["null and undefined values are not allowed for server side row model keys",e?`column = ${e}`:"","data is ",t],194:({method:e})=>`calling gridApi.${e}() is only possible when using rowModelType=\`clientSide\`.`,195:({justCurrentPage:e})=>`selecting just ${e?"current page":"filtered"} only works when gridOptions.rowModelType='clientSide'`,196:({key:e})=>`Provided ids must be of string type. Invalid id provided: ${e}`,197:()=>"`toggledNodes` must be an array of string ids.",199:()=>"getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model. Use `api.getServerSideSelectionState()` instead.",200:NE,201:({rowModelType:e})=>`Could not find row model for rowModelType = ${e}`,202:()=>"`getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model. Use `api.getServerSideSelectionState()` instead.",203:()=>"Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled.",204:()=>"Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled.",205:({duplicateIdText:e})=>`Unable to display rows as duplicate row ids (${e}) were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids.`,206:()=>"getRowId callback must be implemented for transactions to work. Transaction was ignored.",207:()=>'The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.',208:()=>"Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects.",209:()=>`Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects. See ${mu}/filter-set-filter-list/#filter-value-types`,210:()=>"Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects?",211:()=>"property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date.",212:()=>"please review all your toolPanel components, it seems like at least one of them doesn't have an id",213:()=>"Advanced Filter does not work with Filters Tool Panel. Filters Tool Panel has been disabled.",214:({key:e})=>`unable to lookup Tool Panel as invalid key supplied: ${e}`,215:({key:e,defaultByKey:t})=>`the key ${e} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys(t??{}).join(",")}`,216:({name:e})=>`Missing component for '${e}'`,217:({invalidColIds:e})=>["unable to find grid columns for the supplied colDef(s):",e],218:({property:e,defaultOffset:t})=>`${e} must be a number, the value you provided is not a valid number. Using the default of ${t}px.`,219:({property:e})=>`Property ${e} does not exist on the target object.`,220:({lineDash:e})=>`'${e}' is not a valid 'lineDash' option.`,221:()=>"agAggregationComponent should only be used with the client and server side row model.",222:()=>"agFilteredRowCountComponent should only be used with the client side row model.",223:()=>"agSelectedRowCountComponent should only be used with the client and server side row model.",224:()=>"agTotalAndFilteredRowCountComponent should only be used with the client side row model.",225:()=>"agTotalRowCountComponent should only be used with the client side row model.",226:()=>"viewport is missing init method.",227:()=>"menu item icon must be DOM node or string",228:({menuItemOrString:e})=>`unrecognised menu item ${e}`,229:({index:e})=>["invalid row index for ensureIndexVisible: ",e],230:()=>"detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://www.ag-grid.com/react-data-grid/master-detail-custom-detail/",231:()=>"As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.",232:()=>"Using both rowData and v-model. rowData will be ignored.",233:({methodName:e})=>`Framework component is missing the method ${e}()`,234:()=>'Group Column Filter does not work with the colDef property "field". This property will be ignored.',235:()=>'Group Column Filter does not work with the colDef property "filterValueGetter". This property will be ignored.',236:()=>'Group Column Filter does not work with the colDef property "filterParams". This property will be ignored.',237:()=>"Group Column Filter does not work with Tree Data enabled. Please disable Tree Data, or use a different filter.",238:()=>"setRowCount can only accept a positive row count.",239:()=>'Theming API and CSS File Themes are both used in the same page. In v33 we released the Theming API as the new default method of styling the grid. See the migration docs https://www.ag-grid.com/react-data-grid/theming-migration/. Because no value was provided to the `theme` grid option it defaulted to themeQuartz. But the file (ag-grid.css) is also included and will cause styling issues. Either pass the string "legacy" to the theme grid option to use v32 style themes, or remove ag-grid.css from the page to use Theming API.',240:({theme:e})=>`theme grid option must be a Theming API theme object or the string "legacy", received: ${e}`,243:()=>"Failed to deserialize state - each provided state object must be an object.",244:()=>"Failed to deserialize state - `selectAllChildren` must be a boolean value or undefined.",245:()=>"Failed to deserialize state - `toggledNodes` must be an array.",246:()=>"Failed to deserialize state - Every `toggledNode` requires an associated string id.",247:()=>`Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule. 
Please rebuild the selection state and reapply it.`,248:()=>"SetFloatingFilter expects SetFilter as its parent",249:()=>"Must supply a Value Formatter in Set Filter params when using a Key Creator",250:()=>"Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.",251:({chartType:e})=>`AG Grid: Unable to create chart as an invalid chartType = '${e}' was supplied.`,252:()=>`cannot get grid to draw rows when it is in the middle of drawing rows. 
Your code probably called a grid API method while the grid was in the render stage. 
To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). 
To see what part of your code that caused the refresh check this stacktrace.`,253:({version:e})=>["Illegal version string: ",e],254:()=>"Cannot create chart: no chart themes available.",255:({point:e})=>`Lone surrogate U+${e?.toString(16).toUpperCase()} is not a scalar value`,256:()=>"Unable to initialise. See validation error, or load ValidationModule if missing.",257:()=>GE("IntegratedChartsModule"),258:()=>GE("SparklinesModule"),259:({part:e})=>`the argument to theme.withPart must be a Theming API part object, received: ${e}`,260:({propName:e,compName:t,gridScoped:i,gridId:s,rowModelType:n})=>NE({reasonOrId:`AG Grid '${e}' component: ${t}`,moduleName:_u[t],gridId:s,gridScoped:i,rowModelType:n}),261:()=>"As of v33, `column.isHovered()` is deprecated. Use `api.isColumnHovered(column)` instead.",262:()=>'As of v33, icon key "smallDown" is deprecated. Use "advancedFilterBuilderSelect" for Advanced Filter Builder dropdown, "selectOpen" for Select cell editor and dropdowns (e.g. Integrated Charts menu), "richSelectOpen" for Rich Select cell editor.',263:()=>'As of v33, icon key "smallLeft" is deprecated. Use "panelDelimiterRtl" for Row Group Panel / Pivot Panel, "subMenuOpenRtl" for sub-menus.',264:()=>'As of v33, icon key "smallRight" is deprecated. Use "panelDelimiter" for Row Group Panel / Pivot Panel, "subMenuOpen" for sub-menus.',265:({colId:e})=>`Unable to infer chart data type for column '${e}' if first data entry is null. Please specify "chartDataType", or a "cellDataType" in the column definition. For more information, see ${mu}/integrated-charts-range-chart#coldefchartdatatype .`,266:()=>'As of v33.1, using "keyCreator" with the Rich Select Editor has been deprecated. It now requires the "formatValue" callback to convert complex data to strings.',267:()=>"Detail grids can not use a different theme to the master grid, the `theme` detail grid option will be ignored.",268:()=>"Transactions aren't supported with tree data when using treeDataChildrenField",269:()=>"When `masterSelects: 'detail'`, detail grids must be configured with multi-row selection",270:({id:e,parentId:t})=>`Cycle detected for row with id='${e}' and parent id='${t}'. Resetting the parent for row with id='${e}' and showing it as a root-level node.`,271:({id:e,parentId:t})=>`Parent row not found for row with id='${e}' and parent id='${t}'. Showing row with id='${e}' as a root-level node.`,272:()=>_T(),273:({providedId:e,usedId:t})=>`Provided column id '${e}' was already in use, ensure all column and group ids are unique. Using '${t}' instead.`,274:({prop:e})=>{let t=`Since v33, ${e} has been deprecated.`;switch(e){case"maxComponentCreationTimeMs":t+=" This property is no longer required and so will be removed in a future version.";break;case"setGridApi":t+=" This method is not called by AG Grid. To access the GridApi see: https://ag-grid.com/react-data-grid/grid-interface/#grid-api ";break;case"children":t+=" For multiple versions AgGridReact does not support children.";break}return t},275:ST,276:()=>"Row Numbers Row Resizer cannot be used when Grid Columns have `autoHeight` enabled.",277:({colId:e})=>`'enableFilterHandlers' is set to true, but column '${e}' does not have 'filter.doesFilterPass' or 'filter.handler' set.`,278:({colId:e})=>`Unable to create filter handler for column '${e}'`,279:e=>{},280:({colId:e})=>`'name' must be provided for custom filter components for column '${e}`,281:({colId:e})=>`Filter for column '${e}' does not have 'filterParams.buttons', but the new Filters Tool Panel has buttons configured. Either configure buttons for the filter, or disable buttons on the Filters Tool Panel.`,282:()=>"New filter tool panel requires `enableFilterHandlers: true`.",283:()=>"As of v34, use the same method on the filter handler (`api.getColumnFilterHandler(colKey)`) instead.",284:()=>"As of v34, filters are active when they have a model. Use `api.getColumnFilterModel()` instead.",285:()=>"As of v34, use (`api.getColumnFilterModel()`) instead.",286:()=>"As of v34, use (`api.setColumnFilterModel()`) instead.",287:()=>"`api.doFilterAction()` requires `enableFilterHandlers = true",288:()=>"`api.getColumnFilterModel(key, true)` requires `enableFilterHandlers = true",289:({rowModelType:e})=>`Row Model '${e}' is not supported with Batch Editing`,290:({rowIndex:e,rowPinned:t})=>`Row with index '${e}' and pinned state '${t}' not found`};function VU(e,t){let i=BU[e];if(!i)return[`Missing error text for error id ${e}!`];let s=i(t),o=`
See ${_P(e,t)}`;return Array.isArray(s)?s.concat(o):[s,o]}var HU={1:"Charting Aggregation",2:"pivotResultFields",3:"setTooltip"},WE=new WeakMap,UE=new WeakMap;function RT(e,t,i){if(!t)return li(11),{};let s=i,n;if(!s?.setThemeOnGridDiv){let l=rs({tag:"div"});l.style.height="100%",e.appendChild(l),e=l,n=()=>e.remove()}return new GU().create(e,t,l=>{let d=new pN(e);l.createBean(d)},void 0,i,n)}var NU=1,GU=class{create(e,t,i,s,n,o){let l=lB.applyGlobalGridOptions(t),d=l.gridId??String(NU++),p=this.getRegisteredModules(n,d,l.rowModelType),y=this.createBeansList(l.rowModelType,p,d),C=this.createProvidedBeans(e,l,n);if(!y)return;let P={providedBeanInstances:C,beanClasses:y,id:d,beanInitComparator:XH,beanDestroyComparator:YH,derivedBeans:[ZH],destroyCallback:()=>{UE.delete(O),WE.delete(e),L7(d),o?.()}},I=new k8(P);this.registerModuleFeatures(I,p),i(I),I.getBean("syncSvc").start(),s?.(I);let O=I.getBean("gridApi");return WE.set(e,O),UE.set(O,e),O}getRegisteredModules(e,t,i){return tg(FU,void 0,!0),e?.modules?.forEach(s=>tg(s,t)),O7(t,jE(i))}registerModuleFeatures(e,t){let i=e.getBean("registry"),s=e.getBean("apiFunctionSvc");t.forEach(n=>{i.registerModule(n);let o=n.apiFunctions;o&&Object.keys(o).forEach(d=>{s?.addFunction(d,o[d])})})}createProvidedBeans(e,t,i){let s=i?i.frameworkOverrides:null;Di(s)&&(s=new yb);let n={gridOptions:t,eGridDiv:e,eRootDiv:e,globalListener:i?i.globalListener:null,globalSyncListener:i?i.globalSyncListener:null,frameworkOverrides:s};return i&&i.providedBeanInstances&&Object.assign(n,i.providedBeanInstances),n}createBeansList(e,t,i){let s={clientSide:"ClientSideRowModel",infinite:"InfiniteRowModel",serverSide:"ServerSideRowModel",viewport:"ViewportRowModel"},n=jE(e),o=s[n];if(!o){Ap(201,{rowModelType:n},`Unknown rowModelType ${n}.`);return}if(!B7()){Ap(272,void 0,_T());return}if(!e){let d=Object.entries(s).filter(([p,y])=>kC(y,i,p));if(d.length==1){let[p,y]=d[0];if(p!==n){let C={moduleName:y,rowModelType:p};Ap(275,C,ST(C));return}}}if(!kC(o,i,n)){Ap(200,{reasonOrId:`rowModelType = '${n}'`,moduleName:o,gridScoped:wb(),gridId:i,rowModelType:n},`Missing module ${o}Module for rowModelType ${n}.`);return}let l=new Set;return t.forEach(d=>d.beans?.forEach(p=>l.add(p))),Array.from(l)}};function jE(e){return e??"clientSide"}var WU=class extends Be{constructor(){super(...arguments),this.beanName="localeSvc"}getLocaleTextFunc(){let e=this.gos,t=e.getCallback("getLocaleText");return t?J4(t):eB(e.get("localeText"))}};function UU(e,t=!1){let i=[],s=[],n=[],o=[],l=[],d=[],p=[],y=[],C=[],S=0;for(let P=0;P<e.length;P++){let{colId:I,sort:O,sortIndex:V,rowGroup:G,rowGroupIndex:X,aggFunc:Q,pivot:ae,pivotIndex:me,pinned:fe,hide:_e,width:Ae,flex:Oe}=e[P];C.push(I),O&&(i[V??S++]={colId:I,sort:O}),G&&(s[X??0]=I),typeof Q=="string"&&n.push({colId:I,aggFunc:Q}),ae&&(o[me??0]=I),fe&&(fe==="right"?d:l).push(I),_e&&p.push(I),(Oe!=null||Ae)&&y.push({colId:I,flex:Oe??void 0,width:Ae})}return{sort:i.length?{sortModel:i}:void 0,rowGroup:s.length?{groupColIds:s}:void 0,aggregation:n.length?{aggregationModel:n}:void 0,pivot:o.length||t?{pivotMode:t,pivotColIds:o}:void 0,columnPinning:l.length||d.length?{leftColIds:l,rightColIds:d}:void 0,columnVisibility:p.length?{hiddenColIds:p}:void 0,columnSizing:y.length?{columnSizingModel:y}:void 0,columnOrder:C.length?{orderedColIds:C}:void 0}}function jU(e){let t=[];return e.forEach(({groupId:i,open:s})=>{s&&t.push(i)}),t.length?{openColumnGroupIds:t}:void 0}var ET=class{wrap(e,t,i,s){let n=this.createWrapper(e,s);return t?.forEach(o=>{this.createMethod(n,o,!0)}),i?.forEach(o=>{this.createMethod(n,o,!1)}),n}createMethod(e,t,i){e.addMethod(t,this.createMethodProxy(e,t,i))}createMethodProxy(e,t,i){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(i&&je(49,{methodName:t}),null)}}};function sC(e){return e.get("tooltipShowMode")==="whenTruncated"}function $U(e,t){if(typeof e!="number")return"";let i=t(),s=i("thousandSeparator",","),n=i("decimalSeparator",".");return e.toString().replace(".",n).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${s}`)}var qU=class extends Be{getFileName(e){let t=this.getDefaultFileExtension();return(e==null||!e.length)&&(e=this.getDefaultFileName()),e.indexOf(".")===-1?`${e}.${t}`:e}getData(e){let t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},ZU=class{constructor(e){let{colModel:t,rowGroupColsSvc:i,colNames:s,valueSvc:n,gos:o,processCellCallback:l,processHeaderCallback:d,processGroupHeaderCallback:p,processRowGroupCallback:y}=e;this.colModel=t,this.rowGroupColsSvc=i,this.colNames=s,this.valueSvc=n,this.gos=o,this.processCellCallback=l,this.processHeaderCallback=d,this.processGroupHeaderCallback=p,this.processRowGroupCallback=y}prepare(e){}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e,t,i,s,n){let o=t===0&&DP(this.gos,n,this.colModel.isPivotMode());if(this.processRowGroupCallback&&(this.gos.get("treeData")||n.group)&&(e.isRowGroupDisplayed(n.rowGroupColumn?.getColId()??"")||o))return{value:this.processRowGroupCallback(bt(this.gos,{column:e,node:n}))??""};if(this.processCellCallback)return{value:this.processCellCallback(bt(this.gos,{accumulatedRowIndex:i,column:e,node:n,value:this.valueSvc.getValueForDisplay(e,n,void 0,void 0).value,type:s,parseValue:P=>this.valueSvc.parseValue(e,n,P,this.valueSvc.getValue(e,n,void 0)),formatValue:P=>this.valueSvc.formatValue(e,n,P)??P}))??""};let l=this.gos.get("treeData"),d=this.valueSvc,p=n.level===-1&&n.footer,y=e.colDef.showRowGroup===!0&&(n.group||l);if(!p&&(o||y)){let P="",I=n;for(;I&&I.level!==-1;){let{value:O,valueFormatted:V}=d.getValueForDisplay(o?void 0:e,I,!0,!0);P=` -> ${V??O??""}${P}`,I=I.parent}return{value:P,valueFormatted:P}}let{value:C,valueFormatted:S}=d.getValueForDisplay(e,n,!0,!0);return{value:C??"",valueFormatted:S}}getHeaderName(e,t){return e?e(bt(this.gos,{column:t})):this.colNames.getDisplayNameForColumn(t,"csv",!0)}};function KU(e,t){let i=document.defaultView||window;if(!i){je(52);return}let s=document.createElement("a"),n=i.URL.createObjectURL(t);s.setAttribute("href",n),s.setAttribute("download",e),s.style.display="none",document.body.appendChild(s),s.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:i})),document.body.removeChild(s),i.setTimeout(()=>{i.URL.revokeObjectURL(n)},0)}var XU={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,groupLockGroupColumns:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,renderingMode:!0,columnMenu:!0,suppressSetFilterByDefault:!0,getDataPath:!0,enableCellSpan:!0,enableFilterHandlers:!0,filterHandlers:!0},vo="clientSide",Zs="serverSide",lu="infinite",YU={onGroupExpandedOrCollapsed:[vo],refreshClientSideRowModel:[vo],isRowDataEmpty:[vo],forEachLeafNode:[vo],forEachNodeAfterFilter:[vo],forEachNodeAfterFilterAndSort:[vo],resetRowHeights:[vo,Zs],applyTransaction:[vo],applyTransactionAsync:[vo],flushAsyncTransactions:[vo],getBestCostNodeSelection:[vo],getServerSideSelectionState:[Zs],setServerSideSelectionState:[Zs],applyServerSideTransaction:[Zs],applyServerSideTransactionAsync:[Zs],applyServerSideRowData:[Zs],retryServerSideLoads:[Zs],flushServerSideAsyncTransactions:[Zs],refreshServerSide:[Zs],getServerSideGroupLevelState:[Zs],refreshInfiniteCache:[lu],purgeInfiniteCache:[lu],getInfiniteRowCount:[lu],isLastRowIndexKnown:[lu,Zs],expandAll:[vo,Zs],collapseAll:[vo,Zs],onRowHeightChanged:[vo,Zs],setRowCount:[lu,Zs],getCacheBlockState:[lu,Zs]},QU={showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"},selectAllFiltered:{version:"v33",old:"selectAllFiltered()",new:'selectAll("filtered")'},deselectAllFiltered:{version:"v33",old:"deselectAllFiltered()",new:'deselectAll("filtered")'},selectAllOnCurrentPage:{version:"v33",old:"selectAllOnCurrentPage()",new:'selectAll("currentPage")'},deselectAllOnCurrentPage:{version:"v33",old:"deselectAllOnCurrentPage()",new:'deselectAll("currentPage")'}};function JU(e,t,i){let s=QU[e];if(s){let{version:o,new:l,old:d,message:p}=s,y=d??e;return(...C)=>{let S=l?`Please use ${l} instead. `:"";return Bp(`Since ${o} api.${y} is deprecated. ${S}${p??""}`),t.apply(t,C)}}let n=YU[e];return n?(...o)=>{let l=i.rowModel.getType();if(!n.includes(l)){fu(`api.${e} can only be called when gridOptions.rowModelType is ${n.join(" or ")}`);return}return t.apply(t,o)}:t}var ej={detailCellRendererCtrl:"SharedMasterDetail",dndSourceComp:"DragAndDrop",fillHandle:"CellSelection",groupCellRendererCtrl:"GroupCellRenderer",headerFilterCellCtrl:"ColumnFilter",headerGroupCellCtrl:"ColumnGroup",rangeHandle:"CellSelection",tooltipFeature:"Tooltip",highlightTooltipFeature:"Tooltip",tooltipStateManager:"Tooltip",groupStrategy:"RowGrouping",treeGroupStrategy:"TreeData",rowNumberRowResizer:"RowNumbers",singleCell:"EditCore",fullRow:"EditCore",agSetColumnFilterHandler:"SetFilter",agMultiColumnFilterHandler:"MultiFilter",agGroupColumnFilterHandler:"GroupFilter",agNumberColumnFilterHandler:"NumberFilter",agDateColumnFilterHandler:"DateFilter",agTextColumnFilterHandler:"TextFilter"},tj={expanded:1,contracted:1,"tree-closed":1,"tree-open":1,"tree-indeterminate":1,pin:1,"eye-slash":1,arrows:1,left:1,right:1,group:1,aggregation:1,pivot:1,"not-allowed":1,chart:1,cross:1,cancel:1,tick:1,first:1,previous:1,next:1,last:1,linked:1,unlinked:1,"color-picker":1,loading:1,menu:1,"menu-alt":1,filter:1,"filter-add":1,columns:1,maximize:1,minimize:1,copy:1,cut:1,paste:1,grip:1,save:1,csv:1,excel:1,"small-down":1,"small-left":1,"small-right":1,"small-up":1,asc:1,desc:1,none:1,up:1,down:1,plus:1,minus:1,settings:1,"checkbox-checked":1,"checkbox-indeterminate":1,"checkbox-unchecked":1,"radio-button-on":1,"radio-button-off":1,eye:1,"column-arrow":1,"un-pin":1,"pinned-top":1,"pinned-bottom":1,"chevron-up":1,"chevron-down":1,"chevron-left":1,"chevron-right":1,edit:1},ij={chart:"MenuCore",cancel:"EnterpriseCore",first:"Pagination",previous:"Pagination",next:"Pagination",last:"Pagination",linked:"IntegratedCharts",loadingMenuItems:"MenuCore",unlinked:"IntegratedCharts",menu:"ColumnHeaderComp",legacyMenu:"ColumnMenu",filter:"ColumnFilter",filterActive:"ColumnFilter",filterAdd:"NewFiltersToolPanel",filterCardCollapse:"NewFiltersToolPanel",filterCardExpand:"NewFiltersToolPanel",filterCardEditing:"NewFiltersToolPanel",filterTab:"ColumnMenu",filtersToolPanel:"FiltersToolPanel",columns:["MenuCore"],columnsToolPanel:["ColumnsToolPanel"],maximize:"EnterpriseCore",minimize:"EnterpriseCore",save:"MenuCore",columnGroupOpened:"ColumnGroupHeaderComp",columnGroupClosed:"ColumnGroupHeaderComp",accordionOpen:"EnterpriseCore",accordionClosed:"EnterpriseCore",accordionIndeterminate:"EnterpriseCore",columnSelectClosed:["ColumnsToolPanel","ColumnMenu"],columnSelectOpen:["ColumnsToolPanel","ColumnMenu"],columnSelectIndeterminate:["ColumnsToolPanel","ColumnMenu"],columnMovePin:"SharedDragAndDrop",columnMoveHide:"SharedDragAndDrop",columnMoveMove:"SharedDragAndDrop",columnMoveLeft:"SharedDragAndDrop",columnMoveRight:"SharedDragAndDrop",columnMoveGroup:"SharedDragAndDrop",columnMoveValue:"SharedDragAndDrop",columnMovePivot:"SharedDragAndDrop",dropNotAllowed:"SharedDragAndDrop",ensureColumnVisible:["ColumnsToolPanel","ColumnMenu"],groupContracted:"GroupCellRenderer",groupExpanded:"GroupCellRenderer",setFilterGroupClosed:"SetFilter",setFilterGroupOpen:"SetFilter",setFilterGroupIndeterminate:"SetFilter",setFilterLoading:"SetFilter",close:"EnterpriseCore",check:"MenuItem",colorPicker:"CommunityCore",groupLoading:"LoadingCellRenderer",menuAlt:"ColumnHeaderComp",menuPin:"MenuCore",menuValue:"MenuCore",menuAddRowGroup:["MenuCore","ColumnsToolPanel"],menuRemoveRowGroup:["MenuCore","ColumnsToolPanel"],clipboardCopy:"MenuCore",clipboardCut:"MenuCore",clipboardPaste:"MenuCore",pivotPanel:["ColumnsToolPanel","RowGroupingPanel"],rowGroupPanel:["ColumnsToolPanel","RowGroupingPanel"],valuePanel:"ColumnsToolPanel",columnDrag:"EnterpriseCore",rowDrag:["RowDrag","DragAndDrop"],csvExport:"MenuCore",excelExport:"MenuCore",smallDown:"CommunityCore",selectOpen:"CommunityCore",richSelectOpen:"RichSelect",richSelectRemove:"RichSelect",smallLeft:"CommunityCore",smallRight:"CommunityCore",subMenuOpen:"MenuItem",subMenuOpenRtl:"MenuItem",panelDelimiter:"RowGroupingPanel",panelDelimiterRtl:"RowGroupingPanel",smallUp:"CommunityCore",sortAscending:["MenuCore","Sort"],sortDescending:["MenuCore","Sort"],sortUnSort:["MenuCore","Sort"],advancedFilterBuilder:"AdvancedFilter",advancedFilterBuilderDrag:"AdvancedFilter",advancedFilterBuilderInvalid:"AdvancedFilter",advancedFilterBuilderMoveUp:"AdvancedFilter",advancedFilterBuilderMoveDown:"AdvancedFilter",advancedFilterBuilderAdd:"AdvancedFilter",advancedFilterBuilderRemove:"AdvancedFilter",advancedFilterBuilderSelectOpen:"AdvancedFilter",chartsMenu:"IntegratedCharts",chartsMenuEdit:"IntegratedCharts",chartsMenuAdvancedSettings:"IntegratedCharts",chartsMenuAdd:"IntegratedCharts",chartsColorPicker:"IntegratedCharts",chartsThemePrevious:"IntegratedCharts",chartsThemeNext:"IntegratedCharts",chartsDownload:"IntegratedCharts",checkboxChecked:"CommunityCore",checkboxIndeterminate:"CommunityCore",checkboxUnchecked:"CommunityCore",radioButtonOn:"CommunityCore",radioButtonOff:"CommunityCore",rowPin:"PinnedRow",rowUnpin:"PinnedRow",rowPinBottom:"PinnedRow",rowPinTop:"PinnedRow"},sj=new Set(["colorPicker","smallUp","checkboxChecked","checkboxIndeterminate","checkboxUnchecked","radioButtonOn","radioButtonOff","smallDown","smallLeft","smallRight"]),oj=class extends Be{constructor(){super(...arguments),this.beanName="validation"}wireBeans(e){this.gridOptions=e.gridOptions,hB(VU)}warnOnInitialPropertyUpdate(e,t){e==="api"&&XU[t]&&je(22,{key:t})}processGridOptions(e){this.processOptions(e,QW())}validateApiFunction(e,t){return JU(e,t,this.beans)}missingUserComponent(e,t,i,s){let n=_u[t];n?this.gos.assertModuleRegistered(n,`AG Grid '${e}' component: ${t}`):je(101,{propertyName:e,componentName:t,agGridDefaults:i,jsComps:s})}missingDynamicBean(e){let t=ej[e];return t?cr(200,ht(Se({},this.gos.getModuleErrorParams()),{moduleName:t,reasonOrId:e})):void 0}checkRowEvents(e){rj.has(e)&&je(10,{eventType:e})}validateIcon(e){if(sj.has(e)&&je(43,{iconName:e}),tj[e])return;let t=ij[e];if(t){li(200,{reasonOrId:`icon '${e}'`,moduleName:t,gridScoped:wb(),gridId:this.beans.context.getId(),rowModelType:this.gos.get("rowModelType"),additionalText:"Alternatively, use the CSS icon name directly."});return}je(134,{iconName:e})}isProvidedUserComp(e){return!!_u[e]}validateColDef(e){this.processOptions(e,GW())}processOptions(e,t){let{validations:i,deprecations:s,allProperties:n,propertyExceptions:o,objectName:l,docsUrl:d}=t;n&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(e,[...o??[],...Object.keys(s)],n,l,d);let p=new Set;Object.keys(e).forEach(C=>{let S=s[C];if(S){let{message:Q,version:ae}=S;p.add(`As of v${ae}, ${String(C)} is deprecated. ${Q??""}`)}let P=e[C];if(P==null||P===!1)return;let I=i[C];if(!I)return;let{dependencies:O,validate:V,supportedRowModels:G,expectedType:X}=I;if(X){let Q=typeof P;if(Q!==X){p.add(`${String(C)} should be of type '${X}' but received '${Q}' (${P}).`);return}}if(G){let Q=this.gridOptions.rowModelType??"clientSide";if(!G.includes(Q)){p.add(`${String(C)} is not supported with the '${Q}' row model. It is only valid with: ${G.join(", ")}.`);return}}if(O){let Q=this.checkForRequiredDependencies(C,O,e);if(Q){p.add(Q);return}}if(V){let Q=V(e,this.gridOptions,this.beans);if(Q){p.add(Q);return}}}),p.size>0&&p.forEach(C=>{Bp(C)})}checkForRequiredDependencies(e,t,i){let n=Object.entries(t).filter(([o,l])=>{let d=i[o];return!l.required.includes(d)});return n.length===0?null:n.map(([o,l])=>`'${String(e)}' requires '${o}' to be one of [${l.required.map(d=>d===null?"null":d===void 0?"undefined":d).join(", ")}]. ${l.reason??""}`).join(`
           `)}checkProperties(e,t,i,s,n){let o=["__ob__","__v_skip","__metadata__"],l=nj(Object.getOwnPropertyNames(e),[...o,...t,...i],i),d=Object.keys(l);for(let p of d){let y=l[p],C=`invalid ${s} property '${p}' did you mean any of these: ${y.slice(0,8).join(", ")}.`;i.includes("context")&&(C+=`
If you are trying to annotate ${s} with application data, use the '${s}.context' property instead.`),Bp(C)}if(d.length>0&&n){let p=this.beans.frameworkOverrides.getDocLink(n);Bp(`to see all the valid ${s} properties please check: ${p}`)}}};function nj(e,t,i){let s={},n=e.filter(o=>!t.some(l=>l===o));return n.length>0&&n.forEach(o=>s[o]=wC({inputValue:o,allSuggestions:i}).values),s}var rj=new Set(["firstChildChanged","lastChildChanged","childIndexChanged"]),aj={moduleName:"Validation",version:nt,beans:[oj]};function PT(e){e.sibling&&(e.sibling.childrenAfterFilter=e.childrenAfterFilter)}var lj=class extends Be{constructor(){super(...arguments),this.beanName="filterStage",this.refreshProps=new Set(["excludeChildrenWhenTreeDataFiltering"]),this.step="filter"}wireBeans(e){this.filterManager=e.filterManager}execute(e){let{changedPath:t}=e;this.filter(t)}filter(e){let t=!!this.filterManager?.isChildFilterPresent();this.filterNodes(t,e)}filterNodes(e,t){let i=(s,n)=>{s.hasChildren()&&e&&!n?s.childrenAfterFilter=s.childrenAfterGroup.filter(o=>{let l=o.childrenAfterFilter&&o.childrenAfterFilter.length>0,d=o.data&&this.filterManager.doesRowPassFilter({rowNode:o});return l||d}):s.childrenAfterFilter=s.childrenAfterGroup,PT(s)};if(this.doingTreeDataFiltering()){let s=(o,l)=>{if(o.childrenAfterGroup)for(let d=0;d<o.childrenAfterGroup.length;d++){let p=o.childrenAfterGroup[d],y=l||this.filterManager.doesRowPassFilter({rowNode:p});p.childrenAfterGroup?s(o.childrenAfterGroup[d],y):i(p,y)}i(o,l)},n=o=>s(o,!1);t.executeFromRootNode(n)}else{let s=n=>i(n,!1);t.forEachChangedNodeDepthFirst(s,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}},cj=class extends vb{constructor(){super(...arguments),this.iconCreated=!1}wireComp(e,t,i,s,n){this.comp=e;let o=rg(this,this.beans.context,n);this.eButtonShowMainFilter=i,this.eFloatingFilterBody=s,this.setGui(t,o),this.setupActive(),this.refreshHeaderStyles(),this.setupWidth(o),this.setupLeft(o),this.setupHover(o),this.setupFocus(o),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(o),this.setupUi(),o.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(o);let l=()=>this.onColDefChanged(o);o.addManagedListeners(this.column,{colDefChanged:l}),o.addManagedEventListeners({filterSwitched:({column:d})=>{d===this.column&&l()}}),o.addDestroyFunc(()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()})}resizeHeader(){}moveHeader(){}getHeaderClassParams(){let{column:e,beans:t}=this,i=e.colDef;return bt(t.gos,{colDef:i,column:e,floatingFilter:!0})}setupActive(){let e=this.column.getColDef(),t=!!e.filter,i=!!e.floatingFilter;this.active=t&&i}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;let e=tn("filter",this.beans,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new Au(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){let e=this.getLocaleTextFunc();Eu(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){let{beans:t}=this;if(zi(t)===this.eGui)return;let n=Cc(t,this.eGui,null,e.shiftKey);if(n){t.headerNavigation?.scrollToColumn(this.column),e.preventDefault(),n.focus();return}let o=this.findNextColumnWithFloatingFilter(e.shiftKey);o&&t.focusSvc.focusHeaderPosition({headerPosition:{headerRowIndex:this.rowCtrl.rowIndex,column:o},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){let t=this.beans.visibleCols,i=this.column;do if(i=e?t.getColBefore(i):t.getColAfter(i),!i)break;while(!i.getColDef().filter||!i.getColDef().floatingFilter);return i}handleKeyDown(e){super.handleKeyDown(e);let t=this.getWrapperHasFocus();switch(e.key){case Fe.UP:case Fe.DOWN:case Fe.LEFT:case Fe.RIGHT:if(t)return;mc(e);case Fe.ENTER:t&&gc(this.eGui)&&e.preventDefault();break;case Fe.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;let i=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),s=!!e.relatedTarget&&rc(e.relatedTarget,"ag-floating-filter");if(i&&s&&e.target===this.eGui){let n=this.lastFocusEvent,o=!!(n&&n.key===Fe.TAB);if(n&&o){let l=n.shiftKey;gc(this.eGui,l)}}this.focusThis()}setupHover(e){this.beans.colHover?.addHeaderFilterColumnHoverListener(e,this.comp,this.column,this.eGui)}setupLeft(e){let t=new mb(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){this.suppressFilterButton=!this.beans.menuSvc?.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!Bo(this.gos)}setupUserComp(){if(!this.active)return;let e=this.beans.colFilter?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){let e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.beans.menuSvc?.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;let{beans:{colFilter:t},column:i,gos:s}=this,n=o=>{if(o?.source==="filterDestroyed"&&(!this.isAlive()||!t?.isAlive()))return;let l=this.comp.getFloatingFilterComp();l&&l.then(d=>{if(d){if(s.get("enableFilterHandlers")){let C=o,S="filter";C?.afterFloatingFilter?S="ui":C?.afterDataChange?S="dataChanged":o?.source==="api"&&(S="api"),this.updateFloatingFilterParams(this.userCompDetails,S);return}let p=t?.getCurrentFloatingFilterParentModel(i),y=o?ht(Se({},o),{columns:o.columns??[],source:o.source==="api"?"api":"columnFilter"}):null;d.onParentModelChanged(p,y)}})};[this.destroySyncListener]=e.addManagedListeners(i,{filterChanged:n}),t?.isFilterActive(i)&&n(null)}setupWidth(e){let t=()=>{let i=`${this.column.getActualWidth()}px`;this.comp.setWidth(i)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){let e=!!this.beans.filterManager?.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(e),this.highlightFilterButtonWhenActive&&e&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){let t=this.active;this.setupActive();let i=!t&&this.active;t&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());let s=this.beans.colFilter,n=this.active?s?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,o=this.comp.getFloatingFilterComp();!o||!n?this.updateCompDetails(e,n,i):o.then(l=>{!l||s?.areFilterCompsDifferent(this.userCompDetails??null,n)?this.updateCompDetails(e,n,i):this.updateFloatingFilterParams(n,"colDef")})}updateCompDetails(e,t,i){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),i&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e,t){if(!e)return;let i=e.params;this.comp.getFloatingFilterComp()?.then(s=>{typeof s?.refresh=="function"&&(this.gos.get("enableFilterHandlers")&&(i=ht(Se({},i),{model:Ps(this.beans.colFilter?.model??{},this.column.getColId()),source:t})),s.refresh(i))})}addResizeAndMoveKeyboardListeners(){}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}};function hj(e,t){let i=e.colModel.getCol(t);if(!i){li(12,{colKey:t});return}e.menuSvc?.showColumnMenu({column:i,positionBy:"auto"})}function uj(e){e.menuSvc?.hidePopupMenu()}var dj={moduleName:"SharedMenu",version:nt,beans:[yH],apiFunctions:{showColumnMenu:hj,hidePopupMenu:uj}},pj=class extends W8{postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridCtrl=e.gridCtrl}),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)})}getDefaultPopupParent(){return this.gridCtrl.getGui()}positionPopupForMenu(e){let{eventSource:t,ePopup:i,event:s}=e,n=t.getBoundingClientRect(),o=this.getParentRect();this.setAlignedTo(t,i);let l=!1,d=()=>{let p=this.keepXYWithinBounds(i,n.top-o.top,0),y=i.clientWidth>0?i.clientWidth:200;l||(i.style.minWidth=`${y}px`,l=!0);let S=o.right-o.left-y,P;return this.gos.get("enableRtl")?(P=O(),P<0&&(P=I(),this.setAlignedStyles(i,"left")),P>S&&(P=0,this.setAlignedStyles(i,"right"))):(P=I(),P>S&&(P=O(),this.setAlignedStyles(i,"right")),P<0&&(P=0,this.setAlignedStyles(i,"left"))),{x:P,y:p};function I(){return n.right-o.left-2}function O(){return n.left-o.left-y}};this.positionPopup({ePopup:i,keepWithinBounds:!0,updatePosition:d,postProcessCallback:()=>this.callPostProcessPopup(e,"subMenu",i,t,s instanceof MouseEvent?s:void 0)})}callPostProcessPopup(e,t,i,s,n){let o=this.gos.getCallback("postProcessPopup");if(o){let{column:l,rowNode:d}=e;o({column:l,rowNode:d,ePopup:i,type:t,eventSource:s,mouseEvent:n})}}getActivePopups(){return this.popupList.map(e=>e.element)}handleThemeChange(e){if(e.themeChanged){let t=this.beans.environment;for(let i of this.popupList)t.applyThemeClasses(i.wrapper)}}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isStopPropagation(e){return ea(e)}},Ev={moduleName:"Popup",version:nt,beans:[pj]},gj=".ag-set-filter{--ag-indentation-level:0}.ag-set-filter-item{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-set-filter-item{padding-left:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}:where(.ag-rtl) .ag-set-filter-item{padding-right:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}.ag-set-filter-item-checkbox{display:flex;height:100%;width:100%}.ag-set-filter-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr) .ag-set-filter-group-icons{margin-right:var(--ag-widget-container-horizontal-padding)}:where(.ag-rtl) .ag-set-filter-group-icons{margin-left:var(--ag-widget-container-horizontal-padding)}.ag-filter-body-wrapper{display:flex;flex-direction:column}:where(.ag-menu:not(.ag-tabs) .ag-filter) .ag-filter-body-wrapper,:where(.ag-menu:not(.ag-tabs) .ag-filter)>:not(.ag-filter-wrapper){min-width:180px}.ag-filter-filter{flex:1 1 0px}.ag-filter-condition{display:flex;justify-content:center}.ag-floating-filter-body{display:flex;flex:1 1 auto;height:100%;position:relative}.ag-floating-filter-full-body{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;width:100%}:where(.ag-floating-filter-full-body)>div{flex:1 1 auto}.ag-floating-filter-input{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}:where(.ag-input-field-input[type=date]),:where(.ag-input-field-input[type=datetime-local]){width:1px}}.ag-floating-filter-button{display:flex;flex:none}.ag-date-floating-filter-wrapper{display:flex}.ag-set-floating-filter-input :where(input)[disabled]{pointer-events:none}.ag-floating-filter-button-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;height:var(--ag-icon-size);width:var(--ag-icon-size)}.ag-filter-loading{align-items:unset;background-color:var(--ag-chrome-background-color);height:100%;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;width:100%;z-index:1;:where(.ag-menu) &{background-color:var(--ag-menu-background-color)}}.ag-filter-separator{border-top:solid var(--ag-border-width) var(--menu-separator-color)}:where(.ag-filter-select) .ag-picker-field-wrapper{width:0}.ag-filter-condition-operator{height:17px}:where(.ag-ltr) .ag-filter-condition-operator-or{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-condition-operator-or{margin-right:calc(var(--ag-spacing)*2)}.ag-set-filter-select-all{padding-top:var(--ag-widget-container-vertical-padding)}.ag-filter-no-matches,.ag-set-filter-list{height:calc(var(--ag-list-item-height)*6)}.ag-filter-no-matches{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-set-filter-tree-list{height:calc(var(--ag-list-item-height)*10)}.ag-set-filter-filter{margin-left:var(--ag-widget-container-horizontal-padding);margin-right:var(--ag-widget-container-horizontal-padding);margin-top:var(--ag-widget-container-vertical-padding)}.ag-filter-to{margin-top:var(--ag-widget-vertical-spacing)}.ag-mini-filter{margin:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}:where(.ag-ltr) .ag-set-filter-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-rtl) .ag-set-filter-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-filter-menu) .ag-set-filter-list{min-width:200px}.ag-filter-virtual-list-item:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-filter-apply-panel{display:flex;justify-content:flex-end;overflow:hidden;padding:var(--ag-widget-vertical-spacing) var(--ag-widget-container-horizontal-padding) var(--ag-widget-container-vertical-padding)}.ag-filter-apply-panel-button{line-height:1.5}:where(.ag-ltr) .ag-filter-apply-panel-button{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-apply-panel-button{margin-right:calc(var(--ag-spacing)*2)}.ag-simple-filter-body-wrapper{display:flex;flex-direction:column;min-height:calc(var(--ag-list-item-height) + var(--ag-widget-container-vertical-padding) + var(--ag-widget-vertical-spacing));overflow-y:auto;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);padding-bottom:calc(var(--ag-widget-container-vertical-padding) - var(--ag-widget-vertical-spacing));&>*{margin-bottom:var(--ag-widget-vertical-spacing)}:where(.ag-resizer-wrapper){margin:0}}.ag-multi-filter-menu-item{margin:var(--ag-spacing) 0}.ag-multi-filter-group-title-bar{background-color:transparent;color:var(--ag-header-text-color);font-weight:500;padding:calc(var(--ag-spacing)*1.5) var(--ag-spacing)}.ag-group-filter-field-select-wrapper{display:flex;flex-direction:column;gap:var(--ag-widget-vertical-spacing);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}";function fj(e){let t=e.filterManager;return!!t?.isColumnFilterPresent()||!!t?.isAggregateFilterPresent()}function mj(e,t){return e.filterManager?.getColumnFilterInstance(t)??Promise.resolve(void 0)}function vj(e,t){let i=e.colModel.getColDefCol(t);if(i)return e.colFilter?.destroyFilter(i,"api")}function yj(e,t){e.frameworkOverrides.wrapIncoming(()=>e.filterManager?.setFilterModel(t))}function wj(e){return e.filterManager?.getFilterModel()??{}}function Cj(e,t,i){let{gos:s,colModel:n,colFilter:o}=e;i&&!s.get("enableFilterHandlers")&&(je(288),i=!1);let l=n.getColDefCol(t);return l?o?.getModelForColumn(l,i)??null:null}function bj(e,t,i){return e.filterManager?.setColumnFilterModel(t,i)??Promise.resolve()}function xj(e,t){let i=e.colModel.getCol(t);if(!i){li(12,{colKey:t});return}e.menuSvc?.showFilterMenu({column:i,containerType:"columnFilter",positionBy:"auto"})}function _j(e){e.menuSvc?.hideFilterMenu()}function Sj(e,t){let i=e.colModel.getCol(t);if(!i){li(12,{colKey:t});return}return e.colFilter?.getHandler(i,!0)}function Rj(e,t){let{colModel:i,colFilter:s,gos:n}=e;if(!n.get("enableFilterHandlers")){je(287);return}let{colId:o,action:l}=t;if(o){let d=i.getColById(o);d&&s?.updateModel(d,l)}else s?.updateAllModels(l)}var Ej={filterHandler:()=>({doesFilterPass:()=>!0})},Pj=class extends Be{constructor(){super(...arguments),this.beanName="colFilter",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.modelUpdates=[],this.columnModelUpdates=[],this.state=new Map,this.handlerMap=Se({},wM),this.isGlobalButtons=!1,this.activeFilterComps=new Set}postConstruct(){this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)});let e=this.gos,t=Se({},e.get("initialState")?.filter?.filterModel??{});this.initialModel=t,this.model=Se({},t),e.get("enableFilterHandlers")||delete this.handlerMap.agMultiColumnFilter}refreshModel(){this.onNewRowsLoaded("rowDataUpdated")}setModel(e,t="api",i){let{colModel:s,dataTypeSvc:n,filterManager:o}=this.beans;if(n?.isPendingInference){this.modelUpdates.push({model:e,source:t});return}let l=[],d=this.getModel(!0);if(e){let p=new Set(Object.keys(e));this.allColumnFilters.forEach((y,C)=>{let S=e[C];l.push(this.setModelOnFilterWrapper(y,S)),p.delete(C)}),p.forEach(y=>{let C=s.getColDefCol(y)||s.getCol(y);if(!C){je(62,{colId:y});return}if(!C.isFilterAllowed()){je(63,{colId:y});return}let S=this.getOrCreateFilterWrapper(C,!0);if(!S){je(64,{colId:y});return}l.push(this.setModelOnFilterWrapper(S,e[y],!0))})}else this.model={},this.allColumnFilters.forEach(p=>{l.push(this.setModelOnFilterWrapper(p,null))});Ui.all(l).then(()=>{let p=this.getModel(!0),y=[];this.allColumnFilters.forEach((C,S)=>{let P=d?d[S]:null,I=p?p[S]:null;Wp(P,I)||y.push(C.column)}),y.length>0?o?.onFilterChanged({columns:y,source:t}):i&&this.updateActive("filterChanged")})}getModel(e){let t={},{allColumnFilters:i,initialModel:s,beans:{colModel:n}}=this;if(i.forEach((o,l)=>{let d=this.getModelFromFilterWrapper(o);st(d)&&(t[l]=d)}),!e)for(let o of Object.keys(s)){let l=s[o];st(l)&&!i.has(o)&&n.getCol(o)?.isFilterAllowed()&&(t[o]=l)}return t}setState(e,t,i="api"){if(this.state.clear(),t)for(let s of Object.keys(t)){let n=t[s];this.state.set(s,{model:Ps(this.model,s),state:n})}this.setModel(e,i,!0)}getState(){let e=this.state;if(!e.size)return;let t={},i=!1;return e.forEach((s,n)=>{let o=s.state;o!=null&&(i=!0,t[n]=o)}),i?t:void 0}getModelFromFilterWrapper(e){let i=e.column.getColId();if(e.isHandler)return Ps(this.model,i);let s=e.filter;return s?typeof s.getModel!="function"?(je(66),null):s.getModel():Ps(this.initialModel,i)}isFilterPresent(){return this.activeColumnFilters.length>0}isAggFilterPresent(){return!!this.activeAggregateFilters.length}disableFilters(){this.initialModel={};let{allColumnFilters:e}=this;return e.size?(e.forEach(t=>this.disposeFilterWrapper(t,"advancedFilterEnabled")),!0):!1}updateActiveFilters(){let e=y=>y?y.isFilterActive?y.isFilterActive():(je(67),!1):!1,{colModel:t,gos:i}=this.beans,s=!!dC(i),n=y=>{if(!y.isPrimary())return!0;let S=!t.isPivotActive();return!y.isValueActive()||!S?!1:t.isPivotMode()?!0:s},o=[],l=[],d=(y,C,S)=>{C&&(n(y)?o.push(S):l.push(S))},p=[];return this.allColumnFilters.forEach(y=>{let C=y.column,S=C.getColId();if(y.isHandler)p.push(Ui.resolve().then(()=>{d(C,this.isHandlerActive(C),{colId:S,isHandler:!0,handler:y.handler,handlerParams:y.handlerParams})}));else{let P=Ka(y);P&&p.push(P.then(I=>{d(C,e(I),{colId:S,isHandler:!1,comp:I})}))}}),Ui.all(p).then(()=>{this.activeAggregateFilters=o,this.activeColumnFilters=l})}updateFilterFlagInColumns(e,t){let i=[];return this.allColumnFilters.forEach(s=>{let n=s.column;if(s.isHandler)i.push(Ui.resolve().then(()=>{this.setColFilterActive(n,this.isHandlerActive(n),e,t)}));else{let o=Ka(s);o&&i.push(o.then(l=>{this.setColFilterActive(n,l.isFilterActive(),e,t)}))}}),this.beans.groupFilter?.updateFilterFlags(e,t),Ui.all(i)}doFiltersPass(e,t,i){let{data:s,aggData:n}=e,o=i?this.activeAggregateFilters:this.activeColumnFilters,l=i?n:s,d=this.model;for(let p=0;p<o.length;p++){let y=o[p],{colId:C,isHandler:S}=y;if(C!==t)if(S){let{handler:P,handlerParams:I}=y;if(!P.doesFilterPass({node:e,data:l,model:Ps(d,C),handlerParams:I}))return!1}else{let P=y.comp;if(typeof P.doesFilterPass!="function"){li(91);continue}if(!P.doesFilterPass({node:e,data:l}))return!1}}return!0}getHandlerParams(e){let t=this.allColumnFilters.get(e.getColId());return t?.isHandler?t.handlerParams:void 0}callOnFilterChangedOutsideRenderCycle(e){let{rowRenderer:t,filterManager:i}=this.beans,s=()=>{this.isAlive()&&i?.onFilterChanged(e)};t.isRefreshInProgress()?setTimeout(s,0):s()}updateBeforeFilterChanged(e={}){let{column:t,additionalEventAttributes:i}=e,s=t?.getColId();return this.updateActiveFilters().then(()=>this.updateFilterFlagInColumns("filterChanged",i).then(()=>{this.allColumnFilters.forEach(n=>{let{column:o,isHandler:l}=n;s!==o.getColId()&&(l&&n.handler.onAnyFilterChanged?.(),Ka(n,l)?.then(d=>{typeof d?.onAnyFilterChanged=="function"&&d.onAnyFilterChanged()}))}),this.processingFilterChange=!0}))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(e){let t=[];this.allColumnFilters.forEach(i=>{let s=i.isHandler;s&&i.handler.onNewRowsLoaded?.();let n=Ka(i,s);n&&t.push(n.then(o=>{o.onNewRowsLoaded?.()}))}),Ui.all(t).then(()=>this.updateActive(e,{afterDataChange:!0}))}updateActive(e,t){this.updateFilterFlagInColumns(e,t).then(()=>this.updateActiveFilters())}createGetValue(e,t){let{filterValueSvc:i,colModel:s}=this.beans;return(n,o)=>{let l=o?s.getCol(o):e;return l?i.getValue(l,n,t):void 0}}isFilterActive(e){let t=this.cachedFilter(e);if(t?.isHandler)return this.isHandlerActive(e);let i=t?.filter;return i?i.isFilterActive():Ps(this.initialModel,e.getColId())!=null}isHandlerActive(e){let t=st(Ps(this.model,e.getColId()));if(t)return t;let i=this.beans.groupFilter;return i?.isGroupFilter(e)?i.isFilterActive(e):!1}getOrCreateFilterUi(e){let t=this.getOrCreateFilterWrapper(e,!0);return t?Ka(t):null}getFilterUiForDisplay(e){let t=this.getOrCreateFilterWrapper(e,!0);if(!t)return null;let i=Ka(t);return i?i.then(s=>({comp:s,params:t.filterUi.filterParams,isHandler:t.isHandler})):null}getHandler(e,t){let i=this.getOrCreateFilterWrapper(e,t);return i?.isHandler?i.handler:void 0}getOrCreateFilterWrapper(e,t){if(!e.isFilterAllowed())return;let i=this.cachedFilter(e);return!i&&t&&(i=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,i)),i}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e,t=!1){return this.getDefaultFilterFromDataType(()=>this.beans.dataTypeSvc?.getBaseDataType(e),t)}getDefaultFilterFromDataType(e,t=!1){return RB(this.gos)?t?"agSetColumnFloatingFilter":"agSetColumnFilter":hV(e(),t)}getDefaultFloatingFilter(e){return this.getDefaultFilter(e,!0)}createFilterComp(e,t,i,s,n,o){let l=()=>{let y=this.createFilterCompParams(e,n,o),C=s(y,n);return P5(this.beans.userCompFactory,t,C,i)},d=l();return d?{compDetails:d,createFilterUi:y=>(y?l():d).newAgStackInstance()}:null}createFilterInstance(e,t,i,s){let n=this.beans.selectableFilter;n?.isSelectable(t)&&(t=n.getFilterDef(e,t));let{handler:o,handlerParams:l,handlerGenerator:d}=this.createHandler(e,t,i)??{},p=this.createFilterComp(e,t,i,s,!!o,"init");if(!p)return{compDetails:null,createFilterUi:null,handler:o,handlerGenerator:d,handlerParams:l};let{compDetails:y,createFilterUi:C}=p;return this.isGlobalButtons&&(y.params?.buttons?.length||je(281,{colId:e.getColId()})),{compDetails:y,handler:o,handlerGenerator:d,handlerParams:l,createFilterUi:C}}createBaseFilterParams(e,t){let{filterManager:i,rowModel:s}=this.beans;return bt(this.gos,{column:e,colDef:e.getColDef(),getValue:this.createGetValue(e),doesRowPassOtherFilter:t?()=>!0:n=>i?.doesRowPassOtherFilters(e.getColId(),n)??!0,rowModel:s})}createFilterCompParams(e,t,i,s){let n=this.filterChangedCallbackFactory(e),o=this.createBaseFilterParams(e,s);if(o.filterChangedCallback=n,o.filterModifiedCallback=s?()=>{}:l=>this.filterModified(e,l),t){let l=o,d=e.getColId(),p=Ps(this.model,d);l.model=p,l.state=this.state.get(d)??{model:p},l.onModelChange=(y,C)=>{this.updateStoredModel(d,y),this.refreshHandlerAndUi(e,y,"ui").then(()=>{n(ht(Se({},C),{source:"columnFilter"}))})},l.onStateChange=y=>{this.updateState(e,y),this.updateOrRefreshFilterUi(e)},l.onAction=(y,C,S)=>{this.updateModel(e,y,C),this.dispatchLocalEvent({type:"filterAction",column:e,action:y,event:S})},l.getHandler=()=>this.getHandler(e,!0),l.onUiChange=y=>this.filterUiChanged(e,y),l.source=i}return o}createFilterUiForHandler(e,t){return t?{created:!1,create:t,filterParams:e.params,compDetails:e}:null}createFilterUiLegacy(e,t,i){let s=t(),n={created:!0,create:t,filterParams:e.params,compDetails:e,promise:s};return s.then(i),n}createFilterWrapper(e){let{compDetails:t,handler:i,handlerGenerator:s,handlerParams:n,createFilterUi:o}=this.createFilterInstance(e,e.getColDef(),this.getDefaultFilter(e),d=>d),l=e.getColId();if(i)return delete this.initialModel[l],i.init?.(ht(Se({},n),{source:"init",model:Ps(this.model,l)})),{column:e,isHandler:!0,handler:i,handlerGenerator:s,handlerParams:n,filterUi:this.createFilterUiForHandler(t,o)};if(o){let d={column:e,filterUi:null,isHandler:!1};return d.filterUi=this.createFilterUiLegacy(t,o,p=>{d.filter=p??void 0}),d}return{column:e,filterUi:null,isHandler:!1}}createHandlerFunc(e,t,i){let{gos:s,frameworkOverrides:n,registry:o}=this.beans,l,d=I=>{let O=I.filter;if(YP(O)){let V=O.handler;return V||(l=O.doesFilterPass,l?()=>({doesFilterPass:l}):void 0)}return typeof O=="string"?O:void 0},p=s.get("enableFilterHandlers"),y=p?d(t):void 0,C=I=>()=>this.createBean(o.createDynamicBean(I,!0)),S,P;if(typeof y=="string"){let I=s.get("filterHandlers")?.[y];I!=null?S=I:Q8.has(y)&&(S=C(y),P=y)}else S=y;if(!S){let I,{compName:O,jsComp:V,fwComp:G}=eM(n,t);O?I=O:V==null&&G==null&&t.filter===!0&&(I=i),P=this.handlerMap[I],P&&(S=C(P))}return S?{filterHandler:S,handlerNameOrCallback:l??P}:p?(Ms(s)&&je(277,{colId:e.getColId()}),Ej):void 0}createHandler(e,t,i){let s=this.createHandlerFunc(e,t,i);if(!s)return;let n=Fw(this.beans.userCompFactory,t,this.createFilterCompParams(e,!0,"init")),{handlerNameOrCallback:o,filterHandler:l}=s,{handler:d,handlerParams:p}=this.createHandlerFromFunc(e,l,n);return{handler:d,handlerParams:p,handlerGenerator:o??l}}createHandlerFromFunc(e,t,i){let s=e.getColDef(),n=t(bt(this.gos,{column:e,colDef:s})),o=this.createHandlerParams(e,i);return{handler:n,handlerParams:o}}createHandlerParams(e,t){let i=e.getColDef(),s=e.getColId(),n=this.filterChangedCallbackFactory(e);return bt(this.gos,{colDef:i,column:e,getValue:this.createGetValue(e),doesRowPassOtherFilter:o=>this.beans.filterManager?.doesRowPassOtherFilters(s,o)??!0,onModelChange:(o,l)=>{this.updateStoredModel(s,o),this.refreshHandlerAndUi(e,o,"handler").then(()=>{n(ht(Se({},l),{source:"columnFilter"}))})},filterParams:t})}onColumnsChanged(){let e=[],{colModel:t,filterManager:i,groupFilter:s}=this.beans;this.allColumnFilters.forEach((o,l)=>{let d;o.column.isPrimary()?d=t.getColDefCol(l):d=t.getCol(l),!(d&&d===o.column)&&(e.push(o.column),this.disposeFilterWrapper(o,"columnChanged"),this.disposeColumnListener(l))});let n=s&&e.every(o=>s.isGroupFilter(o));e.length>0&&!n&&i?.onFilterChanged({columns:e,source:"api"})}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;let i=this.beans.groupFilter;return i?.isGroupFilter(e)?i.isFilterAllowed(e):!0}getFloatingFilterCompDetails(e,t){let{userCompFactory:i,frameworkOverrides:s,selectableFilter:n}=this.beans,o=P=>{let I=this.getOrCreateFilterUi(e);I?.then(O=>{P(Yp(O))})},l=e.getColDef(),d=n?.isSelectable(l)?n.getFilterDef(e,l):l,p=fV(s,d,()=>this.getDefaultFloatingFilter(e))??"agReadOnlyFloatingFilter",y=this.gos.get("enableFilterHandlers"),C=Fw(i,d,this.createFilterCompParams(e,y,"init",!0)),S=bt(this.gos,{column:e,filterParams:C,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:o,showParentFilter:t});if(y){let P=S,I=e.getColId(),O=this.filterChangedCallbackFactory(e);P.onUiChange=V=>this.floatingFilterUiChanged(e,V),P.model=Ps(this.model,I),P.onModelChange=(V,G)=>{this.updateStoredModel(I,V),this.refreshHandlerAndUi(e,V,"floating",!0).then(()=>{O(ht(Se({},G),{source:"columnFilter"}))})},P.getHandler=()=>this.getHandler(e,!0),P.source="init"}return I5(i,l,S,p)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilterUi(e,t,i,s){if(e.isHandler){let n=t.getColId();delete this.initialModel[n],this.state.delete(n);let o=e.filterUi,l=this.createFilterUiForHandler(i,s);e.filterUi=l,o?.created&&o.promise.then(d=>{this.destroyBean(d),this.eventSvc.dispatchEvent({type:"filterDestroyed",source:"paramsUpdated",column:e.column})})}else this.destroyFilter(t,"paramsUpdated")}destroyFilter(e,t="api"){let i=e.getColId(),s=this.allColumnFilters.get(i);this.disposeColumnListener(i),delete this.initialModel[i],s&&this.disposeFilterWrapper(s,t).then(n=>{n&&this.isAlive()&&this.beans.filterManager?.onFilterChanged({columns:[e],source:"api"})})}disposeColumnListener(e){let t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){let i=!1,{column:s,isHandler:n,filterUi:o}=e,l=s.getColId();n&&(i=this.isHandlerActive(s),this.destroyBean(e.handler),delete this.model[l],this.state.delete(l));let d=()=>{this.setColFilterActive(s,!1,"filterDestroyed"),this.allColumnFilters.delete(l),this.eventSvc.dispatchEvent({type:"filterDestroyed",source:t,column:s})};if(o){if(o.created)return o.promise.then(p=>(i=n?i:!!p?.isFilterActive(),this.destroyBean(p),d(),i));d()}return Ui.resolve(i)}filterChangedCallbackFactory(e){return t=>{this.callOnFilterChangedOutsideRenderCycle({additionalEventAttributes:t,columns:[e],column:e,source:t?.source??"columnFilter"})}}filterParamsChanged(e,t="api"){let i=this.allColumnFilters.get(e);if(!i)return;let s=this.beans,n=i.column,o=n.getColDef(),l=n.isFilterAllowed(),d=this.getDefaultFilter(n),p=s.selectableFilter,y=p?.isSelectable(o)?p.getFilterDef(n,o):o,C=l?this.createHandlerFunc(n,y,this.getDefaultFilter(n)):void 0,S=!!C,P=i.isHandler;if(P!=S){this.destroyFilter(n,"paramsUpdated");return}let{compDetails:I,createFilterUi:O}=(l?this.createFilterComp(n,y,d,G=>G,S,"colDef"):null)??{compDetails:null,createFilterUi:null},V=I?.params??Fw(s.userCompFactory,y,this.createFilterCompParams(n,S,"colDef"));if(P){let G=C?.handlerNameOrCallback??C?.filterHandler,X=Ps(this.model,e);if(i.handlerGenerator!=G){let Q=i.handler,{handler:ae,handlerParams:me}=this.createHandlerFromFunc(n,C.filterHandler,V);i.handler=ae,i.handlerParams=me,i.handlerGenerator=G,delete this.model[e],ae.init?.(ht(Se({},me),{source:"init",model:null})),this.destroyBean(Q),X!=null&&this.beans.filterManager?.onFilterChanged({columns:[n],source:t})}else{let Q=this.createHandlerParams(n,I?.params);i.handlerParams=Q,i.handler.refresh?.(ht(Se({},Q),{source:"colDef",model:X}))}}if(this.areFilterCompsDifferent(i.filterUi?.compDetails??null,I)||!i.filterUi||!I){this.destroyFilterUi(i,n,I,O);return}i.filterUi.filterParams=V,Ka(i,P)?.then(G=>{(G?.refresh?G.refresh(V):!0)===!1?this.destroyFilterUi(i,n,I,O):this.dispatchLocalEvent({type:"filterParamsChanged",column:n,params:V})})}refreshHandlerAndUi(e,t,i,s){let n=this.cachedFilter(e);if(!n)return s&&this.getOrCreateFilterWrapper(e,!0),Ui.resolve();if(!n.isHandler)return Ui.resolve();let{filterUi:o,handler:l,handlerParams:d}=n;return J8(()=>{if(o){let{created:p,filterParams:y}=o;if(p)return o.promise.then(C=>C?{filter:C,filterParams:y}:void 0);o.refreshed=!0}return Ui.resolve(void 0)},l,d,t,this.state.get(e.getColId())??{model:t},i)}setColumnFilterWrapper(e,t){let i=e.getColId();this.allColumnFilters.set(i,t),this.allColumnListeners.set(i,this.addManagedListeners(e,{colDefChanged:()=>this.filterParamsChanged(i)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;let{componentClass:i}=e,{componentClass:s}=t;return!(i===s||i?.render&&s?.render&&i.render===s.render)}hasFloatingFilters(){return this.beans.colModel.getCols().some(t=>t.getColDef().floatingFilter)}getFilterInstance(e){let t=this.beans.colModel.getColDefCol(e);if(!t)return Promise.resolve(void 0);let i=this.getOrCreateFilterUi(t);return i?new Promise(s=>{i.then(n=>{s(Yp(n))})}):Promise.resolve(null)}processFilterModelUpdateQueue(){this.modelUpdates.forEach(({model:e,source:t})=>this.setModel(e,t)),this.modelUpdates=[],this.columnModelUpdates.forEach(({key:e,model:t,resolve:i})=>{this.setModelForColumn(e,t).then(()=>i())}),this.columnModelUpdates=[]}getModelForColumn(e,t){if(t){let{state:s,model:n}=this,o=e.getColId(),l=s.get(o);return l?l.model??null:Ps(n,o)}let i=this.cachedFilter(e);return i?this.getModelFromFilterWrapper(i):null}setModelForColumn(e,t){if(this.beans.dataTypeSvc?.isPendingInference){let i=()=>{},s=new Promise(n=>{i=n});return this.columnModelUpdates.push({key:e,model:t,resolve:i}),s}return new Promise(i=>{this.setModelForColumnLegacy(e,t).then(s=>i(s))})}getStateForColumn(e){return this.state.get(e)??{model:Ps(this.model,e)}}setModelForColumnLegacy(e,t){let i=this.beans.colModel.getColDefCol(e),s=i?this.getOrCreateFilterWrapper(i,!0):null;return s?this.setModelOnFilterWrapper(s,t):Ui.resolve()}setColDefPropsForDataType(e,t,i){let s=e.filter,n=s===!0?this.getDefaultFilterFromDataType(()=>t.baseDataType):s;if(typeof n!="string")return;let o,l,d=this.beans,{filterParams:p,filterValueGetter:y}=e;n==="agMultiColumnFilter"?{filterParams:o,filterValueGetter:l}=d.multiFilter?.getParamsForDataType(p,y,t,i)??{}:{filterParams:o,filterValueGetter:l}=aV(n,p,y,t,i,d,this.getLocaleTextFunc()),e.filterParams=o,l&&(e.filterValueGetter=l)}setColFilterActive(e,t,i,s){e.filterActive!==t&&(e.filterActive=t,e.dispatchColEvent("filterActiveChanged",i)),e.dispatchColEvent("filterChanged",i,s)}setModelOnFilterWrapper(e,t,i){return new Ui(s=>{if(e.isHandler){let o=e.column,l=o.getColId(),d=this.model[l];if(this.updateStoredModel(l,t),i&&t===d){s();return}this.refreshHandlerAndUi(o,t,"api").then(()=>s());return}let n=Ka(e);if(n){n.then(o=>{if(typeof o?.setModel!="function"){je(65),s();return}(o.setModel(t)||Ui.resolve()).then(()=>s())});return}s()})}updateStoredModel(e,t){st(t)?this.model[e]=t:delete this.model[e];let i=this.state.get(e),s={model:t,state:i?.state};this.state.set(e,s)}filterModified(e,t){this.getOrCreateFilterUi(e)?.then(i=>{this.eventSvc.dispatchEvent(Se({type:"filterModified",column:e,filterInstance:i},t))})}filterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent(Se({type:"filterUiChanged",column:e},t))}floatingFilterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent(Se({type:"floatingFilterUiChanged",column:e},t))}updateModel(e,t,i){let s=e.getColId(),n=this.cachedFilter(e),o=()=>n?.filterUi;oE(t,o,()=>Ps(this.model,s),()=>this.state.get(s),l=>this.updateState(e,l),l=>o()?.filterParams?.onModelChange(l,i),n?.isHandler?n.handler.processModelToApply?.bind(n.handler):void 0)}updateAllModels(e,t){let i=[];this.allColumnFilters.forEach((s,n)=>{let o=this.beans.colModel.getColDefCol(n);o&&oE(e,()=>s.filterUi,()=>Ps(this.model,n),()=>this.state.get(n),l=>this.updateState(o,l),l=>{this.updateStoredModel(n,l),this.dispatchLocalEvent({type:"filterAction",column:o,action:e}),i.push(this.refreshHandlerAndUi(o,l,"ui"))},s?.isHandler?s.handler.processModelToApply?.bind(s.handler):void 0)}),i.length&&Ui.all(i).then(()=>{this.callOnFilterChangedOutsideRenderCycle({source:"columnFilter",additionalEventAttributes:t,columns:[]})})}updateOrRefreshFilterUi(e){let t=e.getColId();bM(()=>this.cachedFilter(e)?.filterUi,()=>Ps(this.model,t),()=>this.state.get(t))}updateState(e,t){this.state.set(e.getColId(),t),this.dispatchLocalEvent({type:"filterStateChanged",column:e,state:t})}canApplyAll(){let{state:e,model:t,activeFilterComps:i}=this;for(let n of i)if(n.source==="COLUMN_MENU")return!1;let s=!1;for(let n of e.keys()){let o=e.get(n);if(o.valid===!1)return!1;(o.model??null)!==Ps(t,n)&&(s=!0)}return s}hasUnappliedModel(e){let{model:t,state:i}=this;return(i.get(e)?.model??null)!==Ps(t,e)}setGlobalButtons(e){this.isGlobalButtons=e,this.dispatchLocalEvent({type:"filterGlobalButtons",isGlobal:e})}shouldKeepStateOnDetach(e,t){if(t==="newFiltersToolPanel")return!0;let i=this.beans.filterPanelSvc;return i?.isActive?!!i.getState(e.getColId()):!1}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear(),this.state.clear(),this.activeFilterComps.clear()}};function Mj(e){return!!e.filterManager?.isAnyFilterPresent()}function Tj(e,t="api"){e.filterManager?.onFilterChanged({source:t})}var Dj=class extends Be{constructor(){super(...arguments),this.beanName="filterManager",this.advFilterModelUpdateQueue=[]}wireBeans(e){this.quickFilter=e.quickFilter,this.advancedFilter=e.advancedFilter,this.colFilter=e.colFilter}postConstruct(){let e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:({enabled:s})=>this.onAdvFilterEnabledChanged(s),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.quickFilter&&this.addManagedListeners(this.quickFilter,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})});let{gos:i}=this;this.alwaysPassFilter=i.get("alwaysPassFilter"),this.addManagedPropertyListener("alwaysPassFilter",()=>{this.alwaysPassFilter=i.get("alwaysPassFilter"),this.onFilterChanged({source:"api"})})}isExternalFilterPresentCallback(){let e=this.gos.getCallback("isExternalFilterPresent");return typeof e=="function"&&e({})}doesExternalFilterPass(e){let t=this.gos.get("doesExternalFilterPass");return typeof t=="function"&&t(e)}setFilterState(e,t,i="api"){this.isAdvFilterEnabled()||this.colFilter?.setState(e,t,i)}setFilterModel(e,t="api",i){if(this.isAdvFilterEnabled()){i||this.warnAdvFilters();return}this.colFilter?.setModel(e,t)}getFilterModel(){return this.colFilter?.getModel()??{}}getFilterState(){return this.colFilter?.getState()}isColumnFilterPresent(){return!!this.colFilter?.isFilterPresent()}isAggregateFilterPresent(){return!!this.colFilter?.isAggFilterPresent()}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.externalFilterPresent||this.isAdvFilterPresent()}isAnyFilterPresent(){return this.isChildFilterPresent()||this.isAggregateFilterPresent()}isAdvFilterPresent(){return this.isAdvFilterEnabled()&&this.advancedFilter.isFilterPresent()}onAdvFilterEnabledChanged(e){e?this.colFilter?.disableFilters()&&this.onFilterChanged({source:"advancedFilter"}):this.advancedFilter?.isFilterPresent()&&(this.advancedFilter.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvFilterEnabled(){return!!this.advancedFilter?.isEnabled()}isAdvFilterHeaderActive(){return this.isAdvFilterEnabled()&&this.advancedFilter.isHeaderActive()}refreshFiltersForAggregations(){dC(this.gos)&&this.isAnyFilterPresent()&&this.onFilterChanged()}onFilterChanged(e={}){let{source:t,additionalEventAttributes:i,columns:s=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.colFilter?this.colFilter.updateBeforeFilterChanged(e):Ui.resolve()).then(()=>{let n={source:t,type:"filterChanged",columns:s};i&&no(n,i),this.eventSvc.dispatchEvent(n),this.colFilter?.updateAfterFilterChanged()})}isSuppressFlashingCellsBecauseFiltering(){return!!this.colFilter?.isSuppressFlashingCellsBecauseFiltering()}isQuickFilterPresent(){return!!this.quickFilter?.isFilterPresent()}updateAggFiltering(){this.aggFiltering=!!dC(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.beans.colModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,colIdToSkip:e})}doesRowPassAggregateFilters(e){let{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.isAggregateFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip,!0))}doesRowPassFilter(e){let{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.externalFilterPresent&&!this.doesExternalFilterPass(t)||this.isColumnFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip)||this.isAdvFilterPresent()&&!this.advancedFilter.doesFilterPass(t))}isFilterAllowed(e){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.isFilterAllowed(e)}getAdvFilterModel(){return this.isAdvFilterEnabled()?this.advancedFilter.getModel():null}setAdvFilterModel(e,t="api"){if(this.isAdvFilterEnabled()){if(this.beans.dataTypeSvc?.isPendingInference){this.advFilterModelUpdateQueue.push(e);return}this.advancedFilter.setModel(e??null),this.onFilterChanged({source:t})}}toggleAdvFilterBuilder(e,t){this.isAdvFilterEnabled()&&this.advancedFilter.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvFilterColumns(){this.isAdvFilterEnabled()&&this.advancedFilter.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.hasFloatingFilters()}getColumnFilterInstance(e){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve(void 0)):this.colFilter?.getFilterInstance(e)??Promise.resolve(void 0)}warnAdvFilters(){je(68)}setupAdvFilterHeaderComp(e){this.advancedFilter?.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvFilterHeaderActive()?this.advancedFilter.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){this.advFilterModelUpdateQueue.forEach(e=>this.setAdvFilterModel(e)),this.advFilterModelUpdateQueue=[]}setColumnFilterModel(e,t){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve()):this.colFilter?.setModelForColumn(e,t)??Promise.resolve()}},Fj=class extends Be{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupSvc=e.popupSvc}hideActiveMenu(){this.hidePopup?.()}showMenuAfterMouseEvent(e,t,i,s){e&&!e.isColumn||this.showPopup(e,n=>{this.popupSvc?.positionPopupUnderMouseEvent({column:e,type:i,mouseEvent:t,ePopup:n})},i,t.target,Bo(this.gos),s)}showMenuAfterButtonClick(e,t,i,s){if(e&&!e.isColumn)return;let n=-1,o="left",l=Bo(this.gos);!l&&this.gos.get("enableRtl")&&(n=1,o="right");let d=l?void 0:4*n,p=l?void 0:4;this.showPopup(e,y=>{this.popupSvc?.positionPopupByComponent({type:i,eventSource:t,ePopup:y,nudgeX:d,nudgeY:p,alignSide:o,keepWithinBounds:!0,position:"under",column:e})},i,t,l,s)}showPopup(e,t,i,s,n,o){let l=e?this.createBean(new nV(e,"COLUMN_MENU")):void 0;if(this.activeMenu=l,!l?.hasFilter()||!e){li(57);return}let d=rs({tag:"div",cls:`ag-menu${n?"":" ag-filter-menu"}`,role:"presentation"});[this.tabListener]=this.addManagedElementListeners(d,{keydown:V=>this.trapFocusWithin(V,d)}),d.appendChild(l?.getGui());let p,y=()=>l?.afterGuiDetached(),C=EB(this.gos)?s??this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody:void 0,S=V=>{dE(e,!1,"contextMenu");let G=V instanceof KeyboardEvent;this.tabListener&&(this.tabListener=this.tabListener()),G&&s&&ur(s)&&rM(s)?.focus({preventScroll:!0}),y(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,i,e),o?.()},P=this.getLocaleTextFunc(),I=n&&i!=="columnFilter"?P("ariaLabelColumnMenu","Column Menu"):P("ariaLabelColumnFilter","Column Filter"),O=this.popupSvc?.addPopup({modal:!0,eChild:d,closeOnEsc:!0,closedCallback:S,positionCallback:()=>t(d),anchorToElement:C,ariaLabel:I});O&&(this.hidePopup=p=O.hideFunc),l.afterInit().then(()=>{t(d),l.afterGuiAttached({container:i,hidePopup:p})}),dE(e,!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,i,e)}trapFocusWithin(e,t){e.key!==Fe.TAB||e.defaultPrevented||Cc(this.beans,t,!1,e.shiftKey)||(e.preventDefault(),gc(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,i){this.eventSvc.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:i??null,columnGroup:null})}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},Ij=class extends Be{constructor(){super(...arguments),this.beanName="filterValueSvc"}getValue(e,t,i){if(!t)return;let s=e.getColDef(),{selectableFilter:n,valueSvc:o}=this.beans,l=i??n?.getFilterValueGetter(e.getColId())??s.filterValueGetter;return l?this.executeFilterValueGetter(l,t.data,e,t,s):o.getValue(e,t)}executeFilterValueGetter(e,t,i,s,n){let{expressionSvc:o,valueSvc:l}=this.beans,d=bt(this.gos,{data:t,node:s,column:i,colDef:n,getValue:l.getValueCallback.bind(l,s)});return typeof e=="function"?e(d):o?.evaluate(e,d)}},kj={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eFloatingFilterText"}]},Aj=class extends ii{constructor(){super(kj,[Cv]),this.eFloatingFilterText=ot}init(e){this.params=e;let t=this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0);if(this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`),this.gos.get("enableFilterHandlers")){let i=e,s=i.getHandler();if(s.getModelAsString){let n=s.getModelAsString(i.model);this.eFloatingFilterText.setValue(n)}}}onParentModelChanged(e){if(e==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(t=>{if(t.getModelAsString){let i=t.getModelAsString(e);this.eFloatingFilterText.setValue(i)}})}refresh(e){this.init(e)}},Pb=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions??t,this.mapCustomOptions(),this.defaultOption=this.getDefaultItem(e.defaultOption)}refresh(e,t){let i=e.filterOptions??t;this.filterOptions!==i&&(this.filterOptions=i,this.customFilterOptions={},this.mapCustomOptions()),this.defaultOption=this.getDefaultItem(e.defaultOption)}mapCustomOptions(){let{filterOptions:e}=this;e&&e.forEach(t=>{if(typeof t=="string")return;let i=[["displayKey"],["displayName"],["predicate","test"]],s=n=>n.some(o=>t[o]!=null)?!0:(je(72,{keys:n}),!1);if(!i.every(s)){this.filterOptions=e.filter(n=>n===t)||[];return}this.customFilterOptions[t.displayKey]=t})}getDefaultItem(e){let{filterOptions:t}=this;if(e)return e;if(t.length>=1){let i=t[0];if(typeof i=="string")return i;if(i.displayKey)return i.displayKey;je(73)}else je(74)}getCustomOption(e){return this.customFilterOptions[e]}};function Gp(e,t,i){return i==null?e.splice(t):e.splice(t,i)}function mv(e){return e==null||typeof e=="string"&&e.trim().length===0}function Lj(e){return e==="AND"||e==="OR"?e:"AND"}function Oj(e,t,i){if(e==null)return;let{predicate:s}=e;if(s!=null&&!t.some(n=>n==null))return s(t,i)}function zj(e,t){let i=e.length;return i>t&&(e.splice(t),je(78),i=t),i}function sg(e,t){let i=t.getCustomOption(e);if(i){let{numberOfInputs:n}=i;return n??1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:e==="inRange"?2:1}var Mb=class extends gV{constructor(e,t,i){super(e,"simple-filter"),this.mapValuesFromModel=t,this.defaultOptions=i,this.eTypes=[],this.eJoinPanels=[],this.eJoinAnds=[],this.eJoinOrs=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}setParams(e){super.setParams(e);let t=new Pb;this.optionsFactory=t,t.init(e,this.defaultOptions),this.commonUpdateSimpleParams(e),this.createOption(),this.createMissingConditionsAndOperators()}updateParams(e,t){this.optionsFactory.refresh(e,this.defaultOptions),super.updateParams(e,t),this.commonUpdateSimpleParams(e)}commonUpdateSimpleParams(e){this.setNumConditions(e),this.defaultJoinOperator=Lj(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.createFilterListOptions();let t=this.getGui();this.isReadOnly()?t.setAttribute("tabindex","-1"):t.removeAttribute("tabindex")}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged("immediately",!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach((t,i)=>{let s=i===0?e:this.optionsFactory.defaultOption;t.setValue(s,!0)})}getModelFromUi(){let e=this.getUiCompleteConditions();return e.length===0?null:this.maxNumConditions>1&&e.length>1?{filterType:this.filterType,operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){let{eJoinOrs:e,defaultJoinOperator:t}=this;return e.length===0?t:e[0].getValue()===!0?"OR":"AND"}areNonNullModelsEqual(e,t){let i=!e.operator,s=!t.operator;if(!i&&s||i&&!s)return!1;let o;if(i){let l=e,d=t;o=this.areSimpleModelsEqual(l,d)}else{let l=e,d=t;o=l.operator===d.operator&&rl(l.conditions,d.conditions,(p,y)=>this.areSimpleModelsEqual(p,y))}return o}setModelIntoUi(e,t){if(e==null)return this.resetUiToDefaults(t),Ui.resolve();if(e.operator){let s=e,n=s.conditions;n==null&&(n=[],je(77));let o=zj(n,this.maxNumConditions),l=this.getNumConditions();if(o<l)this.removeConditionsAndOperators(o);else if(o>l)for(let p=l;p<o;p++)this.createJoinOperatorPanel(),this.createOption();let d=s.operator==="OR";this.eJoinAnds.forEach(p=>p.setValue(!d,!0)),this.eJoinOrs.forEach(p=>p.setValue(d,!0)),n.forEach((p,y)=>{this.eTypes[y].setValue(p.type,!0),this.setConditionIntoUi(p,y)})}else{let s=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(s.type,!0),this.setConditionIntoUi(s,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.updateUiVisibility(),t||this.params.onUiChange(this.getUiChangeEventParams()),Ui.resolve()}setNumConditions(e){let t=e.maxNumConditions??2;t<1&&(je(79),t=1),this.maxNumConditions=t;let i=e.numAlwaysVisibleConditions??1;i<1&&(je(80),i=1),i>t&&(je(81),i=t),this.numAlwaysVisibleConditions=i}createOption(){let e=this.getGui(),t=this.createManagedBean(new ob);this.eTypes.push(t),t.addCss("ag-filter-select"),e.appendChild(t.getGui());let i=this.createEValue();this.eConditionBodies.push(i),e.appendChild(i),this.putOptionsIntoDropdown(t),this.resetType(t);let s=this.getNumConditions()-1;this.forEachPositionInput(s,n=>this.resetInput(n)),this.addChangedListeners(t,s)}createJoinOperatorPanel(){let e=rs({tag:"div",cls:"ag-filter-condition"});this.eJoinPanels.push(e);let t=this.createJoinOperator(this.eJoinAnds,e,"and"),i=this.createJoinOperator(this.eJoinOrs,e,"or");this.getGui().appendChild(e);let s=this.eJoinPanels.length-1,n=this.joinOperatorId++;this.resetJoinOperatorAnd(t,s,n),this.resetJoinOperatorOr(i,s,n),this.isReadOnly()||(t.onValueChange(this.listener),i.onValueChange(this.listener))}createJoinOperator(e,t,i){let s=this.createManagedBean(new q5);e.push(s);let n="ag-filter-condition-operator";return s.addCss(n),s.addCss(`${n}-${i}`),t.appendChild(s.getGui()),s}createFilterListOptions(){this.filterListOptions=this.optionsFactory.filterOptions.map(e=>typeof e=="string"?this.createBoilerplateListOption(e):this.createCustomListOption(e))}putOptionsIntoDropdown(e){let{filterListOptions:t}=this;t.forEach(i=>{e.addOption(i)}),e.setDisabled(t.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){let{displayKey:t}=e,i=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:i?this.getLocaleTextFunc()(i.displayKey,i.displayName):this.translate(t)}}createBodyTemplate(){return null}getAgComponents(){return[]}updateUiVisibility(){let e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let i=0;i<this.getNumConditions();i++)this.isConditionUiComplete(i)?e=i:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{let i=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<i){this.removeConditionsAndOperators(i+1);let s=e+1,n=i-s;n>0&&this.removeConditionsAndOperators(s,n),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach((s,n)=>{let o=this.isConditionDisabled(n,e);s.setDisabled(o||this.filterListOptions.length<=1),n===1&&($p(this.eJoinPanels[0],o),this.eJoinAnds[0].setDisabled(o),this.eJoinOrs[0].setDisabled(o))}),this.eConditionBodies.forEach((s,n)=>{Ti(s,this.isConditionBodyVisible(n))});let i=(t??this.getJoinOperator())==="OR";this.eJoinAnds.forEach(s=>{s.setValue(!i,!0)}),this.eJoinOrs.forEach(s=>{s.setValue(i,!0)}),this.forEachInput((s,n,o,l)=>{this.setElementDisplayed(s,n<l),this.setElementDisabled(s,this.isConditionDisabled(o,e))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;let{eTypes:i,eConditionBodies:s,eJoinPanels:n,eJoinAnds:o,eJoinOrs:l}=this;this.removeComponents(i,e,t),this.removeElements(s,e,t),this.removeEValues(e,t);let d=Math.max(e-1,0);this.removeElements(n,d,t),this.removeComponents(o,d,t),this.removeComponents(l,d,t)}removeElements(e,t,i){Gp(e,t,i).forEach(n=>yo(n))}removeComponents(e,t,i){Gp(e,t,i).forEach(n=>{yo(n.getGui()),this.destroyBean(n)})}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!e?.suppressFocus){let t;if(!this.isReadOnly()){let i=this.getInputs(0)[0];i instanceof oc&&this.isConditionBodyVisible(0)?t=i.getInputElement():t=this.eTypes[0]?.getFocusableElement()}(t??this.getGui()).focus({preventScroll:!0})}}afterGuiDetached(){super.afterGuiDetached();let e=this.params;if(this.beans.colFilter?.shouldKeepStateOnDetach(e.column))return;e.onStateChange({model:e.model});let t=-1,i=-1,s=!1,n=this.getJoinOperator();for(let l=this.getNumConditions()-1;l>=0;l--)if(this.isConditionUiComplete(l))t===-1&&(t=l,i=l);else{let d=l>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(l-1),p=l<t;(d||p)&&(this.removeConditionsAndOperators(l,1),s=!0,p&&i--)}let o=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),o=!0),this.shouldAddNewConditionAtEnd(i===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),o=!0),o&&this.updateConditionStatusesAndValues(i,n),s&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=i}getModelAsString(e){return this.params.getHandler()?.getModelAsString?.(e)??""}getPlaceholderText(e,t){let i=this.translate(e);if(typeof this.filterPlaceholder=="function"){let s=this.eTypes[t].getValue(),n=this.translate(s);i=this.filterPlaceholder({filterOptionKey:s,filterOption:n,placeholder:i})}else typeof this.filterPlaceholder=="string"&&(i=this.filterPlaceholder);return i}resetPlaceholder(){let e=this.getLocaleTextFunc();this.forEachInput((t,i,s,n)=>{if(!(t instanceof oc))return;let o=i===0&&n>1?"inRangeStart":i===0?"filterOoo":"inRangeEnd",l=i===0&&n>1?e("ariaFilterFromValue","Filter from value"):i===0?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");t.setInputPlaceholder(this.getPlaceholderText(o,s)),t.setInputAriaLabel(l)})}setElementValue(e,t,i){e instanceof oc&&e.setValue(t!=null?String(t):null,!0)}setElementDisplayed(e,t){ZR(e)&&Ti(e.getGui(),t)}setElementDisabled(e,t){ZR(e)&&$p(e.getGui(),t)}attachElementOnChange(e,t){e instanceof oc&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach((t,i)=>{this.forEachPositionTypeInput(i,t,e)})}forEachPositionInput(e,t){let i=this.getConditionType(e);this.forEachPositionTypeInput(e,i,t)}forEachPositionTypeInput(e,t,i){let s=sg(t,this.optionsFactory),n=this.getInputs(e);for(let o=0;o<n.length;o++){let l=n[o];l!=null&&i(l,o,e,s)}}isConditionDisabled(e,t){return this.isReadOnly()?!0:e===0?!1:e>t+1}isConditionBodyVisible(e){let t=this.getConditionType(e);return sg(t,this.optionsFactory)>0}isConditionUiComplete(e){return!(e>=this.getNumConditions()||this.getConditionType(e)==="empty"||this.getValues(e).some(i=>i==null))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){let e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(t=>this.resetType(t)),this.eJoinAnds.forEach((t,i)=>this.resetJoinOperatorAnd(t,i,this.joinOperatorId+i)),this.eJoinOrs.forEach((t,i)=>this.resetJoinOperatorOr(t,i,this.joinOperatorId+i)),this.joinOperatorId++,this.forEachInput(t=>this.resetInput(t)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,this.updateUiVisibility(),e||this.params.onUiChange(this.getUiChangeEventParams())}resetType(e){let i=this.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.defaultOption,!0).setAriaLabel(i).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,i){this.resetJoinOperator(e,t,this.defaultJoinOperator==="AND",this.translate("andCondition"),i)}resetJoinOperatorOr(e,t,i){this.resetJoinOperator(e,t,this.defaultJoinOperator==="OR",this.translate("orCondition"),i)}resetJoinOperator(e,t,i,s,n){this.updateJoinOperatorDisabled(e.setValue(i,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${n}`).setLabel(s),t)}updateJoinOperatorsDisabled(){let e=(t,i)=>this.updateJoinOperatorDisabled(t,i);this.eJoinAnds.forEach(e),this.eJoinOrs.forEach(e)}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){let i=this.mapValuesFromModel(e,this.optionsFactory);this.forEachInput((s,n,o)=>{o===t&&this.setElementValue(s,i[n]!=null?i[n]:null)})}setValueFromFloatingFilter(e){this.forEachInput((t,i,s)=>{this.setElementValue(t,i===0&&s===0?e:null,!0)})}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,i=>{this.attachElementOnChange(i,this.listener)}))}hasInvalidInputs(){return!1}isReadOnly(){return!!this.params.readOnly}},MT=class{constructor(e,t,i,s,n,o){this.alive=!0,this.context=e,this.eParent=n;let l=M5(t,i,s);l&&l.newAgStackInstance().then(d=>{if(!this.alive){e.destroyBean(d);return}if(this.dateComp=d,!d)return;n.appendChild(d.getGui()),d?.afterGuiAttached?.();let{tempValue:p,disabled:y}=this;p&&d.setDate(p),y!=null&&d.setDisabled?.(y),o?.(this)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){let t=this.dateComp;t?t.setDate(e):this.tempValue=e}setDisabled(e){let t=this.dateComp;t?t.setDisabled?.(e):this.disabled=e}setDisplayed(e){Ti(this.eParent,e)}setInputPlaceholder(e){this.dateComp?.setInputPlaceholder?.(e)}setInputAriaLabel(e){this.dateComp?.setInputAriaLabel?.(e)}afterGuiAttached(e){this.dateComp?.afterGuiAttached?.(e)}updateParams(e){this.dateComp?.refresh?.(e)}},Tb=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"];function TT(e,t){let{dateFrom:i,dateTo:s,type:n}=e||{};return[i&&Co(i,void 0,!0)||null,s&&Co(s,void 0,!0)||null].slice(0,sg(n,t))}var $E=1e3,qE=1/0,Bj=class extends Mb{constructor(){super("dateFilter",TT,Tb),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=$E,this.maxValidYear=qE,this.minValidDate=null,this.maxValidDate=null,this.filterType="date"}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}commonUpdateSimpleParams(e){super.commonUpdateSimpleParams(e);let t=(p,y)=>{let C=e[p];if(C!=null)if(isNaN(C))je(82,{param:p});else return C==null?y:Number(C);return y},i=t("minValidYear",$E),s=t("maxValidYear",qE);this.minValidYear=i,this.maxValidYear=s,i>s&&je(83);let{minValidDate:n,maxValidDate:o}=e,l=n instanceof Date?n:Co(n);this.minValidDate=l;let d=o instanceof Date?o:Co(o);this.maxValidDate=d,l&&d&&l>d&&je(84)}createDateCompWrapper(e){let{beans:{userCompFactory:t,context:i,gos:s},params:n}=this,o=new MT(i,t,n.colDef,bt(s,{onDateChanged:()=>this.onUiChanged(),filterParams:n,location:"filter"}),e);return this.addDestroyFunc(()=>o.destroy()),o}setElementValue(e,t){e.setDate(t)}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}createEValue(){let e=rs({tag:"div",cls:"ag-filter-body"});return this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e}createFromToElement(e,t,i,s){let n=rs({tag:"div",cls:`ag-filter-${s} ag-filter-date-${s}`});t.push(n),e.appendChild(n),i.push(this.createDateCompWrapper(n))}removeEValues(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),Gp(this.eConditionPanelsFrom,e,t),Gp(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,i){Gp(e,t,i).forEach(n=>n.destroy())}isValidDateValue(e){if(e===null)return!1;let{minValidDate:t,maxValidDate:i,minValidYear:s,maxValidYear:n}=this;if(t){if(e<t)return!1}else if(e.getUTCFullYear()<s)return!1;if(i){if(e>i)return!1}else if(e.getUTCFullYear()>n)return!1;return!0}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachInput((i,s,n,o)=>{n!==e||!t||s>=o||(t=t&&this.isValidDateValue(i.getDate()))}),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}createCondition(e){let t=this.getConditionType(e),i={},s=this.getValues(e),n=this.params.useIsoSeparator?"T":" ";return s.length>0&&(i.dateFrom=Vo(s[0],!0,n)),s.length>1&&(i.dateTo=Vo(s[1],!0,n)),Se({dateFrom:null,dateTo:null,filterType:this.filterType,type:t},i)}resetPlaceholder(){let e=this.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),i=e("ariaFilterValue","Filter Value");this.forEachInput(s=>{s.setInputPlaceholder(t),s.setInputAriaLabel(i)})}getInputs(e){let{dateConditionFromComps:t,dateConditionToComps:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}getValues(e){let t=[];return this.forEachPositionInput(e,(i,s,n,o)=>{s<o&&t.push(i.getDate())}),t}translate(e){return e==="lessThan"?super.translate("before"):e==="greaterThan"?super.translate("after"):super.translate(e)}},DT=class extends Be{constructor(e,t){super(),this.mapValuesFromModel=e,this.defaultOptions=t}init(e){let t=e.filterParams,i=new Pb;this.optionsFactory=i,i.init(t,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(i,t)),this.updateParams(e),this.validateModel(e)}refresh(e){if(e.source==="colDef"){let t=e.filterParams,i=this.optionsFactory;i.refresh(t,this.defaultOptions),this.filterModelFormatter.updateParams({optionsFactory:i,filterParams:t}),this.updateParams(e)}this.validateModel(e)}updateParams(e){this.params=e}doesFilterPass(e){let t=e.model;if(t==null)return!0;let{operator:i}=t,s=[];if(i){let l=t;s.push(...l.conditions??[])}else s.push(t);let n=i&&i==="OR"?"some":"every",o=this.params.getValue(e.node);return s[n](l=>this.individualConditionPasses(e,l,o))}getModelAsString(e,t){return this.filterModelFormatter.getModelAsString(e,t)??""}validateModel(e){let{model:t,filterParams:{filterOptions:i,maxNumConditions:s}}=e;if(t==null)return;let o=SM(t)?t.conditions:[t],l=i?.map(C=>typeof C=="string"?C:C.displayKey)??this.defaultOptions;if(!(!o||o.every(C=>l.find(S=>S===C.type)!==void 0))){this.params=ht(Se({},e),{model:null}),e.onModelChange(null);return}let p=!1,y=this.filterType;if((o&&!o.every(C=>C.filterType===y)||t.filterType!==y)&&(o=o.map(C=>ht(Se({},C),{filterType:y})),p=!0),typeof s=="number"&&o&&o.length>s&&(o=o.slice(0,s),p=!0),p){let C=o.length>1?ht(Se({},t),{filterType:y,conditions:o}):ht(Se({},o[0]),{filterType:y});this.params=ht(Se({},e),{model:C}),e.onModelChange(C);return}}individualConditionPasses(e,t,i){let s=this.optionsFactory,n=this.mapValuesFromModel(t,s),o=s.getCustomOption(t.type),l=Oj(o,n,i);return l??(i==null?this.evaluateNullValue(t.type):this.evaluateNonNullValue(n,i,t,e))}},FT=class extends DT{evaluateNullValue(e){let{includeBlanksInEquals:t,includeBlanksInNotEqual:i,includeBlanksInGreaterThan:s,includeBlanksInLessThan:n,includeBlanksInRange:o}=this.params.filterParams;switch(e){case"equals":if(t)return!0;break;case"notEqual":if(i)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(s)return!0;break;case"lessThan":case"lessThanOrEqual":if(n)return!0;break;case"inRange":if(o)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,i){let s=i.type;if(!this.isValid(t))return s==="notEqual"||s==="notBlank";let n=this.comparator(),o=e[0]!=null?n(e[0],t):0;switch(s){case"equals":return o===0;case"notEqual":return o!==0;case"greaterThan":return o>0;case"greaterThanOrEqual":return o>=0;case"lessThan":return o<0;case"lessThanOrEqual":return o<=0;case"inRange":{let l=n(e[1],t);return this.params.filterParams.inRangeInclusive?o>=0&&l<=0:o>0&&l<0}case"blank":return mv(t);case"notBlank":return!mv(t);default:return je(76,{filterModelType:s}),!0}}},IT={equals:"Equals",notEqual:"NotEqual",greaterThan:"GreaterThan",greaterThanOrEqual:"GreaterThanOrEqual",lessThan:"LessThan",lessThanOrEqual:"LessThanOrEqual",inRange:"InRange"},Vj={contains:"Contains",notContains:"NotContains",equals:"TextEquals",notEqual:"TextNotEqual",startsWith:"StartsWith",endsWith:"EndsWith",inRange:"InRange"},Db=class extends Be{constructor(e,t,i){super(),this.optionsFactory=e,this.filterParams=t,this.valueFormatter=i}getModelAsString(e,t){let i=this.getLocaleTextFunc(),s=t==="filterToolPanel";if(!e)return s?Ja(this,"filterSummaryInactive"):null;if(e.operator!=null){let o=e,d=(o.conditions??[]).map(y=>this.getModelAsString(y,t)),p=o.operator==="AND"?"andCondition":"orCondition";return d.join(` ${Ja(this,p)} `)}else{if(e.type==="blank"||e.type==="notBlank")return s?Ja(this,e.type==="blank"?"filterSummaryBlank":"filterSummaryNotBlank"):i(e.type,e.type);{let o=e,l=this.optionsFactory.getCustomOption(o.type),{displayKey:d,displayName:p,numberOfInputs:y}=l||{};return d&&p&&y===0?i(d,p):this.conditionToString(o,s,o.type==="inRange"||y===2,d,p)}}}updateParams(e){let{optionsFactory:t,filterParams:i}=e;this.optionsFactory=t,this.filterParams=i}conditionForToolPanel(e,t,i,s,n,o){let l,d=this.getTypeKey(e);return d&&(l=Ja(this,d)),n&&o&&(l=this.getLocaleTextFunc()(n,o)),l!=null?t?`${l} ${Ja(this,"filterSummaryInRangeValues",[i(),s()])}`:`${l} ${i()}`:null}getTypeKey(e){let t=this.filterTypeKeys[e];return t?`filterSummary${t}`:null}formatValue(e){let t=this.valueFormatter;return t?t(e??null)??"":String(e)}},kT=class extends Db{constructor(e,t){super(e,t,i=>{let{dataTypeSvc:s,valueSvc:n}=this.beans,o=t.column,d=s?.getDateFormatterFunction(o)?.(i??void 0);return n.formatValue(o,null,d)}),this.filterTypeKeys=IT}conditionToString(e,t,i,s,n){let{type:o}=e,l=Co(e.dateFrom),d=Co(e.dateTo),p=this.filterParams.inRangeFloatingFilterDateFormat,y=t?this.formatValue.bind(this):P=>yC(P,p),C=()=>l!==null?y(l):"null",S=()=>d!==null?y(d):"null";if(t){let P=this.conditionForToolPanel(o,i,C,S,s,n);if(P!=null)return P}return i?`${C()}-${S()}`:l!=null?y(l):`${o}`}};function Hj(e,t){let i=t;return i<e?-1:i>e?1:0}var Nj=class extends FT{constructor(){super(TT,Tb),this.filterType="date",this.FilterModelFormatterClass=kT}comparator(){return this.params.filterParams.comparator??Hj}isValid(e){let t=this.params.filterParams.isValidDate;return!t||t(e)}},AT=class extends ii{constructor(){super(...arguments),this.defaultDebounceMs=0}setLastTypeFromModel(e){if(!e){this.lastType=this.optionsFactory.defaultOption;return}let t=e.operator,i;t?i=e.conditions[0]:i=e,this.lastType=i.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;let i=e;return this.isTypeEditable(i.type)}init(e){this.params=e;let t=this.gos.get("enableFilterHandlers");if(this.reactive=t,this.setParams(e),t){let i=e;this.onModelUpdated(i.model)}}setParams(e){let t=new Pb;this.optionsFactory=t,t.init(e.filterParams,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(t,e.filterParams)),this.setSimpleParams(e,!1)}setSimpleParams(e,t=!0){let i=this.optionsFactory.defaultOption;t||(this.lastType=i),this.readOnly=!!e.filterParams.readOnly;let s=this.isTypeEditable(i);this.setEditable(s)}refresh(e){this.params=e;let t=e,i=this.reactive;if((!i||t.source==="colDef")&&this.updateParams(e),i){let{source:s,model:n}=t;if(s==="dataChanged"||s==="ui")return;this.onModelUpdated(n)}}updateParams(e){let t=this.optionsFactory;t.refresh(e.filterParams,this.defaultOptions),this.setSimpleParams(e),this.filterModelFormatter.updateParams({optionsFactory:t,filterParams:e.filterParams})}onParentModelChanged(e,t){t?.afterFloatingFilter||t?.afterDataChange||this.onModelUpdated(e)}hasSingleInput(e){let t=this.optionsFactory.getCustomOption(e)?.numberOfInputs;return t==null||t==1}isTypeEditable(e){let t=["inRange","empty","blank","notBlank"];return!!e&&!this.readOnly&&this.hasSingleInput(e)&&t.indexOf(e)<0}getAriaLabel(e){return`${this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0)} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},Gj={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eReadOnlyText"},{tag:"div",ref:"eDateWrapper",cls:"ag-date-floating-filter-wrapper"}]},Wj=class extends AT{constructor(){super(Gj,[Cv]),this.eReadOnlyText=ot,this.eDateWrapper=ot,this.FilterModelFormatterClass=kT,this.filterType="date",this.defaultOptions=Tb}setParams(e){super.setParams(e),this.createDateComponent();let t=this.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}updateParams(e){super.updateParams(e),this.dateComp.updateParams(this.getDateComponentParams()),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){let t=!this.readOnly&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){let i=e?Co(e.dateFrom):null;this.dateComp.setDate(i),this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){Ti(this.eDateWrapper,e),Ti(this.eReadOnlyText.getGui(),!e)}onModelUpdated(e){super.setLastTypeFromModel(e),this.updateCompOnModelChange(e)}onDateChanged(){let e=this.dateComp.getDate();if(this.reactive){let t=this.params;t.onUiChange();let i=t.model,s=Vo(e),n=s==null?null:ht(Se({},i??{filterType:this.filterType,type:this.lastType??this.optionsFactory.defaultOption}),{dateFrom:s});t.onModelChange(n,{afterFloatingFilter:!0})}else this.params.parentFilterInstance(t=>{t?.onFloatingFilterChanged(this.lastType||null,e)})}getDateComponentParams(){let{filterParams:e}=this.params,t=cb(e,this.defaultDebounceMs);return bt(this.gos,{onDateChanged:Hs(this,this.onDateChanged.bind(this),t),filterParams:e,location:"floatingFilter"})}createDateComponent(){let{beans:{context:e,userCompFactory:t},eDateWrapper:i,params:s}=this;this.dateComp=new MT(e,t,s.column.getColDef(),this.getDateComponentParams(),i,n=>{n.setInputAriaLabel(this.getAriaLabel(s))}),this.addDestroyFunc(()=>this.dateComp.destroy())}},Uj={tag:"div",cls:"ag-filter-filter",children:[{tag:"ag-input-text-field",ref:"eDateInput",cls:"ag-date-filter"}]},jj=class extends ii{constructor(){super(Uj,[Cv]),this.eDateInput=ot,this.isApply=!1,this.applyOnFocusOut=!1}init(e){this.params=e,this.setParams(e);let t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus({preventScroll:!0})},input:this.handleInput.bind(this,!1),change:this.handleInput.bind(this,!0),focusout:this.handleFocusOut.bind(this)})}handleInput(e){if(!this.eDateInput.isDisabled()){if(this.isApply){this.applyOnFocusOut=!e,e&&this.params.onDateChanged();return}e||this.params.onDateChanged()}}handleFocusOut(){this.applyOnFocusOut&&(this.applyOnFocusOut=!1,this.params.onDateChanged())}setParams(e){let t=this.eDateInput.getInputElement(),i=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=i&&ll();let{minValidYear:s,maxValidYear:n,minValidDate:o,maxValidDate:l,buttons:d,includeTime:p,colDef:y}=e.filterParams||{},C=this.beans.dataTypeSvc,S=p??C?.getDateIncludesTimeFlag?.(y.cellDataType)??!1;if(i?S?(t.type="datetime-local",t.step="1"):t.type="date":t.type="text",o&&s&&je(85),l&&n&&je(86),o&&l){let[P,I]=[o,l].map(O=>O instanceof Date?O:Co(O));P&&I&&P.getTime()>I.getTime()&&je(87)}o?o instanceof Date?t.min=yC(o):t.min=o:s&&(t.min=`${s}-01-01`),l?l instanceof Date?t.max=yC(l):t.max=l:n&&(t.max=`${n}-12-31`),this.isApply=e.location==="floatingFilter"&&!!d?.includes("apply")}refresh(e){this.params=e,this.setParams(e)}getDate(){return Co(this.eDateInput.getValue())}setDate(e){let t=this.params.filterParams.colDef.cellDataType,i=this.beans.dataTypeSvc?.getDateIncludesTimeFlag(t)??!1;this.eDateInput.setValue(Vo(e,i))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){(!e||!e.suppressFocus)&&this.eDateInput.getInputElement().focus({preventScroll:!0})}shouldUseBrowserDatePicker(e){return e?.filterParams?.browserDatePicker??!0}},Fb=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"];function BC(e){let{allowedCharPattern:t}=e??{};return t??null}function VC(e){return e==null||isNaN(e)?null:e}function LT(e,t){let{filter:i,filterTo:s,type:n}=e||{};return[VC(i),VC(s)].slice(0,sg(n,t))}var $j=class extends Mb{constructor(){super("numberFilter",LT,Fb),this.eValuesFrom=[],this.eValuesTo=[],this.filterType="number",this.defaultDebounceMs=500}setElementValue(e,t,i){let{numberFormatter:s}=this.params,n=!i&&s?s(t??null):t;super.setElementValue(e,n)}createEValue(){let e=BC(this.params),t=rs({tag:"div",cls:"ag-filter-body",role:"presentation"});return this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,i,s){let n=this.createManagedBean(s?new bc({allowedCharPattern:s}):new sb);n.addCss(`ag-filter-${i}`),n.addCss("ag-filter-filter"),t.push(n),e.appendChild(n.getGui())}removeEValues(e,t){let i=s=>this.removeComponents(s,e,t);i(this.eValuesFrom),i(this.eValuesTo)}getValues(e){let t=[];return this.forEachPositionInput(e,(i,s,n,o)=>{s<o&&t.push(VC(this.stringToFloat(i.getValue())))}),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}stringToFloat(e){if(typeof e=="number")return e;let t=Qr(e);t!=null&&t.trim()===""&&(t=null);let i=this.params.numberParser;return i?i(t):t==null||t.trim()==="-"?null:parseFloat(t)}createCondition(e){let t=this.getConditionType(e),i={filterType:this.filterType,type:t},s=this.getValues(e);return s.length>0&&(i.filter=s[0]),s.length>1&&(i.filterTo=s[1]),i}getInputs(e){let{eValuesFrom:t,eValuesTo:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>{if(!t.getInputElement().validity.valid){e=!0;return}}),e}},OT=class extends Db{constructor(e,t){super(e,t,t.numberFormatter),this.filterTypeKeys=IT}conditionToString(e,t,i,s,n){let{filter:o,filterTo:l,type:d}=e,p=this.formatValue.bind(this);if(t){let y=this.conditionForToolPanel(d,i,()=>p(o),()=>p(l),s,n);if(y!=null)return y}return i?`${p(o)}-${p(l)}`:o!=null?p(o):`${d}`}},qj=class extends FT{constructor(){super(LT,Fb),this.filterType="number",this.FilterModelFormatterClass=OT}comparator(){return(e,t)=>e===t?0:e<t?1:-1}isValid(e){return!isNaN(e)}},zT=class extends Be{constructor(e){super(),this.params=e,this.eInput=ot,this.onValueChanged=()=>{}}setupGui(e){this.eInput=this.createManagedBean(new bc(this.params?.config));let t=this.eInput.getGui();e.appendChild(t);let i=s=>this.onValueChanged(s);this.addManagedListeners(t,{input:i,keydown:i})}setEditable(e){this.eInput.setDisabled(!e)}getValue(){return this.eInput.getValue()}setValue(e,t){this.eInput.setValue(e,t)}setValueChangedListener(e){this.onValueChanged=e}setParams({ariaLabel:e,autoComplete:t}){let{eInput:i}=this;i.setInputAriaLabel(e),t!==void 0&&i.setAutoComplete(t)}};function HC(e){let t=e?.trim();return t===""?e:t}function BT(e,t){let{filter:i,filterTo:s,type:n}=e||{};return[i||null,s||null].slice(0,sg(n,t))}var Zj={tag:"div",ref:"eFloatingFilterInputContainer",cls:"ag-floating-filter-input",role:"presentation"},VT=class extends AT{constructor(){super(...arguments),this.eFloatingFilterInputContainer=ot,this.defaultDebounceMs=500}postConstruct(){this.setTemplate(Zj)}onModelUpdated(e){this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.inputSvc.setValue(this.filterModelFormatter.getModelAsString(e))}setParams(e){this.setupFloatingFilterInputService(e),super.setParams(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.inputSvc=this.createFloatingFilterInputService(e),this.inputSvc.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){let t=e.browserAutoComplete??!1,{inputSvc:i,defaultDebounceMs:s,readOnly:n}=this;if(i.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:t}),this.applyActive=xv(e.filterParams),!n){let o=cb(e.filterParams,s),l=Hs(this,this.syncUpWithParentFilter.bind(this),o);i.setValueChangedListener(l)}}updateParams(e){super.updateParams(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){let{inputSvc:t}=this,i=t.getValue();Ns(this.eFloatingFilterInputContainer),this.destroyBean(t),this.setupFloatingFilterInputService(e),t.setValue(i,!0)}syncUpWithParentFilter(e){let t=e.key===Fe.ENTER,i=this.reactive;if(i&&this.params.onUiChange(),this.applyActive&&!t)return;let{inputSvc:s,params:n,lastType:o}=this,l=s.getValue();if(n.filterParams.trimInput&&(l=HC(l),s.setValue(l,!0)),i){let d=n,p=d.model,y=this.convertValue(l),C=y==null?null:ht(Se({},p??{filterType:this.filterType,type:o??this.optionsFactory.defaultOption}),{filter:y});d.onModelChange(C,{afterFloatingFilter:!0})}else n.parentFilterInstance(d=>{d?.onFloatingFilterChanged(o||null,l||null)})}convertValue(e){return e||null}setEditable(e){this.inputSvc.setEditable(e)}},Kj=class extends Be{constructor(){super(...arguments),this.onValueChanged=()=>{},this.numberInputActive=!0}setupGui(e){this.eNumberInput=this.createManagedBean(new sb),this.eTextInput=this.createManagedBean(new bc),this.eTextInput.setDisabled(!0);let t=this.eNumberInput.getGui(),i=this.eTextInput.getGui();e.appendChild(t),e.appendChild(i),this.setupListeners(t,s=>this.onValueChanged(s)),this.setupListeners(i,s=>this.onValueChanged(s))}setEditable(e){this.numberInputActive=e,this.eNumberInput.setDisplayed(this.numberInputActive),this.eTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eNumberInput.setAutoComplete(e),this.eTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eNumberInput:this.eTextInput}setValueChangedListener(e){this.onValueChanged=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams(e){this.setAriaLabel(e.ariaLabel),e.autoComplete!==void 0&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eNumberInput.setInputAriaLabel(e),this.eTextInput.setInputAriaLabel(e)}},Xj=class extends VT{constructor(){super(...arguments),this.FilterModelFormatterClass=OT,this.filterType="number",this.defaultOptions=Fb}updateParams(e){BC(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.updateParams(e)}createFloatingFilterInputService(e){return this.allowedCharPattern=BC(e.filterParams),this.allowedCharPattern?this.createManagedBean(new zT({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new Kj)}convertValue(e){return e?Number(e):null}},Ib=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],Yj=class extends Mb{constructor(){super("textFilter",BT,Ib),this.filterType="text",this.eValuesFrom=[],this.eValuesTo=[],this.defaultDebounceMs=500}createCondition(e){let t=this.getConditionType(e),i={filterType:this.filterType,type:t},s=this.getValues(e);return s.length>0&&(i.filter=s[0]),s.length>1&&(i.filterTo=s[1]),i}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){let{eValuesFrom:t,eValuesTo:i}=this;return e>=t.length?[null,null]:[t[e],i[e]]}getValues(e){let t=[];return this.forEachPositionInput(e,(i,s,n,o)=>{s<o&&t.push(Qr(i.getValue()))}),t}createEValue(){let e=rs({tag:"div",cls:"ag-filter-body",role:"presentation"}),{eValuesFrom:t,eValuesTo:i}=this;return this.createFromToElement(e,t,"from"),this.createFromToElement(e,i,"to"),e}createFromToElement(e,t,i){let s=this.createManagedBean(new bc);s.addCss(`ag-filter-${i}`),s.addCss("ag-filter-filter"),t.push(s),e.appendChild(s.getGui())}removeEValues(e,t){let i=o=>this.removeComponents(o,e,t),{eValuesFrom:s,eValuesTo:n}=this;i(s),i(n)}},HT=class extends Db{constructor(){super(...arguments),this.filterTypeKeys=Vj}conditionToString(e,t,i,s,n){let{filter:o,filterTo:l,type:d}=e;if(t){let p=C=>()=>Ja(this,"filterSummaryTextQuote",[C]),y=this.conditionForToolPanel(d,i,p(o),p(l),s,n);if(y!=null)return y}return i?`${o}-${l}`:o!=null?`${o}`:`${d}`}},Qj=({filterOption:e,value:t,filterText:i})=>{if(i==null)return!1;switch(e){case"contains":return t.indexOf(i)>=0;case"notContains":return t.indexOf(i)<0;case"equals":return t===i;case"notEqual":return t!=i;case"startsWith":return t.indexOf(i)===0;case"endsWith":{let s=t.lastIndexOf(i);return s>=0&&s===t.length-i.length}default:return!1}},Jj=e=>e,e$=e=>e==null?null:e.toString().toLowerCase(),t$=class extends DT{constructor(){super(BT,Ib),this.filterType="text",this.FilterModelFormatterClass=HT}updateParams(e){super.updateParams(e);let t=e.filterParams;this.matcher=t.textMatcher??Qj,this.formatter=t.textFormatter??(t.caseSensitive?Jj:e$)}evaluateNullValue(e){return e?["notEqual","notContains","blank"].indexOf(e)>=0:!1}evaluateNonNullValue(e,t,i,s){let n=e.map(P=>this.formatter(P))||[],o=this.formatter(t),{api:l,colDef:d,column:p,context:y,filterParams:{textFormatter:C}}=this.params;if(i.type==="blank")return mv(t);if(i.type==="notBlank")return!mv(t);let S={api:l,colDef:d,column:p,context:y,node:s.node,data:s.data,filterOption:i.type,value:o,textFormatter:C};return n.some(P=>this.matcher(ht(Se({},S),{filterText:P})))}processModelToApply(e){if(e&&this.params.filterParams.trimInput){let t=i=>{let s=Se({},i),{filter:n,filterTo:o}=i;return n&&(s.filter=HC(n)??null),o&&(s.filterTo=HC(o)??null),s};return SM(e)?ht(Se({},e),{conditions:e.conditions.map(t)}):t(e)}return e}},i$=class extends VT{constructor(){super(...arguments),this.FilterModelFormatterClass=HT,this.filterType="text",this.defaultOptions=Ib}createFloatingFilterInputService(){return this.createManagedBean(new zT)}};function s$(e){return!!e.quickFilter?.isFilterPresent()}function o$(e){return e.quickFilter?.getText()}function n$(e){e.quickFilter?.resetCache()}var r$=class extends Be{constructor(){super(...arguments),this.beanName="quickFilter",this.quickFilter=null,this.quickFilterParts=null}postConstruct(){let e=this.resetCache.bind(this),t=this.gos;this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{t.get("includeHiddenColumnsInQuickFilter")||this.resetCache()}}),this.addManagedPropertyListener("quickFilterText",i=>this.setFilter(i.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onColumnConfigChanged()),this.quickFilter=this.parseFilter(t.get("quickFilterText")),this.parser=t.get("quickFilterParser"),this.matcher=t.get("quickFilterMatcher"),this.setFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setParserAndMatcher())}refreshCols(){let{autoColSvc:e,colModel:t,gos:i,pivotResultCols:s}=this.beans,n=t.isPivotMode(),o=e?.getColumns(),l=t.getColDefCols(),d=(n&&!i.get("applyQuickFilterBeforePivotOrAgg")?s?.getPivotResultCols()?.list:l)??[];o&&(d=d.concat(o)),this.colsToUse=i.get("includeHiddenColumnsInQuickFilter")?d:d.filter(p=>p.isVisible()||p.isRowGroupActive())}isFilterPresent(){return this.quickFilter!==null}doesRowPass(e){let t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassMatcher(t,e):this.quickFilterParts.every(i=>t?this.doesRowPassCache(e,i):this.doesRowPassNoCache(e,i))}resetCache(){this.beans.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}getText(){return this.gos.get("quickFilterText")}setFilterParts(){let{quickFilter:e,parser:t}=this;e?this.quickFilterParts=t?t(e):e.split(" "):this.quickFilterParts=null}parseFilter(e){return st(e)?e.toUpperCase():null}setFilter(e){if(e!=null&&typeof e!="string"){je(70,{newFilter:e});return}let t=this.parseFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setParserAndMatcher(){let e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),i=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,i&&(this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onColumnConfigChanged(){this.refreshCols(),this.resetCache(),this.isFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassNoCache(e,t){return this.colsToUse.some(i=>{let s=this.getTextForColumn(i,e);return st(s)&&s.indexOf(t)>=0})}doesRowPassCache(e,t){return this.checkGenerateAggText(e),e.quickFilterAggregateText.indexOf(t)>=0}doesRowPassMatcher(e,t){let i;e?(this.checkGenerateAggText(t),i=t.quickFilterAggregateText):i=this.getAggText(t);let{quickFilterParts:s,matcher:n}=this;return n(s,i)}checkGenerateAggText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getAggText(e))}getTextForColumn(e,t){let i=this.beans.filterValueSvc.getValue(e,t),s=e.getColDef();if(s.getQuickFilterText){let n=bt(this.gos,{value:i,node:t,data:t.data,column:e,colDef:s});i=s.getQuickFilterText(n)}return st(i)?i.toString().toUpperCase():null}getAggText(e){let t=[];return this.colsToUse.forEach(i=>{let s=this.getTextForColumn(i,e);st(s)&&t.push(s)}),t.join(`
`)}},a$={moduleName:"ClientSideRowModelFilter",version:nt,rowModels:["clientSide"],beans:[lj]},kb={moduleName:"FilterCore",version:nt,beans:[Dj],apiFunctions:{isAnyFilterPresent:Mj,onFilterChanged:Tj},css:[gj],dependsOn:[a$]},NT={moduleName:"FilterValue",version:nt,beans:[Ij]},Pv={moduleName:"ColumnFilter",version:nt,beans:[Pj,Fj],dynamicBeans:{headerFilterCellCtrl:cj},icons:{filter:"filter",filterActive:"filter"},apiFunctions:{isColumnFilterPresent:fj,getColumnFilterInstance:mj,destroyFilter:vj,setFilterModel:yj,getFilterModel:wj,getColumnFilterModel:Cj,setColumnFilterModel:bj,showColumnFilter:xj,hideColumnFilter:_j,getColumnFilterHandler:Sj,doFilterAction:Rj},dependsOn:[kb,Ev,NT,dj]},l$={moduleName:"CustomFilter",version:nt,userComponents:{agReadOnlyFloatingFilter:Aj},dependsOn:[Pv]},c$={moduleName:"TextFilter",version:nt,dependsOn:[Pv],userComponents:{agTextColumnFilter:{classImp:Yj,params:{useForm:!0}},agTextColumnFloatingFilter:i$},dynamicBeans:{agTextColumnFilterHandler:t$}},h$={moduleName:"NumberFilter",version:nt,dependsOn:[Pv],userComponents:{agNumberColumnFilter:{classImp:$j,params:{useForm:!0}},agNumberColumnFloatingFilter:Xj},dynamicBeans:{agNumberColumnFilterHandler:qj}},u$={moduleName:"DateFilter",version:nt,dependsOn:[Pv],userComponents:{agDateColumnFilter:{classImp:Bj,params:{useForm:!0}},agDateInput:jj,agDateColumnFloatingFilter:Wj},dynamicBeans:{agDateColumnFilterHandler:Nj}},d$={moduleName:"QuickFilterCore",version:nt,rowModels:["clientSide"],beans:[r$],dependsOn:[kb,NT]},p$={moduleName:"QuickFilter",version:nt,apiFunctions:{isQuickFilterPresent:s$,getQuickFilter:o$,resetQuickFilter:n$},dependsOn:[d$]},g$={moduleName:"ExternalFilter",version:nt,dependsOn:[kb]},f$=".ag-tooltip{background-color:var(--ag-tooltip-background-color);border:var(--ag-tooltip-border);border-radius:var(--ag-border-radius);color:var(--ag-tooltip-text-color);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;white-space:normal;z-index:99999;&:where(.ag-cell-editor-tooltip){background-color:var(--ag-tooltip-error-background-color);border:var(--ag-tooltip-error-border);color:var(--ag-tooltip-error-text-color);font-weight:500}}.ag-tooltip-custom{position:absolute;z-index:99999}.ag-tooltip-custom:where(:not(.ag-tooltip-interactive)),.ag-tooltip:where(:not(.ag-tooltip-interactive)){pointer-events:none}.ag-tooltip-animate{transition:opacity 1s;&:where(.ag-tooltip-hiding){opacity:0}}",oC=(e,t,i)=>{let{editModelSvc:s}=e,n=s?.getCellValidationModel()?.getCellValidation(t)?.errorMessages,o=s?.getRowValidationModel().getRowValidation(t)?.errorMessages,l=n||o;return l&&l.length?l.join(i("tooltipValidationErrorSeparator",". ")):void 0},m$=class extends Be{constructor(){super(...arguments),this.beanName="tooltipSvc"}setupHeaderTooltip(e,t,i,s){e&&t.destroyBean(e);let n=sC(this.gos),{column:o,eGui:l}=t,d=o.getColDef();!s&&n&&!d.headerComponent&&(s=Hm(()=>l.querySelector(".ag-header-cell-text")));let p={getGui:()=>l,getLocation:()=>"header",getTooltipValue:()=>i??o.getColDef().headerTooltip,shouldDisplayTooltip:s,getAdditionalParams:()=>({column:o,colDef:o.getColDef()})},y=this.createTooltipFeature(p);return y&&(y=t.createBean(y),t.setRefreshFunction("tooltip",()=>y.refreshTooltip())),y}setupHeaderGroupTooltip(e,t,i,s){e&&t.destroyBean(e);let n=sC(this.gos),{column:o,eGui:l}=t,d=o.getColGroupDef();!s&&n&&!d?.headerGroupComponent&&(s=Hm(()=>l.querySelector(".ag-header-group-text")));let p={getGui:()=>l,getLocation:()=>"headerGroup",getTooltipValue:()=>i??(d&&d.headerTooltip),shouldDisplayTooltip:s,getAdditionalParams:()=>{let C={column:o};return d&&(C.colDef=d),C}},y=this.createTooltipFeature(p);return y&&t.createBean(y)}enableCellTooltipFeature(e,t,i){let{beans:s}=this,{gos:n,editSvc:o}=s,{column:l,rowNode:d}=e,p="cell",y=()=>{let I=!!!o?.isEditing(e)&&oC(s,e,this.getLocaleTextFunc());if(I)return p="cellEditor",I;p="cell";let O=l.getColDef(),V=d.data;if(O.tooltipField&&st(V))return Hp(V,O.tooltipField,l.isTooltipFieldContainsDots());let G=O.tooltipValueGetter;return G?G(bt(n,{location:"cell",colDef:l.getColDef(),column:l,rowIndex:e.cellPosition.rowIndex,node:d,data:d.data,value:e.value,valueFormatted:e.valueFormatted})):null},C=sC(n);i||(C&&!e.isCellRenderer()?i=()=>{let P=!!o?.isEditing(e);if(!P&&oC(s,e,this.getLocaleTextFunc()))return!0;if(!l.isTooltipEnabled())return!1;let V=Hm(()=>{let G=e.eGui;return G.children.length===0?G:G.querySelector(".ag-cell-value")});return!P&&V()}:i=()=>!o?.isEditing(e));let S={getGui:()=>e.eGui,getLocation:()=>p,getTooltipValue:t!=null?()=>t:y,shouldDisplayTooltip:i,getAdditionalParams:()=>({column:l,colDef:l.getColDef(),rowIndex:e.cellPosition.rowIndex,node:d,data:d.data,valueFormatted:e.valueFormatted})};return this.createTooltipFeature(S,s)}setupFullWidthRowTooltip(e,t,i,s){let n={getGui:()=>t.getFullWidthElement(),getTooltipValue:()=>i,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:s},o=this.beans,l=o.context;e&&t.destroyBean(e,l);let d=this.createTooltipFeature(n,o);if(d)return t.createBean(d,l)}setupCellEditorTooltip(e,t){let{beans:i}=this,{context:s}=i,n=t.getValidationElement?.(!0)||!t.isPopup?.()&&e.eGui;if(!n)return;let o={getGui:()=>n,getTooltipValue:()=>oC(i,e,this.getLocaleTextFunc()),getLocation:()=>"cellEditor",shouldDisplayTooltip:()=>{let{editModelSvc:d}=i,p=d?.getRowValidationModel()?.getRowValidationMap(),y=d?.getCellValidationModel()?.getCellValidationMap(),C=!!p&&p.size>0,S=!!y&&y.size>0;return C||S}},l=this.createTooltipFeature(o,i);if(l)return e.createBean(l,s)}initCol(e){let{colDef:t}=e;e.tooltipEnabled=st(t.tooltipField)||st(t.tooltipValueGetter)||st(t.tooltipComponent)}createTooltipFeature(e,t){return this.beans.registry.createDynamicBean("tooltipFeature",!1,e,t)}},v$=class extends H8{createTooltipComp(e,t){F5(this.beans.userCompFactory,e)?.newAgStackInstance().then(t)}setEventHandlers(e){[this.onColumnMovedEventCallback]=this.addManagedEventListeners({columnMoved:e})}clearEventHandlers(){this.onColumnMovedEventCallback?.(),this.onColumnMovedEventCallback=void 0}},GT={moduleName:"Tooltip",version:nt,beans:[m$],dynamicBeans:{tooltipFeature:vM,highlightTooltipFeature:N8,tooltipStateManager:v$},userComponents:{agTooltipComponent:U8},dependsOn:[Ev],css:[f$]},uu=class{constructor(e){this.cellValueChanges=e}},nC=class extends uu{constructor(e,t,i,s){super(e),this.initialRange=t,this.finalRange=i,this.ranges=s}},y$=10,ZE=class{constructor(e){this.actionStack=[],this.maxStackSize=e||y$,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}},w$=class extends Be{constructor(){super(...arguments),this.beanName="undoRedo",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.batchEditing=!1,this.bulkEditing=!1,this.onCellValueChanged=e=>{let t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},i=this.activeCellEdit!==null&&UM(this.activeCellEdit,t),s=this.activeRowEdit!==null&&ON(this.activeRowEdit,t);if(!(i||s||this.isPasting||this.isRangeInAction))return;let{rowPinned:o,rowIndex:l,column:d,oldValue:p,value:y}=e,C={rowPinned:o,rowIndex:l,columnId:d.getColId(),newValue:y,oldValue:p};this.cellValueChanges.push(C)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}postConstruct(){let{gos:e,ctrlsSvc:t}=this.beans;if(!e.get("undoRedoCellEditing"))return;let i=e.get("undoRedoCellEditingLimit");if(i<=0)return;this.undoStack=new ZE(i),this.redoStack=new ZE(i),this.addListeners();let s=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:n=>{n.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:s,newColumnsLoaded:s,columnGroupOpened:s,columnRowGroupChanged:s,columnMoved:s,columnPinned:s,columnVisible:s,rowDragEnd:s}),t.whenReady(this,n=>{this.gridBodyCtrl=n.gridBodyCtrl})}getCurrentUndoStackSize(){return this.undoStack?.getCurrentStackSize()??0}getCurrentRedoStackSize(){return this.redoStack?.getCurrentStackSize()??0}undo(e){let{eventSvc:t,undoStack:i,redoStack:s}=this;t.dispatchEvent({type:"undoStarted",source:e});let n=this.undoRedo(i,s,"initialRange","oldValue","undo");t.dispatchEvent({type:"undoEnded",source:e,operationPerformed:n})}redo(e){let{eventSvc:t,undoStack:i,redoStack:s}=this;t.dispatchEvent({type:"redoStarted",source:e});let n=this.undoRedo(s,i,"finalRange","newValue","redo");t.dispatchEvent({type:"redoEnded",source:e,operationPerformed:n})}undoRedo(e,t,i,s,n){if(!e)return!1;let o=e.pop();return!o||!o.cellValueChanges?!1:(this.processAction(o,l=>l[s],n),o instanceof nC?this.processRange(o.ranges||[o[i]]):this.processCell(o.cellValueChanges),t.push(o),!0)}processAction(e,t,i){e.cellValueChanges.forEach(s=>{let{rowIndex:n,rowPinned:o,columnId:l}=s,d={rowIndex:n,rowPinned:o},p=ia(this.beans,d);p.displayed&&p.setDataValue(l,t(s),i)})}processRange(e){let t,i=this.beans.rangeSvc;i.removeAllCellRanges(!0),e.forEach((s,n)=>{if(!s)return;let o=s.startRow,l=s.endRow;n===e.length-1&&(t={rowPinned:o.rowPinned,rowIndex:o.rowIndex,columnId:s.startColumn.getColId()},this.setLastFocusedCell(t));let d={rowStartIndex:o.rowIndex,rowStartPinned:o.rowPinned,rowEndIndex:l.rowIndex,rowEndPinned:l.rowPinned,columnStart:s.startColumn,columns:s.columns};i.addCellRange(d)})}processCell(e){let t=e[0],{rowIndex:i,rowPinned:s}=t,n={rowIndex:i,rowPinned:s},o=ia(this.beans,n),l={rowPinned:t.rowPinned,rowIndex:o.rowIndex,columnId:t.columnId};this.setLastFocusedCell(l)}setLastFocusedCell(e){let{rowIndex:t,columnId:i,rowPinned:s}=e,{colModel:n,focusSvc:o,rangeSvc:l}=this.beans,d=n.getCol(i);if(!d)return;let{scrollFeature:p}=this.gridBodyCtrl;p.ensureIndexVisible(t),p.ensureColumnVisible(d);let y={rowIndex:t,column:d,rowPinned:s};o.setFocusedCell(ht(Se({},y),{forceBrowserFocus:!0})),l?.setRangeToCell(y)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{let e=new uu(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){let i=new uu(this.cellValueChanges);this.pushActionsToUndoStack(i)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{let e=new uu(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{let t=new nC(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e,{rangeSvc:t,gos:i}=this.beans;t&&ta(i)?e=new nC(this.cellValueChanges,void 0,void 0,[...t.getCellRanges()]):e=new uu(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1},batchEditingStarted:()=>this.startBigChange("batchEditing"),batchEditingStopped:({changes:e})=>this.stopBigChange("batchEditing",e),bulkEditingStarted:()=>this.startBigChange("bulkEditing"),bulkEditingStopped:({changes:e})=>this.stopBigChange("bulkEditing",e)})}startBigChange(e){this[e]=!0}stopBigChange(e,t){if(!this[e]||(this[e]=!1,t?.length===0))return;let i=new uu(t??[]);this.pushActionsToUndoStack(i),this.cellValueChanges=[]}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}},C$=".ag-cell-inline-editing{border:var(--ag-cell-editing-border)!important;border-radius:var(--ag-border-radius);box-shadow:var(--ag-cell-editing-shadow);padding:0;z-index:1;.ag-cell-edit-wrapper,.ag-cell-editor,.ag-cell-wrapper,:where(.ag-cell-editor) .ag-input-field-input,:where(.ag-cell-editor) .ag-wrapper{height:100%;line-height:normal;min-height:100%;width:100%}&.ag-cell-editing-error{border-color:var(--ag-invalid-color)!important}}:where(.ag-popup-editor) .ag-large-text{background-color:var(--ag-background-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);padding:0}.ag-large-text-input{display:block;height:auto;padding:var(--ag-cell-horizontal-padding)}:where(.ag-rtl .ag-large-text-input) textarea{resize:none}:where(.ag-ltr) .ag-checkbox-edit{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-checkbox-edit{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-row.ag-row-editing-invalid .ag-cell-inline-editing){opacity:.8}.ag-popup-editor{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}",b$={tag:"div",cls:"ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit",children:[{tag:"ag-checkbox",ref:"eEditor",role:"presentation"}]},x$=class extends Sv{constructor(){super(b$,[ib]),this.eEditor=ot}initialiseEditor(e){let t=e.value??void 0,i=this.eEditor;i.setValue(t),i.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(t),this.addManagedListeners(i,{fieldValueChanged:n=>this.setAriaLabel(n.selected)})}getValue(){return this.eEditor.getValue()}focusIn(){this.eEditor.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){let t=this.getLocaleTextFunc(),i=yv(t,e),s=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eEditor.setInputAriaLabel(`${s} (${i})`)}getValidationElement(e){return e?this.params.eGridCell:this.eEditor.getInputElement()}getValidationErrors(){let{params:e}=this,{getValidationErrors:t}=e,i=this.getValue();return t?t({value:i,internalErrors:null,cellEditorParams:e}):null}},Mv=class extends Sv{constructor(e){super(),this.cellEditorInput=e,this.eEditor=ot}initialiseEditor(e){let{cellEditorInput:t}=this;this.setTemplate({tag:"div",cls:"ag-cell-edit-wrapper",children:[t.getTemplate()]},t.getAgComponents());let{eEditor:i}=this,{cellStartedEdit:s,eventKey:n,suppressPreventDefault:o}=e;i.getInputElement().setAttribute("title",""),t.init(i,e);let l,d=!0;s?(this.focusAfterAttached=!0,n===Fe.BACKSPACE||n===Fe.DELETE?l="":n&&n.length===1?o?d=!1:l=n:(l=t.getStartValue(),n!==Fe.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,l=t.getStartValue()),d&&l!=null&&i.setStartValue(l),this.addGuiEventListener("keydown",p=>{let{key:y}=p;(y===Fe.PAGE_UP||y===Fe.PAGE_DOWN)&&p.preventDefault()})}afterGuiAttached(){let e=this.getLocaleTextFunc(),t=this.eEditor;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;ll()||t.getFocusableElement().focus();let i=t.getInputElement();this.highlightAllOnFocus?i.select():this.cellEditorInput.setCaret?.()}focusIn(){let{eEditor:e}=this,t=e.getFocusableElement(),i=e.getInputElement();t.focus(),i.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){return this.cellEditorInput.getValidationErrors()}},_$={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},S$=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return _$}getAgComponents(){return[lM]}init(e,t){this.eEditor=e,this.params=t;let{min:i,max:s,step:n,colDef:o}=t;i!=null&&e.setMin(i),s!=null&&e.setMax(s),n!=null&&e.setStep(n),this.includeTime=t.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(o.cellDataType),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){let t=this.eEditor.getInputElement().valueAsDate,{params:i}=this,{min:s,max:n,getValidationErrors:o}=i,l=[],d=this.getLocaleTextFunc();if(t instanceof Date&&!isNaN(t.getTime())){if(s){let p=s instanceof Date?s:new Date(s);if(t<p){let y=p.toLocaleDateString();l.push(d("minDateValidation",`Date must be after ${y}`,[y]))}}if(n){let p=n instanceof Date?n:new Date(n);if(t>p){let y=p.toLocaleDateString();l.push(d("maxDateValidation",`Date must be before ${y}`,[y]))}}}return l.length||(l=null),o?o({value:t,cellEditorParams:i,internalErrors:l}):l}getValue(){let{eEditor:e,params:t}=this,i=e.getDate();return!st(i)&&!st(t.value)?t.value:i??null}getStartValue(){let{value:e}=this.params;if(e instanceof Date)return Vo(e,this.includeTime??!1)}},R$=class extends Mv{constructor(){super(new S$(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},E$={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},P$=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return E$}getAgComponents(){return[lM]}init(e,t){this.eEditor=e,this.params=t;let{min:i,max:s,step:n,colDef:o}=t;i!=null&&e.setMin(i),s!=null&&e.setMax(s),n!=null&&e.setStep(n),this.includeTime=t.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(o.cellDataType),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){let{eEditor:e,params:t}=this,i=e.getInputElement().value,s=this.formatDate(this.parseDate(i??void 0)),{min:n,max:o,getValidationErrors:l}=t,d=[];if(s){let p=new Date(s),y=this.getLocaleTextFunc();if(n){let C=new Date(n);if(p<C){let S=C.toLocaleDateString();d.push(y("minDateValidation",`Date must be after ${S}`,[S]))}}if(o){let C=new Date(o);if(p>C){let S=C.toLocaleDateString();d.push(y("maxDateValidation",`Date must be before ${S}`,[S]))}}}return d.length||(d=null),l?l({value:this.getValue(),cellEditorParams:t,internalErrors:d}):d}getValue(){let{params:e,eEditor:t}=this,i=this.formatDate(t.getDate());return!st(i)&&!st(e.value)?e.value:e.parseValue(i??"")}getStartValue(){return Vo(this.parseDate(this.params.value??void 0)??null,this.includeTime??!1)}parseDate(e){let t=this.getDataTypeService();return t?t.getDateParserFunction(this.params.column)(e):Co(e)??void 0}formatDate(e){let t=this.getDataTypeService();return t?t.getDateFormatterFunction(this.params.column)(e):Vo(e??null,this.includeTime??!1)??void 0}},M$=class extends Mv{constructor(){super(new P$(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},T$={tag:"div",cls:"ag-large-text",children:[{tag:"ag-input-text-area",ref:"eEditor",cls:"ag-large-text-input"}]},D$=class extends Sv{constructor(){super(T$,[K5]),this.eEditor=ot}initialiseEditor(e){let{eEditor:t}=this,{cellStartedEdit:i,eventKey:s,maxLength:n,cols:o,rows:l}=e;this.focusAfterAttached=i,t.getInputElement().setAttribute("title",""),t.setMaxLength(n||200).setCols(o||60).setRows(l||10);let d;i?(this.focusAfterAttached=!0,s===Fe.BACKSPACE||s===Fe.DELETE?d="":s&&s.length===1?d=s:(d=this.getStartValue(e),s!==Fe.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,d=this.getStartValue(e)),d!=null&&t.setValue(d,!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}getStartValue(e){let{value:t}=e;return t?.toString()??t}onKeyDown(e){let t=e.key;(t===Fe.LEFT||t===Fe.UP||t===Fe.RIGHT||t===Fe.DOWN||e.shiftKey&&t===Fe.ENTER)&&e.stopPropagation()}afterGuiAttached(){let{eEditor:e,focusAfterAttached:t,highlightAllOnFocus:i}=this,s=this.getLocaleTextFunc();e.setInputAriaLabel(s("ariaInputEditor","Input Editor")),t&&(e.getFocusableElement().focus(),i&&e.getInputElement().select())}getValue(){let{eEditor:e,params:t}=this,{value:i}=t,s=e.getValue();return!st(s)&&!st(i)?i:t.parseValue(s)}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){let{params:e}=this,{maxLength:t,getValidationErrors:i}=e,s=this.getLocaleTextFunc(),n=this.getValue(),o=[];return typeof n=="string"&&t!=null&&n.length>t&&o.push(s("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),o.length||(o=null),i?i({value:n,internalErrors:o,cellEditorParams:e}):o}},F$={tag:"ag-input-number-field",ref:"eEditor",cls:"ag-cell-editor"},I$=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return F$}getAgComponents(){return[X5]}init(e,t){this.eEditor=e,this.params=t;let{max:i,min:s,precision:n,step:o}=t;i!=null&&e.setMax(i),s!=null&&e.setMin(s),n!=null&&e.setPrecision(n),o!=null&&e.setStep(o);let l=e.getInputElement();t.preventStepping?e.addManagedElementListeners(l,{keydown:this.preventStepping}):t.showStepperButtons&&l.classList.add("ag-number-field-input-stepper")}getValidationErrors(){let{params:e}=this,{min:t,max:i,getValidationErrors:s}=e,o=this.eEditor.getInputElement().valueAsNumber,l=this.getLocaleTextFunc(),d=[];return typeof o=="number"&&(t!=null&&o<t&&d.push(l("minValueValidation",`Must be greater than or equal to ${t}.`,[String(t)])),i!=null&&o>i&&d.push(l("maxValueValidation",`Must be less than or equal to ${i}.`,[String(i)]))),d.length||(d=null),s?s({value:o,cellEditorParams:e,internalErrors:d}):d}preventStepping(e){(e.key===Fe.UP||e.key===Fe.DOWN)&&e.preventDefault()}getValue(){let{eEditor:e,params:t}=this,i=e.getValue();if(!st(i)&&!st(t.value))return t.value;let s=t.parseValue(i);if(s==null)return s;if(typeof s=="string"){if(s==="")return null;s=Number(s)}return isNaN(s)?null:s}getStartValue(){return this.params.value}setCaret(){ll()&&this.eEditor.getInputElement().focus({preventScroll:!0})}},k$=class extends Mv{constructor(){super(new I$(()=>this.getLocaleTextFunc()))}},A$={tag:"div",cls:"ag-cell-edit-wrapper",children:[{tag:"ag-select",ref:"eEditor",cls:"ag-cell-editor"}]},L$=class extends Sv{constructor(){super(A$,[a8]),this.eEditor=ot,this.startedByEnter=!1}wireBeans(e){this.valueSvc=e.valueSvc}initialiseEditor(e){this.focusAfterAttached=e.cellStartedEdit;let{eEditor:t,valueSvc:i,gos:s}=this,{values:n,value:o,eventKey:l}=e;if(Di(n)){je(58);return}this.startedByEnter=l!=null?l===Fe.ENTER:!1;let d=!1;n.forEach(S=>{let P={value:S},I=i.formatValue(e.column,null,S),O=I!=null;P.text=O?I:S,t.addOption(P),d=d||o===S}),d?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);let{valueListGap:p,valueListMaxWidth:y,valueListMaxHeight:C}=e;p!=null&&t.setPickerGap(p),C!=null&&t.setPickerMaxHeight(C),y!=null&&t.setPickerMaxWidth(y),s.get("editType")!=="fullRow"&&this.addManagedListeners(this.eEditor,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eEditor.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eEditor.showPicker()})}focusIn(){this.eEditor.getFocusableElement().focus()}getValue(){return this.eEditor.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getAriaElement()}getValidationErrors(){let{params:e}=this,{values:t,getValidationErrors:i}=e,s=this.getValue(),n=[];if(t&&!t.includes(s)){let o=this.getLocaleTextFunc();n.push(o("invalidSelectionValidation","Invalid selection."))}else n=null;return i?i({value:s,internalErrors:n,cellEditorParams:e}):n}},O$={tag:"ag-input-text-field",ref:"eEditor",cls:"ag-cell-editor"},z$=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return O$}getAgComponents(){return[Cv]}init(e,t){this.eEditor=e,this.params=t;let i=t.maxLength;i!=null&&e.setMaxLength(i)}getValidationErrors(){let{params:e}=this,{maxLength:t,getValidationErrors:i}=e,s=this.getValue(),n=this.getLocaleTextFunc(),o=[];return t!=null&&typeof s=="string"&&s.length>t&&o.push(n("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),o.length||(o=null),i?i({value:s,cellEditorParams:e,internalErrors:o}):o}getValue(){let{eEditor:e,params:t}=this,i=e.getValue();return!st(i)&&!st(t.value)?t.value:t.parseValue(i)}getStartValue(){let e=this.params;return e.useFormatter||e.column.getColDef().refData?e.formatValue(e.value):e.value}setCaret(){ll()&&this.eEditor.getInputElement().focus({preventScroll:!0});let e=this.eEditor,t=e.getValue(),i=st(t)&&t.length||0;i&&e.getInputElement().setSelectionRange(i,i)}},KE=class extends Mv{constructor(){super(new z$(()=>this.getLocaleTextFunc()))}};function B$(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}function V$(e){return e.ctrlsSvc.getScrollFeature().getHScrollPosition()}function WT(e,t,i="auto"){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureColumnVisible(t,i),"ensureVisible")}function UT(e,t,i){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureIndexVisible(t,i),"ensureVisible")}function H$(e,t,i=null){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureNodeVisible(t,i),"ensureVisible")}function N$(e){e.undoRedo?.undo("api")}function G$(e){e.undoRedo?.redo("api")}function W$(e,t){return e.editModelSvc?.getEditRowDataValue(t,{checkSiblings:!0})}function U$(e){let t=e.editModelSvc?.getEditMap(),i=[];return t?.forEach((s,n)=>{let{rowIndex:o,rowPinned:l}=n;s.forEach((d,p)=>{let{editorValue:y,pendingValue:C,sourceValue:S,state:P}=d,I=Yr(d),O=y??C;O===nn&&(O=void 0);let V={newValue:O,oldValue:S,state:P,column:p,colId:p.getColId(),colKey:p.getColId(),rowIndex:o,rowPinned:l};(P==="editing"||P==="changed"&&I)&&i.push(V)})}),i}function j$(e,t=!1){let{editSvc:i}=e;i?.isBatchEditing()?(t?e.editModelSvc?.getEditPositions().forEach(s=>{s.state==="editing"&&i.revertSingleCellEdit(s)}):nc(e,{persist:!0}),Su(e,void 0,{cancel:t})):i?.stopEditing(void 0,{cancel:t,source:"edit",forceStop:!t,forceCancel:t})}function $$(e,t){let i=Oi(e,t);return e.editSvc?.isEditing(i)??!1}function q$(e,t){let{key:i,colKey:s,rowIndex:n,rowPinned:o}=t,{editSvc:l,colModel:d}=e,p=d.getCol(s);if(!p){je(12,{colKey:s});return}let C=ia(e,{rowIndex:n,rowPinned:o||null,column:p});if(!C){je(290,{rowIndex:n,rowPinned:o});return}if(!p.isCellEditable(C))return;o==null&&UT(e,n),WT(e,s),l?.startEditing({rowNode:C,column:p},{event:i?new KeyboardEvent("keydown",{key:i}):void 0,source:"api"})}function Z$(e){return e.editSvc?.validateEdit()||null}function K$(e){return e.undoRedo?.getCurrentUndoStackSize()??0}function X$(e){return e.undoRedo?.getCurrentRedoStackSize()??0}var Y$={tag:"div",cls:"ag-popup-editor",attrs:{tabindex:"-1"}},Q$=class extends JC{constructor(e){super(Y$),this.params=e}postConstruct(){pc(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){let e=this.getGui(),t=this.params,i=s=>{EC(this.gos,s,t.node,t.column,!0)||t.onKeyDown(s)};this.addManagedElementListeners(e,{keydown:i})}};function J$(e,{column:t},i,s,n="ui"){if(i instanceof KeyboardEvent&&(i.key===Fe.TAB||i.key===Fe.ENTER||i.key===Fe.F2||i.key===Fe.BACKSPACE&&s))return!0;if(i?.shiftKey&&e.rangeSvc?.getCellRanges().length!=0)return!1;let l=t?.getColDef(),d=eq(e.gos,l),p=i?.type;return p==="click"&&i?.detail===1&&d===1||p==="dblclick"&&i?.detail===2&&d===2?!0:n==="api"?s??!1:!1}function eq(e,t){return e.get("suppressClickEdit")===!0?0:e.get("singleClickEdit")===!0||t?.singleClickEdit?1:2}function NC(e,{rowNode:t,column:i},s="ui"){let n=i.getColDef().editable,o=e.editModelSvc;return i.isColumnFunc(t,n)||!!o&&o.hasEdits({rowNode:t,column:i},{withOpenEditor:!0})}function tq(e,t,i="ui"){let s=NC(e,t,i);return s===!0||i==="ui"?s:e.colModel.getCols().some(o=>NC(e,{rowNode:t.rowNode,column:o},i))}var vv=(e,t=!1)=>{if(e!==void 0)return Yr(e)||t&&e.state==="editing"};function jT(e,t,i=!1){return vv(e.editModelSvc?.getEdit(t),i)}function $T(e,t){let{editModelSvc:i}=e,{column:s,rowNode:n}=t;if(e.gos.get("groupTotalRow")&&!n?.footer)return!1;for(let o of n?.allLeafChildren??[])if(vv(i?.getEdit({rowNode:o,column:s}))||vv(i?.getEdit({rowNode:o.pinnedSibling,column:s})))return!0}function qT(e,{rowNode:t,column:i}){if(t=t.pinnedSibling,!!t)return vv(e.editModelSvc?.getEdit({rowNode:t,column:i}))}var iq=class extends Be{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}setComp(e){this.cellComp=e,this.applyCellStyles()}applyCellStyles(){let{cellCtrl:e,editSvc:t,beans:i}=this;if(t?.isBatchEditing()&&t.isEditing()){let n=jT(i,e)||$T(i,e)||qT(i,e);this.applyBatchingStyle(n)}else this.applyBatchingStyle(!1);let s=!!this.editModelSvc?.getCellValidationModel().hasCellValidation(this.cellCtrl);this.cellComp.toggleCss("ag-cell-editing-error",s)}applyBatchingStyle(e){this.cellComp.toggleCss("ag-cell-editing",e??!1),this.cellComp.toggleCss("ag-cell-batch-edit",(e&&this.editSvc?.isBatchEditing())??!1)}},sq=class extends Be{constructor(e,t){super(),this.rowCtrl=e,this.beans=t,this.gos=t.gos,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}applyRowStyles(){let{rowCtrl:e,editModelSvc:t,beans:i}=this,s=e.rowNode,n=t?.getEditRow(s),o=this.editModelSvc?.getRowValidationModel().hasRowValidation({rowNode:s});if(!n&&s.pinnedSibling&&(s=s.pinnedSibling,n=t?.getEditRow(s)),n){let l=Array.from(n.keys()).some(d=>{let p={rowNode:s,column:d};return jT(i,p,!0)||$T(i,p)||qT(i,p)});this.applyStyle(o,l);return}this.applyStyle(o)}applyStyle(e=!1,t=!1){let i=this.editSvc?.isBatchEditing()??!1,s=this.gos.get("editType")==="fullRow";this.rowCtrl?.forEachGui(void 0,({rowComp:n})=>{n.toggleCss("ag-row-editing",s&&t),n.toggleCss("ag-row-batch-edit",s&&t&&i),n.toggleCss("ag-row-inline-editing",t),n.toggleCss("ag-row-not-inline-editing",!t),n.toggleCss("ag-row-editing-invalid",s&&t&&e)})}},oq=({rowModel:e,pinnedRowModel:t,editModelSvc:i},s)=>{let n=new Set;return e.forEachNode(o=>s.has(o)&&n.add(o)),t?.forEachPinnedRow("top",o=>s.has(o)&&n.add(o)),t?.forEachPinnedRow("bottom",o=>s.has(o)&&n.add(o)),s.forEach(o=>{n.has(o)||i.removeEdits({rowNode:o})}),n},nq=({editModelSvc:e},t,i)=>{t.forEach(s=>e?.getEditRow(s)?.forEach((n,o)=>!i.has(o)&&e.removeEdits({rowNode:s,column:o})))},rq=e=>()=>{let t=new Set(e.colModel.getCols()),i=e.editModelSvc.getEditMap(!0),s=new Set(i.keys());nq(e,oq(e,s),t)},aq=new Set(["undo","redo","paste","bulk","rangeSvc"]),lq=new Set(["ui","api"]),ZT={paste:"api",rangeSvc:"api",fillHandle:"api",cellClear:"api",bulk:"api"},cq=new Set(Object.keys(ZT)),hq=new Set(["paste","rangeSvc","renderer","cellClear","redo","undo"]),Vm={cancel:!0,source:"api"},uq={cancel:!1,source:"api"},cu={checkSiblings:!0},Ip={force:!0,suppressFlash:!0},dq=class extends Be{constructor(){super(...arguments),this.beanName="editSvc",this.batch=!1,this.stopping=!1,this.committing=!1}postConstruct(){let{beans:e}=this;this.model=e.editModelSvc,this.valueSvc=e.valueSvc,this.rangeSvc=e.rangeSvc,this.addManagedPropertyListener("editType",({currentValue:s})=>{this.stopEditing(void 0,Vm),this.createStrategy(s)});let t=rq(e),i=()=>{let s=this.model.getCellValidationModel().getCellValidationMap().size>0,n=this.model.getRowValidationModel().getRowValidationMap().size>0;return s||n?this.stopEditing(void 0,Vm):this.isEditing()&&(this.isBatchEditing()?Su(e,this.model.getEditPositions()):this.stopEditing(void 0,uq)),!1};this.addManagedEventListeners({columnPinned:t,columnVisible:t,columnRowGroupChanged:t,rowExpansionStateChanged:t,pinnedRowsChanged:t,displayedRowsChanged:t,sortChanged:i,filterChanged:i,cellFocused:this.onCellFocused.bind(this)})}isBatchEditing(){return this.batch}setBatchEditing(e){e?(this.batch=!0,this.stopEditing(void 0,Vm)):(this.stopEditing(void 0,Vm),this.batch=!1)}createStrategy(e){let{beans:t,gos:i,strategy:s}=this,n=XE(i,e);if(s){if(s.beanName===n)return s;this.destroyStrategy()}return this.strategy=this.createOptionalManagedBean(t.registry.createDynamicBean(n,!0))}destroyStrategy(){this.strategy&&(this.strategy.destroy(),this.strategy=this.destroyBean(this.strategy))}shouldStartEditing(e,t,i,s="ui"){let n=J$(this.beans,e,t,i,s);return n&&(this.strategy??(this.strategy=this.createStrategy())),n}shouldStopEditing(e,t,i="ui"){return this.strategy?.shouldStop(e,t,i)??null}shouldCancelEditing(e,t,i="ui"){return this.strategy?.shouldCancel(e,t,i)??null}validateEdit(){return T9(this.beans)}isEditing(e,t){return this.model.hasEdits(e,t??cu)}isRowEditing(e,t){return(e&&this.model.hasRowEdits(e,t))??!1}startEditing(e,t){let{startedEdit:i=!0,event:s=null,source:n="ui",ignoreEventKey:o=!1,silent:l}=t;if(this.strategy??(this.strategy=this.createStrategy()),!this.isCellEditable(e,"api"))return;let d=Oi(this.beans,e);if(d&&!d.comp){d.onCompAttachedFuncs.push(()=>this.startEditing(e,t));return}let p=this.shouldStartEditing(e,s,i,n);if(p===!1&&n!=="api"){this.isEditing(e)&&this.stopEditing();return}!this.batch&&this.shouldStopEditing(e,void 0,n)&&!t.continueEditing&&this.stopEditing(void 0,{source:n}),p&&this.isBatchEditing()&&this.dispatchBatchEvent("batchEditingStarted",new Map),this.strategy.start({position:e,event:s,source:n,ignoreEventKey:o,startedEdit:i,silent:l})}stopEditing(e,t){let{event:i,cancel:s,source:n="ui",suppressNavigateAfterEdit:o,forceCancel:l,forceStop:d}=t||{},{beans:p,model:y}=this;if(cq.has(n)&&this.isBatchEditing())return this.bulkRefresh(e),!1;let C=this.committing?ZT[n]:n;if(!(this.committing||this.isEditing(e)||this.isBatchEditing()&&y.hasEdits(e,cu))||!this.strategy||this.stopping)return!1;this.stopping=!0;let P=Oi(p,e);P&&(P.onEditorAttachedFuncs=[]);let I=y.getEditMap(!0),O=!1,V=!s&&(!!this.shouldStopEditing(e,i,C)||this.committing&&!this.batch)||(d??!1),G=s&&!!this.shouldCancelEditing(e,i,C)||(l??!1);if(V||G){nc(p,{persist:!0,isCancelling:G||s,isStopping:V});let X=y.getEditMap(),Q=this.processEdits(X,s,n);this.strategy?.stop(s,i),Q.forEach(ae=>{y.clearEditValue(ae)}),this.bulkRefresh(void 0,I),y.getEditPositions(X).forEach(ae=>{let me=Oi(p,ae),fe=Yr(ae);me?.refreshCell({force:!0,suppressFlash:!fe})}),I=X,O||(O=V)}else if(i instanceof KeyboardEvent&&this.batch&&this.strategy?.midBatchInputsAllowed(e)&&this.isEditing(e,{withOpenEditor:!0})){let X=i.key,Q=X===Fe.ENTER,ae=X===Fe.ESCAPE,me=X===Fe.TAB;(Q||me||ae)&&(Q||me?nc(p,{persist:!0}):ae&&this.revertSingleCellEdit(P),this.isBatchEditing()?this.strategy?.cleanupEditors():Su(p,y.getEditPositions(),{event:i,cancel:ae}),i.preventDefault(),this.bulkRefresh(e,I,{suppressFlash:!0}),I=y.getEditMap())}else nc(p,{persist:!0}),I=y.getEditMap();return O&&e&&this.model.removeEdits(e),!o&&P&&this.navigateAfterEdit(i instanceof KeyboardEvent&&i.shiftKey,P.cellPosition),LC(p),this.model.hasEdits()||(this.model.getCellValidationModel().clearCellValidationMap(),this.model.getRowValidationModel().clearRowValidationMap()),this.bulkRefresh(),G&&this.beans.rowRenderer.refreshRows({rowNodes:Array.from(I.keys())}),this.isBatchEditing()&&(this.beans.rowRenderer.refreshRows({suppressFlash:!0,force:!0}),O&&V&&this.dispatchBatchEvent("batchEditingStopped",I)),this.stopping=!1,O}navigateAfterEdit(e,t){if(this.gos.get("enterNavigatesVerticallyAfterEdit")){let s=e?Fe.UP:Fe.DOWN;this.beans.navigation?.navigateToNextCell(null,s,t,!1)}}processEdits(e,t=!1,i){let s=Array.from(e.keys()),n=this.model.getCellValidationModel().getCellValidationMap().size>0||this.model.getRowValidationModel().getRowValidationMap().size>0,o=[];for(let l of s){let d=e.get(l);for(let p of d.keys()){let y=d.get(p),C={rowNode:l,column:p},S=Yr(y);!t&&S&&!n&&(this.setNodeDataValue(l,p,y.pendingValue,void 0,i)||o.push(C))}}return o}setNodeDataValue(e,t,i,s,n="edit"){let{beans:o}=this,l=Oi(o,{rowNode:e,column:t}),d=lq.has(n)?"edit":n;l&&(l.suppressRefreshCell=!0),this.commitNextEdit();let p=e.setDataValue(t,i,d);return l&&(l.suppressRefreshCell=!1),s&&l?.refreshCell(Ip),p}setEditMap(e,t){this.strategy??(this.strategy=this.createStrategy()),this.strategy?.setEditMap(e,t),this.bulkRefresh();let i=Ip;t?.forceRefreshOfEditCellsOnly&&(i=Se(Se({},pq(e)),Ip)),this.beans.rowRenderer.refreshCells(i)}dispatchEditValuesChanged({rowNode:e,column:t},i={}){if(!e||!t||!i)return;let{pendingValue:s,sourceValue:n}=i,{rowIndex:o,rowPinned:l,data:d}=e;this.beans.eventSvc.dispatchEvent({type:"cellEditValuesChanged",node:e,rowIndex:o,rowPinned:l,column:t,source:"api",data:d,newValue:s,oldValue:n,value:s,colDef:t.getColDef()})}bulkRefresh(e={},t,i={}){let{beans:s,gos:n}=this,{editModelSvc:o,rowModel:l}=s;Ms(n,l)&&(e.rowNode&&e.column?this.refCell(e,this.model.getEdit(e),i):t&&o?.getEditMap(!1)?.forEach((d,p)=>{for(let y of d.keys())this.refCell({rowNode:p,column:y},d.get(y),i)}))}refCell({rowNode:e,column:t},i,s={}){let{beans:n,gos:o}=this,l=new Set([e]),d=new Set,p=e.pinnedSibling;p&&l.add(p);let y=e.sibling;y&&d.add(y);let C=e.parent;for(;C;)C.sibling?.footer&&o.get("groupTotalRow")||!C.parent&&C.sibling&&o.get("grandTotalRow")?d.add(C.sibling):d.add(C),C=C.parent;l.forEach(S=>this.dispatchEditValuesChanged({rowNode:S,column:t},i)),l.forEach(S=>Oi(n,{rowNode:S,column:t})?.refreshCell(s)),d.forEach(S=>Oi(n,{rowNode:S,column:t})?.refreshCell(s))}stopAllEditing(e=!1,t="ui"){this.isEditing()&&this.stopEditing(void 0,{cancel:e,source:t})}isCellEditable(e,t="ui"){let{rowNode:i}=e,{gos:s,beans:n}=this;if(i.group){if(s.get("treeData")){if(!i.data&&!s.get("enableGroupEdit"))return!1}else if(!s.get("enableGroupEdit"))return!1}let o=XE(s)==="fullRow"?tq(n,e,t):NC(n,e,t);return o&&(this.strategy??(this.strategy=this.createStrategy())),o}cellEditingInvalidCommitBlocks(){return this.gos.get("invalidEditValueMode")==="block"}checkNavWithValidation(e,t,i=!0){if(this.hasValidationErrors(e)){let s=Oi(this.beans,e);return this.cellEditingInvalidCommitBlocks()?(t?.preventDefault?.(),i&&(!s?.hasBrowserFocus()&&s?.focusCell(),s?.comp?.getCellEditor()?.focusIn?.()),"block-stop"):(s&&this.revertSingleCellEdit(s),"revert-continue")}return"continue"}revertSingleCellEdit(e,t=!1){let i=Oi(this.beans,e);i?.comp?.getCellEditor()&&(Su(this.beans,[e],{silent:!0}),this.model.clearEditValue(e),Fu(this.beans,e,{silent:!0}),vc(this.beans),i?.refreshCell(Ip),i.rowCtrl.rowEditStyleFeature?.applyRowStyles(),t&&(i?.focusCell(),i?.comp?.getCellEditor()?.focusIn?.()))}hasValidationErrors(e){vc(this.beans);let t=Oi(this.beans,e);t&&(t.refreshCell(Ip),t.rowCtrl.rowEditStyleFeature?.applyRowStyles());let i=!1;return e?.rowNode?(i||(i=this.model.getRowValidationModel().hasRowValidation({rowNode:e.rowNode})),e.column&&(i||(i=this.model.getCellValidationModel().hasCellValidation({rowNode:e.rowNode,column:e.column})))):(i||(i=this.model.getCellValidationModel().getCellValidationMap().size>0),i||(i=this.model.getRowValidationModel().getRowValidationMap().size>0)),i}moveToNextCell(e,t,i,s="ui"){let n,o=this.isEditing(),l=o&&this.checkNavWithValidation(void 0,i)==="block-stop";return e instanceof Ru&&o&&(n=this.strategy?.moveToNextEditingCell(e,t,i,s,l)),n===null||(n=n||!!this.beans.focusSvc.focusedHeader,n===!1&&!l&&this.stopEditing()),n}getCellDataValue({rowNode:e,column:t},i=!0){if(!e||!t)return;let s=this.model.getEdit({rowNode:e,column:t}),n=e.pinnedSibling;if(n){let l=this.model.getEdit({rowNode:n,column:t});l&&(s=l)}let o=i?s?.editorValue??s?.pendingValue:s?.pendingValue;return o===nn||!s?s?.sourceValue??this.valueSvc.getValue(t,e,!1,"api"):o}addStopEditingWhenGridLosesFocus(e){_9(this,this.beans,e)}createPopupEditorWrapper(e){return new Q$(e)}commitNextEdit(){this.committing=!0}setDataValue(e,t,i){try{if((!this.isEditing()||this.committing)&&!hq.has(i))return;let{beans:s}=this;this.strategy??(this.strategy=this.createStrategy());let n=this.isBatchEditing()?"ui":this.committing?i??"api":"api";if(!i||aq.has(i))return Km(s,e,t,i,void 0,{persist:!0}),this.setNodeDataValue(e.rowNode,e.column,t,!0,i);let o=this.model.getEdit(e);if(o){if(o.pendingValue===t)return!1;if(o.sourceValue!==t)return Km(s,e,t,i,void 0,{persist:!0}),this.stopEditing(e,{source:n,suppressNavigateAfterEdit:!0}),!0;if(o.sourceValue===t)return s.editModelSvc?.removeEdits(e),this.dispatchEditValuesChanged(e,ht(Se({},o),{pendingValue:t})),!0}return Km(s,e,t,i,void 0,{persist:!0}),this.stopEditing(e,{source:n,suppressNavigateAfterEdit:!0}),!0}finally{this.committing=!1}}handleColDefChanged(e){E9(this.beans,e)}destroy(){this.model.clear(),this.destroyStrategy(),super.destroy()}prepDetailsDuringBatch(e,t){if(!this.batch||!this.model.hasRowEdits(e.rowNode,cu))return;let{rowNode:s,column:n}=e,{compDetails:o,valueToDisplay:l}=t;if(o){let{params:p}=o;return p.data=this.model.getEditRowDataValue(s,cu),{compDetails:o}}let d=this.model.getEditRow(e.rowNode,cu);if(l!==void 0&&d?.has(n))return{valueToDisplay:this.valueSvc.getValue(n,s)}}cleanupEditors(){this.strategy?.cleanupEditors()}dispatchCellEvent(e,t,i,s){this.strategy?.dispatchCellEvent(e,t,i,s)}dispatchBatchEvent(e,t){this.eventSvc.dispatchEvent(this.createBatchEditEvent(e,t))}createBatchEditEvent(e,t){return bt(this.gos,Se({type:e},e==="batchEditingStopped"?{changes:this.toEventChangeList(t)}:{}))}toEventChangeList(e){return this.model.getEditPositions(e).map(t=>({rowIndex:t.rowNode.rowIndex,rowPinned:t.rowNode.rowPinned,columnId:t.column.getColId(),newValue:t.pendingValue,oldValue:t.sourceValue}))}applyBulkEdit({rowNode:e,column:t},i){if(!i||i.length===0)return;let{beans:s,rangeSvc:n,valueSvc:o}=this;nc(s,{persist:!0});let l=this.model.getEditMap(!0),d=l.get(e)?.get(t)?.pendingValue;this.batch||this.eventSvc.dispatchEvent({type:"bulkEditingStarted"}),i.forEach(y=>{if(n?.forEachRowInRange(y,C=>{let S=ia(s,C);if(S===void 0)return;let P=l.get(S)??new Map;for(let I of y.columns)if(I&&this.isCellEditable({rowNode:S,column:I},"api")){let O=o.getValue(I,S,!0,"api"),V=o.parseValue(I,S??null,d,O);Number.isNaN(V)&&(V=null),P.set(I,{editorValue:void 0,pendingValue:V,sourceValue:O,state:"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}P.size>0&&l.set(S,P)}),this.setEditMap(l),this.batch){this.cleanupEditors(),LC(s),this.bulkRefresh();return}this.commitNextEdit(),this.stopEditing(void 0,{source:"bulk"}),this.eventSvc.dispatchEvent({type:"bulkEditingStopped",changes:this.toEventChangeList(l)})}),this.bulkRefresh();let p=Oi(s,{rowNode:e,column:t});p&&p.focusCell(!0)}createCellStyleFeature(e,t){return new iq(e,t)}createRowStyleFeature(e,t){return new sq(e,t)}setEditingCells(e,t){let{beans:i}=this,{colModel:s,valueSvc:n}=i,o=new Map;e.forEach(({colId:l,column:d,colKey:p,rowIndex:y,rowPinned:C,newValue:S,state:P})=>{let I=l?s.getCol(l):p?s.getCol(p):d;if(!I)return;let O=ia(i,{rowIndex:y,rowPinned:C});if(!O)return;let V=n.getValue(I,O,!0,"api");if(!t?.forceRefreshOfEditCellsOnly&&!Yr({pendingValue:S,sourceValue:V})&&P!=="editing")return;let G=o.get(O);G||(G=new Map,o.set(O,G)),S===void 0&&(S=nn),G.set(I,{editorValue:void 0,pendingValue:S,sourceValue:V,state:P??"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}),this.setEditMap(o,t)}onCellFocused(e){let t=Oi(this.beans,e);if(!t||!this.isEditing(t,cu))return;let i=this.model.getEdit(t);if(!i||!Yr(i))return;let n=this.getLocaleTextFunc()("ariaPendingChange","Pending Change");this.beans.ariaAnnounce?.announceValue(n,"pendingChange")}allowedFocusTargetOnValidation(e){return Oi(this.beans,e)}};function pq(e){return{rowNodes:e?Array.from(e.keys()):void 0,columns:e?[...new Set(Array.from(e.values()).flatMap(t=>Array.from(t.keys())))]:void 0}}function XE(e,t){return t??e.get("editType")??"singleCell"}var KT=class extends Be{postConstruct(){this.model=this.beans.editModelSvc,this.editSvc=this.beans.editSvc,this.addManagedEventListeners({cellFocused:this.onCellFocusChanged?.bind(this),cellFocusCleared:this.onCellFocusChanged?.bind(this)})}clearEdits(e){this.model.clearEditValue(e)}onCellFocusChanged(e){let t,i=e.previousParams,{editSvc:s,beans:n}=this,o=e.type==="cellFocused"?e.sourceEvent:null;i&&(t=Oi(n,i));let{gos:l,editModelSvc:d}=n,p=e.type==="cellFocusCleared";if(s.isEditing(void 0,{withOpenEditor:!0})){let{column:y,rowIndex:C,rowPinned:S}=e,P={column:y,rowNode:ia(n,{rowIndex:C,rowPinned:S})},I=l.get("invalidEditValueMode")==="block";if(I)return;let O=!I,V=!!d?.getCellValidationModel().hasCellValidation(P),G=O&&V;(i||p?s.stopEditing(void 0,{cancel:G,source:p&&O?"api":void 0,event:o}):!0)||(s.isBatchEditing()?s.cleanupEditors():s.stopEditing(void 0,{source:"api"}))}t?.refreshCell({suppressFlash:!0,force:!0})}stop(e,t){let i=this.model.getEditPositions(),s={all:[],pass:[],fail:[]};if(i.forEach(o=>{if(s.all.push(o),(this.model.getCellValidationModel().getCellValidation(o)?.errorMessages?.length??0)>0){s.fail.push(o);return}s.pass.push(o)}),e)return i.forEach(o=>{gv(this.beans,o,{cancel:e}),this.model.stop(o)}),!0;let n=this.processValidationResults(s);return n.destroy.length>0&&n.destroy.forEach(o=>{gv(this.beans,o,{event:t,cancel:e}),this.model.stop(o)}),n.keep.length>0&&n.keep.forEach(o=>{let l=Oi(this.beans,o);this.editSvc?.cellEditingInvalidCommitBlocks()||l&&this.editSvc.revertSingleCellEdit(l)}),!0}cleanupEditors({rowNode:e}={},t){nc(this.beans,{persist:!1});let i=this.model.getEditPositions(),s=[];e?i.forEach(n=>{!e||n.rowNode===e||s.push(n)}):i.forEach(n=>{s.push(n)}),Su(this.beans,s),LC(this.beans,t)}setFocusOutOnEditor(e){e.comp?.getCellEditor()?.focusOut?.()}setFocusInOnEditor(e){let t=e.comp,i=t?.getCellEditor();if(i?.focusIn)i.focusIn();else{let s=this.beans.gos.get("editType")==="fullRow";e.focusCell(s),e.onEditorAttachedFuncs.push(()=>t?.getCellEditor()?.focusIn?.())}}setupEditors(e){let{event:t,ignoreEventKey:i=!1,startedEdit:s,position:n,cells:o=this.model.getEditPositions()}=e,l=t instanceof KeyboardEvent&&!i&&t.key||void 0;R9(this.beans,o,n,l,t,s)}dispatchCellEvent(e,t,i,s){let n=Oi(this.beans,e);n&&this.eventSvc.dispatchEvent(Se(Se({},n.createEvent(t??null,i)),s))}dispatchRowEvent(e,t,i){if(i)return;let s=Sb(this.beans,e);s&&this.eventSvc.dispatchEvent(s.createRowEvent(t))}shouldStop(e,t,i="ui"){let s=this.editSvc.isBatchEditing();return s&&i==="api"?!0:s&&(i==="ui"||i==="edit")?!1:i==="api"?!0:t instanceof KeyboardEvent&&!s?t.key===Fe.ENTER:null}shouldCancel(e,t,i="ui"){let s=this.editSvc.isBatchEditing();return!!(t instanceof KeyboardEvent&&!s&&t.key===Fe.ESCAPE||s&&i==="api"||i==="api")}setEditMap(e,t){t?.update||this.editSvc.stopEditing(void 0,{cancel:!0,source:"api"});let i=[];if(e.forEach((s,n)=>{s.forEach((o,l)=>{o.state==="editing"&&i.push(ht(Se({},o),{rowNode:n,column:l}))})}),t?.update&&(e=new Map([...this.model.getEditMap(),...e])),this.model?.setEditMap(e),i.length>0){let s=i.at(-1),n=s.pendingValue===nn?void 0:s.pendingValue;this.start({position:s,event:new KeyboardEvent("keydown",{key:n}),source:"api"});let o=Oi(this.beans,s);o&&this.setFocusInOnEditor(o)}}destroy(){this.cleanupEditors(),super.destroy()}},gq=class extends KT{constructor(){super(...arguments),this.beanName="fullRow",this.startedRows=[]}shouldStop(e,t,i="ui"){let{rowNode:s}=e||{};if(!Sb(this.beans,{rowNode:this.rowNode}))return!0;let o=super.shouldStop({rowNode:this.rowNode},t,i);return o!==null?o:this.rowNode?s!==this.rowNode:!1}midBatchInputsAllowed({rowNode:e}){return e?this.model.hasEdits({rowNode:e}):!1}clearEdits(e){this.model.clearEditValue(e)}start(e){let{position:t,silent:i,startedEdit:s,event:n,ignoreEventKey:o}=e,{rowNode:l}=t;this.rowNode!==l&&super.cleanupEditors(t),this.dispatchRowEvent({rowNode:l},"rowEditingStarted",i),this.startedRows.push(l);let d=this.beans.visibleCols.allCols,p=[];d.forEach(y=>{if(!y.isCellEditable(l))return;let C={rowNode:l,column:y};p.push(C),this.model.hasEdits(C)||this.model.start(C)}),this.rowNode=l,this.setupEditors({cells:p,position:t,startedEdit:s,event:n,ignoreEventKey:o})}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){let{rowNode:i}=this;if(i&&!this.model.hasRowEdits(i))return!1;let s=[];return e||this.model.getEditMap().forEach((n,o)=>{if(!(!n||n.size===0)){for(let l of n.values())if(Yr(l)){s.push(o);break}}}),vc(this.beans),!e&&this.editSvc?.checkNavWithValidation({rowNode:i})==="block-stop"?!1:(super.stop(e,t),s.forEach(n=>this.dispatchRowEvent({rowNode:n},"rowValueChanged")),this.cleanupEditors({rowNode:i},!0),this.rowNode=void 0,!0)}onCellFocusChanged(e){let{rowIndex:t}=e,i=e.previousParams;if(i?.rowIndex===t||e.sourceEvent instanceof KeyboardEvent)return;let s=Oi(this.beans,i);this.gos.get("invalidEditValueMode")==="block"&&s&&(this.model.getCellValidationModel().getCellValidation(s)||this.model.getRowValidationModel().getRowValidation(s))||super.onCellFocusChanged(e)}cleanupEditors(e={},t){super.cleanupEditors(e,t),this.startedRows.forEach(i=>this.dispatchRowEvent({rowNode:i},"rowEditingStopped")),this.startedRows.length=0}moveToNextEditingCell(e,t,i,s="ui",n=!1){let o=e.cellPosition,l;this.model.suspend(!0);try{l=this.beans.navigation?.findNextCellToFocusOn(o,{backwards:t,startEditing:!0,skipToNextEditableCell:!1})}finally{this.model.suspend(!1)}if(l===!1)return null;if(l==null)return!1;let d=l.cellPosition,p=e.isCellEditable(),y=l.isCellEditable(),C=d&&o.rowIndex===d.rowIndex&&o.rowPinned===d.rowPinned;p&&this.setFocusOutOnEditor(e),this.restoreEditors();let S=this.gos.get("suppressStartEditOnTab");return y&&!n?S?l.focusCell(!0,i):(l.comp?.getCellEditor()||Fu(this.beans,l,{event:i,cellStartedEdit:!0}),this.setFocusInOnEditor(l),l.focusCell(!1,i)):(y&&n&&this.setFocusInOnEditor(l),l.focusCell(!0,i)),!C&&!n&&(this.editSvc?.stopEditing({rowNode:e.rowNode},{event:i}),this.cleanupEditors(l,!0),S?l.focusCell(!0,i):this.editSvc.startEditing(l,{startedEdit:!0,event:i,source:s,ignoreEventKey:!0})),e.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}restoreEditors(){this.model.getEditMap().forEach((e,t)=>e.forEach(({state:i},s)=>{if(i!=="editing")return;let n=Oi(this.beans,{rowNode:t,column:s});n&&!n.comp?.getCellEditor()&&Fu(this.beans,n,{silent:!0})}))}destroy(){super.destroy(),this.rowNode=void 0,this.startedRows.length=0}},fq=class extends KT{constructor(){super(...arguments),this.beanName="singleCell"}shouldStop(e,t,i="ui"){let s=super.shouldStop(e,t,i);if(s!==null)return s;let{rowNode:n,column:o}=e||{};return(!this.rowNode||!this.column)&&n&&o?null:this.rowNode!==n||this.column!==o}midBatchInputsAllowed(e){return this.model.hasEdits(e)}start(e){let{position:t,startedEdit:i,event:s,ignoreEventKey:n}=e;(this.rowNode!==t.rowNode||this.column!==t.column)&&super.cleanupEditors(),this.rowNode=t.rowNode,this.column=t.column,this.model.start(t),this.setupEditors({cells:[t],position:t,startedEdit:i,event:s,ignoreEventKey:n})}dispatchRowEvent(e,t,i){}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){return super.stop(e,t),this.rowNode=void 0,this.column=void 0,!0}onCellFocusChanged(e){let{colModel:t,editSvc:i}=this.beans,{rowIndex:s,column:n,rowPinned:o}=e,l=ia(this.beans,{rowIndex:s,rowPinned:o}),d=AC(n),p=t.getCol(d),y=e.previousParams;if(y){let C=AC(y.column);if(y?.rowIndex===s&&C===d&&y?.rowPinned===o)return}i?.isEditing({rowNode:l,column:p},{withOpenEditor:!0})&&e.type==="cellFocused"||super.onCellFocusChanged(e)}moveToNextEditingCell(e,t,i,s="ui",n=!1){let o=this.beans.focusSvc.getFocusedCell();o&&(e=gu(this.beans,o)??e);let l=e.cellPosition,d,p=this.beans.gos.get("editType")==="fullRow";p&&this.model.suspend(!0),n||(e.eGui.focus(),this.editSvc?.stopEditing(e,{source:this.editSvc?.isBatchEditing()?"ui":"api",event:i}));try{d=this.beans.navigation?.findNextCellToFocusOn(l,{backwards:t,startEditing:!0})}finally{p&&this.model.suspend(!1)}if(d===!1)return null;if(d==null)return!1;let y=d.cellPosition,C=e.isCellEditable(),S=d.isCellEditable(),P=y&&l.rowIndex===y.rowIndex&&l.rowPinned===y.rowPinned;C&&!n&&this.setFocusOutOnEditor(e);let I=this.gos.get("suppressStartEditOnTab");if(!P&&!n&&(super.cleanupEditors(d,!0),I?d.focusCell(!0,i):this.editSvc.startEditing(d,{startedEdit:!0,event:i,source:s,ignoreEventKey:!0})),S&&!n){if(d.focusCell(!1,i),I)d.focusCell(!0,i);else if(!d.comp?.getCellEditor()){let O=this.editSvc?.isEditing(d,{withOpenEditor:!0});Fu(this.beans,d,{event:i,cellStartedEdit:!0,silent:O}),this.setFocusInOnEditor(d),this.cleanupEditors(d)}}else S&&n&&this.setFocusInOnEditor(d),d.focusCell(!0,i);return e.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}destroy(){super.destroy(),this.rowNode=void 0,this.column=void 0}},cl={moduleName:"EditCore",version:nt,beans:[x9,dq],apiFunctions:{getEditingCells:U$,getEditRowValues:W$,getCellEditorInstances:S9,startEditingCell:q$,stopEditing:j$,isEditing:$$,validateEdit:Z$},dynamicBeans:{singleCell:fq,fullRow:gq},dependsOn:[Ev,GT],css:[C$]},mq={moduleName:"UndoRedoEdit",version:nt,beans:[w$],apiFunctions:{undoCellEditing:N$,redoCellEditing:G$,getCurrentUndoSize:K$,getCurrentRedoSize:X$},dependsOn:[cl]},vq={moduleName:"TextEditor",version:nt,userComponents:{agCellEditor:KE,agTextCellEditor:KE},dependsOn:[cl]},yq={moduleName:"NumberEditor",version:nt,userComponents:{agNumberCellEditor:{classImp:k$}},dependsOn:[cl]},wq={moduleName:"DateEditor",version:nt,userComponents:{agDateCellEditor:R$,agDateStringCellEditor:M$},dependsOn:[cl]},Cq={moduleName:"CheckboxEditor",version:nt,userComponents:{agCheckboxCellEditor:x$},dependsOn:[cl]},bq={moduleName:"SelectEditor",version:nt,userComponents:{agSelectCellEditor:L$},dependsOn:[cl]},xq={moduleName:"LargeTextEditor",version:nt,userComponents:{agLargeTextCellEditor:D$},dependsOn:[cl]},_q={moduleName:"CustomEditor",version:nt,dependsOn:[cl]},Sq=class extends Be{constructor(){super(...arguments),this.beanName="selectionColSvc"}postConstruct(){this.addManagedPropertyListener("rowSelection",e=>{this.onSelectionOptionsChanged(e.currentValue,e.previousValue,wu(e.source))}),this.addManagedPropertyListener("selectionColumnDef",this.updateColumns.bind(this))}addColumns(e){let t=this.columns;t!=null&&(e.list=t.list.concat(e.list),e.tree=t.tree.concat(e.tree),AB(e))}createColumns(e,t){let i=()=>{nv(this.beans,this.columns?.tree),this.columns=null},s=e.treeDepth,o=(this.columns?.treeDepth??-1)==s,l=this.generateSelectionCols();if(kB(l,this.columns?.list??[])&&o)return;i();let{colGroupSvc:p}=this.beans,y=p?.findDepth(e.tree)??0,C=p?.balanceTreeForAutoCols(l,y)??[];this.columns={list:l,tree:C,treeDepth:y,map:{}},t(P=>{if(!P)return null;let I=P.filter(O=>!al(O));return[...l,...I]})}updateColumns(e){let t=wu(e.source);this.columns?.list.forEach(i=>{let s=this.createSelectionColDef(e.currentValue);i.setColDef(s,null,t),_n(this.beans,{state:[ht(Se({},s),{colId:i.getColId()})]},t)})}getColumn(e){return this.columns?.list.find(t=>HP(t,e))??null}getColumns(){return this.columns?.list??null}isSelectionColumnEnabled(){let{gos:e,beans:t}=this,i=e.get("rowSelection");if(typeof i!="object"||!ac(e))return!1;let s=(t.autoColSvc?.getColumns()?.length??0)>0;if(i.checkboxLocation==="autoGroupColumn"&&s)return!1;let n=!!yu(i),o=Nm(i);return n||o}createSelectionColDef(e){let{gos:t}=this,i=e??t.get("selectionColumnDef"),s=t.get("enableRtl"),d=i??{},{rowSpan:n,spanRows:o}=d,l=Kd(d,["rowSpan","spanRows"]);return ht(Se({width:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:s?"right":"left",comparator(p,y,C,S){let P=C.isSelected(),I=S.isSelected();return P===I?0:P?1:-1},editable:!1,suppressFillHandle:!0,pinned:null},l),{colId:zP,chartDataType:"excluded"})}generateSelectionCols(){if(!this.isSelectionColumnEnabled())return[];let e=this.createSelectionColDef(),t=e.colId;this.gos.validateColDef(e,t,!0);let i=new wc(e,null,t,!1);return this.createBean(i),[i]}onSelectionOptionsChanged(e,t,i){let s=t&&typeof t!="string"?yu(t):void 0,n=e&&typeof e!="string"?yu(e):void 0,o=s!==n,l=t&&typeof t!="string"?Nm(t):void 0,d=e&&typeof e!="string"?Nm(e):void 0,p=l!==d,y=iv(e),C=iv(t);(o||p||y!==C)&&this.beans.colModel.refreshAll(i)}destroy(){nv(this.beans,this.columns?.tree),super.destroy()}refreshVisibility(e,t,i){if(!this.columns?.list.length)return;let s=e.length+t.length+i.length;if(s===0)return;let n=this.columns.list[0];if(!n.isVisible())return;let o=()=>{let p;switch(n.pinned){case"left":case!0:p=e;break;case"right":p=i;break;default:p=t}p&&sn(p,n)};(this.beans.rowNumbersSvc?.getColumn(BP)?2:1)===s&&o()}};function Rq(e,t){if(!t.nodes.every(l=>l.rowPinned&&!hg(l)?(je(59),!1):l.id===void 0?(je(60),!1):!0))return;let{nodes:s,source:n,newValue:o}=t;e.selectionSvc?.setNodesSelected({nodes:s,source:n??"api",newValue:o})}function Eq(e,t,i="apiSelectAll"){e.selectionSvc?.selectAllRowNodes({source:i,selectAll:t})}function Pq(e,t,i="apiSelectAll"){e.selectionSvc?.deselectAllRowNodes({source:i,selectAll:t})}function Mq(e,t="apiSelectAllFiltered"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"filtered"})}function Tq(e,t="apiSelectAllFiltered"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"filtered"})}function Dq(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"currentPage"})}function Fq(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"currentPage"})}function Iq(e){return e.selectionSvc?.getSelectedNodes()??[]}function kq(e){return e.selectionSvc?.getSelectedRows()??[]}var Aq=class extends UH{constructor(){super(...arguments),this.beanName="selectionSvc",this.selectedNodes=new Map,this.detailSelection=new Map,this.masterSelectsDetail=!1}postConstruct(){super.postConstruct();let{gos:e}=this;this.mode=sv(e),this.groupSelectsDescendants=Xp(e),this.groupSelectsFiltered=ov(e)==="filteredDescendants",this.masterSelectsDetail=GR(e)==="detail",this.addManagedPropertyListeners(["groupSelectsChildren","groupSelectsFiltered","rowSelection"],()=>{let t=Xp(e),i=sv(e),s=ov(e)==="filteredDescendants";this.masterSelectsDetail=GR(e)==="detail",(t!==this.groupSelectsDescendants||s!==this.groupSelectsFiltered||i!==this.mode)&&(this.deselectAllRowNodes({source:"api"}),this.groupSelectsDescendants=t,this.groupSelectsFiltered=s,this.mode=i)}),this.addManagedEventListeners({rowSelected:this.onRowSelected.bind(this)})}destroy(){super.destroy(),this.resetNodes()}handleSelectionEvent(e,t,i){if(this.isRowSelectionBlocked(t))return 0;let s=this.inferNodeSelections(t,e.shiftKey,e.metaKey||e.ctrlKey,i);if(s==null)return 0;if(this.selectionCtx.selectAll=!1,"select"in s)return s.reset?this.resetNodes():this.selectRange(s.deselect,!1,i),this.selectRange(s.select,!0,i);{let n=s.checkFilteredNodes?YT(s.node):s.newValue;return this.setNodesSelected({nodes:[s.node],newValue:n,clearSelection:s.clearSelection,keepDescendants:s.keepDescendants,event:e,source:i})}}setNodesSelected({newValue:e,clearSelection:t,suppressFinishActions:i,nodes:s,event:n,source:o,keepDescendants:l=!1}){let{gos:d}=this;if(!ac(d)&&e)return je(132),0;if(s.length===0)return 0;if(s.length>1&&!this.isMultiSelect())return je(130),0;let p=0;for(let y=0;y<s.length;y++){let C=s[y],S=hu(C);if(S.rowPinned&&!hg(S)){je(59);continue}if(S.id===void 0){je(60);continue}this.groupSelectsFiltered&&S.group&&!d.get("treeData")||this.selectRowNode(S,e,n,o)&&(this.detailSelection.delete(S.id),p++),this.groupSelectsDescendants&&S.childrenAfterGroup?.length&&(p+=this.selectChildren(S,e,o))}return i||(s.length===1&&o==="api"&&this.selectionCtx.setRoot(hu(s[0])),e&&(t||!this.isMultiSelect())&&(p+=this.clearOtherNodes(hu(s[0]),l,o)),p>0&&(this.updateGroupsFromChildrenSelections(o),this.dispatchSelectionChanged(o))),p}selectRange(e,t,i){let s=0;return e.forEach(n=>{let o=hu(n);if(o.group&&this.groupSelectsDescendants)return;this.selectRowNode(o,t,void 0,i)&&s++}),s>0&&(this.updateGroupsFromChildrenSelections(i),this.dispatchSelectionChanged(i)),s}selectChildren(e,t,i){let s=this.groupSelectsFiltered?e.childrenAfterAggFilter:e.childrenAfterGroup;return s?this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,source:i,nodes:s}):0}getSelectedNodes(){return Array.from(this.selectedNodes.values())}getSelectedRows(){let e=[];return this.selectedNodes.forEach(t=>t.data&&e.push(t.data)),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){let t=new Map;this.selectedNodes.forEach((i,s)=>{e(i)&&t.set(s,i)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsDescendants)return!1;let{gos:i,rowModel:s}=this.beans;if(!Ms(i,s))return!1;let n=s.rootNode;if(!n)return!1;t||(t=new eg(!0,n),t.active=!1);let o=!1;return t.forEachChangedNodeDepthFirst(l=>{if(l!==n){let d=this.calculateSelectedFromChildren(l);o=this.selectRowNode(l,d===null?!1:d,void 0,e)||o}}),o}clearOtherNodes(e,t,i){let s=new Map,n=0;return this.selectedNodes.forEach(o=>{let l=o.id==e.id;if((t?!Oq(e,o):!0)&&!l){let p=this.selectedNodes.get(o.id);n+=this.setNodesSelected({nodes:[p],newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:i}),this.groupSelectsDescendants&&o.parent&&s.set(o.parent.id,o.parent)}}),s.forEach(o=>{let l=this.calculateSelectedFromChildren(o);this.selectRowNode(o,l===null?!1:l,void 0,i)}),n}onRowSelected(e){let t=e.node;this.groupSelectsDescendants&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}createDaemonNode(e){if(!e.id)return;let t=new fc(this.beans);return t.id=e.id,t.data=e.data,t.__daemon=!0,t.__selected=e.__selected,t.level=e.level,t}syncInOldRowNode(e,t){t&&e.id!==t.id&&this.selectedNodes.get(t.id)==e&&this.selectedNodes.set(t.id,t)}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.__selected=!0,this.selectedNodes.set(e.id,e)):e.__selected=!1}reset(e){let t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){this.selectedNodes.forEach(e=>{this.selectRowNode(e,!1)}),this.selectedNodes.clear()}getBestCostNodeSelection(){let{gos:e,rowModel:t}=this.beans;if(!Ms(e,t))return;let i=t.getTopLevelNodes();if(i===null)return;let s=[];function n(o){for(let l=0,d=o.length;l<d;l++){let p=o[l];p.isSelected()?s.push(p):p.group&&p.childrenAfterGroup&&n(p.childrenAfterGroup)}}return n(i),s}isEmpty(){return this.getSelectionCount()===0}deselectAllRowNodes({source:e,selectAll:t}){let i=Ms(this.gos),s=!1,n=o=>{let l=this.selectRowNode(hu(o),!1,void 0,e);s||(s=l)};if(t==="currentPage"||t==="filtered"){if(!i){li(102);return}this.getNodesToSelect(t).forEach(n)}else this.selectedNodes.forEach(n),this.reset(e);if(this.selectionCtx.selectAll=!1,i&&this.groupSelectsDescendants){let o=this.updateGroupsFromChildrenSelections(e);s||(s=o)}s&&this.dispatchSelectionChanged(e)}getSelectedCounts(e){let t=0,i=0;return this.getNodesToSelect(e).forEach(s=>{this.groupSelectsDescendants&&s.group||(s.isSelected()?t++:s.selectable&&i++)}),{selectedCount:t,notSelectedCount:i}}getSelectAllState(e){let{selectedCount:t,notSelectedCount:i}=this.getSelectedCounts(e);return XT(t,i)??null}hasNodesToSelect(e){return this.getNodesToSelect(e).filter(t=>t.selectable).length>0}getNodesToSelect(e){if(!this.canSelectAll())return[];let t=[],i=n=>t.push(n);if(e==="currentPage")return this.forEachNodeOnPage(n=>{if(!n.group){i(n);return}if(!n.expanded&&!n.footer){let o=l=>{i(l),l.childrenAfterFilter?.forEach(o)};o(n);return}this.groupSelectsDescendants||i(n)}),t;let s=this.beans.rowModel;return e==="filtered"?(s.forEachNodeAfterFilter(i),t):(s.forEachNode(i),t)}forEachNodeOnPage(e){let{pageBounds:t,rowModel:i}=this.beans,s=t.getFirstRow(),n=t.getLastRow();for(let o=s;o<=n;o++){let l=i.getRow(o);l&&e(l)}}selectAllRowNodes(e){let{gos:t,selectionCtx:i}=this;if(!ac(t)){je(132);return}if(bB(t)&&!Kp(t)){je(130);return}if(!this.canSelectAll())return;let{source:s,selectAll:n}=e,o=!1;if(this.getNodesToSelect(n).forEach(l=>{let d=this.selectRowNode(hu(l),!0,void 0,s);o||(o=d)}),i.selectAll=!0,Ms(t)&&this.groupSelectsDescendants){let l=this.updateGroupsFromChildrenSelections(s);o||(o=l)}o&&this.dispatchSelectionChanged(s)}getSelectionState(){return this.isEmpty()?null:Array.from(this.selectedNodes.keys())}setSelectionState(e,t,i){if(e||(e=[]),!Array.isArray(e)){li(103);return}let s=new Set(e),n=[];this.beans.rowModel.forEachNode(o=>{s.has(o.id)&&n.push(o)}),i&&this.resetNodes(),this.setNodesSelected({newValue:!0,nodes:n,source:t})}canSelectAll(){let{gos:e}=this.beans;return!!Ms(e)}updateSelectable(e){let{gos:t,rowModel:i}=this.beans;if(!ac(t))return;let s="selectableChanged",n=e!==void 0,o=Ms(t)&&this.groupSelectsDescendants,l=[],d=p=>{if(n&&!p.group)return;if(o&&p.group){let C=p.childrenAfterGroup?.some(S=>S.selectable)??!1;this.setRowSelectable(p,C,!0);return}!this.updateRowSelectable(p,!0)&&p.isSelected()&&l.push(p)};if(o){if(e===void 0){let p=i.rootNode;e=p?new eg(!1,p):void 0}e?.forEachChangedNodeDepthFirst(d,!n,!n)}else i.forEachNode(d);l.length&&this.setNodesSelected({nodes:l,newValue:!1,source:s}),!n&&o&&this.updateGroupsFromChildrenSelections?.(s)}updateSelectableAfterGrouping(e){this.updateSelectable(e),this.groupSelectsDescendants&&this.updateGroupsFromChildrenSelections?.("rowGroupChanged",e)&&this.dispatchSelectionChanged("rowGroupChanged")}refreshMasterNodeState(e,t){if(!this.masterSelectsDetail)return;let i=e.detailNode?.detailGridInfo?.api;if(!i)return;let s=Lq(i);if(e.isSelected()!==s&&this.selectRowNode(e,s,t,"masterDetail")&&this.dispatchSelectionChanged("masterDetail"),!s){let o=this.detailSelection.get(e.id)??new Set;for(let l of i.getSelectedNodes())o.add(l.id);this.detailSelection.set(e.id,o)}}setDetailSelectionState(e,t,i){if(this.masterSelectsDetail){if(!Kp(t)){je(269);return}switch(e.isSelected()){case!0:{i.selectAll();break}case!1:{i.deselectAll();break}case void 0:{let s=this.detailSelection.get(e.id);if(s){let n=[];for(let o of s){let l=i.getRowNode(o);l&&n.push(l)}i.setNodesSelected({nodes:n,newValue:!0,source:"masterDetail"})}break}default:break}}}dispatchSelectionChanged(e){this.eventSvc.dispatchEvent({type:"selectionChanged",source:e,selectedNodes:this.getSelectedNodes(),serverSideState:null})}};function hu(e){return hg(e)?e.pinnedSibling:e.footer?e.sibling:e}function Lq(e){let t=0,i=0;return e.forEachNode(s=>{s.isSelected()?t++:s.selectable&&i++}),XT(t,i)}function XT(e,t){if(e===0&&t===0)return!1;if(!(e>0&&t>0))return e>0}function Oq(e,t){let i=t.parent;for(;i;){if(i===e)return!0;i=i.parent}return!1}function YT(e){let t=e.isSelected()===!1,i=e.childrenAfterFilter?.some(YT)??!1;return t||i}var zq={moduleName:"SharedRowSelection",version:nt,beans:[Sq],apiFunctions:{setNodesSelected:Rq,selectAll:Eq,deselectAll:Pq,selectAllFiltered:Mq,deselectAllFiltered:Tq,selectAllOnCurrentPage:Dq,deselectAllOnCurrentPage:Fq,getSelectedNodes:Iq,getSelectedRows:kq}},Bq={moduleName:"RowSelection",version:nt,rowModels:["clientSide","infinite","viewport"],beans:[Aq],dependsOn:[zq]};function Vq(e){e.expansionSvc?.expandAll(!0)}function Hq(e){e.expansionSvc?.expandAll(!1)}function QT(e){e.rowModel?.onRowHeightChanged()}function JT(e){if(e.rowAutoHeight?.active){je(3);return}e.rowModel?.resetRowHeights()}function Nq(e,t,i){let s=kN(e);if(s){if(e.rowGroupColsSvc?.columns.length===0){if(t<0){li(238);return}s.setRowCount(t,i);return}li(28);return}let n=Rv(e);if(n){n.setRowCount(t,i);return}}function Gq(e){return ku(e.gos)?e.rowModel.getBlockStates():e.rowNodeBlockLoader?.getBlockState()??{}}function Wq(e){return e.rowModel.isLastRowIndexKnown()}var Uq={moduleName:"CsrmSsrmSharedApi",version:nt,apiFunctions:{expandAll:Vq,collapseAll:Hq}},jq={moduleName:"RowModelSharedApi",version:nt,apiFunctions:{onRowHeightChanged:QT,resetRowHeights:JT}},$q={moduleName:"SsrmInfiniteSharedApi",version:nt,apiFunctions:{setRowCount:Nq,getCacheBlockState:Gq,isLastRowIndexKnown:Wq}},qq=class extends Be{constructor(){super(...arguments),this.beanName="alignedGridsSvc",this.consuming=!1}getAlignedGridApis(){let e=this.gos.get("alignedGrids")??[],t=typeof e=="function";return typeof e=="function"&&(e=e()),e.map(s=>{if(!s){li(18),t||li(20);return}if(this.isGridApi(s))return s;let n=s;return"current"in n?n.current?.api:(n.api||li(19),n.api)}).filter(s=>!!s&&!s.isDestroyed())}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){let e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:({event:t})=>this.onColumnEvent(t),alignedGridScroll:({event:t})=>this.onScrollEvent(t)})}fireEvent(e){this.consuming||this.getAlignedGridApis().forEach(t=>{t.isDestroyed()||t.dispatchEvent(e)})}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent({type:"alignedGridColumn",event:e})}fireScrollEvent(e){e.direction==="horizontal"&&this.fireEvent({type:"alignedGridScroll",event:e})}onScrollEvent(e){this.onEvent(()=>{this.beans.ctrlsSvc.getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}extractDataFromEvent(e,t){let i=[];return e.columns?e.columns.forEach(s=>{i.push(t(s))}):e.column&&i.push(t(e.column)),i}getMasterColumns(e){return this.extractDataFromEvent(e,t=>t)}getColumnIds(e){return this.extractDataFromEvent(e,t=>t.getColId())}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":{this.processColumnEvent(e);break}case"columnGroupOpened":{this.processGroupOpenedEvent(e);break}case"columnPivotChanged":je(21);break}})}processGroupOpenedEvent(e){let{colGroupSvc:t}=this.beans;t&&e.columnGroups.forEach(i=>{let s=null;i&&(s=t.getProvidedColGroup(i.getGroupId())),!(i&&!s)&&t.setColumnGroupOpened(s,i.isExpanded(),"alignedGridChanged")})}processColumnEvent(e){let t=e.column,i=null,s=this.beans,{colResize:n,ctrlsSvc:o,colModel:l}=s;if(t&&(i=l.getColDefCol(t.getColId())),t&&!i)return;let d=this.getMasterColumns(e);switch(e.type){case"columnMoved":{let S=e.api.getColumnState().map(P=>({colId:P.colId}));_n(s,{state:S,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{let S=e.api.getColumnState().map(P=>({colId:P.colId,hide:P.hide}));_n(s,{state:S},"alignedGridChanged")}break;case"columnPinned":{let S=e.api.getColumnState().map(P=>({colId:P.colId,pinned:P.pinned}));_n(s,{state:S},"alignedGridChanged")}break;case"columnResized":{let C=e,S={};d.forEach(P=>{S[P.getId()]={key:P.getColId(),newWidth:P.getActualWidth()}}),C.flexColumns?.forEach(P=>{S[P.getId()]&&delete S[P.getId()]}),n?.setColumnWidths(Object.values(S),!1,C.finished,"alignedGridChanged");break}}let y=o.getGridBodyCtrl().isVerticalScrollShowing();this.getAlignedGridApis().forEach(C=>{C.setGridOption("alwaysShowVerticalScroll",y)})}},Zq={moduleName:"AlignedGrids",version:nt,beans:[qq],dependsOn:[YM]},Kq=class extends VH{constructor(){super(...arguments),this.beanName="csrmNodeSvc"}},rC=class{constructor(){this.removals=new Set,this.updates=new Set,this.adds=new Set}remove(e){this.adds.delete(e)||(this.updates.delete(e),this.removals.add(e))}update(e){this.adds.has(e)||this.updates.add(e)}add(e){this.adds.add(e)}},eD=e=>{let t=e.childrenAfterSort,i=e.sibling;if(i&&(i.childrenAfterSort=t),!!t)for(let s=0,n=t.length-1;s<=n;s++){let o=t[s],l=s===0,d=s===n;o.firstChild!==l&&(o.firstChild=l,o.dispatchRowEvent("firstChildChanged")),o.lastChild!==d&&(o.lastChild=d,o.dispatchRowEvent("lastChildChanged")),o.childIndex!==s&&(o.childIndex=s,o.dispatchRowEvent("childIndexChanged"))}},Xq=class extends Be{constructor(){super(...arguments),this.beanName="sortStage",this.refreshProps=new Set(["postSortRows","groupDisplayType","accentedSort"]),this.step="sort"}execute(e){let t=this.beans.sortSvc.getSortOptions(),i=t.length>0&&!!e.changedRowNodes&&this.gos.get("deltaSort");this.sort(t,i,e.changedRowNodes,e.changedPath)}sort(e,t,i,s){let{gos:n,colModel:o,rowGroupColsSvc:l,rowNodeSorter:d,rowRenderer:p,showRowGroupCols:y}=this.beans,C=n.get("groupMaintainOrder"),S=o.getCols().some(Q=>Q.isRowGroupActive()),P=l?.columns,I=o.isPivotMode(),O=n.getCallback("postSortRows"),V=!1,G,X=Q=>{let ae=I&&Q.leafGroup,me=C&&S&&!Q.leafGroup;me&&(G??(G=this.shouldSortContainsGroupCols(e)),me&&(me=!G));let fe=null;if(me){let _e=!1;if(P){let Ae=Q.level+1;Ae<P.length&&(_e=P[Ae].getSort()===null)}_e||(fe=Jq(Q))}else!e.length||ae?fe=null:t&&i?fe=Yq(d,Q,i,s,e):fe=d.doFullSort(Q.childrenAfterAggFilter,e);if(fe||(fe=Q.childrenAfterAggFilter?.slice(0)??[]),V||(V=Q.childrenAfterSort?.[0]!==fe[0]),Q.childrenAfterSort=fe,eD(Q),O){let _e={nodes:Q.childrenAfterSort};O(_e)}};if(s?.forEachChangedNodeDepthFirst(X),V&&n.get("groupHideOpenParents")){let Q=y?.getShowRowGroupCols();Q?.length&&p.refreshCells({columns:Q,force:!0})}}shouldSortContainsGroupCols(e){let t=e.length;if(!t)return!1;if(nr(this.gos)){for(let i=0;i<t;++i){let s=e[i].column;if(s.isPrimary()&&s.isRowGroupActive())return!0}return!1}for(let i=0;i<t;++i)if(e[i].column.getColDef().showRowGroup)return!0;return!1}},Yq=(e,t,i,s,n)=>{let o=t.childrenAfterAggFilter,l=t.childrenAfterSort;if(!l)return e.doFullSort(o,n);let d=new Set,p=[],{updates:y,adds:C}=i;for(let P=0,I=o.length;P<I;++P){let O=o[P];y.has(O)||C.has(O)||s&&!s.canSkip(O)?p.push({currentPos:p.length,rowNode:O}):d.add(O)}let S=l.filter(P=>d.has(P)).map((P,I)=>({currentPos:I,rowNode:P}));return p.sort((P,I)=>e.compareRowNodes(n,P,I)),Qq(e,n,p,S)},Qq=(e,t,i,s)=>{let n=0,o=0,l=i.length,d=s.length,p=new Array(l+d),y=0;for(;n<l&&o<d;){let C=i[n],S=s[o];e.compareRowNodes(t,C,S)<0?(p[y++]=C.rowNode,++n):(p[y++]=S.rowNode,++o)}for(;n<l;)p[y++]=i[n++].rowNode;for(;o<d;)p[y++]=s[o++].rowNode;return p},Jq=e=>{let t=e.childrenAfterSort,i=e.childrenAfterAggFilter,s=t?.length,n=i?.length;if(!s||!n)return null;let o=new Array(n),l=new Set;for(let p=0;p<n;++p)l.add(i[p]);let d=0;for(let p=0;p<s;++p){let y=t[p];l.delete(y)&&(o[d++]=y)}if(l.size===0&&d===s)return t;for(let p of l)o[d++]=p;return o.length=d,o},eZ=class extends Be{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null,this.rowsToDisplay=[],this.rowDataUpdatedPending=!1,this.started=!1,this.isRefreshingModel=!1,this.rowNodesCountReady=!1,this.rowCountReady=!1,this.onRowHeightChanged_debounced=Hs(this,this.onRowHeightChanged.bind(this),100)}wireBeans(e){this.colModel=e.colModel,this.valueCache=e.valueCache,this.filterStage=e.filterStage,this.sortStage=e.sortStage,this.flattenStage=e.flattenStage,this.groupStage=e.groupStage,this.aggStage=e.aggStage,this.pivotStage=e.pivotStage,this.filterAggStage=e.filterAggStage}postConstruct(){this.orderedStages=[this.groupStage,this.filterStage,this.pivotStage,this.aggStage,this.sortStage,this.filterAggStage,this.flattenStage].filter(s=>!!s);let e=this.refreshModel.bind(this,{step:"group"}),t=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame")});this.addManagedEventListeners({newColumnsLoaded:t,columnRowGroupChanged:e,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:"pivot"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:e,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this),rowExpansionStateChanged:this.onRowGroupOpened.bind(this)}),this.addPropertyListeners(),this.rootNode=new fc(this.beans);let i=this.getNewNodeManager();this.nodeManager=i,i.activate(this.rootNode)}getNewNodeManager(){let{gos:e,beans:t}=this;return LP(e)==="treeNested"&&t.csrmChildrenTreeNodeSvc||t.csrmNodeSvc}addPropertyListeners(){let e=["treeData","treeDataChildrenField",...this.orderedStages.flatMap(({refreshProps:t})=>[...t])];this.addManagedPropertyListeners(e,t=>{let i=t.changeSet?.properties;i&&this.onPropChange(i)}),this.addManagedPropertyListener("rowData",()=>this.onPropChange(["rowData"])),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.started=!0,this.rowNodesCountReady?this.refreshModel({step:"group",rowDataUpdated:!0,newData:!0}):this.setInitialData()}setInitialData(){this.gos.get("rowData")&&this.onPropChange(["rowData"])}ensureRowHeightsValid(e,t,i,s){let n,o=!1;do{n=!1;let l=this.getRowIndexAtPixel(e),d=this.getRowIndexAtPixel(t),p=Math.max(l,i),y=Math.min(d,s);for(let C=p;C<=y;C++){let S=this.getRow(C);if(S.rowHeightEstimated){let P=sl(this.beans,S);S.setRowHeight(P.height),n=!0,o=!0}}n&&this.setRowTopAndRowIndex()}while(n);return o}onPropChange(e){if(!this.rootNode)return;let t=this.gos,i=new Set(e),s={step:"nothing",changedProps:i},n=i.has("rowData"),o=this.nodeManager,l=this.getNewNodeManager(),d=o!==l||n&&i.has("treeData")&&t.get("treeData")||i.has("treeDataChildrenField")&&t.get("treeData"),p;if((d||n)&&(p=t.get("rowData"),p!=null&&!Array.isArray(p)&&(p=null,je(1))),d&&(n||(p=o?.extractRowData()??p),o!==l&&(o?.deactivate(),this.nodeManager=l),l.activate(this.rootNode)),p)if(!d&&!this.isEmpty()&&p.length>0&&t.exists("getRowId")&&!t.get("resetRowDataOnUpdate"))s.keepRenderedRows=!0,s.animate=!this.gos.get("suppressAnimationFrame"),s.changedRowNodes=new rC,l.setImmutableRowData(s,p);else{s.rowDataUpdated=!0,s.newData=!0;let{selectionSvc:C,pinnedRowModel:S}=this.beans;C?.reset("rowDataChanged"),S?.isManual()&&S.reset(),this.rowNodesCountReady=!0,l.setNewRowData(p)}if(s.rowDataUpdated)s.step="group";else if(s.step==="nothing"){for(let{refreshProps:y,step:C}of this.orderedStages)if(e.some(S=>y.has(S))){s.step=C;break}}s.step!=="nothing"&&this.refreshModel(s)}setRowTopAndRowIndex(){let{beans:e,rowsToDisplay:t}=this,i=e.environment.getDefaultRowHeight(),s=0,n=new Set,o=Gs(this.gos,"normal");for(let l=0,d=t.length;l<d;++l){let p=t[l];if(p.id!=null&&n.add(p.id),p.rowHeight==null){let y=sl(e,p,o,i);p.setRowHeight(y.height,y.estimated)}p.setRowTop(s),p.setRowIndex(l),s+=p.rowHeight}return n}clearRowTopAndRowIndex(e,t){let i=e.active,s=o=>{o&&o.id!=null&&!t.has(o.id)&&o.clearRowTopAndRowIndex()},n=o=>{if(o!==null&&(s(o),s(o.detailNode),s(o.sibling),o.hasChildren()&&o.childrenAfterGroup)){let l=o.level==-1;i&&!l&&!o.expanded||o.childrenAfterGroup.forEach(n)}};n(this.rootNode)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){let e=this.rootNode;if(!e||this.rowsToDisplay.length===0)return 0;if(this.rowsToDisplay&&this.rowsToDisplay[0]===e)return 1;let i=e.childrenAfterSort,s=e.sibling&&e.sibling.displayed?1:0;return(i?i.length:0)+s}getTopLevelRowDisplayedIndex(e){let{rootNode:t,rowsToDisplay:i}=this;if(!t||!i.length||i[0]===t)return e;let{childrenAfterSort:n}=t,o=d=>{let p=n[d];if(this.gos.get("groupHideOpenParents"))for(;p.expanded&&p.childrenAfterSort&&p.childrenAfterSort.length>0;)p=p.childrenAfterSort[0];return p.rowIndex},{footerSvc:l}=this.beans;return l?l.getTopDisplayIndex(i,e,n,o):o(e)}getTopLevelIndexFromDisplayedIndex(e){let{rootNode:t,rowsToDisplay:i}=this;if(!t||!i.length||i[0]===t)return e;let n=this.getRow(e);for(n.footer&&(n=n.sibling);n.parent&&n.parent!==t;)n=n.parent;let o=t.childrenAfterSort?.findIndex(l=>l===n);return o===-1?e:o??e}getRowBounds(e){let t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){let e=vu(this.gos);this.refreshModel({step:"map",keepRenderedRows:!0,animate:e})}onFilterChanged(e){if(e.afterDataChange)return;let t=vu(this.gos),s=e.columns.length===0||e.columns.some(n=>n.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:s,keepRenderedRows:!0,animate:t})}onSortChanged(){let e=vu(this.gos);this.refreshModel({step:"sort",keepRenderedRows:!0,animate:e})}getType(){return"clientSide"}onValueChanged(){this.refreshModel({step:this.colModel.isPivotActive()?"pivot":"aggregate"})}createChangePath(e){let t=new eg(!1,this.rootNode);return e||(t.active=!1),t}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;let{changedRowNodes:t,newData:i,rowDataUpdated:s}=e;return!(!t||i||!s||t.removals.size||t.adds.size)}refreshModel(e){if(!this.rootNode)return;let t=this.beans,i=!!e.rowDataUpdated,s=e.changedPath??(e.changedPath=this.createChangePath(!e.newData&&i));if(this.started&&i&&this.eventSvc.dispatchEvent({type:"rowDataUpdated"}),!this.started||this.isRefreshingModel||this.colModel.changeEventsDispatching||this.isSuppressModelUpdateAfterUpdateTransaction(e)){this.rowDataUpdatedPending||(this.rowDataUpdatedPending=i);return}switch(this.rowDataUpdatedPending&&(this.rowDataUpdatedPending=!1,e.rowDataUpdated=i=!0,e.step="group"),this.isRefreshingModel=!0,t.masterDetailSvc?.refreshModel(e),i&&e.step!=="group"&&t.colFilter?.refreshModel(),e.step){case"group":(this.doRowGrouping(e)||i)&&t.colFilter?.refreshModel(),!this.rowCountReady&&this.rowNodesCountReady&&(this.rowCountReady=!0,this.eventSvc.dispatchEventOnce({type:"rowCountReady"}));case"filter":this.doFilter(s);case"pivot":this.doPivot(s);case"aggregate":this.doAggregate(s);case"filter_aggregates":this.doFilterAggregates(s);case"sort":this.doSort(e.changedRowNodes,s);case"map":this.doRowsToDisplay()}let n=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(s,n),this.isRefreshingModel=!1,this.eventSvc.dispatchEvent({type:"modelUpdated",animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1,keepUndoRedoStack:e.keepUndoRedoStack})}isEmpty(){return!this.rootNode?.allLeafChildren?.length||!this.colModel?.ready}isRowsToRender(){return this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let i=!1,s=!1,n=[],o=Xp(this.gos);return this.forEachNodeAfterFilterAndSort(l=>{if(s)return;if(i&&(l===t||l===e)&&(s=!0,l.group&&o)){n.push(...l.allLeafChildren);return}if(!i){if(l!==t&&l!==e)return;i=!0,t===e&&(s=!0)}if(!l.group||!o){n.push(l);return}}),n}getTopLevelNodes(){return this.rootNode?.childrenAfterGroup??null}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){let t=this.rowsToDisplay;if(this.isEmpty()||t.length===0)return-1;let i=0,s=t.length-1;if(e<=0)return 0;if(di(t).rowTop<=e)return t.length-1;let o=-1,l=-1;for(;;){let d=Math.floor((i+s)/2),p=t[d];if(this.isRowInPixel(p,e)||(p.rowTop<e?i=d+1:p.rowTop>e&&(s=d-1),o===i&&l===s))return d;o=i,l=s}}isRowInPixel(e,t){let i=e.rowTop,s=e.rowTop+e.rowHeight;return i<=t&&s>t}forEachLeafNode(e){this.rootNode?.allLeafChildren?.forEach((t,i)=>e(t,i))}forEachNode(e,t=!1){this.depthFirstSearchRowNodes(e,t)}forEachDisplayedNode(e){this.rowsToDisplay.forEach(e)}forEachNodeAfterFilter(e,t=!1){this.depthFirstSearchRowNodes(e,t,i=>i.childrenAfterAggFilter)}forEachNodeAfterFilterAndSort(e,t=!1){this.depthFirstSearchRowNodes(e,t,i=>i.childrenAfterSort)}forEachPivotNode(e,t=!1,i=!1){let{colModel:s,rowGroupColsSvc:n}=this.beans;if(!s.isPivotMode())return;if(!n?.columns.length){e(this.rootNode,0);return}let o=i?"childrenAfterSort":"childrenAfterGroup";this.depthFirstSearchRowNodes(e,t,l=>l.leafGroup?null:l[o])}depthFirstSearchRowNodes(e,t=!1,i=o=>o.childrenAfterGroup,s=this.rootNode,n=0){let o=n;if(!s)return o;let l=s===this.rootNode;l||e(s,o++);let{footerSvc:d}=this.beans;if(s.hasChildren()&&!s.footer){let p=i(s);if(p){o=d?.addTotalRows(o,s,e,t,l,"top")??o;for(let y of p)o=this.depthFirstSearchRowNodes(e,t,i,y,o);return d?.addTotalRows(o,s,e,t,l,"bottom")??o}}return o}doAggregate(e){let t=this.rootNode;t&&this.aggStage?.execute({rowNode:t,changedPath:e})}doFilterAggregates(e){let t=this.rootNode;this.filterAggStage?this.filterAggStage.execute({rowNode:t,changedPath:e}):t.childrenAfterAggFilter=t.childrenAfterFilter}doSort(e,t){this.sortStage?this.sortStage.execute({rowNode:this.rootNode,changedRowNodes:e,changedPath:t}):t.forEachChangedNodeDepthFirst(i=>{i.childrenAfterSort=i.childrenAfterAggFilter.slice(0),eD(i)})}doRowGrouping(e){let t=this.rootNode,i=this.groupStage?.execute({rowNode:t,changedRowNodes:e.changedRowNodes,changedPath:e.changedPath,rowNodesOrderChanged:!!e.rowNodesOrderChanged,afterColumnsChanged:!!e.afterColumnsChanged});if(i!==void 0)return i;let s=t.sibling;return t.childrenAfterGroup=t.allLeafChildren,s&&(s.childrenAfterGroup=t.childrenAfterGroup),t.updateHasChildren(),!1}doFilter(e){this.filterStage?this.filterStage.execute({rowNode:this.rootNode,changedPath:e}):e.forEachChangedNodeDepthFirst(t=>{t.childrenAfterFilter=t.childrenAfterGroup,PT(t)},!0)}doPivot(e){this.pivotStage?.execute({rowNode:this.rootNode,changedPath:e})}getRowNode(e){let t=this.nodeManager.getRowNode(e);return typeof t=="object"?t:typeof e=="string"&&e.indexOf(_C)===0?this.groupStage?.getNode(e):void 0}batchUpdateRowData(e,t){if(this.applyAsyncTransactionsTimeout==null){this.rowDataTransactionBatch=[];let i=this.gos.get("asyncTransactionWaitMillis");this.applyAsyncTransactionsTimeout=window.setTimeout(()=>{this.isAlive()&&this.executeBatchUpdateRowData()},i)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){this.applyAsyncTransactionsTimeout!=null&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache?.onDataChanged();let e=[],t=[],i=new rC,s=!1;this.rowDataTransactionBatch?.forEach(n=>{this.rowNodesCountReady=!0;let{rowNodeTransaction:o,rowsInserted:l}=this.nodeManager.updateRowData(n.rowDataTransaction,i);l&&(s=!0),t.push(o),n.callback&&e.push(n.callback.bind(null,o))}),this.commitTransactions(s,i),e.length>0&&window.setTimeout(()=>{e.forEach(n=>n())},0),t.length>0&&this.eventSvc.dispatchEvent({type:"asyncTransactionsFlushed",results:t}),this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(e){this.valueCache?.onDataChanged(),this.rowNodesCountReady=!0;let t=new rC,{rowNodeTransaction:i,rowsInserted:s}=this.nodeManager.updateRowData(e,t);return this.commitTransactions(s,t),i}commitTransactions(e,t){this.refreshModel({step:"group",rowDataUpdated:!0,rowNodesOrderChanged:e,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedRowNodes:t,changedPath:this.createChangePath(!0)})}doRowsToDisplay(){let{flattenStage:e,rootNode:t}=this,i;if(e)i=e.execute({rowNode:t});else{i=t?.childrenAfterSort??[];for(let s of i)s.setUiLevel(0)}this.rowsToDisplay=i}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepUndoRedoStack:!0})}resetRowHeights(){let e=this.rootNode;if(!e)return;let t=this.resetRowHeightsForAllRowNodes();e.setRowHeight(e.rowHeight,!0),e.sibling&&e.sibling.setRowHeight(e.sibling.rowHeight,!0),t&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);let i=t.detailNode;i&&i.setRowHeight(i.rowHeight,!0),t.sibling&&t.sibling.setRowHeight(t.sibling.rowHeight,!0),e=!0}),e}onGridStylesChanges(e){if(e.rowHeightChanged){if(this.beans.rowAutoHeight?.active)return;this.resetRowHeights()}}onGridReady(){this.started||this.setInitialData()}isRowDataLoaded(){return this.rowCountReady}destroy(){super.destroy(),this.started=!1,this.rootNode=null,this.nodeManager=null,this.rowDataTransactionBatch=null,this.orderedStages=jR,this.rowsToDisplay=jR}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}};function tZ(e){e.expansionSvc?.onGroupExpandedOrCollapsed()}function iZ(e,t){let i=oa(e);i&&((!t||t==="everything")&&(t="group"),i.refreshModel({step:t,keepRenderedRows:!0,animate:!e.gos.get("suppressAnimationFrame")}))}function sZ(e){return oa(e)?.isEmpty()??!0}function oZ(e,t){oa(e)?.forEachLeafNode(t)}function nZ(e,t){oa(e)?.forEachNodeAfterFilter(t)}function rZ(e,t){oa(e)?.forEachNodeAfterFilterAndSort(t)}function aZ(e,t){return e.frameworkOverrides.wrapIncoming(()=>oa(e)?.updateRowData(t))}function lZ(e,t,i){e.frameworkOverrides.wrapIncoming(()=>oa(e)?.batchUpdateRowData(t,i))}function cZ(e){e.frameworkOverrides.wrapIncoming(()=>oa(e)?.flushAsyncTransactions())}function hZ(e){return e.selectionSvc?.getBestCostNodeSelection()}var uZ={moduleName:"ClientSideRowModel",version:nt,rowModels:["clientSide"],beans:[Kq,eZ,Xq],dependsOn:[bT]},dZ={moduleName:"ClientSideRowModelApi",version:nt,apiFunctions:{onGroupExpandedOrCollapsed:tZ,refreshClientSideRowModel:iZ,isRowDataEmpty:sZ,forEachLeafNode:oZ,forEachNodeAfterFilter:nZ,forEachNodeAfterFilterAndSort:rZ,applyTransaction:aZ,applyTransactionAsync:lZ,flushAsyncTransactions:cZ,getBestCostNodeSelection:hZ,resetRowHeights:JT,onRowHeightChanged:QT},dependsOn:[Uq,jq]},pZ=class extends Be{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel}serialize(e,t={}){let{allColumns:i,columnKeys:s,skipRowGroups:n,exportRowNumbers:o}=t,l=this.getColumnsToExport({allColumns:i,skipRowGroups:n,columnKeys:s,exportRowNumbers:o});return[this.prepareSession(l),this.prependContent(t),this.exportColumnGroups(t,l),this.exportHeaders(t,l),this.processPinnedTopRows(t,l),this.processRows(t,l),this.processPinnedBottomRows(t,l),this.appendContent(t)].reduce((d,p)=>p(d),e).parse()}processRow(e,t,i,s){let n=t.shouldRowBeSkipped||(()=>!1),l=t.rowPositions!=null||!!t.onlySelected,d=this.gos.get("groupHideOpenParents")&&!l,p=this.colModel.isPivotMode()?s.leafGroup:!s.group,y=!!s.footer,C=s.allChildrenCount===1&&s.childrenAfterGroup?.length===1&&wB(this.gos,s);if(!p&&!y&&(t.skipRowGroups||C||d)||t.onlySelected&&!s.isSelected()||t.skipPinnedTop&&s.rowPinned==="top"||t.skipPinnedBottom&&s.rowPinned==="bottom"||s.stub||s.level===-1&&!p&&!y||n(bt(this.gos,{node:s})))return;let I=e.onNewBodyRow(s);if(i.forEach((O,V)=>{I.onColumn(O,V,s)}),t.getCustomContentBelowRow){let O=t.getCustomContentBelowRow(bt(this.gos,{node:s}));O&&e.addCustomContent(O)}}appendContent(e){return t=>{let i=e.appendContent;return i&&t.addCustomContent(i),t}}prependContent(e){return t=>{let i=e.prependContent;return i&&t.addCustomContent(i),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return i=>{if(!e.skipColumnGroupHeaders){let s=new KP,{colGroupSvc:n}=this.beans,o=n?n.createColumnGroups({columns:t,idCreator:s,pinned:null,isStandaloneStructure:!0}):t;this.recursivelyAddHeaderGroups(o,i,e.processGroupHeaderCallback)}return i}}exportHeaders(e,t){return i=>{if(!e.skipColumnHeaders){let s=i.onNewHeaderRow();t.forEach((n,o)=>{s.onColumn(n,o,void 0)})}return i}}processPinnedTopRows(e,t){return i=>{let s=this.processRow.bind(this,i,e,t);return e.rowPositions?e.rowPositions.filter(n=>n.rowPinned==="top").sort((n,o)=>n.rowIndex-o.rowIndex).map(n=>this.pinnedRowModel?.getPinnedTopRow(n.rowIndex)).forEach(s):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("top",s),i}}processRows(e,t){return i=>{let s=this.rowModel,n=Ms(this.gos,s),o=ku(this.gos,s),l=!n&&e.onlySelected,d=this.processRow.bind(this,i,e,t),{exportedRows:p="filteredAndSorted"}=e;if(e.rowPositions)return e.rowPositions.filter(y=>y.rowPinned==null).sort((y,C)=>y.rowIndex-C.rowIndex).map(y=>s.getRow(y.rowIndex)).forEach(d),i;if(this.colModel.isPivotMode())return n?s.forEachPivotNode(d,!0,p==="filteredAndSorted"):o?s.forEachNodeAfterFilterAndSort(d,!0):s.forEachNode(d),i;if(e.onlySelectedAllPages||l){let y=this.beans.selectionSvc?.getSelectedNodes()??[];this.replicateSortedOrder(y),y.forEach(d)}else p==="all"?s.forEachNode(d):n||o?s.forEachNodeAfterFilterAndSort(d,!0):s.forEachNode(d);return i}}replicateSortedOrder(e){let{sortSvc:t,rowNodeSorter:i}=this.beans;if(!t||!i)return;let s=t.getSortOptions(),n=(o,l)=>o.rowIndex!=null&&l.rowIndex!=null?o.rowIndex-l.rowIndex:o.level===l.level?o.parent?.id===l.parent?.id?i.compareRowNodes(s,{rowNode:o,currentPos:o.rowIndex??-1},{rowNode:l,currentPos:l.rowIndex??-1}):n(o.parent,l.parent):o.level>l.level?n(o.parent,l):n(o,l.parent);e.sort(n)}processPinnedBottomRows(e,t){return i=>{let s=this.processRow.bind(this,i,e,t);return e.rowPositions?e.rowPositions.filter(n=>n.rowPinned==="bottom").sort((n,o)=>n.rowIndex-o.rowIndex).map(n=>this.pinnedRowModel?.getPinnedBottomRow(n.rowIndex)).forEach(s):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("bottom",s),i}}getColumnsToExport(e){let{allColumns:t=!1,skipRowGroups:i=!1,exportRowNumbers:s=!1,columnKeys:n}=e,{colModel:o,gos:l,visibleCols:d}=this,p=o.isPivotMode(),y=P=>al(P)?!1:!el(P)||s;if(n&&n.length)return o.getColsForKeys(n).filter(y);let C=l.get("treeData"),S=[];return t&&!p?S=o.getCols():S=d.allCols,S=S.filter(P=>y(P)&&(i&&!C?!YC(P):!0)),S}recursivelyAddHeaderGroups(e,t,i){let s=[];e.forEach(n=>{let o=n;o.getChildren&&o.getChildren().forEach(l=>s.push(l))}),e.length>0&&ns(e[0])&&this.doAddHeaderHeader(t,e,i),s&&s.length>0&&this.recursivelyAddHeaderGroups(s,t,i)}doAddHeaderHeader(e,t,i){let s=e.onNewHeaderGroupingRow(),n=0;t.forEach(o=>{let l=o,d;i?d=i(bt(this.gos,{columnGroup:l})):d=this.beans.colNames.getDisplayNameForColumnGroup(l,"header");let y=(l.isExpandable()?l.getLeafColumns():[]).reduce((C,S,P,I)=>{let O=di(C);return S.getColumnGroupShow()==="open"?(!O||O[1]!=null)&&(O=[P],C.push(O)):O&&O[1]==null&&(O[1]=P-1),P===I.length-1&&O&&O[1]==null&&(O[1]=P),C},[]);s.onColumn(l,d||"",n++,l.getLeafColumns().length-1,y)})}},gZ={moduleName:"SharedExport",version:nt,beans:[pZ]},YE=`\r
`,fZ=class extends ZU{constructor(e){super(e),this.config=e,this.isFirstLine=!0,this.result="";let{suppressQuotes:t,columnSeparator:i}=e;this.suppressQuotes=t,this.columnSeparator=i}addCustomContent(e){e&&(typeof e=="string"?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,YE),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((i,s)=>{s!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(i.data.value||""),i.mergeAcross&&this.appendEmptyCells(i.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,i,s){i!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(s)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){t!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,i){t!=0&&(this.result+=this.columnSeparator);let s=this.extractRowCellValue(e,t,t,"csv",i);this.result+=this.putInQuotes(s.valueFormatted??s.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(e==null)return'""';let t;return typeof e=="string"?t=e:typeof e.toString=="function"?t=e.toString():(je(53),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=YE),this.isFirstLine=!1}},mZ=class extends qU{constructor(){super(...arguments),this.beanName="csvCreator"}wireBeans(e){this.colModel=e.colModel,this.colNames=e.colNames,this.rowGroupColsSvc=e.rowGroupColsSvc,this.valueSvc=e.valueSvc}getMergedParams(e){let t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){je(51);return}let t=this.getMergedParams(e),i=this.getData(t),s=new Blob(["\uFEFF",i],{type:"text/plain"}),n=typeof t.fileName=="function"?t.fileName(bt(this.gos,{})):t.fileName;KU(this.getFileName(n),s)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){let i=t?Object.assign({},e):this.getMergedParams(e);return this.getData(i)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){let{colModel:t,colNames:i,rowGroupColsSvc:s,valueSvc:n,gos:o}=this,{processCellCallback:l,processHeaderCallback:d,processGroupHeaderCallback:p,processRowGroupCallback:y,suppressQuotes:C,columnSeparator:S}=e;return new fZ({colModel:t,colNames:i,valueSvc:n,gos:o,processCellCallback:l||void 0,processHeaderCallback:d||void 0,processGroupHeaderCallback:p||void 0,processRowGroupCallback:y||void 0,suppressQuotes:C||!1,columnSeparator:S||",",rowGroupColsSvc:s})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};function vZ(e,t){return e.csvCreator?.getDataAsCsv(t)}function yZ(e,t){e.csvCreator?.exportDataAsCsv(t)}var wZ={moduleName:"CsvExport",version:nt,beans:[mZ],apiFunctions:{getDataAsCsv:vZ,exportDataAsCsv:yZ},dependsOn:[gZ]},CZ=class extends Be{constructor(e,t,i){super(),this.id=e,this.parentCache=t,this.params=i,this.state="needsLoading",this.version=0,this.startRow=e*i.blockSize,this.endRow=this.startRow+i.blockSize}load(){this.state="loading",this.loadFromDatasource()}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed"),this.dispatchLocalEvent({type:"loadComplete"})}pageLoaded(e,t,i){this.successCommon(e,{rowData:t,rowCount:i})}isRequestMostRecentAndLive(e){let t=e===this.version,i=this.isAlive();return t&&i}successCommon(e,t){this.dispatchLocalEvent({type:"loadComplete"}),this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}postConstruct(){this.rowNodes=[];let{params:{blockSize:e,rowHeight:t},startRow:i,beans:s,rowNodes:n}=this;for(let o=0;o<e;o++){let l=i+o,d=new fc(s);d.setRowHeight(t),d.uiLevel=0,d.setRowIndex(l),d.setRowTop(t*l),n.push(d)}}getBlockStateJson(){let{id:e,startRow:t,endRow:i,state:s}=this;return{id:""+e,state:{blockNumber:e,startRow:t,endRow:i,pageStatus:s}}}setDataAndId(e,t,i){st(t)?e.setDataAndId(t,i.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){let e=this.createLoadParams();if(Di(this.params.datasource.getRows)){je(90);return}window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}createLoadParams(){let{startRow:e,endRow:t,version:i,params:{sortModel:s,filterModel:n},gos:o}=this;return{startRow:e,endRow:t,successCallback:this.pageLoaded.bind(this,i),failCallback:this.pageLoadFailed.bind(this,i),sortModel:s,filterModel:n,context:bt(o,{}).context}}forEachNode(e,t,i){this.rowNodes.forEach((s,n)=>{this.startRow+n<i&&e(s,t.value++)})}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.value++);let i=e-this.startRow;return this.rowNodes[i]}processServerResult(e){let{rowNodes:t,beans:i}=this;t.forEach((n,o)=>{let l=e.rowData?e.rowData[o]:void 0;!n.id&&n.alreadyRendered&&l&&(t[o]=new fc(i),t[o].setRowIndex(n.rowIndex),t[o].setRowTop(n.rowTop),t[o].setRowHeight(n.rowHeight),n.clearRowTopAndRowIndex()),this.setDataAndId(t[o],l,this.startRow+o)});let s=e.rowCount!=null&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,s)}destroy(){this.rowNodes.forEach(e=>{e.clearRowTopAndRowIndex()}),super.destroy()}},bZ=2,xZ=class extends Be{constructor(e){super(),this.params=e,this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount}getRow(e,t=!1){let i=Math.floor(e/this.params.blockSize),s=this.blocks[i];if(!s){if(t)return;s=this.createBlock(i)}return s.getRow(e)}createBlock(e){let t=this.params,i=this.createBean(new CZ(e,this,t));return this.blocks[i.id]=i,this.blockCount++,this.purgeBlocksIfNeeded(i),t.rowNodeBlockLoader.addBlock(i),i}refreshCache(){if(this.blockCount==0){this.purgeCache();return}this.getBlocksInOrder().forEach(t=>t.setStateWaitingToLoad()),this.params.rowNodeBlockLoader.checkBlockToLoad()}destroy(){this.getBlocksInOrder().forEach(e=>this.destroyBlock(e)),super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(il(this.gos,`InfiniteCache - onPageLoaded: page = ${e.id}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){let t=this.getBlocksInOrder().filter(l=>l!=e),i=(l,d)=>d.lastAccessed-l.lastAccessed;t.sort(i);let s=this.params.maxBlocksInCache>0,n=s?this.params.maxBlocksInCache-1:null,o=bZ-1;t.forEach((l,d)=>{let p=l.state==="needsLoading"&&d>=o,y=s?d>=n:!1;if(p||y){if(this.isBlockCurrentlyDisplayed(l)||this.isBlockFocused(l))return;this.removeBlockFromCache(l)}})}isBlockFocused(e){let t=this.beans.focusSvc.getFocusCellToUseAfterRefresh();if(!t||t.rowPinned!=null)return!1;let{startRow:i,endRow:s}=e;return t.rowIndex>=i&&t.rowIndex<s}isBlockCurrentlyDisplayed(e){let{startRow:t,endRow:i}=e;return this.beans.rowRenderer.isRangeInRenderedViewport(t,i-1)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if(typeof t=="number"&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){let{blockSize:i,overflowSize:s}=this.params,o=(e.id+1)*i+s;this.rowCount<o&&(this.rowCount=o)}}setRowCount(e,t){this.rowCount=e,st(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){let t={value:0};this.getBlocksInOrder().forEach(i=>i.forEachNode(e,t,this.rowCount))}getBlocksInOrder(){let e=(i,s)=>i.id-s.id;return Object.values(this.blocks).sort(e)}destroyBlock(e){delete this.blocks[e.id],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventSvc.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){let e=[];this.getBlocksInOrder().forEach(t=>{t.id*this.params.blockSize>=this.rowCount&&e.push(t)}),e.length>0&&e.forEach(t=>this.destroyBlock(t))}purgeCache(){this.getBlocksInOrder().forEach(e=>this.removeBlockFromCache(e)),this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){let i=[],s=-1,n=!1,o={value:0},l=!1;return this.getBlocksInOrder().forEach(p=>{if(!l){if(n&&s+1!==p.id){l=!0;return}s=p.id,p.forEachNode(y=>{let C=y===e||y===t;(n||C)&&i.push(y),C&&(n=!n)},o,this.rowCount)}}),l||n?[]:i}},_Z=class extends Be{constructor(){super(...arguments),this.beanName="rowModel"}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){this.gos.get("rowModelType")==="infinite"&&(this.rowHeight=lc(this.beans),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache()))}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy()}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.beans.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.reset.bind(this),sortChanged:this.reset.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.dispatchModelUpdatedEvent.bind(this)}),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=lc(this.beans),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onColumnEverything(){let e;this.cacheParams?e=!Wp(this.cacheParams.sortModel,this.beans.sortSvc?.getSortModel()??[]):e=!0,e&&this.reset()}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?.getRowNodesInRange(e,t)??[]}reset(){if(!this.datasource)return;Pu(this.gos)!=null||this.beans.selectionSvc?.reset("rowDataChanged"),this.resetCache()}dispatchModelUpdatedEvent(){this.eventSvc.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){this.destroyCache();let e=this.beans,{filterManager:t,sortSvc:i,rowNodeBlockLoader:s,eventSvc:n,gos:o}=e;this.cacheParams={datasource:this.datasource,filterModel:t?.getFilterModel()??{},sortModel:i?.getSortModel()??[],rowNodeBlockLoader:s,initialRowCount:o.get("infiniteInitialRowCount"),maxBlocksInCache:o.get("maxBlocksInCache"),rowHeight:lc(e),overflowSize:o.get("cacheOverflowSize"),blockSize:o.get("cacheBlockSize"),lastAccessedSequence:{value:0}},this.infiniteCache=this.createBean(new xZ(this.cacheParams)),n.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode(e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)}),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache=this.destroyBean(this.infiniteCache)}getRow(e){let t=this.infiniteCache;if(t&&!(e>=t.getRowCount()))return t.getRow(e)}getRowNode(e){let t;return this.forEachNode(i=>{i.id===e&&(t=i)}),t}forEachNode(e){this.infiniteCache?.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(this.rowHeight!==0){let t=Math.floor(e/this.rowHeight),i=this.getRowCount()-1;return t>i?i:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache?.refreshCache()}purgeCache(){this.infiniteCache?.purgeCache()}isLastRowIndexKnown(){return this.infiniteCache?.isLastRowIndexKnown()??!1}setRowCount(e,t){this.infiniteCache?.setRowCount(e,t)}resetRowHeights(){}onRowHeightChanged(){}};function SZ(e){Rv(e)?.refreshCache()}function RZ(e){Rv(e)?.purgeCache()}function EZ(e){return Rv(e)?.getRowCount()}var PZ=class extends Be{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=CB(this.gos);let e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=Hs(this,this.performCheckBlocksToLoad.bind(this),e))}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){sn(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad()}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){il(this.gos,"RowNodeBlockLoader - checkBlockToLoad: max loads exceeded");return}let e=this.maxConcurrentRequests!=null?this.maxConcurrentRequests-this.activeBlockLoadsCount:1,t=this.blocks.filter(i=>i.state==="needsLoading").slice(0,e);this.activeBlockLoadsCount+=t.length,t.forEach(i=>i.load()),this.printCacheStatus()}getBlockState(){let e={};return this.blocks.forEach(t=>{let{id:i,state:s}=t.getBlockStateJson();e[i]=s}),e}printCacheStatus(){il(this.gos,`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}},MZ={moduleName:"InfiniteRowModelCore",version:nt,rowModels:["infinite"],beans:[_Z,PZ]},TZ={moduleName:"InfiniteRowModel",version:nt,apiFunctions:{refreshInfiniteCache:SZ,purgeInfiniteCache:RZ,getInfiniteRowCount:EZ},dependsOn:[MZ,$q]},DZ="\u2191",FZ="\u2193",IZ={tag:"span",children:[{tag:"span",ref:"eDelta",cls:"ag-value-change-delta"},{tag:"span",ref:"eValue",cls:"ag-value-change-value"}]},kZ=class extends ii{constructor(){super(IZ),this.eValue=ot,this.eDelta=ot,this.refreshCount=0}init(e){this.refresh(e,!0)}showDelta(e,t){let i=Math.abs(t),s=e.formatValue(i),n=st(s)?s:i,o=t>=0,l=this.eDelta;o?l.textContent=DZ+n:l.textContent=FZ+n,l.classList.toggle("ag-value-change-delta-up",o),l.classList.toggle("ag-value-change-delta-down",!o)}setTimerToRemoveDelta(){this.refreshCount++;let e=this.refreshCount;this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),Ns(this.eDelta)}refresh(e,t=!1){let{value:i,valueFormatted:s}=e,{eValue:n,lastValue:o,beans:l}=this;if(i===o||(st(s)?n.textContent=s:st(i)?n.textContent=i:Ns(n),l.filterManager?.isSuppressFlashingCellsBecauseFiltering()))return!1;let d=i&&typeof i=="object"&&"toNumber"in i?i.toNumber():i,p=o&&typeof o=="object"&&"toNumber"in o?o.toNumber():o;if(d===p)return!1;if(typeof d=="number"&&typeof p=="number"){let y=d-p;this.showDelta(e,y)}return o&&n.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=i,!0}},AZ=".ag-value-slide-out{opacity:1}:where(.ag-ltr) .ag-value-slide-out{margin-right:5px;transition:opacity 3s,margin-right 3s}:where(.ag-rtl) .ag-value-slide-out{margin-left:5px;transition:opacity 3s,margin-left 3s}:where(.ag-ltr,.ag-rtl) .ag-value-slide-out{transition-timing-function:linear}.ag-value-slide-out-end{opacity:0}:where(.ag-ltr) .ag-value-slide-out-end{margin-right:10px}:where(.ag-rtl) .ag-value-slide-out-end{margin-left:10px}",LZ={tag:"span",children:[{tag:"span",ref:"eCurrent",cls:"ag-value-slide-current"}]},OZ=class extends ii{constructor(){super(LZ),this.eCurrent=ot,this.refreshCount=0,this.registerCSS(AZ)}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;let e=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious);let{beans:t,eCurrent:i}=this,s=rs({tag:"span",cls:"ag-value-slide-previous ag-value-slide-out"});this.ePrevious=s,s.textContent=i.textContent,this.getGui().insertBefore(s,i),t.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.getGui().removeChild(this.ePrevious),this.ePrevious=null)},3e3)})}refresh(e,t=!1){let i=e.value;if(Di(i)&&(i=""),i===this.lastValue||this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering())return!1;t||this.addSlideAnimation(),this.lastValue=i;let s=this.eCurrent;return st(e.valueFormatted)?s.textContent=e.valueFormatted:st(e.value)?s.textContent=i:Ns(s),!0}},zZ=class extends Be{constructor(){super(...arguments),this.beanName="cellFlashSvc",this.nextAnimationTime=null,this.nextAnimationCycle=null,this.animations={highlight:new Map,"data-changed":new Map}}animateCell(e,t,i=this.beans.gos.get("cellFlashDuration"),s=this.beans.gos.get("cellFadeDuration")){let n=this.animations[t];n.delete(e);let o=Date.now(),l=o+i,d=o+i+s,p={phase:"flash",flashEndTime:l,fadeEndTime:d};n.set(e,p);let y=`ag-cell-${t}`,C=`${y}-animation`,{comp:S,eGui:{style:P}}=e;S.toggleCss(y,!0),S.toggleCss(C,!1),P.removeProperty("transition"),P.removeProperty("transition-delay"),this.nextAnimationTime&&l+15<this.nextAnimationTime&&(clearTimeout(this.nextAnimationCycle),this.nextAnimationCycle=null,this.nextAnimationTime=null),this.nextAnimationCycle||(this.beans.frameworkOverrides.wrapIncoming(()=>{this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),i)}),this.nextAnimationTime=l)}advanceAnimations(){let e=Date.now(),t=null;for(let i of Object.keys(this.animations)){let s=this.animations[i],n=`ag-cell-${i}`,o=`${n}-animation`;for(let[l,d]of s){if(!l.isAlive()||!l.comp){s.delete(l);continue}let{phase:p,flashEndTime:y,fadeEndTime:C}=d,S=p==="flash"?y:C;if(!(e+15>=S)){t=Math.min(S,t??1/0);continue}let{comp:I,eGui:{style:O}}=l;switch(p){case"flash":I.toggleCss(n,!1),I.toggleCss(o,!0),O.transition=`background-color ${C-y}ms`,O.transitionDelay=`${y-e}ms`,t=Math.min(C,t??1/0),d.phase="fade";break;case"fade":I.toggleCss(n,!1),I.toggleCss(o,!1),O.removeProperty("transition"),O.removeProperty("transition-delay"),s.delete(l);break}}}t==null?(this.nextAnimationTime=null,this.nextAnimationCycle=null):t&&(this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),t-e),this.nextAnimationTime=t)}onFlashCells(e,t){if(!e.comp)return;let i=AN(e.cellPosition);t.cells[i]&&this.animateCell(e,"highlight")}flashCell(e,t){this.animateCell(e,"data-changed",t?.flashDuration,t?.fadeDuration)}destroy(){for(let e of Object.keys(this.animations))this.animations[e].clear()}};function BZ(e,t={}){let{cellFlashSvc:i}=e;i&&e.frameworkOverrides.wrapIncoming(()=>{e.rowRenderer.getCellCtrls(t.rowNodes,t.columns).forEach(s=>i.flashCell(s,t))})}var VZ={moduleName:"HighlightChanges",version:nt,beans:[zZ],userComponents:{agAnimateShowChangeCellRenderer:kZ,agAnimateSlideCellRenderer:OZ},apiFunctions:{flashCells:BZ}};function HZ(e){return e.stateSvc?.getState()??{}}function NZ(e,t,i){return e.stateSvc?.setState(t,i)}function QE(e){switch(e=Se({},e),e.version||(e.version="32.1.0"),e.version){case"32.1.0":e=GZ(e)}return e.version=nt,e}function GZ(e){return e.cellSelection=WZ(e,"rangeSelection"),e}function WZ(e,t){if(e&&typeof e=="object")return e[t]}var UZ=class extends Be{constructor(){super(...arguments),this.beanName="stateSvc",this.updateRowGroupExpansionStateTimer=0,this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=Hs(this,()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=Hs(this,()=>{this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(this.updateCachedState("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowGroupExpansion",void 0)):(this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("ssrmRowGroupExpansion",void 0))},0),this.onRowSelectedDebounced=Hs(this,()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){let{gos:e,ctrlsSvc:t,colDelayRenderSvc:i}=this.beans;this.isClientSideRowModel=Ms(e);let s=QE(e.get("initialState")??{}),n=s.partialColumnState;delete s.partialColumnState,this.cachedState=s;let o=this.suppressEventsAndDispatchInitEvent.bind(this);t.whenReady(this,()=>o(()=>this.setupStateOnGridReady(s))),(s.columnOrder||s.columnVisibility||s.columnSizing||s.columnPinning||s.columnGroup)&&i?.hideColumns("columnState");let[l,d,p]=this.addManagedEventListeners({newColumnsLoaded:({source:y})=>{y==="gridInitializing"&&(l(),o(()=>{this.setupStateOnColumnsInitialised(s,!!n),i?.revealColumns("columnState")}))},rowCountReady:()=>{d?.(),o(()=>this.setupStateOnRowCountReady(s))},firstDataRendered:()=>{p?.(),o(()=>this.setupStateOnFirstDataRendered(s))}})}destroy(){super.destroy(),clearTimeout(this.updateRowGroupExpansionStateTimer),this.queuedUpdateSources.clear()}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setState(e,t){let i=QE(e);delete i.partialColumnState,this.cachedState=i,this.startSuppressEvents();let s="api",n=t?new Set(t):void 0;this.setGridReadyState(i,s,n),this.setColumnsInitialisedState(i,s,!1,n),this.setRowCountState(i,s,n),setTimeout(()=>{this.isAlive()&&this.setFirstDataRenderedState(i,s,n),this.stopSuppressEvents(s)})}setGridReadyState(e,t,i){t==="api"&&!i?.has("sideBar")&&this.beans.sideBar?.comp?.setState(e.sideBar),this.updateCachedState("sideBar",this.getSideBarState())}setupStateOnGridReady(e){this.setGridReadyState(e,"gridInitializing");let t=()=>this.updateCachedState("sideBar",this.getSideBarState());this.addManagedEventListeners({toolPanelVisibleChanged:t,sideBarUpdated:t})}updateColumnAndGroupState(){this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState())}setColumnsInitialisedState(e,t,i,s){this.setColumnState(e,t,i,s),this.setColumnGroupState(e,t,s),this.updateColumnAndGroupState()}setupStateOnColumnsInitialised(e,t){this.setColumnsInitialisedState(e,"gridInitializing",t);let i=s=>()=>this.updateColumnState([s]);this.addManagedEventListeners({columnValueChanged:i("aggregation"),columnMoved:i("columnOrder"),columnPinned:i("columnPinning"),columnResized:i("columnSizing"),columnVisible:i("columnVisibility"),columnPivotChanged:i("pivot"),columnPivotModeChanged:i("pivot"),columnRowGroupChanged:i("rowGroup"),sortChanged:i("sort"),newColumnsLoaded:this.updateColumnAndGroupState.bind(this),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setRowCountState(e,t,i){let{filter:s,rowGroupExpansion:n,ssrmRowGroupExpansion:o,rowSelection:l,pagination:d}=e,p=(C,S)=>!i?.has(C)&&(S||t==="api");p("filter",s)&&this.setFilterState(s),p("rowGroupExpansion",n)&&this.setRowGroupExpansionState(o,n,t),p("rowSelection",l)&&this.setRowSelectionState(l,t),p("pagination",d)&&this.setPaginationState(d,t);let y=this.updateCachedState.bind(this);y("filter",this.getFilterState()),this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(y("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),y("rowGroupExpansion",void 0)):(y("rowGroupExpansion",this.getRowGroupExpansionState()),y("ssrmRowGroupExpansion",void 0)),y("rowSelection",this.getRowSelectionState()),y("pagination",this.getPaginationState())}setupStateOnRowCountReady(e){this.setRowCountState(e,"gridInitializing");let t=this.updateCachedState.bind(this),i=()=>{this.updateRowGroupExpansionStateTimer=0,this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(t("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),t("rowGroupExpansion",void 0)):(t("rowGroupExpansion",this.getRowGroupExpansionState()),t("ssrmRowGroupExpansion",void 0))},s=()=>t("filter",this.getFilterState()),{gos:n,colFilter:o}=this.beans;this.addManagedEventListeners({filterChanged:s,rowExpansionStateChanged:this.onRowGroupOpenedDebounced,expandOrCollapseAll:i,columnRowGroupChanged:i,rowDataUpdated:()=>{(n.get("groupDefaultExpanded")!==0||n.get("isGroupOpenByDefault"))&&(this.updateRowGroupExpansionStateTimer||(this.updateRowGroupExpansionStateTimer=setTimeout(i)))},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:l=>{(l.newPage||l.newPageSize)&&t("pagination",this.getPaginationState())}}),o&&this.addManagedListeners(o,{filterStateChanged:s})}setFirstDataRenderedState(e,t,i){let{scroll:s,cellSelection:n,focusedCell:o,columnOrder:l,rowPinning:d}=e,p=(S,P)=>!i?.has(S)&&(P||t==="api");p("focusedCell",o)&&this.setFocusedCellState(o),p("cellSelection",n)&&this.setCellSelectionState(n),p("scroll",s)&&this.setScrollState(s),p("rowPinning",d)&&this.setRowPinningState(d),this.setColumnPivotState(!!l?.orderedColIds,t);let y=this.updateCachedState.bind(this);y("sideBar",this.getSideBarState()),y("focusedCell",this.getFocusedCellState());let C=this.getRangeSelectionState();y("rangeSelection",C),y("cellSelection",C),y("scroll",this.getScrollState())}setupStateOnFirstDataRendered(e){this.setFirstDataRenderedState(e,"gridInitializing");let t=this.updateCachedState.bind(this),i=()=>t("focusedCell",this.getFocusedCellState());this.addManagedEventListeners({cellFocused:i,cellFocusCleared:i,cellSelectionChanged:s=>{if(s.finished){let n=this.getRangeSelectionState();t("rangeSelection",n),t("cellSelection",n)}},bodyScrollEnd:()=>t("scroll",this.getScrollState()),pinnedRowsChanged:()=>t("rowPinning",this.getRowPinningState())})}getColumnState(){let e=this.beans;return UU(av(e),e.colModel.isPivotMode())}setColumnState(e,t,i,s){let{sort:n,rowGroup:o,aggregation:l,pivot:d,columnPinning:p,columnVisibility:y,columnSizing:C,columnOrder:S}=e,P=!1,I=(Xe,lt)=>{let St=!s?.has(Xe)&&!!(lt||t==="api");return P||(P=St),St},O={},V=Xe=>{let lt=O[Xe];return lt||(lt={colId:Xe},O[Xe]=lt,lt)},G={},X=I("sort",n);X&&n?.sortModel.forEach(({colId:Xe,sort:lt},St)=>{let Gt=V(Xe);Gt.sort=lt,Gt.sortIndex=St}),(X||!i)&&(G.sort=null,G.sortIndex=null);let Q=I("rowGroup",o);Q&&o?.groupColIds.forEach((Xe,lt)=>{let St=V(Xe);St.rowGroup=!0,St.rowGroupIndex=lt}),(Q||!i)&&(G.rowGroup=null,G.rowGroupIndex=null);let ae=I("aggregation",l);ae&&l?.aggregationModel.forEach(({colId:Xe,aggFunc:lt})=>{V(Xe).aggFunc=lt}),(ae||!i)&&(G.aggFunc=null);let me=I("pivot",d);me&&(d?.pivotColIds.forEach((Xe,lt)=>{let St=V(Xe);St.pivot=!0,St.pivotIndex=lt}),this.gos.updateGridOptions({options:{pivotMode:!!d?.pivotMode},source:t})),(me||!i)&&(G.pivot=null,G.pivotIndex=null);let fe=I("columnPinning",p);fe&&(p?.leftColIds.forEach(Xe=>{V(Xe).pinned="left"}),p?.rightColIds.forEach(Xe=>{V(Xe).pinned="right"})),(fe||!i)&&(G.pinned=null);let _e=I("columnVisibility",y);_e&&y?.hiddenColIds.forEach(Xe=>{V(Xe).hide=!0}),(_e||!i)&&(G.hide=null);let Ae=I("columnSizing",C);Ae&&C?.columnSizingModel.forEach(({colId:Xe,flex:lt,width:St})=>{let Gt=V(Xe);Gt.flex=lt??null,Gt.width=St}),(Ae||!i)&&(G.flex=null);let Oe=S?.orderedColIds,Ge=!!Oe?.length&&!s?.has("columnOrder"),it=Ge?Oe.map(Xe=>V(Xe)):Object.values(O);(it.length||P)&&(this.columnStates=it,_n(this.beans,{state:it,applyOrder:Ge,defaultState:G},t))}setColumnPivotState(e,t){let i=this.columnStates;this.columnStates=void 0;let s=this.columnGroupStates;this.columnGroupStates=void 0;let n=this.beans,{pivotResultCols:o,colGroupSvc:l}=n;if(o?.isPivotResultColsPresent()){if(i){let d=[];for(let p of i)o.getPivotResultCol(p.colId)&&d.push(p);_n(n,{state:d,applyOrder:e},t)}s&&l?.setColumnGroupState(s,t)}}getColumnGroupState(){let e=this.beans.colGroupSvc;if(!e)return;let t=e.getColumnGroupState();return jU(t)}setColumnGroupState(e,t,i){let s=this.beans.colGroupSvc;if(!s||i?.has("columnGroup")||t!=="api"&&!Object.prototype.hasOwnProperty.call(e,"columnGroup"))return;let n=new Set(e.columnGroup?.openColumnGroupIds),l=s.getColumnGroupState().map(({groupId:d})=>{let p=n.has(d);return p&&n.delete(d),{groupId:d,open:p}});n.forEach(d=>{l.push({groupId:d,open:!0})}),l.length&&(this.columnGroupStates=l),s.setColumnGroupState(l,t)}getFilterState(){let e=this.beans.filterManager,t=e?.getFilterModel();t&&Object.keys(t).length===0&&(t=void 0);let i=e?.getFilterState(),s=e?.getAdvFilterModel()??void 0;return t||s||i?{filterModel:t,columnFilterState:i,advancedFilterModel:s}:void 0}setFilterState(e){let t=this.beans.filterManager,{filterModel:i,columnFilterState:s,advancedFilterModel:n}=e??{filterModel:null,columnFilterState:null,advancedFilterModel:null};(i!==void 0||s!==void 0)&&t?.setFilterState(i??null,s??null,"columnFilter"),n!==void 0&&t?.setAdvFilterModel(n??null,"advancedFilter")}getRangeSelectionState(){let e=this.beans.rangeSvc?.getCellRanges().map(t=>{let{id:i,type:s,startRow:n,endRow:o,columns:l,startColumn:d}=t;return{id:i,type:s,startRow:n,endRow:o,colIds:l.map(p=>p.getColId()),startColId:d.getColId()}});return e?.length?{cellRanges:e}:void 0}setCellSelectionState(e){let{gos:t,rangeSvc:i,colModel:s,visibleCols:n}=this.beans;if(!ta(t)||!i)return;let o=[];e?.cellRanges.forEach(l=>{let d=[];if(l.colIds.forEach(y=>{let C=s.getCol(y);C&&d.push(C)}),!d.length)return;let p=s.getCol(l.startColId);if(!p){let y=n.allCols,C=new Set(d);p=y.find(S=>C.has(S))}o.push(ht(Se({},l),{columns:d,startColumn:p}))}),i.setCellRanges(o)}getScrollState(){if(!this.isClientSideRowModel)return;let e=this.beans.ctrlsSvc.getScrollFeature(),{left:t}=e?.getHScrollPosition()??{left:0},{top:i}=e?.getVScrollPosition()??{top:0};return i||t?{top:i,left:t}:void 0}setScrollState(e){if(!this.isClientSideRowModel)return;let{top:t,left:i}=e??{top:0,left:0},{frameworkOverrides:s,rowRenderer:n,animationFrameSvc:o,ctrlsSvc:l}=this.beans;s.wrapIncoming(()=>{l.get("center").setCenterViewportScrollLeft(i),l.getScrollFeature()?.setVerticalScrollPosition(t),n.redraw({afterScroll:!0}),o?.flushAllFrames()})}getSideBarState(){return this.beans.sideBar?.comp?.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;let e=this.beans.focusSvc.getFocusedCell();if(e){let{column:t,rowIndex:i,rowPinned:s}=e;return{colId:t.getColId(),rowIndex:i,rowPinned:s}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;let{focusSvc:t,colModel:i}=this.beans;if(!e){t.clearFocusedCell();return}let{colId:s,rowIndex:n,rowPinned:o}=e;t.setFocusedCell({column:i.getCol(s),rowIndex:n,rowPinned:o,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){let{pagination:e,gos:t}=this.beans;if(!e)return;let i=e.getCurrentPage(),s=t.get("paginationAutoPageSize")?void 0:e.getPageSize();if(!(!i&&!s))return{page:i,pageSize:s}}setPaginationState(e,t){let{pagination:i,gos:s}=this.beans;if(!i)return;let{pageSize:n,page:o}=e??{page:0,pageSize:s.get("paginationPageSize")},l=t==="gridInitializing";n&&!s.get("paginationAutoPageSize")&&i.setPageSize(n,l?"initialState":"pageSizeSelector"),typeof o=="number"&&(l?i.setPage(o):i.goToPage(o))}getRowSelectionState(){let e=this.beans.selectionSvc;if(!e)return;let t=e.getSelectionState();return!t||!Array.isArray(t)&&(t.selectAll===!1||t.selectAllChildren===!1)&&!t?.toggledNodes?.length?void 0:t}setRowSelectionState(e,t){this.beans.selectionSvc?.setSelectionState(e,t,t==="api")}getRowGroupExpansionState(){let{expansionSvc:e}=this.beans;if(e)return e.getExpansionState()}getRowPinningState(){return this.beans.pinnedRowModel?.getPinnedState()}setRowPinningState(e){let t=this.beans.pinnedRowModel;e?t?.setPinnedState(e):t?.reset()}setRowGroupExpansionState(e,t,i){let s=this.beans.expansionSvc;if(!s)return;let n=t??{expandedRowGroupIds:[],collapsedRowGroupIds:[]};s.setExpansionState(n,i)}updateColumnState(e){let t=this.getColumnState(),i=!1,s=this.cachedState;for(let n of Object.keys(t)){let o=t[n];Wp(o,s[n])||(i=!0)}this.cachedState=Se(Se({},s),t),i&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){let i=this.cachedState[e];this.setCachedStateValue(e,t),Wp(t,i)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState=ht(Se({},this.cachedState),{[e]:t})}refreshStaleState(){let e=this.staleStateKeys;e.forEach(t=>{switch(t){case"rowSelection":this.setCachedStateValue(t,this.getRowSelectionState());break}}),e.clear()}dispatchStateUpdateEvent(e){this.suppressEvents||(e.forEach(t=>this.queuedUpdateSources.add(t)),this.dispatchStateUpdateEventDebounced())}dispatchQueuedStateUpdateEvents(){let e=this.queuedUpdateSources,t=Array.from(e);e.clear(),this.eventSvc.dispatchEvent({type:"stateUpdated",sources:t,state:this.cachedState})}startSuppressEvents(){this.suppressEvents=!0,this.beans.colAnimation?.setSuppressAnimation(!0)}stopSuppressEvents(e){setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.beans.colAnimation?.setSuppressAnimation(!1),this.dispatchStateUpdateEvent([e]))})}suppressEventsAndDispatchInitEvent(e){this.startSuppressEvents(),e(),this.stopSuppressEvents("gridInitializing")}},jZ={moduleName:"GridState",version:nt,beans:[UZ],apiFunctions:{getState:HZ,setState:NZ}};function $Z(e){return e.rowModel.isLastRowIndexKnown()}function qZ(e){return e.pagination?.getPageSize()??100}function ZZ(e){return e.pagination?.getCurrentPage()??0}function KZ(e){return e.pagination?.getTotalPages()??1}function XZ(e){return e.pagination?e.pagination.getMasterRowCount():e.rowModel.getRowCount()}function YZ(e){e.pagination?.goToNextPage()}function QZ(e){e.pagination?.goToPreviousPage()}function JZ(e){e.pagination?.goToFirstPage()}function eK(e){e.pagination?.goToLastPage()}function tK(e,t){e.pagination?.goToPage(t)}var iK=class extends Be{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeSvc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowsCtrl=e.center;let t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.beans.pagination.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;let e=this.centerRowsCtrl.viewportSizeFeature.getBodyHeight();if(e>0){let t=this.beans,i=()=>{let s=Math.max(lc(t),1),n=Math.floor(e/s);t.pagination.setPageSize(n,"autoCalculated")};this.isBodyRendered?Hs(this,i,50)():(i(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},kp="paginationPageSizeSelector",sK={tag:"span",cls:"ag-paging-page-size"},oK=class extends ii{constructor(){super(sK),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;let e=this.selectPageSizeComp.getValue();if(!e)return;let t=Number(e);isNaN(t)||t<1||t===this.pagination.getPageSize()||(this.pagination.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.pagination=e.pagination}postConstruct(){this.addManagedPropertyListener(kp,()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!e?.newPageSize)return;let t=this.pagination.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){Ns(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get(kp)!==!1}reloadPageSizesSelector(){let e=this.getPageSizeSelectorValues(),t=this.pagination.getPageSize(),i=!t||!e.includes(t);if(i){let n=this.gos.exists("paginationPageSize"),o=this.gos.get(kp)!==!0;je(94,{pageSizeSet:n,pageSizesSet:o,pageSizeOptions:e,paginationPageSizeOption:t}),o||je(95,{paginationPageSizeOption:t,paginationPageSizeSelector:kp}),e.unshift("")}let s=String(i?"":t);this.selectPageSizeComp?(rl(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(s,!0)):this.createPageSizeSelectorComp(e,s),this.hasEmptyOption=i}createPageSizeSelectOptions(e){return e.map(t=>({value:String(t)}))}createPageSizeSelectorComp(e,t){let i=this.getLocaleTextFunc(),s=i("pageSizeSelectorLabel","Page Size:"),n=i("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new ob).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(n).setLabel(s).onValueChange(()=>this.handlePageSizeItemSelected()),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){let e=[20,50,100],t=this.gos.get(kp);return!Array.isArray(t)||!t?.length?e:[...t].sort((i,s)=>i-s)}destroy(){this.toggleSelectDisplay(!1),super.destroy()}},nK={selector:"AG-PAGE-SIZE-SELECTOR",component:oK},rK=".ag-paging-panel{align-items:center;border-top:var(--ag-footer-row-border);display:flex;gap:calc(var(--ag-spacing)*4);height:var(--ag-pagination-panel-height);justify-content:flex-end;padding:0 var(--ag-cell-horizontal-padding)}:where(.ag-paging-page-size) .ag-wrapper{min-width:50px}.ag-paging-page-summary-panel{align-items:center;display:flex;gap:var(--ag-cell-widget-spacing);.ag-disabled &{pointer-events:none}}.ag-paging-button{cursor:pointer;position:relative;&.ag-disabled{cursor:default;opacity:.5}}.ag-paging-number,.ag-paging-row-summary-panel-number{font-weight:500}",aK=class extends NM{constructor(){super(),this.btFirst=ot,this.btPrevious=ot,this.btNext=ot,this.btLast=ot,this.lbRecordCount=ot,this.lbFirstRowOnPage=ot,this.lbLastRowOnPage=ot,this.lbCurrent=ot,this.lbTotal=ot,this.pageSizeComp=ot,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1,this.registerCSS(rK)}wireBeans(e){this.rowModel=e.rowModel,this.pagination=e.pagination,this.ariaAnnounce=e.ariaAnnounce}postConstruct(){let e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[nK]);let{btFirst:t,btPrevious:i,btNext:s,btLast:n}=this;this.activateTabIndex([t,i,s,n]),t.insertAdjacentElement("afterbegin",tn(e?"last":"first",this.beans)),i.insertAdjacentElement("afterbegin",tn(e?"next":"previous",this.beans)),s.insertAdjacentElement("afterbegin",tn(e?"previous":"next",this.beans)),n.insertAdjacentElement("afterbegin",tn(e?"first":"last",this.beans)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:o=>this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(o):iH(this.beans,o),forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){let t=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){this.areListenersSetup||(this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)}),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach(e=>{let{el:t,fn:i}=e;this.addManagedListeners(t,{click:i,keydown:s=>{(s.key===Fe.ENTER||s.key===Fe.SPACE)&&(s.preventDefault(),i())}})}),tH(this.beans,this,this.getGui()),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.pagination.goToFirstPage()}formatNumber(e){let t=this.gos.getCallback("paginationNumberFormatter");return t?t({value:e}):$U(e,this.getLocaleTextFunc.bind(this))}getTemplate(){let e=this.getLocaleTextFunc(),t=`ag-${this.getCompId()}`;return{tag:"div",cls:"ag-paging-panel ag-unselectable",attrs:{id:`${t}`},children:[{tag:"ag-page-size-selector",ref:"pageSizeComp"},{tag:"span",cls:"ag-paging-row-summary-panel",children:[{tag:"span",ref:"lbFirstRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-first-row`}},{tag:"span",attrs:{id:`${t}-to`},children:e("to","to")},{tag:"span",ref:"lbLastRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-last-row`}},{tag:"span",attrs:{id:`${t}-of`},children:e("of","of")},{tag:"span",ref:"lbRecordCount",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-row-count`}}]},{tag:"span",cls:"ag-paging-page-summary-panel",role:"presentation",children:[{tag:"div",ref:"btFirst",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("firstPage","First Page")}},{tag:"div",ref:"btPrevious",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("previousPage","Previous Page")}},{tag:"span",cls:"ag-paging-description",children:[{tag:"span",attrs:{id:`${t}-start-page`},children:e("page","Page")},{tag:"span",ref:"lbCurrent",cls:"ag-paging-number",attrs:{id:`${t}-start-page-number`}},{tag:"span",attrs:{id:`${t}-of-page`},children:e("of","of")},{tag:"span",ref:"lbTotal",cls:"ag-paging-number",attrs:{id:`${t}-of-page-number`}}]},{tag:"div",ref:"btNext",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("nextPage","Next Page")}},{tag:"div",ref:"btLast",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("lastPage","Last Page")}}]}]}}onBtNext(){this.nextButtonDisabled||this.pagination.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.pagination.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.pagination.goToLastPage()}enableOrDisableButtons(){let e=this.pagination.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),i=this.pagination.getTotalPages();this.previousAndFirstButtonsDisabled=e===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);let s=this.isZeroPagesToDisplay(),n=e===i-1;this.nextButtonDisabled=n||s,this.lastButtonDisabled=!t||s||e===i-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){M4(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){let e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages();return e&&t===0}updateLabels(){let e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages(),i=this.pagination.getMasterRowCount(),s=e?i:null,n=this.pagination.getCurrentPage(),o=this.pagination.getPageSize(),l,d;this.isZeroPagesToDisplay()?l=d=0:(l=o*n+1,d=l+o-1,e&&d>s&&(d=s));let p=l+o-1,y=!e&&i<p,C=this.formatNumber(l);this.lbFirstRowOnPage.textContent=C;let S,P=this.getLocaleTextFunc();y?S=P("pageLastRowUnknown","?"):S=this.formatNumber(d),this.lbLastRowOnPage.textContent=S;let O=t>0?n+1:0,V=this.formatNumber(O);this.lbCurrent.textContent=V;let G,X;if(e)G=this.formatNumber(t),X=this.formatNumber(s);else{let Q=P("more","more");G=Q,X=Q}this.lbTotal.textContent=G,this.lbRecordCount.textContent=X,this.announceAriaStatus(C,S,X,V,G)}announceAriaStatus(e,t,i,s,n){let o=this.getLocaleTextFunc(),l=o("page","Page"),d=o("to","to"),p=o("of","of"),y=`${e} ${d} ${t} ${p} ${i}`,C=`${l} ${s} ${p} ${n}`;y!==this.ariaRowStatus&&(this.ariaRowStatus=y,this.ariaAnnounce?.announceValue(y,"paginationRow")),C!==this.ariaPageStatus&&(this.ariaPageStatus=C,this.ariaAnnounce?.announceValue(C,"paginationPage"))}},lK={selector:"AG-PAGINATION",component:aK},cK=class extends Be{constructor(){super(...arguments),this.beanName="pagination",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}postConstruct(){let e=this.gos;this.active=e.get("pagination"),this.pageSizeFromGridOptions=e.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return lK}isPaginateChildRows(){let e=this.gos;return e.get("groupHideParentOfSingleChild")||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")?!0:e.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){let t=this.currentPage;if(!this.active||t===e||typeof t!="number")return;let{editSvc:i}=this.beans;i?.isEditing()&&(i.isBatchEditing()?i.cleanupEditors():i.stopEditing(void 0,{source:"api"})),this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0})}goToPageWithIndex(e){if(!this.active)return;let t=e;this.paginateChildRows||(t=this.beans.rowModel.getTopLevelIndexFromDisplayedIndex?.(e)??e),this.goToPage(Math.floor(t/this.pageSize))}isRowInPage(e){return this.active?e>=this.topDisplayedRowIndex&&e<=this.bottomDisplayedRowIndex:!0}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){let e=this.beans.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return st(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:st(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:st(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:st(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.beans.pageBounds.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;let e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){let i=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}i!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){let e=this.totalPages;this.currentPage>=e&&(this.currentPage=e-1);let t=this.currentPage;(!isFinite(t)||isNaN(t)||t<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){let e=this.beans.rowModel,t=e.getTopLevelRowCount();if(this.masterRowCount=t,t<=0){this.setZeroRows();return}let i=this.pageSize,s=t-1;this.totalPages=Math.floor(s/i)+1,this.adjustCurrentPageIfInvalid();let n=this.currentPage,o=i*n,l=i*(n+1)-1;if(l>s&&(l=s),this.topDisplayedRowIndex=e.getTopLevelRowDisplayedIndex(o),l===s)this.bottomDisplayedRowIndex=e.getRowCount()-1;else{let d=e.getTopLevelRowDisplayedIndex(l+1);this.bottomDisplayedRowIndex=d-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){let e=this.beans.rowModel.getRowCount();if(this.masterRowCount=e,e===0){this.setZeroRows();return}let{pageSize:t,currentPage:i}=this,s=e-1;this.totalPages=Math.floor(s/t)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=t*i,this.bottomDisplayedRowIndex=t*(i+1)-1,this.bottomDisplayedRowIndex>s&&(this.bottomDisplayedRowIndex=s)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.beans.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){let{keepRenderedRows:t=!1,newPage:i=!1,newPageSize:s=!1}=e;this.eventSvc.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:i,newPageSize:s,keepRenderedRows:t})}},hK={moduleName:"Pagination",version:nt,beans:[cK,iK],icons:{first:"first",previous:"previous",next:"next",last:"last"},apiFunctions:{paginationIsLastPageFound:$Z,paginationGetPageSize:qZ,paginationGetCurrentPage:ZZ,paginationGetTotalPages:KZ,paginationGetRowCount:XZ,paginationGoToNextPage:YZ,paginationGoToPreviousPage:QZ,paginationGoToFirstPage:JZ,paginationGoToLastPage:eK,paginationGoToPage:tK},dependsOn:[Ev]};function uK(e,t={}){let i=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.redrawRows(i))}function tD(e,t,i,s,n){t&&(s&&t.parent&&t.parent.level!==-1&&tD(e,t.parent,i,s,n),t.setExpanded(i,void 0,n))}function dK(e,t){return e.rowModel.getRowNode(t)}function pK(e,t,i,s){e.rowRenderer.addRenderedRowListener(t,i,s)}function gK(e){return e.rowRenderer.getRenderedNodes()}function fK(e,t,i){e.rowModel.forEachNode(t,i)}function mK(e){return e.rowRenderer.firstRenderedRow}function vK(e){return e.rowRenderer.lastRenderedRow}function yK(e,t){return e.rowModel.getRow(t)}function wK(e){return e.rowModel.getRowCount()}var CK={moduleName:"RowApi",version:nt,apiFunctions:{redrawRows:uK,setRowNodeExpanded:tD,getRowNode:dK,addRenderedRowListener:pK,getRenderedNodes:gK,forEachNode:fK,getFirstDisplayedRowIndex:mK,getLastDisplayedRowIndex:vK,getDisplayedRowAtIndex:yK,getDisplayedRowCount:wK}},bK={moduleName:"ScrollApi",version:nt,apiFunctions:{getVerticalPixelRange:B$,getHorizontalPixelRange:V$,ensureColumnVisible:WT,ensureIndexVisible:UT,ensureNodeVisible:H$}};function xK(e,t,i){if(!t)return;let s=e.ctrlsSvc.getGridBodyCtrl().eGridBody,n=`aria-${t}`;i===null?s.removeAttribute(n):s.setAttribute(n,i)}function _K(e,t={}){e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.refreshCells(t))}function SK(e){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getHeaderRowContainerCtrls().forEach(t=>t.refresh()))}function RK(e){return e.animationFrameSvc?.isQueueEmpty()??!0}function EK(e){e.animationFrameSvc?.flushAllFrames()}function PK(e){return{rowHeight:lc(e),headerHeight:cg(e)}}function MK(e,t={}){let i=[];if(e.rowRenderer.getCellCtrls(t.rowNodes,t.columns).forEach(o=>{let l=o.getCellRenderer();l!=null&&i.push(Yp(l))}),t.columns?.length)return i;let s=[],n=OC(t.rowNodes);return e.rowRenderer.getAllRowCtrls().forEach(o=>{if(n&&!zC(o.rowNode,n)||!o.isFullWidth())return;let l=o.getFullWidthCellRenderers();for(let d=0;d<l.length;d++){let p=l[d];p!=null&&s.push(Yp(p))}}),[...s,...i]}var TK={moduleName:"RenderApi",version:nt,apiFunctions:{setGridAriaProperty:xK,refreshCells:_K,refreshHeader:SK,isAnimationFrameQueueEmpty:RK,flushAllAnimationFrames:EK,getSizesForCurrentTheme:PK,getCellRendererInstances:MK}};function DK(e,t){typeof t=="number"?e.colAutosize?.sizeColumnsToFit(t,"api"):e.colAutosize?.sizeColumnsToFitGridBody(t)}function iD({colAutosize:e,visibleCols:t},i,s){Array.isArray(i)?e?.autoSizeCols({colKeys:i,skipHeader:s,source:"api"}):e?.autoSizeCols({colKeys:i.colIds??t.allCols,skipHeader:i.skipHeader,defaultMaxWidth:i.defaultMaxWidth,defaultMinWidth:i.defaultMinWidth,columnLimits:i.columnLimits,source:"api"})}function FK(e,t){t&&typeof t=="object"?iD(e,t):e.colAutosize?.autoSizeAllColumns({source:"api",skipHeader:t})}var IK=class extends Be{constructor(){super(...arguments),this.beanName="colAutosize",this.timesDelayed=0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}postConstruct(){let e=this.gos.get("autoSizeStrategy");if(e){let t=!1,i=e.type;i==="fitGridWidth"||i==="fitProvidedWidth"?t=!0:i==="fitCellContents"&&this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered(e)}),t&&this.beans.colDelayRenderSvc?.hideColumns(i)}}autoSizeCols(e){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.autoSizeCols(e));return}let{colKeys:t,skipHeader:i,skipHeaderGroups:s,stopAtGroup:n,defaultMaxWidth:o,defaultMinWidth:l,columnLimits:d=[],source:p="api"}=e,{animationFrameSvc:y,renderStatus:C,colModel:S,autoWidthCalc:P,visibleCols:I}=this.beans;if(y?.flushAllFrames(),this.timesDelayed<5&&C&&(!C.areHeaderCellsRendered()||!C.areCellsRendered())){this.timesDelayed++,setTimeout(()=>{this.isAlive()&&this.autoSizeCols(e)});return}this.timesDelayed=0;let O=[],V=-1,G=Object.fromEntries(d.map(({colId:ae,maxWidth:me,minWidth:fe})=>[ae,{maxWidth:me,minWidth:fe}])),X=i??this.gos.get("skipHeaderOnAutoSize"),Q=s??X;for(;V!==0;){V=0;let ae=[];t.forEach(me=>{if(!me||IB(me))return;let fe=S.getCol(me);if(!fe||O.indexOf(fe)>=0)return;let _e=P.getPreferredWidthForColumn(fe,X);if(_e>0){let Ae=G[fe.colId]??{};Ae.minWidth??(Ae.minWidth=l),Ae.maxWidth??(Ae.maxWidth=o);let Oe=kK(fe,_e,Ae);fe.setActualWidth(Oe,p),O.push(fe),V++}ae.push(fe)}),ae.length&&I.refresh(p)}Q||this.autoSizeColumnGroupsByColumns(t,p,n),Mu(this.eventSvc,O,!0,"autosizeColumns")}autoSizeColumn(e,t,i){e&&this.autoSizeCols({colKeys:[e],skipHeader:i,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,i){let{colModel:s,ctrlsSvc:n}=this.beans,o=new Set;s.getColsForKeys(e).forEach(y=>{let C=y.getParent();for(;C&&C!=i;)C.isPadding()||o.add(C),C=C.getParent()});let d,p=[];for(let y of o){for(let C of n.getHeaderRowContainerCtrls())if(d=C.getHeaderCtrlForColumn(y),d)break;d&&d.resizeLeafColumnsToFit(t)}return p}autoSizeAllColumns(e){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.autoSizeAllColumns(e));return}let t=this.beans.visibleCols.allCols;this.autoSizeCols(Se({colKeys:t},e))}addColumnAutosize(e,t){let i=this.gos.get("skipHeaderOnAutoSize"),s=()=>{this.autoSizeColumn(t,"uiColumnResized",i)};e.addEventListener("dblclick",s);let n=new sc(e);return n.addEventListener("doubleTap",s),()=>{e.removeEventListener("dblclick",s),n.removeEventListener("doubleTap",s),n.destroy()}}addColumnGroupResize(e,t,i){let s=this.gos.get("skipHeaderOnAutoSize"),n=()=>{let o=[];t.getDisplayedLeafColumns().forEach(d=>{d.getColDef().suppressAutoSize||o.push(d.getColId())}),o.length>0&&this.autoSizeCols({colKeys:o,skipHeader:s,stopAtGroup:t,source:"uiColumnResized"}),i()};return e.addEventListener("dblclick",n),()=>e.removeEventListener("dblclick",n)}sizeColumnsToFitGridBody(e,t){if(!this.isAlive())return;let{ctrlsSvc:i,scrollVisibleSvc:s}=this.beans,n=i.getGridBodyCtrl(),l=n.isVerticalScrollShowing()?s.getScrollbarWidth():0,p=qp(n.eGridBody)-l;if(p>0){this.sizeColumnsToFit(p,"sizeColumnsToFit",!1,e);return}t===void 0?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,100)},0):t===100?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,500)},100):t===500?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,-1)},500):je(29)}sizeColumnsToFit(e,t="sizeColumnsToFit",i,s){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.sizeColumnsToFit(e,t,i,s));return}let n={};s&&s?.columnLimits?.forEach(V=>{var G=V,{key:I}=G,O=Kd(G,["key"]);n[typeof I=="string"?I:I.getColId()]=O});let o=this.beans.visibleCols.allCols;if(e<=0||!o.length||e===Kr(o)&&o.every(O=>{if(O.colDef.suppressSizeToFit)return!0;let V=n?.[O.getId()],G=V?.minWidth??s?.defaultMinWidth,X=V?.maxWidth??s?.defaultMaxWidth,Q=O.getActualWidth();return(G==null||Q>=G)&&(X==null||Q<=X)}))return;let d=[],p=[];o.forEach(I=>{I.getColDef().suppressSizeToFit===!0?p.push(I):d.push(I)});let y=d.slice(0),C=!1,S=I=>{sn(d,I),p.push(I)};for(d.forEach(I=>{I.resetActualWidth(t);let O=n?.[I.getId()],V=O?.minWidth??s?.defaultMinWidth,G=O?.maxWidth??s?.defaultMaxWidth,X=I.getActualWidth();typeof V=="number"&&X<V?I.setActualWidth(V,t,!0):typeof G=="number"&&X>G&&I.setActualWidth(G,t,!0)});!C;){C=!0;let I=e-Kr(p);if(I<=0)d.forEach(O=>{let V=n?.[O.getId()]?.minWidth??s?.defaultMinWidth;if(typeof V=="number"){O.setActualWidth(V,t,!0);return}O.setActualWidth(O.minWidth,t)});else{let O=I/Kr(d),V=I;for(let G=d.length-1;G>=0;G--){let X=d[G],Q=n?.[X.getId()],ae=Q?.minWidth??s?.defaultMinWidth,me=Q?.maxWidth??s?.defaultMaxWidth,fe=X.getMinWidth(),_e=X.getMaxWidth(),Ae=typeof ae=="number"&&ae>fe?ae:fe,Oe=typeof me=="number"&&me<_e?me:_e,Ge=Math.round(X.getActualWidth()*O);Ge<Ae?(Ge=Ae,S(X),C=!1):Ge>Oe?(Ge=Oe,S(X),C=!1):G===0&&(Ge=V),X.setActualWidth(Ge,t,!0),V-=Ge}}}y.forEach(I=>{I.fireColumnWidthChangedEvent(t)});let P=this.beans.visibleCols;P.setLeftValues(t),P.updateBodyWidths(),!i&&Mu(this.eventSvc,y,!0,t)}applyAutosizeStrategy(){let{gos:e,colDelayRenderSvc:t}=this.beans,i=e.get("autoSizeStrategy");!i||i.type==="fitCellContents"||setTimeout(()=>{if(!this.isAlive())return;let s=i.type;if(s==="fitGridWidth"){let{columnLimits:n,defaultMinWidth:o,defaultMaxWidth:l}=i,d=n?.map(({colId:p,minWidth:y,maxWidth:C})=>({key:p,minWidth:y,maxWidth:C}));this.sizeColumnsToFitGridBody({defaultMinWidth:o,defaultMaxWidth:l,columnLimits:d})}else s==="fitProvidedWidth"&&this.sizeColumnsToFit(i.width,"sizeColumnsToFit");t?.revealColumns(s)})}onFirstDataRendered(e){let{colIds:t,skipHeader:i,defaultMaxWidth:s,defaultMinWidth:n,columnLimits:o}=e;setTimeout(()=>{if(!this.isAlive())return;let l={skipHeader:i,source:"autosizeColumns",defaultMaxWidth:s,defaultMinWidth:n,columnLimits:o};t?this.autoSizeCols(Se({colKeys:t},l)):this.autoSizeAllColumns(l)})}processResizeOperations(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach(e=>e()),this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}destroy(){this.resizeOperationQueue.length=0,super.destroy()}};function kK(e,t,i={}){let s=i.minWidth??e.getMinWidth();t<s&&(t=s);let n=i.maxWidth??e.getMaxWidth();return t>n&&(t=n),t}var AK={moduleName:"ColumnAutoSize",version:nt,beans:[IK],apiFunctions:{sizeColumnsToFit:DK,autoSizeColumns:iD,autoSizeAllColumns:FK},dependsOn:[XM]},LK=".ag-row-pinned-source{background-color:var(--ag-pinned-source-row-background-color);color:var(--ag-pinned-source-row-text-color);font-weight:var(--ag-pinned-source-row-font-weight)}.ag-row-pinned-manual{background-color:var(--ag-pinned-row-background-color);color:var(--ag-pinned-row-text-color);font-weight:var(--ag-pinned-row-font-weight)}";function OK(e){return e.pinnedRowModel?.getPinnedTopRowCount()??0}function zK(e){return e.pinnedRowModel?.getPinnedBottomRowCount()??0}function BK(e,t){return e.pinnedRowModel?.getPinnedTopRow(t)}function VK(e,t){return e.pinnedRowModel?.getPinnedBottomRow(t)}function HK(e,t,i){return e.pinnedRowModel?.forEachPinnedRow(t,i)}var NK={moduleName:"PinnedRow",version:nt,beans:[zH],css:[LK],apiFunctions:{getPinnedTopRowCount:OK,getPinnedBottomRowCount:zK,getPinnedTopRow:BK,getPinnedBottomRow:VK,forEachPinnedRow:HK},icons:{rowPin:"pin",rowPinTop:"pinned-top",rowPinBottom:"pinned-bottom",rowUnpin:"un-pin"}},GK=class extends Ru{constructor(e,t,i){super(e.col,e.firstNode,i,t),this.cellSpan=e,this.SPANNED_CELL_CSS_CLASS="ag-spanned-cell"}setComp(e,t,i,s,n,o,l){this.eWrapper=i,super.setComp(e,t,i,s,n,o,l),this.setAriaRowSpan(),this.refreshAriaRowIndex()}isCellSpanning(){return!0}getCellSpan(){return this.cellSpan}refreshAriaRowIndex(){this.rowNode.rowIndex!=null&&Xm(this.eGui,this.rowNode.rowIndex)}setAriaRowSpan(){k4(this.eGui,this.cellSpan.spannedNodes.size)}setFocusedCellPosition(e){this.focusedCellPosition=e}getFocusedCellPosition(){return this.focusedCellPosition??this.cellPosition}checkCellFocused(){let e=this.beans.focusSvc.getFocusedCell();return!!e&&this.cellSpan.doesSpanContain(e)}applyStaticCssClasses(){super.applyStaticCssClasses(),this.comp.toggleCss(this.SPANNED_CELL_CSS_CLASS,!0)}onCellFocused(e){let{beans:t}=this;if(_v(t)){this.focusedCellPosition=void 0;return}let i=this.isCellFocused();i||(this.focusedCellPosition=void 0),e&&i&&(this.focusedCellPosition={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column}),super.onCellFocused(e)}getRootElement(){return this.eWrapper}},WK=class extends fv{onRowIndexChanged(){super.onRowIndexChanged(),this.getAllCellCtrls().forEach(e=>e.refreshAriaRowIndex())}getInitialRowClasses(e){return["ag-spanned-row"]}getNewCellCtrl(e){let t=this.beans.rowSpanSvc?.getCellSpan(e,this.rowNode);if(!(!t||t.firstNode!==this.rowNode))return new GK(t,this,this.beans)}isCorrectCtrlForSpan(e){let t=this.beans.rowSpanSvc?.getCellSpan(e.column,this.rowNode);return!t||t.firstNode!==this.rowNode?!1:e.getCellSpan()===t}onRowHeightChanged(){}refreshFirstAndLastRowStyles(){}addHoverFunctionality(){}resetHoveredStatus(){}},UK=class extends Be{constructor(){super(...arguments),this.beanName="spannedRowRenderer",this.topCtrls=new Map,this.bottomCtrls=new Map,this.centerCtrls=new Map}postConstruct(){this.addManagedEventListeners({displayedRowsChanged:this.createAllCtrls.bind(this)})}createAllCtrls(){this.createCtrls("top"),this.createCtrls("bottom"),this.createCtrls("center")}createCtrls(e){let{rowSpanSvc:t}=this.beans,i=`${e}Ctrls`,s=this[i],n=s.size,o=this.getAllRelevantRowControls(e),l=new Map,d=!1;for(let y of o)y.isAlive()&&t?.forEachSpannedColumn(y.rowNode,(C,S)=>{if(l.has(S.firstNode))return;let P=s.get(S.firstNode);if(P){l.set(S.firstNode,P),s.delete(S.firstNode);return}d=!0;let I=new WK(S.firstNode,this.beans,!1,!1,!1);l.set(S.firstNode,I)});this[i]=l;let p=l.size===n;if(!(!d&&p)){for(let y of s.values())y.destroyFirstPass(!0),y.destroySecondPass();this.dispatchLocalEvent({type:"spannedRowsUpdated",ctrlsKey:e})}}getAllRelevantRowControls(e){let{rowRenderer:t}=this.beans;switch(e){case"top":return t.topRowCtrls;case"bottom":return t.bottomRowCtrls;case"center":return t.allRowCtrls}}getCellByPosition(e){let{rowSpanSvc:t}=this.beans,i=t?.getCellSpanByPosition(e);if(!i)return;let s=`${sD(e.rowPinned)}Ctrls`,n=this[s].get(i.firstNode);if(n)return n.getAllCellCtrls().find(o=>o.column===e.column)}getCtrls(e){let t=`${e}Ctrls`;return[...this[t].values()]}destroyRowCtrls(e){let t=`${e}Ctrls`;for(let i of this[t].values())i.destroyFirstPass(!0),i.destroySecondPass();this[t]=new Map}destroy(){super.destroy(),this.destroyRowCtrls("top"),this.destroyRowCtrls("bottom"),this.destroyRowCtrls("center")}},sD=e=>e??"center",jK=class{constructor(e,t){this.col=e,this.firstNode=t,this.cellSpan=!0,this.spannedNodes=new Set,this.addSpannedNode(t)}reset(){this.spannedNodes.clear(),this.addSpannedNode(this.firstNode)}addSpannedNode(e){this.spannedNodes.add(e),this.lastNode=e}getLastNode(){return this.lastNode}getCellHeight(){return this.lastNode.rowTop+this.lastNode.rowHeight-this.firstNode.rowTop-1}doesSpanContain(e){return e.column!==this.col||e.rowPinned!=this.firstNode.rowPinned?!1:this.firstNode.rowIndex<=e.rowIndex&&e.rowIndex<=this.lastNode.rowIndex}getLastNodeAutoHeight(){let e=this.firstNode.__autoHeights?.[this.col.getColId()];if(e==null)return;let t=0;return this.spannedNodes.forEach(i=>{i!==this.lastNode&&(t+=i.rowHeight)}),e-t}},$K=class extends Be{constructor(e){super(),this.column=e}buildCache(e){let{column:t,beans:{gos:i,pinnedRowModel:s,rowModel:n,valueSvc:o,pagination:l}}=this,{colDef:d}=t,p=this[`${e}ValueNodeMap`],y=new Map,C=i.getCallback("isFullWidthRow"),S=d.equals,P=d.spanRows,I=typeof P=="function",O=null,V=null,G,X=(ae,me)=>{O=ae,V=null,G=me},Q=ae=>{let me=!ae.isExpandable()&&!ae.group&&!ae.detail&&(C?!C({rowNode:ae}):!0);if(ae.rowIndex==null||!me){X(null,null);return}if(O==null||ae.level!==O.level||ae.footer||V&&ae.rowIndex-1!==V?.getLastNode().rowIndex){X(ae,o.getValue(t,ae));return}let fe=o.getValue(t,ae);if(I){let _e=bt(i,{valueA:G,nodeA:O,valueB:fe,nodeB:ae,column:t,colDef:d});if(!P(_e)){X(ae,fe);return}}else if(S?!S(G,fe):G!==fe){X(ae,fe);return}if(!V){let _e=p?.get(O);_e?.firstNode===O?(_e.reset(),V=_e):V=new jK(t,O),y.set(O,V)}V.addSpannedNode(ae),y.set(ae,V)};switch(e){case"center":n.forEachDisplayedNode?.(ae=>{(!l||l.isRowInPage(ae.rowIndex))&&Q(ae)});break;case"top":s?.forEachPinnedRow("top",Q);break;case"bottom":s?.forEachPinnedRow("bottom",Q);break}this[`${e}ValueNodeMap`]=y}isCellSpanning(e){return!!this.getCellSpan(e)}getCellSpan(e){return this[`${sD(e.rowPinned)}ValueNodeMap`].get(e)}},qK=class extends Be{constructor(){super(...arguments),this.beanName="rowSpanSvc",this.spanningColumns=new Map,this.debouncePinnedEvent=Hs(this,this.dispatchCellsUpdatedEvent.bind(this,!0),0),this.debounceModelEvent=Hs(this,this.dispatchCellsUpdatedEvent.bind(this,!1),0),this.pinnedTimeout=null,this.modelTimeout=null}postConstruct(){let e=this.onRowDataUpdated.bind(this),t=this.buildPinnedCaches.bind(this);this.addManagedEventListeners({paginationChanged:this.buildModelCaches.bind(this),pinnedRowDataChanged:t,pinnedRowsChanged:t,rowNodeDataChanged:e,cellValueChanged:e})}register(e){let{gos:t}=this.beans;if(!t.get("enableCellSpan")||this.spanningColumns.has(e))return;let i=this.createManagedBean(new $K(e));this.spanningColumns.set(e,i),i.buildCache("top"),i.buildCache("bottom"),i.buildCache("center"),this.debouncePinnedEvent(),this.debounceModelEvent()}dispatchCellsUpdatedEvent(e){this.dispatchLocalEvent({type:"spannedCellsUpdated",pinned:e})}deregister(e){this.spanningColumns.delete(e)}onRowDataUpdated({node:e}){let{spannedRowRenderer:t}=this.beans;if(e.rowPinned){if(this.pinnedTimeout!=null)return;this.pinnedTimeout=window.setTimeout(()=>{this.pinnedTimeout=null,this.buildPinnedCaches(),t?.createCtrls("top"),t?.createCtrls("bottom")},0);return}this.modelTimeout==null&&(this.modelTimeout=window.setTimeout(()=>{this.modelTimeout=null,this.buildModelCaches(),t?.createCtrls("center")},0))}buildModelCaches(){this.modelTimeout!=null&&clearTimeout(this.modelTimeout),this.spanningColumns.forEach(e=>e.buildCache("center")),this.debounceModelEvent()}buildPinnedCaches(){this.pinnedTimeout!=null&&clearTimeout(this.pinnedTimeout),this.spanningColumns.forEach(e=>{e.buildCache("top"),e.buildCache("bottom")}),this.debouncePinnedEvent()}isCellSpanning(e,t){let i=this.spanningColumns.get(e);return i?i.isCellSpanning(t):!1}getCellSpanByPosition(e){let{pinnedRowModel:t,rowModel:i}=this.beans,s=e.column,n=e.rowIndex,o=this.spanningColumns.get(s);if(!o)return;let l;switch(e.rowPinned){case"top":l=t?.getPinnedTopRow(n);break;case"bottom":l=t?.getPinnedBottomRow(n);break;default:l=i.getRow(n)}if(l)return o.getCellSpan(l)}getCellStart(e){let t=this.getCellSpanByPosition(e);return t?ht(Se({},e),{rowIndex:t.firstNode.rowIndex}):e}getCellEnd(e){let t=this.getCellSpanByPosition(e);return t?ht(Se({},e),{rowIndex:t.getLastNode().rowIndex}):e}getCellSpan(e,t){let i=this.spanningColumns.get(e);if(i)return i.getCellSpan(t)}forEachSpannedColumn(e,t){for(let[i,s]of this.spanningColumns)if(s.isCellSpanning(e)){let n=s.getCellSpan(e);t(i,n)}}destroy(){super.destroy(),this.spanningColumns.clear()}},ZK={moduleName:"CellSpan",version:nt,beans:[qK,UK]},KK=class extends Be{constructor(e,t){super(),this.cellCtrl=e,this.staticClasses=[],this.beans=t,this.column=e.column}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){let{column:e,cellComp:t}=this,i=e.colDef,s=i.cellClassRules,n=this.getCellClassParams(e,i);Eb(this.beans.expressionSvc,s===this.cellClassRules?void 0:this.cellClassRules,s,n,o=>t.toggleCss(o,!0),o=>t.toggleCss(o,!1)),this.cellClassRules=s}applyUserStyles(){let e=this.column,t=e.colDef,i=t.cellStyle;if(!i)return;let s;if(typeof i=="function"){let n=this.getCellClassParams(e,t);s=i(n)}else s=i;s&&this.cellComp.setUserStyles(s)}applyClassesFromColDef(){let{column:e,cellComp:t}=this,i=e.colDef,s=this.getCellClassParams(e,i);this.staticClasses.forEach(o=>t.toggleCss(o,!1));let n=this.beans.cellStyles.getStaticCellClasses(i,s);this.staticClasses=n,n.forEach(o=>t.toggleCss(o,!0))}getCellClassParams(e,t){let{value:i,rowNode:s}=this.cellCtrl;return bt(this.beans.gos,{value:i,data:s.data,node:s,colDef:t,column:e,rowIndex:s.rowIndex})}},XK=class extends Be{constructor(){super(...arguments),this.beanName="cellStyles"}processAllCellClasses(e,t,i,s){Eb(this.beans.expressionSvc,void 0,e.cellClassRules,t,i,s),this.processStaticCellClasses(e,t,i)}getStaticCellClasses(e,t){let{cellClass:i}=e;if(!i)return[];let s;return typeof i=="function"?s=i(t):s=i,typeof s=="string"&&(s=[s]),s||[]}createCellCustomStyleFeature(e,t){return new KK(e,t)}processStaticCellClasses(e,t,i){this.getStaticCellClasses(e,t).forEach(n=>{i(n)})}},YK={moduleName:"CellStyle",version:nt,beans:[XK]},QK={moduleName:"RowStyle",version:nt,beans:[U9]};function JK(e,t){return!!e.colHover?.isHovered(t)}var eX=class extends Be{constructor(e,t){super(),this.columns=e,this.element=t,this.destroyManagedListeners=[],this.enableFeature=i=>{let{beans:s,gos:n,element:o,columns:l}=this,d=s.colHover;i??!!n.get("columnHoverHighlight")?this.destroyManagedListeners=this.addManagedElementListeners(o,{mouseover:d.setMouseOver.bind(d,l),mouseout:d.clearMouseOver.bind(d)}):(this.destroyManagedListeners.forEach(y=>y()),this.destroyManagedListeners=[])}}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{this.enableFeature(e)}),this.enableFeature()}destroy(){super.destroy(),this.destroyManagedListeners=null}},tX="ag-column-hover",iX=class extends Be{constructor(){super(...arguments),this.beanName="colHover"}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{e||this.clearMouseOver()})}setMouseOver(e){this.updateState(e)}clearMouseOver(){this.updateState(null)}isHovered(e){if(!this.gos.get("columnHoverHighlight"))return!1;let t=this.selectedColumns;return!!t&&t.indexOf(e)>=0}addHeaderColumnHoverListener(e,t,i){let s=()=>{let n=this.isHovered(i);t.toggleCss("ag-column-hover",n)};e.addManagedEventListeners({columnHoverChanged:s}),s()}onCellColumnHover(e,t){if(!t)return;let i=this.isHovered(e);t.toggleCss(tX,i)}addHeaderFilterColumnHoverListener(e,t,i,s){this.createHoverFeature(e,[i],s);let n=()=>{let o=this.isHovered(i);t.toggleCss("ag-column-hover",o)};e.addManagedEventListeners({columnHoverChanged:n}),n()}createHoverFeature(e,t,i){e.createManagedBean(new eX(t,i))}updateState(e){this.selectedColumns=e,this.eventSvc.dispatchEvent({type:"columnHoverChanged"})}},sX={moduleName:"ColumnHover",version:nt,beans:[iX],apiFunctions:{isColumnHovered:JK}},oX=class extends Be{constructor(){super(...arguments),this.beanName="apiEventSvc",this.syncListeners=new Map,this.asyncListeners=new Map,this.syncGlobalListeners=new Set,this.globalListenerPairs=new Map}postConstruct(){this.wrapSvc=this.beans.frameworkOverrides.createGlobalEventListenerWrapper?.()}addListener(e,t){let i=this.wrapSvc?.wrap(e,t)??t,s=!Zm.has(e),n=s?this.asyncListeners:this.syncListeners;n.has(e)||n.set(e,new Set),n.get(e).add(i),this.eventSvc.addListener(e,i,s)}removeListener(e,t){let i=this.wrapSvc?.unwrap(e,t)??t,n=!!this.asyncListeners.get(e)?.delete(i);n||this.syncListeners.get(e)?.delete(i),this.eventSvc.removeListener(e,i,n)}addGlobalListener(e){let t=this.wrapSvc?.wrapGlobal(e)??e,i=(o,l)=>{Zm.has(o)&&t(o,l)},s=(o,l)=>{Zm.has(o)||t(o,l)};this.globalListenerPairs.set(e,{syncListener:i,asyncListener:s});let n=this.eventSvc;n.addGlobalListener(i,!1),n.addGlobalListener(s,!0)}removeGlobalListener(e){let{eventSvc:t,wrapSvc:i,globalListenerPairs:s}=this,n=i?.unwrapGlobal(e)??e;if(s.has(n)){let{syncListener:l,asyncListener:d}=s.get(n);t.removeGlobalListener(l,!1),t.removeGlobalListener(d,!0),s.delete(e)}else this.syncGlobalListeners.delete(n),t.removeGlobalListener(n,!1)}destroyEventListeners(e,t){e.forEach((i,s)=>{i.forEach(n=>this.eventSvc.removeListener(s,n,t)),i.clear()}),e.clear()}destroyGlobalListeners(e,t){e.forEach(i=>this.eventSvc.removeGlobalListener(i,t)),e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncListeners,!1),this.destroyEventListeners(this.asyncListeners,!0),this.destroyGlobalListeners(this.syncGlobalListeners,!1);let{globalListenerPairs:e,eventSvc:t}=this;e.forEach(({syncListener:i,asyncListener:s})=>{t.removeGlobalListener(i,!1),t.removeGlobalListener(s,!0)}),e.clear()}};function nX(e,t,i){e.apiEventSvc?.addListener(t,i)}function rX(e,t,i){e.apiEventSvc?.removeListener(t,i)}function aX(e,t){e.apiEventSvc?.addGlobalListener(t)}function lX(e,t){e.apiEventSvc?.removeGlobalListener(t)}var cX={moduleName:"EventApi",version:nt,apiFunctions:{addEventListener:nX,addGlobalListener:aX,removeEventListener:rX,removeGlobalListener:lX},beans:[oX]},hX={moduleName:"Locale",version:nt,beans:[WU]},uX=class extends Be{constructor(){super(...arguments),this.beanName="rowAutoHeight",this.wasEverActive=!1,this._debouncedCalculateRowHeights=Hs(this,this.calculateRowHeights.bind(this),1)}requestCheckAutoHeight(){this.wasEverActive&&this._debouncedCalculateRowHeights()}calculateRowHeights(){let{visibleCols:e,rowModel:t,rowSpanSvc:i,pinnedRowModel:s}=this.beans,n=e.autoHeightCols,o=!1,l=d=>{let p=d.__autoHeights,y=sl(this.beans,d).height;for(let C of n){let S=p?.[C.getColId()],P=i?.getCellSpan(C,d);if(P){if(P.getLastNode()!==d)continue;if(S=i?.getCellSpan(C,d)?.getLastNodeAutoHeight(),!S)return}if(S==null){if(this.colSpanSkipCell(C,d))continue;return}y=Math.max(S,y)}y!==d.rowHeight&&(d.setRowHeight(y),o=!0)};s?.forEachPinnedRow?.("top",l),s?.forEachPinnedRow?.("bottom",l),t.forEachDisplayedNode?.(l),o&&t.onRowHeightChanged?.()}setRowAutoHeight(e,t,i){if(e.__autoHeights??(e.__autoHeights={}),t==null){delete e.__autoHeights[i.getId()];return}let s=e.__autoHeights[i.getId()];e.__autoHeights[i.getId()]=t,s!==t&&this.requestCheckAutoHeight()}colSpanSkipCell(e,t){let{colModel:i,colViewport:s,visibleCols:n}=this.beans;if(!i.colSpanActive)return!1;let o=[];switch(e.getPinned()){case"left":o=n.getLeftColsForRow(t);break;case"right":o=n.getRightColsForRow(t);break;case null:o=s.getColsWithinViewport(t);break}return!o.includes(e)}setupCellAutoHeight(e,t,i){if(!e.column.isAutoHeight()||!t)return!1;this.wasEverActive=!0;let s=t.parentElement,{rowNode:n,column:o}=e,l=this.beans,d=C=>{if(this.beans.editSvc?.isEditing(e)||!e.isAlive()||!i.isAlive())return;let{paddingTop:S,paddingBottom:P,borderBottomWidth:I,borderTopWidth:O}=yc(s),V=S+P+I+O,X=t.offsetHeight+V;if(C<5){let Q=Vs(l),ae=!Q||!Q.contains(t),me=X==0;if(ae||me){window.setTimeout(()=>d(C+1),0);return}}this.setRowAutoHeight(n,X,o)},p=()=>d(0);p();let y=nl(l,t,p);return i.addDestroyFunc(()=>{y(),this.setRowAutoHeight(n,void 0,o)}),!0}setAutoHeightActive(e){this.active=e.list.some(t=>t.isVisible()&&t.isAutoHeight())}areRowsMeasured(){if(!this.active)return!0;let e=this.beans.rowRenderer.getAllRowCtrls(),t=null;for(let{rowNode:i}of e)if((!t||this.beans.colModel.colSpanActive)&&(t=this.beans.colViewport.getColsWithinViewport(i).filter(n=>n.isAutoHeight())),t.length!==0){if(!i.__autoHeights)return!1;for(let s of t){let n=i.__autoHeights[s.getColId()];if(!n||i.rowHeight<n)return!1}}return!0}},dX={moduleName:"RowAutoHeight",version:nt,beans:[uX]},oD={moduleName:"AllCommunity",version:nt,dependsOn:[uZ,wZ,TZ,aj,vq,yq,wq,Cq,bq,xq,_q,mq,c$,h$,u$,l$,p$,g$,jZ,Zq,hK,YM,CK,bK,TK,AK,XN,NK,Bq,EU,YK,sX,QK,cX,TU,VZ,GT,hX,dX,KN,dZ,ZK]};var pX=(()=>{class e{constructor(){this.vcr=Ci(Rf)}static{this.\u0275fac=function(s){return new(s||e)}}static{this.\u0275cmp=oo({type:e,selectors:[["ag-component-container"]],standalone:!1,decls:0,vars:0,template:function(s,n){},encapsulation:2})}}return e})(),aD=16,Ab=0;function gX(e){let t=new Map;for(let i=0;i<aD;i++){let s=e.createComponent(pX);t.set(i,s),yo(s.location.nativeElement)}return t}var fX=new Set(["doesFilterPass","isFilterActive"]),nD=(()=>{class e extends ET{setViewContainerRef(i,s){this.viewContainerRef=i,this.angularFrameworkOverrides=s}createWrapper(i){let s=this.angularFrameworkOverrides,n=this;n.compShards??=gX(this.viewContainerRef);class o extends Lb{init(p){s.runInsideAngular(()=>{super.init(p),this._componentRef.changeDetectorRef.detectChanges()})}createComponent(){return n.createComponent(i)}hasMethod(p){return l.getFrameworkComponentInstance()[p]!=null}callMethod(p,y){let C=this.getFrameworkComponentInstance(),S=C[p];return fX.has(p)?S.apply(C,y):s.runInsideAngular(()=>S.apply(C,y))}addMethod(p,y){l[p]=y}}let l=new o;return l}createComponent(i){return Ab=(Ab+1)%aD,this.compShards.get(Ab).instance.vcr.createComponent(i)}static{this.\u0275fac=(()=>{let i;return function(n){return(i||(i=$l(e)))(n||e)}})()}static{this.\u0275prov=Zo({token:e,factory:e.\u0275fac})}}return e})(),Lb=class{init(t){this._params=t,this._componentRef=this.createComponent(),this._agAwareComponent=this._componentRef.instance,this._frameworkComponentInstance=this._componentRef.instance,this._eGui=this._componentRef.location.nativeElement,yo(this._eGui),this._agAwareComponent.agInit(this._params)}getGui(){return this._eGui}getRootElement(){return this._eGui.firstChild}destroy(){this._frameworkComponentInstance&&typeof this._frameworkComponentInstance.destroy=="function"&&this._frameworkComponentInstance.destroy(),this._componentRef?.destroy()}getFrameworkComponentInstance(){return this._frameworkComponentInstance}},Tv=class{constructor(t){this.frameworkOverrides=t,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(t,i){let{frameworkOverrides:s,wrappedListeners:n}=this,o=i;if(s.shouldWrapOutgoing){o=d=>{s.wrapOutgoing(()=>i(d))};let l=n.get(t);l||(l=new Map,n.set(t,l)),l.set(i,o)}return o}wrapGlobal(t){let{frameworkOverrides:i,wrappedGlobalListeners:s}=this,n=t;return i.shouldWrapOutgoing&&(n=(o,l)=>{i.wrapOutgoing(()=>t(o,l))},s.set(t,n)),n}unwrap(t,i){let{wrappedListeners:s}=this,n=s.get(t);if(n){let o=n.get(i);if(o)return n.delete(i),n.size===0&&s.delete(t),o}return i}unwrapGlobal(t){let{wrappedGlobalListeners:i}=this,s=i.get(t);return s?(i.delete(t),s):t}},rD=(()=>{class e extends yb{constructor(i){super("angular"),this._ngZone=i,this.batchFrameworkComps=!0,this.isRunningWithinTestZone=!1,this.wrapIncoming=(s,n)=>this.runOutside(s,n),this.wrapOutgoing=s=>this.runInsideAngular(s),this.isRunningWithinTestZone=window?.AG_GRID_UNDER_TEST??!!window?.Zone?.AsyncTestZoneSpec,this._ngZone?this.isRunningWithinTestZone?this.runOutside=(s,n)=>n==="resize-observer"||n==="popupPositioning"?this._ngZone.runOutsideAngular(s):s():this.runOutside=s=>this._ngZone.runOutsideAngular(s):this.runOutside=s=>s()}get shouldWrapOutgoing(){return this._ngZone&&$n.isInAngularZone()}createLocalEventListenerWrapper(i,s){if(this.shouldWrapOutgoing)return i??(s.setFrameworkOverrides(this),new Tv(this))}createGlobalEventListenerWrapper(){return new Tv(this)}isFrameworkComponent(i){if(!i)return!1;let s=i.prototype;return s&&"agInit"in s}runInsideAngular(i){return!this._ngZone||$n.isInAngularZone()?i():this._ngZone.run(i)}runOutsideAngular(i,s){return this.runOutside(i,s)}static{this.\u0275fac=function(s){return new(s||e)(y_($n))}}static{this.\u0275prov=Zo({token:e,factory:e.\u0275fac})}}return e})(),lD=(()=>{class e{constructor(i,s,n,o){this._viewContainerRef=s,this._angularFrameworkOverrides=n,this._frameworkCompWrapper=o,this._initialised=!1,this._destroyed=!1,this._holdEvents=!0,this._fullyReady=new Promise(l=>{this._resolveFullyReady=l}),this.statusBar=void 0,this.sideBar=void 0,this.suppressContextMenu=void 0,this.preventDefaultOnContextMenu=void 0,this.allowContextMenuWithControlKey=void 0,this.columnMenu=void 0,this.suppressMenuHide=void 0,this.enableBrowserTooltips=void 0,this.tooltipTrigger=void 0,this.tooltipShowDelay=void 0,this.tooltipHideDelay=void 0,this.tooltipMouseTrack=void 0,this.tooltipShowMode=void 0,this.tooltipInteraction=void 0,this.popupParent=void 0,this.copyHeadersToClipboard=void 0,this.copyGroupHeadersToClipboard=void 0,this.clipboardDelimiter=void 0,this.suppressCopyRowsToClipboard=void 0,this.suppressCopySingleCellRanges=void 0,this.suppressLastEmptyLineOnPaste=void 0,this.suppressClipboardPaste=void 0,this.suppressClipboardApi=void 0,this.suppressCutToClipboard=void 0,this.columnDefs=void 0,this.defaultColDef=void 0,this.defaultColGroupDef=void 0,this.columnTypes=void 0,this.dataTypeDefinitions=void 0,this.maintainColumnOrder=void 0,this.enableStrictPivotColumnOrder=void 0,this.suppressFieldDotNotation=void 0,this.headerHeight=void 0,this.groupHeaderHeight=void 0,this.floatingFiltersHeight=void 0,this.pivotHeaderHeight=void 0,this.pivotGroupHeaderHeight=void 0,this.hidePaddedHeaderRows=void 0,this.allowDragFromColumnsToolPanel=void 0,this.suppressMovableColumns=void 0,this.suppressColumnMoveAnimation=void 0,this.suppressMoveWhenColumnDragging=void 0,this.suppressDragLeaveHidesColumns=void 0,this.suppressGroupChangesColumnVisibility=void 0,this.suppressMakeColumnVisibleAfterUnGroup=void 0,this.suppressRowGroupHidesColumns=void 0,this.colResizeDefault=void 0,this.suppressAutoSize=void 0,this.autoSizePadding=void 0,this.skipHeaderOnAutoSize=void 0,this.autoSizeStrategy=void 0,this.components=void 0,this.editType=void 0,this.suppressStartEditOnTab=void 0,this.getFullRowEditValidationErrors=void 0,this.invalidEditValueMode=void 0,this.singleClickEdit=void 0,this.suppressClickEdit=void 0,this.readOnlyEdit=void 0,this.stopEditingWhenCellsLoseFocus=void 0,this.enterNavigatesVertically=void 0,this.enterNavigatesVerticallyAfterEdit=void 0,this.enableCellEditingOnBackspace=void 0,this.undoRedoCellEditing=void 0,this.undoRedoCellEditingLimit=void 0,this.defaultCsvExportParams=void 0,this.suppressCsvExport=void 0,this.defaultExcelExportParams=void 0,this.suppressExcelExport=void 0,this.excelStyles=void 0,this.findSearchValue=void 0,this.findOptions=void 0,this.quickFilterText=void 0,this.cacheQuickFilter=void 0,this.includeHiddenColumnsInQuickFilter=void 0,this.quickFilterParser=void 0,this.quickFilterMatcher=void 0,this.applyQuickFilterBeforePivotOrAgg=void 0,this.excludeChildrenWhenTreeDataFiltering=void 0,this.enableAdvancedFilter=void 0,this.alwaysPassFilter=void 0,this.includeHiddenColumnsInAdvancedFilter=void 0,this.advancedFilterParent=void 0,this.advancedFilterBuilderParams=void 0,this.advancedFilterParams=void 0,this.suppressAdvancedFilterEval=void 0,this.suppressSetFilterByDefault=void 0,this.enableFilterHandlers=void 0,this.filterHandlers=void 0,this.enableCharts=void 0,this.chartThemes=void 0,this.customChartThemes=void 0,this.chartThemeOverrides=void 0,this.chartToolPanelsDef=void 0,this.chartMenuItems=void 0,this.loadingCellRenderer=void 0,this.loadingCellRendererParams=void 0,this.loadingCellRendererSelector=void 0,this.localeText=void 0,this.masterDetail=void 0,this.keepDetailRows=void 0,this.keepDetailRowsCount=void 0,this.detailCellRenderer=void 0,this.detailCellRendererParams=void 0,this.detailRowHeight=void 0,this.detailRowAutoHeight=void 0,this.context=void 0,this.alignedGrids=void 0,this.tabIndex=void 0,this.rowBuffer=void 0,this.valueCache=void 0,this.valueCacheNeverExpires=void 0,this.enableCellExpressions=void 0,this.suppressTouch=void 0,this.suppressFocusAfterRefresh=void 0,this.suppressBrowserResizeObserver=void 0,this.suppressPropertyNamesCheck=void 0,this.suppressChangeDetection=void 0,this.debug=void 0,this.loading=void 0,this.overlayLoadingTemplate=void 0,this.loadingOverlayComponent=void 0,this.loadingOverlayComponentParams=void 0,this.suppressLoadingOverlay=void 0,this.overlayNoRowsTemplate=void 0,this.noRowsOverlayComponent=void 0,this.noRowsOverlayComponentParams=void 0,this.suppressNoRowsOverlay=void 0,this.pagination=void 0,this.paginationPageSize=void 0,this.paginationPageSizeSelector=void 0,this.paginationAutoPageSize=void 0,this.paginateChildRows=void 0,this.suppressPaginationPanel=void 0,this.pivotMode=void 0,this.pivotPanelShow=void 0,this.pivotMaxGeneratedColumns=void 0,this.pivotDefaultExpanded=void 0,this.pivotColumnGroupTotals=void 0,this.pivotRowTotals=void 0,this.pivotSuppressAutoColumn=void 0,this.suppressExpandablePivotGroups=void 0,this.functionsReadOnly=void 0,this.aggFuncs=void 0,this.suppressAggFuncInHeader=void 0,this.alwaysAggregateAtRootLevel=void 0,this.aggregateOnlyChangedColumns=void 0,this.suppressAggFilteredOnly=void 0,this.removePivotHeaderRowWhenSingleValueColumn=void 0,this.animateRows=void 0,this.cellFlashDuration=void 0,this.cellFadeDuration=void 0,this.allowShowChangeAfterFilter=void 0,this.domLayout=void 0,this.ensureDomOrder=void 0,this.enableCellSpan=void 0,this.enableRtl=void 0,this.suppressColumnVirtualisation=void 0,this.suppressMaxRenderedRowRestriction=void 0,this.suppressRowVirtualisation=void 0,this.rowDragManaged=void 0,this.rowDragInsertDelay=void 0,this.suppressRowDrag=void 0,this.suppressMoveWhenRowDragging=void 0,this.rowDragEntireRow=void 0,this.rowDragMultiRow=void 0,this.rowDragText=void 0,this.dragAndDropImageComponent=void 0,this.dragAndDropImageComponentParams=void 0,this.fullWidthCellRenderer=void 0,this.fullWidthCellRendererParams=void 0,this.embedFullWidthRows=void 0,this.groupDisplayType=void 0,this.groupDefaultExpanded=void 0,this.autoGroupColumnDef=void 0,this.groupMaintainOrder=void 0,this.groupSelectsChildren=void 0,this.groupLockGroupColumns=void 0,this.groupAggFiltering=void 0,this.groupTotalRow=void 0,this.grandTotalRow=void 0,this.suppressStickyTotalRow=void 0,this.groupSuppressBlankHeader=void 0,this.groupSelectsFiltered=void 0,this.showOpenedGroup=void 0,this.groupHideParentOfSingleChild=void 0,this.groupRemoveSingleChildren=void 0,this.groupRemoveLowestSingleChildren=void 0,this.groupHideOpenParents=void 0,this.groupAllowUnbalanced=void 0,this.rowGroupPanelShow=void 0,this.groupRowRenderer=void 0,this.groupRowRendererParams=void 0,this.treeData=void 0,this.treeDataChildrenField=void 0,this.treeDataParentIdField=void 0,this.rowGroupPanelSuppressSort=void 0,this.suppressGroupRowsSticky=void 0,this.groupHierarchyConfig=void 0,this.pinnedTopRowData=void 0,this.pinnedBottomRowData=void 0,this.enableRowPinning=void 0,this.isRowPinnable=void 0,this.isRowPinned=void 0,this.rowModelType=void 0,this.rowData=void 0,this.asyncTransactionWaitMillis=void 0,this.suppressModelUpdateAfterUpdateTransaction=void 0,this.datasource=void 0,this.cacheOverflowSize=void 0,this.infiniteInitialRowCount=void 0,this.serverSideInitialRowCount=void 0,this.suppressServerSideFullWidthLoadingRow=void 0,this.cacheBlockSize=void 0,this.maxBlocksInCache=void 0,this.maxConcurrentDatasourceRequests=void 0,this.blockLoadDebounceMillis=void 0,this.purgeClosedRowNodes=void 0,this.serverSideDatasource=void 0,this.serverSideSortAllLevels=void 0,this.serverSideEnableClientSideSort=void 0,this.serverSideOnlyRefreshFilteredGroups=void 0,this.serverSidePivotResultFieldSeparator=void 0,this.viewportDatasource=void 0,this.viewportRowModelPageSize=void 0,this.viewportRowModelBufferSize=void 0,this.alwaysShowHorizontalScroll=void 0,this.alwaysShowVerticalScroll=void 0,this.debounceVerticalScrollbar=void 0,this.suppressHorizontalScroll=void 0,this.suppressScrollOnNewData=void 0,this.suppressScrollWhenPopupsAreOpen=void 0,this.suppressAnimationFrame=void 0,this.suppressMiddleClickScrolls=void 0,this.suppressPreventDefaultOnMouseWheel=void 0,this.scrollbarWidth=void 0,this.rowSelection=void 0,this.cellSelection=void 0,this.rowMultiSelectWithClick=void 0,this.suppressRowDeselection=void 0,this.suppressRowClickSelection=void 0,this.suppressCellFocus=void 0,this.suppressHeaderFocus=void 0,this.selectionColumnDef=void 0,this.rowNumbers=void 0,this.suppressMultiRangeSelection=void 0,this.enableCellTextSelection=void 0,this.enableRangeSelection=void 0,this.enableRangeHandle=void 0,this.enableFillHandle=void 0,this.fillHandleDirection=void 0,this.suppressClearOnFillReduction=void 0,this.sortingOrder=void 0,this.accentedSort=void 0,this.unSortIcon=void 0,this.suppressMultiSort=void 0,this.alwaysMultiSort=void 0,this.multiSortKey=void 0,this.suppressMaintainUnsortedOrder=void 0,this.icons=void 0,this.rowHeight=void 0,this.rowStyle=void 0,this.rowClass=void 0,this.rowClassRules=void 0,this.suppressRowHoverHighlight=void 0,this.suppressRowTransform=void 0,this.columnHoverHighlight=void 0,this.gridId=void 0,this.deltaSort=void 0,this.treeDataDisplayType=void 0,this.enableGroupEdit=void 0,this.initialState=void 0,this.theme=void 0,this.loadThemeGoogleFonts=void 0,this.themeCssLayer=void 0,this.styleNonce=void 0,this.themeStyleContainer=void 0,this.getContextMenuItems=void 0,this.getMainMenuItems=void 0,this.postProcessPopup=void 0,this.processUnpinnedColumns=void 0,this.processCellForClipboard=void 0,this.processHeaderForClipboard=void 0,this.processGroupHeaderForClipboard=void 0,this.processCellFromClipboard=void 0,this.sendToClipboard=void 0,this.processDataFromClipboard=void 0,this.isExternalFilterPresent=void 0,this.doesExternalFilterPass=void 0,this.getChartToolbarItems=void 0,this.createChartContainer=void 0,this.focusGridInnerElement=void 0,this.navigateToNextHeader=void 0,this.tabToNextHeader=void 0,this.navigateToNextCell=void 0,this.tabToNextCell=void 0,this.getLocaleText=void 0,this.getDocument=void 0,this.paginationNumberFormatter=void 0,this.getGroupRowAgg=void 0,this.isGroupOpenByDefault=void 0,this.ssrmExpandAllAffectsAllRows=void 0,this.initialGroupOrderComparator=void 0,this.processPivotResultColDef=void 0,this.processPivotResultColGroupDef=void 0,this.getDataPath=void 0,this.getChildCount=void 0,this.getServerSideGroupLevelParams=void 0,this.isServerSideGroupOpenByDefault=void 0,this.isApplyServerSideTransaction=void 0,this.isServerSideGroup=void 0,this.getServerSideGroupKey=void 0,this.getBusinessKeyForNode=void 0,this.getRowId=void 0,this.resetRowDataOnUpdate=void 0,this.processRowPostCreate=void 0,this.isRowSelectable=void 0,this.isRowMaster=void 0,this.fillOperation=void 0,this.postSortRows=void 0,this.getRowStyle=void 0,this.getRowClass=void 0,this.getRowHeight=void 0,this.isFullWidthRow=void 0,this.isRowValidDropPosition=void 0,this.toolPanelVisibleChanged=new We,this.toolPanelSizeChanged=new We,this.columnMenuVisibleChanged=new We,this.contextMenuVisibleChanged=new We,this.cutStart=new We,this.cutEnd=new We,this.pasteStart=new We,this.pasteEnd=new We,this.columnVisible=new We,this.columnPinned=new We,this.columnResized=new We,this.columnMoved=new We,this.columnValueChanged=new We,this.columnPivotModeChanged=new We,this.columnPivotChanged=new We,this.columnGroupOpened=new We,this.newColumnsLoaded=new We,this.gridColumnsChanged=new We,this.displayedColumnsChanged=new We,this.virtualColumnsChanged=new We,this.columnEverythingChanged=new We,this.columnsReset=new We,this.columnHeaderMouseOver=new We,this.columnHeaderMouseLeave=new We,this.columnHeaderClicked=new We,this.columnHeaderContextMenu=new We,this.componentStateChanged=new We,this.cellValueChanged=new We,this.cellEditRequest=new We,this.rowValueChanged=new We,this.cellEditingStarted=new We,this.cellEditingStopped=new We,this.rowEditingStarted=new We,this.rowEditingStopped=new We,this.bulkEditingStarted=new We,this.bulkEditingStopped=new We,this.batchEditingStarted=new We,this.batchEditingStopped=new We,this.undoStarted=new We,this.undoEnded=new We,this.redoStarted=new We,this.redoEnded=new We,this.cellSelectionDeleteStart=new We,this.cellSelectionDeleteEnd=new We,this.rangeDeleteStart=new We,this.rangeDeleteEnd=new We,this.fillStart=new We,this.fillEnd=new We,this.filterOpened=new We,this.filterChanged=new We,this.filterModified=new We,this.filterUiChanged=new We,this.floatingFilterUiChanged=new We,this.advancedFilterBuilderVisibleChanged=new We,this.findChanged=new We,this.chartCreated=new We,this.chartRangeSelectionChanged=new We,this.chartOptionsChanged=new We,this.chartDestroyed=new We,this.cellKeyDown=new We,this.gridReady=new We,this.firstDataRendered=new We,this.gridSizeChanged=new We,this.modelUpdated=new We,this.virtualRowRemoved=new We,this.viewportChanged=new We,this.bodyScroll=new We,this.bodyScrollEnd=new We,this.dragStarted=new We,this.dragStopped=new We,this.dragCancelled=new We,this.stateUpdated=new We,this.paginationChanged=new We,this.rowDragEnter=new We,this.rowDragMove=new We,this.rowDragLeave=new We,this.rowDragEnd=new We,this.rowDragCancel=new We,this.rowResizeStarted=new We,this.rowResizeEnded=new We,this.columnRowGroupChanged=new We,this.rowGroupOpened=new We,this.expandOrCollapseAll=new We,this.pivotMaxColumnsExceeded=new We,this.pinnedRowDataChanged=new We,this.pinnedRowsChanged=new We,this.rowDataUpdated=new We,this.asyncTransactionsFlushed=new We,this.storeRefreshed=new We,this.headerFocused=new We,this.cellClicked=new We,this.cellDoubleClicked=new We,this.cellFocused=new We,this.cellMouseOver=new We,this.cellMouseOut=new We,this.cellMouseDown=new We,this.rowClicked=new We,this.rowDoubleClicked=new We,this.rowSelected=new We,this.selectionChanged=new We,this.cellContextMenu=new We,this.rangeSelectionChanged=new We,this.cellSelectionChanged=new We,this.tooltipShow=new We,this.tooltipHide=new We,this.sortChanged=new We,this._nativeElement=i.nativeElement,this._fullyReady.then(()=>{this._holdEvents=!1})}ngAfterViewInit(){this._angularFrameworkOverrides.runOutsideAngular(()=>{this._frameworkCompWrapper.setViewContainerRef(this._viewContainerRef,this._angularFrameworkOverrides);let i=Object.keys(this).filter(d=>!(d.startsWith("_")||d=="gridOptions"||d=="modules"||this[d]instanceof We)),s={};i.forEach(d=>{let p=vX(d,this[d]);s[d]=p});let n=kP(this.gridOptions,s,i),o={globalListener:this.globalListener.bind(this),frameworkOverrides:this._angularFrameworkOverrides,providedBeanInstances:{frameworkCompWrapper:this._frameworkCompWrapper},modules:this.modules||[],setThemeOnGridDiv:!0},l=RT(this._nativeElement,n,o);l&&(this.api=l),this._initialised=!0,this._resolveFullyReady()})}ngOnChanges(i){this._initialised&&this._angularFrameworkOverrides.runOutsideAngular(()=>{let s={};for(let n of Object.keys(i)){let o=i[n];s[n]=o.currentValue}AP(s,this.api)})}ngOnDestroy(){this._initialised&&(this._destroyed=!0,this.api?.destroy())}isEmitterUsed(i){let n=this[i],o=n?.observed??n?.observers?.length>0,l=`on${i.charAt(0).toUpperCase()}${i.substring(1)}`,d=!!this.gridOptions&&!!this.gridOptions[l];return o||d}globalListener(i,s){if(this._destroyed)return;let n=this[i];if(n&&this.isEmitterUsed(i)){let o=()=>this._angularFrameworkOverrides.runInsideAngular(()=>n.emit(s));this._holdEvents?this._fullyReady.then(()=>o()):o()}}static{this.\u0275fac=function(s){return new(s||e)(yn(ql),yn(Rf),yn(rD),yn(nD))}}static{this.\u0275cmp=oo({type:e,selectors:[["ag-grid-angular"]],inputs:{gridOptions:"gridOptions",modules:"modules",statusBar:"statusBar",sideBar:"sideBar",suppressContextMenu:[2,"suppressContextMenu","suppressContextMenu",Le],preventDefaultOnContextMenu:[2,"preventDefaultOnContextMenu","preventDefaultOnContextMenu",Le],allowContextMenuWithControlKey:[2,"allowContextMenuWithControlKey","allowContextMenuWithControlKey",Le],columnMenu:"columnMenu",suppressMenuHide:[2,"suppressMenuHide","suppressMenuHide",Le],enableBrowserTooltips:[2,"enableBrowserTooltips","enableBrowserTooltips",Le],tooltipTrigger:"tooltipTrigger",tooltipShowDelay:"tooltipShowDelay",tooltipHideDelay:"tooltipHideDelay",tooltipMouseTrack:[2,"tooltipMouseTrack","tooltipMouseTrack",Le],tooltipShowMode:"tooltipShowMode",tooltipInteraction:[2,"tooltipInteraction","tooltipInteraction",Le],popupParent:"popupParent",copyHeadersToClipboard:[2,"copyHeadersToClipboard","copyHeadersToClipboard",Le],copyGroupHeadersToClipboard:[2,"copyGroupHeadersToClipboard","copyGroupHeadersToClipboard",Le],clipboardDelimiter:"clipboardDelimiter",suppressCopyRowsToClipboard:[2,"suppressCopyRowsToClipboard","suppressCopyRowsToClipboard",Le],suppressCopySingleCellRanges:[2,"suppressCopySingleCellRanges","suppressCopySingleCellRanges",Le],suppressLastEmptyLineOnPaste:[2,"suppressLastEmptyLineOnPaste","suppressLastEmptyLineOnPaste",Le],suppressClipboardPaste:[2,"suppressClipboardPaste","suppressClipboardPaste",Le],suppressClipboardApi:[2,"suppressClipboardApi","suppressClipboardApi",Le],suppressCutToClipboard:[2,"suppressCutToClipboard","suppressCutToClipboard",Le],columnDefs:"columnDefs",defaultColDef:"defaultColDef",defaultColGroupDef:"defaultColGroupDef",columnTypes:"columnTypes",dataTypeDefinitions:"dataTypeDefinitions",maintainColumnOrder:[2,"maintainColumnOrder","maintainColumnOrder",Le],enableStrictPivotColumnOrder:[2,"enableStrictPivotColumnOrder","enableStrictPivotColumnOrder",Le],suppressFieldDotNotation:[2,"suppressFieldDotNotation","suppressFieldDotNotation",Le],headerHeight:"headerHeight",groupHeaderHeight:"groupHeaderHeight",floatingFiltersHeight:"floatingFiltersHeight",pivotHeaderHeight:"pivotHeaderHeight",pivotGroupHeaderHeight:"pivotGroupHeaderHeight",hidePaddedHeaderRows:[2,"hidePaddedHeaderRows","hidePaddedHeaderRows",Le],allowDragFromColumnsToolPanel:[2,"allowDragFromColumnsToolPanel","allowDragFromColumnsToolPanel",Le],suppressMovableColumns:[2,"suppressMovableColumns","suppressMovableColumns",Le],suppressColumnMoveAnimation:[2,"suppressColumnMoveAnimation","suppressColumnMoveAnimation",Le],suppressMoveWhenColumnDragging:[2,"suppressMoveWhenColumnDragging","suppressMoveWhenColumnDragging",Le],suppressDragLeaveHidesColumns:[2,"suppressDragLeaveHidesColumns","suppressDragLeaveHidesColumns",Le],suppressGroupChangesColumnVisibility:"suppressGroupChangesColumnVisibility",suppressMakeColumnVisibleAfterUnGroup:[2,"suppressMakeColumnVisibleAfterUnGroup","suppressMakeColumnVisibleAfterUnGroup",Le],suppressRowGroupHidesColumns:[2,"suppressRowGroupHidesColumns","suppressRowGroupHidesColumns",Le],colResizeDefault:"colResizeDefault",suppressAutoSize:[2,"suppressAutoSize","suppressAutoSize",Le],autoSizePadding:"autoSizePadding",skipHeaderOnAutoSize:[2,"skipHeaderOnAutoSize","skipHeaderOnAutoSize",Le],autoSizeStrategy:"autoSizeStrategy",components:"components",editType:"editType",suppressStartEditOnTab:[2,"suppressStartEditOnTab","suppressStartEditOnTab",Le],getFullRowEditValidationErrors:"getFullRowEditValidationErrors",invalidEditValueMode:"invalidEditValueMode",singleClickEdit:[2,"singleClickEdit","singleClickEdit",Le],suppressClickEdit:[2,"suppressClickEdit","suppressClickEdit",Le],readOnlyEdit:[2,"readOnlyEdit","readOnlyEdit",Le],stopEditingWhenCellsLoseFocus:[2,"stopEditingWhenCellsLoseFocus","stopEditingWhenCellsLoseFocus",Le],enterNavigatesVertically:[2,"enterNavigatesVertically","enterNavigatesVertically",Le],enterNavigatesVerticallyAfterEdit:[2,"enterNavigatesVerticallyAfterEdit","enterNavigatesVerticallyAfterEdit",Le],enableCellEditingOnBackspace:[2,"enableCellEditingOnBackspace","enableCellEditingOnBackspace",Le],undoRedoCellEditing:[2,"undoRedoCellEditing","undoRedoCellEditing",Le],undoRedoCellEditingLimit:"undoRedoCellEditingLimit",defaultCsvExportParams:"defaultCsvExportParams",suppressCsvExport:[2,"suppressCsvExport","suppressCsvExport",Le],defaultExcelExportParams:"defaultExcelExportParams",suppressExcelExport:[2,"suppressExcelExport","suppressExcelExport",Le],excelStyles:"excelStyles",findSearchValue:"findSearchValue",findOptions:"findOptions",quickFilterText:"quickFilterText",cacheQuickFilter:[2,"cacheQuickFilter","cacheQuickFilter",Le],includeHiddenColumnsInQuickFilter:[2,"includeHiddenColumnsInQuickFilter","includeHiddenColumnsInQuickFilter",Le],quickFilterParser:"quickFilterParser",quickFilterMatcher:"quickFilterMatcher",applyQuickFilterBeforePivotOrAgg:[2,"applyQuickFilterBeforePivotOrAgg","applyQuickFilterBeforePivotOrAgg",Le],excludeChildrenWhenTreeDataFiltering:[2,"excludeChildrenWhenTreeDataFiltering","excludeChildrenWhenTreeDataFiltering",Le],enableAdvancedFilter:[2,"enableAdvancedFilter","enableAdvancedFilter",Le],alwaysPassFilter:"alwaysPassFilter",includeHiddenColumnsInAdvancedFilter:[2,"includeHiddenColumnsInAdvancedFilter","includeHiddenColumnsInAdvancedFilter",Le],advancedFilterParent:"advancedFilterParent",advancedFilterBuilderParams:"advancedFilterBuilderParams",advancedFilterParams:"advancedFilterParams",suppressAdvancedFilterEval:[2,"suppressAdvancedFilterEval","suppressAdvancedFilterEval",Le],suppressSetFilterByDefault:[2,"suppressSetFilterByDefault","suppressSetFilterByDefault",Le],enableFilterHandlers:[2,"enableFilterHandlers","enableFilterHandlers",Le],filterHandlers:"filterHandlers",enableCharts:[2,"enableCharts","enableCharts",Le],chartThemes:"chartThemes",customChartThemes:"customChartThemes",chartThemeOverrides:"chartThemeOverrides",chartToolPanelsDef:"chartToolPanelsDef",chartMenuItems:"chartMenuItems",loadingCellRenderer:"loadingCellRenderer",loadingCellRendererParams:"loadingCellRendererParams",loadingCellRendererSelector:"loadingCellRendererSelector",localeText:"localeText",masterDetail:[2,"masterDetail","masterDetail",Le],keepDetailRows:[2,"keepDetailRows","keepDetailRows",Le],keepDetailRowsCount:"keepDetailRowsCount",detailCellRenderer:"detailCellRenderer",detailCellRendererParams:"detailCellRendererParams",detailRowHeight:"detailRowHeight",detailRowAutoHeight:[2,"detailRowAutoHeight","detailRowAutoHeight",Le],context:"context",alignedGrids:"alignedGrids",tabIndex:"tabIndex",rowBuffer:"rowBuffer",valueCache:[2,"valueCache","valueCache",Le],valueCacheNeverExpires:[2,"valueCacheNeverExpires","valueCacheNeverExpires",Le],enableCellExpressions:[2,"enableCellExpressions","enableCellExpressions",Le],suppressTouch:[2,"suppressTouch","suppressTouch",Le],suppressFocusAfterRefresh:[2,"suppressFocusAfterRefresh","suppressFocusAfterRefresh",Le],suppressBrowserResizeObserver:[2,"suppressBrowserResizeObserver","suppressBrowserResizeObserver",Le],suppressPropertyNamesCheck:[2,"suppressPropertyNamesCheck","suppressPropertyNamesCheck",Le],suppressChangeDetection:[2,"suppressChangeDetection","suppressChangeDetection",Le],debug:[2,"debug","debug",Le],loading:[2,"loading","loading",Le],overlayLoadingTemplate:"overlayLoadingTemplate",loadingOverlayComponent:"loadingOverlayComponent",loadingOverlayComponentParams:"loadingOverlayComponentParams",suppressLoadingOverlay:[2,"suppressLoadingOverlay","suppressLoadingOverlay",Le],overlayNoRowsTemplate:"overlayNoRowsTemplate",noRowsOverlayComponent:"noRowsOverlayComponent",noRowsOverlayComponentParams:"noRowsOverlayComponentParams",suppressNoRowsOverlay:[2,"suppressNoRowsOverlay","suppressNoRowsOverlay",Le],pagination:[2,"pagination","pagination",Le],paginationPageSize:"paginationPageSize",paginationPageSizeSelector:"paginationPageSizeSelector",paginationAutoPageSize:[2,"paginationAutoPageSize","paginationAutoPageSize",Le],paginateChildRows:[2,"paginateChildRows","paginateChildRows",Le],suppressPaginationPanel:[2,"suppressPaginationPanel","suppressPaginationPanel",Le],pivotMode:[2,"pivotMode","pivotMode",Le],pivotPanelShow:"pivotPanelShow",pivotMaxGeneratedColumns:"pivotMaxGeneratedColumns",pivotDefaultExpanded:"pivotDefaultExpanded",pivotColumnGroupTotals:"pivotColumnGroupTotals",pivotRowTotals:"pivotRowTotals",pivotSuppressAutoColumn:[2,"pivotSuppressAutoColumn","pivotSuppressAutoColumn",Le],suppressExpandablePivotGroups:[2,"suppressExpandablePivotGroups","suppressExpandablePivotGroups",Le],functionsReadOnly:[2,"functionsReadOnly","functionsReadOnly",Le],aggFuncs:"aggFuncs",suppressAggFuncInHeader:[2,"suppressAggFuncInHeader","suppressAggFuncInHeader",Le],alwaysAggregateAtRootLevel:[2,"alwaysAggregateAtRootLevel","alwaysAggregateAtRootLevel",Le],aggregateOnlyChangedColumns:[2,"aggregateOnlyChangedColumns","aggregateOnlyChangedColumns",Le],suppressAggFilteredOnly:[2,"suppressAggFilteredOnly","suppressAggFilteredOnly",Le],removePivotHeaderRowWhenSingleValueColumn:[2,"removePivotHeaderRowWhenSingleValueColumn","removePivotHeaderRowWhenSingleValueColumn",Le],animateRows:[2,"animateRows","animateRows",Le],cellFlashDuration:"cellFlashDuration",cellFadeDuration:"cellFadeDuration",allowShowChangeAfterFilter:[2,"allowShowChangeAfterFilter","allowShowChangeAfterFilter",Le],domLayout:"domLayout",ensureDomOrder:[2,"ensureDomOrder","ensureDomOrder",Le],enableCellSpan:[2,"enableCellSpan","enableCellSpan",Le],enableRtl:[2,"enableRtl","enableRtl",Le],suppressColumnVirtualisation:[2,"suppressColumnVirtualisation","suppressColumnVirtualisation",Le],suppressMaxRenderedRowRestriction:[2,"suppressMaxRenderedRowRestriction","suppressMaxRenderedRowRestriction",Le],suppressRowVirtualisation:[2,"suppressRowVirtualisation","suppressRowVirtualisation",Le],rowDragManaged:[2,"rowDragManaged","rowDragManaged",Le],rowDragInsertDelay:"rowDragInsertDelay",suppressRowDrag:[2,"suppressRowDrag","suppressRowDrag",Le],suppressMoveWhenRowDragging:[2,"suppressMoveWhenRowDragging","suppressMoveWhenRowDragging",Le],rowDragEntireRow:[2,"rowDragEntireRow","rowDragEntireRow",Le],rowDragMultiRow:[2,"rowDragMultiRow","rowDragMultiRow",Le],rowDragText:"rowDragText",dragAndDropImageComponent:"dragAndDropImageComponent",dragAndDropImageComponentParams:"dragAndDropImageComponentParams",fullWidthCellRenderer:"fullWidthCellRenderer",fullWidthCellRendererParams:"fullWidthCellRendererParams",embedFullWidthRows:[2,"embedFullWidthRows","embedFullWidthRows",Le],groupDisplayType:"groupDisplayType",groupDefaultExpanded:"groupDefaultExpanded",autoGroupColumnDef:"autoGroupColumnDef",groupMaintainOrder:[2,"groupMaintainOrder","groupMaintainOrder",Le],groupSelectsChildren:[2,"groupSelectsChildren","groupSelectsChildren",Le],groupLockGroupColumns:"groupLockGroupColumns",groupAggFiltering:"groupAggFiltering",groupTotalRow:"groupTotalRow",grandTotalRow:"grandTotalRow",suppressStickyTotalRow:"suppressStickyTotalRow",groupSuppressBlankHeader:[2,"groupSuppressBlankHeader","groupSuppressBlankHeader",Le],groupSelectsFiltered:[2,"groupSelectsFiltered","groupSelectsFiltered",Le],showOpenedGroup:[2,"showOpenedGroup","showOpenedGroup",Le],groupHideParentOfSingleChild:"groupHideParentOfSingleChild",groupRemoveSingleChildren:[2,"groupRemoveSingleChildren","groupRemoveSingleChildren",Le],groupRemoveLowestSingleChildren:[2,"groupRemoveLowestSingleChildren","groupRemoveLowestSingleChildren",Le],groupHideOpenParents:[2,"groupHideOpenParents","groupHideOpenParents",Le],groupAllowUnbalanced:[2,"groupAllowUnbalanced","groupAllowUnbalanced",Le],rowGroupPanelShow:"rowGroupPanelShow",groupRowRenderer:"groupRowRenderer",groupRowRendererParams:"groupRowRendererParams",treeData:[2,"treeData","treeData",Le],treeDataChildrenField:"treeDataChildrenField",treeDataParentIdField:"treeDataParentIdField",rowGroupPanelSuppressSort:[2,"rowGroupPanelSuppressSort","rowGroupPanelSuppressSort",Le],suppressGroupRowsSticky:[2,"suppressGroupRowsSticky","suppressGroupRowsSticky",Le],groupHierarchyConfig:"groupHierarchyConfig",pinnedTopRowData:"pinnedTopRowData",pinnedBottomRowData:"pinnedBottomRowData",enableRowPinning:"enableRowPinning",isRowPinnable:"isRowPinnable",isRowPinned:"isRowPinned",rowModelType:"rowModelType",rowData:"rowData",asyncTransactionWaitMillis:"asyncTransactionWaitMillis",suppressModelUpdateAfterUpdateTransaction:[2,"suppressModelUpdateAfterUpdateTransaction","suppressModelUpdateAfterUpdateTransaction",Le],datasource:"datasource",cacheOverflowSize:"cacheOverflowSize",infiniteInitialRowCount:"infiniteInitialRowCount",serverSideInitialRowCount:"serverSideInitialRowCount",suppressServerSideFullWidthLoadingRow:[2,"suppressServerSideFullWidthLoadingRow","suppressServerSideFullWidthLoadingRow",Le],cacheBlockSize:"cacheBlockSize",maxBlocksInCache:"maxBlocksInCache",maxConcurrentDatasourceRequests:"maxConcurrentDatasourceRequests",blockLoadDebounceMillis:"blockLoadDebounceMillis",purgeClosedRowNodes:[2,"purgeClosedRowNodes","purgeClosedRowNodes",Le],serverSideDatasource:"serverSideDatasource",serverSideSortAllLevels:[2,"serverSideSortAllLevels","serverSideSortAllLevels",Le],serverSideEnableClientSideSort:[2,"serverSideEnableClientSideSort","serverSideEnableClientSideSort",Le],serverSideOnlyRefreshFilteredGroups:[2,"serverSideOnlyRefreshFilteredGroups","serverSideOnlyRefreshFilteredGroups",Le],serverSidePivotResultFieldSeparator:"serverSidePivotResultFieldSeparator",viewportDatasource:"viewportDatasource",viewportRowModelPageSize:"viewportRowModelPageSize",viewportRowModelBufferSize:"viewportRowModelBufferSize",alwaysShowHorizontalScroll:[2,"alwaysShowHorizontalScroll","alwaysShowHorizontalScroll",Le],alwaysShowVerticalScroll:[2,"alwaysShowVerticalScroll","alwaysShowVerticalScroll",Le],debounceVerticalScrollbar:[2,"debounceVerticalScrollbar","debounceVerticalScrollbar",Le],suppressHorizontalScroll:[2,"suppressHorizontalScroll","suppressHorizontalScroll",Le],suppressScrollOnNewData:[2,"suppressScrollOnNewData","suppressScrollOnNewData",Le],suppressScrollWhenPopupsAreOpen:[2,"suppressScrollWhenPopupsAreOpen","suppressScrollWhenPopupsAreOpen",Le],suppressAnimationFrame:[2,"suppressAnimationFrame","suppressAnimationFrame",Le],suppressMiddleClickScrolls:[2,"suppressMiddleClickScrolls","suppressMiddleClickScrolls",Le],suppressPreventDefaultOnMouseWheel:[2,"suppressPreventDefaultOnMouseWheel","suppressPreventDefaultOnMouseWheel",Le],scrollbarWidth:"scrollbarWidth",rowSelection:"rowSelection",cellSelection:"cellSelection",rowMultiSelectWithClick:[2,"rowMultiSelectWithClick","rowMultiSelectWithClick",Le],suppressRowDeselection:[2,"suppressRowDeselection","suppressRowDeselection",Le],suppressRowClickSelection:[2,"suppressRowClickSelection","suppressRowClickSelection",Le],suppressCellFocus:[2,"suppressCellFocus","suppressCellFocus",Le],suppressHeaderFocus:[2,"suppressHeaderFocus","suppressHeaderFocus",Le],selectionColumnDef:"selectionColumnDef",rowNumbers:"rowNumbers",suppressMultiRangeSelection:[2,"suppressMultiRangeSelection","suppressMultiRangeSelection",Le],enableCellTextSelection:[2,"enableCellTextSelection","enableCellTextSelection",Le],enableRangeSelection:[2,"enableRangeSelection","enableRangeSelection",Le],enableRangeHandle:[2,"enableRangeHandle","enableRangeHandle",Le],enableFillHandle:[2,"enableFillHandle","enableFillHandle",Le],fillHandleDirection:"fillHandleDirection",suppressClearOnFillReduction:[2,"suppressClearOnFillReduction","suppressClearOnFillReduction",Le],sortingOrder:"sortingOrder",accentedSort:[2,"accentedSort","accentedSort",Le],unSortIcon:[2,"unSortIcon","unSortIcon",Le],suppressMultiSort:[2,"suppressMultiSort","suppressMultiSort",Le],alwaysMultiSort:[2,"alwaysMultiSort","alwaysMultiSort",Le],multiSortKey:"multiSortKey",suppressMaintainUnsortedOrder:[2,"suppressMaintainUnsortedOrder","suppressMaintainUnsortedOrder",Le],icons:"icons",rowHeight:"rowHeight",rowStyle:"rowStyle",rowClass:"rowClass",rowClassRules:"rowClassRules",suppressRowHoverHighlight:[2,"suppressRowHoverHighlight","suppressRowHoverHighlight",Le],suppressRowTransform:[2,"suppressRowTransform","suppressRowTransform",Le],columnHoverHighlight:[2,"columnHoverHighlight","columnHoverHighlight",Le],gridId:"gridId",deltaSort:[2,"deltaSort","deltaSort",Le],treeDataDisplayType:"treeDataDisplayType",enableGroupEdit:[2,"enableGroupEdit","enableGroupEdit",Le],initialState:"initialState",theme:"theme",loadThemeGoogleFonts:[2,"loadThemeGoogleFonts","loadThemeGoogleFonts",Le],themeCssLayer:"themeCssLayer",styleNonce:"styleNonce",themeStyleContainer:"themeStyleContainer",getContextMenuItems:"getContextMenuItems",getMainMenuItems:"getMainMenuItems",postProcessPopup:"postProcessPopup",processUnpinnedColumns:"processUnpinnedColumns",processCellForClipboard:"processCellForClipboard",processHeaderForClipboard:"processHeaderForClipboard",processGroupHeaderForClipboard:"processGroupHeaderForClipboard",processCellFromClipboard:"processCellFromClipboard",sendToClipboard:"sendToClipboard",processDataFromClipboard:"processDataFromClipboard",isExternalFilterPresent:"isExternalFilterPresent",doesExternalFilterPass:"doesExternalFilterPass",getChartToolbarItems:"getChartToolbarItems",createChartContainer:"createChartContainer",focusGridInnerElement:"focusGridInnerElement",navigateToNextHeader:"navigateToNextHeader",tabToNextHeader:"tabToNextHeader",navigateToNextCell:"navigateToNextCell",tabToNextCell:"tabToNextCell",getLocaleText:"getLocaleText",getDocument:"getDocument",paginationNumberFormatter:"paginationNumberFormatter",getGroupRowAgg:"getGroupRowAgg",isGroupOpenByDefault:"isGroupOpenByDefault",ssrmExpandAllAffectsAllRows:"ssrmExpandAllAffectsAllRows",initialGroupOrderComparator:"initialGroupOrderComparator",processPivotResultColDef:"processPivotResultColDef",processPivotResultColGroupDef:"processPivotResultColGroupDef",getDataPath:"getDataPath",getChildCount:"getChildCount",getServerSideGroupLevelParams:"getServerSideGroupLevelParams",isServerSideGroupOpenByDefault:"isServerSideGroupOpenByDefault",isApplyServerSideTransaction:"isApplyServerSideTransaction",isServerSideGroup:"isServerSideGroup",getServerSideGroupKey:"getServerSideGroupKey",getBusinessKeyForNode:"getBusinessKeyForNode",getRowId:"getRowId",resetRowDataOnUpdate:[2,"resetRowDataOnUpdate","resetRowDataOnUpdate",Le],processRowPostCreate:"processRowPostCreate",isRowSelectable:"isRowSelectable",isRowMaster:"isRowMaster",fillOperation:"fillOperation",postSortRows:"postSortRows",getRowStyle:"getRowStyle",getRowClass:"getRowClass",getRowHeight:"getRowHeight",isFullWidthRow:"isFullWidthRow",isRowValidDropPosition:"isRowValidDropPosition"},outputs:{toolPanelVisibleChanged:"toolPanelVisibleChanged",toolPanelSizeChanged:"toolPanelSizeChanged",columnMenuVisibleChanged:"columnMenuVisibleChanged",contextMenuVisibleChanged:"contextMenuVisibleChanged",cutStart:"cutStart",cutEnd:"cutEnd",pasteStart:"pasteStart",pasteEnd:"pasteEnd",columnVisible:"columnVisible",columnPinned:"columnPinned",columnResized:"columnResized",columnMoved:"columnMoved",columnValueChanged:"columnValueChanged",columnPivotModeChanged:"columnPivotModeChanged",columnPivotChanged:"columnPivotChanged",columnGroupOpened:"columnGroupOpened",newColumnsLoaded:"newColumnsLoaded",gridColumnsChanged:"gridColumnsChanged",displayedColumnsChanged:"displayedColumnsChanged",virtualColumnsChanged:"virtualColumnsChanged",columnEverythingChanged:"columnEverythingChanged",columnsReset:"columnsReset",columnHeaderMouseOver:"columnHeaderMouseOver",columnHeaderMouseLeave:"columnHeaderMouseLeave",columnHeaderClicked:"columnHeaderClicked",columnHeaderContextMenu:"columnHeaderContextMenu",componentStateChanged:"componentStateChanged",cellValueChanged:"cellValueChanged",cellEditRequest:"cellEditRequest",rowValueChanged:"rowValueChanged",cellEditingStarted:"cellEditingStarted",cellEditingStopped:"cellEditingStopped",rowEditingStarted:"rowEditingStarted",rowEditingStopped:"rowEditingStopped",bulkEditingStarted:"bulkEditingStarted",bulkEditingStopped:"bulkEditingStopped",batchEditingStarted:"batchEditingStarted",batchEditingStopped:"batchEditingStopped",undoStarted:"undoStarted",undoEnded:"undoEnded",redoStarted:"redoStarted",redoEnded:"redoEnded",cellSelectionDeleteStart:"cellSelectionDeleteStart",cellSelectionDeleteEnd:"cellSelectionDeleteEnd",rangeDeleteStart:"rangeDeleteStart",rangeDeleteEnd:"rangeDeleteEnd",fillStart:"fillStart",fillEnd:"fillEnd",filterOpened:"filterOpened",filterChanged:"filterChanged",filterModified:"filterModified",filterUiChanged:"filterUiChanged",floatingFilterUiChanged:"floatingFilterUiChanged",advancedFilterBuilderVisibleChanged:"advancedFilterBuilderVisibleChanged",findChanged:"findChanged",chartCreated:"chartCreated",chartRangeSelectionChanged:"chartRangeSelectionChanged",chartOptionsChanged:"chartOptionsChanged",chartDestroyed:"chartDestroyed",cellKeyDown:"cellKeyDown",gridReady:"gridReady",firstDataRendered:"firstDataRendered",gridSizeChanged:"gridSizeChanged",modelUpdated:"modelUpdated",virtualRowRemoved:"virtualRowRemoved",viewportChanged:"viewportChanged",bodyScroll:"bodyScroll",bodyScrollEnd:"bodyScrollEnd",dragStarted:"dragStarted",dragStopped:"dragStopped",dragCancelled:"dragCancelled",stateUpdated:"stateUpdated",paginationChanged:"paginationChanged",rowDragEnter:"rowDragEnter",rowDragMove:"rowDragMove",rowDragLeave:"rowDragLeave",rowDragEnd:"rowDragEnd",rowDragCancel:"rowDragCancel",rowResizeStarted:"rowResizeStarted",rowResizeEnded:"rowResizeEnded",columnRowGroupChanged:"columnRowGroupChanged",rowGroupOpened:"rowGroupOpened",expandOrCollapseAll:"expandOrCollapseAll",pivotMaxColumnsExceeded:"pivotMaxColumnsExceeded",pinnedRowDataChanged:"pinnedRowDataChanged",pinnedRowsChanged:"pinnedRowsChanged",rowDataUpdated:"rowDataUpdated",asyncTransactionsFlushed:"asyncTransactionsFlushed",storeRefreshed:"storeRefreshed",headerFocused:"headerFocused",cellClicked:"cellClicked",cellDoubleClicked:"cellDoubleClicked",cellFocused:"cellFocused",cellMouseOver:"cellMouseOver",cellMouseOut:"cellMouseOut",cellMouseDown:"cellMouseDown",rowClicked:"rowClicked",rowDoubleClicked:"rowDoubleClicked",rowSelected:"rowSelected",selectionChanged:"selectionChanged",cellContextMenu:"cellContextMenu",rangeSelectionChanged:"rangeSelectionChanged",cellSelectionChanged:"cellSelectionChanged",tooltipShow:"tooltipShow",tooltipHide:"tooltipHide",sortChanged:"sortChanged"},features:[ka([rD,nD]),Hr],decls:0,vars:0,template:function(s,n){},encapsulation:2})}}return e})(),mX=new Set(_b);function vX(e,t){return mX.has(e)?t===""?!0:t==="false"?!1:t:t}tT.registerModules([oD]);var Dv=class e{applicants=Ci(Kn).applicants;colorScheme=Ci(Lh);dataSource=new Tm;theme=Zn(()=>Cb.withPart(this.colorScheme.theme()==="dark"?aT:oT));options={suppressDragLeaveHidesColumns:!0,defaultColDef:{filter:!0},columnDefs:[{field:"full_name",headerName:"Full Name"},{field:"age",headerName:"Age"},{field:"email",headerName:"Email"},{field:"phone_number",headerName:"Phone Number"}],autoSizeStrategy:{type:"fitGridWidth"}};static \u0275fac=function(i){return new(i||e)};static \u0275cmp=oo({type:e,selectors:[["iisa-applicants-table"]],decls:1,vars:3,consts:[[3,"theme","gridOptions","rowData"]],template:function(i,s){i&1&&Lo(0,"ag-grid-angular",0),i&2&&kh("theme",s.theme())("gridOptions",s.options)("rowData",s.applicants())},dependencies:[AR,IR,lD],encapsulation:2,changeDetection:0})};var cD=class e{store=Ci(Kn);static \u0275fac=function(i){return new(i||e)};static \u0275cmp=oo({type:e,selectors:[["iisa-dashboard"]],hostAttrs:[1,"grid","h-full","overflow-auto","pt-20","p-4","gap-4"],features:[ka([bR(CR())])],decls:19,vars:0,consts:[[1,"grid","auto-fill-100","auto-rows-[320px]","*:last:col-span-full","gap-4","has-hover:*:not-hover:opacity-80","*:transition-opacity","*:rounded","*:overflow-auto"],[1,"bg-surface-1","p-8","relative","isolate","rounded","grid"],[1,"grid","gap-4","place-content-center","overflow-clip","h-full","max-w-60","self-start"],[1,"text-3xl","font-bold"],[1,"place-self-end"],["srcset","crew.avif","type","image/avif"],["src","crew.webp","alt","",1,"absolute","top-0","end-0","mask-radial-at-top-right","object-cover","mask-radial-from-0%","mask-radial-to-60%","h-full","-z-10"],["routerLink","/candidates",1,"button","button__bold"],["iisaAgeChart","",1,"bg-surface-1","p-4","rounded"],["iisaDateChart","",1,"bg-surface-1","p-4","rounded"],[1,"w-full","bg-surface-1","h-100","rounded","overflow-auto","grid"]],template:function(i,s){i&1&&(ho(0,"article",0)(1,"section",1)(2,"hgroup",2)(3,"h2",3),Ah(4,"Candidate Review Mode"),uo(),ho(5,"p"),Ah(6,"Enter detailed review mode to inspect each applicant\u2019s mission dossier one at a time."),uo()(),ho(7,"figure",4)(8,"picture"),Lo(9,"source",5)(10,"img",6),uo(),ho(11,"a",7),Ah(12,"Begin Review"),uo()()(),Lo(13,"iisa-map"),ho(14,"section"),Lo(15,"canvas",8),uo(),ho(16,"section"),Lo(17,"canvas",9),uo()(),Lo(18,"iisa-applicants-table",10))},dependencies:[Dv,Rm,Mm,Em,T_],encapsulation:2,changeDetection:0})};export{cD as DashboardComponent};
